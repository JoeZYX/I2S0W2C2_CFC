Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 17919
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0001465  0.000181   0.00097182 0.00123001 0.0004852  0.00060716]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 8.408675909042358
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4808261  Vali Loss: 1.0490500 Vali Accuracy: 0.6963298  Vali weighted F1: 0.6040021  Vali macro F1 0.3705639 
Validation loss decreased (inf --> 1.049050).  Saving model ...
Epoch: 2 cost time: 6.183887481689453
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8044687  Vali Loss: 0.6433446 Vali Accuracy: 0.7601810  Vali weighted F1: 0.7040650  Vali macro F1 0.5091415 
new best score!!!!
Validation loss decreased (1.049050 --> 0.643345).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.1962831020355225
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5829328  Vali Loss: 0.5180349 Vali Accuracy: 0.8225239  Vali weighted F1: 0.7893376  Vali macro F1 0.7304528 
new best score!!!!
Validation loss decreased (0.643345 --> 0.518035).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.181410074234009
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4820169  Vali Loss: 0.4509937 Vali Accuracy: 0.8521870  Vali weighted F1: 0.8399891  Vali macro F1 0.8045497 
new best score!!!!
Validation loss decreased (0.518035 --> 0.450994).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.180037498474121
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4042490  Vali Loss: 0.3800398 Vali Accuracy: 0.8748115  Vali weighted F1: 0.8599157  Vali macro F1 0.8122647 
new best score!!!!
Validation loss decreased (0.450994 --> 0.380040).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.181555271148682
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3572888  Vali Loss: 0.3268253 Vali Accuracy: 0.8934138  Vali weighted F1: 0.8864523  Vali macro F1 0.8435251 
new best score!!!!
Validation loss decreased (0.380040 --> 0.326825).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.176052093505859
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3239816  Vali Loss: 0.3375246 Vali Accuracy: 0.8863751  Vali weighted F1: 0.8799668  Vali macro F1 0.8410969 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.169109344482422
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2914562  Vali Loss: 0.2852605 Vali Accuracy: 0.9059829  Vali weighted F1: 0.9063705  Vali macro F1 0.8740654 
new best score!!!!
Validation loss decreased (0.326825 --> 0.285260).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.187874794006348
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2694875  Vali Loss: 0.2510317 Vali Accuracy: 0.9089995  Vali weighted F1: 0.9088878  Vali macro F1 0.8766025 
new best score!!!!
Validation loss decreased (0.285260 --> 0.251032).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.191880464553833
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2449206  Vali Loss: 0.2451402 Vali Accuracy: 0.9170437  Vali weighted F1: 0.9188495  Vali macro F1 0.8916696 
new best score!!!!
Validation loss decreased (0.251032 --> 0.245140).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.169332265853882
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2240318  Vali Loss: 0.2205090 Vali Accuracy: 0.9281046  Vali weighted F1: 0.9289296  Vali macro F1 0.9038597 
new best score!!!!
Validation loss decreased (0.245140 --> 0.220509).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.174394130706787
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.2044878  Vali Loss: 0.2279020 Vali Accuracy: 0.9265963  Vali weighted F1: 0.9272469  Vali macro F1 0.9054431 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.171157121658325
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1865220  Vali Loss: 0.2011801 Vali Accuracy: 0.9346405  Vali weighted F1: 0.9358551  Vali macro F1 0.9188843 
new best score!!!!
Validation loss decreased (0.220509 --> 0.201180).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1756978034973145
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1792521  Vali Loss: 0.2331005 Vali Accuracy: 0.9260935  Vali weighted F1: 0.9262093  Vali macro F1 0.9028595 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.159441232681274
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1725788  Vali Loss: 0.1816826 Vali Accuracy: 0.9366516  Vali weighted F1: 0.9369658  Vali macro F1 0.9164013 
new best score!!!!
Validation loss decreased (0.201180 --> 0.181683).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.197439432144165
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1602202  Vali Loss: 0.2375850 Vali Accuracy: 0.9195576  Vali weighted F1: 0.9229817  Vali macro F1 0.9002677 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.1744561195373535
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1622588  Vali Loss: 0.2105874 Vali Accuracy: 0.9366516  Vali weighted F1: 0.9377266  Vali macro F1 0.9171860 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.1765923500061035
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1477790  Vali Loss: 0.1665104 Vali Accuracy: 0.9421820  Vali weighted F1: 0.9428822  Vali macro F1 0.9206429 
new best score!!!!
Validation loss decreased (0.181683 --> 0.166510).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.166493892669678
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1429659  Vali Loss: 0.1784710 Vali Accuracy: 0.9401709  Vali weighted F1: 0.9406356  Vali macro F1 0.9222101 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.157940864562988
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1412662  Vali Loss: 0.1507799 Vali Accuracy: 0.9477124  Vali weighted F1: 0.9480989  Vali macro F1 0.9269486 
new best score!!!!
Validation loss decreased (0.166510 --> 0.150780).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.170853137969971
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1328885  Vali Loss: 0.1648409 Vali Accuracy: 0.9477124  Vali weighted F1: 0.9485994  Vali macro F1 0.9285194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.164237022399902
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1281285  Vali Loss: 0.1633757 Vali Accuracy: 0.9396682  Vali weighted F1: 0.9395012  Vali macro F1 0.9210271 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.190262317657471
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1223215  Vali Loss: 0.1381613 Vali Accuracy: 0.9527401  Vali weighted F1: 0.9526039  Vali macro F1 0.9347316 
new best score!!!!
Validation loss decreased (0.150780 --> 0.138161).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.18045711517334
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1237085  Vali Loss: 0.1232841 Vali Accuracy: 0.9592760  Vali weighted F1: 0.9596733  Vali macro F1 0.9499821 
new best score!!!!
Validation loss decreased (0.138161 --> 0.123284).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.168269872665405
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1155643  Vali Loss: 0.1240194 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9582077  Vali macro F1 0.9477030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.158711194992065
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1112978  Vali Loss: 0.1361119 Vali Accuracy: 0.9522373  Vali weighted F1: 0.9521357  Vali macro F1 0.9313505 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.179376840591431
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1066832  Vali Loss: 0.1262321 Vali Accuracy: 0.9542484  Vali weighted F1: 0.9548809  Vali macro F1 0.9393987 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.173753499984741
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1053790  Vali Loss: 0.1781427 Vali Accuracy: 0.9446958  Vali weighted F1: 0.9457302  Vali macro F1 0.9288003 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.180822134017944
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1055695  Vali Loss: 0.1158985 Vali Accuracy: 0.9602815  Vali weighted F1: 0.9603025  Vali macro F1 0.9459610 
new best score!!!!
Validation loss decreased (0.123284 --> 0.115899).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.198116779327393
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1059302  Vali Loss: 0.1592606 Vali Accuracy: 0.9512318  Vali weighted F1: 0.9521449  Vali macro F1 0.9417069 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.182415008544922
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1014367  Vali Loss: 0.1413466 Vali Accuracy: 0.9532428  Vali weighted F1: 0.9545424  Vali macro F1 0.9423259 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.177114725112915
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0959545  Vali Loss: 0.1190575 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9627223  Vali macro F1 0.9510460 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.187196254730225
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0913330  Vali Loss: 0.1040883 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9671147  Vali macro F1 0.9568835 
new best score!!!!
Validation loss decreased (0.115899 --> 0.104088).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.182938814163208
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0871343  Vali Loss: 0.1290548 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9619039  Vali macro F1 0.9524531 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.18485426902771
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0868909  Vali Loss: 0.1042621 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9691483  Vali macro F1 0.9591986 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.1869895458221436
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0814985  Vali Loss: 0.1177161 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9636781  Vali macro F1 0.9541990 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.197412490844727
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0861856  Vali Loss: 0.0962576 Vali Accuracy: 0.9693313  Vali weighted F1: 0.9695572  Vali macro F1 0.9604007 
new best score!!!!
Validation loss decreased (0.104088 --> 0.096258).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.177325963973999
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0784220  Vali Loss: 0.1104882 Vali Accuracy: 0.9607843  Vali weighted F1: 0.9611796  Vali macro F1 0.9450897 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.1762988567352295
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0797583  Vali Loss: 0.1025330 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9672718  Vali macro F1 0.9578751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.17547082901001
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0803712  Vali Loss: 0.1644974 Vali Accuracy: 0.9512318  Vali weighted F1: 0.9523890  Vali macro F1 0.9421753 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.174348831176758
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0852464  Vali Loss: 0.0873908 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9717372  Vali macro F1 0.9631509 
new best score!!!!
Validation loss decreased (0.096258 --> 0.087391).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.182793617248535
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0807862  Vali Loss: 0.1091836 Vali Accuracy: 0.9693313  Vali weighted F1: 0.9696889  Vali macro F1 0.9610732 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.19373083114624
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0735188  Vali Loss: 0.0858380 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9714645  Vali macro F1 0.9616019 
new best score!!!!
Validation loss decreased (0.087391 --> 0.085838).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.195608139038086
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0775732  Vali Loss: 0.0987082 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9676485  Vali macro F1 0.9483505 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.180458307266235
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0747883  Vali Loss: 0.1033360 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9700993  Vali macro F1 0.9612411 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.178268194198608
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0782894  Vali Loss: 0.1178587 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9636672  Vali macro F1 0.9535302 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.182409048080444
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0699580  Vali Loss: 0.1310056 Vali Accuracy: 0.9638009  Vali weighted F1: 0.9643909  Vali macro F1 0.9535080 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.178086042404175
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0745957  Vali Loss: 0.1171624 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9649443  Vali macro F1 0.9558756 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 6.1724042892456055
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0621135  Vali Loss: 0.0954303 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9701534  Vali macro F1 0.9610752 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.199570417404175
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0580218  Vali Loss: 0.0911718 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9716229  Vali macro F1 0.9632048 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.197098731994629
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0586463  Vali Loss: 0.0907483 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9716316  Vali macro F1 0.9634351 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.178884267807007
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0574163  Vali Loss: 0.0870387 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9721373  Vali macro F1 0.9636542 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.184872388839722
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0558745  Vali Loss: 0.0876324 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9731497  Vali macro F1 0.9648556 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 6.177198886871338
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0547330  Vali Loss: 0.0881221 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9721752  Vali macro F1 0.9636348 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.1812403202056885
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0541724  Vali Loss: 0.0891410 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9716481  Vali macro F1 0.9630280 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.183550596237183
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0550614  Vali Loss: 0.0879701 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9721539  Vali macro F1 0.9631517 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.187963247299194
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0544035  Vali Loss: 0.0884582 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9721293  Vali macro F1 0.9634513 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.188789129257202
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0548477  Vali Loss: 0.0886273 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9721293  Vali macro F1 0.9634513 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8137127  Test weighted F1: 0.8263335  Test macro F1 0.7756771 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.268127918243408
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0650018  Vali Loss: 0.0961552 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9710902  Vali macro F1 0.9616126 
Validation loss decreased (inf --> 0.096155).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.20763897895813
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0624484  Vali Loss: 0.0919881 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9711707  Vali macro F1 0.9625660 
new best score!!!!
Validation loss decreased (0.096155 --> 0.091988).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.200539827346802
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0631131  Vali Loss: 0.1019089 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9687015  Vali macro F1 0.9599983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.2032694816589355
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0610905  Vali Loss: 0.0926617 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9726056  Vali macro F1 0.9639294 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.228973150253296
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0626958  Vali Loss: 0.0959064 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9701526  Vali macro F1 0.9605186 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.232922315597534
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0595827  Vali Loss: 0.0895598 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9736031  Vali macro F1 0.9646571 
new best score!!!!
Validation loss decreased (0.091988 --> 0.089560).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.228191614151001
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0596283  Vali Loss: 0.0918954 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9720791  Vali macro F1 0.9630064 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.223974704742432
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0613730  Vali Loss: 0.0925735 Vali Accuracy: 0.9703369  Vali weighted F1: 0.9706418  Vali macro F1 0.9619061 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.220521688461304
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0602211  Vali Loss: 0.0911663 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9716374  Vali macro F1 0.9629764 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.21736741065979
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0595226  Vali Loss: 0.0907884 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9716448  Vali macro F1 0.9627889 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.217342138290405
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0584350  Vali Loss: 0.0914964 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9711708  Vali macro F1 0.9625791 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.2241740226745605
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0565061  Vali Loss: 0.0929343 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9701646  Vali macro F1 0.9607007 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.242655277252197
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0580910  Vali Loss: 0.0992855 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9681502  Vali macro F1 0.9575386 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.223733186721802
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0581009  Vali Loss: 0.0901268 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9720905  Vali macro F1 0.9634327 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.217194318771362
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0577238  Vali Loss: 0.0912847 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9711763  Vali macro F1 0.9619199 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.230226516723633
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0586362  Vali Loss: 0.0842782 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9745232  Vali macro F1 0.9659874 
new best score!!!!
Validation loss decreased (0.089560 --> 0.084278).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.213002920150757
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0598189  Vali Loss: 0.0874956 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9745185  Vali macro F1 0.9657529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.216839790344238
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0589400  Vali Loss: 0.0992337 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9686939  Vali macro F1 0.9586743 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.242820739746094
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0531833  Vali Loss: 0.0851896 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9740678  Vali macro F1 0.9655333 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.220125913619995
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0552626  Vali Loss: 0.0894369 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9716713  Vali macro F1 0.9619511 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.218983888626099
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0558228  Vali Loss: 0.0941862 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9702069  Vali macro F1 0.9607560 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 6.213284254074097
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0549639  Vali Loss: 0.0907376 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9726150  Vali macro F1 0.9640743 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.216111898422241
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0552548  Vali Loss: 0.0909899 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9701619  Vali macro F1 0.9605982 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.211648941040039
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0539875  Vali Loss: 0.0904535 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9720916  Vali macro F1 0.9633758 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.221439599990845
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0535118  Vali Loss: 0.0923247 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9716068  Vali macro F1 0.9629216 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.2366743087768555
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0532825  Vali Loss: 0.0905691 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9725977  Vali macro F1 0.9636222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 6.23553466796875
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0543336  Vali Loss: 0.0904904 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9725977  Vali macro F1 0.9636222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.2236552238464355
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0529976  Vali Loss: 0.0906653 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9725977  Vali macro F1 0.9636222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.21757960319519
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0544642  Vali Loss: 0.0906763 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9725977  Vali macro F1 0.9636222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.212578535079956
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0530176  Vali Loss: 0.0904704 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9725977  Vali macro F1 0.9636222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.2120325565338135
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0531001  Vali Loss: 0.0905116 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9725977  Vali macro F1 0.9636222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8048658  Test weighted F1: 0.8193481  Test macro F1 0.7729557 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014928 0.00018305 0.00110011 0.00139082 0.00051151 0.00062189]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.0179057121276855
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.4927030  Vali Loss: 1.1132286 Vali Accuracy: 0.6666667  Vali weighted F1: 0.5558836  Vali macro F1 0.2728408 
Validation loss decreased (inf --> 1.113229).  Saving model ...
Epoch: 2 cost time: 6.033739805221558
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.8423261  Vali Loss: 0.6782306 Vali Accuracy: 0.7563504  Vali weighted F1: 0.7022062  Vali macro F1 0.5075349 
new best score!!!!
Validation loss decreased (1.113229 --> 0.678231).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.0349555015563965
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.6008345  Vali Loss: 0.6152616 Vali Accuracy: 0.7879730  Vali weighted F1: 0.7541831  Vali macro F1 0.6837265 
new best score!!!!
Validation loss decreased (0.678231 --> 0.615262).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.0260961055755615
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.5005044  Vali Loss: 0.4696810 Vali Accuracy: 0.8455158  Vali weighted F1: 0.8254378  Vali macro F1 0.7723251 
new best score!!!!
Validation loss decreased (0.615262 --> 0.469681).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.028943061828613
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.4329268  Vali Loss: 0.3908159 Vali Accuracy: 0.8776568  Vali weighted F1: 0.8699474  Vali macro F1 0.8292402 
new best score!!!!
Validation loss decreased (0.469681 --> 0.390816).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.0383265018463135
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.3607983  Vali Loss: 0.3403110 Vali Accuracy: 0.8952825  Vali weighted F1: 0.8940333  Vali macro F1 0.8486237 
new best score!!!!
Validation loss decreased (0.390816 --> 0.340311).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.037311792373657
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.3064788  Vali Loss: 0.3065875 Vali Accuracy: 0.9009850  Vali weighted F1: 0.9015074  Vali macro F1 0.8573179 
new best score!!!!
Validation loss decreased (0.340311 --> 0.306588).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.038040637969971
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.2782048  Vali Loss: 0.2670193 Vali Accuracy: 0.9097978  Vali weighted F1: 0.9105911  Vali macro F1 0.8685602 
new best score!!!!
Validation loss decreased (0.306588 --> 0.267019).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.058164119720459
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.2450504  Vali Loss: 0.2559533 Vali Accuracy: 0.9139450  Vali weighted F1: 0.9148440  Vali macro F1 0.8742449 
new best score!!!!
Validation loss decreased (0.267019 --> 0.255953).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.031583070755005
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.2314174  Vali Loss: 0.2466769 Vali Accuracy: 0.9175739  Vali weighted F1: 0.9194279  Vali macro F1 0.8797471 
new best score!!!!
Validation loss decreased (0.255953 --> 0.246677).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.0319743156433105
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.2153934  Vali Loss: 0.2353863 Vali Accuracy: 0.9191291  Vali weighted F1: 0.9180209  Vali macro F1 0.8794666 
new best score!!!!
Validation loss decreased (0.246677 --> 0.235386).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.043847322463989
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.2042674  Vali Loss: 0.2590726 Vali Accuracy: 0.9149819  Vali weighted F1: 0.9151392  Vali macro F1 0.8804852 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.047727346420288
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1992883  Vali Loss: 0.2244859 Vali Accuracy: 0.9237947  Vali weighted F1: 0.9226689  Vali macro F1 0.8912594 
new best score!!!!
Validation loss decreased (0.235386 --> 0.224486).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.041712522506714
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1876353  Vali Loss: 0.2238173 Vali Accuracy: 0.9305340  Vali weighted F1: 0.9299758  Vali macro F1 0.8992939 
new best score!!!!
Validation loss decreased (0.224486 --> 0.223817).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.042705059051514
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1818555  Vali Loss: 0.2044509 Vali Accuracy: 0.9336444  Vali weighted F1: 0.9351507  Vali macro F1 0.9170419 
new best score!!!!
Validation loss decreased (0.223817 --> 0.204451).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.047606945037842
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1695535  Vali Loss: 0.1856603 Vali Accuracy: 0.9455677  Vali weighted F1: 0.9458386  Vali macro F1 0.9276715 
new best score!!!!
Validation loss decreased (0.204451 --> 0.185660).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.033628940582275
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1661925  Vali Loss: 0.1949287 Vali Accuracy: 0.9403836  Vali weighted F1: 0.9406540  Vali macro F1 0.9215869 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.0218400955200195
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.1596925  Vali Loss: 0.1890595 Vali Accuracy: 0.9445308  Vali weighted F1: 0.9444655  Vali macro F1 0.9265131 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.026043653488159
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.1509246  Vali Loss: 0.1718087 Vali Accuracy: 0.9455677  Vali weighted F1: 0.9464295  Vali macro F1 0.9299375 
new best score!!!!
Validation loss decreased (0.185660 --> 0.171809).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.0437705516815186
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.1494325  Vali Loss: 0.1782560 Vali Accuracy: 0.9471229  Vali weighted F1: 0.9467094  Vali macro F1 0.9292106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.040010213851929
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.1424894  Vali Loss: 0.1530680 Vali Accuracy: 0.9538621  Vali weighted F1: 0.9531809  Vali macro F1 0.9368507 
new best score!!!!
Validation loss decreased (0.171809 --> 0.153068).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.0591795444488525
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.1368215  Vali Loss: 0.1684121 Vali Accuracy: 0.9460861  Vali weighted F1: 0.9457632  Vali macro F1 0.9274816 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.025680303573608
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.1310027  Vali Loss: 0.1595927 Vali Accuracy: 0.9497149  Vali weighted F1: 0.9494277  Vali macro F1 0.9318601 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.013244390487671
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.1265323  Vali Loss: 0.1390828 Vali Accuracy: 0.9590461  Vali weighted F1: 0.9587537  Vali macro F1 0.9479964 
new best score!!!!
Validation loss decreased (0.153068 --> 0.139083).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.030277490615845
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.1233125  Vali Loss: 0.1507322 Vali Accuracy: 0.9523069  Vali weighted F1: 0.9525510  Vali macro F1 0.9415611 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.03719425201416
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.1222921  Vali Loss: 0.1363379 Vali Accuracy: 0.9600829  Vali weighted F1: 0.9601268  Vali macro F1 0.9488913 
new best score!!!!
Validation loss decreased (0.139083 --> 0.136338).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.040109157562256
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.1169236  Vali Loss: 0.1476556 Vali Accuracy: 0.9512701  Vali weighted F1: 0.9506588  Vali macro F1 0.9348774 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.044398069381714
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.1132147  Vali Loss: 0.1282709 Vali Accuracy: 0.9611198  Vali weighted F1: 0.9610256  Vali macro F1 0.9504098 
new best score!!!!
Validation loss decreased (0.136338 --> 0.128271).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.050792455673218
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.1124298  Vali Loss: 0.1681419 Vali Accuracy: 0.9455677  Vali weighted F1: 0.9447794  Vali macro F1 0.9321292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.035694122314453
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.1104598  Vali Loss: 0.1331112 Vali Accuracy: 0.9569725  Vali weighted F1: 0.9572408  Vali macro F1 0.9492158 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.015126705169678
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.1127994  Vali Loss: 0.1256551 Vali Accuracy: 0.9554173  Vali weighted F1: 0.9552810  Vali macro F1 0.9421799 
new best score!!!!
Validation loss decreased (0.128271 --> 0.125655).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.013398885726929
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.1053979  Vali Loss: 0.1212383 Vali Accuracy: 0.9611198  Vali weighted F1: 0.9608336  Vali macro F1 0.9510489 
new best score!!!!
Validation loss decreased (0.125655 --> 0.121238).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.025146484375
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.1020459  Vali Loss: 0.1143395 Vali Accuracy: 0.9611198  Vali weighted F1: 0.9608936  Vali macro F1 0.9512575 
new best score!!!!
Validation loss decreased (0.121238 --> 0.114340).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.029331684112549
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0959721  Vali Loss: 0.1010711 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9682016  Vali macro F1 0.9604754 
new best score!!!!
Validation loss decreased (0.114340 --> 0.101071).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.010803461074829
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.1012523  Vali Loss: 0.1022129 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9671869  Vali macro F1 0.9597351 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.015497446060181
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0978181  Vali Loss: 0.1045565 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9640103  Vali macro F1 0.9565632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.032158613204956
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0862483  Vali Loss: 0.1283912 Vali Accuracy: 0.9517885  Vali weighted F1: 0.9524999  Vali macro F1 0.9451854 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.023160219192505
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0927689  Vali Loss: 0.1190820 Vali Accuracy: 0.9569725  Vali weighted F1: 0.9579107  Vali macro F1 0.9508986 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.006539821624756
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0829170  Vali Loss: 0.0989036 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9680100  Vali macro F1 0.9619157 
new best score!!!!
Validation loss decreased (0.101071 --> 0.098904).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.017081022262573
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0793960  Vali Loss: 0.1047269 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9637618  Vali macro F1 0.9563147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.012031555175781
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0807306  Vali Loss: 0.1076105 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9625299  Vali macro F1 0.9530328 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.017102003097534
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0833326  Vali Loss: 0.0925673 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9670807  Vali macro F1 0.9612778 
new best score!!!!
Validation loss decreased (0.098904 --> 0.092567).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.030165433883667
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0780677  Vali Loss: 0.0993597 Vali Accuracy: 0.9631934  Vali weighted F1: 0.9631757  Vali macro F1 0.9546216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.0256407260894775
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0727699  Vali Loss: 0.0908215 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9688835  Vali macro F1 0.9603946 
new best score!!!!
Validation loss decreased (0.092567 --> 0.090822).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.021005630493164
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0787638  Vali Loss: 0.1094521 Vali Accuracy: 0.9626750  Vali weighted F1: 0.9626326  Vali macro F1 0.9561606 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.007153272628784
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0668946  Vali Loss: 0.0761585 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9744638  Vali macro F1 0.9671529 
new best score!!!!
Validation loss decreased (0.090822 --> 0.076158).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.026014566421509
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0706107  Vali Loss: 0.0802369 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9745152  Vali macro F1 0.9667423 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.020003080368042
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0664596  Vali Loss: 0.0844645 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9730115  Vali macro F1 0.9657861 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.028190851211548
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0658935  Vali Loss: 0.0957203 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9684444  Vali macro F1 0.9594537 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.024939060211182
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0659478  Vali Loss: 0.0889115 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9694018  Vali macro F1 0.9605393 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.0461719036102295
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0597010  Vali Loss: 0.0780746 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9750663  Vali macro F1 0.9667501 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 52 cost time: 6.025819301605225
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0534008  Vali Loss: 0.0750652 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9755760  Vali macro F1 0.9661442 
new best score!!!!
Validation loss decreased (0.076158 --> 0.075065).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.0143043994903564
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0532958  Vali Loss: 0.0750387 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9754965  Vali macro F1 0.9676657 
new best score!!!!
Validation loss decreased (0.075065 --> 0.075039).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.020869731903076
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0535672  Vali Loss: 0.0713020 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9765924  Vali macro F1 0.9687459 
new best score!!!!
Validation loss decreased (0.075039 --> 0.071302).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.025852203369141
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0500859  Vali Loss: 0.0732131 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9761423  Vali macro F1 0.9694194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.019297122955322
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0501295  Vali Loss: 0.0746889 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766238  Vali macro F1 0.9687664 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.022736310958862
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0509765  Vali Loss: 0.0738373 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9775514  Vali macro F1 0.9704589 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.034082889556885
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0494490  Vali Loss: 0.0734336 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9786513  Vali macro F1 0.9717452 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.016422510147095
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0495088  Vali Loss: 0.0728158 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9775505  Vali macro F1 0.9696160 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 6.005599021911621
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0484173  Vali Loss: 0.0716025 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9760399  Vali macro F1 0.9677988 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.012592077255249
VALI: Epoch: 61, Steps: 68 | Train Loss: 0.0492744  Vali Loss: 0.0713268 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9770640  Vali macro F1 0.9687053 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.014279365539551
VALI: Epoch: 62, Steps: 68 | Train Loss: 0.0502931  Vali Loss: 0.0717497 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9765641  Vali macro F1 0.9682706 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.017552614212036
VALI: Epoch: 63, Steps: 68 | Train Loss: 0.0491711  Vali Loss: 0.0709094 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9776482  Vali macro F1 0.9699410 
new best score!!!!
Validation loss decreased (0.071302 --> 0.070909).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 6.038699626922607
VALI: Epoch: 64, Steps: 68 | Train Loss: 0.0481027  Vali Loss: 0.0710869 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9776126  Vali macro F1 0.9693581 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 6.048690319061279
VALI: Epoch: 65, Steps: 68 | Train Loss: 0.0496115  Vali Loss: 0.0720699 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9775588  Vali macro F1 0.9700139 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 6.02976131439209
VALI: Epoch: 66, Steps: 68 | Train Loss: 0.0478201  Vali Loss: 0.0712613 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9760124  Vali macro F1 0.9677391 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 6.0176520347595215
VALI: Epoch: 67, Steps: 68 | Train Loss: 0.0500298  Vali Loss: 0.0715179 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9765152  Vali macro F1 0.9683012 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 6.0130226612091064
VALI: Epoch: 68, Steps: 68 | Train Loss: 0.0495376  Vali Loss: 0.0715978 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9765683  Vali macro F1 0.9683994 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 69 cost time: 6.013925552368164
VALI: Epoch: 69, Steps: 68 | Train Loss: 0.0483335  Vali Loss: 0.0714396 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9760573  Vali macro F1 0.9675972 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.017147541046143
VALI: Epoch: 70, Steps: 68 | Train Loss: 0.0483003  Vali Loss: 0.0712013 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.032174825668335
VALI: Epoch: 71, Steps: 68 | Train Loss: 0.0482351  Vali Loss: 0.0711293 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.0321245193481445
VALI: Epoch: 72, Steps: 68 | Train Loss: 0.0491695  Vali Loss: 0.0709855 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.011044979095459
VALI: Epoch: 73, Steps: 68 | Train Loss: 0.0472244  Vali Loss: 0.0710230 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 74 cost time: 6.026362180709839
VALI: Epoch: 74, Steps: 68 | Train Loss: 0.0492336  Vali Loss: 0.0710228 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 6.023385286331177
VALI: Epoch: 75, Steps: 68 | Train Loss: 0.0475563  Vali Loss: 0.0710277 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 6.025106430053711
VALI: Epoch: 76, Steps: 68 | Train Loss: 0.0473054  Vali Loss: 0.0710381 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 6.020179033279419
VALI: Epoch: 77, Steps: 68 | Train Loss: 0.0496610  Vali Loss: 0.0710288 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 6.025037527084351
VALI: Epoch: 78, Steps: 68 | Train Loss: 0.0496888  Vali Loss: 0.0710309 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766058  Vali macro F1 0.9682500 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9313212  Test weighted F1: 0.9339109  Test macro F1 0.9061574 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.057690382003784
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0496289  Vali Loss: 0.0716042 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9771721  Vali macro F1 0.9694874 
Validation loss decreased (inf --> 0.071604).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.027917146682739
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0509976  Vali Loss: 0.0697056 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9781325  Vali macro F1 0.9703594 
new best score!!!!
Validation loss decreased (0.071604 --> 0.069706).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.016418695449829
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0479657  Vali Loss: 0.0751716 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772016  Vali macro F1 0.9702678 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.0146284103393555
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0487435  Vali Loss: 0.0751216 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9759700  Vali macro F1 0.9677753 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.029153347015381
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0480511  Vali Loss: 0.0700514 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9786427  Vali macro F1 0.9716505 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.018294811248779
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0480646  Vali Loss: 0.0772680 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9764806  Vali macro F1 0.9686988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.0405592918396
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0478167  Vali Loss: 0.0708694 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9771766  Vali macro F1 0.9698186 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.034401178359985
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0489835  Vali Loss: 0.0705442 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9775844  Vali macro F1 0.9701646 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.019207715988159
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0456400  Vali Loss: 0.0725782 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9781446  Vali macro F1 0.9711984 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.025601148605347
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0464522  Vali Loss: 0.0712857 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9791844  Vali macro F1 0.9721677 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.025517702102661
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0486060  Vali Loss: 0.0732584 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766745  Vali macro F1 0.9699604 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.025407314300537
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0463774  Vali Loss: 0.0728874 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9760687  Vali macro F1 0.9680734 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.034998178482056
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0452985  Vali Loss: 0.0699696 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9765403  Vali macro F1 0.9691680 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.044354677200317
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0471547  Vali Loss: 0.0715662 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9765631  Vali macro F1 0.9689708 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.030423402786255
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0450482  Vali Loss: 0.0713893 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9775769  Vali macro F1 0.9701086 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.034308910369873
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0456526  Vali Loss: 0.0710455 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9776181  Vali macro F1 0.9701918 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.021369218826294
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0439895  Vali Loss: 0.0708705 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9771670  Vali macro F1 0.9696242 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9349399  Test weighted F1: 0.9372517  Test macro F1 0.9096816 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014773 0.00018282 0.00097561 0.00126743 0.0005005  0.00061237]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.13103985786438
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4873248  Vali Loss: 1.0616509 Vali Accuracy: 0.6900763  Vali weighted F1: 0.5982936  Vali macro F1 0.3773146 
Validation loss decreased (inf --> 1.061651).  Saving model ...
Epoch: 2 cost time: 6.145350694656372
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8072391  Vali Loss: 0.6632968 Vali Accuracy: 0.7648855  Vali weighted F1: 0.7124911  Vali macro F1 0.5176496 
new best score!!!!
Validation loss decreased (1.061651 --> 0.663297).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.1516804695129395
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5971702  Vali Loss: 0.5151747 Vali Accuracy: 0.8361323  Vali weighted F1: 0.7993798  Vali macro F1 0.7165376 
new best score!!!!
Validation loss decreased (0.663297 --> 0.515175).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.122491836547852
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4861113  Vali Loss: 0.4592157 Vali Accuracy: 0.8508906  Vali weighted F1: 0.8383643  Vali macro F1 0.7847230 
new best score!!!!
Validation loss decreased (0.515175 --> 0.459216).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.163954734802246
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4074660  Vali Loss: 0.3848478 Vali Accuracy: 0.8595420  Vali weighted F1: 0.8522755  Vali macro F1 0.7802255 
new best score!!!!
Validation loss decreased (0.459216 --> 0.384848).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.149394750595093
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3685037  Vali Loss: 0.3179943 Vali Accuracy: 0.8890585  Vali weighted F1: 0.8807529  Vali macro F1 0.8231363 
new best score!!!!
Validation loss decreased (0.384848 --> 0.317994).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.132489442825317
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3254423  Vali Loss: 0.3040268 Vali Accuracy: 0.8977099  Vali weighted F1: 0.8930040  Vali macro F1 0.8397217 
new best score!!!!
Validation loss decreased (0.317994 --> 0.304027).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.133812427520752
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2956532  Vali Loss: 0.2757537 Vali Accuracy: 0.9058524  Vali weighted F1: 0.9040627  Vali macro F1 0.8588359 
new best score!!!!
Validation loss decreased (0.304027 --> 0.275754).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.141957521438599
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2694708  Vali Loss: 0.2579695 Vali Accuracy: 0.9134860  Vali weighted F1: 0.9131674  Vali macro F1 0.8668653 
new best score!!!!
Validation loss decreased (0.275754 --> 0.257970).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.146476745605469
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2578038  Vali Loss: 0.2702313 Vali Accuracy: 0.9078880  Vali weighted F1: 0.9072858  Vali macro F1 0.8651529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.140789031982422
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2378341  Vali Loss: 0.2329978 Vali Accuracy: 0.9190840  Vali weighted F1: 0.9199123  Vali macro F1 0.8807832 
new best score!!!!
Validation loss decreased (0.257970 --> 0.232998).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.135972499847412
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.2112227  Vali Loss: 0.2187927 Vali Accuracy: 0.9216285  Vali weighted F1: 0.9229008  Vali macro F1 0.8833957 
new best score!!!!
Validation loss decreased (0.232998 --> 0.218793).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.1345367431640625
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1966274  Vali Loss: 0.2115337 Vali Accuracy: 0.9282443  Vali weighted F1: 0.9286158  Vali macro F1 0.8918637 
new best score!!!!
Validation loss decreased (0.218793 --> 0.211534).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.148347616195679
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1886442  Vali Loss: 0.1950997 Vali Accuracy: 0.9318066  Vali weighted F1: 0.9329114  Vali macro F1 0.8992577 
new best score!!!!
Validation loss decreased (0.211534 --> 0.195100).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.159094572067261
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1807705  Vali Loss: 0.2061249 Vali Accuracy: 0.9272265  Vali weighted F1: 0.9293798  Vali macro F1 0.8964369 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.140951871871948
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1798600  Vali Loss: 0.2190940 Vali Accuracy: 0.9226463  Vali weighted F1: 0.9253629  Vali macro F1 0.8975508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.152660131454468
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1713200  Vali Loss: 0.2170020 Vali Accuracy: 0.9272265  Vali weighted F1: 0.9293133  Vali macro F1 0.9047861 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.146843910217285
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1638575  Vali Loss: 0.1651792 Vali Accuracy: 0.9409669  Vali weighted F1: 0.9415240  Vali macro F1 0.9104507 
new best score!!!!
Validation loss decreased (0.195100 --> 0.165179).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.1454713344573975
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1558154  Vali Loss: 0.1543169 Vali Accuracy: 0.9450382  Vali weighted F1: 0.9457130  Vali macro F1 0.9186091 
new best score!!!!
Validation loss decreased (0.165179 --> 0.154317).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.136366605758667
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1470388  Vali Loss: 0.1500676 Vali Accuracy: 0.9475827  Vali weighted F1: 0.9477026  Vali macro F1 0.9201760 
new best score!!!!
Validation loss decreased (0.154317 --> 0.150068).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.1376354694366455
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1523996  Vali Loss: 0.1483466 Vali Accuracy: 0.9455471  Vali weighted F1: 0.9463949  Vali macro F1 0.9215061 
new best score!!!!
Validation loss decreased (0.150068 --> 0.148347).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.131246566772461
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1395953  Vali Loss: 0.1466616 Vali Accuracy: 0.9455471  Vali weighted F1: 0.9464780  Vali macro F1 0.9179370 
new best score!!!!
Validation loss decreased (0.148347 --> 0.146662).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.146601438522339
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1338150  Vali Loss: 0.1491586 Vali Accuracy: 0.9435115  Vali weighted F1: 0.9438696  Vali macro F1 0.9157228 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.165812253952026
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1414343  Vali Loss: 0.1766461 Vali Accuracy: 0.9333333  Vali weighted F1: 0.9355088  Vali macro F1 0.9061181 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.133163928985596
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1319862  Vali Loss: 0.1271052 Vali Accuracy: 0.9552163  Vali weighted F1: 0.9551702  Vali macro F1 0.9293053 
new best score!!!!
Validation loss decreased (0.146662 --> 0.127105).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.1312339305877686
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1250812  Vali Loss: 0.1536971 Vali Accuracy: 0.9445293  Vali weighted F1: 0.9455424  Vali macro F1 0.9208070 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.136171340942383
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1200498  Vali Loss: 0.1216342 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9575760  Vali macro F1 0.9347486 
new best score!!!!
Validation loss decreased (0.127105 --> 0.121634).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.137844800949097
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1274908  Vali Loss: 0.1498657 Vali Accuracy: 0.9501272  Vali weighted F1: 0.9502923  Vali macro F1 0.9274338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.132375240325928
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1128024  Vali Loss: 0.1134380 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9601147  Vali macro F1 0.9394246 
new best score!!!!
Validation loss decreased (0.121634 --> 0.113438).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.146096467971802
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1109134  Vali Loss: 0.1656392 Vali Accuracy: 0.9440204  Vali weighted F1: 0.9453750  Vali macro F1 0.9264171 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.153470993041992
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1137044  Vali Loss: 0.1105218 Vali Accuracy: 0.9618321  Vali weighted F1: 0.9621160  Vali macro F1 0.9434432 
new best score!!!!
Validation loss decreased (0.113438 --> 0.110522).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.1321775913238525
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1057725  Vali Loss: 0.1172966 Vali Accuracy: 0.9577608  Vali weighted F1: 0.9579021  Vali macro F1 0.9365589 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.131896257400513
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.1041202  Vali Loss: 0.1082595 Vali Accuracy: 0.9587786  Vali weighted F1: 0.9589529  Vali macro F1 0.9372692 
new best score!!!!
Validation loss decreased (0.110522 --> 0.108260).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.1492087841033936
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.1022830  Vali Loss: 0.1210647 Vali Accuracy: 0.9582697  Vali weighted F1: 0.9584259  Vali macro F1 0.9346497 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.1327760219573975
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.1185870  Vali Loss: 0.1108097 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9560012  Vali macro F1 0.9318259 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.1338605880737305
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0939743  Vali Loss: 0.1080784 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9611683  Vali macro F1 0.9418812 
new best score!!!!
Validation loss decreased (0.108260 --> 0.108078).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.139330625534058
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0955165  Vali Loss: 0.1189577 Vali Accuracy: 0.9516539  Vali weighted F1: 0.9518503  Vali macro F1 0.9271150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.155967473983765
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0926565  Vali Loss: 0.0997357 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9681458  Vali macro F1 0.9470609 
new best score!!!!
Validation loss decreased (0.108078 --> 0.099736).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.137568473815918
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0890292  Vali Loss: 0.1103359 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9635028  Vali macro F1 0.9402842 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.126493453979492
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0952888  Vali Loss: 0.0906210 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697335  Vali macro F1 0.9494380 
new best score!!!!
Validation loss decreased (0.099736 --> 0.090621).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.134413003921509
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0858292  Vali Loss: 0.0908158 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9674109  Vali macro F1 0.9449647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.13592004776001
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0837808  Vali Loss: 0.0948805 Vali Accuracy: 0.9653944  Vali weighted F1: 0.9658570  Vali macro F1 0.9467397 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.132137298583984
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0816841  Vali Loss: 0.0968647 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9713847  Vali macro F1 0.9545568 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.14649772644043
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0856037  Vali Loss: 0.0853133 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675922  Vali macro F1 0.9468727 
new best score!!!!
Validation loss decreased (0.090621 --> 0.085313).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.14454460144043
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0918527  Vali Loss: 0.1333699 Vali Accuracy: 0.9536896  Vali weighted F1: 0.9534790  Vali macro F1 0.9313866 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.15233588218689
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0917709  Vali Loss: 0.0876648 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727658  Vali macro F1 0.9578937 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.131315469741821
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0800721  Vali Loss: 0.0829882 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9760969  Vali macro F1 0.9630820 
new best score!!!!
Validation loss decreased (0.085313 --> 0.082988).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.140070676803589
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0766616  Vali Loss: 0.0850129 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9719596  Vali macro F1 0.9585816 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.142575025558472
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0691180  Vali Loss: 0.0830077 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9734830  Vali macro F1 0.9610376 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.135176658630371
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0738632  Vali Loss: 0.0984284 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9690816  Vali macro F1 0.9532227 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.1417152881622314
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0721070  Vali Loss: 0.0800018 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9718193  Vali macro F1 0.9563061 
new best score!!!!
Validation loss decreased (0.082988 --> 0.080002).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.154245138168335
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0782133  Vali Loss: 0.0786719 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9764530  Vali macro F1 0.9631942 
new best score!!!!
Validation loss decreased (0.080002 --> 0.078672).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.157705068588257
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0730185  Vali Loss: 0.1193165 Vali Accuracy: 0.9633588  Vali weighted F1: 0.9631918  Vali macro F1 0.9518055 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.140309572219849
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0677967  Vali Loss: 0.0787721 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9750471  Vali macro F1 0.9639356 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.140921115875244
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0632581  Vali Loss: 0.0719539 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9760554  Vali macro F1 0.9633073 
new best score!!!!
Validation loss decreased (0.078672 --> 0.071954).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.134719371795654
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0696328  Vali Loss: 0.0856775 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9708513  Vali macro F1 0.9576585 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.126653671264648
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0655894  Vali Loss: 0.0767632 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9780284  Vali macro F1 0.9687359 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.126022815704346
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0650324  Vali Loss: 0.0720621 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9803942  Vali macro F1 0.9705832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.133463382720947
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0613100  Vali Loss: 0.0692518 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9778284  Vali macro F1 0.9665510 
new best score!!!!
Validation loss decreased (0.071954 --> 0.069252).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.121377468109131
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0760265  Vali Loss: 0.0732394 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9748397  Vali macro F1 0.9617644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.113752126693726
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0649146  Vali Loss: 0.0664967 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9777573  Vali macro F1 0.9646558 
new best score!!!!
Validation loss decreased (0.069252 --> 0.066497).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.11419415473938
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0625738  Vali Loss: 0.0880030 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9704889  Vali macro F1 0.9580569 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.103090524673462
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0559306  Vali Loss: 0.0684820 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9763828  Vali macro F1 0.9649084 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.1203296184539795
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0544264  Vali Loss: 0.0694198 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9792928  Vali macro F1 0.9646930 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.123123407363892
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0627214  Vali Loss: 0.0807456 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9754930  Vali macro F1 0.9674530 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 6.1344544887542725
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0740750  Vali Loss: 0.0611430 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9786984  Vali macro F1 0.9651944 
new best score!!!!
Validation loss decreased (0.066497 --> 0.061143).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 6.1317524909973145
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0582671  Vali Loss: 0.0672733 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9779155  Vali macro F1 0.9673352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 6.111583232879639
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0529790  Vali Loss: 0.0678489 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9795997  Vali macro F1 0.9687302 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 6.113661289215088
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0536176  Vali Loss: 0.0719576 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9778672  Vali macro F1 0.9674014 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 6.1241137981414795
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0550795  Vali Loss: 0.0655273 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9767812  Vali macro F1 0.9639709 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 6.135987281799316
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0545066  Vali Loss: 0.0779533 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9734380  Vali macro F1 0.9615111 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 72 cost time: 6.114893436431885
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0441294  Vali Loss: 0.0623542 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832647  Vali macro F1 0.9741038 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 6.132688283920288
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0414482  Vali Loss: 0.0582924 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9822603  Vali macro F1 0.9729016 
new best score!!!!
Validation loss decreased (0.061143 --> 0.058292).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 6.142568826675415
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0415108  Vali Loss: 0.0587938 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817692  Vali macro F1 0.9721042 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 6.1121909618377686
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0395546  Vali Loss: 0.0600866 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9808035  Vali macro F1 0.9713361 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 6.110601902008057
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0385102  Vali Loss: 0.0599321 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9803251  Vali macro F1 0.9711729 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 6.1162800788879395
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0413188  Vali Loss: 0.0582365 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9813007  Vali macro F1 0.9720756 
new best score!!!!
Validation loss decreased (0.058292 --> 0.058236).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 6.118370056152344
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0411758  Vali Loss: 0.0560313 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9802467  Vali macro F1 0.9698194 
new best score!!!!
Validation loss decreased (0.058236 --> 0.056031).  Saving model ...
new best score!!!!
Epoch: 79 cost time: 6.119798898696899
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0390366  Vali Loss: 0.0609714 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9812925  Vali macro F1 0.9719234 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 6.135287761688232
VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0403858  Vali Loss: 0.0604528 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9827921  Vali macro F1 0.9734439 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 6.110154867172241
VALI: Epoch: 81, Steps: 70 | Train Loss: 0.0406865  Vali Loss: 0.0605473 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817839  Vali macro F1 0.9722451 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 6.118359088897705
VALI: Epoch: 82, Steps: 70 | Train Loss: 0.0389874  Vali Loss: 0.0602031 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9812819  Vali macro F1 0.9714157 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 6.109579801559448
VALI: Epoch: 83, Steps: 70 | Train Loss: 0.0397499  Vali Loss: 0.0581943 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828003  Vali macro F1 0.9735769 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 84 cost time: 6.11087703704834
VALI: Epoch: 84, Steps: 70 | Train Loss: 0.0360103  Vali Loss: 0.0578385 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828003  Vali macro F1 0.9735769 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 6.113413333892822
VALI: Epoch: 85, Steps: 70 | Train Loss: 0.0355872  Vali Loss: 0.0587869 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9822991  Vali macro F1 0.9727480 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 6.115896224975586
VALI: Epoch: 86, Steps: 70 | Train Loss: 0.0379028  Vali Loss: 0.0581673 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817850  Vali macro F1 0.9722657 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 6.136599063873291
VALI: Epoch: 87, Steps: 70 | Train Loss: 0.0382048  Vali Loss: 0.0583015 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9822991  Vali macro F1 0.9727480 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 88 cost time: 6.142309665679932
VALI: Epoch: 88, Steps: 70 | Train Loss: 0.0372056  Vali Loss: 0.0580774 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817850  Vali macro F1 0.9722657 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 89 cost time: 6.109744548797607
VALI: Epoch: 89, Steps: 70 | Train Loss: 0.0372752  Vali Loss: 0.0580188 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817850  Vali macro F1 0.9722657 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 6.097059488296509
VALI: Epoch: 90, Steps: 70 | Train Loss: 0.0388904  Vali Loss: 0.0580992 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817850  Vali macro F1 0.9722657 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 91 cost time: 6.099682569503784
VALI: Epoch: 91, Steps: 70 | Train Loss: 0.0356523  Vali Loss: 0.0581351 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817850  Vali macro F1 0.9722657 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 92 cost time: 6.10819673538208
VALI: Epoch: 92, Steps: 70 | Train Loss: 0.0380640  Vali Loss: 0.0581389 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817850  Vali macro F1 0.9722657 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 93 cost time: 6.122820854187012
VALI: Epoch: 93, Steps: 70 | Train Loss: 0.0393095  Vali Loss: 0.0582682 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817850  Vali macro F1 0.9722657 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8729604  Test weighted F1: 0.8775956  Test macro F1 0.8550505 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.172208786010742
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0402164  Vali Loss: 0.0586471 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9808007  Vali macro F1 0.9711493 
Validation loss decreased (inf --> 0.058647).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.136745929718018
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0383694  Vali Loss: 0.0622630 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818078  Vali macro F1 0.9729300 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.1324193477630615
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0396509  Vali Loss: 0.0596267 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9808283  Vali macro F1 0.9708241 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.119930744171143
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0373836  Vali Loss: 0.0594824 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817987  Vali macro F1 0.9726734 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.139703989028931
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0375798  Vali Loss: 0.0605438 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9812763  Vali macro F1 0.9714083 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.124516010284424
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0382907  Vali Loss: 0.0583890 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9827875  Vali macro F1 0.9728816 
new best score!!!!
Validation loss decreased (0.058647 --> 0.058389).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.14778995513916
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0371732  Vali Loss: 0.0615884 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9813796  Vali macro F1 0.9722373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.158377408981323
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0405591  Vali Loss: 0.0542126 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9822244  Vali macro F1 0.9718454 
new best score!!!!
Validation loss decreased (0.058389 --> 0.054213).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.141610622406006
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0387307  Vali Loss: 0.0596513 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817783  Vali macro F1 0.9722385 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.1303229331970215
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0368876  Vali Loss: 0.0594920 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9831960  Vali macro F1 0.9722172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.132625341415405
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0409495  Vali Loss: 0.0616038 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823525  Vali macro F1 0.9733330 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.128647089004517
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0377049  Vali Loss: 0.0623294 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823090  Vali macro F1 0.9733564 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.123802661895752
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0389840  Vali Loss: 0.0622093 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9812946  Vali macro F1 0.9711787 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.155052661895752
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0358725  Vali Loss: 0.0594652 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9812946  Vali macro F1 0.9711787 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.147592306137085
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0358936  Vali Loss: 0.0585383 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9813109  Vali macro F1 0.9722115 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.139124631881714
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0376387  Vali Loss: 0.0594704 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9813033  Vali macro F1 0.9719367 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.148911237716675
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0355926  Vali Loss: 0.0591939 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9813033  Vali macro F1 0.9719367 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.1334147453308105
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0364442  Vali Loss: 0.0585715 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832859  Vali macro F1 0.9742591 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 19 cost time: 6.13598370552063
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0349892  Vali Loss: 0.0585475 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832859  Vali macro F1 0.9742591 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.136953353881836
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0391594  Vali Loss: 0.0583844 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9827860  Vali macro F1 0.9736763 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.16060209274292
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0343621  Vali Loss: 0.0583861 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9827860  Vali macro F1 0.9736763 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.148455619812012
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0370629  Vali Loss: 0.0584129 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9827860  Vali macro F1 0.9736763 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.141904830932617
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0338209  Vali Loss: 0.0584395 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9822979  Vali macro F1 0.9732335 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8744845  Test weighted F1: 0.8789459  Test macro F1 0.8582694 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014881 0.00018454 0.00100503 0.00125313 0.00051787 0.00062112]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.04616641998291
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.4908668  Vali Loss: 1.0607671 Vali Accuracy: 0.7198764  Vali weighted F1: 0.6357767  Vali macro F1 0.4088984 
Validation loss decreased (inf --> 1.060767).  Saving model ...
Epoch: 2 cost time: 6.043792009353638
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.8420529  Vali Loss: 0.6471862 Vali Accuracy: 0.7579815  Vali weighted F1: 0.6916355  Vali macro F1 0.4717410 
new best score!!!!
Validation loss decreased (1.060767 --> 0.647186).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.044696807861328
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.6139565  Vali Loss: 0.5193508 Vali Accuracy: 0.8228630  Vali weighted F1: 0.7908168  Vali macro F1 0.7087901 
new best score!!!!
Validation loss decreased (0.647186 --> 0.519351).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.059703350067139
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.5145979  Vali Loss: 0.4705352 Vali Accuracy: 0.8388260  Vali weighted F1: 0.8195693  Vali macro F1 0.7562487 
new best score!!!!
Validation loss decreased (0.519351 --> 0.470535).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.053622007369995
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.4615680  Vali Loss: 0.4031718 Vali Accuracy: 0.8645726  Vali weighted F1: 0.8599712  Vali macro F1 0.8077334 
new best score!!!!
Validation loss decreased (0.470535 --> 0.403172).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.045281648635864
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.4005672  Vali Loss: 0.3866532 Vali Accuracy: 0.8681771  Vali weighted F1: 0.8659586  Vali macro F1 0.8097301 
new best score!!!!
Validation loss decreased (0.403172 --> 0.386653).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.047889947891235
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.3414573  Vali Loss: 0.3199196 Vali Accuracy: 0.8975283  Vali weighted F1: 0.8895848  Vali macro F1 0.8434592 
new best score!!!!
Validation loss decreased (0.386653 --> 0.319920).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.0534045696258545
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.2985890  Vali Loss: 0.2350739 Vali Accuracy: 0.9258496  Vali weighted F1: 0.9257966  Vali macro F1 0.8879195 
new best score!!!!
Validation loss decreased (0.319920 --> 0.235074).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.053254127502441
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.2599536  Vali Loss: 0.2283595 Vali Accuracy: 0.9263646  Vali weighted F1: 0.9262599  Vali macro F1 0.8871447 
new best score!!!!
Validation loss decreased (0.235074 --> 0.228360).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.058931827545166
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.2427585  Vali Loss: 0.2069441 Vali Accuracy: 0.9273944  Vali weighted F1: 0.9281116  Vali macro F1 0.8894814 
new best score!!!!
Validation loss decreased (0.228360 --> 0.206944).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.066037893295288
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.2284201  Vali Loss: 0.1891698 Vali Accuracy: 0.9361483  Vali weighted F1: 0.9360553  Vali macro F1 0.8954950 
new best score!!!!
Validation loss decreased (0.206944 --> 0.189170).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.040105819702148
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.2222217  Vali Loss: 0.1842561 Vali Accuracy: 0.9387230  Vali weighted F1: 0.9393346  Vali macro F1 0.9117168 
new best score!!!!
Validation loss decreased (0.189170 --> 0.184256).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.055053949356079
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1997052  Vali Loss: 0.1706250 Vali Accuracy: 0.9433574  Vali weighted F1: 0.9437573  Vali macro F1 0.9172027 
new best score!!!!
Validation loss decreased (0.184256 --> 0.170625).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.061955213546753
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1939013  Vali Loss: 0.1636747 Vali Accuracy: 0.9449022  Vali weighted F1: 0.9447358  Vali macro F1 0.9135639 
new best score!!!!
Validation loss decreased (0.170625 --> 0.163675).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.050496816635132
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1843445  Vali Loss: 0.1643921 Vali Accuracy: 0.9474768  Vali weighted F1: 0.9475576  Vali macro F1 0.9222749 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.0435779094696045
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1787146  Vali Loss: 0.2038280 Vali Accuracy: 0.9356334  Vali weighted F1: 0.9364398  Vali macro F1 0.9098569 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.071747064590454
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1684491  Vali Loss: 0.1602690 Vali Accuracy: 0.9454171  Vali weighted F1: 0.9463720  Vali macro F1 0.9201112 
new best score!!!!
Validation loss decreased (0.163675 --> 0.160269).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.080102443695068
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.1615759  Vali Loss: 0.1655730 Vali Accuracy: 0.9454171  Vali weighted F1: 0.9447434  Vali macro F1 0.9244992 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.046356201171875
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.1585958  Vali Loss: 0.1359523 Vali Accuracy: 0.9567456  Vali weighted F1: 0.9565083  Vali macro F1 0.9355157 
new best score!!!!
Validation loss decreased (0.160269 --> 0.135952).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.052981853485107
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.1507150  Vali Loss: 0.1466764 Vali Accuracy: 0.9490216  Vali weighted F1: 0.9479087  Vali macro F1 0.9271409 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.043128728866577
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.1488916  Vali Loss: 0.1558689 Vali Accuracy: 0.9490216  Vali weighted F1: 0.9485785  Vali macro F1 0.9307642 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.046806335449219
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.1373376  Vali Loss: 0.1395679 Vali Accuracy: 0.9531411  Vali weighted F1: 0.9522657  Vali macro F1 0.9290964 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.060063362121582
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.1374445  Vali Loss: 0.1327266 Vali Accuracy: 0.9567456  Vali weighted F1: 0.9574358  Vali macro F1 0.9391092 
new best score!!!!
Validation loss decreased (0.135952 --> 0.132727).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.070396900177002
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.1305873  Vali Loss: 0.1324313 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9547557  Vali macro F1 0.9258501 
new best score!!!!
Validation loss decreased (0.132727 --> 0.132431).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.0725767612457275
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.1279101  Vali Loss: 0.1398102 Vali Accuracy: 0.9510814  Vali weighted F1: 0.9519885  Vali macro F1 0.9334887 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.055765151977539
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.1232414  Vali Loss: 0.1379856 Vali Accuracy: 0.9526262  Vali weighted F1: 0.9521675  Vali macro F1 0.9337938 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.039346694946289
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.1205538  Vali Loss: 0.1203982 Vali Accuracy: 0.9613800  Vali weighted F1: 0.9617353  Vali macro F1 0.9451977 
new best score!!!!
Validation loss decreased (0.132431 --> 0.120398).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.055712938308716
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.1139066  Vali Loss: 0.1145763 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9608682  Vali macro F1 0.9444468 
new best score!!!!
Validation loss decreased (0.120398 --> 0.114576).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.052558660507202
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.1183710  Vali Loss: 0.1197962 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9594280  Vali macro F1 0.9383080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.044461488723755
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.1121249  Vali Loss: 0.1431238 Vali Accuracy: 0.9526262  Vali weighted F1: 0.9541552  Vali macro F1 0.9378065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.060792684555054
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.1117806  Vali Loss: 0.1160745 Vali Accuracy: 0.9598352  Vali weighted F1: 0.9602102  Vali macro F1 0.9442250 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.065986394882202
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.1108403  Vali Loss: 0.1298169 Vali Accuracy: 0.9552008  Vali weighted F1: 0.9555382  Vali macro F1 0.9344596 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.055789947509766
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.1063122  Vali Loss: 0.1464757 Vali Accuracy: 0.9515963  Vali weighted F1: 0.9530104  Vali macro F1 0.9316010 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 6.053419351577759
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0979699  Vali Loss: 0.1069588 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9641931  Vali macro F1 0.9485280 
new best score!!!!
Validation loss decreased (0.114576 --> 0.106959).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.061074733734131
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0914871  Vali Loss: 0.1050813 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9640753  Vali macro F1 0.9483018 
new best score!!!!
Validation loss decreased (0.106959 --> 0.105081).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.046464204788208
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0924654  Vali Loss: 0.1042367 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9642576  Vali macro F1 0.9480149 
new best score!!!!
Validation loss decreased (0.105081 --> 0.104237).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.055929660797119
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0900868  Vali Loss: 0.1073871 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9638197  Vali macro F1 0.9475024 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.0759947299957275
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0875052  Vali Loss: 0.1025461 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9651920  Vali macro F1 0.9495483 
new best score!!!!
Validation loss decreased (0.104237 --> 0.102546).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.067354440689087
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0886121  Vali Loss: 0.1067950 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9638016  Vali macro F1 0.9473594 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.052659273147583
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0882421  Vali Loss: 0.1096561 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9634313  Vali macro F1 0.9478299 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.052444219589233
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0876179  Vali Loss: 0.1010045 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9658238  Vali macro F1 0.9498267 
new best score!!!!
Validation loss decreased (0.102546 --> 0.101005).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.061679840087891
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0889305  Vali Loss: 0.1011891 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9667159  Vali macro F1 0.9507261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.0632407665252686
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0862159  Vali Loss: 0.1032523 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9647049  Vali macro F1 0.9486827 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.079111099243164
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0851663  Vali Loss: 0.1023720 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9637190  Vali macro F1 0.9464982 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.0699169635772705
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0824069  Vali Loss: 0.0990850 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9667736  Vali macro F1 0.9510746 
new best score!!!!
Validation loss decreased (0.101005 --> 0.099085).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.064725637435913
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0882325  Vali Loss: 0.0995384 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9667951  Vali macro F1 0.9507090 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.06708025932312
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0857795  Vali Loss: 0.1042854 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9648262  Vali macro F1 0.9485736 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.064709663391113
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0857022  Vali Loss: 0.0986275 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9671843  Vali macro F1 0.9516182 
new best score!!!!
Validation loss decreased (0.099085 --> 0.098628).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.0589423179626465
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0850123  Vali Loss: 0.1016428 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9653588  Vali macro F1 0.9503570 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.065250635147095
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0847953  Vali Loss: 0.0983610 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9672771  Vali macro F1 0.9515159 
new best score!!!!
Validation loss decreased (0.098628 --> 0.098361).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.084469556808472
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0852178  Vali Loss: 0.0993522 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9651333  Vali macro F1 0.9493172 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.086993932723999
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0820646  Vali Loss: 0.1016803 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9631377  Vali macro F1 0.9457122 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.073583602905273
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0842206  Vali Loss: 0.1054135 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9647837  Vali macro F1 0.9477457 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.074879884719849
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0817127  Vali Loss: 0.1041048 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9647080  Vali macro F1 0.9477921 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.071573495864868
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0828954  Vali Loss: 0.1037407 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9646728  Vali macro F1 0.9480240 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 6.063730716705322
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0816157  Vali Loss: 0.1003981 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9638878  Vali macro F1 0.9467270 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.076678037643433
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0821433  Vali Loss: 0.1004638 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9647798  Vali macro F1 0.9482610 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.097095489501953
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0819415  Vali Loss: 0.0995131 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9649768  Vali macro F1 0.9479793 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.075109004974365
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0835595  Vali Loss: 0.1011586 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9639266  Vali macro F1 0.9464326 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.0741424560546875
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0829864  Vali Loss: 0.1015748 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9639266  Vali macro F1 0.9464326 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.068484544754028
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0823096  Vali Loss: 0.1014218 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9639266  Vali macro F1 0.9464326 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.071083307266235
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0815508  Vali Loss: 0.1012791 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9639266  Vali macro F1 0.9464326 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.066445350646973
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0826549  Vali Loss: 0.1011813 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9639266  Vali macro F1 0.9464326 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.0885632038116455
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0798733  Vali Loss: 0.1010322 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9639266  Vali macro F1 0.9464326 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.062256813049316
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0819236  Vali Loss: 0.1009406 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9639266  Vali macro F1 0.9464326 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9539548  Test weighted F1: 0.9523098  Test macro F1 0.9313950 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.087063312530518
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0841707  Vali Loss: 0.1034792 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9646547  Vali macro F1 0.9492831 
Validation loss decreased (inf --> 0.103479).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.075082540512085
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0841747  Vali Loss: 0.1045617 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9641385  Vali macro F1 0.9476963 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.07761287689209
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0846489  Vali Loss: 0.1002436 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9642803  Vali macro F1 0.9483721 
new best score!!!!
Validation loss decreased (0.103479 --> 0.100244).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.078317403793335
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0845073  Vali Loss: 0.1040540 Vali Accuracy: 0.9660144  Vali weighted F1: 0.9663891  Vali macro F1 0.9501953 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.1143410205841064
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0822546  Vali Loss: 0.0988790 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9669436  Vali macro F1 0.9506821 
new best score!!!!
Validation loss decreased (0.100244 --> 0.098879).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.082642555236816
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0850539  Vali Loss: 0.1032346 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9635369  Vali macro F1 0.9457345 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.0729944705963135
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0811134  Vali Loss: 0.1079773 Vali Accuracy: 0.9624099  Vali weighted F1: 0.9627353  Vali macro F1 0.9459292 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.083201885223389
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0827059  Vali Loss: 0.1046730 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9635392  Vali macro F1 0.9468014 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.0765135288238525
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0816012  Vali Loss: 0.0987396 Vali Accuracy: 0.9660144  Vali weighted F1: 0.9660603  Vali macro F1 0.9500733 
new best score!!!!
Validation loss decreased (0.098879 --> 0.098740).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.0951011180877686
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0840356  Vali Loss: 0.0969371 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9684050  Vali macro F1 0.9528120 
new best score!!!!
Validation loss decreased (0.098740 --> 0.096937).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.078160047531128
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0811555  Vali Loss: 0.1016007 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9654502  Vali macro F1 0.9506557 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.099445819854736
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0782321  Vali Loss: 0.1051482 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9659686  Vali macro F1 0.9495932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.0701189041137695
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0786420  Vali Loss: 0.1033204 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9660345  Vali macro F1 0.9514469 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.08545446395874
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0785576  Vali Loss: 0.1099799 Vali Accuracy: 0.9624099  Vali weighted F1: 0.9629976  Vali macro F1 0.9451181 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.081772804260254
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0790202  Vali Loss: 0.1042060 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9649871  Vali macro F1 0.9490289 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 6.081704378128052
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0790944  Vali Loss: 0.0984928 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678019  Vali macro F1 0.9521904 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.074252605438232
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0801091  Vali Loss: 0.0971810 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9658132  Vali macro F1 0.9500567 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.088427782058716
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0784007  Vali Loss: 0.0992646 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9669114  Vali macro F1 0.9497652 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.094201326370239
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0794215  Vali Loss: 0.0970068 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9674060  Vali macro F1 0.9515342 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.074404716491699
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0772897  Vali Loss: 0.1017972 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9644426  Vali macro F1 0.9474412 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.073978424072266
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0766478  Vali Loss: 0.0990406 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9668935  Vali macro F1 0.9512584 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.079581260681152
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0759891  Vali Loss: 0.0983953 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9669231  Vali macro F1 0.9510088 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.086496353149414
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0756209  Vali Loss: 0.0993101 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9668005  Vali macro F1 0.9514589 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.078242778778076
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0745410  Vali Loss: 0.0987744 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9673550  Vali macro F1 0.9514236 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.091285228729248
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0765396  Vali Loss: 0.0967277 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9668657  Vali macro F1 0.9509275 
new best score!!!!
Validation loss decreased (0.096937 --> 0.096728).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.088155031204224
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0749211  Vali Loss: 0.0979424 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9673166  Vali macro F1 0.9517033 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.078588247299194
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0768784  Vali Loss: 0.0971002 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9668657  Vali macro F1 0.9509275 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.076733112335205
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0734513  Vali Loss: 0.0981334 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9673739  Vali macro F1 0.9517993 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.0747411251068115
Fine Tuning VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0760055  Vali Loss: 0.0979346 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9673451  Vali macro F1 0.9520509 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.085459232330322
Fine Tuning VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0749229  Vali Loss: 0.0980638 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9674116  Vali macro F1 0.9515196 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 6.0904717445373535
Fine Tuning VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0757117  Vali Loss: 0.0980005 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9673839  Vali macro F1 0.9517714 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.093311786651611
Fine Tuning VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0756596  Vali Loss: 0.0980082 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.077576637268066
Fine Tuning VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0752237  Vali Loss: 0.0979691 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.0821332931518555
Fine Tuning VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0757782  Vali Loss: 0.0978630 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.084776878356934
Fine Tuning VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0775745  Vali Loss: 0.0978760 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 36 cost time: 6.082360744476318
Fine Tuning VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0731697  Vali Loss: 0.0978628 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.086135149002075
Fine Tuning VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0758803  Vali Loss: 0.0978632 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.100882291793823
Fine Tuning VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0737174  Vali Loss: 0.0978498 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.095448017120361
Fine Tuning VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0760934  Vali Loss: 0.0978374 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.0670998096466064
Fine Tuning VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0737655  Vali Loss: 0.0978176 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9678627  Vali macro F1 0.9522957 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9503005  Test weighted F1: 0.9485435  Test macro F1 0.9268604 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00015069 0.00018522 0.00137552 0.001443   0.00053476 0.00064267]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.838122129440308
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.5039295  Vali Loss: 1.1557141 Vali Accuracy: 0.6817697  Vali weighted F1: 0.5727425  Vali macro F1 0.2758735 
Validation loss decreased (inf --> 1.155714).  Saving model ...
Epoch: 2 cost time: 5.820590257644653
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.8844841  Vali Loss: 0.7328378 Vali Accuracy: 0.7260128  Vali weighted F1: 0.6582929  Vali macro F1 0.3417236 
new best score!!!!
Validation loss decreased (1.155714 --> 0.732838).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.81766676902771
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.6591964  Vali Loss: 0.6042264 Vali Accuracy: 0.7921109  Vali weighted F1: 0.7507211  Vali macro F1 0.5417785 
new best score!!!!
Validation loss decreased (0.732838 --> 0.604226).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.85873556137085
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.5461867  Vali Loss: 0.5188057 Vali Accuracy: 0.8038380  Vali weighted F1: 0.7775106  Vali macro F1 0.5783609 
new best score!!!!
Validation loss decreased (0.604226 --> 0.518806).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.849576711654663
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.4991644  Vali Loss: 0.4959968 Vali Accuracy: 0.8043710  Vali weighted F1: 0.7701157  Vali macro F1 0.5669866 
new best score!!!!
Validation loss decreased (0.518806 --> 0.495997).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.833673715591431
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.4669353  Vali Loss: 0.4493777 Vali Accuracy: 0.8230277  Vali weighted F1: 0.7983419  Vali macro F1 0.5975399 
new best score!!!!
Validation loss decreased (0.495997 --> 0.449378).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.837506532669067
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.4380475  Vali Loss: 0.4180105 Vali Accuracy: 0.8326226  Vali weighted F1: 0.8103610  Vali macro F1 0.6122653 
new best score!!!!
Validation loss decreased (0.449378 --> 0.418011).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.834131479263306
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.3973809  Vali Loss: 0.3693585 Vali Accuracy: 0.8566098  Vali weighted F1: 0.8382590  Vali macro F1 0.6431188 
new best score!!!!
Validation loss decreased (0.418011 --> 0.369359).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.824853897094727
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.3447204  Vali Loss: 0.3066967 Vali Accuracy: 0.8992537  Vali weighted F1: 0.8941559  Vali macro F1 0.8559440 
new best score!!!!
Validation loss decreased (0.369359 --> 0.306697).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.836544752120972
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.2811107  Vali Loss: 0.2627884 Vali Accuracy: 0.9200426  Vali weighted F1: 0.9174266  Vali macro F1 0.8892296 
new best score!!!!
Validation loss decreased (0.306697 --> 0.262788).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.8550028800964355
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.2521542  Vali Loss: 0.2441372 Vali Accuracy: 0.9227079  Vali weighted F1: 0.9209653  Vali macro F1 0.8935177 
new best score!!!!
Validation loss decreased (0.262788 --> 0.244137).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.84006929397583
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.2287009  Vali Loss: 0.2249108 Vali Accuracy: 0.9301706  Vali weighted F1: 0.9281634  Vali macro F1 0.9021374 
new best score!!!!
Validation loss decreased (0.244137 --> 0.224911).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.834407091140747
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.2163866  Vali Loss: 0.2102086 Vali Accuracy: 0.9333689  Vali weighted F1: 0.9328907  Vali macro F1 0.9096697 
new best score!!!!
Validation loss decreased (0.224911 --> 0.210209).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.84177827835083
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.2019170  Vali Loss: 0.2246982 Vali Accuracy: 0.9248401  Vali weighted F1: 0.9244173  Vali macro F1 0.8979142 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.842534780502319
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1956303  Vali Loss: 0.2271919 Vali Accuracy: 0.9275053  Vali weighted F1: 0.9258391  Vali macro F1 0.9011714 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.8384153842926025
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1843748  Vali Loss: 0.2087288 Vali Accuracy: 0.9317697  Vali weighted F1: 0.9299763  Vali macro F1 0.9049393 
new best score!!!!
Validation loss decreased (0.210209 --> 0.208729).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.8455810546875
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1785002  Vali Loss: 0.1932363 Vali Accuracy: 0.9360341  Vali weighted F1: 0.9348945  Vali macro F1 0.9110132 
new best score!!!!
Validation loss decreased (0.208729 --> 0.193236).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.8642847537994385
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1701061  Vali Loss: 0.2061093 Vali Accuracy: 0.9365672  Vali weighted F1: 0.9355618  Vali macro F1 0.9166755 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.845103740692139
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.1631340  Vali Loss: 0.1949909 Vali Accuracy: 0.9376333  Vali weighted F1: 0.9373880  Vali macro F1 0.9141328 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.840023994445801
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.1635876  Vali Loss: 0.1823511 Vali Accuracy: 0.9445629  Vali weighted F1: 0.9433392  Vali macro F1 0.9272946 
new best score!!!!
Validation loss decreased (0.193236 --> 0.182351).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.842442512512207
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.1544989  Vali Loss: 0.1725340 Vali Accuracy: 0.9482942  Vali weighted F1: 0.9475560  Vali macro F1 0.9344392 
new best score!!!!
Validation loss decreased (0.182351 --> 0.172534).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.830198526382446
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.1491663  Vali Loss: 0.1598204 Vali Accuracy: 0.9493603  Vali weighted F1: 0.9485384  Vali macro F1 0.9357480 
new best score!!!!
Validation loss decreased (0.172534 --> 0.159820).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.833587646484375
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.1402743  Vali Loss: 0.1670199 Vali Accuracy: 0.9466951  Vali weighted F1: 0.9457526  Vali macro F1 0.9316081 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.833108425140381
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.1371474  Vali Loss: 0.1652739 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9467129  Vali macro F1 0.9337621 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.8536248207092285
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.1354350  Vali Loss: 0.1433661 Vali Accuracy: 0.9520256  Vali weighted F1: 0.9516483  Vali macro F1 0.9394012 
new best score!!!!
Validation loss decreased (0.159820 --> 0.143366).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.85209846496582
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.1371280  Vali Loss: 0.1560795 Vali Accuracy: 0.9525586  Vali weighted F1: 0.9518895  Vali macro F1 0.9407374 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.838254928588867
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.1319564  Vali Loss: 0.1349429 Vali Accuracy: 0.9578891  Vali weighted F1: 0.9574964  Vali macro F1 0.9478340 
new best score!!!!
Validation loss decreased (0.143366 --> 0.134943).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.82685661315918
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.1265809  Vali Loss: 0.1464951 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9475950  Vali macro F1 0.9355778 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.828041315078735
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.1201340  Vali Loss: 0.1342059 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9571613  Vali macro F1 0.9449593 
new best score!!!!
Validation loss decreased (0.134943 --> 0.134206).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.836408853530884
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.1188207  Vali Loss: 0.1401720 Vali Accuracy: 0.9568230  Vali weighted F1: 0.9560918  Vali macro F1 0.9428472 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.843559980392456
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.1133599  Vali Loss: 0.1611141 Vali Accuracy: 0.9493603  Vali weighted F1: 0.9480095  Vali macro F1 0.9322250 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.867491006851196
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.1129420  Vali Loss: 0.1424492 Vali Accuracy: 0.9536247  Vali weighted F1: 0.9533205  Vali macro F1 0.9370773 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.850579023361206
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.1095405  Vali Loss: 0.1240006 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9603689  Vali macro F1 0.9496670 
new best score!!!!
Validation loss decreased (0.134206 --> 0.124001).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.839493036270142
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.1081825  Vali Loss: 0.1665584 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9460743  Vali macro F1 0.9309341 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.831048250198364
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.1165879  Vali Loss: 0.1327513 Vali Accuracy: 0.9536247  Vali weighted F1: 0.9525647  Vali macro F1 0.9313887 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.833138704299927
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.1068827  Vali Loss: 0.1314735 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9546712  Vali macro F1 0.9433222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.832479953765869
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0995210  Vali Loss: 0.1141017 Vali Accuracy: 0.9589552  Vali weighted F1: 0.9589710  Vali macro F1 0.9463181 
new best score!!!!
Validation loss decreased (0.124001 --> 0.114102).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.847042560577393
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0951580  Vali Loss: 0.1144038 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9614308  Vali macro F1 0.9519659 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.857481479644775
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0978988  Vali Loss: 0.1033709 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9635442  Vali macro F1 0.9539372 
new best score!!!!
Validation loss decreased (0.114102 --> 0.103371).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.861122131347656
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0952879  Vali Loss: 0.1079731 Vali Accuracy: 0.9642857  Vali weighted F1: 0.9641005  Vali macro F1 0.9567747 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.839545488357544
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0910713  Vali Loss: 0.1172067 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9605116  Vali macro F1 0.9477491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.839245796203613
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0853517  Vali Loss: 0.1046644 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9667227  Vali macro F1 0.9591161 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.831937789916992
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0888054  Vali Loss: 0.1104572 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9654593  Vali macro F1 0.9511907 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.833069086074829
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0907545  Vali Loss: 0.1015633 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9646154  Vali macro F1 0.9444950 
new best score!!!!
Validation loss decreased (0.103371 --> 0.101563).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.839682102203369
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0846158  Vali Loss: 0.1318556 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9577744  Vali macro F1 0.9459169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.848448276519775
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0824558  Vali Loss: 0.0995384 Vali Accuracy: 0.9632196  Vali weighted F1: 0.9631574  Vali macro F1 0.9527347 
new best score!!!!
Validation loss decreased (0.101563 --> 0.099538).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.858735799789429
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0801854  Vali Loss: 0.1061099 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9671459  Vali macro F1 0.9569669 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.8385374546051025
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0801287  Vali Loss: 0.0858171 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9722428  Vali macro F1 0.9655290 
new best score!!!!
Validation loss decreased (0.099538 --> 0.085817).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 5.840303897857666
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0819782  Vali Loss: 0.1373996 Vali Accuracy: 0.9557569  Vali weighted F1: 0.9549245  Vali macro F1 0.9358809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.838107109069824
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0816934  Vali Loss: 0.1034155 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9665684  Vali macro F1 0.9569618 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.83022141456604
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0775387  Vali Loss: 0.1231582 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9576765  Vali macro F1 0.9465586 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.836855411529541
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0731209  Vali Loss: 0.1026318 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9713318  Vali macro F1 0.9618809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.843796968460083
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0732373  Vali Loss: 0.0897200 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9711088  Vali macro F1 0.9629140 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 5.871859073638916
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0629223  Vali Loss: 0.0898973 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9701633  Vali macro F1 0.9613563 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.842525959014893
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0610635  Vali Loss: 0.0896726 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9737767  Vali macro F1 0.9653718 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 5.84139084815979
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0626774  Vali Loss: 0.0915700 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9727632  Vali macro F1 0.9640542 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 5.832349538803101
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0610568  Vali Loss: 0.0912915 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9726999  Vali macro F1 0.9640993 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 5.840226650238037
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0615975  Vali Loss: 0.0868148 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9732748  Vali macro F1 0.9645630 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 59 cost time: 5.837899446487427
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0596643  Vali Loss: 0.0880198 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9737767  Vali macro F1 0.9653718 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 5.8488450050354
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0592553  Vali Loss: 0.0877907 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9737767  Vali macro F1 0.9653718 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 5.857141971588135
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0590714  Vali Loss: 0.0881514 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9737767  Vali macro F1 0.9653718 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 5.849329471588135
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0577128  Vali Loss: 0.0884137 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9737891  Vali macro F1 0.9657158 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 5.832982063293457
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0590094  Vali Loss: 0.0885037 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9743077  Vali macro F1 0.9661924 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8931454  Test weighted F1: 0.8988898  Test macro F1 0.8612792 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.871588945388794
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0709219  Vali Loss: 0.0897631 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9720855  Vali macro F1 0.9650632 
Validation loss decreased (inf --> 0.089763).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.850861072540283
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0681403  Vali Loss: 0.0889703 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9716157  Vali macro F1 0.9626797 
new best score!!!!
Validation loss decreased (0.089763 --> 0.088970).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.847080230712891
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0676231  Vali Loss: 0.0914443 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9688146  Vali macro F1 0.9599294 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.852766990661621
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0670354  Vali Loss: 0.0871022 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721796  Vali macro F1 0.9639329 
new best score!!!!
Validation loss decreased (0.088970 --> 0.087102).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 5.87650203704834
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0654766  Vali Loss: 0.0909233 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721418  Vali macro F1 0.9633731 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 5.860465049743652
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0678418  Vali Loss: 0.0898536 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9704957  Vali macro F1 0.9613823 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 5.857061862945557
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0647674  Vali Loss: 0.0863101 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9717546  Vali macro F1 0.9635711 
new best score!!!!
Validation loss decreased (0.087102 --> 0.086310).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 5.857860803604126
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0658508  Vali Loss: 0.0901890 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9705197  Vali macro F1 0.9615832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 5.8459813594818115
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0626933  Vali Loss: 0.0862416 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721950  Vali macro F1 0.9643249 
new best score!!!!
Validation loss decreased (0.086310 --> 0.086242).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 5.855348587036133
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0662362  Vali Loss: 0.0946161 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9701457  Vali macro F1 0.9601807 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 5.856246709823608
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0614668  Vali Loss: 0.0874826 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9732499  Vali macro F1 0.9656589 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 5.865882158279419
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0657261  Vali Loss: 0.0890173 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9732500  Vali macro F1 0.9650507 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 5.87238073348999
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0631696  Vali Loss: 0.0855000 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9727892  Vali macro F1 0.9649821 
new best score!!!!
Validation loss decreased (0.086242 --> 0.085500).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 5.860236167907715
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0615231  Vali Loss: 0.0832277 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9717976  Vali macro F1 0.9634748 
new best score!!!!
Validation loss decreased (0.085500 --> 0.083228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 5.856419801712036
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0630840  Vali Loss: 0.0931749 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9715270  Vali macro F1 0.9628210 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 5.8535990715026855
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0643540  Vali Loss: 0.0897574 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721578  Vali macro F1 0.9641520 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 5.853875398635864
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0608106  Vali Loss: 0.0904103 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721589  Vali macro F1 0.9643027 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 5.8566975593566895
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0622340  Vali Loss: 0.0968079 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9699765  Vali macro F1 0.9588609 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 5.890131950378418
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0640161  Vali Loss: 0.0924138 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9710618  Vali macro F1 0.9619681 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 20 cost time: 5.899150609970093
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0613821  Vali Loss: 0.0868542 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9716738  Vali macro F1 0.9638152 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 5.860241174697876
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0615746  Vali Loss: 0.0907242 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9700877  Vali macro F1 0.9614268 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 5.849694490432739
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0616666  Vali Loss: 0.0887864 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9732649  Vali macro F1 0.9660071 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 5.858825206756592
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0597125  Vali Loss: 0.0878034 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721237  Vali macro F1 0.9642788 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 5.856015205383301
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0611588  Vali Loss: 0.0953847 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9689469  Vali macro F1 0.9595497 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 5.852401494979858
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0588185  Vali Loss: 0.0888116 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721867  Vali macro F1 0.9639709 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 5.874971628189087
Fine Tuning VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0582528  Vali Loss: 0.0883579 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9727032  Vali macro F1 0.9644910 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 5.871382713317871
Fine Tuning VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0571691  Vali Loss: 0.0885903 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9727228  Vali macro F1 0.9648728 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 5.866137504577637
Fine Tuning VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0603012  Vali Loss: 0.0888091 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721854  Vali macro F1 0.9640151 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 5.857443571090698
Fine Tuning VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0565544  Vali Loss: 0.0891600 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9727050  Vali macro F1 0.9644471 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8807175  Test weighted F1: 0.8888714  Test macro F1 0.8536012 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00014231 0.00018433 0.00095329 0.00125471 0.00053248 0.00064185]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.135124683380127
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4761679  Vali Loss: 1.0893235 Vali Accuracy: 0.7082699  Vali weighted F1: 0.6180981  Vali macro F1 0.4057656 
Validation loss decreased (inf --> 1.089324).  Saving model ...
Epoch: 2 cost time: 6.133675813674927
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8220874  Vali Loss: 0.6891915 Vali Accuracy: 0.7402334  Vali weighted F1: 0.6790675  Vali macro F1 0.4810996 
new best score!!!!
Validation loss decreased (1.089324 --> 0.689191).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.141426086425781
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5768523  Vali Loss: 0.5251657 Vali Accuracy: 0.8193810  Vali weighted F1: 0.7817603  Vali macro F1 0.7072887 
new best score!!!!
Validation loss decreased (0.689191 --> 0.525166).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.153199911117554
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4678857  Vali Loss: 0.4922590 Vali Accuracy: 0.8330797  Vali weighted F1: 0.8326264  Vali macro F1 0.7810603 
new best score!!!!
Validation loss decreased (0.525166 --> 0.492259).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.154303789138794
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3896210  Vali Loss: 0.3660733 Vali Accuracy: 0.8777270  Vali weighted F1: 0.8718298  Vali macro F1 0.8109096 
new best score!!!!
Validation loss decreased (0.492259 --> 0.366073).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.14907693862915
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3217254  Vali Loss: 0.3083504 Vali Accuracy: 0.8954845  Vali weighted F1: 0.8977992  Vali macro F1 0.8529509 
new best score!!!!
Validation loss decreased (0.366073 --> 0.308350).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.145017623901367
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2955249  Vali Loss: 0.2886466 Vali Accuracy: 0.9030949  Vali weighted F1: 0.9036104  Vali macro F1 0.8615050 
new best score!!!!
Validation loss decreased (0.308350 --> 0.288647).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.142730712890625
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2592578  Vali Loss: 0.2668253 Vali Accuracy: 0.9101979  Vali weighted F1: 0.9122045  Vali macro F1 0.8752414 
new best score!!!!
Validation loss decreased (0.288647 --> 0.266825).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.145627975463867
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2404878  Vali Loss: 0.2610222 Vali Accuracy: 0.9178082  Vali weighted F1: 0.9185063  Vali macro F1 0.8819741 
new best score!!!!
Validation loss decreased (0.266825 --> 0.261022).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.160682916641235
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2235211  Vali Loss: 0.2461627 Vali Accuracy: 0.9178082  Vali weighted F1: 0.9201945  Vali macro F1 0.8843510 
new best score!!!!
Validation loss decreased (0.261022 --> 0.246163).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.159061431884766
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2079772  Vali Loss: 0.2323251 Vali Accuracy: 0.9198376  Vali weighted F1: 0.9222520  Vali macro F1 0.8899318 
new best score!!!!
Validation loss decreased (0.246163 --> 0.232325).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.15063214302063
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1922053  Vali Loss: 0.2468080 Vali Accuracy: 0.9213597  Vali weighted F1: 0.9238411  Vali macro F1 0.8941637 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.147738695144653
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1832708  Vali Loss: 0.2092385 Vali Accuracy: 0.9350583  Vali weighted F1: 0.9364063  Vali macro F1 0.9100024 
new best score!!!!
Validation loss decreased (0.232325 --> 0.209238).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.162228107452393
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1737198  Vali Loss: 0.2154342 Vali Accuracy: 0.9304921  Vali weighted F1: 0.9324046  Vali macro F1 0.9044800 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.152623414993286
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1630778  Vali Loss: 0.1944048 Vali Accuracy: 0.9386098  Vali weighted F1: 0.9399530  Vali macro F1 0.9147236 
new best score!!!!
Validation loss decreased (0.209238 --> 0.194405).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.160454750061035
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1555932  Vali Loss: 0.1887829 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9417178  Vali macro F1 0.9190166 
new best score!!!!
Validation loss decreased (0.194405 --> 0.188783).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.168401002883911
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1566610  Vali Loss: 0.1821448 Vali Accuracy: 0.9401319  Vali weighted F1: 0.9412527  Vali macro F1 0.9147708 
new best score!!!!
Validation loss decreased (0.188783 --> 0.182145).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.158189058303833
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1607777  Vali Loss: 0.1742475 Vali Accuracy: 0.9431761  Vali weighted F1: 0.9431282  Vali macro F1 0.9216138 
new best score!!!!
Validation loss decreased (0.182145 --> 0.174247).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.151809930801392
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1416436  Vali Loss: 0.1698319 Vali Accuracy: 0.9467275  Vali weighted F1: 0.9473203  Vali macro F1 0.9229976 
new best score!!!!
Validation loss decreased (0.174247 --> 0.169832).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.152041435241699
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1362017  Vali Loss: 0.1622977 Vali Accuracy: 0.9518011  Vali weighted F1: 0.9522549  Vali macro F1 0.9348253 
new best score!!!!
Validation loss decreased (0.169832 --> 0.162298).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.140210390090942
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1393022  Vali Loss: 0.1709882 Vali Accuracy: 0.9446981  Vali weighted F1: 0.9449111  Vali macro F1 0.9261629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.145959138870239
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1412818  Vali Loss: 0.1698433 Vali Accuracy: 0.9457128  Vali weighted F1: 0.9463528  Vali macro F1 0.9271164 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.135534048080444
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1290425  Vali Loss: 0.1501869 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9525998  Vali macro F1 0.9323058 
new best score!!!!
Validation loss decreased (0.162298 --> 0.150187).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.1499083042144775
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1217253  Vali Loss: 0.1620248 Vali Accuracy: 0.9467275  Vali weighted F1: 0.9478750  Vali macro F1 0.9262555 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.159954309463501
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1195072  Vali Loss: 0.1399936 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9575332  Vali macro F1 0.9445542 
new best score!!!!
Validation loss decreased (0.150187 --> 0.139994).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.13933253288269
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1184560  Vali Loss: 0.1492923 Vali Accuracy: 0.9512938  Vali weighted F1: 0.9522994  Vali macro F1 0.9368495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.152508735656738
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1146013  Vali Loss: 0.1482033 Vali Accuracy: 0.9502790  Vali weighted F1: 0.9503778  Vali macro F1 0.9276920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.140537977218628
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1110004  Vali Loss: 0.1578074 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9504785  Vali macro F1 0.9346654 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.145166635513306
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1102850  Vali Loss: 0.1288564 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9588150  Vali macro F1 0.9438279 
new best score!!!!
Validation loss decreased (0.139994 --> 0.128856).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.1493353843688965
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1102681  Vali Loss: 0.1399297 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9574455  Vali macro F1 0.9423940 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.159321308135986
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1021146  Vali Loss: 0.1382259 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9564407  Vali macro F1 0.9432391 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.149271488189697
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1057564  Vali Loss: 0.1411788 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9566869  Vali macro F1 0.9457838 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.131775379180908
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0995696  Vali Loss: 0.1409112 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9586213  Vali macro F1 0.9471698 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.1522486209869385
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0973383  Vali Loss: 0.1445468 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9535159  Vali macro F1 0.9410160 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.138845443725586
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0875468  Vali Loss: 0.1152468 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9627839  Vali macro F1 0.9538633 
new best score!!!!
Validation loss decreased (0.128856 --> 0.115247).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.145095109939575
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0839591  Vali Loss: 0.1185125 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9634063  Vali macro F1 0.9543000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.154531478881836
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0822163  Vali Loss: 0.1150741 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9627770  Vali macro F1 0.9538316 
new best score!!!!
Validation loss decreased (0.115247 --> 0.115074).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.175055503845215
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0823020  Vali Loss: 0.1156675 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9633289  Vali macro F1 0.9538627 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.167986154556274
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0818800  Vali Loss: 0.1141839 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9637700  Vali macro F1 0.9547941 
new best score!!!!
Validation loss decreased (0.115074 --> 0.114184).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.160325527191162
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0824025  Vali Loss: 0.1171199 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9634309  Vali macro F1 0.9540317 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.153326988220215
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0809385  Vali Loss: 0.1143548 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9628880  Vali macro F1 0.9534470 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.154814004898071
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0810198  Vali Loss: 0.1157691 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9615016  Vali macro F1 0.9520659 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.155269145965576
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0788647  Vali Loss: 0.1157762 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9644327  Vali macro F1 0.9550395 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.147044897079468
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0811881  Vali Loss: 0.1127087 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9643071  Vali macro F1 0.9551725 
new best score!!!!
Validation loss decreased (0.114184 --> 0.112709).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.17538046836853
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0786061  Vali Loss: 0.1146367 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9628911  Vali macro F1 0.9536808 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.162176132202148
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0780192  Vali Loss: 0.1165815 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649416  Vali macro F1 0.9561894 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.149016618728638
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0782813  Vali Loss: 0.1095265 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9667024  Vali macro F1 0.9579435 
new best score!!!!
Validation loss decreased (0.112709 --> 0.109526).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.151748180389404
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0769895  Vali Loss: 0.1141276 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9629265  Vali macro F1 0.9536962 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.141043186187744
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0781944  Vali Loss: 0.1206741 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9630823  Vali macro F1 0.9540482 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.150944232940674
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0776258  Vali Loss: 0.1122383 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9658848  Vali macro F1 0.9571243 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.149531126022339
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0779736  Vali Loss: 0.1128230 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9654423  Vali macro F1 0.9566942 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.153520345687866
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0779438  Vali Loss: 0.1164194 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9644625  Vali macro F1 0.9559889 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.164869546890259
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0764182  Vali Loss: 0.1133117 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9648355  Vali macro F1 0.9559714 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.150872707366943
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0746540  Vali Loss: 0.1128309 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9659045  Vali macro F1 0.9574485 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.156590938568115
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0760861  Vali Loss: 0.1123637 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649093  Vali macro F1 0.9558001 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.143483877182007
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0762972  Vali Loss: 0.1126653 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649093  Vali macro F1 0.9558001 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.138591051101685
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0730671  Vali Loss: 0.1133675 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9644088  Vali macro F1 0.9549644 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 6.142309904098511
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0768402  Vali Loss: 0.1132749 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9644088  Vali macro F1 0.9549644 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.1654462814331055
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0746459  Vali Loss: 0.1132326 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649093  Vali macro F1 0.9558001 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.153213024139404
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0760072  Vali Loss: 0.1131566 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649093  Vali macro F1 0.9558001 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.149980306625366
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0752317  Vali Loss: 0.1130605 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649093  Vali macro F1 0.9558001 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.145999908447266
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0767564  Vali Loss: 0.1132162 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649093  Vali macro F1 0.9558001 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9418092  Test weighted F1: 0.9411871  Test macro F1 0.9278593 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.181697845458984
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0792177  Vali Loss: 0.1157233 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9633544  Vali macro F1 0.9544697 
Validation loss decreased (inf --> 0.115723).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.149449110031128
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0776685  Vali Loss: 0.1145967 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9634237  Vali macro F1 0.9540432 
new best score!!!!
Validation loss decreased (0.115723 --> 0.114597).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.1538848876953125
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0767611  Vali Loss: 0.1132178 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9634924  Vali macro F1 0.9547458 
new best score!!!!
Validation loss decreased (0.114597 --> 0.113218).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.159626245498657
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0768032  Vali Loss: 0.1110076 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9647915  Vali macro F1 0.9558953 
new best score!!!!
Validation loss decreased (0.113218 --> 0.111008).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.151705265045166
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0771824  Vali Loss: 0.1156773 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9648136  Vali macro F1 0.9557276 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.143874406814575
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0774918  Vali Loss: 0.1091688 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9688589  Vali macro F1 0.9599455 
new best score!!!!
Validation loss decreased (0.111008 --> 0.109169).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.1458964347839355
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0755230  Vali Loss: 0.1115223 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9653874  Vali macro F1 0.9562555 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.151469945907593
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0763855  Vali Loss: 0.1089750 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9668009  Vali macro F1 0.9577617 
new best score!!!!
Validation loss decreased (0.109169 --> 0.108975).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.138662099838257
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0737111  Vali Loss: 0.1131782 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9659367  Vali macro F1 0.9572209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.15404486656189
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0767768  Vali Loss: 0.1156653 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9654268  Vali macro F1 0.9567050 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.170912027359009
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0748894  Vali Loss: 0.1201465 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9630878  Vali macro F1 0.9540557 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.144458293914795
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0746413  Vali Loss: 0.1147914 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9640236  Vali macro F1 0.9553163 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.601484298706055
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0729972  Vali Loss: 0.1305886 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9592069  Vali macro F1 0.9496373 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 8.367473840713501
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0749363  Vali Loss: 0.1078141 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9653508  Vali macro F1 0.9569043 
new best score!!!!
Validation loss decreased (0.108975 --> 0.107814).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.125598192214966
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0718525  Vali Loss: 0.1094963 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9648530  Vali macro F1 0.9560865 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.11053729057312
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0742764  Vali Loss: 0.1078690 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9667981  Vali macro F1 0.9579400 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.1166672706604
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0723354  Vali Loss: 0.1086576 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9662556  Vali macro F1 0.9576915 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.136721849441528
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0712158  Vali Loss: 0.1116185 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9660694  Vali macro F1 0.9569479 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.109413385391235
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0712857  Vali Loss: 0.1092987 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9659033  Vali macro F1 0.9558139 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.100074529647827
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0697660  Vali Loss: 0.1100969 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9654262  Vali macro F1 0.9553412 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.115405321121216
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0695719  Vali Loss: 0.1090752 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669331  Vali macro F1 0.9582211 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.101371765136719
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0712117  Vali Loss: 0.1088189 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9663990  Vali macro F1 0.9576139 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.111051797866821
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0692068  Vali Loss: 0.1086755 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669331  Vali macro F1 0.9582211 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.110792398452759
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0709263  Vali Loss: 0.1103888 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9664321  Vali macro F1 0.9580352 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 6.113135576248169
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0692673  Vali Loss: 0.1102740 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669666  Vali macro F1 0.9586429 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.112854957580566
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0696955  Vali Loss: 0.1101642 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669666  Vali macro F1 0.9586429 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.119472503662109
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0712818  Vali Loss: 0.1100427 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669666  Vali macro F1 0.9586429 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.110265493392944
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0695462  Vali Loss: 0.1099659 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669666  Vali macro F1 0.9586429 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.114290237426758
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0683584  Vali Loss: 0.1102858 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669666  Vali macro F1 0.9586429 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9400625  Test weighted F1: 0.9395240  Test macro F1 0.9236393 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014215 0.00017848 0.00096525 0.00123916 0.0004771  0.00060096]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.300309181213379
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.4613309  Vali Loss: 1.0293066 Vali Accuracy: 0.6961026  Vali weighted F1: 0.6032160  Vali macro F1 0.3826059 
Validation loss decreased (inf --> 1.029307).  Saving model ...
Epoch: 2 cost time: 6.307906627655029
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.7876517  Vali Loss: 0.6150790 Vali Accuracy: 0.7666502  Vali weighted F1: 0.7119533  Vali macro F1 0.5191504 
new best score!!!!
Validation loss decreased (1.029307 --> 0.615079).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.278046369552612
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.5781783  Vali Loss: 0.4887466 Vali Accuracy: 0.8406512  Vali weighted F1: 0.8125305  Vali macro F1 0.7482449 
new best score!!!!
Validation loss decreased (0.615079 --> 0.488747).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.276493072509766
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.4711749  Vali Loss: 0.4159368 Vali Accuracy: 0.8717316  Vali weighted F1: 0.8577438  Vali macro F1 0.8105805 
new best score!!!!
Validation loss decreased (0.488747 --> 0.415937).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.3059093952178955
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.3782190  Vali Loss: 0.3732043 Vali Accuracy: 0.8801184  Vali weighted F1: 0.8715071  Vali macro F1 0.8274857 
new best score!!!!
Validation loss decreased (0.415937 --> 0.373204).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.304239511489868
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.3135865  Vali Loss: 0.2553710 Vali Accuracy: 0.9121855  Vali weighted F1: 0.9098682  Vali macro F1 0.8711078 
new best score!!!!
Validation loss decreased (0.373204 --> 0.255371).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.281163692474365
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.2725217  Vali Loss: 0.2270586 Vali Accuracy: 0.9225456  Vali weighted F1: 0.9223515  Vali macro F1 0.8858996 
new best score!!!!
Validation loss decreased (0.255371 --> 0.227059).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.303220272064209
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.2455896  Vali Loss: 0.2041706 Vali Accuracy: 0.9324124  Vali weighted F1: 0.9331433  Vali macro F1 0.9029808 
new best score!!!!
Validation loss decreased (0.227059 --> 0.204171).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.2956764698028564
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.2145006  Vali Loss: 0.1957033 Vali Accuracy: 0.9348791  Vali weighted F1: 0.9367549  Vali macro F1 0.9058039 
new best score!!!!
Validation loss decreased (0.204171 --> 0.195703).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2816386222839355
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.2082319  Vali Loss: 0.2319987 Vali Accuracy: 0.9171189  Vali weighted F1: 0.9213002  Vali macro F1 0.8934057 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.292505502700806
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.2051288  Vali Loss: 0.1737186 Vali Accuracy: 0.9412926  Vali weighted F1: 0.9414923  Vali macro F1 0.9137703 
new best score!!!!
Validation loss decreased (0.195703 --> 0.173719).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.292712926864624
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1806649  Vali Loss: 0.1786731 Vali Accuracy: 0.9398125  Vali weighted F1: 0.9419217  Vali macro F1 0.9162845 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.29992938041687
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1706701  Vali Loss: 0.1596503 Vali Accuracy: 0.9546127  Vali weighted F1: 0.9555355  Vali macro F1 0.9342060 
new best score!!!!
Validation loss decreased (0.173719 --> 0.159650).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.2923362255096436
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1724349  Vali Loss: 0.1799651 Vali Accuracy: 0.9437593  Vali weighted F1: 0.9453207  Vali macro F1 0.9205165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.3098461627960205
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1613476  Vali Loss: 0.1658256 Vali Accuracy: 0.9496793  Vali weighted F1: 0.9510010  Vali macro F1 0.9269063 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.300740480422974
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.1553922  Vali Loss: 0.1670398 Vali Accuracy: 0.9481993  Vali weighted F1: 0.9501154  Vali macro F1 0.9269543 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 6.283336162567139
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.1487584  Vali Loss: 0.1431600 Vali Accuracy: 0.9546127  Vali weighted F1: 0.9553091  Vali macro F1 0.9329795 
new best score!!!!
Validation loss decreased (0.159650 --> 0.143160).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.292983055114746
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.1394806  Vali Loss: 0.1545446 Vali Accuracy: 0.9521460  Vali weighted F1: 0.9529753  Vali macro F1 0.9299190 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.28515362739563
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.1338255  Vali Loss: 0.1464289 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9575901  Vali macro F1 0.9386563 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.2932288646698
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.1324527  Vali Loss: 0.1444457 Vali Accuracy: 0.9570794  Vali weighted F1: 0.9578985  Vali macro F1 0.9390397 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.292663812637329
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.1313225  Vali Loss: 0.1396141 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9603945  Vali macro F1 0.9435228 
new best score!!!!
Validation loss decreased (0.143160 --> 0.139614).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.3043694496154785
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.1267064  Vali Loss: 0.1391035 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9591291  Vali macro F1 0.9435639 
new best score!!!!
Validation loss decreased (0.139614 --> 0.139103).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.309407949447632
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.1216172  Vali Loss: 0.1576839 Vali Accuracy: 0.9481993  Vali weighted F1: 0.9490844  Vali macro F1 0.9288662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.302046060562134
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.1274886  Vali Loss: 0.1384135 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9605791  Vali macro F1 0.9448371 
new best score!!!!
Validation loss decreased (0.139103 --> 0.138414).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.28183388710022
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.1203984  Vali Loss: 0.1367225 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9624866  Vali macro F1 0.9488022 
new best score!!!!
Validation loss decreased (0.138414 --> 0.136723).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.289667129516602
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.1164988  Vali Loss: 0.1314385 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9640917  Vali macro F1 0.9499510 
new best score!!!!
Validation loss decreased (0.136723 --> 0.131438).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.282479286193848
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.1110841  Vali Loss: 0.1366997 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9630811  Vali macro F1 0.9516284 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.303100109100342
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.1092956  Vali Loss: 0.1213493 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9637193  Vali macro F1 0.9486609 
new best score!!!!
Validation loss decreased (0.131438 --> 0.121349).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.308594226837158
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.1083626  Vali Loss: 0.1263459 Vali Accuracy: 0.9620128  Vali weighted F1: 0.9627060  Vali macro F1 0.9486635 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.288509845733643
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.1048963  Vali Loss: 0.1306452 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9643168  Vali macro F1 0.9536746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.287146329879761
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.1046185  Vali Loss: 0.1301323 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9657177  Vali macro F1 0.9549057 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.284886360168457
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.1083786  Vali Loss: 0.1443017 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9608370  Vali macro F1 0.9445798 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.289433002471924
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0975917  Vali Loss: 0.1130070 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9671254  Vali macro F1 0.9554439 
new best score!!!!
Validation loss decreased (0.121349 --> 0.113007).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.286356210708618
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0984627  Vali Loss: 0.1155427 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9670677  Vali macro F1 0.9536240 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.31336522102356
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0953610  Vali Loss: 0.1199585 Vali Accuracy: 0.9654662  Vali weighted F1: 0.9658753  Vali macro F1 0.9553197 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.300345420837402
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0932514  Vali Loss: 0.1127133 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9671023  Vali macro F1 0.9547098 
new best score!!!!
Validation loss decreased (0.113007 --> 0.112713).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.279661417007446
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0901290  Vali Loss: 0.1094807 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9703774  Vali macro F1 0.9625226 
new best score!!!!
Validation loss decreased (0.112713 --> 0.109481).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.279749393463135
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0875481  Vali Loss: 0.1195740 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9641206  Vali macro F1 0.9531288 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.279696464538574
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0896795  Vali Loss: 0.1019621 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9727062  Vali macro F1 0.9645908 
new best score!!!!
Validation loss decreased (0.109481 --> 0.101962).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.278660297393799
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0847424  Vali Loss: 0.0959066 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9713006  Vali macro F1 0.9608565 
new best score!!!!
Validation loss decreased (0.101962 --> 0.095907).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.280571699142456
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0881624  Vali Loss: 0.0982590 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9712866  Vali macro F1 0.9627833 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.310702800750732
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0828617  Vali Loss: 0.1110521 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9682952  Vali macro F1 0.9597608 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.305262804031372
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0851151  Vali Loss: 0.1017358 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9697301  Vali macro F1 0.9591572 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.281345844268799
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0793406  Vali Loss: 0.1125444 Vali Accuracy: 0.9654662  Vali weighted F1: 0.9657268  Vali macro F1 0.9530499 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.288711071014404
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0768825  Vali Loss: 0.0994330 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9723565  Vali macro F1 0.9644739 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 6.286628484725952
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0693873  Vali Loss: 0.0872981 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9751509  Vali macro F1 0.9682360 
new best score!!!!
Validation loss decreased (0.095907 --> 0.087298).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.286431312561035
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0649475  Vali Loss: 0.0878187 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9747052  Vali macro F1 0.9673623 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.292353391647339
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0653441  Vali Loss: 0.0889929 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9742410  Vali macro F1 0.9668233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.319870233535767
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0665553  Vali Loss: 0.0927287 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9733348  Vali macro F1 0.9653717 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.302863836288452
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0657257  Vali Loss: 0.0907538 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9737275  Vali macro F1 0.9666657 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.292548894882202
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0638568  Vali Loss: 0.0899840 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9741605  Vali macro F1 0.9671815 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 6.278470754623413
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0642005  Vali Loss: 0.0889508 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9746743  Vali macro F1 0.9678518 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.280439615249634
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0619543  Vali Loss: 0.0887636 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756582  Vali macro F1 0.9688242 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.286746501922607
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0635853  Vali Loss: 0.0885819 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9746743  Vali macro F1 0.9678518 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.270802974700928
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0630075  Vali Loss: 0.0882205 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9746743  Vali macro F1 0.9678518 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.297123193740845
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0632578  Vali Loss: 0.0882834 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756582  Vali macro F1 0.9688242 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 57 cost time: 6.285383224487305
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0625890  Vali Loss: 0.0883351 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756582  Vali macro F1 0.9688242 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.283947467803955
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0628729  Vali Loss: 0.0883911 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756582  Vali macro F1 0.9688242 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.278289079666138
VALI: Epoch: 59, Steps: 72 | Train Loss: 0.0618922  Vali Loss: 0.0883630 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756582  Vali macro F1 0.9688242 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.2860267162323
VALI: Epoch: 60, Steps: 72 | Train Loss: 0.0642957  Vali Loss: 0.0883173 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756582  Vali macro F1 0.9688242 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.283789157867432
VALI: Epoch: 61, Steps: 72 | Train Loss: 0.0624393  Vali Loss: 0.0882989 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756582  Vali macro F1 0.9688242 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8908324  Test weighted F1: 0.8751900  Test macro F1 0.6459208 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.364975452423096
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0666852  Vali Loss: 0.0908730 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9747259  Vali macro F1 0.9667131 
Validation loss decreased (inf --> 0.090873).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.331047773361206
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0663374  Vali Loss: 0.0869910 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9746156  Vali macro F1 0.9674820 
new best score!!!!
Validation loss decreased (0.090873 --> 0.086991).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.33242392539978
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0658763  Vali Loss: 0.0891677 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9732210  Vali macro F1 0.9656049 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.292656183242798
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0626826  Vali Loss: 0.0891730 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9762399  Vali macro F1 0.9674893 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.301410675048828
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0641632  Vali Loss: 0.0860016 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9750912  Vali macro F1 0.9674569 
new best score!!!!
Validation loss decreased (0.086991 --> 0.086002).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.314135789871216
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0647325  Vali Loss: 0.0841260 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9775593  Vali macro F1 0.9706515 
new best score!!!!
Validation loss decreased (0.086002 --> 0.084126).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.317389249801636
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0655139  Vali Loss: 0.0884784 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9742248  Vali macro F1 0.9662637 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.323534727096558
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0624773  Vali Loss: 0.0884151 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9742117  Vali macro F1 0.9661398 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.3435962200164795
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0616458  Vali Loss: 0.0893688 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9751861  Vali macro F1 0.9678866 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.31737756729126
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0631731  Vali Loss: 0.0857578 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9770646  Vali macro F1 0.9701157 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.308180809020996
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0614875  Vali Loss: 0.0875568 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756196  Vali macro F1 0.9678907 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.3046088218688965
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0651387  Vali Loss: 0.0889191 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9742047  Vali macro F1 0.9665388 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.299810171127319
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0611446  Vali Loss: 0.0877283 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9761768  Vali macro F1 0.9685621 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.31510591506958
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0607149  Vali Loss: 0.0857397 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756101  Vali macro F1 0.9683714 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.45559287071228
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0612917  Vali Loss: 0.0866539 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9766191  Vali macro F1 0.9697123 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.327033758163452
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0614116  Vali Loss: 0.0873178 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9766917  Vali macro F1 0.9691465 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.315377473831177
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0576448  Vali Loss: 0.0852325 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9751773  Vali macro F1 0.9674473 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.308914661407471
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0586033  Vali Loss: 0.0846126 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756739  Vali macro F1 0.9676906 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.308259010314941
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0589174  Vali Loss: 0.0843260 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9751773  Vali macro F1 0.9674473 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.307378053665161
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0575774  Vali Loss: 0.0841080 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9761620  Vali macro F1 0.9685227 
new best score!!!!
Validation loss decreased (0.084126 --> 0.084108).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.3408284187316895
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0602820  Vali Loss: 0.0849763 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.380660772323608
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0600302  Vali Loss: 0.0849091 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.350919246673584
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0590419  Vali Loss: 0.0844674 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.315090894699097
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0569235  Vali Loss: 0.0848623 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9751893  Vali macro F1 0.9674834 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.3244171142578125
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0592888  Vali Loss: 0.0846158 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.317096948623657
Fine Tuning VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0568963  Vali Loss: 0.0846841 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.323782920837402
Fine Tuning VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0584008  Vali Loss: 0.0846055 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.318714380264282
Fine Tuning VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0565043  Vali Loss: 0.0845647 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.334168195724487
Fine Tuning VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0587904  Vali Loss: 0.0845820 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.324617147445679
Fine Tuning VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0572074  Vali Loss: 0.0844354 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 31 cost time: 6.323253870010376
Fine Tuning VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0578963  Vali Loss: 0.0844272 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.3153886795043945
Fine Tuning VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0568070  Vali Loss: 0.0844253 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.318934202194214
Fine Tuning VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0578709  Vali Loss: 0.0844082 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.31262469291687
Fine Tuning VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0577983  Vali Loss: 0.0843946 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.323638916015625
Fine Tuning VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0587180  Vali Loss: 0.0843934 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756860  Vali macro F1 0.9677267 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8868627  Test weighted F1: 0.8724519  Test macro F1 0.6468064 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0001451  0.00016764 0.0010142  0.00132979 0.00050327 0.00062933]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.2681496143341064
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.4544960  Vali Loss: 1.0399712 Vali Accuracy: 0.6780584  Vali weighted F1: 0.5682977  Vali macro F1 0.2780829 
Validation loss decreased (inf --> 1.039971).  Saving model ...
Epoch: 2 cost time: 6.268536329269409
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.7808671  Vali Loss: 0.6532187 Vali Accuracy: 0.7582962  Vali weighted F1: 0.7019116  Vali macro F1 0.4960630 
new best score!!!!
Validation loss decreased (1.039971 --> 0.653219).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.269158363342285
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.5598371  Vali Loss: 0.5294920 Vali Accuracy: 0.8103021  Vali weighted F1: 0.7697079  Vali macro F1 0.6917137 
new best score!!!!
Validation loss decreased (0.653219 --> 0.529492).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.266835689544678
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.4682148  Vali Loss: 0.4513351 Vali Accuracy: 0.8360575  Vali weighted F1: 0.8190246  Vali macro F1 0.7584678 
new best score!!!!
Validation loss decreased (0.529492 --> 0.451335).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.279917001724243
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.4144461  Vali Loss: 0.4034723 Vali Accuracy: 0.8548787  Vali weighted F1: 0.8406497  Vali macro F1 0.7883338 
new best score!!!!
Validation loss decreased (0.451335 --> 0.403472).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.290799379348755
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.3556179  Vali Loss: 0.3710828 Vali Accuracy: 0.8672610  Vali weighted F1: 0.8616321  Vali macro F1 0.8007995 
new best score!!!!
Validation loss decreased (0.403472 --> 0.371083).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.303368806838989
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.2866360  Vali Loss: 0.2544435 Vali Accuracy: 0.9113422  Vali weighted F1: 0.9105658  Vali macro F1 0.8696355 
new best score!!!!
Validation loss decreased (0.371083 --> 0.254444).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.274927616119385
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2508171  Vali Loss: 0.2679641 Vali Accuracy: 0.9118375  Vali weighted F1: 0.9106125  Vali macro F1 0.8727056 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.2723658084869385
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2198304  Vali Loss: 0.2070851 Vali Accuracy: 0.9291729  Vali weighted F1: 0.9290674  Vali macro F1 0.8949623 
new best score!!!!
Validation loss decreased (0.254444 --> 0.207085).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.268863201141357
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.2101141  Vali Loss: 0.2108425 Vali Accuracy: 0.9276870  Vali weighted F1: 0.9275218  Vali macro F1 0.8885122 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.2726850509643555
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1970726  Vali Loss: 0.1889260 Vali Accuracy: 0.9370976  Vali weighted F1: 0.9361259  Vali macro F1 0.9058088 
new best score!!!!
Validation loss decreased (0.207085 --> 0.188926).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.281432151794434
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1857633  Vali Loss: 0.1812093 Vali Accuracy: 0.9410599  Vali weighted F1: 0.9415964  Vali macro F1 0.9133420 
new best score!!!!
Validation loss decreased (0.188926 --> 0.181209).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.2882256507873535
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1801968  Vali Loss: 0.1886306 Vali Accuracy: 0.9385835  Vali weighted F1: 0.9394744  Vali macro F1 0.9099485 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.278891563415527
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1703925  Vali Loss: 0.1855225 Vali Accuracy: 0.9395740  Vali weighted F1: 0.9410199  Vali macro F1 0.9134478 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.271336317062378
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1667244  Vali Loss: 0.1697670 Vali Accuracy: 0.9420505  Vali weighted F1: 0.9425879  Vali macro F1 0.9143070 
new best score!!!!
Validation loss decreased (0.181209 --> 0.169767).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.283441543579102
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1567449  Vali Loss: 0.1880550 Vali Accuracy: 0.9395740  Vali weighted F1: 0.9409074  Vali macro F1 0.9116637 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.277955055236816
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1543307  Vali Loss: 0.1768249 Vali Accuracy: 0.9440317  Vali weighted F1: 0.9445643  Vali macro F1 0.9171650 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.275988340377808
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1483235  Vali Loss: 0.1543766 Vali Accuracy: 0.9455176  Vali weighted F1: 0.9458951  Vali macro F1 0.9201843 
new best score!!!!
Validation loss decreased (0.169767 --> 0.154377).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.277287483215332
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1478451  Vali Loss: 0.1705850 Vali Accuracy: 0.9415552  Vali weighted F1: 0.9428352  Vali macro F1 0.9203590 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.290381908416748
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1357191  Vali Loss: 0.1590683 Vali Accuracy: 0.9445270  Vali weighted F1: 0.9460448  Vali macro F1 0.9224263 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.268569469451904
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1382554  Vali Loss: 0.1682629 Vali Accuracy: 0.9450223  Vali weighted F1: 0.9460514  Vali macro F1 0.9176745 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.260725498199463
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1400800  Vali Loss: 0.1566497 Vali Accuracy: 0.9425458  Vali weighted F1: 0.9425773  Vali macro F1 0.9139146 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 6.270777702331543
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1332379  Vali Loss: 0.1397315 Vali Accuracy: 0.9534423  Vali weighted F1: 0.9539251  Vali macro F1 0.9318759 
new best score!!!!
Validation loss decreased (0.154377 --> 0.139731).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.275336265563965
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1226051  Vali Loss: 0.1446748 Vali Accuracy: 0.9514611  Vali weighted F1: 0.9518768  Vali macro F1 0.9306645 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.274530649185181
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1220080  Vali Loss: 0.1505974 Vali Accuracy: 0.9554235  Vali weighted F1: 0.9566115  Vali macro F1 0.9453270 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 8.978798866271973
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1214238  Vali Loss: 0.1250515 Vali Accuracy: 0.9588905  Vali weighted F1: 0.9595390  Vali macro F1 0.9455758 
new best score!!!!
Validation loss decreased (0.139731 --> 0.125051).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.293848276138306
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1061536  Vali Loss: 0.1523993 Vali Accuracy: 0.9489846  Vali weighted F1: 0.9502002  Vali macro F1 0.9355662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.278012037277222
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1070319  Vali Loss: 0.1397674 Vali Accuracy: 0.9519564  Vali weighted F1: 0.9532369  Vali macro F1 0.9412892 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.275900840759277
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1054730  Vali Loss: 0.1068099 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9657321  Vali macro F1 0.9541598 
new best score!!!!
Validation loss decreased (0.125051 --> 0.106810).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.27089524269104
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1056504  Vali Loss: 0.1023204 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9648611  Vali macro F1 0.9487174 
new best score!!!!
Validation loss decreased (0.106810 --> 0.102320).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.271376371383667
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.1029865  Vali Loss: 0.1026837 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9656166  Vali macro F1 0.9524325 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.280143737792969
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0995103  Vali Loss: 0.1029609 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9668104  Vali macro F1 0.9558333 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.300844192504883
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0930272  Vali Loss: 0.1062136 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9680894  Vali macro F1 0.9564968 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.2928102016448975
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0931231  Vali Loss: 0.1024031 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9649526  Vali macro F1 0.9510948 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.280431509017944
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0883732  Vali Loss: 0.0956261 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9683282  Vali macro F1 0.9569287 
new best score!!!!
Validation loss decreased (0.102320 --> 0.095626).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.278099536895752
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0880967  Vali Loss: 0.1007401 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9665978  Vali macro F1 0.9557645 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.282047271728516
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0880058  Vali Loss: 0.0825362 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9727198  Vali macro F1 0.9632816 
new best score!!!!
Validation loss decreased (0.095626 --> 0.082536).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.281642436981201
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0875876  Vali Loss: 0.0925805 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9709894  Vali macro F1 0.9609883 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.273792028427124
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0884799  Vali Loss: 0.0921508 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9705261  Vali macro F1 0.9615340 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.3070385456085205
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0835969  Vali Loss: 0.0904744 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9745493  Vali macro F1 0.9655716 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.30478572845459
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0863820  Vali Loss: 0.0883890 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9679991  Vali macro F1 0.9501747 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.286212921142578
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0767218  Vali Loss: 0.0847407 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9716357  Vali macro F1 0.9612890 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 43 cost time: 6.280215740203857
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0655025  Vali Loss: 0.0724442 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9749262  Vali macro F1 0.9661911 
new best score!!!!
Validation loss decreased (0.082536 --> 0.072444).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.270447254180908
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0652712  Vali Loss: 0.0739424 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9754114  Vali macro F1 0.9671254 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.2704102993011475
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0649615  Vali Loss: 0.0730559 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9769291  Vali macro F1 0.9683551 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.269026279449463
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0656800  Vali Loss: 0.0719918 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793959  Vali macro F1 0.9709521 
new best score!!!!
Validation loss decreased (0.072444 --> 0.071992).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.293678045272827
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0635611  Vali Loss: 0.0714254 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9773846  Vali macro F1 0.9694068 
new best score!!!!
Validation loss decreased (0.071992 --> 0.071425).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.280248165130615
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0616646  Vali Loss: 0.0727831 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788780  Vali macro F1 0.9712888 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.272090196609497
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0606104  Vali Loss: 0.0703588 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9773690  Vali macro F1 0.9687518 
new best score!!!!
Validation loss decreased (0.071425 --> 0.070359).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.269164562225342
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0642572  Vali Loss: 0.0665600 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9778602  Vali macro F1 0.9701178 
new best score!!!!
Validation loss decreased (0.070359 --> 0.066560).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.266098260879517
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0633346  Vali Loss: 0.0703126 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9778912  Vali macro F1 0.9700557 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.271013259887695
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0607911  Vali Loss: 0.0735928 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9774516  Vali macro F1 0.9686075 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.267576456069946
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0617538  Vali Loss: 0.0708950 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784468  Vali macro F1 0.9703789 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.289930105209351
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0597300  Vali Loss: 0.0668261 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798318  Vali macro F1 0.9730087 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.274251461029053
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0603968  Vali Loss: 0.0681618 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9764357  Vali macro F1 0.9684419 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 6.2700724601745605
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0607540  Vali Loss: 0.0680685 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9774391  Vali macro F1 0.9691623 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.269387483596802
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0597823  Vali Loss: 0.0677298 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9769415  Vali macro F1 0.9689187 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.272746562957764
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0604655  Vali Loss: 0.0675753 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784208  Vali macro F1 0.9703370 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.268523454666138
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0593410  Vali Loss: 0.0673834 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9774242  Vali macro F1 0.9695172 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.27201771736145
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0582195  Vali Loss: 0.0669969 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784044  Vali macro F1 0.9705617 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.2911858558654785
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0608496  Vali Loss: 0.0669641 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779149  Vali macro F1 0.9703476 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.266876935958862
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0581111  Vali Loss: 0.0670232 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9774242  Vali macro F1 0.9695172 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.272299289703369
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0569170  Vali Loss: 0.0670590 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9774242  Vali macro F1 0.9695172 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.276576519012451
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0592128  Vali Loss: 0.0669738 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779149  Vali macro F1 0.9703476 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.278501033782959
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0586486  Vali Loss: 0.0669384 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779149  Vali macro F1 0.9703476 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8279290  Test weighted F1: 0.8316968  Test macro F1 0.8562824 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3167173862457275
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0637116  Vali Loss: 0.0703051 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9783915  Vali macro F1 0.9712493 
Validation loss decreased (inf --> 0.070305).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.292104244232178
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0625722  Vali Loss: 0.0701516 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779156  Vali macro F1 0.9706791 
new best score!!!!
Validation loss decreased (0.070305 --> 0.070152).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.291844129562378
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0626907  Vali Loss: 0.0696469 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779483  Vali macro F1 0.9694848 
new best score!!!!
Validation loss decreased (0.070152 --> 0.069647).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.292749881744385
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0610078  Vali Loss: 0.0661906 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788957  Vali macro F1 0.9709065 
new best score!!!!
Validation loss decreased (0.069647 --> 0.066191).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.312626838684082
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0584765  Vali Loss: 0.0655422 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788475  Vali macro F1 0.9710623 
new best score!!!!
Validation loss decreased (0.066191 --> 0.065542).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.288435459136963
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0582252  Vali Loss: 0.0666158 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9783885  Vali macro F1 0.9707545 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.306165456771851
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0583089  Vali Loss: 0.0694896 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9763920  Vali macro F1 0.9690023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.29428243637085
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0596609  Vali Loss: 0.0658534 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798837  Vali macro F1 0.9727966 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.310410737991333
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0584359  Vali Loss: 0.0651224 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808351  Vali macro F1 0.9740602 
new best score!!!!
Validation loss decreased (0.065542 --> 0.065122).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.312804698944092
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0608967  Vali Loss: 0.0664129 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779156  Vali macro F1 0.9693356 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.301360607147217
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0596261  Vali Loss: 0.0645080 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803014  Vali macro F1 0.9735229 
new best score!!!!
Validation loss decreased (0.065122 --> 0.064508).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.294937610626221
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0579303  Vali Loss: 0.0663053 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798610  Vali macro F1 0.9726322 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.302852392196655
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0604974  Vali Loss: 0.0644250 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817893  Vali macro F1 0.9751158 
new best score!!!!
Validation loss decreased (0.064508 --> 0.064425).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.311792612075806
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0575447  Vali Loss: 0.0638783 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788831  Vali macro F1 0.9714674 
new best score!!!!
Validation loss decreased (0.064425 --> 0.063878).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.31209659576416
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0578499  Vali Loss: 0.0651576 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9778756  Vali macro F1 0.9705018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.33940315246582
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0583918  Vali Loss: 0.0667693 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788986  Vali macro F1 0.9720935 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.303099632263184
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0565833  Vali Loss: 0.0663507 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793782  Vali macro F1 0.9723209 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.2921576499938965
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0554969  Vali Loss: 0.0632505 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803574  Vali macro F1 0.9730018 
new best score!!!!
Validation loss decreased (0.063878 --> 0.063251).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.310117721557617
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0555891  Vali Loss: 0.0654486 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9783982  Vali macro F1 0.9714000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.301222324371338
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0572524  Vali Loss: 0.0632815 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788664  Vali macro F1 0.9716926 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.29868745803833
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0553089  Vali Loss: 0.0625238 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9778562  Vali macro F1 0.9703939 
new best score!!!!
Validation loss decreased (0.063251 --> 0.062524).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.309311151504517
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0545640  Vali Loss: 0.0634370 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793463  Vali macro F1 0.9719225 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.330369710922241
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0565812  Vali Loss: 0.0676744 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9768360  Vali macro F1 0.9689055 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.298450708389282
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0561069  Vali Loss: 0.0703868 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9769305  Vali macro F1 0.9689061 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.30792760848999
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0565358  Vali Loss: 0.0651275 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793575  Vali macro F1 0.9721897 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.312522649765015
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0555170  Vali Loss: 0.0668557 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789370  Vali macro F1 0.9709909 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 27 cost time: 6.3069939613342285
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0547449  Vali Loss: 0.0635633 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812947  Vali macro F1 0.9739163 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.302310943603516
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0532424  Vali Loss: 0.0652779 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803320  Vali macro F1 0.9734940 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.3214428424835205
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0539088  Vali Loss: 0.0630531 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803819  Vali macro F1 0.9732766 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.304386377334595
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0540143  Vali Loss: 0.0621711 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803049  Vali macro F1 0.9729661 
new best score!!!!
Validation loss decreased (0.062524 --> 0.062171).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.299286603927612
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0528583  Vali Loss: 0.0649636 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793607  Vali macro F1 0.9721142 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.3000476360321045
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0524937  Vali Loss: 0.0623221 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788594  Vali macro F1 0.9707843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.300175428390503
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0538538  Vali Loss: 0.0625421 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9794019  Vali macro F1 0.9719009 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.314763784408569
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0542936  Vali Loss: 0.0612971 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793630  Vali macro F1 0.9721830 
new best score!!!!
Validation loss decreased (0.062171 --> 0.061297).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 6.307159185409546
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0529125  Vali Loss: 0.0622162 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789028  Vali macro F1 0.9714197 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 6.326714515686035
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0520010  Vali Loss: 0.0621771 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803968  Vali macro F1 0.9727187 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 6.298815488815308
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0509435  Vali Loss: 0.0616094 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808287  Vali macro F1 0.9736376 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 6.289808988571167
Fine Tuning VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0521165  Vali Loss: 0.0592478 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798060  Vali macro F1 0.9723558 
new best score!!!!
Validation loss decreased (0.061297 --> 0.059248).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 6.297464847564697
Fine Tuning VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0513366  Vali Loss: 0.0615908 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803224  Vali macro F1 0.9728956 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 6.299858570098877
Fine Tuning VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0506936  Vali Loss: 0.0590760 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798726  Vali macro F1 0.9722081 
new best score!!!!
Validation loss decreased (0.059248 --> 0.059076).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 41 cost time: 6.299468278884888
Fine Tuning VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0507509  Vali Loss: 0.0619729 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784269  Vali macro F1 0.9709264 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 6.309142351150513
Fine Tuning VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0507427  Vali Loss: 0.0600219 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808525  Vali macro F1 0.9730501 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 6.319289684295654
Fine Tuning VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0523570  Vali Loss: 0.0619262 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793710  Vali macro F1 0.9715215 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 6.2857561111450195
Fine Tuning VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0509062  Vali Loss: 0.0627168 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9794087  Vali macro F1 0.9716459 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 6.298645973205566
Fine Tuning VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0502449  Vali Loss: 0.0603297 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798521  Vali macro F1 0.9720677 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 46 cost time: 6.299623489379883
Fine Tuning VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0497942  Vali Loss: 0.0599255 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808216  Vali macro F1 0.9736763 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 47 cost time: 6.2993199825286865
Fine Tuning VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0476137  Vali Loss: 0.0599742 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808427  Vali macro F1 0.9730184 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 48 cost time: 6.305562257766724
Fine Tuning VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0480593  Vali Loss: 0.0600684 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9818101  Vali macro F1 0.9746240 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 49 cost time: 6.320862054824829
Fine Tuning VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0495933  Vali Loss: 0.0601262 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808210  Vali macro F1 0.9733450 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 50 cost time: 6.30489706993103
Fine Tuning VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0468548  Vali Loss: 0.0598328 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808009  Vali macro F1 0.9736741 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 51 cost time: 6.30131196975708
Fine Tuning VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0478328  Vali Loss: 0.0598537 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808009  Vali macro F1 0.9736741 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 52 cost time: 6.289277791976929
Fine Tuning VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0480630  Vali Loss: 0.0598686 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808009  Vali macro F1 0.9736741 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 53 cost time: 6.29395604133606
Fine Tuning VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0490494  Vali Loss: 0.0599088 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808009  Vali macro F1 0.9736741 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 54 cost time: 6.304708480834961
Fine Tuning VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0488989  Vali Loss: 0.0599216 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808009  Vali macro F1 0.9736741 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 55 cost time: 6.296106338500977
Fine Tuning VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0495849  Vali Loss: 0.0599365 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9813059  Vali macro F1 0.9741498 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8527811  Test weighted F1: 0.8547278  Test macro F1 0.8704430 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014648 0.00017775 0.00108932 0.00131579 0.00049628 0.00062933]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.1472296714782715
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4589925  Vali Loss: 1.0332697 Vali Accuracy: 0.6783359  Vali weighted F1: 0.5695459  Vali macro F1 0.2754904 
Validation loss decreased (inf --> 1.033270).  Saving model ...
Epoch: 2 cost time: 6.117412567138672
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.7961034  Vali Loss: 0.6553524 Vali Accuracy: 0.7569762  Vali weighted F1: 0.6938032  Vali macro F1 0.4883205 
new best score!!!!
Validation loss decreased (1.033270 --> 0.655352).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.128958463668823
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5930295  Vali Loss: 0.5352970 Vali Accuracy: 0.8214105  Vali weighted F1: 0.7898260  Vali macro F1 0.7207148 
new best score!!!!
Validation loss decreased (0.655352 --> 0.535297).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.12527060508728
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5012081  Vali Loss: 0.4649202 Vali Accuracy: 0.8432268  Vali weighted F1: 0.8236836  Vali macro F1 0.7736391 
new best score!!!!
Validation loss decreased (0.535297 --> 0.464920).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.139026641845703
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4445937  Vali Loss: 0.4271806 Vali Accuracy: 0.8635211  Vali weighted F1: 0.8488952  Vali macro F1 0.8079427 
new best score!!!!
Validation loss decreased (0.464920 --> 0.427181).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.142071485519409
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3936611  Vali Loss: 0.3661383 Vali Accuracy: 0.8787418  Vali weighted F1: 0.8681021  Vali macro F1 0.8313800 
new best score!!!!
Validation loss decreased (0.427181 --> 0.366138).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.161702632904053
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3400800  Vali Loss: 0.2973385 Vali Accuracy: 0.9015728  Vali weighted F1: 0.8986167  Vali macro F1 0.8652405 
new best score!!!!
Validation loss decreased (0.366138 --> 0.297338).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.153857469558716
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2900934  Vali Loss: 0.2607442 Vali Accuracy: 0.9157788  Vali weighted F1: 0.9121250  Vali macro F1 0.8851505 
new best score!!!!
Validation loss decreased (0.297338 --> 0.260744).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.149068117141724
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2493246  Vali Loss: 0.2144361 Vali Accuracy: 0.9350583  Vali weighted F1: 0.9351153  Vali macro F1 0.9088070 
new best score!!!!
Validation loss decreased (0.260744 --> 0.214436).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.138456344604492
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2255295  Vali Loss: 0.2051516 Vali Accuracy: 0.9401319  Vali weighted F1: 0.9392034  Vali macro F1 0.9130210 
new best score!!!!
Validation loss decreased (0.214436 --> 0.205152).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.135329008102417
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2168848  Vali Loss: 0.2458737 Vali Accuracy: 0.9213597  Vali weighted F1: 0.9173308  Vali macro F1 0.8959021 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.1376566886901855
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1984881  Vali Loss: 0.2008265 Vali Accuracy: 0.9375951  Vali weighted F1: 0.9372909  Vali macro F1 0.9122942 
new best score!!!!
Validation loss decreased (0.205152 --> 0.200826).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.130802631378174
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1879926  Vali Loss: 0.2000598 Vali Accuracy: 0.9370878  Vali weighted F1: 0.9359924  Vali macro F1 0.9086684 
new best score!!!!
Validation loss decreased (0.200826 --> 0.200060).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.145275831222534
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1737450  Vali Loss: 0.2006102 Vali Accuracy: 0.9360731  Vali weighted F1: 0.9348369  Vali macro F1 0.9105725 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.152989387512207
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1736114  Vali Loss: 0.1852641 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9418277  Vali macro F1 0.9153144 
new best score!!!!
Validation loss decreased (0.200060 --> 0.185264).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.146770477294922
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1640236  Vali Loss: 0.1671476 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9472729  Vali macro F1 0.9244445 
new best score!!!!
Validation loss decreased (0.185264 --> 0.167148).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.142381429672241
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1583411  Vali Loss: 0.1731695 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9410610  Vali macro F1 0.9205900 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.143882513046265
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1519036  Vali Loss: 0.1659135 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9471707  Vali macro F1 0.9245097 
new best score!!!!
Validation loss decreased (0.167148 --> 0.165914).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.142016172409058
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1439436  Vali Loss: 0.1673417 Vali Accuracy: 0.9477423  Vali weighted F1: 0.9470507  Vali macro F1 0.9246575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.147050619125366
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1502028  Vali Loss: 0.1538946 Vali Accuracy: 0.9518011  Vali weighted F1: 0.9517397  Vali macro F1 0.9323692 
new best score!!!!
Validation loss decreased (0.165914 --> 0.153895).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.144532918930054
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1435871  Vali Loss: 0.1533662 Vali Accuracy: 0.9502790  Vali weighted F1: 0.9499177  Vali macro F1 0.9311062 
new best score!!!!
Validation loss decreased (0.153895 --> 0.153366).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.161426544189453
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1390184  Vali Loss: 0.1708586 Vali Accuracy: 0.9446981  Vali weighted F1: 0.9448518  Vali macro F1 0.9212056 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.168287992477417
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1372844  Vali Loss: 0.1352951 Vali Accuracy: 0.9548453  Vali weighted F1: 0.9547965  Vali macro F1 0.9350066 
new best score!!!!
Validation loss decreased (0.153366 --> 0.135295).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.127469778060913
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1291372  Vali Loss: 0.1435135 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9563453  Vali macro F1 0.9402032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.139329671859741
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1232445  Vali Loss: 0.1650421 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9525789  Vali macro F1 0.9337400 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.129392385482788
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1208041  Vali Loss: 0.1407855 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9570996  Vali macro F1 0.9407730 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.136273145675659
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1193475  Vali Loss: 0.1435766 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9575262  Vali macro F1 0.9383770 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.140094041824341
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1169111  Vali Loss: 0.1377184 Vali Accuracy: 0.9563673  Vali weighted F1: 0.9567217  Vali macro F1 0.9380278 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 6.165994167327881
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1059966  Vali Loss: 0.1319130 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9610151  Vali macro F1 0.9437458 
new best score!!!!
Validation loss decreased (0.135295 --> 0.131913).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.144156217575073
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1051185  Vali Loss: 0.1269793 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9619979  Vali macro F1 0.9454548 
new best score!!!!
Validation loss decreased (0.131913 --> 0.126979).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.143783092498779
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1045648  Vali Loss: 0.1303491 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9610775  Vali macro F1 0.9442066 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.139207601547241
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1014038  Vali Loss: 0.1313365 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9605642  Vali macro F1 0.9426008 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.1364426612854
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.1039603  Vali Loss: 0.1257366 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9610724  Vali macro F1 0.9434052 
new best score!!!!
Validation loss decreased (0.126979 --> 0.125737).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.141181468963623
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.1024582  Vali Loss: 0.1287314 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9616040  Vali macro F1 0.9456654 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.1471381187438965
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.1016975  Vali Loss: 0.1290010 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9605840  Vali macro F1 0.9437345 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.154606342315674
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.1003050  Vali Loss: 0.1257862 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9630446  Vali macro F1 0.9464574 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.143419504165649
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.1029688  Vali Loss: 0.1290342 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9615807  Vali macro F1 0.9450153 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.140727996826172
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.1027708  Vali Loss: 0.1289604 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9610732  Vali macro F1 0.9445760 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.147406578063965
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.1007708  Vali Loss: 0.1270014 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9610775  Vali macro F1 0.9442066 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.143071413040161
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0962988  Vali Loss: 0.1265535 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9615807  Vali macro F1 0.9450153 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.162187814712524
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0999957  Vali Loss: 0.1272683 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9615807  Vali macro F1 0.9450153 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.147611618041992
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0986537  Vali Loss: 0.1266815 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9620697  Vali macro F1 0.9458400 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.173398733139038
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0975181  Vali Loss: 0.1259251 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625734  Vali macro F1 0.9466334 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.183363437652588
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0983547  Vali Loss: 0.1259836 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625734  Vali macro F1 0.9466334 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.137587785720825
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0956767  Vali Loss: 0.1260318 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625734  Vali macro F1 0.9466334 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.139875173568726
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.1001840  Vali Loss: 0.1260038 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625734  Vali macro F1 0.9466334 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.137716054916382
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0974477  Vali Loss: 0.1260832 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625734  Vali macro F1 0.9466334 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.154383420944214
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0970122  Vali Loss: 0.1261575 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625734  Vali macro F1 0.9466334 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9281310  Test weighted F1: 0.9280677  Test macro F1 0.8669911 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.205930471420288
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.1032429  Vali Loss: 0.1225526 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9635102  Vali macro F1 0.9473933 
Validation loss decreased (inf --> 0.122553).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.152876138687134
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.1017739  Vali Loss: 0.1273975 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9635331  Vali macro F1 0.9472824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.149367332458496
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.1011339  Vali Loss: 0.1296284 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9620545  Vali macro F1 0.9454906 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.133286237716675
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.1017166  Vali Loss: 0.1276179 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625684  Vali macro F1 0.9466049 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.148332595825195
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1029920  Vali Loss: 0.1281938 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9596287  Vali macro F1 0.9443178 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.15656042098999
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0988183  Vali Loss: 0.1268706 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9615782  Vali macro F1 0.9453540 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.16746711730957
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0978014  Vali Loss: 0.1225615 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9630720  Vali macro F1 0.9473985 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.165837049484253
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0980859  Vali Loss: 0.1260822 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625860  Vali macro F1 0.9465808 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.151187896728516
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0962056  Vali Loss: 0.1228794 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9628644  Vali macro F1 0.9466859 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.154719829559326
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0952250  Vali Loss: 0.1230165 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9621438  Vali macro F1 0.9459965 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.143142461776733
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0959553  Vali Loss: 0.1242328 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625830  Vali macro F1 0.9463936 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.153109550476074
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0956311  Vali Loss: 0.1246374 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9620953  Vali macro F1 0.9459511 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.157415866851807
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0950884  Vali Loss: 0.1248260 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9615769  Vali macro F1 0.9453691 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.160155773162842
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0942463  Vali Loss: 0.1238551 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625990  Vali macro F1 0.9467445 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.168931245803833
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0943881  Vali Loss: 0.1248635 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9620805  Vali macro F1 0.9461622 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.16525673866272
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0954937  Vali Loss: 0.1245594 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9620805  Vali macro F1 0.9461622 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9308917  Test weighted F1: 0.9308336  Test macro F1 0.8713571 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013931 0.00018355 0.00106724 0.00127551 0.00049116 0.00059347]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.257566928863525
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.4636069  Vali Loss: 1.0475599 Vali Accuracy: 0.6698207  Vali weighted F1: 0.5590566  Vali macro F1 0.2728338 
Validation loss decreased (inf --> 1.047560).  Saving model ...
Epoch: 2 cost time: 6.24848198890686
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.8037430  Vali Loss: 0.6427829 Vali Accuracy: 0.7604582  Vali weighted F1: 0.6982503  Vali macro F1 0.4809163 
new best score!!!!
Validation loss decreased (1.047560 --> 0.642783).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.235241174697876
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.5850889  Vali Loss: 0.5178196 Vali Accuracy: 0.8172311  Vali weighted F1: 0.7798186  Vali macro F1 0.6910266 
new best score!!!!
Validation loss decreased (0.642783 --> 0.517820).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2336647510528564
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.4983401  Vali Loss: 0.4558132 Vali Accuracy: 0.8396414  Vali weighted F1: 0.8162663  Vali macro F1 0.7435847 
new best score!!!!
Validation loss decreased (0.517820 --> 0.455813).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.246671199798584
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.4342484  Vali Loss: 0.4053873 Vali Accuracy: 0.8580677  Vali weighted F1: 0.8417607  Vali macro F1 0.7810040 
new best score!!!!
Validation loss decreased (0.455813 --> 0.405387).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.249397039413452
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.3840707  Vali Loss: 0.3450964 Vali Accuracy: 0.8824701  Vali weighted F1: 0.8753608  Vali macro F1 0.8192191 
new best score!!!!
Validation loss decreased (0.405387 --> 0.345096).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.2383949756622314
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.3315176  Vali Loss: 0.3256142 Vali Accuracy: 0.8909363  Vali weighted F1: 0.8861611  Vali macro F1 0.8321747 
new best score!!!!
Validation loss decreased (0.345096 --> 0.325614).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.240387201309204
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2842396  Vali Loss: 0.2664116 Vali Accuracy: 0.9083665  Vali weighted F1: 0.9093524  Vali macro F1 0.8584740 
new best score!!!!
Validation loss decreased (0.325614 --> 0.266412).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.248855352401733
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2572460  Vali Loss: 0.2320254 Vali Accuracy: 0.9183267  Vali weighted F1: 0.9180322  Vali macro F1 0.8716992 
new best score!!!!
Validation loss decreased (0.266412 --> 0.232025).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.241914987564087
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.2211967  Vali Loss: 0.2451492 Vali Accuracy: 0.9158367  Vali weighted F1: 0.9180146  Vali macro F1 0.8769706 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.245167255401611
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.2276687  Vali Loss: 0.2110269 Vali Accuracy: 0.9307769  Vali weighted F1: 0.9303999  Vali macro F1 0.8932323 
new best score!!!!
Validation loss decreased (0.232025 --> 0.211027).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.270944833755493
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.2105767  Vali Loss: 0.2214027 Vali Accuracy: 0.9277888  Vali weighted F1: 0.9290383  Vali macro F1 0.8911771 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.23085880279541
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1952495  Vali Loss: 0.2028201 Vali Accuracy: 0.9382470  Vali weighted F1: 0.9385404  Vali macro F1 0.9015050 
new best score!!!!
Validation loss decreased (0.211027 --> 0.202820).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.250731468200684
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1897740  Vali Loss: 0.2448887 Vali Accuracy: 0.9252988  Vali weighted F1: 0.9221451  Vali macro F1 0.8848771 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.240400075912476
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1843185  Vali Loss: 0.2259526 Vali Accuracy: 0.9203187  Vali weighted F1: 0.9225108  Vali macro F1 0.8879578 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.249005317687988
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1787940  Vali Loss: 0.2188694 Vali Accuracy: 0.9277888  Vali weighted F1: 0.9292379  Vali macro F1 0.8957030 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 6.249334096908569
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1679012  Vali Loss: 0.1881148 Vali Accuracy: 0.9347610  Vali weighted F1: 0.9342158  Vali macro F1 0.8994755 
new best score!!!!
Validation loss decreased (0.202820 --> 0.188115).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.249827146530151
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1618930  Vali Loss: 0.1748314 Vali Accuracy: 0.9392430  Vali weighted F1: 0.9399786  Vali macro F1 0.9052386 
new best score!!!!
Validation loss decreased (0.188115 --> 0.174831).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.256895542144775
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1578251  Vali Loss: 0.2537755 Vali Accuracy: 0.9103586  Vali weighted F1: 0.9145082  Vali macro F1 0.8803356 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.235509872436523
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1564878  Vali Loss: 0.1801374 Vali Accuracy: 0.9332669  Vali weighted F1: 0.9349265  Vali macro F1 0.9015932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.238542795181274
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1449793  Vali Loss: 0.1721025 Vali Accuracy: 0.9417331  Vali weighted F1: 0.9417191  Vali macro F1 0.9084409 
new best score!!!!
Validation loss decreased (0.174831 --> 0.172103).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.24689793586731
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1472637  Vali Loss: 0.1865301 Vali Accuracy: 0.9322709  Vali weighted F1: 0.9341651  Vali macro F1 0.9022847 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.234881162643433
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1424512  Vali Loss: 0.1594341 Vali Accuracy: 0.9467131  Vali weighted F1: 0.9469455  Vali macro F1 0.9160388 
new best score!!!!
Validation loss decreased (0.172103 --> 0.159434).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.2419586181640625
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1371430  Vali Loss: 0.1528776 Vali Accuracy: 0.9442231  Vali weighted F1: 0.9452327  Vali macro F1 0.9144621 
new best score!!!!
Validation loss decreased (0.159434 --> 0.152878).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.243737697601318
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1409808  Vali Loss: 0.1632130 Vali Accuracy: 0.9442231  Vali weighted F1: 0.9451255  Vali macro F1 0.9165660 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.2368245124816895
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1257888  Vali Loss: 0.1731635 Vali Accuracy: 0.9397410  Vali weighted F1: 0.9406381  Vali macro F1 0.9105049 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.24578070640564
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1281143  Vali Loss: 0.1420324 Vali Accuracy: 0.9531873  Vali weighted F1: 0.9533958  Vali macro F1 0.9242206 
new best score!!!!
Validation loss decreased (0.152878 --> 0.142032).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.244557857513428
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1275073  Vali Loss: 0.1998931 Vali Accuracy: 0.9347610  Vali weighted F1: 0.9359871  Vali macro F1 0.9086212 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.239330768585205
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1203691  Vali Loss: 0.1634913 Vali Accuracy: 0.9357570  Vali weighted F1: 0.9362573  Vali macro F1 0.9034276 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.237313270568848
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1205140  Vali Loss: 0.2049942 Vali Accuracy: 0.9267928  Vali weighted F1: 0.9283012  Vali macro F1 0.9021697 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.242768049240112
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.1180173  Vali Loss: 0.1612587 Vali Accuracy: 0.9392430  Vali weighted F1: 0.9409355  Vali macro F1 0.9149550 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.251399993896484
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.1140353  Vali Loss: 0.1375569 Vali Accuracy: 0.9561753  Vali weighted F1: 0.9571535  Vali macro F1 0.9388620 
new best score!!!!
Validation loss decreased (0.142032 --> 0.137557).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.2619242668151855
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.1169016  Vali Loss: 0.2146989 Vali Accuracy: 0.9208167  Vali weighted F1: 0.9242484  Vali macro F1 0.8969043 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.242080450057983
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.1098759  Vali Loss: 0.1779623 Vali Accuracy: 0.9407371  Vali weighted F1: 0.9413869  Vali macro F1 0.9164670 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.239286422729492
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.1119355  Vali Loss: 0.1574467 Vali Accuracy: 0.9417331  Vali weighted F1: 0.9427187  Vali macro F1 0.9221298 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.238349676132202
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.1096691  Vali Loss: 0.1300951 Vali Accuracy: 0.9516932  Vali weighted F1: 0.9527205  Vali macro F1 0.9308631 
new best score!!!!
Validation loss decreased (0.137557 --> 0.130095).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.25385856628418
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.1091944  Vali Loss: 0.1166401 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9585264  Vali macro F1 0.9391668 
new best score!!!!
Validation loss decreased (0.130095 --> 0.116640).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.247593641281128
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.1002687  Vali Loss: 0.1223099 Vali Accuracy: 0.9556773  Vali weighted F1: 0.9565070  Vali macro F1 0.9380922 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.256458520889282
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.1015557  Vali Loss: 0.1196292 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9605363  Vali macro F1 0.9419025 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.2731993198394775
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.1026927  Vali Loss: 0.1285129 Vali Accuracy: 0.9541833  Vali weighted F1: 0.9551084  Vali macro F1 0.9356292 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.241419076919556
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0929297  Vali Loss: 0.1206305 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9585853  Vali macro F1 0.9380826 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.238488435745239
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0916597  Vali Loss: 0.1286678 Vali Accuracy: 0.9521912  Vali weighted F1: 0.9531944  Vali macro F1 0.9324303 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 43 cost time: 6.245464563369751
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0839814  Vali Loss: 0.1112491 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9610909  Vali macro F1 0.9419566 
new best score!!!!
Validation loss decreased (0.116640 --> 0.111249).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.22803807258606
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0815042  Vali Loss: 0.1086518 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9620633  Vali macro F1 0.9436209 
new best score!!!!
Validation loss decreased (0.111249 --> 0.108652).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.2501842975616455
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0800701  Vali Loss: 0.1100553 Vali Accuracy: 0.9626494  Vali weighted F1: 0.9631802  Vali macro F1 0.9453644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.249392986297607
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0804770  Vali Loss: 0.1077298 Vali Accuracy: 0.9626494  Vali weighted F1: 0.9630718  Vali macro F1 0.9454363 
new best score!!!!
Validation loss decreased (0.108652 --> 0.107730).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.251168966293335
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0778337  Vali Loss: 0.1100726 Vali Accuracy: 0.9626494  Vali weighted F1: 0.9631650  Vali macro F1 0.9461534 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.2322187423706055
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0790871  Vali Loss: 0.1105041 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9610409  Vali macro F1 0.9428571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.2359254360198975
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0794667  Vali Loss: 0.1122759 Vali Accuracy: 0.9611554  Vali weighted F1: 0.9617888  Vali macro F1 0.9449246 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.235724925994873
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0780078  Vali Loss: 0.1080097 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9636372  Vali macro F1 0.9466176 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.2376251220703125
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0777049  Vali Loss: 0.1052040 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9645347  Vali macro F1 0.9474721 
new best score!!!!
Validation loss decreased (0.107730 --> 0.105204).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.242672681808472
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0770289  Vali Loss: 0.1065039 Vali Accuracy: 0.9621514  Vali weighted F1: 0.9625442  Vali macro F1 0.9440637 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.247332572937012
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0756531  Vali Loss: 0.1141621 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9589379  Vali macro F1 0.9418935 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.255000591278076
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0761826  Vali Loss: 0.1102164 Vali Accuracy: 0.9611554  Vali weighted F1: 0.9617702  Vali macro F1 0.9445113 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.241885423660278
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0791848  Vali Loss: 0.1053631 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9645625  Vali macro F1 0.9476416 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.245378255844116
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0747044  Vali Loss: 0.1078254 Vali Accuracy: 0.9621514  Vali weighted F1: 0.9626769  Vali macro F1 0.9458344 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 6.241668224334717
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0757857  Vali Loss: 0.1090580 Vali Accuracy: 0.9601594  Vali weighted F1: 0.9607291  Vali macro F1 0.9429649 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.244360685348511
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0751850  Vali Loss: 0.1078501 Vali Accuracy: 0.9601594  Vali weighted F1: 0.9607291  Vali macro F1 0.9429649 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.240118980407715
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0752218  Vali Loss: 0.1082108 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9612397  Vali macro F1 0.9436050 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.25137734413147
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0719376  Vali Loss: 0.1093486 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9602485  Vali macro F1 0.9421562 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.260197877883911
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0751100  Vali Loss: 0.1071518 Vali Accuracy: 0.9621514  Vali weighted F1: 0.9627143  Vali macro F1 0.9446723 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 6.247893810272217
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0754300  Vali Loss: 0.1069950 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9621931  Vali macro F1 0.9441493 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.253071546554565
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0752141  Vali Loss: 0.1066136 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9622039  Vali macro F1 0.9440325 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.243591785430908
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0731924  Vali Loss: 0.1067008 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9622039  Vali macro F1 0.9440325 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.246624946594238
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0726885  Vali Loss: 0.1067765 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9622039  Vali macro F1 0.9440325 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 6.245419263839722
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0748054  Vali Loss: 0.1070052 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9622039  Vali macro F1 0.9440325 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9273997  Test weighted F1: 0.9268394  Test macro F1 0.8932770 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.287112712860107
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0771348  Vali Loss: 0.1114525 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9602335  Vali macro F1 0.9430563 
Validation loss decreased (inf --> 0.111452).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.261290788650513
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0759165  Vali Loss: 0.1047003 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9641500  Vali macro F1 0.9463422 
new best score!!!!
Validation loss decreased (0.111452 --> 0.104700).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.261866569519043
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0793838  Vali Loss: 0.1094091 Vali Accuracy: 0.9601594  Vali weighted F1: 0.9606597  Vali macro F1 0.9423917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.24414587020874
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0760731  Vali Loss: 0.1239601 Vali Accuracy: 0.9546813  Vali weighted F1: 0.9554027  Vali macro F1 0.9376629 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.263652324676514
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0758850  Vali Loss: 0.0988638 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663592  Vali macro F1 0.9493762 
new best score!!!!
Validation loss decreased (0.104700 --> 0.098864).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.273682117462158
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0769346  Vali Loss: 0.0976197 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9669317  Vali macro F1 0.9509572 
new best score!!!!
Validation loss decreased (0.098864 --> 0.097620).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.274554014205933
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0741279  Vali Loss: 0.1015137 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9649846  Vali macro F1 0.9481262 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.289614200592041
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0749826  Vali Loss: 0.1108643 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9601023  Vali macro F1 0.9428966 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.267646551132202
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0751240  Vali Loss: 0.0987359 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9660251  Vali macro F1 0.9487768 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.263518810272217
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0733743  Vali Loss: 0.1148162 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9588657  Vali macro F1 0.9420442 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.278955698013306
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0751978  Vali Loss: 0.1045477 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9621718  Vali macro F1 0.9434988 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.268784523010254
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0742083  Vali Loss: 0.1101702 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9602139  Vali macro F1 0.9436814 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.272531032562256
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0733926  Vali Loss: 0.1043847 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9639813  Vali macro F1 0.9466708 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.268898248672485
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0715046  Vali Loss: 0.1080455 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9612848  Vali macro F1 0.9439067 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.278308391571045
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0732023  Vali Loss: 0.1022235 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9649859  Vali macro F1 0.9481922 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.282766342163086
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0702576  Vali Loss: 0.1063701 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9646901  Vali macro F1 0.9475516 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.283371210098267
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0702322  Vali Loss: 0.1037474 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9645527  Vali macro F1 0.9474550 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.264694929122925
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0701575  Vali Loss: 0.1022496 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9650244  Vali macro F1 0.9475296 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.260394334793091
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0703204  Vali Loss: 0.1020343 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9645422  Vali macro F1 0.9467180 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.26279616355896
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0701742  Vali Loss: 0.1028296 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9650244  Vali macro F1 0.9475296 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.270370721817017
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0699616  Vali Loss: 0.1015312 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9655463  Vali macro F1 0.9484057 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9312791  Test weighted F1: 0.9307304  Test macro F1 0.8981032 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 17919
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014674 0.00018002 0.00097466 0.00124224 0.00048757 0.00060643]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.202468633651733
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4501715  Vali Loss: 0.9755142 Vali Accuracy: 0.6591252  Vali weighted F1: 0.5492415  Vali macro F1 0.2729349 
Validation loss decreased (inf --> 0.975514).  Saving model ...
Epoch: 2 cost time: 6.210424900054932
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8036101  Vali Loss: 0.7105251 Vali Accuracy: 0.7461036  Vali weighted F1: 0.6754102  Vali macro F1 0.4623013 
new best score!!!!
Validation loss decreased (0.975514 --> 0.710525).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.190479278564453
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6574944  Vali Loss: 0.6328824 Vali Accuracy: 0.7501257  Vali weighted F1: 0.6953140  Vali macro F1 0.4816065 
new best score!!!!
Validation loss decreased (0.710525 --> 0.632882).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.1846513748168945
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5885892  Vali Loss: 0.6013376 Vali Accuracy: 0.7647059  Vali weighted F1: 0.7084888  Vali macro F1 0.5074975 
new best score!!!!
Validation loss decreased (0.632882 --> 0.601338).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.187810897827148
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.5557970  Vali Loss: 0.5636214 Vali Accuracy: 0.7797888  Vali weighted F1: 0.7423306  Vali macro F1 0.5535515 
new best score!!!!
Validation loss decreased (0.601338 --> 0.563621).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.189379692077637
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.4740650  Vali Loss: 0.4247801 Vali Accuracy: 0.8285571  Vali weighted F1: 0.8022913  Vali macro F1 0.6196154 
new best score!!!!
Validation loss decreased (0.563621 --> 0.424780).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.192512512207031
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3753621  Vali Loss: 0.3473028 Vali Accuracy: 0.8622423  Vali weighted F1: 0.8432679  Vali macro F1 0.6715765 
new best score!!!!
Validation loss decreased (0.424780 --> 0.347303).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.1918816566467285
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.3154474  Vali Loss: 0.2851693 Vali Accuracy: 0.9069884  Vali weighted F1: 0.9049242  Vali macro F1 0.8535849 
new best score!!!!
Validation loss decreased (0.347303 --> 0.285169).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.19704794883728
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2645136  Vali Loss: 0.2295082 Vali Accuracy: 0.9170437  Vali weighted F1: 0.9177862  Vali macro F1 0.8808519 
new best score!!!!
Validation loss decreased (0.285169 --> 0.229508).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.187780141830444
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2233727  Vali Loss: 0.2414452 Vali Accuracy: 0.9110106  Vali weighted F1: 0.9138538  Vali macro F1 0.8762207 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.182865619659424
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2085175  Vali Loss: 0.2042353 Vali Accuracy: 0.9306184  Vali weighted F1: 0.9291711  Vali macro F1 0.9027744 
new best score!!!!
Validation loss decreased (0.229508 --> 0.204235).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.189950466156006
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.2002414  Vali Loss: 0.1996021 Vali Accuracy: 0.9301156  Vali weighted F1: 0.9296070  Vali macro F1 0.8982192 
new best score!!!!
Validation loss decreased (0.204235 --> 0.199602).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.187006711959839
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1864166  Vali Loss: 0.1844586 Vali Accuracy: 0.9381599  Vali weighted F1: 0.9382580  Vali macro F1 0.9109035 
new best score!!!!
Validation loss decreased (0.199602 --> 0.184459).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1878063678741455
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1739741  Vali Loss: 0.1747742 Vali Accuracy: 0.9381599  Vali weighted F1: 0.9390940  Vali macro F1 0.9156929 
new best score!!!!
Validation loss decreased (0.184459 --> 0.174774).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.209506511688232
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1707606  Vali Loss: 0.1675804 Vali Accuracy: 0.9401709  Vali weighted F1: 0.9393549  Vali macro F1 0.9195891 
new best score!!!!
Validation loss decreased (0.174774 --> 0.167580).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.19451904296875
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1615222  Vali Loss: 0.1590283 Vali Accuracy: 0.9462041  Vali weighted F1: 0.9459178  Vali macro F1 0.9240816 
new best score!!!!
Validation loss decreased (0.167580 --> 0.159028).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.184960842132568
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1631282  Vali Loss: 0.1537766 Vali Accuracy: 0.9467069  Vali weighted F1: 0.9467084  Vali macro F1 0.9220610 
new best score!!!!
Validation loss decreased (0.159028 --> 0.153777).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.186587810516357
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1504963  Vali Loss: 0.1573843 Vali Accuracy: 0.9502262  Vali weighted F1: 0.9509910  Vali macro F1 0.9318571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.190817594528198
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1472281  Vali Loss: 0.1491318 Vali Accuracy: 0.9477124  Vali weighted F1: 0.9481030  Vali macro F1 0.9320933 
new best score!!!!
Validation loss decreased (0.153777 --> 0.149132).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.186429262161255
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1438615  Vali Loss: 0.1565022 Vali Accuracy: 0.9411765  Vali weighted F1: 0.9422845  Vali macro F1 0.9266145 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.18684720993042
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1425871  Vali Loss: 0.1441482 Vali Accuracy: 0.9522373  Vali weighted F1: 0.9525406  Vali macro F1 0.9364850 
new best score!!!!
Validation loss decreased (0.149132 --> 0.144148).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.19710898399353
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1318794  Vali Loss: 0.1626610 Vali Accuracy: 0.9411765  Vali weighted F1: 0.9398868  Vali macro F1 0.9202657 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.200981855392456
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1371692  Vali Loss: 0.1377700 Vali Accuracy: 0.9527401  Vali weighted F1: 0.9530322  Vali macro F1 0.9384747 
new best score!!!!
Validation loss decreased (0.144148 --> 0.137770).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.179431915283203
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1243280  Vali Loss: 0.1297809 Vali Accuracy: 0.9567622  Vali weighted F1: 0.9571167  Vali macro F1 0.9413171 
new best score!!!!
Validation loss decreased (0.137770 --> 0.129781).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.186114311218262
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1223541  Vali Loss: 0.1518059 Vali Accuracy: 0.9457014  Vali weighted F1: 0.9454897  Vali macro F1 0.9296800 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.185196399688721
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1290141  Vali Loss: 0.1259466 Vali Accuracy: 0.9572650  Vali weighted F1: 0.9574123  Vali macro F1 0.9419976 
new best score!!!!
Validation loss decreased (0.129781 --> 0.125947).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.183375597000122
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1163715  Vali Loss: 0.1291731 Vali Accuracy: 0.9557567  Vali weighted F1: 0.9555180  Vali macro F1 0.9388886 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.183679580688477
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1140031  Vali Loss: 0.1295020 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9578828  Vali macro F1 0.9421025 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.197650194168091
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1093341  Vali Loss: 0.1564465 Vali Accuracy: 0.9497235  Vali weighted F1: 0.9499306  Vali macro F1 0.9336236 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.189957141876221
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1061791  Vali Loss: 0.1281934 Vali Accuracy: 0.9537456  Vali weighted F1: 0.9541302  Vali macro F1 0.9390649 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.191424608230591
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1028092  Vali Loss: 0.1277738 Vali Accuracy: 0.9587733  Vali weighted F1: 0.9591432  Vali macro F1 0.9428415 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.185119152069092
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0951731  Vali Loss: 0.1140742 Vali Accuracy: 0.9607843  Vali weighted F1: 0.9610926  Vali macro F1 0.9461859 
new best score!!!!
Validation loss decreased (0.125947 --> 0.114074).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.18574333190918
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0922441  Vali Loss: 0.1132568 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9625703  Vali macro F1 0.9476069 
new best score!!!!
Validation loss decreased (0.114074 --> 0.113257).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.186316251754761
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0899269  Vali Loss: 0.1132169 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9619748  Vali macro F1 0.9474083 
new best score!!!!
Validation loss decreased (0.113257 --> 0.113217).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.180347204208374
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0911702  Vali Loss: 0.1125386 Vali Accuracy: 0.9607843  Vali weighted F1: 0.9609897  Vali macro F1 0.9461994 
new best score!!!!
Validation loss decreased (0.113217 --> 0.112539).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.183194637298584
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0887594  Vali Loss: 0.1109252 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9615182  Vali macro F1 0.9460444 
new best score!!!!
Validation loss decreased (0.112539 --> 0.110925).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.196483612060547
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0889246  Vali Loss: 0.1137532 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9620780  Vali macro F1 0.9467768 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.188806533813477
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0892356  Vali Loss: 0.1115892 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9615858  Vali macro F1 0.9460160 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.1784348487854
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0876718  Vali Loss: 0.1075449 Vali Accuracy: 0.9607843  Vali weighted F1: 0.9609860  Vali macro F1 0.9452522 
new best score!!!!
Validation loss decreased (0.110925 --> 0.107545).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.183653831481934
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0887532  Vali Loss: 0.1092614 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9624648  Vali macro F1 0.9475454 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.184461832046509
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0910863  Vali Loss: 0.1080532 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9635676  Vali macro F1 0.9499146 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.187173366546631
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0879605  Vali Loss: 0.1090824 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9614178  Vali macro F1 0.9469597 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.179271936416626
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0879843  Vali Loss: 0.1072771 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9624788  Vali macro F1 0.9479591 
new best score!!!!
Validation loss decreased (0.107545 --> 0.107277).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.191372871398926
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0881468  Vali Loss: 0.1071055 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9618893  Vali macro F1 0.9475605 
new best score!!!!
Validation loss decreased (0.107277 --> 0.107105).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.19195556640625
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0869908  Vali Loss: 0.1098579 Vali Accuracy: 0.9607843  Vali weighted F1: 0.9608941  Vali macro F1 0.9460216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.182530641555786
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0875127  Vali Loss: 0.1076621 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9619672  Vali macro F1 0.9466667 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.185732126235962
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0863659  Vali Loss: 0.1056339 Vali Accuracy: 0.9638009  Vali weighted F1: 0.9638990  Vali macro F1 0.9480115 
new best score!!!!
Validation loss decreased (0.107105 --> 0.105634).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.172640562057495
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0854870  Vali Loss: 0.1069111 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9644510  Vali macro F1 0.9494354 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.172331094741821
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0857888  Vali Loss: 0.1104002 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9619255  Vali macro F1 0.9452260 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.177818775177002
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0862891  Vali Loss: 0.1111664 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9635117  Vali macro F1 0.9474086 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.1794140338897705
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0874388  Vali Loss: 0.1073822 Vali Accuracy: 0.9638009  Vali weighted F1: 0.9640656  Vali macro F1 0.9493688 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.199692964553833
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0834784  Vali Loss: 0.1077340 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9629373  Vali macro F1 0.9479975 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.1541712284088135
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0825928  Vali Loss: 0.1076647 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9629373  Vali macro F1 0.9479975 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.141530990600586
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0843274  Vali Loss: 0.1075225 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634856  Vali macro F1 0.9480802 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.143864393234253
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0835164  Vali Loss: 0.1083832 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9629998  Vali macro F1 0.9468772 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.144042730331421
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0822407  Vali Loss: 0.1085798 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9625217  Vali macro F1 0.9467749 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.138679027557373
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0832571  Vali Loss: 0.1075994 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634856  Vali macro F1 0.9480802 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 6.137020826339722
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0848071  Vali Loss: 0.1075392 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634856  Vali macro F1 0.9480802 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.1571125984191895
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0811410  Vali Loss: 0.1075558 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634856  Vali macro F1 0.9480802 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.146087884902954
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0841846  Vali Loss: 0.1075455 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9629900  Vali macro F1 0.9473126 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.160428047180176
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0831192  Vali Loss: 0.1076090 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634781  Vali macro F1 0.9477279 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.141660213470459
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0833288  Vali Loss: 0.1076463 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634781  Vali macro F1 0.9477279 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8515130  Test weighted F1: 0.8609945  Test macro F1 0.8319699 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.199820041656494
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0864407  Vali Loss: 0.1082977 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9624812  Vali macro F1 0.9470977 
Validation loss decreased (inf --> 0.108298).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.195464372634888
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0853070  Vali Loss: 0.1115616 Vali Accuracy: 0.9602815  Vali weighted F1: 0.9604517  Vali macro F1 0.9457506 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.1826324462890625
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0861050  Vali Loss: 0.1064609 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9624682  Vali macro F1 0.9459886 
new best score!!!!
Validation loss decreased (0.108298 --> 0.106461).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.661612272262573
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0845477  Vali Loss: 0.1075675 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634838  Vali macro F1 0.9487447 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.224869012832642
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0837767  Vali Loss: 0.1151452 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9630918  Vali macro F1 0.9486295 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.197292804718018
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0845461  Vali Loss: 0.1087147 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9624113  Vali macro F1 0.9474609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.207399368286133
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0849518  Vali Loss: 0.1074441 Vali Accuracy: 0.9638009  Vali weighted F1: 0.9640540  Vali macro F1 0.9495825 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.192966461181641
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0842509  Vali Loss: 0.1087034 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9630161  Vali macro F1 0.9475404 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.199845314025879
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0815455  Vali Loss: 0.1096613 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9630528  Vali macro F1 0.9479827 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.212440252304077
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0847516  Vali Loss: 0.1041660 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9649825  Vali macro F1 0.9500873 
new best score!!!!
Validation loss decreased (0.106461 --> 0.104166).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.204549789428711
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0803773  Vali Loss: 0.1060630 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9630118  Vali macro F1 0.9469269 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.223551034927368
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0807516  Vali Loss: 0.1048122 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9649411  Vali macro F1 0.9496320 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.2064173221588135
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0818626  Vali Loss: 0.1092888 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9628908  Vali macro F1 0.9471886 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.195530891418457
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0837706  Vali Loss: 0.1103695 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9646211  Vali macro F1 0.9490219 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.1861395835876465
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0837900  Vali Loss: 0.1076883 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9635082  Vali macro F1 0.9475956 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.1969311237335205
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0797751  Vali Loss: 0.1056408 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9630004  Vali macro F1 0.9472611 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.1900529861450195
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0769875  Vali Loss: 0.1055887 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9629916  Vali macro F1 0.9471953 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.201785326004028
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0783221  Vali Loss: 0.1058911 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634949  Vali macro F1 0.9480268 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.206229209899902
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0772708  Vali Loss: 0.1055393 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9625022  Vali macro F1 0.9464637 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.204956769943237
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0786362  Vali Loss: 0.1056042 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9630004  Vali macro F1 0.9472611 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 21 cost time: 6.192397117614746
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0792178  Vali Loss: 0.1055578 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9630004  Vali macro F1 0.9472611 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.194955825805664
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0792588  Vali Loss: 0.1054699 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634949  Vali macro F1 0.9480268 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.1966552734375
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0787474  Vali Loss: 0.1053134 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634704  Vali macro F1 0.9477331 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.211366415023804
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0793783  Vali Loss: 0.1052592 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634704  Vali macro F1 0.9477331 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.214317083358765
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0806225  Vali Loss: 0.1052620 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634704  Vali macro F1 0.9477331 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8551322  Test weighted F1: 0.8624594  Test macro F1 0.8281914 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014952 0.00018225 0.0010989  0.00140056 0.0005071  0.00063211]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.020979881286621
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.4589767  Vali Loss: 1.0390710 Vali Accuracy: 0.6531882  Vali weighted F1: 0.5416474  Vali macro F1 0.2696836 
Validation loss decreased (inf --> 1.039071).  Saving model ...
Epoch: 2 cost time: 6.011668682098389
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.8219071  Vali Loss: 0.7607723 Vali Accuracy: 0.7283567  Vali weighted F1: 0.6414045  Vali macro F1 0.4317018 
new best score!!!!
Validation loss decreased (1.039071 --> 0.760772).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.006437301635742
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.6647699  Vali Loss: 0.6651436 Vali Accuracy: 0.7439088  Vali weighted F1: 0.6867731  Vali macro F1 0.4896081 
new best score!!!!
Validation loss decreased (0.760772 --> 0.665144).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.002847194671631
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.5405253  Vali Loss: 0.5318203 Vali Accuracy: 0.7967859  Vali weighted F1: 0.7612017  Vali macro F1 0.5691782 
new best score!!!!
Validation loss decreased (0.665144 --> 0.531820).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.996466875076294
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.4364384  Vali Loss: 0.4605743 Vali Accuracy: 0.8216693  Vali weighted F1: 0.7968011  Vali macro F1 0.6114215 
new best score!!!!
Validation loss decreased (0.531820 --> 0.460574).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.016634702682495
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.3778636  Vali Loss: 0.4285605 Vali Accuracy: 0.8367030  Vali weighted F1: 0.8162942  Vali macro F1 0.6365179 
new best score!!!!
Validation loss decreased (0.460574 --> 0.428560).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.012598514556885
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.3392115  Vali Loss: 0.4067024 Vali Accuracy: 0.8496630  Vali weighted F1: 0.8278356  Vali macro F1 0.6525061 
new best score!!!!
Validation loss decreased (0.428560 --> 0.406702).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.179925441741943
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.3171256  Vali Loss: 0.3812333 Vali Accuracy: 0.8558839  Vali weighted F1: 0.8406445  Vali macro F1 0.6682276 
new best score!!!!
Validation loss decreased (0.406702 --> 0.381233).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.014088869094849
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.2873950  Vali Loss: 0.2994709 Vali Accuracy: 0.8838777  Vali weighted F1: 0.8678552  Vali macro F1 0.6986779 
new best score!!!!
Validation loss decreased (0.381233 --> 0.299471).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.017853736877441
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.2803423  Vali Loss: 0.2983323 Vali Accuracy: 0.8963193  Vali weighted F1: 0.8913126  Vali macro F1 0.7927837 
new best score!!!!
Validation loss decreased (0.299471 --> 0.298332).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.990047454833984
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.2570154  Vali Loss: 0.2696144 Vali Accuracy: 0.8937273  Vali weighted F1: 0.8784315  Vali macro F1 0.7107228 
new best score!!!!
Validation loss decreased (0.298332 --> 0.269614).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.00139045715332
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.2416079  Vali Loss: 0.2597832 Vali Accuracy: 0.9217211  Vali weighted F1: 0.9214494  Vali macro F1 0.8719966 
new best score!!!!
Validation loss decreased (0.269614 --> 0.259783).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.012080907821655
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.2198535  Vali Loss: 0.2390309 Vali Accuracy: 0.9263867  Vali weighted F1: 0.9261187  Vali macro F1 0.8956984 
new best score!!!!
Validation loss decreased (0.259783 --> 0.239031).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.984516859054565
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1909405  Vali Loss: 0.2308791 Vali Accuracy: 0.9243131  Vali weighted F1: 0.9219358  Vali macro F1 0.8894422 
new best score!!!!
Validation loss decreased (0.239031 --> 0.230879).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.993535757064819
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1708933  Vali Loss: 0.1928138 Vali Accuracy: 0.9388284  Vali weighted F1: 0.9385904  Vali macro F1 0.9133311 
new best score!!!!
Validation loss decreased (0.230879 --> 0.192814).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.023081541061401
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1630333  Vali Loss: 0.2027220 Vali Accuracy: 0.9393468  Vali weighted F1: 0.9398063  Vali macro F1 0.9173740 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.021594285964966
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1514426  Vali Loss: 0.1913550 Vali Accuracy: 0.9341628  Vali weighted F1: 0.9345864  Vali macro F1 0.9137731 
new best score!!!!
Validation loss decreased (0.192814 --> 0.191355).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.984068155288696
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.1571374  Vali Loss: 0.1841007 Vali Accuracy: 0.9367548  Vali weighted F1: 0.9367427  Vali macro F1 0.9130583 
new best score!!!!
Validation loss decreased (0.191355 --> 0.184101).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.976712703704834
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.1476780  Vali Loss: 0.1748924 Vali Accuracy: 0.9409020  Vali weighted F1: 0.9407573  Vali macro F1 0.9213664 
new best score!!!!
Validation loss decreased (0.184101 --> 0.174892).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.984534025192261
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.1366471  Vali Loss: 0.1758002 Vali Accuracy: 0.9440124  Vali weighted F1: 0.9442321  Vali macro F1 0.9237164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.975069761276245
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.1394619  Vali Loss: 0.1704286 Vali Accuracy: 0.9429756  Vali weighted F1: 0.9433416  Vali macro F1 0.9264533 
new best score!!!!
Validation loss decreased (0.174892 --> 0.170429).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.997986793518066
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.1339532  Vali Loss: 0.1554866 Vali Accuracy: 0.9481597  Vali weighted F1: 0.9483814  Vali macro F1 0.9302860 
new best score!!!!
Validation loss decreased (0.170429 --> 0.155487).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.99629807472229
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.1209008  Vali Loss: 0.1520830 Vali Accuracy: 0.9502333  Vali weighted F1: 0.9506043  Vali macro F1 0.9303339 
new best score!!!!
Validation loss decreased (0.155487 --> 0.152083).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.013062238693237
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.1192034  Vali Loss: 0.1830109 Vali Accuracy: 0.9393468  Vali weighted F1: 0.9401411  Vali macro F1 0.9167014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.980862379074097
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.1173330  Vali Loss: 0.1412580 Vali Accuracy: 0.9517885  Vali weighted F1: 0.9522029  Vali macro F1 0.9328784 
new best score!!!!
Validation loss decreased (0.152083 --> 0.141258).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.987851142883301
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.1048092  Vali Loss: 0.1262138 Vali Accuracy: 0.9559357  Vali weighted F1: 0.9560207  Vali macro F1 0.9382291 
new best score!!!!
Validation loss decreased (0.141258 --> 0.126214).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.985891342163086
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.1153789  Vali Loss: 0.1491702 Vali Accuracy: 0.9450492  Vali weighted F1: 0.9447172  Vali macro F1 0.9262921 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.989717721939087
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.1092906  Vali Loss: 0.1221181 Vali Accuracy: 0.9538621  Vali weighted F1: 0.9540627  Vali macro F1 0.9352931 
new best score!!!!
Validation loss decreased (0.126214 --> 0.122118).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.996306896209717
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0951525  Vali Loss: 0.1336163 Vali Accuracy: 0.9533437  Vali weighted F1: 0.9537473  Vali macro F1 0.9436584 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.996617794036865
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.1010883  Vali Loss: 0.1217963 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9617803  Vali macro F1 0.9542765 
new best score!!!!
Validation loss decreased (0.122118 --> 0.121796).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.013043403625488
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0912588  Vali Loss: 0.1153287 Vali Accuracy: 0.9590461  Vali weighted F1: 0.9590509  Vali macro F1 0.9492951 
new best score!!!!
Validation loss decreased (0.121796 --> 0.115329).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.995825290679932
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0989293  Vali Loss: 0.1238028 Vali Accuracy: 0.9580093  Vali weighted F1: 0.9585992  Vali macro F1 0.9520078 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.9969236850738525
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0981526  Vali Loss: 0.1160266 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9622729  Vali macro F1 0.9547390 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.9975502490997314
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0903124  Vali Loss: 0.1097304 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9616876  Vali macro F1 0.9535942 
new best score!!!!
Validation loss decreased (0.115329 --> 0.109730).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.984156131744385
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0938852  Vali Loss: 0.1057365 Vali Accuracy: 0.9590461  Vali weighted F1: 0.9592422  Vali macro F1 0.9439072 
new best score!!!!
Validation loss decreased (0.109730 --> 0.105737).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.993357181549072
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0840917  Vali Loss: 0.1090911 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9623002  Vali macro F1 0.9555174 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.988023996353149
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0848519  Vali Loss: 0.1240002 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9626720  Vali macro F1 0.9570106 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.007897138595581
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0758292  Vali Loss: 0.1074881 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9624657  Vali macro F1 0.9498678 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.998083114624023
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0769210  Vali Loss: 0.0967811 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9647723  Vali macro F1 0.9612033 
new best score!!!!
Validation loss decreased (0.105737 --> 0.096781).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.9787983894348145
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0762286  Vali Loss: 0.0959909 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9659456  Vali macro F1 0.9605545 
new best score!!!!
Validation loss decreased (0.096781 --> 0.095991).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.9774065017700195
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0832190  Vali Loss: 0.0981917 Vali Accuracy: 0.9652670  Vali weighted F1: 0.9654959  Vali macro F1 0.9612590 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.983266830444336
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0705421  Vali Loss: 0.0971937 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9681123  Vali macro F1 0.9620185 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.991383075714111
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0740532  Vali Loss: 0.1148697 Vali Accuracy: 0.9574909  Vali weighted F1: 0.9577037  Vali macro F1 0.9411456 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.993456125259399
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0699876  Vali Loss: 0.0978093 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9696892  Vali macro F1 0.9625470 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 5.986903429031372
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0651101  Vali Loss: 0.1023883 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9649563  Vali macro F1 0.9610319 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 6.002208471298218
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0589494  Vali Loss: 0.0870111 Vali Accuracy: 0.9709694  Vali weighted F1: 0.9711382  Vali macro F1 0.9651063 
new best score!!!!
Validation loss decreased (0.095991 --> 0.087011).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.9774956703186035
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0552296  Vali Loss: 0.0873489 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9721713  Vali macro F1 0.9657093 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.978418827056885
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0547025  Vali Loss: 0.0880191 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9696625  Vali macro F1 0.9630702 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 5.9723992347717285
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0560468  Vali Loss: 0.0869681 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9727260  Vali macro F1 0.9663138 
new best score!!!!
Validation loss decreased (0.087011 --> 0.086968).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 5.99462890625
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0536730  Vali Loss: 0.0860420 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731775  Vali macro F1 0.9675924 
new best score!!!!
Validation loss decreased (0.086968 --> 0.086042).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 5.983861923217773
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0553843  Vali Loss: 0.0854139 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731730  Vali macro F1 0.9673288 
new best score!!!!
Validation loss decreased (0.086042 --> 0.085414).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 5.9973673820495605
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0528779  Vali Loss: 0.0844953 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9737010  Vali macro F1 0.9683972 
new best score!!!!
Validation loss decreased (0.085414 --> 0.084495).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.004019498825073
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0522058  Vali Loss: 0.0848439 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731927  Vali macro F1 0.9670019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 5.984919786453247
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0538103  Vali Loss: 0.0854609 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9732124  Vali macro F1 0.9678615 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 5.975679159164429
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0522250  Vali Loss: 0.0852820 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9752731  Vali macro F1 0.9707904 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 5.976345777511597
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0545252  Vali Loss: 0.0827499 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747036  Vali macro F1 0.9692323 
new best score!!!!
Validation loss decreased (0.084495 --> 0.082750).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 5.987190008163452
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0530192  Vali Loss: 0.0831660 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9752293  Vali macro F1 0.9703251 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 5.987847805023193
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0518324  Vali Loss: 0.0873168 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9742916  Vali macro F1 0.9693446 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 5.998426675796509
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0523752  Vali Loss: 0.0872685 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9721406  Vali macro F1 0.9660117 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 5.9921019077301025
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0522571  Vali Loss: 0.0870641 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9721009  Vali macro F1 0.9661734 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 5.995496511459351
VALI: Epoch: 61, Steps: 68 | Train Loss: 0.0515412  Vali Loss: 0.0868510 Vali Accuracy: 0.9709694  Vali weighted F1: 0.9711326  Vali macro F1 0.9643864 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 62 cost time: 5.9802281856536865
VALI: Epoch: 62, Steps: 68 | Train Loss: 0.0499857  Vali Loss: 0.0857029 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747628  Vali macro F1 0.9699915 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 5.978193998336792
VALI: Epoch: 63, Steps: 68 | Train Loss: 0.0477352  Vali Loss: 0.0852074 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9721731  Vali macro F1 0.9662558 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 5.982961416244507
VALI: Epoch: 64, Steps: 68 | Train Loss: 0.0498025  Vali Loss: 0.0852627 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726659  Vali macro F1 0.9667001 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 5.976190567016602
VALI: Epoch: 65, Steps: 68 | Train Loss: 0.0503048  Vali Loss: 0.0843872 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9737303  Vali macro F1 0.9683253 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 5.976834297180176
VALI: Epoch: 66, Steps: 68 | Train Loss: 0.0508307  Vali Loss: 0.0850031 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9732005  Vali macro F1 0.9678141 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 67 cost time: 5.998688697814941
VALI: Epoch: 67, Steps: 68 | Train Loss: 0.0504583  Vali Loss: 0.0848817 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726892  Vali macro F1 0.9670420 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 6.018408298492432
VALI: Epoch: 68, Steps: 68 | Train Loss: 0.0511730  Vali Loss: 0.0848163 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726892  Vali macro F1 0.9670420 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 5.982378005981445
VALI: Epoch: 69, Steps: 68 | Train Loss: 0.0488030  Vali Loss: 0.0848004 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726892  Vali macro F1 0.9670420 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 5.977223873138428
VALI: Epoch: 70, Steps: 68 | Train Loss: 0.0484087  Vali Loss: 0.0845981 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726892  Vali macro F1 0.9670420 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 5.983103275299072
VALI: Epoch: 71, Steps: 68 | Train Loss: 0.0495565  Vali Loss: 0.0846259 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726892  Vali macro F1 0.9670420 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9119957  Test weighted F1: 0.9127436  Test macro F1 0.8545011 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.029080390930176
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0530358  Vali Loss: 0.0840789 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731772  Vali macro F1 0.9672218 
Validation loss decreased (inf --> 0.084079).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.002624273300171
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0528400  Vali Loss: 0.0857791 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731170  Vali macro F1 0.9676774 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.018951654434204
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0505634  Vali Loss: 0.0829276 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9732142  Vali macro F1 0.9673132 
new best score!!!!
Validation loss decreased (0.084079 --> 0.082928).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.010871887207031
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0524102  Vali Loss: 0.0850304 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9722043  Vali macro F1 0.9666099 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.010112762451172
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0528223  Vali Loss: 0.0847015 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731472  Vali macro F1 0.9661384 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.218360424041748
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0505807  Vali Loss: 0.0858825 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9737270  Vali macro F1 0.9681813 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 7.463674783706665
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0494751  Vali Loss: 0.0868059 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9742400  Vali macro F1 0.9686735 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 7.227100849151611
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0473713  Vali Loss: 0.0860348 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9758405  Vali macro F1 0.9711752 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 5.995606184005737
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0517225  Vali Loss: 0.0859357 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9727431  Vali macro F1 0.9672479 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 5.999541521072388
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0489399  Vali Loss: 0.0853346 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9752695  Vali macro F1 0.9705237 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 5.999191999435425
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0493996  Vali Loss: 0.0826606 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9736785  Vali macro F1 0.9677206 
new best score!!!!
Validation loss decreased (0.082928 --> 0.082661).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.013187885284424
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0480688  Vali Loss: 0.0850688 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9737375  Vali macro F1 0.9675833 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.011587619781494
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0486482  Vali Loss: 0.0829965 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9753037  Vali macro F1 0.9691577 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.003164052963257
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0490434  Vali Loss: 0.0817659 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9778137  Vali macro F1 0.9735338 
new best score!!!!
Validation loss decreased (0.082661 --> 0.081766).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 5.991727828979492
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0469662  Vali Loss: 0.0839597 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9752674  Vali macro F1 0.9696147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 5.994446516036987
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0470825  Vali Loss: 0.0847548 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747656  Vali macro F1 0.9692372 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 5.999363899230957
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0493195  Vali Loss: 0.0858021 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9736837  Vali macro F1 0.9677350 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.014416217803955
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0481265  Vali Loss: 0.0859378 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726169  Vali macro F1 0.9649821 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.002669095993042
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0467145  Vali Loss: 0.0853995 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751561  Vali macro F1 0.9685345 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 5.995757102966309
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0467047  Vali Loss: 0.0852723 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747095  Vali macro F1 0.9681806 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 5.999197721481323
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0463325  Vali Loss: 0.0853940 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747771  Vali macro F1 0.9686320 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 5.985625982284546
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0462029  Vali Loss: 0.0848645 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747966  Vali macro F1 0.9683786 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 5.977911949157715
Fine Tuning VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0461263  Vali Loss: 0.0848385 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747786  Vali macro F1 0.9686411 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 5.980043649673462
Fine Tuning VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0461518  Vali Loss: 0.0848774 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9742645  Vali macro F1 0.9678581 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 5.993083238601685
Fine Tuning VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0460163  Vali Loss: 0.0847438 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747786  Vali macro F1 0.9686411 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 5.992276430130005
Fine Tuning VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0444212  Vali Loss: 0.0846839 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747786  Vali macro F1 0.9686411 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.007564544677734
Fine Tuning VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0461832  Vali Loss: 0.0846709 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747786  Vali macro F1 0.9686411 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.017008543014526
Fine Tuning VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0460298  Vali Loss: 0.0846839 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747786  Vali macro F1 0.9686411 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.007494211196899
Fine Tuning VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0459611  Vali Loss: 0.0845874 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9752922  Vali macro F1 0.9694232 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9181552  Test weighted F1: 0.9202965  Test macro F1 0.8800220 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014912 0.00018139 0.00098425 0.00125471 0.00049529 0.00061237]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.21174168586731
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4530934  Vali Loss: 0.9833003 Vali Accuracy: 0.6620865  Vali weighted F1: 0.5513749  Vali macro F1 0.2697239 
Validation loss decreased (inf --> 0.983300).  Saving model ...
Epoch: 2 cost time: 6.096951246261597
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8096567  Vali Loss: 0.6895324 Vali Accuracy: 0.7786260  Vali weighted F1: 0.7148629  Vali macro F1 0.4916030 
new best score!!!!
Validation loss decreased (0.983300 --> 0.689532).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.088280916213989
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6488148  Vali Loss: 0.5721556 Vali Accuracy: 0.7745547  Vali weighted F1: 0.7278722  Vali macro F1 0.5137037 
new best score!!!!
Validation loss decreased (0.689532 --> 0.572156).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.086019515991211
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5508662  Vali Loss: 0.5307367 Vali Accuracy: 0.7959288  Vali weighted F1: 0.7510997  Vali macro F1 0.5433341 
new best score!!!!
Validation loss decreased (0.572156 --> 0.530737).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.103935956954956
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4452180  Vali Loss: 0.4136055 Vali Accuracy: 0.8351145  Vali weighted F1: 0.8085398  Vali macro F1 0.6195519 
new best score!!!!
Validation loss decreased (0.530737 --> 0.413605).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.105717182159424
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3688005  Vali Loss: 0.3299276 Vali Accuracy: 0.8758270  Vali weighted F1: 0.8557277  Vali macro F1 0.6818691 
new best score!!!!
Validation loss decreased (0.413605 --> 0.329928).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.091275215148926
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3249907  Vali Loss: 0.2943317 Vali Accuracy: 0.8829517  Vali weighted F1: 0.8663402  Vali macro F1 0.6940719 
new best score!!!!
Validation loss decreased (0.329928 --> 0.294332).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.081145524978638
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2882404  Vali Loss: 0.2548697 Vali Accuracy: 0.9262087  Vali weighted F1: 0.9271720  Vali macro F1 0.8866262 
new best score!!!!
Validation loss decreased (0.294332 --> 0.254870).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.099938631057739
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2493256  Vali Loss: 0.2226323 Vali Accuracy: 0.9272265  Vali weighted F1: 0.9265394  Vali macro F1 0.8837660 
new best score!!!!
Validation loss decreased (0.254870 --> 0.222632).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.089456081390381
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2270513  Vali Loss: 0.1893243 Vali Accuracy: 0.9353690  Vali weighted F1: 0.9355927  Vali macro F1 0.8958047 
new best score!!!!
Validation loss decreased (0.222632 --> 0.189324).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 9.796201944351196
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2013806  Vali Loss: 0.1714446 Vali Accuracy: 0.9450382  Vali weighted F1: 0.9445524  Vali macro F1 0.9186654 
new best score!!!!
Validation loss decreased (0.189324 --> 0.171445).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.119690418243408
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1831254  Vali Loss: 0.1787523 Vali Accuracy: 0.9435115  Vali weighted F1: 0.9428869  Vali macro F1 0.9149339 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.090294122695923
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1758207  Vali Loss: 0.1551860 Vali Accuracy: 0.9501272  Vali weighted F1: 0.9503300  Vali macro F1 0.9282959 
new best score!!!!
Validation loss decreased (0.171445 --> 0.155186).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.092697381973267
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1690408  Vali Loss: 0.1660016 Vali Accuracy: 0.9475827  Vali weighted F1: 0.9483778  Vali macro F1 0.9258376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.098713636398315
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1665856  Vali Loss: 0.1444622 Vali Accuracy: 0.9521628  Vali weighted F1: 0.9526346  Vali macro F1 0.9309523 
new best score!!!!
Validation loss decreased (0.155186 --> 0.144462).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.101056098937988
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1598329  Vali Loss: 0.1570674 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9560369  Vali macro F1 0.9320286 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.0893473625183105
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1454372  Vali Loss: 0.1402634 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9600388  Vali macro F1 0.9417216 
new best score!!!!
Validation loss decreased (0.144462 --> 0.140263).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.0854268074035645
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1385613  Vali Loss: 0.1689823 Vali Accuracy: 0.9501272  Vali weighted F1: 0.9495341  Vali macro F1 0.9289449 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.0842602252960205
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1390105  Vali Loss: 0.1541056 Vali Accuracy: 0.9526718  Vali weighted F1: 0.9534550  Vali macro F1 0.9328803 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.093031644821167
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1304918  Vali Loss: 0.1334698 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9560376  Vali macro F1 0.9373445 
new best score!!!!
Validation loss decreased (0.140263 --> 0.133470).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.087261199951172
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1247727  Vali Loss: 0.1189964 Vali Accuracy: 0.9623410  Vali weighted F1: 0.9622357  Vali macro F1 0.9450363 
new best score!!!!
Validation loss decreased (0.133470 --> 0.118996).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.068068027496338
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1237175  Vali Loss: 0.1790305 Vali Accuracy: 0.9445293  Vali weighted F1: 0.9421750  Vali macro F1 0.9220175 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.0938756465911865
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1248788  Vali Loss: 0.1334904 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9598902  Vali macro F1 0.9417058 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.093812465667725
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1189715  Vali Loss: 0.1149756 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9639406  Vali macro F1 0.9451706 
new best score!!!!
Validation loss decreased (0.118996 --> 0.114976).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.106493949890137
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1155679  Vali Loss: 0.1126289 Vali Accuracy: 0.9633588  Vali weighted F1: 0.9631120  Vali macro F1 0.9452797 
new best score!!!!
Validation loss decreased (0.114976 --> 0.112629).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.094106435775757
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1120674  Vali Loss: 0.1263010 Vali Accuracy: 0.9628499  Vali weighted F1: 0.9633832  Vali macro F1 0.9460415 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.083416223526001
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1078540  Vali Loss: 0.1249913 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9616394  Vali macro F1 0.9434202 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.0861451625823975
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1101812  Vali Loss: 0.1105954 Vali Accuracy: 0.9669211  Vali weighted F1: 0.9670559  Vali macro F1 0.9504139 
new best score!!!!
Validation loss decreased (0.112629 --> 0.110595).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.101899147033691
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1052962  Vali Loss: 0.1202886 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9638413  Vali macro F1 0.9464053 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.101768970489502
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1040349  Vali Loss: 0.1294521 Vali Accuracy: 0.9603053  Vali weighted F1: 0.9607274  Vali macro F1 0.9382269 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.093251943588257
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0996599  Vali Loss: 0.1215939 Vali Accuracy: 0.9628499  Vali weighted F1: 0.9631317  Vali macro F1 0.9450427 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.098584413528442
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0988515  Vali Loss: 0.1045948 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9695569  Vali macro F1 0.9554306 
new best score!!!!
Validation loss decreased (0.110595 --> 0.104595).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.1157004833221436
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0948075  Vali Loss: 0.0943958 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9701244  Vali macro F1 0.9547151 
new best score!!!!
Validation loss decreased (0.104595 --> 0.094396).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.0876381397247314
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0930269  Vali Loss: 0.1009523 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9682275  Vali macro F1 0.9544773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.084996938705444
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0903756  Vali Loss: 0.1149184 Vali Accuracy: 0.9623410  Vali weighted F1: 0.9618346  Vali macro F1 0.9436485 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.0917582511901855
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0969632  Vali Loss: 0.1134794 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9651076  Vali macro F1 0.9519027 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.087465286254883
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.1050070  Vali Loss: 0.0993579 Vali Accuracy: 0.9659033  Vali weighted F1: 0.9662149  Vali macro F1 0.9519494 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.0893332958221436
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0896908  Vali Loss: 0.0965753 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732252  Vali macro F1 0.9589295 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 6.090323209762573
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0823553  Vali Loss: 0.0897075 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727481  Vali macro F1 0.9582495 
new best score!!!!
Validation loss decreased (0.094396 --> 0.089707).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.090887546539307
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0787208  Vali Loss: 0.0886335 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9736882  Vali macro F1 0.9592380 
new best score!!!!
Validation loss decreased (0.089707 --> 0.088633).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.104860305786133
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0779703  Vali Loss: 0.0891968 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727291  Vali macro F1 0.9583727 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.1082682609558105
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0781815  Vali Loss: 0.0916276 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722411  Vali macro F1 0.9574138 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.084910154342651
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0757305  Vali Loss: 0.0882966 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732272  Vali macro F1 0.9588113 
new best score!!!!
Validation loss decreased (0.088633 --> 0.088297).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.082720994949341
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0761922  Vali Loss: 0.0888612 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727425  Vali macro F1 0.9583661 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.0704665184021
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0735726  Vali Loss: 0.0870682 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9735920  Vali macro F1 0.9593785 
new best score!!!!
Validation loss decreased (0.088297 --> 0.087068).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.07794713973999
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0758130  Vali Loss: 0.0873349 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732224  Vali macro F1 0.9588177 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.078527927398682
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0754185  Vali Loss: 0.0881616 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722438  Vali macro F1 0.9584007 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.081942081451416
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0736574  Vali Loss: 0.0870257 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9741885  Vali macro F1 0.9604871 
new best score!!!!
Validation loss decreased (0.087068 --> 0.087026).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.090043544769287
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0763171  Vali Loss: 0.0900525 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9731950  Vali macro F1 0.9587016 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.097561359405518
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0733230  Vali Loss: 0.0850223 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737318  Vali macro F1 0.9602734 
new best score!!!!
Validation loss decreased (0.087026 --> 0.085022).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.085806369781494
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0796054  Vali Loss: 0.0850611 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9742098  Vali macro F1 0.9608297 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.0932512283325195
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0737836  Vali Loss: 0.0878045 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737731  Vali macro F1 0.9601641 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.084239482879639
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0729588  Vali Loss: 0.0857648 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9752097  Vali macro F1 0.9616289 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.078557729721069
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0712962  Vali Loss: 0.0885290 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9717350  Vali macro F1 0.9565628 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.073268890380859
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0740811  Vali Loss: 0.0887497 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727573  Vali macro F1 0.9590523 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 6.083990573883057
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0735215  Vali Loss: 0.0874384 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737125  Vali macro F1 0.9593513 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.088053226470947
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0712954  Vali Loss: 0.0881601 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727310  Vali macro F1 0.9588918 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.102066278457642
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0706188  Vali Loss: 0.0877027 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9741967  Vali macro F1 0.9604444 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.097254514694214
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0697082  Vali Loss: 0.0876902 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732410  Vali macro F1 0.9591423 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.099684000015259
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0709813  Vali Loss: 0.0877520 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737428  Vali macro F1 0.9600028 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.077342748641968
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0713835  Vali Loss: 0.0877174 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9742393  Vali macro F1 0.9604777 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.092198610305786
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0713084  Vali Loss: 0.0876821 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9742393  Vali macro F1 0.9604777 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.081545829772949
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0707540  Vali Loss: 0.0876986 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737374  Vali macro F1 0.9596171 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.087007999420166
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0714641  Vali Loss: 0.0877157 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737374  Vali macro F1 0.9596171 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.088104248046875
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0704277  Vali Loss: 0.0877225 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737374  Vali macro F1 0.9596171 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8695535  Test weighted F1: 0.8763930  Test macro F1 0.8727953 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.1696038246154785
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0730354  Vali Loss: 0.0906556 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9717997  Vali macro F1 0.9568240 
Validation loss decreased (inf --> 0.090656).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.127704381942749
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0738777  Vali Loss: 0.0912723 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9717685  Vali macro F1 0.9568879 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.116082429885864
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0747212  Vali Loss: 0.0881596 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732339  Vali macro F1 0.9591685 
new best score!!!!
Validation loss decreased (0.090656 --> 0.088160).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.103973150253296
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0732041  Vali Loss: 0.0900154 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737735  Vali macro F1 0.9586310 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.11119270324707
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0719393  Vali Loss: 0.0879875 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737518  Vali macro F1 0.9590110 
new best score!!!!
Validation loss decreased (0.088160 --> 0.087987).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.125707626342773
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0728496  Vali Loss: 0.0897002 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732487  Vali macro F1 0.9581796 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.12053108215332
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0729840  Vali Loss: 0.0883763 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722615  Vali macro F1 0.9581334 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.1253907680511475
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0728709  Vali Loss: 0.0874924 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9747530  Vali macro F1 0.9607414 
new best score!!!!
Validation loss decreased (0.087987 --> 0.087492).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.120866298675537
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0714471  Vali Loss: 0.0874875 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732037  Vali macro F1 0.9590483 
new best score!!!!
Validation loss decreased (0.087492 --> 0.087488).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.137795686721802
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0718384  Vali Loss: 0.0898016 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737836  Vali macro F1 0.9600139 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.128087043762207
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0709236  Vali Loss: 0.0867647 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9736815  Vali macro F1 0.9592287 
new best score!!!!
Validation loss decreased (0.087488 --> 0.086765).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.116372346878052
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0709389  Vali Loss: 0.0872183 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737301  Vali macro F1 0.9592706 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.116103887557983
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0708987  Vali Loss: 0.0885716 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737653  Vali macro F1 0.9597353 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.111897706985474
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0693890  Vali Loss: 0.0867963 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722168  Vali macro F1 0.9576602 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.103149890899658
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0689323  Vali Loss: 0.0870560 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722447  Vali macro F1 0.9573750 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.100790500640869
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0690422  Vali Loss: 0.0853457 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9736971  Vali macro F1 0.9595735 
new best score!!!!
Validation loss decreased (0.086765 --> 0.085346).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.1171839237213135
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0690956  Vali Loss: 0.0850119 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737150  Vali macro F1 0.9598963 
new best score!!!!
Validation loss decreased (0.085346 --> 0.085012).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.120715618133545
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0679851  Vali Loss: 0.0893956 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727339  Vali macro F1 0.9578963 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.121532678604126
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0694151  Vali Loss: 0.0830986 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9752309  Vali macro F1 0.9618734 
new best score!!!!
Validation loss decreased (0.085012 --> 0.083099).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.122573614120483
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0687656  Vali Loss: 0.0853650 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737587  Vali macro F1 0.9593450 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.109555959701538
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0688052  Vali Loss: 0.0838053 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9772519  Vali macro F1 0.9647082 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.114432334899902
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0700031  Vali Loss: 0.0831478 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9767399  Vali macro F1 0.9635230 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.124548435211182
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0661999  Vali Loss: 0.0842752 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9767498  Vali macro F1 0.9638864 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.112828731536865
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0680620  Vali Loss: 0.0870213 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722487  Vali macro F1 0.9569847 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 25 cost time: 6.120488166809082
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0677310  Vali Loss: 0.0877543 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732380  Vali macro F1 0.9587466 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.111179351806641
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0643734  Vali Loss: 0.0871119 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737374  Vali macro F1 0.9596171 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.1337902545928955
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0701313  Vali Loss: 0.0823650 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9752113  Vali macro F1 0.9615893 
new best score!!!!
Validation loss decreased (0.083099 --> 0.082365).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 6.125794410705566
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0699356  Vali Loss: 0.0846913 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9747331  Vali macro F1 0.9609921 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.112006902694702
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0678219  Vali Loss: 0.0845068 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757487  Vali macro F1 0.9634491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.108951568603516
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0671875  Vali Loss: 0.0839222 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9747062  Vali macro F1 0.9603219 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.1112380027771
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0642711  Vali Loss: 0.0850822 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737290  Vali macro F1 0.9592709 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.119178771972656
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0641665  Vali Loss: 0.0834280 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9752438  Vali macro F1 0.9612421 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 33 cost time: 6.1269073486328125
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0628086  Vali Loss: 0.0834577 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9762150  Vali macro F1 0.9623245 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.126733303070068
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0646883  Vali Loss: 0.0833191 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9762413  Vali macro F1 0.9629950 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.132972240447998
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0631491  Vali Loss: 0.0842267 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9747843  Vali macro F1 0.9607857 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.136654376983643
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0654599  Vali Loss: 0.0839282 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9747587  Vali macro F1 0.9610757 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.122275352478027
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0650722  Vali Loss: 0.0839277 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757536  Vali macro F1 0.9624501 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 38 cost time: 6.114725589752197
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0636867  Vali Loss: 0.0838438 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757536  Vali macro F1 0.9624501 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 6.1173012256622314
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0644558  Vali Loss: 0.0837592 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757536  Vali macro F1 0.9624501 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 6.118226766586304
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0617514  Vali Loss: 0.0836082 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757536  Vali macro F1 0.9624501 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 6.1231818199157715
Fine Tuning VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0647211  Vali Loss: 0.0836359 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757536  Vali macro F1 0.9624501 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 6.120047092437744
Fine Tuning VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0622553  Vali Loss: 0.0836020 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757536  Vali macro F1 0.9624501 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8708983  Test weighted F1: 0.8773701  Test macro F1 0.8728281 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014914 0.00018464 0.000999   0.00124378 0.00051733 0.00061958]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.054826498031616
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.4842732  Vali Loss: 0.9784258 Vali Accuracy: 0.6889804  Vali weighted F1: 0.5879998  Vali macro F1 0.2762087 
Validation loss decreased (inf --> 0.978426).  Saving model ...
Epoch: 2 cost time: 6.060426712036133
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.8379429  Vali Loss: 0.6884153 Vali Accuracy: 0.7600412  Vali weighted F1: 0.6712562  Vali macro F1 0.4234561 
new best score!!!!
Validation loss decreased (0.978426 --> 0.688415).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.05138087272644
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.6606719  Vali Loss: 0.5832538 Vali Accuracy: 0.7919670  Vali weighted F1: 0.7401152  Vali macro F1 0.5173665 
new best score!!!!
Validation loss decreased (0.688415 --> 0.583254).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.049643278121948
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.5705296  Vali Loss: 0.5139274 Vali Accuracy: 0.8182286  Vali weighted F1: 0.7818692  Vali macro F1 0.5745431 
new best score!!!!
Validation loss decreased (0.583254 --> 0.513927).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.04313063621521
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.4927361  Vali Loss: 0.4209472 Vali Accuracy: 0.8486097  Vali weighted F1: 0.8269519  Vali macro F1 0.6392110 
new best score!!!!
Validation loss decreased (0.513927 --> 0.420947).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.039933443069458
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.4289053  Vali Loss: 0.3729950 Vali Accuracy: 0.8547889  Vali weighted F1: 0.8341164  Vali macro F1 0.6459137 
new best score!!!!
Validation loss decreased (0.420947 --> 0.372995).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.047574996948242
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.3646233  Vali Loss: 0.3516699 Vali Accuracy: 0.8681771  Vali weighted F1: 0.8480536  Vali macro F1 0.6627528 
new best score!!!!
Validation loss decreased (0.372995 --> 0.351670).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.0402398109436035
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.3312237  Vali Loss: 0.2913695 Vali Accuracy: 0.8877446  Vali weighted F1: 0.8737676  Vali macro F1 0.6952823 
new best score!!!!
Validation loss decreased (0.351670 --> 0.291370).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.053643465042114
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.2970712  Vali Loss: 0.2628801 Vali Accuracy: 0.9227600  Vali weighted F1: 0.9233937  Vali macro F1 0.8887185 
new best score!!!!
Validation loss decreased (0.291370 --> 0.262880).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.045957088470459
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.2511085  Vali Loss: 0.2156549 Vali Accuracy: 0.9346035  Vali weighted F1: 0.9333024  Vali macro F1 0.9045458 
new best score!!!!
Validation loss decreased (0.262880 --> 0.215655).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.043088674545288
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.2253210  Vali Loss: 0.2102854 Vali Accuracy: 0.9346035  Vali weighted F1: 0.9331164  Vali macro F1 0.9047533 
new best score!!!!
Validation loss decreased (0.215655 --> 0.210285).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.032670736312866
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.2138882  Vali Loss: 0.2069692 Vali Accuracy: 0.9351184  Vali weighted F1: 0.9351402  Vali macro F1 0.8968745 
new best score!!!!
Validation loss decreased (0.210285 --> 0.206969).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.039677619934082
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.2034585  Vali Loss: 0.1942867 Vali Accuracy: 0.9412976  Vali weighted F1: 0.9403166  Vali macro F1 0.9166475 
new best score!!!!
Validation loss decreased (0.206969 --> 0.194287).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.04445743560791
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1934288  Vali Loss: 0.1745767 Vali Accuracy: 0.9459320  Vali weighted F1: 0.9456152  Vali macro F1 0.9210657 
new best score!!!!
Validation loss decreased (0.194287 --> 0.174577).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.031317710876465
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1864289  Vali Loss: 0.1670034 Vali Accuracy: 0.9495366  Vali weighted F1: 0.9486964  Vali macro F1 0.9243863 
new best score!!!!
Validation loss decreased (0.174577 --> 0.167003).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.031233787536621
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1808240  Vali Loss: 0.1661879 Vali Accuracy: 0.9485067  Vali weighted F1: 0.9474335  Vali macro F1 0.9239034 
new best score!!!!
Validation loss decreased (0.167003 --> 0.166188).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.049611806869507
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1720185  Vali Loss: 0.2037851 Vali Accuracy: 0.9335736  Vali weighted F1: 0.9358515  Vali macro F1 0.9146027 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.037547588348389
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.1699621  Vali Loss: 0.1522510 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9543402  Vali macro F1 0.9326796 
new best score!!!!
Validation loss decreased (0.166188 --> 0.152251).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.061161041259766
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.1627231  Vali Loss: 0.1687007 Vali Accuracy: 0.9500515  Vali weighted F1: 0.9501066  Vali macro F1 0.9288818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.06194806098938
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.1636507  Vali Loss: 0.1601918 Vali Accuracy: 0.9552008  Vali weighted F1: 0.9538660  Vali macro F1 0.9350887 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.042325258255005
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.1608670  Vali Loss: 0.1499651 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9544919  Vali macro F1 0.9265205 
new best score!!!!
Validation loss decreased (0.152251 --> 0.149965).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.040880441665649
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.1466606  Vali Loss: 0.1466427 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9537457  Vali macro F1 0.9338136 
new best score!!!!
Validation loss decreased (0.149965 --> 0.146643).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.032179355621338
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.1413210  Vali Loss: 0.1571676 Vali Accuracy: 0.9510814  Vali weighted F1: 0.9516198  Vali macro F1 0.9307692 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.0220417976379395
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.1387414  Vali Loss: 0.1380506 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9585344  Vali macro F1 0.9400553 
new best score!!!!
Validation loss decreased (0.146643 --> 0.138051).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.028791904449463
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.1340570  Vali Loss: 0.1347254 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9636412  Vali macro F1 0.9500306 
new best score!!!!
Validation loss decreased (0.138051 --> 0.134725).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.02355694770813
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.1340880  Vali Loss: 0.1304635 Vali Accuracy: 0.9582904  Vali weighted F1: 0.9578034  Vali macro F1 0.9396065 
new best score!!!!
Validation loss decreased (0.134725 --> 0.130463).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.045711994171143
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.1287824  Vali Loss: 0.1304174 Vali Accuracy: 0.9577755  Vali weighted F1: 0.9569769  Vali macro F1 0.9383517 
new best score!!!!
Validation loss decreased (0.130463 --> 0.130417).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.048670530319214
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.1281693  Vali Loss: 0.1219953 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9647987  Vali macro F1 0.9486853 
new best score!!!!
Validation loss decreased (0.130417 --> 0.121995).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.042770624160767
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.1203951  Vali Loss: 0.1506030 Vali Accuracy: 0.9515963  Vali weighted F1: 0.9518891  Vali macro F1 0.9320035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.034437894821167
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.1180793  Vali Loss: 0.1207597 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9640558  Vali macro F1 0.9488815 
new best score!!!!
Validation loss decreased (0.121995 --> 0.120760).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.032835960388184
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.1166005  Vali Loss: 0.1169298 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9628446  Vali macro F1 0.9441869 
new best score!!!!
Validation loss decreased (0.120760 --> 0.116930).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.037023305892944
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.1127960  Vali Loss: 0.1237241 Vali Accuracy: 0.9618950  Vali weighted F1: 0.9616778  Vali macro F1 0.9389759 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.026356220245361
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.1103197  Vali Loss: 0.1133798 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9680362  Vali macro F1 0.9514309 
new best score!!!!
Validation loss decreased (0.116930 --> 0.113380).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.029720067977905
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.1151924  Vali Loss: 0.1163673 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9649440  Vali macro F1 0.9461557 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.025528192520142
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.1048044  Vali Loss: 0.1173991 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9642635  Vali macro F1 0.9457129 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.043278932571411
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.1058286  Vali Loss: 0.1112499 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9676837  Vali macro F1 0.9510804 
new best score!!!!
Validation loss decreased (0.113380 --> 0.111250).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.04140830039978
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.1051204  Vali Loss: 0.1045974 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9717681  Vali macro F1 0.9559267 
new best score!!!!
Validation loss decreased (0.111250 --> 0.104597).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.027205467224121
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0976281  Vali Loss: 0.1118555 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9698223  Vali macro F1 0.9533535 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.030789136886597
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0967768  Vali Loss: 0.1127616 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9638738  Vali macro F1 0.9422642 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.036228179931641
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0968090  Vali Loss: 0.1090912 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9656307  Vali macro F1 0.9457896 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.030007362365723
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.1038903  Vali Loss: 0.1277357 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9599835  Vali macro F1 0.9394599 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.037421703338623
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0956292  Vali Loss: 0.0967746 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9703266  Vali macro F1 0.9543989 
new best score!!!!
Validation loss decreased (0.104597 --> 0.096775).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.029851675033569
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0929917  Vali Loss: 0.1139564 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9644037  Vali macro F1 0.9453483 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.006655693054199
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0885728  Vali Loss: 0.0992047 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9688256  Vali macro F1 0.9527876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.0565104484558105
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0827517  Vali Loss: 0.1073253 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9653802  Vali macro F1 0.9440828 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.03945517539978
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0865597  Vali Loss: 0.0973490 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9722111  Vali macro F1 0.9567638 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.0431249141693115
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0793822  Vali Loss: 0.0947378 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9722883  Vali macro F1 0.9558853 
new best score!!!!
Validation loss decreased (0.096775 --> 0.094738).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.036534070968628
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0851487  Vali Loss: 0.0849161 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9749234  Vali macro F1 0.9583155 
new best score!!!!
Validation loss decreased (0.094738 --> 0.084916).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.0309529304504395
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0798096  Vali Loss: 0.0919737 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9714273  Vali macro F1 0.9543164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.025940179824829
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0738143  Vali Loss: 0.0851677 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9722614  Vali macro F1 0.9538703 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.020849704742432
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0818926  Vali Loss: 0.0868709 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9715412  Vali macro F1 0.9571611 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.023871183395386
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0743210  Vali Loss: 0.1016802 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9702986  Vali macro F1 0.9515273 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.026057958602905
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0812526  Vali Loss: 0.0902187 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9707346  Vali macro F1 0.9542029 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 6.040672063827515
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0649313  Vali Loss: 0.0849974 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9737492  Vali macro F1 0.9585426 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.028862714767456
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0638052  Vali Loss: 0.0843438 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9733232  Vali macro F1 0.9575707 
new best score!!!!
Validation loss decreased (0.084916 --> 0.084344).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.022777080535889
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0624452  Vali Loss: 0.0829312 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9738265  Vali macro F1 0.9580830 
new best score!!!!
Validation loss decreased (0.084344 --> 0.082931).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 6.032336235046387
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0624706  Vali Loss: 0.0823218 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748769  Vali macro F1 0.9602983 
new best score!!!!
Validation loss decreased (0.082931 --> 0.082322).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.029108285903931
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0625003  Vali Loss: 0.0839079 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748698  Vali macro F1 0.9599380 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.03702449798584
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0653556  Vali Loss: 0.0837357 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753695  Vali macro F1 0.9594972 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.035513162612915
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0625255  Vali Loss: 0.0829422 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748948  Vali macro F1 0.9599564 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.028956174850464
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0616155  Vali Loss: 0.0822639 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748070  Vali macro F1 0.9598217 
new best score!!!!
Validation loss decreased (0.082322 --> 0.082264).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.0548155307769775
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0602347  Vali Loss: 0.0833751 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9742740  Vali macro F1 0.9588976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.056983947753906
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0599455  Vali Loss: 0.0836967 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748248  Vali macro F1 0.9598784 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.03262996673584
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0602938  Vali Loss: 0.0813624 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747733  Vali macro F1 0.9600628 
new best score!!!!
Validation loss decreased (0.082264 --> 0.081362).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 6.042479515075684
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0607881  Vali Loss: 0.0819285 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9742740  Vali macro F1 0.9588976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 6.033129930496216
VALI: Epoch: 66, Steps: 69 | Train Loss: 0.0605694  Vali Loss: 0.0814913 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747901  Vali macro F1 0.9605322 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 6.0317018032073975
VALI: Epoch: 67, Steps: 69 | Train Loss: 0.0623286  Vali Loss: 0.0814371 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9754772  Vali macro F1 0.9607577 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.030475378036499
VALI: Epoch: 68, Steps: 69 | Train Loss: 0.0609556  Vali Loss: 0.0822149 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9752976  Vali macro F1 0.9610578 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.031256675720215
VALI: Epoch: 69, Steps: 69 | Train Loss: 0.0615208  Vali Loss: 0.0824062 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748752  Vali macro F1 0.9586024 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 70 cost time: 6.036443471908569
VALI: Epoch: 70, Steps: 69 | Train Loss: 0.0596308  Vali Loss: 0.0823136 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753920  Vali macro F1 0.9595123 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 6.220332384109497
VALI: Epoch: 71, Steps: 69 | Train Loss: 0.0592247  Vali Loss: 0.0821913 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753920  Vali macro F1 0.9595123 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 6.233242750167847
VALI: Epoch: 72, Steps: 69 | Train Loss: 0.0595713  Vali Loss: 0.0818324 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753920  Vali macro F1 0.9595123 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 6.217322587966919
VALI: Epoch: 73, Steps: 69 | Train Loss: 0.0582480  Vali Loss: 0.0821149 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753509  Vali macro F1 0.9594403 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 6.223750591278076
VALI: Epoch: 74, Steps: 69 | Train Loss: 0.0595436  Vali Loss: 0.0817573 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748578  Vali macro F1 0.9589511 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 75 cost time: 6.222510814666748
VALI: Epoch: 75, Steps: 69 | Train Loss: 0.0606897  Vali Loss: 0.0817485 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748578  Vali macro F1 0.9589511 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 6.205817937850952
VALI: Epoch: 76, Steps: 69 | Train Loss: 0.0604433  Vali Loss: 0.0817904 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748578  Vali macro F1 0.9589511 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 77 cost time: 6.2306013107299805
VALI: Epoch: 77, Steps: 69 | Train Loss: 0.0563320  Vali Loss: 0.0818158 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748578  Vali macro F1 0.9589511 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 78 cost time: 6.243922710418701
VALI: Epoch: 78, Steps: 69 | Train Loss: 0.0587512  Vali Loss: 0.0817582 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748578  Vali macro F1 0.9589511 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 79 cost time: 6.2681050300598145
VALI: Epoch: 79, Steps: 69 | Train Loss: 0.0590676  Vali Loss: 0.0817370 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748578  Vali macro F1 0.9589511 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9727952  Test weighted F1: 0.9720641  Test macro F1 0.9621404 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.255226135253906
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0619362  Vali Loss: 0.0811295 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753114  Vali macro F1 0.9606311 
Validation loss decreased (inf --> 0.081130).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.24242377281189
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0603211  Vali Loss: 0.0832272 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9736984  Vali macro F1 0.9591491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.242994546890259
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0599537  Vali Loss: 0.0822109 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9759462  Vali macro F1 0.9611637 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.229478597640991
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0602089  Vali Loss: 0.0816594 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9759422  Vali macro F1 0.9615045 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.236606121063232
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0604509  Vali Loss: 0.0836426 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9742604  Vali macro F1 0.9588684 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.209859371185303
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0590453  Vali Loss: 0.0818204 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748745  Vali macro F1 0.9594756 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.2173871994018555
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0584843  Vali Loss: 0.0831348 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753671  Vali macro F1 0.9605060 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.234541177749634
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0590164  Vali Loss: 0.0825036 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747264  Vali macro F1 0.9603836 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.242341756820679
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0591774  Vali Loss: 0.0807695 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9754056  Vali macro F1 0.9601159 
new best score!!!!
Validation loss decreased (0.081130 --> 0.080769).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.21898078918457
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0573043  Vali Loss: 0.0829894 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747411  Vali macro F1 0.9599386 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.213150978088379
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0576935  Vali Loss: 0.0805706 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9764369  Vali macro F1 0.9622267 
new best score!!!!
Validation loss decreased (0.080769 --> 0.080571).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.219214916229248
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0574696  Vali Loss: 0.0812236 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9737682  Vali macro F1 0.9579763 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.25121283531189
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0562223  Vali Loss: 0.0818627 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9742291  Vali macro F1 0.9587287 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.22730827331543
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0590168  Vali Loss: 0.0798919 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773854  Vali macro F1 0.9638262 
new best score!!!!
Validation loss decreased (0.080571 --> 0.079892).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.2187299728393555
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0585257  Vali Loss: 0.0815384 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9742831  Vali macro F1 0.9592470 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.23104190826416
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0555743  Vali Loss: 0.0813034 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9758094  Vali macro F1 0.9612012 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.250460147857666
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0552425  Vali Loss: 0.0833258 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747196  Vali macro F1 0.9596894 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.261858940124512
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0573167  Vali Loss: 0.0817944 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747735  Vali macro F1 0.9596735 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.221850872039795
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0583331  Vali Loss: 0.0811749 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9743326  Vali macro F1 0.9589867 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.2189531326293945
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0562359  Vali Loss: 0.0808594 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753267  Vali macro F1 0.9607362 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.223574638366699
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0562861  Vali Loss: 0.0802769 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753690  Vali macro F1 0.9608105 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.207064390182495
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0550959  Vali Loss: 0.0801833 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9758464  Vali macro F1 0.9616513 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.28694486618042
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0549929  Vali Loss: 0.0800622 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9758464  Vali macro F1 0.9616513 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.315266847610474
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0542712  Vali Loss: 0.0803068 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9769133  Vali macro F1 0.9627716 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 6.337379693984985
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0530452  Vali Loss: 0.0803326 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9769133  Vali macro F1 0.9627716 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.239130735397339
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0548181  Vali Loss: 0.0802461 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9769133  Vali macro F1 0.9627716 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.246145248413086
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0529891  Vali Loss: 0.0802726 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9769133  Vali macro F1 0.9627716 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.2337987422943115
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0559148  Vali Loss: 0.0802044 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9769133  Vali macro F1 0.9627716 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.241344690322876
Fine Tuning VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0549187  Vali Loss: 0.0802016 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9769133  Vali macro F1 0.9627716 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9710898  Test weighted F1: 0.9702481  Test macro F1 0.9599253 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014993 0.00018664 0.00140056 0.0014556  0.0005277  0.00064226]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.973909616470337
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.4819103  Vali Loss: 1.0914125 Vali Accuracy: 0.6689765  Vali weighted F1: 0.5652664  Vali macro F1 0.2693944 
Validation loss decreased (inf --> 1.091412).  Saving model ...
Epoch: 2 cost time: 5.98926043510437
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.8524762  Vali Loss: 0.6933211 Vali Accuracy: 0.7089552  Vali weighted F1: 0.6104238  Vali macro F1 0.3011177 
new best score!!!!
Validation loss decreased (1.091412 --> 0.693321).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.00222110748291
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.6444229  Vali Loss: 0.5594801 Vali Accuracy: 0.7862473  Vali weighted F1: 0.7399901  Vali macro F1 0.5150703 
new best score!!!!
Validation loss decreased (0.693321 --> 0.559480).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.990236043930054
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.5303436  Vali Loss: 0.4479062 Vali Accuracy: 0.8155650  Vali weighted F1: 0.7808161  Vali macro F1 0.5665758 
new best score!!!!
Validation loss decreased (0.559480 --> 0.447906).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.990217685699463
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.4113353  Vali Loss: 0.3286130 Vali Accuracy: 0.8912580  Vali weighted F1: 0.8847317  Vali macro F1 0.8371773 
new best score!!!!
Validation loss decreased (0.447906 --> 0.328613).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.985034465789795
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.3254012  Vali Loss: 0.2756672 Vali Accuracy: 0.9147122  Vali weighted F1: 0.9112116  Vali macro F1 0.8738617 
new best score!!!!
Validation loss decreased (0.328613 --> 0.275667).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.998512029647827
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.2645387  Vali Loss: 0.2242941 Vali Accuracy: 0.9323028  Vali weighted F1: 0.9309228  Vali macro F1 0.8968723 
new best score!!!!
Validation loss decreased (0.275667 --> 0.224294).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.004023790359497
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.2382785  Vali Loss: 0.2146189 Vali Accuracy: 0.9285714  Vali weighted F1: 0.9280435  Vali macro F1 0.8946651 
new best score!!!!
Validation loss decreased (0.224294 --> 0.214619).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.005136966705322
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.2170026  Vali Loss: 0.2109971 Vali Accuracy: 0.9371002  Vali weighted F1: 0.9348828  Vali macro F1 0.9054619 
new best score!!!!
Validation loss decreased (0.214619 --> 0.210997).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.999792575836182
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.2052585  Vali Loss: 0.1852959 Vali Accuracy: 0.9402985  Vali weighted F1: 0.9404667  Vali macro F1 0.9129852 
new best score!!!!
Validation loss decreased (0.210997 --> 0.185296).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.005559921264648
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1964487  Vali Loss: 0.1651086 Vali Accuracy: 0.9450959  Vali weighted F1: 0.9446895  Vali macro F1 0.9196995 
new best score!!!!
Validation loss decreased (0.185296 --> 0.165109).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.013909816741943
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1823002  Vali Loss: 0.1654828 Vali Accuracy: 0.9466951  Vali weighted F1: 0.9456402  Vali macro F1 0.9277556 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.000749588012695
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1782283  Vali Loss: 0.1705572 Vali Accuracy: 0.9397655  Vali weighted F1: 0.9394547  Vali macro F1 0.9183686 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.002847671508789
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1697334  Vali Loss: 0.1439840 Vali Accuracy: 0.9488273  Vali weighted F1: 0.9483720  Vali macro F1 0.9311156 
new best score!!!!
Validation loss decreased (0.165109 --> 0.143984).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.993598699569702
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1650191  Vali Loss: 0.1578613 Vali Accuracy: 0.9429638  Vali weighted F1: 0.9421325  Vali macro F1 0.9217447 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.9986655712127686
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1544371  Vali Loss: 0.1418236 Vali Accuracy: 0.9504264  Vali weighted F1: 0.9501278  Vali macro F1 0.9319482 
new best score!!!!
Validation loss decreased (0.143984 --> 0.141824).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.997785806655884
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1565955  Vali Loss: 0.1624238 Vali Accuracy: 0.9418977  Vali weighted F1: 0.9420236  Vali macro F1 0.9220089 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.999520778656006
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1531336  Vali Loss: 0.1295113 Vali Accuracy: 0.9552239  Vali weighted F1: 0.9550630  Vali macro F1 0.9383792 
new best score!!!!
Validation loss decreased (0.141824 --> 0.129511).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.086199998855591
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.1475394  Vali Loss: 0.1358238 Vali Accuracy: 0.9509595  Vali weighted F1: 0.9511404  Vali macro F1 0.9270784 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.00627589225769
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.1413589  Vali Loss: 0.1207379 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9572969  Vali macro F1 0.9414998 
new best score!!!!
Validation loss decreased (0.129511 --> 0.120738).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.002171039581299
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.1402729  Vali Loss: 0.1260664 Vali Accuracy: 0.9520256  Vali weighted F1: 0.9521745  Vali macro F1 0.9316624 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.017752170562744
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.1316671  Vali Loss: 0.1288990 Vali Accuracy: 0.9562900  Vali weighted F1: 0.9559167  Vali macro F1 0.9405752 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.011523008346558
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.1287531  Vali Loss: 0.1186451 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9545612  Vali macro F1 0.9389068 
new best score!!!!
Validation loss decreased (0.120738 --> 0.118645).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.985340356826782
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.1285740  Vali Loss: 0.1190251 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9546662  Vali macro F1 0.9378518 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.99264669418335
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.1226355  Vali Loss: 0.1318106 Vali Accuracy: 0.9520256  Vali weighted F1: 0.9512570  Vali macro F1 0.9285843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.003563404083252
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.1215460  Vali Loss: 0.1124495 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9593706  Vali macro F1 0.9411536 
new best score!!!!
Validation loss decreased (0.118645 --> 0.112450).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.006485939025879
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.1228526  Vali Loss: 0.1104377 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9596921  Vali macro F1 0.9422001 
new best score!!!!
Validation loss decreased (0.112450 --> 0.110438).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.004536151885986
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.1124996  Vali Loss: 0.1092937 Vali Accuracy: 0.9600213  Vali weighted F1: 0.9603413  Vali macro F1 0.9451649 
new best score!!!!
Validation loss decreased (0.110438 --> 0.109294).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.99807596206665
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.1092498  Vali Loss: 0.1250004 Vali Accuracy: 0.9530917  Vali weighted F1: 0.9533296  Vali macro F1 0.9314468 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.002806901931763
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.1081919  Vali Loss: 0.1185184 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9591805  Vali macro F1 0.9450674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.019215822219849
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.1148886  Vali Loss: 0.1055403 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9636664  Vali macro F1 0.9464892 
new best score!!!!
Validation loss decreased (0.109294 --> 0.105540).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.003948926925659
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.1028333  Vali Loss: 0.1040887 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9636480  Vali macro F1 0.9491505 
new best score!!!!
Validation loss decreased (0.105540 --> 0.104089).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.993102788925171
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.1011698  Vali Loss: 0.1093516 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9596095  Vali macro F1 0.9441943 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.009082078933716
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0998736  Vali Loss: 0.1091790 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9617259  Vali macro F1 0.9448237 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.0009589195251465
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0917750  Vali Loss: 0.0998253 Vali Accuracy: 0.9642857  Vali weighted F1: 0.9644195  Vali macro F1 0.9510470 
new best score!!!!
Validation loss decreased (0.104089 --> 0.099825).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.001838684082031
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0982922  Vali Loss: 0.1012275 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9647027  Vali macro F1 0.9513340 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.999508619308472
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0962762  Vali Loss: 0.0993269 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9650769  Vali macro F1 0.9511903 
new best score!!!!
Validation loss decreased (0.099825 --> 0.099327).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.000263452529907
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0873754  Vali Loss: 0.0957749 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9678258  Vali macro F1 0.9559322 
new best score!!!!
Validation loss decreased (0.099327 --> 0.095775).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.0250725746154785
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0867008  Vali Loss: 0.1081349 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9634339  Vali macro F1 0.9502378 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.018458127975464
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0877144  Vali Loss: 0.1082556 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9610294  Vali macro F1 0.9503479 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.0096094608306885
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0825352  Vali Loss: 0.1226971 Vali Accuracy: 0.9557569  Vali weighted F1: 0.9570542  Vali macro F1 0.9409920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.003491163253784
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0876975  Vali Loss: 0.1097471 Vali Accuracy: 0.9589552  Vali weighted F1: 0.9594407  Vali macro F1 0.9463599 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.003282308578491
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0829983  Vali Loss: 0.0905857 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9666818  Vali macro F1 0.9561089 
new best score!!!!
Validation loss decreased (0.095775 --> 0.090586).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.002927303314209
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0859434  Vali Loss: 0.0980006 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9617291  Vali macro F1 0.9384065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.999246597290039
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0783207  Vali Loss: 0.0996470 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9649183  Vali macro F1 0.9516091 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.998716831207275
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0750313  Vali Loss: 0.0855154 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9676461  Vali macro F1 0.9557342 
new best score!!!!
Validation loss decreased (0.090586 --> 0.085515).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.001757860183716
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0726584  Vali Loss: 0.0891553 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9691626  Vali macro F1 0.9584680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.0127222537994385
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0709971  Vali Loss: 0.0820369 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9698461  Vali macro F1 0.9567014 
new best score!!!!
Validation loss decreased (0.085515 --> 0.082037).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.003580331802368
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0723686  Vali Loss: 0.0982575 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9649483  Vali macro F1 0.9435032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.000062942504883
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0728626  Vali Loss: 0.0979581 Vali Accuracy: 0.9621535  Vali weighted F1: 0.9624350  Vali macro F1 0.9412821 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.994945764541626
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0685770  Vali Loss: 0.0786920 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9681828  Vali macro F1 0.9541541 
new best score!!!!
Validation loss decreased (0.082037 --> 0.078692).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 5.989164113998413
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0701127  Vali Loss: 0.0849917 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9660682  Vali macro F1 0.9466765 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 5.988840579986572
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0651066  Vali Loss: 0.0832598 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9684745  Vali macro F1 0.9563655 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 5.999698162078857
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0646496  Vali Loss: 0.0804901 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9700295  Vali macro F1 0.9593709 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 5.9930291175842285
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0705413  Vali Loss: 0.0836741 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9699269  Vali macro F1 0.9593550 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 5.9926066398620605
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0661509  Vali Loss: 0.0739084 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9712894  Vali macro F1 0.9626863 
new best score!!!!
Validation loss decreased (0.078692 --> 0.073908).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 6.001990079879761
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0645597  Vali Loss: 0.0768110 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9721158  Vali macro F1 0.9646871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 5.994809627532959
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0596157  Vali Loss: 0.0735197 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9735896  Vali macro F1 0.9638826 
new best score!!!!
Validation loss decreased (0.073908 --> 0.073520).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 5.988713026046753
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0585413  Vali Loss: 0.0853561 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9680044  Vali macro F1 0.9583749 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 5.986454486846924
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0606130  Vali Loss: 0.0717095 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9729029  Vali macro F1 0.9647318 
new best score!!!!
Validation loss decreased (0.073520 --> 0.071709).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 5.9852118492126465
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0586535  Vali Loss: 0.0739815 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9724130  Vali macro F1 0.9630761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 5.987478256225586
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0607496  Vali Loss: 0.0676683 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9751780  Vali macro F1 0.9681202 
new best score!!!!
Validation loss decreased (0.071709 --> 0.067668).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 5.9879679679870605
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0610694  Vali Loss: 0.0927031 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9676427  Vali macro F1 0.9584124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 5.990838527679443
VALI: Epoch: 64, Steps: 66 | Train Loss: 0.0654191  Vali Loss: 0.0896827 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9686493  Vali macro F1 0.9601159 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 6.005324602127075
VALI: Epoch: 65, Steps: 66 | Train Loss: 0.0576922  Vali Loss: 0.0851775 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9714967  Vali macro F1 0.9614679 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 6.012426137924194
VALI: Epoch: 66, Steps: 66 | Train Loss: 0.0526543  Vali Loss: 0.0763099 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9700393  Vali macro F1 0.9559945 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 5.978697299957275
VALI: Epoch: 67, Steps: 66 | Train Loss: 0.0510939  Vali Loss: 0.0765466 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9719966  Vali macro F1 0.9564355 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 68 cost time: 5.995091915130615
VALI: Epoch: 68, Steps: 66 | Train Loss: 0.0444527  Vali Loss: 0.0752945 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9709320  Vali macro F1 0.9557309 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 5.978206157684326
VALI: Epoch: 69, Steps: 66 | Train Loss: 0.0442043  Vali Loss: 0.0720019 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9709488  Vali macro F1 0.9561258 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 5.985498666763306
VALI: Epoch: 70, Steps: 66 | Train Loss: 0.0423869  Vali Loss: 0.0744422 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9720076  Vali macro F1 0.9587668 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 5.984705209732056
VALI: Epoch: 71, Steps: 66 | Train Loss: 0.0418001  Vali Loss: 0.0740742 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9735924  Vali macro F1 0.9640304 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 5.98687744140625
VALI: Epoch: 72, Steps: 66 | Train Loss: 0.0395337  Vali Loss: 0.0739145 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9719337  Vali macro F1 0.9578502 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 73 cost time: 6.000091552734375
VALI: Epoch: 73, Steps: 66 | Train Loss: 0.0428591  Vali Loss: 0.0725261 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9725047  Vali macro F1 0.9599866 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 6.01006555557251
VALI: Epoch: 74, Steps: 66 | Train Loss: 0.0416467  Vali Loss: 0.0719961 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9735865  Vali macro F1 0.9627271 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 5.999061107635498
VALI: Epoch: 75, Steps: 66 | Train Loss: 0.0404368  Vali Loss: 0.0718343 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9730596  Vali macro F1 0.9617522 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 5.999651193618774
VALI: Epoch: 76, Steps: 66 | Train Loss: 0.0415588  Vali Loss: 0.0717046 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9730592  Vali macro F1 0.9618548 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 5.991834402084351
VALI: Epoch: 77, Steps: 66 | Train Loss: 0.0399938  Vali Loss: 0.0711012 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9741223  Vali macro F1 0.9628894 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8604741  Test weighted F1: 0.8709063  Test macro F1 0.8376047 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.015764236450195
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0490554  Vali Loss: 0.0667474 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9756716  Vali macro F1 0.9690729 
Validation loss decreased (inf --> 0.066747).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.010416507720947
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0466072  Vali Loss: 0.0682496 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9761956  Vali macro F1 0.9698516 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.000436544418335
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0456297  Vali Loss: 0.0688304 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9751547  Vali macro F1 0.9685812 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.005728006362915
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0459722  Vali Loss: 0.0691478 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9751517  Vali macro F1 0.9680213 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.027488470077515
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0468282  Vali Loss: 0.0686747 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9745939  Vali macro F1 0.9675522 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.046263217926025
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0451080  Vali Loss: 0.0683450 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9766830  Vali macro F1 0.9696938 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.026560306549072
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0456862  Vali Loss: 0.0687052 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9730535  Vali macro F1 0.9638864 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.01921534538269
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0420920  Vali Loss: 0.0707582 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9746705  Vali macro F1 0.9675725 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.024897813796997
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0441054  Vali Loss: 0.0724616 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9730736  Vali macro F1 0.9646886 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.028119802474976
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0441423  Vali Loss: 0.0703249 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9761830  Vali macro F1 0.9694584 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.026206016540527
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0422307  Vali Loss: 0.0698845 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9746313  Vali macro F1 0.9674893 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.021146535873413
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0430511  Vali Loss: 0.0681962 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9751071  Vali macro F1 0.9679215 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.0240068435668945
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0436781  Vali Loss: 0.0683720 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9741216  Vali macro F1 0.9670303 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.02843165397644
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0420690  Vali Loss: 0.0689452 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9741216  Vali macro F1 0.9670303 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.050271272659302
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0429271  Vali Loss: 0.0696252 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9736112  Vali macro F1 0.9665424 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.030807256698608
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0422570  Vali Loss: 0.0693311 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9736112  Vali macro F1 0.9665424 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8745676  Test weighted F1: 0.8830843  Test macro F1 0.8488057 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001428  0.00018382 0.00096525 0.00125628 0.00053135 0.00063412]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.35186505317688
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4726256  Vali Loss: 1.0377813 Vali Accuracy: 0.6615931  Vali weighted F1: 0.5560134  Vali macro F1 0.2662327 
Validation loss decreased (inf --> 1.037781).  Saving model ...
Epoch: 2 cost time: 6.311747789382935
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8313763  Vali Loss: 0.6863382 Vali Accuracy: 0.7544394  Vali weighted F1: 0.6624873  Vali macro F1 0.4145151 
new best score!!!!
Validation loss decreased (1.037781 --> 0.686338).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.309036493301392
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6368512  Vali Loss: 0.5864374 Vali Accuracy: 0.7721969  Vali weighted F1: 0.7168952  Vali macro F1 0.4877308 
new best score!!!!
Validation loss decreased (0.686338 --> 0.586437).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.302886247634888
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5565689  Vali Loss: 0.5148067 Vali Accuracy: 0.8006088  Vali weighted F1: 0.7619873  Vali macro F1 0.5500393 
new best score!!!!
Validation loss decreased (0.586437 --> 0.514807).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.318875312805176
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4774671  Vali Loss: 0.4348156 Vali Accuracy: 0.8148148  Vali weighted F1: 0.7954452  Vali macro F1 0.6003456 
new best score!!!!
Validation loss decreased (0.514807 --> 0.434816).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.3303728103637695
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3839815  Vali Loss: 0.3404126 Vali Accuracy: 0.8888889  Vali weighted F1: 0.8841888  Vali macro F1 0.8338474 
new best score!!!!
Validation loss decreased (0.434816 --> 0.340413).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.326969623565674
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3050322  Vali Loss: 0.2695908 Vali Accuracy: 0.9091832  Vali weighted F1: 0.9075572  Vali macro F1 0.8683028 
new best score!!!!
Validation loss decreased (0.340413 --> 0.269591).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.304251432418823
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2612685  Vali Loss: 0.2284140 Vali Accuracy: 0.9223744  Vali weighted F1: 0.9216574  Vali macro F1 0.8802812 
new best score!!!!
Validation loss decreased (0.269591 --> 0.228414).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.312798738479614
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2285213  Vali Loss: 0.2036919 Vali Accuracy: 0.9315068  Vali weighted F1: 0.9320306  Vali macro F1 0.8964411 
new best score!!!!
Validation loss decreased (0.228414 --> 0.203692).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.3077473640441895
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2118331  Vali Loss: 0.1961382 Vali Accuracy: 0.9335363  Vali weighted F1: 0.9336343  Vali macro F1 0.8958788 
new best score!!!!
Validation loss decreased (0.203692 --> 0.196138).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.321454763412476
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2008936  Vali Loss: 0.1698670 Vali Accuracy: 0.9401319  Vali weighted F1: 0.9398110  Vali macro F1 0.9087706 
new best score!!!!
Validation loss decreased (0.196138 --> 0.169867).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.33928918838501
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1876812  Vali Loss: 0.1716203 Vali Accuracy: 0.9431761  Vali weighted F1: 0.9425714  Vali macro F1 0.9141212 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.322878360748291
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1745974  Vali Loss: 0.1509468 Vali Accuracy: 0.9477423  Vali weighted F1: 0.9476795  Vali macro F1 0.9217393 
new best score!!!!
Validation loss decreased (0.169867 --> 0.150947).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.468207597732544
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1650697  Vali Loss: 0.1714014 Vali Accuracy: 0.9446981  Vali weighted F1: 0.9456542  Vali macro F1 0.9196535 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.329476594924927
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1582253  Vali Loss: 0.1619481 Vali Accuracy: 0.9467275  Vali weighted F1: 0.9472218  Vali macro F1 0.9227459 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.420729875564575
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1542977  Vali Loss: 0.1476820 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9522192  Vali macro F1 0.9283330 
new best score!!!!
Validation loss decreased (0.150947 --> 0.147682).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.314693927764893
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1486256  Vali Loss: 0.1350299 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9570713  Vali macro F1 0.9353341 
new best score!!!!
Validation loss decreased (0.147682 --> 0.135030).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.316547393798828
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1461276  Vali Loss: 0.1906247 Vali Accuracy: 0.9304921  Vali weighted F1: 0.9325284  Vali macro F1 0.9046199 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.310807943344116
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1483915  Vali Loss: 0.1357542 Vali Accuracy: 0.9533232  Vali weighted F1: 0.9533854  Vali macro F1 0.9295734 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.311894655227661
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1388309  Vali Loss: 0.1314203 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9577311  Vali macro F1 0.9348962 
new best score!!!!
Validation loss decreased (0.135030 --> 0.131420).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.320260524749756
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1345083  Vali Loss: 0.1429265 Vali Accuracy: 0.9518011  Vali weighted F1: 0.9506182  Vali macro F1 0.9311569 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.3249289989471436
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1308069  Vali Loss: 0.1333059 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9534075  Vali macro F1 0.9308289 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.348492860794067
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1210939  Vali Loss: 0.1241899 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9548110  Vali macro F1 0.9324574 
new best score!!!!
Validation loss decreased (0.131420 --> 0.124190).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.328071594238281
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1172998  Vali Loss: 0.1340412 Vali Accuracy: 0.9482496  Vali weighted F1: 0.9490832  Vali macro F1 0.9242576 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.310149908065796
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1154074  Vali Loss: 0.1131467 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9591106  Vali macro F1 0.9374348 
new best score!!!!
Validation loss decreased (0.124190 --> 0.113147).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.320841073989868
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1215637  Vali Loss: 0.1133116 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9642035  Vali macro F1 0.9419246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.310874700546265
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1104816  Vali Loss: 0.1174412 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9563385  Vali macro F1 0.9329362 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.311603546142578
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1116136  Vali Loss: 0.1449999 Vali Accuracy: 0.9462202  Vali weighted F1: 0.9477210  Vali macro F1 0.9257761 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.3166584968566895
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1090201  Vali Loss: 0.1078431 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597197  Vali macro F1 0.9394055 
new best score!!!!
Validation loss decreased (0.113147 --> 0.107843).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.336641073226929
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1138908  Vali Loss: 0.1090153 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9624395  Vali macro F1 0.9414413 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.33439564704895
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1014537  Vali Loss: 0.0993878 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9662772  Vali macro F1 0.9466609 
new best score!!!!
Validation loss decreased (0.107843 --> 0.099388).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.3274314403533936
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0972160  Vali Loss: 0.1002149 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9666086  Vali macro F1 0.9482761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.314206600189209
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0968895  Vali Loss: 0.0918772 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9690377  Vali macro F1 0.9498702 
new best score!!!!
Validation loss decreased (0.099388 --> 0.091877).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.339621067047119
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0905126  Vali Loss: 0.0924195 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9679239  Vali macro F1 0.9454354 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.34646201133728
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0959601  Vali Loss: 0.0951131 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9658691  Vali macro F1 0.9435318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.332344055175781
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0899291  Vali Loss: 0.0891450 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9720146  Vali macro F1 0.9527099 
new best score!!!!
Validation loss decreased (0.091877 --> 0.089145).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.316148519515991
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0860629  Vali Loss: 0.0873047 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9691805  Vali macro F1 0.9481678 
new best score!!!!
Validation loss decreased (0.089145 --> 0.087305).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.313002824783325
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0821767  Vali Loss: 0.0871960 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9675556  Vali macro F1 0.9457736 
new best score!!!!
Validation loss decreased (0.087305 --> 0.087196).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.314365386962891
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0835563  Vali Loss: 0.0846393 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9717136  Vali macro F1 0.9513962 
new best score!!!!
Validation loss decreased (0.087196 --> 0.084639).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.318100690841675
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0811273  Vali Loss: 0.0841183 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9686130  Vali macro F1 0.9454512 
new best score!!!!
Validation loss decreased (0.084639 --> 0.084118).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.32018256187439
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0782401  Vali Loss: 0.0850452 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9730049  Vali macro F1 0.9559238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.312483787536621
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0771702  Vali Loss: 0.0797702 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9704028  Vali macro F1 0.9542672 
new best score!!!!
Validation loss decreased (0.084118 --> 0.079770).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.316883087158203
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0838931  Vali Loss: 0.0811495 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9716432  Vali macro F1 0.9539692 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.415327548980713
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0787660  Vali Loss: 0.0808039 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9716577  Vali macro F1 0.9473807 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.328604698181152
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0805406  Vali Loss: 0.0865942 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9672060  Vali macro F1 0.9466151 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.3183372020721436
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0715199  Vali Loss: 0.0888733 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9693729  Vali macro F1 0.9467847 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.326385259628296
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0686247  Vali Loss: 0.0821924 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9723758  Vali macro F1 0.9544261 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 48 cost time: 6.3319292068481445
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0653049  Vali Loss: 0.0695175 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787027  Vali macro F1 0.9630860 
new best score!!!!
Validation loss decreased (0.079770 --> 0.069518).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.312424421310425
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0602481  Vali Loss: 0.0674708 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786771  Vali macro F1 0.9629441 
new best score!!!!
Validation loss decreased (0.069518 --> 0.067471).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.342132568359375
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0574169  Vali Loss: 0.0661568 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786543  Vali macro F1 0.9622348 
new best score!!!!
Validation loss decreased (0.067471 --> 0.066157).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.309676885604858
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0573570  Vali Loss: 0.0660581 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781253  Vali macro F1 0.9607134 
new best score!!!!
Validation loss decreased (0.066157 --> 0.066058).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.310750246047974
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0585336  Vali Loss: 0.0670484 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786356  Vali macro F1 0.9618360 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.308187246322632
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0582736  Vali Loss: 0.0688434 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771669  Vali macro F1 0.9601058 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.308674097061157
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0579336  Vali Loss: 0.0661182 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786642  Vali macro F1 0.9626432 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.298484802246094
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0576095  Vali Loss: 0.0672202 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776613  Vali macro F1 0.9610562 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.322726488113403
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0560173  Vali Loss: 0.0676862 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771409  Vali macro F1 0.9594810 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 6.314889669418335
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0584688  Vali Loss: 0.0660991 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771423  Vali macro F1 0.9586578 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.323506832122803
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0552259  Vali Loss: 0.0664112 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771539  Vali macro F1 0.9590249 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.307355642318726
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0549328  Vali Loss: 0.0660491 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771106  Vali macro F1 0.9584895 
new best score!!!!
Validation loss decreased (0.066058 --> 0.066049).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.3173322677612305
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0586467  Vali Loss: 0.0659195 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771106  Vali macro F1 0.9584895 
new best score!!!!
Validation loss decreased (0.066049 --> 0.065919).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.313415050506592
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0540324  Vali Loss: 0.0658930 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776354  Vali macro F1 0.9591738 
new best score!!!!
Validation loss decreased (0.065919 --> 0.065893).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.31452202796936
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0560011  Vali Loss: 0.0658926 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771378  Vali macro F1 0.9595769 
new best score!!!!
Validation loss decreased (0.065893 --> 0.065893).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 6.311879634857178
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0557418  Vali Loss: 0.0661947 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771423  Vali macro F1 0.9586578 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 6.32888650894165
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0529682  Vali Loss: 0.0663084 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771729  Vali macro F1 0.9588238 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 6.313205003738403
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0542831  Vali Loss: 0.0660745 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776807  Vali macro F1 0.9599430 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 6.308252334594727
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0563594  Vali Loss: 0.0658203 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771423  Vali macro F1 0.9586578 
new best score!!!!
Validation loss decreased (0.065893 --> 0.065820).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 6.313079118728638
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0556249  Vali Loss: 0.0655358 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776635  Vali macro F1 0.9601473 
new best score!!!!
Validation loss decreased (0.065820 --> 0.065536).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 6.315493822097778
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0558557  Vali Loss: 0.0654624 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776635  Vali macro F1 0.9601473 
new best score!!!!
Validation loss decreased (0.065536 --> 0.065462).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 6.302735805511475
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0557766  Vali Loss: 0.0654450 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776655  Vali macro F1 0.9593389 
new best score!!!!
Validation loss decreased (0.065462 --> 0.065445).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 6.315531492233276
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0562424  Vali Loss: 0.0658082 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776435  Vali macro F1 0.9604615 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 6.317530632019043
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0575103  Vali Loss: 0.0655346 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781679  Vali macro F1 0.9610298 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 6.318002700805664
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0551107  Vali Loss: 0.0653281 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786651  Vali macro F1 0.9606966 
new best score!!!!
Validation loss decreased (0.065445 --> 0.065328).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 6.325317859649658
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0549844  Vali Loss: 0.0658212 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 6.316538095474243
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0557371  Vali Loss: 0.0654484 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791900  Vali macro F1 0.9622074 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 6.3276073932647705
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0556911  Vali Loss: 0.0655748 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776592  Vali macro F1 0.9604062 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 6.312816619873047
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0557807  Vali Loss: 0.0653223 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781679  Vali macro F1 0.9610298 
new best score!!!!
Validation loss decreased (0.065328 --> 0.065322).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 6.309905529022217
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0567905  Vali Loss: 0.0652264 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791900  Vali macro F1 0.9622074 
new best score!!!!
Validation loss decreased (0.065322 --> 0.065226).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 6.327938795089722
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0531538  Vali Loss: 0.0650762 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791746  Vali macro F1 0.9624157 
new best score!!!!
Validation loss decreased (0.065226 --> 0.065076).  Saving model ...
new best score!!!!
Epoch: 79 cost time: 6.31674861907959
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0554013  Vali Loss: 0.0652075 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786937  Vali macro F1 0.9617305 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 6.331375598907471
VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0541658  Vali Loss: 0.0650767 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786825  Vali macro F1 0.9614555 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 6.336944580078125
VALI: Epoch: 81, Steps: 70 | Train Loss: 0.0580803  Vali Loss: 0.0654827 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781769  Vali macro F1 0.9609467 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 6.353268623352051
VALI: Epoch: 82, Steps: 70 | Train Loss: 0.0553629  Vali Loss: 0.0654559 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781679  Vali macro F1 0.9610298 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 6.345379114151001
VALI: Epoch: 83, Steps: 70 | Train Loss: 0.0564917  Vali Loss: 0.0649596 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792024  Vali macro F1 0.9621300 
new best score!!!!
Validation loss decreased (0.065076 --> 0.064960).  Saving model ...
new best score!!!!
Epoch: 84 cost time: 6.36523175239563
VALI: Epoch: 84, Steps: 70 | Train Loss: 0.0558523  Vali Loss: 0.0651906 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 6.298237562179565
VALI: Epoch: 85, Steps: 70 | Train Loss: 0.0557607  Vali Loss: 0.0653069 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781851  Vali macro F1 0.9608251 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 6.30588173866272
VALI: Epoch: 86, Steps: 70 | Train Loss: 0.0547383  Vali Loss: 0.0654681 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781851  Vali macro F1 0.9608251 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 6.305666208267212
VALI: Epoch: 87, Steps: 70 | Train Loss: 0.0572545  Vali Loss: 0.0652225 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781851  Vali macro F1 0.9608251 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 88 cost time: 6.3173558712005615
VALI: Epoch: 88, Steps: 70 | Train Loss: 0.0555271  Vali Loss: 0.0652155 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 89 cost time: 6.353020906448364
VALI: Epoch: 89, Steps: 70 | Train Loss: 0.0559926  Vali Loss: 0.0651470 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 6.383419036865234
VALI: Epoch: 90, Steps: 70 | Train Loss: 0.0553264  Vali Loss: 0.0651034 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 91 cost time: 6.3234193325042725
VALI: Epoch: 91, Steps: 70 | Train Loss: 0.0572349  Vali Loss: 0.0650442 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 92 cost time: 6.3339433670043945
VALI: Epoch: 92, Steps: 70 | Train Loss: 0.0556264  Vali Loss: 0.0650627 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 93 cost time: 6.308924436569214
VALI: Epoch: 93, Steps: 70 | Train Loss: 0.0555574  Vali Loss: 0.0650647 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 94 cost time: 6.328860521316528
VALI: Epoch: 94, Steps: 70 | Train Loss: 0.0552285  Vali Loss: 0.0650626 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 95 cost time: 6.315044403076172
VALI: Epoch: 95, Steps: 70 | Train Loss: 0.0570104  Vali Loss: 0.0650632 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 96 cost time: 6.306776523590088
VALI: Epoch: 96, Steps: 70 | Train Loss: 0.0547009  Vali Loss: 0.0650597 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 97 cost time: 6.400291919708252
VALI: Epoch: 97, Steps: 70 | Train Loss: 0.0555449  Vali Loss: 0.0650603 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 98 cost time: 6.39792537689209
VALI: Epoch: 98, Steps: 70 | Train Loss: 0.0543921  Vali Loss: 0.0650594 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786896  Vali macro F1 0.9617079 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9293988  Test weighted F1: 0.9290678  Test macro F1 0.9107420 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.328077793121338
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0561094  Vali Loss: 0.0644281 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787080  Vali macro F1 0.9603385 
Validation loss decreased (inf --> 0.064428).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.315176010131836
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0557202  Vali Loss: 0.0656740 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776571  Vali macro F1 0.9603935 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.29874062538147
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0568099  Vali Loss: 0.0658356 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786749  Vali macro F1 0.9618218 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.304884910583496
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0552068  Vali Loss: 0.0667172 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771578  Vali macro F1 0.9597895 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.343887567520142
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0559573  Vali Loss: 0.0670736 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776525  Vali macro F1 0.9603782 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.309795618057251
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0554455  Vali Loss: 0.0659593 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771992  Vali macro F1 0.9598321 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.314104080200195
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0540984  Vali Loss: 0.0656825 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777207  Vali macro F1 0.9605097 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.337184429168701
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0542499  Vali Loss: 0.0652011 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782354  Vali macro F1 0.9611587 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.305952072143555
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0533626  Vali Loss: 0.0656428 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776162  Vali macro F1 0.9602558 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.301878929138184
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0556304  Vali Loss: 0.0643364 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777195  Vali macro F1 0.9605515 
new best score!!!!
Validation loss decreased (0.064428 --> 0.064336).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.322779178619385
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0548135  Vali Loss: 0.0627951 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796338  Vali macro F1 0.9635722 
new best score!!!!
Validation loss decreased (0.064336 --> 0.062795).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.309462308883667
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0533830  Vali Loss: 0.0661778 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787154  Vali macro F1 0.9623619 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.306509971618652
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0570295  Vali Loss: 0.0651382 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776752  Vali macro F1 0.9603997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.304732322692871
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0535614  Vali Loss: 0.0626515 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781984  Vali macro F1 0.9603438 
new best score!!!!
Validation loss decreased (0.062795 --> 0.062651).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.316026926040649
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0520508  Vali Loss: 0.0656732 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787164  Vali macro F1 0.9616928 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.329671382904053
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0554193  Vali Loss: 0.0630443 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807388  Vali macro F1 0.9657942 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.332254886627197
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0538908  Vali Loss: 0.0623323 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807625  Vali macro F1 0.9675256 
new best score!!!!
Validation loss decreased (0.062651 --> 0.062332).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.3124847412109375
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0521561  Vali Loss: 0.0603407 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812847  Vali macro F1 0.9705192 
new best score!!!!
Validation loss decreased (0.062332 --> 0.060341).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.31125545501709
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0521965  Vali Loss: 0.0625978 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807256  Vali macro F1 0.9695508 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.314111232757568
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0505128  Vali Loss: 0.0629052 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812780  Vali macro F1 0.9704919 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.325786590576172
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0521196  Vali Loss: 0.0630293 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787751  Vali macro F1 0.9624535 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.31382942199707
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0521508  Vali Loss: 0.0608908 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822654  Vali macro F1 0.9718575 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.319038152694702
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0501768  Vali Loss: 0.0630983 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823144  Vali macro F1 0.9713180 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.3405921459198
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0513507  Vali Loss: 0.0611991 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817760  Vali macro F1 0.9700205 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.345227956771851
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0494495  Vali Loss: 0.0610107 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832924  Vali macro F1 0.9729986 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.322296857833862
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0502645  Vali Loss: 0.0605778 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832924  Vali macro F1 0.9729986 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.315375804901123
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0505967  Vali Loss: 0.0607044 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822873  Vali macro F1 0.9716155 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.306882619857788
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0495990  Vali Loss: 0.0608765 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827813  Vali macro F1 0.9721327 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 6.306513786315918
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0491452  Vali Loss: 0.0608936 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827813  Vali macro F1 0.9721327 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.3101396560668945
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0493931  Vali Loss: 0.0608280 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832914  Vali macro F1 0.9730405 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.296161651611328
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0501761  Vali Loss: 0.0607553 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827962  Vali macro F1 0.9725215 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.3100361824035645
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0498671  Vali Loss: 0.0607358 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827962  Vali macro F1 0.9725215 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.360284328460693
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0486913  Vali Loss: 0.0606352 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832924  Vali macro F1 0.9729986 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9293069  Test weighted F1: 0.9289588  Test macro F1 0.9089800 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014223 0.00017892 0.00098039 0.00120192 0.00047619 0.00059916]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.49660062789917
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.4497241  Vali Loss: 0.9508634 Vali Accuracy: 0.6753823  Vali weighted F1: 0.5693993  Vali macro F1 0.2756521 
Validation loss decreased (inf --> 0.950863).  Saving model ...
Epoch: 2 cost time: 6.488637447357178
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.7966851  Vali Loss: 0.6611837 Vali Accuracy: 0.7824371  Vali weighted F1: 0.7255503  Vali macro F1 0.5047326 
new best score!!!!
Validation loss decreased (0.950863 --> 0.661184).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.484034538269043
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.6340581  Vali Loss: 0.5477733 Vali Accuracy: 0.8036507  Vali weighted F1: 0.7593763  Vali macro F1 0.5561699 
new best score!!!!
Validation loss decreased (0.661184 --> 0.547773).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.485748052597046
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.5243402  Vali Loss: 0.4553716 Vali Accuracy: 0.8302911  Vali weighted F1: 0.8101990  Vali macro F1 0.6266235 
new best score!!!!
Validation loss decreased (0.547773 --> 0.455372).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.484019041061401
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.4394247  Vali Loss: 0.3772680 Vali Accuracy: 0.8534780  Vali weighted F1: 0.8284727  Vali macro F1 0.6470905 
new best score!!!!
Validation loss decreased (0.455372 --> 0.377268).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.495431423187256
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.3606881  Vali Loss: 0.3797194 Vali Accuracy: 0.8549581  Vali weighted F1: 0.8270259  Vali macro F1 0.6415647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.502682209014893
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.3164146  Vali Loss: 0.2743556 Vali Accuracy: 0.8894919  Vali weighted F1: 0.8743731  Vali macro F1 0.6997169 
new best score!!!!
Validation loss decreased (0.377268 --> 0.274356).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.491327524185181
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.2912333  Vali Loss: 0.2474996 Vali Accuracy: 0.8978786  Vali weighted F1: 0.8823132  Vali macro F1 0.7121939 
new best score!!!!
Validation loss decreased (0.274356 --> 0.247500).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.5029144287109375
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.2702669  Vali Loss: 0.2333645 Vali Accuracy: 0.9037987  Vali weighted F1: 0.8879632  Vali macro F1 0.7175614 
new best score!!!!
Validation loss decreased (0.247500 --> 0.233365).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.498536825180054
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.2563685  Vali Loss: 0.2256007 Vali Accuracy: 0.9087321  Vali weighted F1: 0.8935157  Vali macro F1 0.7257794 
new best score!!!!
Validation loss decreased (0.233365 --> 0.225601).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.494303464889526
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.2424492  Vali Loss: 0.2463180 Vali Accuracy: 0.9008387  Vali weighted F1: 0.8838308  Vali macro F1 0.7145739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.503006458282471
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.2386575  Vali Loss: 0.2878492 Vali Accuracy: 0.8929452  Vali weighted F1: 0.8768889  Vali macro F1 0.7068113 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.4857871532440186
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.2409517  Vali Loss: 0.2090828 Vali Accuracy: 0.9107055  Vali weighted F1: 0.8953361  Vali macro F1 0.7286466 
new best score!!!!
Validation loss decreased (0.225601 --> 0.209083).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.4858996868133545
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.2127220  Vali Loss: 0.1960422 Vali Accuracy: 0.9472126  Vali weighted F1: 0.9476459  Vali macro F1 0.9178691 
new best score!!!!
Validation loss decreased (0.209083 --> 0.196042).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.5099146366119385
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1801388  Vali Loss: 0.1477553 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9598640  Vali macro F1 0.9406618 
new best score!!!!
Validation loss decreased (0.196042 --> 0.147755).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.51249361038208
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.1659046  Vali Loss: 0.1371204 Vali Accuracy: 0.9555994  Vali weighted F1: 0.9555630  Vali macro F1 0.9380807 
new best score!!!!
Validation loss decreased (0.147755 --> 0.137120).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.5029261112213135
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.1432512  Vali Loss: 0.1318533 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9603787  Vali macro F1 0.9453555 
new best score!!!!
Validation loss decreased (0.137120 --> 0.131853).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.49502968788147
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.1362033  Vali Loss: 0.1300011 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9604968  Vali macro F1 0.9454644 
new best score!!!!
Validation loss decreased (0.131853 --> 0.130001).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.494878768920898
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.1331667  Vali Loss: 0.1300007 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9606614  Vali macro F1 0.9473788 
new best score!!!!
Validation loss decreased (0.130001 --> 0.130001).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.511568784713745
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.1317727  Vali Loss: 0.1125682 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9642840  Vali macro F1 0.9528419 
new best score!!!!
Validation loss decreased (0.130001 --> 0.112568).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.531205415725708
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.1236032  Vali Loss: 0.1335114 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9617763  Vali macro F1 0.9477236 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.490772724151611
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.1236712  Vali Loss: 0.1119052 Vali Accuracy: 0.9659595  Vali weighted F1: 0.9662136  Vali macro F1 0.9543541 
new best score!!!!
Validation loss decreased (0.112568 --> 0.111905).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.51008939743042
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.1169107  Vali Loss: 0.1283418 Vali Accuracy: 0.9570794  Vali weighted F1: 0.9571861  Vali macro F1 0.9444410 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.498446941375732
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.1149676  Vali Loss: 0.1050379 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9652926  Vali macro F1 0.9543088 
new best score!!!!
Validation loss decreased (0.111905 --> 0.105038).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.492355108261108
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.1157250  Vali Loss: 0.1144332 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9649905  Vali macro F1 0.9534610 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.484807968139648
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.1096677  Vali Loss: 0.1117723 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9665525  Vali macro F1 0.9556611 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.491101503372192
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.1067590  Vali Loss: 0.1101440 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9672832  Vali macro F1 0.9574703 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.558859348297119
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.1070618  Vali Loss: 0.1068221 Vali Accuracy: 0.9654662  Vali weighted F1: 0.9659619  Vali macro F1 0.9553140 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.49947190284729
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.1098093  Vali Loss: 0.0969389 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9686622  Vali macro F1 0.9592812 
new best score!!!!
Validation loss decreased (0.105038 --> 0.096939).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.52550482749939
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.1057381  Vali Loss: 0.1017897 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9695866  Vali macro F1 0.9599216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.508970499038696
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0975977  Vali Loss: 0.1011102 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9692215  Vali macro F1 0.9604463 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.493435382843018
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0951851  Vali Loss: 0.0988884 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9703745  Vali macro F1 0.9616575 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.500998497009277
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.1028338  Vali Loss: 0.1014791 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9668502  Vali macro F1 0.9568252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.498999357223511
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0948573  Vali Loss: 0.0929511 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9672570  Vali macro F1 0.9574681 
new best score!!!!
Validation loss decreased (0.096939 --> 0.092951).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.500633001327515
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0953677  Vali Loss: 0.0974354 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9704284  Vali macro F1 0.9615896 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.529318332672119
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0894002  Vali Loss: 0.0827353 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9735288  Vali macro F1 0.9666054 
new best score!!!!
Validation loss decreased (0.092951 --> 0.082735).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.5773820877075195
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0900218  Vali Loss: 0.0904746 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9703123  Vali macro F1 0.9631291 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.499863386154175
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0813446  Vali Loss: 0.1010140 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9673108  Vali macro F1 0.9587616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.50276255607605
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0819393  Vali Loss: 0.0978681 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9682017  Vali macro F1 0.9597024 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.509424448013306
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0798648  Vali Loss: 0.0812070 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9745489  Vali macro F1 0.9682898 
new best score!!!!
Validation loss decreased (0.082735 --> 0.081207).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.484862565994263
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0858274  Vali Loss: 0.0971663 Vali Accuracy: 0.9674396  Vali weighted F1: 0.9678566  Vali macro F1 0.9580421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.482777118682861
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0813449  Vali Loss: 0.0992781 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9695876  Vali macro F1 0.9624593 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.497340202331543
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0840805  Vali Loss: 0.0766883 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783541  Vali macro F1 0.9714708 
new best score!!!!
Validation loss decreased (0.081207 --> 0.076688).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.497100591659546
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0779726  Vali Loss: 0.0963607 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9723406  Vali macro F1 0.9640975 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.4886815547943115
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0796875  Vali Loss: 0.0783038 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9740414  Vali macro F1 0.9664194 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.497126340866089
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0758505  Vali Loss: 0.0823711 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9759977  Vali macro F1 0.9679755 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.487094163894653
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0691950  Vali Loss: 0.0745364 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9763637  Vali macro F1 0.9692891 
new best score!!!!
Validation loss decreased (0.076688 --> 0.074536).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.498135566711426
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0727223  Vali Loss: 0.0735115 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9774600  Vali macro F1 0.9700071 
new best score!!!!
Validation loss decreased (0.074536 --> 0.073511).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.496875047683716
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0677564  Vali Loss: 0.0899682 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9722932  Vali macro F1 0.9615774 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.485422372817993
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0683695  Vali Loss: 0.0753908 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9779609  Vali macro F1 0.9715491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.490154266357422
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0689915  Vali Loss: 0.0790381 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9746377  Vali macro F1 0.9682498 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.485439300537109
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0727470  Vali Loss: 0.0824954 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9760444  Vali macro F1 0.9692689 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.485956430435181
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0664353  Vali Loss: 0.0767850 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783555  Vali macro F1 0.9705998 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 6.500135898590088
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0558707  Vali Loss: 0.0703080 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9779017  Vali macro F1 0.9710167 
new best score!!!!
Validation loss decreased (0.073511 --> 0.070308).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.497048377990723
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0550338  Vali Loss: 0.0694505 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9784317  Vali macro F1 0.9714891 
new best score!!!!
Validation loss decreased (0.070308 --> 0.069451).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.503733396530151
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0570753  Vali Loss: 0.0702906 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793723  Vali macro F1 0.9728991 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.5041704177856445
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0548887  Vali Loss: 0.0698150 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9789211  Vali macro F1 0.9720039 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.4987828731536865
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0526237  Vali Loss: 0.0696667 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9789132  Vali macro F1 0.9730852 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.489336729049683
VALI: Epoch: 59, Steps: 72 | Train Loss: 0.0542080  Vali Loss: 0.0703494 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9774489  Vali macro F1 0.9707653 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.481081008911133
VALI: Epoch: 60, Steps: 72 | Train Loss: 0.0519143  Vali Loss: 0.0700321 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798325  Vali macro F1 0.9736871 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 61 cost time: 6.4893200397491455
VALI: Epoch: 61, Steps: 72 | Train Loss: 0.0531823  Vali Loss: 0.0690440 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803671  Vali macro F1 0.9748857 
new best score!!!!
Validation loss decreased (0.069451 --> 0.069044).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.495373010635376
VALI: Epoch: 62, Steps: 72 | Train Loss: 0.0517149  Vali Loss: 0.0695452 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803671  Vali macro F1 0.9748857 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.509987115859985
VALI: Epoch: 63, Steps: 72 | Train Loss: 0.0514300  Vali Loss: 0.0694312 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803671  Vali macro F1 0.9748857 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.512429475784302
VALI: Epoch: 64, Steps: 72 | Train Loss: 0.0518493  Vali Loss: 0.0695145 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.5709357261657715
VALI: Epoch: 65, Steps: 72 | Train Loss: 0.0514738  Vali Loss: 0.0698552 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 6.589411735534668
VALI: Epoch: 66, Steps: 72 | Train Loss: 0.0508299  Vali Loss: 0.0697402 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793958  Vali macro F1 0.9735618 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 67 cost time: 6.558924436569214
VALI: Epoch: 67, Steps: 72 | Train Loss: 0.0517980  Vali Loss: 0.0697120 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793958  Vali macro F1 0.9735618 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 6.533230781555176
VALI: Epoch: 68, Steps: 72 | Train Loss: 0.0510124  Vali Loss: 0.0696827 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 6.482736110687256
VALI: Epoch: 69, Steps: 72 | Train Loss: 0.0517922  Vali Loss: 0.0697103 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 6.477207183837891
VALI: Epoch: 70, Steps: 72 | Train Loss: 0.0510800  Vali Loss: 0.0697137 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 6.48539924621582
VALI: Epoch: 71, Steps: 72 | Train Loss: 0.0523717  Vali Loss: 0.0696523 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 72 cost time: 6.498181343078613
VALI: Epoch: 72, Steps: 72 | Train Loss: 0.0530366  Vali Loss: 0.0696567 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 6.50220799446106
VALI: Epoch: 73, Steps: 72 | Train Loss: 0.0507517  Vali Loss: 0.0696555 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 6.492220163345337
VALI: Epoch: 74, Steps: 72 | Train Loss: 0.0520721  Vali Loss: 0.0696552 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 6.490588188171387
VALI: Epoch: 75, Steps: 72 | Train Loss: 0.0517884  Vali Loss: 0.0696524 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 6.489793062210083
VALI: Epoch: 76, Steps: 72 | Train Loss: 0.0502971  Vali Loss: 0.0696541 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798798  Vali macro F1 0.9740510 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8884754  Test weighted F1: 0.8749407  Test macro F1 0.6520704 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.524553060531616
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0526941  Vali Loss: 0.0714803 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798466  Vali macro F1 0.9736403 
Validation loss decreased (inf --> 0.071480).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.5185911655426025
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0531893  Vali Loss: 0.0689328 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793765  Vali macro F1 0.9732311 
new best score!!!!
Validation loss decreased (0.071480 --> 0.068933).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.543940305709839
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0543183  Vali Loss: 0.0711466 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9769710  Vali macro F1 0.9710983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.539483547210693
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0551371  Vali Loss: 0.0721732 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9779483  Vali macro F1 0.9710003 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.516791820526123
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0510004  Vali Loss: 0.0723191 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9774524  Vali macro F1 0.9705845 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.5124430656433105
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0530455  Vali Loss: 0.0702658 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783994  Vali macro F1 0.9717324 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.529836416244507
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0495486  Vali Loss: 0.0693713 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783866  Vali macro F1 0.9722243 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.516401767730713
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0544209  Vali Loss: 0.0728028 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813002  Vali macro F1 0.9761035 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.513015508651733
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0523089  Vali Loss: 0.0692432 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798511  Vali macro F1 0.9738001 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.510873317718506
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0536649  Vali Loss: 0.0683413 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788766  Vali macro F1 0.9731042 
new best score!!!!
Validation loss decreased (0.068933 --> 0.068341).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.52960729598999
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0515170  Vali Loss: 0.0684791 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793702  Vali macro F1 0.9733156 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.5340962409973145
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0480835  Vali Loss: 0.0689637 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783921  Vali macro F1 0.9723543 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.516740798950195
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0491244  Vali Loss: 0.0707391 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798494  Vali macro F1 0.9737874 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.507569313049316
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0501087  Vali Loss: 0.0725714 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798667  Vali macro F1 0.9740994 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.524937391281128
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0506878  Vali Loss: 0.0724106 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9784269  Vali macro F1 0.9722671 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.512352705001831
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0472964  Vali Loss: 0.0698501 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798660  Vali macro F1 0.9740843 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.508999347686768
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0485142  Vali Loss: 0.0686492 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803490  Vali macro F1 0.9745721 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.516915559768677
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0483641  Vali Loss: 0.0690317 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808392  Vali macro F1 0.9754257 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.540654420852661
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0479325  Vali Loss: 0.0684760 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808326  Vali macro F1 0.9750612 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.838468551635742
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0483747  Vali Loss: 0.0683517 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808326  Vali macro F1 0.9750612 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 21 cost time: 6.53702974319458
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0480426  Vali Loss: 0.0683995 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808326  Vali macro F1 0.9750612 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.512749671936035
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0471490  Vali Loss: 0.0683726 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808326  Vali macro F1 0.9750612 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.499673366546631
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0494158  Vali Loss: 0.0683617 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808326  Vali macro F1 0.9750612 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.499657154083252
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0485569  Vali Loss: 0.0684860 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803490  Vali macro F1 0.9745721 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.504904747009277
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0482341  Vali Loss: 0.0684113 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803490  Vali macro F1 0.9745721 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8864905  Test weighted F1: 0.8737718  Test macro F1 0.6523459 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014451 0.00016909 0.00099108 0.00134953 0.00049579 0.00063694]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.489227771759033
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.4342908  Vali Loss: 0.9215138 Vali Accuracy: 0.6904408  Vali weighted F1: 0.5855062  Vali macro F1 0.2796747 
Validation loss decreased (inf --> 0.921514).  Saving model ...
Epoch: 2 cost time: 6.487984895706177
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.7753065  Vali Loss: 0.6588915 Vali Accuracy: 0.7786033  Vali weighted F1: 0.7184724  Vali macro F1 0.4922561 
new best score!!!!
Validation loss decreased (0.921514 --> 0.658892).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.465172529220581
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.6056991  Vali Loss: 0.5317101 Vali Accuracy: 0.7904903  Vali weighted F1: 0.7432920  Vali macro F1 0.5278431 
new best score!!!!
Validation loss decreased (0.658892 --> 0.531710).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.451070070266724
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.5008855  Vali Loss: 0.4271456 Vali Accuracy: 0.8296186  Vali weighted F1: 0.8082752  Vali macro F1 0.6134067 
new best score!!!!
Validation loss decreased (0.531710 --> 0.427146).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.475807189941406
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.3865933  Vali Loss: 0.3770597 Vali Accuracy: 0.8855869  Vali weighted F1: 0.8760562  Vali macro F1 0.8257578 
new best score!!!!
Validation loss decreased (0.427146 --> 0.377060).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.476457834243774
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2985959  Vali Loss: 0.2556483 Vali Accuracy: 0.9133234  Vali weighted F1: 0.9137276  Vali macro F1 0.8769005 
new best score!!!!
Validation loss decreased (0.377060 --> 0.255648).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.4683754444122314
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.2520210  Vali Loss: 0.2279937 Vali Accuracy: 0.9301634  Vali weighted F1: 0.9306594  Vali macro F1 0.9047314 
new best score!!!!
Validation loss decreased (0.255648 --> 0.227994).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.461636304855347
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2246940  Vali Loss: 0.2070196 Vali Accuracy: 0.9336305  Vali weighted F1: 0.9331347  Vali macro F1 0.9101851 
new best score!!!!
Validation loss decreased (0.227994 --> 0.207020).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.485461235046387
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2151371  Vali Loss: 0.2032350 Vali Accuracy: 0.9366023  Vali weighted F1: 0.9364550  Vali macro F1 0.9130061 
new best score!!!!
Validation loss decreased (0.207020 --> 0.203235).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.477141618728638
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1986040  Vali Loss: 0.1907493 Vali Accuracy: 0.9415552  Vali weighted F1: 0.9418033  Vali macro F1 0.9227578 
new best score!!!!
Validation loss decreased (0.203235 --> 0.190749).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.480117082595825
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1894218  Vali Loss: 0.2021854 Vali Accuracy: 0.9370976  Vali weighted F1: 0.9381326  Vali macro F1 0.9161717 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.475549221038818
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1791176  Vali Loss: 0.1838482 Vali Accuracy: 0.9405646  Vali weighted F1: 0.9402952  Vali macro F1 0.9177259 
new best score!!!!
Validation loss decreased (0.190749 --> 0.183848).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.466777563095093
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1728982  Vali Loss: 0.1771863 Vali Accuracy: 0.9440317  Vali weighted F1: 0.9436931  Vali macro F1 0.9261445 
new best score!!!!
Validation loss decreased (0.183848 --> 0.177186).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.465797424316406
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1679223  Vali Loss: 0.1660764 Vali Accuracy: 0.9474988  Vali weighted F1: 0.9478329  Vali macro F1 0.9305580 
new best score!!!!
Validation loss decreased (0.177186 --> 0.166076).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.456240653991699
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1613321  Vali Loss: 0.1748163 Vali Accuracy: 0.9455176  Vali weighted F1: 0.9454080  Vali macro F1 0.9289367 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.462470293045044
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1579937  Vali Loss: 0.1602977 Vali Accuracy: 0.9529470  Vali weighted F1: 0.9533446  Vali macro F1 0.9379639 
new best score!!!!
Validation loss decreased (0.166076 --> 0.160298).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.442434072494507
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1509873  Vali Loss: 0.1598490 Vali Accuracy: 0.9524517  Vali weighted F1: 0.9524035  Vali macro F1 0.9377996 
new best score!!!!
Validation loss decreased (0.160298 --> 0.159849).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 7.834213972091675
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1478069  Vali Loss: 0.1571350 Vali Accuracy: 0.9549282  Vali weighted F1: 0.9549213  Vali macro F1 0.9401029 
new best score!!!!
Validation loss decreased (0.159849 --> 0.157135).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.473423719406128
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1408417  Vali Loss: 0.1497003 Vali Accuracy: 0.9519564  Vali weighted F1: 0.9520743  Vali macro F1 0.9354753 
new best score!!!!
Validation loss decreased (0.157135 --> 0.149700).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.4687111377716064
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1418903  Vali Loss: 0.1527269 Vali Accuracy: 0.9554235  Vali weighted F1: 0.9551729  Vali macro F1 0.9419216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.459007740020752
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1336501  Vali Loss: 0.1467491 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9577323  Vali macro F1 0.9438424 
new best score!!!!
Validation loss decreased (0.149700 --> 0.146749).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.4602837562561035
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1353514  Vali Loss: 0.1446933 Vali Accuracy: 0.9499752  Vali weighted F1: 0.9495157  Vali macro F1 0.9328856 
new best score!!!!
Validation loss decreased (0.146749 --> 0.144693).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.464301824569702
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1249283  Vali Loss: 0.1457560 Vali Accuracy: 0.9554235  Vali weighted F1: 0.9549820  Vali macro F1 0.9403457 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.454209327697754
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1298885  Vali Loss: 0.1359170 Vali Accuracy: 0.9569094  Vali weighted F1: 0.9574280  Vali macro F1 0.9440811 
new best score!!!!
Validation loss decreased (0.144693 --> 0.135917).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.455618858337402
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1248650  Vali Loss: 0.1358375 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9598552  Vali macro F1 0.9467207 
new best score!!!!
Validation loss decreased (0.135917 --> 0.135838).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.48510217666626
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1177157  Vali Loss: 0.1357921 Vali Accuracy: 0.9564141  Vali weighted F1: 0.9567026  Vali macro F1 0.9425887 
new best score!!!!
Validation loss decreased (0.135838 --> 0.135792).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.502024412155151
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1129015  Vali Loss: 0.1293061 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9595841  Vali macro F1 0.9455143 
new best score!!!!
Validation loss decreased (0.135792 --> 0.129306).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.469303369522095
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1064320  Vali Loss: 0.1277009 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9612382  Vali macro F1 0.9476173 
new best score!!!!
Validation loss decreased (0.129306 --> 0.127701).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.460904359817505
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1022653  Vali Loss: 0.1218724 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9613669  Vali macro F1 0.9474577 
new best score!!!!
Validation loss decreased (0.127701 --> 0.121872).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.459313869476318
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1029679  Vali Loss: 0.1173240 Vali Accuracy: 0.9618623  Vali weighted F1: 0.9618107  Vali macro F1 0.9484219 
new best score!!!!
Validation loss decreased (0.121872 --> 0.117324).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.464120626449585
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.1009996  Vali Loss: 0.1277653 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9613913  Vali macro F1 0.9478796 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.464723110198975
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.1050617  Vali Loss: 0.1367495 Vali Accuracy: 0.9564141  Vali weighted F1: 0.9563990  Vali macro F1 0.9417671 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.475371837615967
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0957031  Vali Loss: 0.1110776 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9630467  Vali macro F1 0.9505369 
new best score!!!!
Validation loss decreased (0.117324 --> 0.111078).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.487684726715088
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0932535  Vali Loss: 0.1087095 Vali Accuracy: 0.9673105  Vali weighted F1: 0.9669221  Vali macro F1 0.9544880 
new best score!!!!
Validation loss decreased (0.111078 --> 0.108709).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.512380361557007
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0882335  Vali Loss: 0.1395378 Vali Accuracy: 0.9579000  Vali weighted F1: 0.9583156  Vali macro F1 0.9462338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.4629271030426025
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0901306  Vali Loss: 0.1055468 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9682371  Vali macro F1 0.9563896 
new best score!!!!
Validation loss decreased (0.108709 --> 0.105547).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.4706268310546875
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0878269  Vali Loss: 0.1032554 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9687739  Vali macro F1 0.9566446 
new best score!!!!
Validation loss decreased (0.105547 --> 0.103255).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.463141918182373
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0825640  Vali Loss: 0.1059783 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9680948  Vali macro F1 0.9556078 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.466066837310791
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0796950  Vali Loss: 0.1109230 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9664816  Vali macro F1 0.9552728 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.488223314285278
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0876756  Vali Loss: 0.1019134 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9694760  Vali macro F1 0.9563387 
new best score!!!!
Validation loss decreased (0.103255 --> 0.101913).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.478247404098511
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0881018  Vali Loss: 0.0940850 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9732642  Vali macro F1 0.9612198 
new best score!!!!
Validation loss decreased (0.101913 --> 0.094085).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.468446493148804
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0759890  Vali Loss: 0.0995210 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9727890  Vali macro F1 0.9610338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.493022918701172
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0842904  Vali Loss: 0.1135095 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9668211  Vali macro F1 0.9546739 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.465195178985596
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0755175  Vali Loss: 0.1041806 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9693382  Vali macro F1 0.9576838 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.455855131149292
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0704414  Vali Loss: 0.0998205 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9715254  Vali macro F1 0.9608294 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.456122875213623
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0732432  Vali Loss: 0.0887964 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742043  Vali macro F1 0.9640327 
new best score!!!!
Validation loss decreased (0.094085 --> 0.088796).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.47023344039917
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0653082  Vali Loss: 0.0938756 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9714415  Vali macro F1 0.9645388 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.459537982940674
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0658747  Vali Loss: 0.1082552 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9702868  Vali macro F1 0.9600451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.459554195404053
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0664879  Vali Loss: 0.0858497 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752301  Vali macro F1 0.9645364 
new best score!!!!
Validation loss decreased (0.088796 --> 0.085850).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.4706947803497314
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0653746  Vali Loss: 0.1048255 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9696173  Vali macro F1 0.9584088 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.479755401611328
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0645193  Vali Loss: 0.0933759 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9763986  Vali macro F1 0.9692239 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.470067501068115
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0672135  Vali Loss: 0.0822119 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762661  Vali macro F1 0.9653900 
new best score!!!!
Validation loss decreased (0.085850 --> 0.082212).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.473863840103149
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0581591  Vali Loss: 0.0893411 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9716929  Vali macro F1 0.9588656 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.458929777145386
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0643438  Vali Loss: 0.1055022 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9721361  Vali macro F1 0.9639478 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.460068464279175
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0632513  Vali Loss: 0.0931836 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9759561  Vali macro F1 0.9675405 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.4683997631073
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0637938  Vali Loss: 0.0905652 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762132  Vali macro F1 0.9653203 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.552767515182495
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0544555  Vali Loss: 0.0802330 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9777539  Vali macro F1 0.9673310 
new best score!!!!
Validation loss decreased (0.082212 --> 0.080233).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.57819676399231
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0578334  Vali Loss: 0.0928074 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9745009  Vali macro F1 0.9669639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.588558912277222
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0543880  Vali Loss: 0.0830660 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9773430  Vali macro F1 0.9645946 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.525930166244507
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0587668  Vali Loss: 0.0897091 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9773789  Vali macro F1 0.9669493 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.463233470916748
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0542634  Vali Loss: 0.0864480 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9761618  Vali macro F1 0.9580403 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.453989267349243
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0501116  Vali Loss: 0.0968346 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9697940  Vali macro F1 0.9579990 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 63 cost time: 6.468536138534546
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0475242  Vali Loss: 0.0742000 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807000  Vali macro F1 0.9734737 
new best score!!!!
Validation loss decreased (0.080233 --> 0.074200).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 6.4624574184417725
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0402281  Vali Loss: 0.0747194 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817120  Vali macro F1 0.9745861 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 6.461498737335205
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0407576  Vali Loss: 0.0749159 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9816830  Vali macro F1 0.9745341 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 6.547035217285156
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0418348  Vali Loss: 0.0766458 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797599  Vali macro F1 0.9701502 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 6.591789722442627
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0424221  Vali Loss: 0.0768864 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802286  Vali macro F1 0.9709368 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 6.546312570571899
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0397383  Vali Loss: 0.0752902 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812130  Vali macro F1 0.9740442 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 69 cost time: 6.464472770690918
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0386454  Vali Loss: 0.0751947 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807344  Vali macro F1 0.9735586 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.459115266799927
VALI: Epoch: 70, Steps: 71 | Train Loss: 0.0399325  Vali Loss: 0.0755521 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812207  Vali macro F1 0.9743808 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 8.881181240081787
VALI: Epoch: 71, Steps: 71 | Train Loss: 0.0398496  Vali Loss: 0.0753813 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807249  Vali macro F1 0.9726602 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.501502275466919
VALI: Epoch: 72, Steps: 71 | Train Loss: 0.0393363  Vali Loss: 0.0750801 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812207  Vali macro F1 0.9743808 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.451780796051025
VALI: Epoch: 73, Steps: 71 | Train Loss: 0.0390528  Vali Loss: 0.0747803 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812207  Vali macro F1 0.9743808 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 74 cost time: 6.461827278137207
VALI: Epoch: 74, Steps: 71 | Train Loss: 0.0392685  Vali Loss: 0.0747798 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812207  Vali macro F1 0.9743808 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 6.4783935546875
VALI: Epoch: 75, Steps: 71 | Train Loss: 0.0406291  Vali Loss: 0.0748230 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812207  Vali macro F1 0.9743808 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 6.466366767883301
VALI: Epoch: 76, Steps: 71 | Train Loss: 0.0396600  Vali Loss: 0.0748797 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812207  Vali macro F1 0.9743808 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 6.4579339027404785
VALI: Epoch: 77, Steps: 71 | Train Loss: 0.0398999  Vali Loss: 0.0748940 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812207  Vali macro F1 0.9743808 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 6.4591193199157715
VALI: Epoch: 78, Steps: 71 | Train Loss: 0.0390380  Vali Loss: 0.0749306 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812207  Vali macro F1 0.9743808 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8846154  Test weighted F1: 0.8804266  Test macro F1 0.8290323 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.4881064891815186
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0415168  Vali Loss: 0.0743935 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9811946  Vali macro F1 0.9737085 
Validation loss decreased (inf --> 0.074394).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.454745531082153
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0403469  Vali Loss: 0.0769587 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807520  Vali macro F1 0.9735942 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.449764013290405
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0414419  Vali Loss: 0.0769800 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792631  Vali macro F1 0.9696118 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.4764323234558105
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0403316  Vali Loss: 0.0755155 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817004  Vali macro F1 0.9748681 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.4825732707977295
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0412956  Vali Loss: 0.0759454 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812502  Vali macro F1 0.9744338 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.46146297454834
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0411502  Vali Loss: 0.0774604 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788073  Vali macro F1 0.9691308 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.458079099655151
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0409361  Vali Loss: 0.0799641 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787717  Vali macro F1 0.9693769 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.458064556121826
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0391280  Vali Loss: 0.0736817 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807481  Vali macro F1 0.9723954 
new best score!!!!
Validation loss decreased (0.074394 --> 0.073682).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.466289043426514
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0403624  Vali Loss: 0.0734609 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807355  Vali macro F1 0.9735773 
new best score!!!!
Validation loss decreased (0.073682 --> 0.073461).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.465421199798584
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0375161  Vali Loss: 0.0738867 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9783143  Vali macro F1 0.9707000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.472069025039673
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0386889  Vali Loss: 0.0755555 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812298  Vali macro F1 0.9752767 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.475559949874878
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0395595  Vali Loss: 0.0763046 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802080  Vali macro F1 0.9736075 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.489940404891968
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0385059  Vali Loss: 0.0765200 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793051  Vali macro F1 0.9708732 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.470554351806641
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0384243  Vali Loss: 0.0759266 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9806804  Vali macro F1 0.9725921 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.470091819763184
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0376861  Vali Loss: 0.0747675 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802551  Vali macro F1 0.9730558 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.466245174407959
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0365069  Vali Loss: 0.0749244 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802977  Vali macro F1 0.9740111 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.478450775146484
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0354110  Vali Loss: 0.0748368 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798022  Vali macro F1 0.9722930 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.475362777709961
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0366396  Vali Loss: 0.0747626 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802461  Vali macro F1 0.9727169 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.478791236877441
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0351912  Vali Loss: 0.0750698 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807326  Vali macro F1 0.9735395 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 6.477563381195068
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0372373  Vali Loss: 0.0750684 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807326  Vali macro F1 0.9735395 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.483686923980713
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0372756  Vali Loss: 0.0751133 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807326  Vali macro F1 0.9735395 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.4827611446380615
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0373552  Vali Loss: 0.0752899 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802368  Vali macro F1 0.9718189 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.468982696533203
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0355465  Vali Loss: 0.0752017 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802368  Vali macro F1 0.9718189 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.4666972160339355
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0357636  Vali Loss: 0.0752502 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807326  Vali macro F1 0.9735395 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8721893  Test weighted F1: 0.8681345  Test macro F1 0.8166793 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014601 0.00017819 0.00109529 0.00133156 0.00049603 0.00062735]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.304803371429443
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4503674  Vali Loss: 0.9651439 Vali Accuracy: 0.6768138  Vali weighted F1: 0.5691176  Vali macro F1 0.2762288 
Validation loss decreased (inf --> 0.965144).  Saving model ...
Epoch: 2 cost time: 6.295231580734253
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8126886  Vali Loss: 0.7003054 Vali Accuracy: 0.7569762  Vali weighted F1: 0.6792250  Vali macro F1 0.4554330 
new best score!!!!
Validation loss decreased (0.965144 --> 0.700305).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.302700519561768
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6603215  Vali Loss: 0.6013943 Vali Accuracy: 0.7630644  Vali weighted F1: 0.7049173  Vali macro F1 0.4870819 
new best score!!!!
Validation loss decreased (0.700305 --> 0.601394).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2960546016693115
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5742425  Vali Loss: 0.5044502 Vali Accuracy: 0.8193810  Vali weighted F1: 0.7968429  Vali macro F1 0.6094644 
new best score!!!!
Validation loss decreased (0.601394 --> 0.504450).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.322070837020874
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4491049  Vali Loss: 0.3896895 Vali Accuracy: 0.8569254  Vali weighted F1: 0.8346523  Vali macro F1 0.6622749 
new best score!!!!
Validation loss decreased (0.504450 --> 0.389689).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.300145864486694
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3573025  Vali Loss: 0.3164287 Vali Accuracy: 0.8792491  Vali weighted F1: 0.8617504  Vali macro F1 0.6922530 
new best score!!!!
Validation loss decreased (0.389689 --> 0.316429).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.302582502365112
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3120296  Vali Loss: 0.2850179 Vali Accuracy: 0.8914257  Vali weighted F1: 0.8753357  Vali macro F1 0.7069452 
new best score!!!!
Validation loss decreased (0.316429 --> 0.285018).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.289053916931152
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2901226  Vali Loss: 0.2571709 Vali Accuracy: 0.8990360  Vali weighted F1: 0.8824996  Vali macro F1 0.7144524 
new best score!!!!
Validation loss decreased (0.285018 --> 0.257171).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.298607587814331
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2584486  Vali Loss: 0.2198937 Vali Accuracy: 0.9365804  Vali weighted F1: 0.9365091  Vali macro F1 0.9172114 
new best score!!!!
Validation loss decreased (0.257171 --> 0.219894).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2983152866363525
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2114310  Vali Loss: 0.1932966 Vali Accuracy: 0.9406393  Vali weighted F1: 0.9408284  Vali macro F1 0.9261906 
new best score!!!!
Validation loss decreased (0.219894 --> 0.193297).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.294501066207886
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1908282  Vali Loss: 0.1688213 Vali Accuracy: 0.9441908  Vali weighted F1: 0.9439900  Vali macro F1 0.9250122 
new best score!!!!
Validation loss decreased (0.193297 --> 0.168821).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.317307949066162
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1707888  Vali Loss: 0.1655561 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9503995  Vali macro F1 0.9370605 
new best score!!!!
Validation loss decreased (0.168821 --> 0.165556).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.315275430679321
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1666887  Vali Loss: 0.1574838 Vali Accuracy: 0.9538305  Vali weighted F1: 0.9542435  Vali macro F1 0.9415391 
new best score!!!!
Validation loss decreased (0.165556 --> 0.157484).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.305514574050903
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1523303  Vali Loss: 0.1520986 Vali Accuracy: 0.9548453  Vali weighted F1: 0.9543658  Vali macro F1 0.9429726 
new best score!!!!
Validation loss decreased (0.157484 --> 0.152099).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.30692195892334
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1480528  Vali Loss: 0.1623941 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9495248  Vali macro F1 0.9366923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.320909023284912
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1439581  Vali Loss: 0.1713702 Vali Accuracy: 0.9446981  Vali weighted F1: 0.9455442  Vali macro F1 0.9226130 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.304643154144287
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1383562  Vali Loss: 0.1396507 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9587728  Vali macro F1 0.9460636 
new best score!!!!
Validation loss decreased (0.152099 --> 0.139651).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.316690921783447
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1327059  Vali Loss: 0.1395180 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9606213  Vali macro F1 0.9455344 
new best score!!!!
Validation loss decreased (0.139651 --> 0.139518).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.307685852050781
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1265148  Vali Loss: 0.1205921 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9647987  Vali macro F1 0.9520832 
new best score!!!!
Validation loss decreased (0.139518 --> 0.120592).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.305781841278076
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1199560  Vali Loss: 0.1194997 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9643587  Vali macro F1 0.9503430 
new best score!!!!
Validation loss decreased (0.120592 --> 0.119500).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.313602685928345
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1143159  Vali Loss: 0.1531029 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9533382  Vali macro F1 0.9406942 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.3295066356658936
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1112480  Vali Loss: 0.1355083 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9578302  Vali macro F1 0.9432787 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.303516149520874
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1113572  Vali Loss: 0.1152388 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9654754  Vali macro F1 0.9539503 
new best score!!!!
Validation loss decreased (0.119500 --> 0.115239).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.310483932495117
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1133223  Vali Loss: 0.1304438 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9579433  Vali macro F1 0.9413726 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.299006938934326
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1085233  Vali Loss: 0.1155266 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9642457  Vali macro F1 0.9519680 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.302638292312622
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1036864  Vali Loss: 0.1130505 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9659683  Vali macro F1 0.9519332 
new best score!!!!
Validation loss decreased (0.115239 --> 0.113050).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.302734375
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0990440  Vali Loss: 0.1674068 Vali Accuracy: 0.9421613  Vali weighted F1: 0.9441454  Vali macro F1 0.9298967 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.315311431884766
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1050650  Vali Loss: 0.1036273 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9695967  Vali macro F1 0.9584061 
new best score!!!!
Validation loss decreased (0.113050 --> 0.103627).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.3297624588012695
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0936650  Vali Loss: 0.1091800 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9661325  Vali macro F1 0.9513131 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.320153474807739
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0879948  Vali Loss: 0.1084297 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9702503  Vali macro F1 0.9592359 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.302901268005371
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0858674  Vali Loss: 0.1028861 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9681802  Vali macro F1 0.9575505 
new best score!!!!
Validation loss decreased (0.103627 --> 0.102886).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.305442571640015
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0888355  Vali Loss: 0.1098804 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9670538  Vali macro F1 0.9578168 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.307307243347168
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0839409  Vali Loss: 0.0992302 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9716796  Vali macro F1 0.9618061 
new best score!!!!
Validation loss decreased (0.102886 --> 0.099230).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.3195741176605225
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0821473  Vali Loss: 0.1027825 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9700922  Vali macro F1 0.9589612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.3251190185546875
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0841486  Vali Loss: 0.1039639 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9668770  Vali macro F1 0.9548049 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.41266655921936
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0768493  Vali Loss: 0.1013250 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9696413  Vali macro F1 0.9598596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.408588409423828
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0724558  Vali Loss: 0.1009303 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9704157  Vali macro F1 0.9605261 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.418671369552612
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0760206  Vali Loss: 0.1308918 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9573230  Vali macro F1 0.9452015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 6.403729200363159
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0680967  Vali Loss: 0.0960723 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9692574  Vali macro F1 0.9598532 
new best score!!!!
Validation loss decreased (0.099230 --> 0.096072).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.411936283111572
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0654993  Vali Loss: 0.0952128 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9693298  Vali macro F1 0.9597038 
new best score!!!!
Validation loss decreased (0.096072 --> 0.095213).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.40814995765686
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0645773  Vali Loss: 0.0926501 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9717676  Vali macro F1 0.9623590 
new best score!!!!
Validation loss decreased (0.095213 --> 0.092650).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.359597206115723
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0650056  Vali Loss: 0.0907073 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732974  Vali macro F1 0.9640096 
new best score!!!!
Validation loss decreased (0.092650 --> 0.090707).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.330393075942993
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0640542  Vali Loss: 0.0911287 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9711587  Vali macro F1 0.9609579 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.311032772064209
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0611884  Vali Loss: 0.0920061 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9713234  Vali macro F1 0.9617822 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.317349910736084
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0616222  Vali Loss: 0.0900437 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727266  Vali macro F1 0.9626538 
new best score!!!!
Validation loss decreased (0.090707 --> 0.090044).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.343157768249512
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0628113  Vali Loss: 0.0894270 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9706942  Vali macro F1 0.9611206 
new best score!!!!
Validation loss decreased (0.090044 --> 0.089427).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.325283050537109
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0616264  Vali Loss: 0.0903666 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9701223  Vali macro F1 0.9599684 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.310537338256836
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0606480  Vali Loss: 0.0896886 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722313  Vali macro F1 0.9625528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.311571836471558
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0613311  Vali Loss: 0.0893079 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722674  Vali macro F1 0.9629762 
new best score!!!!
Validation loss decreased (0.089427 --> 0.089308).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.315791845321655
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0607289  Vali Loss: 0.0913812 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9706805  Vali macro F1 0.9606317 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.310110092163086
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0615312  Vali Loss: 0.0914939 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707479  Vali macro F1 0.9610500 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.3083062171936035
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0610903  Vali Loss: 0.0892303 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707388  Vali macro F1 0.9603736 
new best score!!!!
Validation loss decreased (0.089308 --> 0.089230).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.314209222793579
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0598832  Vali Loss: 0.0893024 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727212  Vali macro F1 0.9632702 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.343744277954102
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0617823  Vali Loss: 0.0879465 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9706579  Vali macro F1 0.9611557 
new best score!!!!
Validation loss decreased (0.089230 --> 0.087947).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.341310501098633
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0585331  Vali Loss: 0.0869785 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9723347  Vali macro F1 0.9627399 
new best score!!!!
Validation loss decreased (0.087947 --> 0.086978).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.367369174957275
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0590546  Vali Loss: 0.0855757 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728374  Vali macro F1 0.9646385 
new best score!!!!
Validation loss decreased (0.086978 --> 0.085576).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 6.315949201583862
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0573448  Vali Loss: 0.0887106 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9702736  Vali macro F1 0.9606122 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.318811893463135
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0584501  Vali Loss: 0.0865811 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9712200  Vali macro F1 0.9623941 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.305131435394287
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0594006  Vali Loss: 0.0881672 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9706582  Vali macro F1 0.9608687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.30826735496521
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0584110  Vali Loss: 0.0880288 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9721541  Vali macro F1 0.9633931 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.314117670059204
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0588783  Vali Loss: 0.0846783 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727941  Vali macro F1 0.9643660 
new best score!!!!
Validation loss decreased (0.085576 --> 0.084678).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.3153510093688965
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0561678  Vali Loss: 0.0857963 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9698036  Vali macro F1 0.9599995 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.319799423217773
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0570759  Vali Loss: 0.0860394 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9731946  Vali macro F1 0.9642591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.321033477783203
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0567362  Vali Loss: 0.0848197 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727588  Vali macro F1 0.9624551 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.307580232620239
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0581672  Vali Loss: 0.0847121 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707898  Vali macro F1 0.9603622 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 6.318929195404053
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0599036  Vali Loss: 0.0865792 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9702817  Vali macro F1 0.9601688 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 67 cost time: 6.336090564727783
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0546978  Vali Loss: 0.0842511 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9702715  Vali macro F1 0.9597926 
new best score!!!!
Validation loss decreased (0.084678 --> 0.084251).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 6.305518865585327
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0552369  Vali Loss: 0.0842490 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9717496  Vali macro F1 0.9616118 
new best score!!!!
Validation loss decreased (0.084251 --> 0.084249).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 6.315171003341675
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0545970  Vali Loss: 0.0841191 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722604  Vali macro F1 0.9627823 
new best score!!!!
Validation loss decreased (0.084249 --> 0.084119).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 6.307787656784058
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0570233  Vali Loss: 0.0841180 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9712638  Vali macro F1 0.9611692 
new best score!!!!
Validation loss decreased (0.084119 --> 0.084118).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 6.331771373748779
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0568015  Vali Loss: 0.0839433 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727803  Vali macro F1 0.9633973 
new best score!!!!
Validation loss decreased (0.084118 --> 0.083943).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 6.319258213043213
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0558342  Vali Loss: 0.0836934 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727803  Vali macro F1 0.9633973 
new best score!!!!
Validation loss decreased (0.083943 --> 0.083693).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 6.3145716190338135
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0557000  Vali Loss: 0.0838993 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722491  Vali macro F1 0.9624302 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 6.301605224609375
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0539703  Vali Loss: 0.0836474 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722837  Vali macro F1 0.9625842 
new best score!!!!
Validation loss decreased (0.083693 --> 0.083647).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 6.308648347854614
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0547829  Vali Loss: 0.0836078 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722935  Vali macro F1 0.9629533 
new best score!!!!
Validation loss decreased (0.083647 --> 0.083608).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 6.312021255493164
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0550312  Vali Loss: 0.0836328 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9713232  Vali macro F1 0.9610113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 6.295246124267578
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0546731  Vali Loss: 0.0838464 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722604  Vali macro F1 0.9627823 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 6.300253629684448
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0541734  Vali Loss: 0.0838197 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9712637  Vali macro F1 0.9611495 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 6.3048341274261475
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0565193  Vali Loss: 0.0837992 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9703070  Vali macro F1 0.9609782 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 6.3089280128479
VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0569212  Vali Loss: 0.0833621 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
new best score!!!!
Validation loss decreased (0.083608 --> 0.083362).  Saving model ...
new best score!!!!
Epoch: 81 cost time: 6.311521530151367
VALI: Epoch: 81, Steps: 70 | Train Loss: 0.0550093  Vali Loss: 0.0829432 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
new best score!!!!
Validation loss decreased (0.083362 --> 0.082943).  Saving model ...
new best score!!!!
Epoch: 82 cost time: 6.302901029586792
VALI: Epoch: 82, Steps: 70 | Train Loss: 0.0554220  Vali Loss: 0.0831767 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722935  Vali macro F1 0.9629533 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 83 cost time: 6.303104639053345
VALI: Epoch: 83, Steps: 70 | Train Loss: 0.0560010  Vali Loss: 0.0829844 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728060  Vali macro F1 0.9647547 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 84 cost time: 6.309700965881348
VALI: Epoch: 84, Steps: 70 | Train Loss: 0.0557490  Vali Loss: 0.0833120 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727803  Vali macro F1 0.9633973 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 85 cost time: 6.307077646255493
VALI: Epoch: 85, Steps: 70 | Train Loss: 0.0530110  Vali Loss: 0.0830015 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 86 cost time: 6.3082661628723145
VALI: Epoch: 86, Steps: 70 | Train Loss: 0.0557439  Vali Loss: 0.0831969 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9737873  Vali macro F1 0.9657402 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 87 cost time: 6.317082166671753
VALI: Epoch: 87, Steps: 70 | Train Loss: 0.0542760  Vali Loss: 0.0831485 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9737873  Vali macro F1 0.9657402 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 88 cost time: 6.3348002433776855
VALI: Epoch: 88, Steps: 70 | Train Loss: 0.0531691  Vali Loss: 0.0830978 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 89 cost time: 6.333527326583862
VALI: Epoch: 89, Steps: 70 | Train Loss: 0.0541116  Vali Loss: 0.0831123 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 90 cost time: 6.299266338348389
VALI: Epoch: 90, Steps: 70 | Train Loss: 0.0545117  Vali Loss: 0.0831175 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 91 cost time: 6.3087522983551025
VALI: Epoch: 91, Steps: 70 | Train Loss: 0.0525707  Vali Loss: 0.0831137 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 92 cost time: 6.371006727218628
VALI: Epoch: 92, Steps: 70 | Train Loss: 0.0550436  Vali Loss: 0.0831140 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 93 cost time: 6.391283988952637
VALI: Epoch: 93, Steps: 70 | Train Loss: 0.0540027  Vali Loss: 0.0831161 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 94 cost time: 6.415465593338013
VALI: Epoch: 94, Steps: 70 | Train Loss: 0.0535316  Vali Loss: 0.0831179 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 95 cost time: 6.411832094192505
VALI: Epoch: 95, Steps: 70 | Train Loss: 0.0550891  Vali Loss: 0.0831177 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 96 cost time: 6.415990352630615
VALI: Epoch: 96, Steps: 70 | Train Loss: 0.0541739  Vali Loss: 0.0831119 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732928  Vali macro F1 0.9651987 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9305236  Test weighted F1: 0.9307962  Test macro F1 0.8802160 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.4451375007629395
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0546905  Vali Loss: 0.0837015 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9718197  Vali macro F1 0.9621694 
Validation loss decreased (inf --> 0.083702).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.381424903869629
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0558752  Vali Loss: 0.0832378 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732371  Vali macro F1 0.9656416 
new best score!!!!
Validation loss decreased (0.083702 --> 0.083238).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.293524980545044
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0574173  Vali Loss: 0.0857766 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9712464  Vali macro F1 0.9628680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.274266719818115
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0530452  Vali Loss: 0.0843823 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728135  Vali macro F1 0.9644660 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.305059432983398
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0535264  Vali Loss: 0.0838854 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707626  Vali macro F1 0.9607497 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.315103769302368
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0565273  Vali Loss: 0.0838867 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9717597  Vali macro F1 0.9624205 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.315414667129517
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0546915  Vali Loss: 0.0841131 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9736893  Vali macro F1 0.9654182 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.313317775726318
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0539248  Vali Loss: 0.0803500 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9738723  Vali macro F1 0.9649882 
new best score!!!!
Validation loss decreased (0.083238 --> 0.080350).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.333183288574219
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0543018  Vali Loss: 0.0815533 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9712492  Vali macro F1 0.9620781 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.326935291290283
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0524497  Vali Loss: 0.0815778 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727486  Vali macro F1 0.9639778 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.324424505233765
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0564599  Vali Loss: 0.0853711 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9713897  Vali macro F1 0.9625683 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.3179566860198975
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0550012  Vali Loss: 0.0797808 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9733106  Vali macro F1 0.9641750 
new best score!!!!
Validation loss decreased (0.080350 --> 0.079781).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.317261695861816
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0539444  Vali Loss: 0.0804313 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747713  Vali macro F1 0.9661878 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.311647653579712
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0534924  Vali Loss: 0.0798279 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9743092  Vali macro F1 0.9658723 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.304789066314697
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0558892  Vali Loss: 0.0812790 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9718723  Vali macro F1 0.9620562 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.332338094711304
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0540420  Vali Loss: 0.0842074 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9741681  Vali macro F1 0.9653268 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.328712224960327
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0511569  Vali Loss: 0.0816813 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9717776  Vali macro F1 0.9634296 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.343575477600098
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0517517  Vali Loss: 0.0804144 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728002  Vali macro F1 0.9651139 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.319427251815796
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0511326  Vali Loss: 0.0800290 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728077  Vali macro F1 0.9651122 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.32587456703186
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0495967  Vali Loss: 0.0800232 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732855  Vali macro F1 0.9655758 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.3127851486206055
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0518837  Vali Loss: 0.0796815 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728002  Vali macro F1 0.9651139 
new best score!!!!
Validation loss decreased (0.079781 --> 0.079681).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.311777353286743
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0514840  Vali Loss: 0.0796132 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9738236  Vali macro F1 0.9664251 
new best score!!!!
Validation loss decreased (0.079681 --> 0.079613).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.314523696899414
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0504132  Vali Loss: 0.0794826 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722950  Vali macro F1 0.9643005 
new best score!!!!
Validation loss decreased (0.079613 --> 0.079483).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.3153111934661865
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0482702  Vali Loss: 0.0794202 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9743411  Vali macro F1 0.9669208 
new best score!!!!
Validation loss decreased (0.079483 --> 0.079420).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.3348212242126465
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0492441  Vali Loss: 0.0797257 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722950  Vali macro F1 0.9643005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.344261407852173
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0496299  Vali Loss: 0.0796336 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732781  Vali macro F1 0.9655777 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.339512586593628
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0506518  Vali Loss: 0.0794717 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728002  Vali macro F1 0.9651139 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.317979335784912
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0504625  Vali Loss: 0.0796282 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732855  Vali macro F1 0.9655758 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.330230474472046
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0522594  Vali Loss: 0.0794834 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727618  Vali macro F1 0.9649747 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 6.321659326553345
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0512284  Vali Loss: 0.0795374 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732612  Vali macro F1 0.9657930 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.325324773788452
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0507528  Vali Loss: 0.0795285 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727753  Vali macro F1 0.9653299 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.332033395767212
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0495099  Vali Loss: 0.0795341 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732855  Vali macro F1 0.9655758 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.329396724700928
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0501101  Vali Loss: 0.0794784 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727820  Vali macro F1 0.9653269 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.33414101600647
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0529464  Vali Loss: 0.0794414 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722976  Vali macro F1 0.9648662 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 35 cost time: 6.345921277999878
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0505752  Vali Loss: 0.0794449 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9722976  Vali macro F1 0.9648662 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 6.323341369628906
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0508981  Vali Loss: 0.0794486 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727953  Vali macro F1 0.9656820 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 6.327123403549194
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0509807  Vali Loss: 0.0794594 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9733054  Vali macro F1 0.9659279 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 6.342778205871582
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0501248  Vali Loss: 0.0794686 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9733054  Vali macro F1 0.9659279 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 6.320872783660889
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0495278  Vali Loss: 0.0794774 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9733054  Vali macro F1 0.9659279 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9301555  Test weighted F1: 0.9304925  Test macro F1 0.8807368 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00014029 0.00018169 0.00103093 0.00130208 0.00049358 0.00059809]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.439895868301392
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.4480218  Vali Loss: 0.9912880 Vali Accuracy: 0.6648406  Vali weighted F1: 0.5530560  Vali macro F1 0.2737679 
Validation loss decreased (inf --> 0.991288).  Saving model ...
Epoch: 2 cost time: 6.425649642944336
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.7888293  Vali Loss: 0.7062902 Vali Accuracy: 0.7395418  Vali weighted F1: 0.6776189  Vali macro F1 0.4661334 
new best score!!!!
Validation loss decreased (0.991288 --> 0.706290).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.436117649078369
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.6014488  Vali Loss: 0.5610831 Vali Accuracy: 0.7808765  Vali weighted F1: 0.7415914  Vali macro F1 0.5496741 
new best score!!!!
Validation loss decreased (0.706290 --> 0.561083).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.446960926055908
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.5208086  Vali Loss: 0.4780152 Vali Accuracy: 0.8102590  Vali weighted F1: 0.7795464  Vali macro F1 0.5964871 
new best score!!!!
Validation loss decreased (0.561083 --> 0.478015).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.441349983215332
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.4147454  Vali Loss: 0.4220364 Vali Accuracy: 0.8301793  Vali weighted F1: 0.8040154  Vali macro F1 0.6163272 
new best score!!!!
Validation loss decreased (0.478015 --> 0.422036).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.432488918304443
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.3301703  Vali Loss: 0.2855039 Vali Accuracy: 0.9123506  Vali weighted F1: 0.9117371  Vali macro F1 0.8800457 
new best score!!!!
Validation loss decreased (0.422036 --> 0.285504).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.441817283630371
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.2763221  Vali Loss: 0.2593102 Vali Accuracy: 0.9168327  Vali weighted F1: 0.9148165  Vali macro F1 0.8869756 
new best score!!!!
Validation loss decreased (0.285504 --> 0.259310).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.451446533203125
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2426121  Vali Loss: 0.2457594 Vali Accuracy: 0.9252988  Vali weighted F1: 0.9260975  Vali macro F1 0.8990841 
new best score!!!!
Validation loss decreased (0.259310 --> 0.245759).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.430502891540527
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2191879  Vali Loss: 0.2337050 Vali Accuracy: 0.9228088  Vali weighted F1: 0.9202834  Vali macro F1 0.8972632 
new best score!!!!
Validation loss decreased (0.245759 --> 0.233705).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.434139251708984
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.2020055  Vali Loss: 0.2274978 Vali Accuracy: 0.9287849  Vali weighted F1: 0.9278005  Vali macro F1 0.9025125 
new best score!!!!
Validation loss decreased (0.233705 --> 0.227498).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.498160123825073
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1959585  Vali Loss: 0.2148322 Vali Accuracy: 0.9317729  Vali weighted F1: 0.9309141  Vali macro F1 0.9045438 
new best score!!!!
Validation loss decreased (0.227498 --> 0.214832).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.431234836578369
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1812626  Vali Loss: 0.1968826 Vali Accuracy: 0.9347610  Vali weighted F1: 0.9333840  Vali macro F1 0.9109708 
new best score!!!!
Validation loss decreased (0.214832 --> 0.196883).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.44800066947937
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1737484  Vali Loss: 0.2002807 Vali Accuracy: 0.9322709  Vali weighted F1: 0.9332706  Vali macro F1 0.9102376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.439093828201294
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1742382  Vali Loss: 0.1741849 Vali Accuracy: 0.9412351  Vali weighted F1: 0.9406861  Vali macro F1 0.9189235 
new best score!!!!
Validation loss decreased (0.196883 --> 0.174185).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.441158294677734
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1620945  Vali Loss: 0.1721428 Vali Accuracy: 0.9442231  Vali weighted F1: 0.9442197  Vali macro F1 0.9226595 
new best score!!!!
Validation loss decreased (0.174185 --> 0.172143).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.432360887527466
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1546083  Vali Loss: 0.1831035 Vali Accuracy: 0.9347610  Vali weighted F1: 0.9350021  Vali macro F1 0.9133524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.43367075920105
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1506934  Vali Loss: 0.1611136 Vali Accuracy: 0.9412351  Vali weighted F1: 0.9417455  Vali macro F1 0.9205374 
new best score!!!!
Validation loss decreased (0.172143 --> 0.161114).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.430717945098877
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1461197  Vali Loss: 0.1616244 Vali Accuracy: 0.9457171  Vali weighted F1: 0.9458963  Vali macro F1 0.9259693 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.442713022232056
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1411877  Vali Loss: 0.1597072 Vali Accuracy: 0.9501992  Vali weighted F1: 0.9505331  Vali macro F1 0.9322535 
new best score!!!!
Validation loss decreased (0.161114 --> 0.159707).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.447990894317627
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1425628  Vali Loss: 0.1554900 Vali Accuracy: 0.9511952  Vali weighted F1: 0.9514275  Vali macro F1 0.9340937 
new best score!!!!
Validation loss decreased (0.159707 --> 0.155490).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.447039604187012
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1321119  Vali Loss: 0.1423201 Vali Accuracy: 0.9521912  Vali weighted F1: 0.9522965  Vali macro F1 0.9346156 
new best score!!!!
Validation loss decreased (0.155490 --> 0.142320).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.471705913543701
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1308934  Vali Loss: 0.1427222 Vali Accuracy: 0.9521912  Vali weighted F1: 0.9516845  Vali macro F1 0.9346042 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.4438276290893555
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1272623  Vali Loss: 0.1412324 Vali Accuracy: 0.9551793  Vali weighted F1: 0.9555185  Vali macro F1 0.9392164 
new best score!!!!
Validation loss decreased (0.142320 --> 0.141232).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.439858436584473
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1299809  Vali Loss: 0.1358499 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9578875  Vali macro F1 0.9421960 
new best score!!!!
Validation loss decreased (0.141232 --> 0.135850).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.420867919921875
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1222588  Vali Loss: 0.1352422 Vali Accuracy: 0.9556773  Vali weighted F1: 0.9552569  Vali macro F1 0.9391674 
new best score!!!!
Validation loss decreased (0.135850 --> 0.135242).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.433101654052734
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1236443  Vali Loss: 0.1371928 Vali Accuracy: 0.9546813  Vali weighted F1: 0.9545973  Vali macro F1 0.9385876 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.438764572143555
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1157784  Vali Loss: 0.1619742 Vali Accuracy: 0.9402390  Vali weighted F1: 0.9420935  Vali macro F1 0.9238668 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.45561957359314
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1160697  Vali Loss: 0.1338976 Vali Accuracy: 0.9591633  Vali weighted F1: 0.9593177  Vali macro F1 0.9455635 
new best score!!!!
Validation loss decreased (0.135242 --> 0.133898).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.452902317047119
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1129976  Vali Loss: 0.1179072 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9654218  Vali macro F1 0.9551505 
new best score!!!!
Validation loss decreased (0.133898 --> 0.117907).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.454789876937866
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1091109  Vali Loss: 0.1434926 Vali Accuracy: 0.9487052  Vali weighted F1: 0.9500277  Vali macro F1 0.9399962 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.429634094238281
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.1081320  Vali Loss: 0.1206461 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9652539  Vali macro F1 0.9540367 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.431000709533691
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.1076627  Vali Loss: 0.1124383 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9689661  Vali macro F1 0.9599630 
new best score!!!!
Validation loss decreased (0.117907 --> 0.112438).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.417514085769653
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.1026904  Vali Loss: 0.1154952 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9653146  Vali macro F1 0.9552170 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.42540979385376
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.1015244  Vali Loss: 0.1099029 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9670929  Vali macro F1 0.9581403 
new best score!!!!
Validation loss decreased (0.112438 --> 0.109903).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.434114933013916
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0955918  Vali Loss: 0.1098871 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9665199  Vali macro F1 0.9582064 
new best score!!!!
Validation loss decreased (0.109903 --> 0.109887).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.440042018890381
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0981581  Vali Loss: 0.1040200 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9698391  Vali macro F1 0.9602620 
new best score!!!!
Validation loss decreased (0.109887 --> 0.104020).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.453044652938843
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0947036  Vali Loss: 0.1034752 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707907  Vali macro F1 0.9603110 
new best score!!!!
Validation loss decreased (0.104020 --> 0.103475).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.449844837188721
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0874886  Vali Loss: 0.1127542 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9659824  Vali macro F1 0.9566395 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.4315032958984375
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0934981  Vali Loss: 0.1153955 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9641469  Vali macro F1 0.9549964 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.438910484313965
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0957594  Vali Loss: 0.1017260 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9684952  Vali macro F1 0.9606515 
new best score!!!!
Validation loss decreased (0.103475 --> 0.101726).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.438111305236816
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0870821  Vali Loss: 0.1044436 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9670168  Vali macro F1 0.9590468 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.444793939590454
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0820108  Vali Loss: 0.1019964 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9675971  Vali macro F1 0.9582826 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.430258750915527
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0819587  Vali Loss: 0.1103730 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9659550  Vali macro F1 0.9560971 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.43645977973938
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0793173  Vali Loss: 0.1070654 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9674609  Vali macro F1 0.9570120 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.454730033874512
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0798788  Vali Loss: 0.1084035 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9646291  Vali macro F1 0.9535147 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 6.45165753364563
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0715950  Vali Loss: 0.0864894 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9722391  Vali macro F1 0.9644113 
new best score!!!!
Validation loss decreased (0.101726 --> 0.086489).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.437071323394775
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0628879  Vali Loss: 0.0876595 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9722677  Vali macro F1 0.9641509 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.442067384719849
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0646306  Vali Loss: 0.0877108 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732330  Vali macro F1 0.9651140 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.4370057582855225
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0639479  Vali Loss: 0.0859743 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717865  Vali macro F1 0.9637140 
new best score!!!!
Validation loss decreased (0.086489 --> 0.085974).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.434942245483398
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0641538  Vali Loss: 0.0872991 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732714  Vali macro F1 0.9648066 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.429242849349976
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0650327  Vali Loss: 0.0872301 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728169  Vali macro F1 0.9651292 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.436805486679077
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0637849  Vali Loss: 0.0847755 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728136  Vali macro F1 0.9647318 
new best score!!!!
Validation loss decreased (0.085974 --> 0.084776).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.460040807723999
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0635054  Vali Loss: 0.0847204 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9722313  Vali macro F1 0.9640946 
new best score!!!!
Validation loss decreased (0.084776 --> 0.084720).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.446057558059692
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0619417  Vali Loss: 0.0859856 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712955  Vali macro F1 0.9628908 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.427880525588989
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0628967  Vali Loss: 0.0837477 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732095  Vali macro F1 0.9650211 
new best score!!!!
Validation loss decreased (0.084720 --> 0.083748).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.429199934005737
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0631458  Vali Loss: 0.0849255 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718421  Vali macro F1 0.9631892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.435292959213257
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0645831  Vali Loss: 0.0877214 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712895  Vali macro F1 0.9633785 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.417249441146851
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0616153  Vali Loss: 0.0855348 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9722947  Vali macro F1 0.9643229 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.432757616043091
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0606647  Vali Loss: 0.0861385 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728287  Vali macro F1 0.9646902 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.534718751907349
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0622677  Vali Loss: 0.0872835 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723382  Vali macro F1 0.9639108 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 61 cost time: 6.45002818107605
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0612185  Vali Loss: 0.0859711 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718142  Vali macro F1 0.9634278 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.457563877105713
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0608697  Vali Loss: 0.0867179 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723356  Vali macro F1 0.9638162 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.4375901222229
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0614961  Vali Loss: 0.0861643 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723199  Vali macro F1 0.9639905 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.433138132095337
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0596744  Vali Loss: 0.0857480 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723199  Vali macro F1 0.9639905 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.431737184524536
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0601439  Vali Loss: 0.0852298 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718172  Vali macro F1 0.9634137 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 66 cost time: 6.4266886711120605
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0612555  Vali Loss: 0.0852362 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718172  Vali macro F1 0.9634137 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.426358938217163
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0605650  Vali Loss: 0.0851953 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718172  Vali macro F1 0.9634137 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.430892705917358
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0593459  Vali Loss: 0.0852922 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718172  Vali macro F1 0.9634137 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.454022407531738
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0588669  Vali Loss: 0.0853232 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718172  Vali macro F1 0.9634137 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.446191310882568
VALI: Epoch: 70, Steps: 71 | Train Loss: 0.0594324  Vali Loss: 0.0853395 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718172  Vali macro F1 0.9634137 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9387054  Test weighted F1: 0.9383034  Test macro F1 0.9064528 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.420988082885742
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0626613  Vali Loss: 0.0879915 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717517  Vali macro F1 0.9630916 
Validation loss decreased (inf --> 0.087991).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.411778926849365
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0622310  Vali Loss: 0.0845679 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718209  Vali macro F1 0.9637429 
new best score!!!!
Validation loss decreased (0.087991 --> 0.084568).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.41280722618103
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0619099  Vali Loss: 0.0857273 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727686  Vali macro F1 0.9640332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.411707401275635
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0612532  Vali Loss: 0.0855960 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723437  Vali macro F1 0.9642241 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.421356201171875
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0620620  Vali Loss: 0.0860518 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713226  Vali macro F1 0.9626473 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.4182164669036865
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0607345  Vali Loss: 0.0849519 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717975  Vali macro F1 0.9635786 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.439464330673218
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0585376  Vali Loss: 0.0897368 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713389  Vali macro F1 0.9633064 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.436291933059692
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0601890  Vali Loss: 0.0874779 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723950  Vali macro F1 0.9641053 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.430563688278198
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0603602  Vali Loss: 0.0818663 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742653  Vali macro F1 0.9658458 
new best score!!!!
Validation loss decreased (0.084568 --> 0.081866).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.42864727973938
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0610027  Vali Loss: 0.0843234 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718664  Vali macro F1 0.9633349 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.41886830329895
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0580798  Vali Loss: 0.0825540 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9751971  Vali macro F1 0.9674575 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.420749187469482
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0588874  Vali Loss: 0.0876279 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713226  Vali macro F1 0.9626473 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.429730653762817
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0588178  Vali Loss: 0.0828803 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728250  Vali macro F1 0.9639650 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.4414215087890625
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0602486  Vali Loss: 0.0874228 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727546  Vali macro F1 0.9637722 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.427315950393677
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0578003  Vali Loss: 0.0850379 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728049  Vali macro F1 0.9644565 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.42422342300415
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0587946  Vali Loss: 0.0848396 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728049  Vali macro F1 0.9644565 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.428164720535278
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0565820  Vali Loss: 0.0839488 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728266  Vali macro F1 0.9647303 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.449526071548462
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0561621  Vali Loss: 0.0843418 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728266  Vali macro F1 0.9647303 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.426877498626709
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0562797  Vali Loss: 0.0839759 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732965  Vali macro F1 0.9652381 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 6.426357746124268
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0569200  Vali Loss: 0.0838557 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732965  Vali macro F1 0.9652381 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.428959369659424
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0581343  Vali Loss: 0.0839644 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732965  Vali macro F1 0.9652381 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.426714897155762
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0578736  Vali Loss: 0.0842010 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732965  Vali macro F1 0.9652381 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.421306848526001
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0567197  Vali Loss: 0.0842298 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732965  Vali macro F1 0.9652381 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.419450044631958
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0580559  Vali Loss: 0.0843599 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732965  Vali macro F1 0.9652381 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9404788  Test weighted F1: 0.9400685  Test macro F1 0.9093322 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 17919
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014616 0.00018232 0.00096154 0.001221   0.00048263 0.00060864]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.212432146072388
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.3832326  Vali Loss: 0.8767502 Vali Accuracy: 0.6842634  Vali weighted F1: 0.5774569  Vali macro F1 0.2748225 
Validation loss decreased (inf --> 0.876750).  Saving model ...
Epoch: 2 cost time: 6.234994173049927
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.7883040  Vali Loss: 0.6734401 Vali Accuracy: 0.7631976  Vali weighted F1: 0.7054182  Vali macro F1 0.4799182 
new best score!!!!
Validation loss decreased (0.876750 --> 0.673440).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.221448183059692
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6360512  Vali Loss: 0.5897919 Vali Accuracy: 0.7642031  Vali weighted F1: 0.7014361  Vali macro F1 0.4733778 
new best score!!!!
Validation loss decreased (0.673440 --> 0.589792).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.210256338119507
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5644275  Vali Loss: 0.5132772 Vali Accuracy: 0.7973856  Vali weighted F1: 0.7555092  Vali macro F1 0.5394527 
new best score!!!!
Validation loss decreased (0.589792 --> 0.513277).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.217151641845703
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4770350  Vali Loss: 0.4500000 Vali Accuracy: 0.8496732  Vali weighted F1: 0.8218330  Vali macro F1 0.7584659 
new best score!!!!
Validation loss decreased (0.513277 --> 0.450000).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.216245174407959
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3901163  Vali Loss: 0.3971129 Vali Accuracy: 0.8738059  Vali weighted F1: 0.8593793  Vali macro F1 0.8157294 
new best score!!!!
Validation loss decreased (0.450000 --> 0.397113).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.222865581512451
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3337504  Vali Loss: 0.3156333 Vali Accuracy: 0.8929110  Vali weighted F1: 0.8867029  Vali macro F1 0.8472898 
new best score!!!!
Validation loss decreased (0.397113 --> 0.315633).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.234774112701416
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2973169  Vali Loss: 0.2731843 Vali Accuracy: 0.9029663  Vali weighted F1: 0.8983021  Vali macro F1 0.8610143 
new best score!!!!
Validation loss decreased (0.315633 --> 0.273184).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.239210844039917
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2676031  Vali Loss: 0.2498800 Vali Accuracy: 0.9155354  Vali weighted F1: 0.9125008  Vali macro F1 0.8816995 
new best score!!!!
Validation loss decreased (0.273184 --> 0.249880).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2275073528289795
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2477801  Vali Loss: 0.2260875 Vali Accuracy: 0.9270990  Vali weighted F1: 0.9271855  Vali macro F1 0.8972874 
new best score!!!!
Validation loss decreased (0.249880 --> 0.226087).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.221370697021484
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2232631  Vali Loss: 0.2174171 Vali Accuracy: 0.9311212  Vali weighted F1: 0.9307890  Vali macro F1 0.9028121 
new best score!!!!
Validation loss decreased (0.226087 --> 0.217417).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.222137689590454
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.2070875  Vali Loss: 0.1903199 Vali Accuracy: 0.9396682  Vali weighted F1: 0.9396941  Vali macro F1 0.9133039 
new best score!!!!
Validation loss decreased (0.217417 --> 0.190320).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.21950364112854
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1962728  Vali Loss: 0.1990597 Vali Accuracy: 0.9351433  Vali weighted F1: 0.9347323  Vali macro F1 0.9070554 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.214451313018799
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1829663  Vali Loss: 0.1683284 Vali Accuracy: 0.9462041  Vali weighted F1: 0.9463817  Vali macro F1 0.9211420 
new best score!!!!
Validation loss decreased (0.190320 --> 0.168328).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.221920728683472
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1728135  Vali Loss: 0.1583890 Vali Accuracy: 0.9477124  Vali weighted F1: 0.9476059  Vali macro F1 0.9237133 
new best score!!!!
Validation loss decreased (0.168328 --> 0.158389).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.227978467941284
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1616467  Vali Loss: 0.2204254 Vali Accuracy: 0.9281046  Vali weighted F1: 0.9248185  Vali macro F1 0.8981517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.230310440063477
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1605005  Vali Loss: 0.1508531 Vali Accuracy: 0.9517345  Vali weighted F1: 0.9514767  Vali macro F1 0.9343682 
new best score!!!!
Validation loss decreased (0.158389 --> 0.150853).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.256459951400757
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1515869  Vali Loss: 0.1606242 Vali Accuracy: 0.9492207  Vali weighted F1: 0.9491213  Vali macro F1 0.9325830 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.229565382003784
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1488234  Vali Loss: 0.1354813 Vali Accuracy: 0.9537456  Vali weighted F1: 0.9538369  Vali macro F1 0.9369688 
new best score!!!!
Validation loss decreased (0.150853 --> 0.135481).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.226711750030518
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1432251  Vali Loss: 0.1247064 Vali Accuracy: 0.9567622  Vali weighted F1: 0.9567597  Vali macro F1 0.9414890 
new best score!!!!
Validation loss decreased (0.135481 --> 0.124706).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.226057529449463
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1378582  Vali Loss: 0.1389689 Vali Accuracy: 0.9547511  Vali weighted F1: 0.9544443  Vali macro F1 0.9357958 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.226274490356445
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1365505  Vali Loss: 0.1299548 Vali Accuracy: 0.9587733  Vali weighted F1: 0.9593570  Vali macro F1 0.9423018 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.2333292961120605
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1332127  Vali Loss: 0.1369812 Vali Accuracy: 0.9552539  Vali weighted F1: 0.9552640  Vali macro F1 0.9406185 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.222168207168579
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1313737  Vali Loss: 0.1242166 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9576780  Vali macro F1 0.9421771 
new best score!!!!
Validation loss decreased (0.124706 --> 0.124217).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.235417366027832
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1223534  Vali Loss: 0.1371957 Vali Accuracy: 0.9557567  Vali weighted F1: 0.9559138  Vali macro F1 0.9411371 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.237879991531372
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1194646  Vali Loss: 0.1423768 Vali Accuracy: 0.9547511  Vali weighted F1: 0.9555767  Vali macro F1 0.9361167 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.232961177825928
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1210170  Vali Loss: 0.1244679 Vali Accuracy: 0.9567622  Vali weighted F1: 0.9564203  Vali macro F1 0.9425699 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.225588083267212
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1152555  Vali Loss: 0.1254776 Vali Accuracy: 0.9547511  Vali weighted F1: 0.9542364  Vali macro F1 0.9380283 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.225188255310059
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1123242  Vali Loss: 0.1127124 Vali Accuracy: 0.9592760  Vali weighted F1: 0.9590582  Vali macro F1 0.9444333 
new best score!!!!
Validation loss decreased (0.124217 --> 0.112712).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.231482267379761
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1158361  Vali Loss: 0.1125495 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9576956  Vali macro F1 0.9393770 
new best score!!!!
Validation loss decreased (0.112712 --> 0.112549).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.217959880828857
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1120398  Vali Loss: 0.1316520 Vali Accuracy: 0.9532428  Vali weighted F1: 0.9527279  Vali macro F1 0.9307157 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.213082313537598
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1096184  Vali Loss: 0.1054288 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9629815  Vali macro F1 0.9466765 
new best score!!!!
Validation loss decreased (0.112549 --> 0.105429).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.220827341079712
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.1035262  Vali Loss: 0.0986444 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9668669  Vali macro F1 0.9513447 
new best score!!!!
Validation loss decreased (0.105429 --> 0.098644).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.2401111125946045
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.1027145  Vali Loss: 0.1099192 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9611316  Vali macro F1 0.9465683 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.229761600494385
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.1024240  Vali Loss: 0.1206819 Vali Accuracy: 0.9567622  Vali weighted F1: 0.9561806  Vali macro F1 0.9389646 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.213917970657349
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0982097  Vali Loss: 0.1078028 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9626322  Vali macro F1 0.9481097 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.211560010910034
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0964712  Vali Loss: 0.0998205 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9670115  Vali macro F1 0.9525354 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.211596488952637
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0923471  Vali Loss: 0.1009924 Vali Accuracy: 0.9653092  Vali weighted F1: 0.9657619  Vali macro F1 0.9510359 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 6.210508823394775
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0860634  Vali Loss: 0.0889754 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9709362  Vali macro F1 0.9605481 
new best score!!!!
Validation loss decreased (0.098644 --> 0.088975).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.213099241256714
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0815569  Vali Loss: 0.0890930 Vali Accuracy: 0.9693313  Vali weighted F1: 0.9694488  Vali macro F1 0.9583747 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.213682413101196
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0818232  Vali Loss: 0.0878757 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9709728  Vali macro F1 0.9604934 
new best score!!!!
Validation loss decreased (0.088975 --> 0.087876).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.240641355514526
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0790398  Vali Loss: 0.0887309 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9699175  Vali macro F1 0.9588517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.256634950637817
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0800843  Vali Loss: 0.0920167 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9685280  Vali macro F1 0.9571741 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.2301928997039795
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0794902  Vali Loss: 0.0893414 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9679835  Vali macro F1 0.9558249 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.2256903648376465
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0780489  Vali Loss: 0.0921188 Vali Accuracy: 0.9663147  Vali weighted F1: 0.9664301  Vali macro F1 0.9535928 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.216462850570679
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0795010  Vali Loss: 0.0925662 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9669962  Vali macro F1 0.9544185 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.222006559371948
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0783439  Vali Loss: 0.0895439 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674998  Vali macro F1 0.9555286 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.220333576202393
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0762725  Vali Loss: 0.0894274 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9679448  Vali macro F1 0.9551918 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.223835229873657
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0761854  Vali Loss: 0.0895831 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9679686  Vali macro F1 0.9560205 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.231831073760986
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0771270  Vali Loss: 0.0892131 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9669691  Vali macro F1 0.9543971 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.245169162750244
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0775877  Vali Loss: 0.0900706 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674690  Vali macro F1 0.9552092 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 6.225764989852905
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0772241  Vali Loss: 0.0900396 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9669691  Vali macro F1 0.9543971 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.218150615692139
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0778363  Vali Loss: 0.0899092 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9669691  Vali macro F1 0.9543971 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.2150609493255615
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0775006  Vali Loss: 0.0898906 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9669691  Vali macro F1 0.9543971 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.921217203140259
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0771700  Vali Loss: 0.0898215 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9669691  Vali macro F1 0.9543971 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.176558256149292
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0783062  Vali Loss: 0.0898203 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9669691  Vali macro F1 0.9543971 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8174324  Test weighted F1: 0.8269375  Test macro F1 0.7387454 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.211125612258911
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0813570  Vali Loss: 0.0901127 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9683684  Vali macro F1 0.9571941 
Validation loss decreased (inf --> 0.090113).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.204535961151123
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0806224  Vali Loss: 0.0879618 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9684754  Vali macro F1 0.9549349 
new best score!!!!
Validation loss decreased (0.090113 --> 0.087962).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.218835830688477
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0793668  Vali Loss: 0.0874480 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9667896  Vali macro F1 0.9535680 
new best score!!!!
Validation loss decreased (0.087962 --> 0.087448).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.198049306869507
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0796332  Vali Loss: 0.0869411 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9684329  Vali macro F1 0.9562505 
new best score!!!!
Validation loss decreased (0.087448 --> 0.086941).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.276041030883789
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0797814  Vali Loss: 0.0917933 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9659402  Vali macro F1 0.9546175 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.326015949249268
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0799514  Vali Loss: 0.0887395 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9690425  Vali macro F1 0.9561616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.254493951797485
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0798935  Vali Loss: 0.0874420 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9657516  Vali macro F1 0.9537062 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.204064846038818
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0776277  Vali Loss: 0.0887998 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9710356  Vali macro F1 0.9591815 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.209853172302246
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0767329  Vali Loss: 0.0898870 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9669430  Vali macro F1 0.9541507 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.210192441940308
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0755706  Vali Loss: 0.0883770 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9689115  Vali macro F1 0.9570671 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.219622850418091
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0772287  Vali Loss: 0.0927038 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9658317  Vali macro F1 0.9531175 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.444570064544678
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0767612  Vali Loss: 0.0885696 Vali Accuracy: 0.9693313  Vali weighted F1: 0.9694157  Vali macro F1 0.9583167 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.2100160121917725
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0753457  Vali Loss: 0.0873617 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9689324  Vali macro F1 0.9572705 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.2057318687438965
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0757361  Vali Loss: 0.0887619 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9684454  Vali macro F1 0.9549827 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.204373121261597
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0739394  Vali Loss: 0.0884218 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.2037272453308105
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0739405  Vali Loss: 0.0870158 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9679119  Vali macro F1 0.9545907 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.20304012298584
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0718953  Vali Loss: 0.0881658 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.214721441268921
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0741157  Vali Loss: 0.0865952 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
new best score!!!!
Validation loss decreased (0.086941 --> 0.086595).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.239713430404663
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0752572  Vali Loss: 0.0863503 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
new best score!!!!
Validation loss decreased (0.086595 --> 0.086350).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.235829830169678
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0755250  Vali Loss: 0.0860452 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9679119  Vali macro F1 0.9545907 
new best score!!!!
Validation loss decreased (0.086350 --> 0.086045).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.267470121383667
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0737710  Vali Loss: 0.0868337 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.219694137573242
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0736799  Vali Loss: 0.0876180 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.212909698486328
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0739030  Vali Loss: 0.0865268 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9684403  Vali macro F1 0.9555211 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.2116005420684814
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0721324  Vali Loss: 0.0867874 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9684198  Vali macro F1 0.9557101 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.219160318374634
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0730092  Vali Loss: 0.0873569 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.217182397842407
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0726805  Vali Loss: 0.0870421 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.228896617889404
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0729832  Vali Loss: 0.0870337 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.244969844818115
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0727298  Vali Loss: 0.0868617 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.208161354064941
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0746930  Vali Loss: 0.0869264 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.210416316986084
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0716633  Vali Loss: 0.0868754 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 31 cost time: 6.217018365859985
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0733999  Vali Loss: 0.0868649 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.211950778961182
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0737585  Vali Loss: 0.0868641 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.208399057388306
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0737773  Vali Loss: 0.0868529 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.21054220199585
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0736492  Vali Loss: 0.0868431 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.2510130405426025
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0743177  Vali Loss: 0.0868407 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674237  Vali macro F1 0.9541227 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8192420  Test weighted F1: 0.8283550  Test macro F1 0.7625919 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014914 0.00018315 0.00110742 0.00140252 0.00050633 0.00062617]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.013524055480957
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.3782886  Vali Loss: 0.9052232 Vali Accuracy: 0.6677035  Vali weighted F1: 0.5587615  Vali macro F1 0.2746845 
Validation loss decreased (inf --> 0.905223).  Saving model ...
Epoch: 2 cost time: 5.999610900878906
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.7806154  Vali Loss: 0.7092116 Vali Accuracy: 0.7454640  Vali weighted F1: 0.6655425  Vali macro F1 0.4493226 
new best score!!!!
Validation loss decreased (0.905223 --> 0.709212).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.995065689086914
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.6407863  Vali Loss: 0.6048154 Vali Accuracy: 0.7662001  Vali weighted F1: 0.7105073  Vali macro F1 0.4995807 
new best score!!!!
Validation loss decreased (0.709212 --> 0.604815).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.009047985076904
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.5546129  Vali Loss: 0.5425079 Vali Accuracy: 0.8170036  Vali weighted F1: 0.7713212  Vali macro F1 0.6930850 
new best score!!!!
Validation loss decreased (0.604815 --> 0.542508).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.009919166564941
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.4789001  Vali Loss: 0.4321167 Vali Accuracy: 0.8470710  Vali weighted F1: 0.8190257  Vali macro F1 0.7579085 
new best score!!!!
Validation loss decreased (0.542508 --> 0.432117).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.0066163539886475
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.4226122  Vali Loss: 0.3910313 Vali Accuracy: 0.8672888  Vali weighted F1: 0.8515120  Vali macro F1 0.8057406 
new best score!!!!
Validation loss decreased (0.432117 --> 0.391031).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.0089430809021
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.3701930  Vali Loss: 0.3333956 Vali Accuracy: 0.8849145  Vali weighted F1: 0.8753477  Vali macro F1 0.8298150 
new best score!!!!
Validation loss decreased (0.391031 --> 0.333396).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.015650510787964
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.3250504  Vali Loss: 0.3081045 Vali Accuracy: 0.8973561  Vali weighted F1: 0.8923191  Vali macro F1 0.8514062 
new best score!!!!
Validation loss decreased (0.333396 --> 0.308104).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.034284591674805
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.2847755  Vali Loss: 0.2804311 Vali Accuracy: 0.8983929  Vali weighted F1: 0.8927311  Vali macro F1 0.8535591 
new best score!!!!
Validation loss decreased (0.308104 --> 0.280431).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.03900933265686
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.2516314  Vali Loss: 0.2373717 Vali Accuracy: 0.9160187  Vali weighted F1: 0.9162548  Vali macro F1 0.8855043 
new best score!!!!
Validation loss decreased (0.280431 --> 0.237372).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.016495227813721
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.2383214  Vali Loss: 0.2152469 Vali Accuracy: 0.9300156  Vali weighted F1: 0.9291943  Vali macro F1 0.9012483 
new best score!!!!
Validation loss decreased (0.237372 --> 0.215247).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.016085147857666
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.2261657  Vali Loss: 0.2097862 Vali Accuracy: 0.9315708  Vali weighted F1: 0.9315652  Vali macro F1 0.9049235 
new best score!!!!
Validation loss decreased (0.215247 --> 0.209786).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.01071572303772
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.2060221  Vali Loss: 0.1936264 Vali Accuracy: 0.9326076  Vali weighted F1: 0.9322593  Vali macro F1 0.9053896 
new best score!!!!
Validation loss decreased (0.209786 --> 0.193626).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.008967638015747
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1935828  Vali Loss: 0.2045079 Vali Accuracy: 0.9310524  Vali weighted F1: 0.9307687  Vali macro F1 0.9063781 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.00946569442749
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1857601  Vali Loss: 0.2269500 Vali Accuracy: 0.9253499  Vali weighted F1: 0.9245474  Vali macro F1 0.9006409 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.019388437271118
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1790053  Vali Loss: 0.1829841 Vali Accuracy: 0.9372732  Vali weighted F1: 0.9382548  Vali macro F1 0.9158972 
new best score!!!!
Validation loss decreased (0.193626 --> 0.182984).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.005269527435303
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1674908  Vali Loss: 0.1702043 Vali Accuracy: 0.9393468  Vali weighted F1: 0.9387488  Vali macro F1 0.9114951 
new best score!!!!
Validation loss decreased (0.182984 --> 0.170204).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.02293062210083
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.1626241  Vali Loss: 0.1578553 Vali Accuracy: 0.9419388  Vali weighted F1: 0.9416146  Vali macro F1 0.9175334 
new best score!!!!
Validation loss decreased (0.170204 --> 0.157855).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.022721529006958
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.1560502  Vali Loss: 0.1610722 Vali Accuracy: 0.9434940  Vali weighted F1: 0.9430363  Vali macro F1 0.9247615 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.023486137390137
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.1498822  Vali Loss: 0.2273389 Vali Accuracy: 0.9243131  Vali weighted F1: 0.9224131  Vali macro F1 0.8995300 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.00070858001709
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.1506195  Vali Loss: 0.1556029 Vali Accuracy: 0.9450492  Vali weighted F1: 0.9446278  Vali macro F1 0.9242040 
new best score!!!!
Validation loss decreased (0.157855 --> 0.155603).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.017063140869141
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.1423338  Vali Loss: 0.1405764 Vali Accuracy: 0.9528253  Vali weighted F1: 0.9530674  Vali macro F1 0.9369756 
new best score!!!!
Validation loss decreased (0.155603 --> 0.140576).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.015749216079712
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.1344413  Vali Loss: 0.1602001 Vali Accuracy: 0.9450492  Vali weighted F1: 0.9446722  Vali macro F1 0.9248926 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.01561164855957
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.1271550  Vali Loss: 0.1450073 Vali Accuracy: 0.9497149  Vali weighted F1: 0.9492272  Vali macro F1 0.9325447 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.018876314163208
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.1289724  Vali Loss: 0.1351730 Vali Accuracy: 0.9486781  Vali weighted F1: 0.9492228  Vali macro F1 0.9333924 
new best score!!!!
Validation loss decreased (0.140576 --> 0.135173).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.013146638870239
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.1218362  Vali Loss: 0.1301556 Vali Accuracy: 0.9538621  Vali weighted F1: 0.9540958  Vali macro F1 0.9380765 
new best score!!!!
Validation loss decreased (0.135173 --> 0.130156).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.017945766448975
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.1229295  Vali Loss: 0.1308226 Vali Accuracy: 0.9533437  Vali weighted F1: 0.9531382  Vali macro F1 0.9374003 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.044297933578491
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.1193665  Vali Loss: 0.1338882 Vali Accuracy: 0.9512701  Vali weighted F1: 0.9511885  Vali macro F1 0.9334284 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.008215665817261
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.1115413  Vali Loss: 0.1216149 Vali Accuracy: 0.9512701  Vali weighted F1: 0.9517148  Vali macro F1 0.9362500 
new best score!!!!
Validation loss decreased (0.130156 --> 0.121615).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.020421981811523
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.1087104  Vali Loss: 0.1317024 Vali Accuracy: 0.9502333  Vali weighted F1: 0.9506386  Vali macro F1 0.9378395 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.012634038925171
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.1096624  Vali Loss: 0.1236474 Vali Accuracy: 0.9543805  Vali weighted F1: 0.9542590  Vali macro F1 0.9362733 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.010110139846802
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.1039228  Vali Loss: 0.1197975 Vali Accuracy: 0.9595645  Vali weighted F1: 0.9593180  Vali macro F1 0.9462947 
new best score!!!!
Validation loss decreased (0.121615 --> 0.119798).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.019671440124512
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.1041706  Vali Loss: 0.1342487 Vali Accuracy: 0.9507517  Vali weighted F1: 0.9497559  Vali macro F1 0.9352097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.998415946960449
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.1059877  Vali Loss: 0.1257499 Vali Accuracy: 0.9538621  Vali weighted F1: 0.9541996  Vali macro F1 0.9409528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.020544528961182
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0960791  Vali Loss: 0.1170890 Vali Accuracy: 0.9600829  Vali weighted F1: 0.9601592  Vali macro F1 0.9461002 
new best score!!!!
Validation loss decreased (0.119798 --> 0.117089).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.034437656402588
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0983544  Vali Loss: 0.1127822 Vali Accuracy: 0.9626750  Vali weighted F1: 0.9627795  Vali macro F1 0.9533144 
new best score!!!!
Validation loss decreased (0.117089 --> 0.112782).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.035205841064453
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0945110  Vali Loss: 0.0958450 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9674773  Vali macro F1 0.9580545 
new best score!!!!
Validation loss decreased (0.112782 --> 0.095845).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.012475490570068
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0927379  Vali Loss: 0.1184994 Vali Accuracy: 0.9580093  Vali weighted F1: 0.9583492  Vali macro F1 0.9480762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.008319139480591
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0864642  Vali Loss: 0.0989066 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9621820  Vali macro F1 0.9510946 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.00583291053772
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0957387  Vali Loss: 0.0998675 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9622001  Vali macro F1 0.9507592 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.007692337036133
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0867158  Vali Loss: 0.1163422 Vali Accuracy: 0.9574909  Vali weighted F1: 0.9576466  Vali macro F1 0.9455821 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.0130321979522705
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0789565  Vali Loss: 0.0954824 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9622803  Vali macro F1 0.9484281 
new best score!!!!
Validation loss decreased (0.095845 --> 0.095482).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.0096588134765625
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0803026  Vali Loss: 0.1077981 Vali Accuracy: 0.9600829  Vali weighted F1: 0.9607537  Vali macro F1 0.9498353 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.008460998535156
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0804917  Vali Loss: 0.1015805 Vali Accuracy: 0.9637118  Vali weighted F1: 0.9640808  Vali macro F1 0.9523744 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.024025201797485
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0872595  Vali Loss: 0.0993387 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9645318  Vali macro F1 0.9541387 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.008085489273071
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0720459  Vali Loss: 0.0861368 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9699918  Vali macro F1 0.9608278 
new best score!!!!
Validation loss decreased (0.095482 --> 0.086137).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.0038001537323
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0766681  Vali Loss: 0.1091493 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9620537  Vali macro F1 0.9516269 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.00125789642334
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0747596  Vali Loss: 0.0805400 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9699138  Vali macro F1 0.9599514 
new best score!!!!
Validation loss decreased (0.086137 --> 0.080540).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.01007342338562
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0764635  Vali Loss: 0.1027158 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9645537  Vali macro F1 0.9554587 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.000386953353882
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0749800  Vali Loss: 0.0837607 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9686075  Vali macro F1 0.9578386 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.001034498214722
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0687865  Vali Loss: 0.0907647 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9686230  Vali macro F1 0.9600632 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.007589817047119
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0654142  Vali Loss: 0.0871414 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9704262  Vali macro F1 0.9595673 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.015047550201416
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0718343  Vali Loss: 0.0828182 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9715000  Vali macro F1 0.9595345 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 6.023693084716797
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0569694  Vali Loss: 0.0807667 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9714983  Vali macro F1 0.9614629 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.014455795288086
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0552592  Vali Loss: 0.0760083 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9715947  Vali macro F1 0.9620108 
new best score!!!!
Validation loss decreased (0.080540 --> 0.076008).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.01670241355896
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0557760  Vali Loss: 0.0760136 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9736759  Vali macro F1 0.9632107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.014241695404053
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0542981  Vali Loss: 0.0785842 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9701072  Vali macro F1 0.9592490 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.008162975311279
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0537058  Vali Loss: 0.0760067 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726338  Vali macro F1 0.9618036 
new best score!!!!
Validation loss decreased (0.076008 --> 0.076007).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 6.007916212081909
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0545287  Vali Loss: 0.0776416 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9716021  Vali macro F1 0.9608147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.015573978424072
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0533291  Vali Loss: 0.0754537 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731348  Vali macro F1 0.9629247 
new best score!!!!
Validation loss decreased (0.076007 --> 0.075454).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.012853384017944
VALI: Epoch: 61, Steps: 68 | Train Loss: 0.0528158  Vali Loss: 0.0757528 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9721544  Vali macro F1 0.9617650 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.034302473068237
VALI: Epoch: 62, Steps: 68 | Train Loss: 0.0534587  Vali Loss: 0.0790294 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9729598  Vali macro F1 0.9629237 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.02582573890686
VALI: Epoch: 63, Steps: 68 | Train Loss: 0.0511984  Vali Loss: 0.0766688 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731652  Vali macro F1 0.9623945 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.00554347038269
VALI: Epoch: 64, Steps: 68 | Train Loss: 0.0511725  Vali Loss: 0.0781329 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9730887  Vali macro F1 0.9634365 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.025864839553833
VALI: Epoch: 65, Steps: 68 | Train Loss: 0.0521648  Vali Loss: 0.0774444 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 66 cost time: 6.006792783737183
VALI: Epoch: 66, Steps: 68 | Train Loss: 0.0553799  Vali Loss: 0.0759400 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.005223274230957
VALI: Epoch: 67, Steps: 68 | Train Loss: 0.0506451  Vali Loss: 0.0750591 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9736624  Vali macro F1 0.9635202 
new best score!!!!
Validation loss decreased (0.075454 --> 0.075059).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 6.0066070556640625
VALI: Epoch: 68, Steps: 68 | Train Loss: 0.0503159  Vali Loss: 0.0750639 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 6.0131847858428955
VALI: Epoch: 69, Steps: 68 | Train Loss: 0.0500943  Vali Loss: 0.0757454 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9736624  Vali macro F1 0.9635202 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 6.017400503158569
VALI: Epoch: 70, Steps: 68 | Train Loss: 0.0493076  Vali Loss: 0.0753820 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 6.037690162658691
VALI: Epoch: 71, Steps: 68 | Train Loss: 0.0485989  Vali Loss: 0.0753073 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9736624  Vali macro F1 0.9635202 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 6.00576114654541
VALI: Epoch: 72, Steps: 68 | Train Loss: 0.0496609  Vali Loss: 0.0757417 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 73 cost time: 6.005685329437256
VALI: Epoch: 73, Steps: 68 | Train Loss: 0.0499431  Vali Loss: 0.0755503 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 6.007208347320557
VALI: Epoch: 74, Steps: 68 | Train Loss: 0.0521879  Vali Loss: 0.0754323 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 6.010457754135132
VALI: Epoch: 75, Steps: 68 | Train Loss: 0.0527339  Vali Loss: 0.0753501 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 6.015656232833862
VALI: Epoch: 76, Steps: 68 | Train Loss: 0.0497091  Vali Loss: 0.0753250 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 6.01601767539978
VALI: Epoch: 77, Steps: 68 | Train Loss: 0.0500367  Vali Loss: 0.0753955 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 78 cost time: 6.016694068908691
VALI: Epoch: 78, Steps: 68 | Train Loss: 0.0500786  Vali Loss: 0.0753973 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 6.030517339706421
VALI: Epoch: 79, Steps: 68 | Train Loss: 0.0518072  Vali Loss: 0.0753963 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 6.025926351547241
VALI: Epoch: 80, Steps: 68 | Train Loss: 0.0506464  Vali Loss: 0.0753858 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 6.007390260696411
VALI: Epoch: 81, Steps: 68 | Train Loss: 0.0506756  Vali Loss: 0.0753860 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 6.0104546546936035
VALI: Epoch: 82, Steps: 68 | Train Loss: 0.0488709  Vali Loss: 0.0753949 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741983  Vali macro F1 0.9640410 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9329381  Test weighted F1: 0.9334012  Test macro F1 0.8887762 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.017989635467529
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0514819  Vali Loss: 0.0812254 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9735934  Vali macro F1 0.9644867 
Validation loss decreased (inf --> 0.081225).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.007308006286621
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0527060  Vali Loss: 0.0738108 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756827  Vali macro F1 0.9657680 
new best score!!!!
Validation loss decreased (0.081225 --> 0.073811).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.016550779342651
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0508358  Vali Loss: 0.0771804 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9750594  Vali macro F1 0.9647827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.0122926235198975
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0512264  Vali Loss: 0.0745430 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741812  Vali macro F1 0.9637555 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.041420221328735
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0501315  Vali Loss: 0.0779165 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731128  Vali macro F1 0.9632054 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.041348457336426
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0484471  Vali Loss: 0.0732692 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757000  Vali macro F1 0.9655183 
new best score!!!!
Validation loss decreased (0.073811 --> 0.073269).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.044757604598999
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0513758  Vali Loss: 0.0741035 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9737287  Vali macro F1 0.9647325 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.037351846694946
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0503681  Vali Loss: 0.0812336 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9740314  Vali macro F1 0.9637171 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.021270751953125
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0497186  Vali Loss: 0.0716876 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9742783  Vali macro F1 0.9642066 
new best score!!!!
Validation loss decreased (0.073269 --> 0.071688).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.022566080093384
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0494749  Vali Loss: 0.0742283 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741973  Vali macro F1 0.9646724 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.025367259979248
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0489339  Vali Loss: 0.0788824 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741446  Vali macro F1 0.9645156 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.018611431121826
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0490077  Vali Loss: 0.0766717 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762295  Vali macro F1 0.9666837 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.010593891143799
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0490236  Vali Loss: 0.0807195 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9736289  Vali macro F1 0.9632076 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.0407960414886475
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0484812  Vali Loss: 0.0781293 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767074  Vali macro F1 0.9670183 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 6.03127646446228
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0493375  Vali Loss: 0.0754996 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772146  Vali macro F1 0.9669288 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.031886577606201
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0491571  Vali Loss: 0.0753585 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731979  Vali macro F1 0.9630126 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.015279531478882
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0500105  Vali Loss: 0.0744080 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731503  Vali macro F1 0.9625342 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.032256841659546
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0490210  Vali Loss: 0.0720762 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767470  Vali macro F1 0.9669613 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.019956350326538
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0482259  Vali Loss: 0.0703593 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757175  Vali macro F1 0.9661549 
new best score!!!!
Validation loss decreased (0.071688 --> 0.070359).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.027634143829346
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0488275  Vali Loss: 0.0703104 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9777571  Vali macro F1 0.9673273 
new best score!!!!
Validation loss decreased (0.070359 --> 0.070310).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.0166003704071045
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0474154  Vali Loss: 0.0780597 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9717395  Vali macro F1 0.9616079 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.02143669128418
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0463200  Vali Loss: 0.0711948 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9778025  Vali macro F1 0.9677149 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.025385856628418
Fine Tuning VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0473296  Vali Loss: 0.0706201 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9768351  Vali macro F1 0.9667844 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.019810199737549
Fine Tuning VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0450095  Vali Loss: 0.0758127 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751524  Vali macro F1 0.9645951 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.010656118392944
Fine Tuning VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0466390  Vali Loss: 0.0714092 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9761591  Vali macro F1 0.9661212 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 6.020017385482788
Fine Tuning VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0464751  Vali Loss: 0.0700055 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757190  Vali macro F1 0.9657962 
new best score!!!!
Validation loss decreased (0.070310 --> 0.070005).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.025087594985962
Fine Tuning VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0445484  Vali Loss: 0.0706920 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9752027  Vali macro F1 0.9649814 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.024680137634277
Fine Tuning VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0450130  Vali Loss: 0.0702837 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767997  Vali macro F1 0.9666799 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.010460615158081
Fine Tuning VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0462753  Vali Loss: 0.0704792 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762651  Vali macro F1 0.9661620 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.01594352722168
Fine Tuning VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0448627  Vali Loss: 0.0697068 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9768142  Vali macro F1 0.9670107 
new best score!!!!
Validation loss decreased (0.070005 --> 0.069707).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.024561882019043
Fine Tuning VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0438756  Vali Loss: 0.0703842 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767997  Vali macro F1 0.9666799 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.01601767539978
Fine Tuning VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0446177  Vali Loss: 0.0716718 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9742020  Vali macro F1 0.9640182 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.032644987106323
Fine Tuning VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0453010  Vali Loss: 0.0703203 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757501  Vali macro F1 0.9659055 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.009482383728027
Fine Tuning VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0454629  Vali Loss: 0.0702380 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9773150  Vali macro F1 0.9674932 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.001036643981934
Fine Tuning VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0460345  Vali Loss: 0.0702796 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 36 cost time: 6.0247461795806885
Fine Tuning VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0461027  Vali Loss: 0.0703480 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.006532430648804
Fine Tuning VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0454412  Vali Loss: 0.0704230 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.005140066146851
Fine Tuning VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0449864  Vali Loss: 0.0704548 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.01265549659729
Fine Tuning VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0450331  Vali Loss: 0.0703749 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.018630027770996
Fine Tuning VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0426366  Vali Loss: 0.0704467 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 41 cost time: 6.032439708709717
Fine Tuning VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0437551  Vali Loss: 0.0704537 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 6.016454696655273
Fine Tuning VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0446842  Vali Loss: 0.0704554 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 6.025144100189209
Fine Tuning VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0450311  Vali Loss: 0.0704630 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 6.156329870223999
Fine Tuning VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0440845  Vali Loss: 0.0704566 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 6.025122404098511
Fine Tuning VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0437983  Vali Loss: 0.0704463 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762509  Vali macro F1 0.9663879 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9374038  Test weighted F1: 0.9381698  Test macro F1 0.8959693 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.0001478  0.00018292 0.00097371 0.00126422 0.00049579 0.00061881]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.1371049880981445
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.3821885  Vali Loss: 0.9037516 Vali Accuracy: 0.6697201  Vali weighted F1: 0.5587328  Vali macro F1 0.2734629 
Validation loss decreased (inf --> 0.903752).  Saving model ...
Epoch: 2 cost time: 6.124274492263794
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.7785139  Vali Loss: 0.6887572 Vali Accuracy: 0.7684478  Vali weighted F1: 0.7089253  Vali macro F1 0.4952789 
new best score!!!!
Validation loss decreased (0.903752 --> 0.688757).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.140860319137573
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6000631  Vali Loss: 0.5375458 Vali Accuracy: 0.8086514  Vali weighted F1: 0.7739595  Vali macro F1 0.6876859 
new best score!!!!
Validation loss decreased (0.688757 --> 0.537546).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.1467108726501465
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4876385  Vali Loss: 0.4427826 Vali Accuracy: 0.8463104  Vali weighted F1: 0.8058106  Vali macro F1 0.7357366 
new best score!!!!
Validation loss decreased (0.537546 --> 0.442783).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.144155263900757
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4233011  Vali Loss: 0.4055772 Vali Accuracy: 0.8569975  Vali weighted F1: 0.8233192  Vali macro F1 0.7557899 
new best score!!!!
Validation loss decreased (0.442783 --> 0.405577).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.129486560821533
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3805999  Vali Loss: 0.3725134 Vali Accuracy: 0.8783715  Vali weighted F1: 0.8609467  Vali macro F1 0.8121135 
new best score!!!!
Validation loss decreased (0.405577 --> 0.372513).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.130488157272339
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3449447  Vali Loss: 0.3482266 Vali Accuracy: 0.8839695  Vali weighted F1: 0.8697401  Vali macro F1 0.8238877 
new best score!!!!
Validation loss decreased (0.372513 --> 0.348227).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.124395847320557
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.3153210  Vali Loss: 0.3877079 Vali Accuracy: 0.8727735  Vali weighted F1: 0.8573533  Vali macro F1 0.8111936 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.125094175338745
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2918185  Vali Loss: 0.3185146 Vali Accuracy: 0.8916031  Vali weighted F1: 0.8841329  Vali macro F1 0.8459063 
new best score!!!!
Validation loss decreased (0.348227 --> 0.318515).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.134341716766357
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2663447  Vali Loss: 0.2572328 Vali Accuracy: 0.9099237  Vali weighted F1: 0.9073762  Vali macro F1 0.8720032 
new best score!!!!
Validation loss decreased (0.318515 --> 0.257233).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.129254102706909
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2443697  Vali Loss: 0.2280235 Vali Accuracy: 0.9246819  Vali weighted F1: 0.9244249  Vali macro F1 0.8921807 
new best score!!!!
Validation loss decreased (0.257233 --> 0.228023).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.14073371887207
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.2232521  Vali Loss: 0.2131214 Vali Accuracy: 0.9282443  Vali weighted F1: 0.9270003  Vali macro F1 0.8962275 
new best score!!!!
Validation loss decreased (0.228023 --> 0.213121).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.150714159011841
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.2073342  Vali Loss: 0.2109934 Vali Accuracy: 0.9272265  Vali weighted F1: 0.9256616  Vali macro F1 0.8964092 
new best score!!!!
Validation loss decreased (0.213121 --> 0.210993).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1409454345703125
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.2056827  Vali Loss: 0.2084504 Vali Accuracy: 0.9287532  Vali weighted F1: 0.9297207  Vali macro F1 0.8996156 
new best score!!!!
Validation loss decreased (0.210993 --> 0.208450).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.124678373336792
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.2027611  Vali Loss: 0.2054790 Vali Accuracy: 0.9302799  Vali weighted F1: 0.9296832  Vali macro F1 0.9000155 
new best score!!!!
Validation loss decreased (0.208450 --> 0.205479).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.133471727371216
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1876000  Vali Loss: 0.1901521 Vali Accuracy: 0.9379135  Vali weighted F1: 0.9387164  Vali macro F1 0.9115819 
new best score!!!!
Validation loss decreased (0.205479 --> 0.190152).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.132420063018799
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1798182  Vali Loss: 0.1747595 Vali Accuracy: 0.9435115  Vali weighted F1: 0.9432335  Vali macro F1 0.9171454 
new best score!!!!
Validation loss decreased (0.190152 --> 0.174760).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.130891561508179
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1736912  Vali Loss: 0.1989095 Vali Accuracy: 0.9363868  Vali weighted F1: 0.9348245  Vali macro F1 0.9087169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.1249988079071045
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1648442  Vali Loss: 0.1966148 Vali Accuracy: 0.9328244  Vali weighted F1: 0.9335766  Vali macro F1 0.9036169 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.122759819030762
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1734972  Vali Loss: 0.1815217 Vali Accuracy: 0.9404580  Vali weighted F1: 0.9394156  Vali macro F1 0.9128234 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.134345531463623
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1501424  Vali Loss: 0.1595664 Vali Accuracy: 0.9450382  Vali weighted F1: 0.9452970  Vali macro F1 0.9199418 
new best score!!!!
Validation loss decreased (0.174760 --> 0.159566).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.158543109893799
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1523500  Vali Loss: 0.1683440 Vali Accuracy: 0.9440204  Vali weighted F1: 0.9438852  Vali macro F1 0.9171915 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.140494108200073
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1552770  Vali Loss: 0.1964836 Vali Accuracy: 0.9363868  Vali weighted F1: 0.9342366  Vali macro F1 0.9051322 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.138558387756348
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1450375  Vali Loss: 0.2008471 Vali Accuracy: 0.9328244  Vali weighted F1: 0.9306878  Vali macro F1 0.9049660 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.1324098110198975
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1525265  Vali Loss: 0.1571117 Vali Accuracy: 0.9450382  Vali weighted F1: 0.9451814  Vali macro F1 0.9219462 
new best score!!!!
Validation loss decreased (0.159566 --> 0.157112).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.138087511062622
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1440512  Vali Loss: 0.1512061 Vali Accuracy: 0.9491094  Vali weighted F1: 0.9493951  Vali macro F1 0.9276088 
new best score!!!!
Validation loss decreased (0.157112 --> 0.151206).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.1327879428863525
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1325578  Vali Loss: 0.1404154 Vali Accuracy: 0.9491094  Vali weighted F1: 0.9493776  Vali macro F1 0.9249467 
new best score!!!!
Validation loss decreased (0.151206 --> 0.140415).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.140487194061279
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1326312  Vali Loss: 0.1404954 Vali Accuracy: 0.9496183  Vali weighted F1: 0.9496857  Vali macro F1 0.9262992 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.119777679443359
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1309481  Vali Loss: 0.1410992 Vali Accuracy: 0.9526718  Vali weighted F1: 0.9525020  Vali macro F1 0.9317387 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.14635157585144
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1292696  Vali Loss: 0.1445708 Vali Accuracy: 0.9501272  Vali weighted F1: 0.9500988  Vali macro F1 0.9290462 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.14398980140686
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1238258  Vali Loss: 0.1401744 Vali Accuracy: 0.9562341  Vali weighted F1: 0.9566520  Vali macro F1 0.9380896 
new best score!!!!
Validation loss decreased (0.140415 --> 0.140174).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.14393949508667
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1354511  Vali Loss: 0.1408619 Vali Accuracy: 0.9506361  Vali weighted F1: 0.9498869  Vali macro F1 0.9332944 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.140719652175903
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.1180951  Vali Loss: 0.1235565 Vali Accuracy: 0.9547074  Vali weighted F1: 0.9547714  Vali macro F1 0.9328925 
new best score!!!!
Validation loss decreased (0.140174 --> 0.123556).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.133175373077393
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.1145083  Vali Loss: 0.1300306 Vali Accuracy: 0.9531807  Vali weighted F1: 0.9531276  Vali macro F1 0.9314586 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.125927209854126
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.1158211  Vali Loss: 0.1202787 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9571495  Vali macro F1 0.9391962 
new best score!!!!
Validation loss decreased (0.123556 --> 0.120279).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.13132905960083
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.1147718  Vali Loss: 0.1141298 Vali Accuracy: 0.9577608  Vali weighted F1: 0.9578151  Vali macro F1 0.9407690 
new best score!!!!
Validation loss decreased (0.120279 --> 0.114130).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.138068199157715
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.1023603  Vali Loss: 0.1122289 Vali Accuracy: 0.9592875  Vali weighted F1: 0.9591756  Vali macro F1 0.9394201 
new best score!!!!
Validation loss decreased (0.114130 --> 0.112229).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.132352590560913
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.1024057  Vali Loss: 0.1228020 Vali Accuracy: 0.9562341  Vali weighted F1: 0.9556673  Vali macro F1 0.9382405 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.142874717712402
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0973150  Vali Loss: 0.1129157 Vali Accuracy: 0.9608142  Vali weighted F1: 0.9607019  Vali macro F1 0.9426997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.151264905929565
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0960632  Vali Loss: 0.1491507 Vali Accuracy: 0.9506361  Vali weighted F1: 0.9497138  Vali macro F1 0.9285372 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.139423131942749
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0939036  Vali Loss: 0.1084206 Vali Accuracy: 0.9608142  Vali weighted F1: 0.9610147  Vali macro F1 0.9428667 
new best score!!!!
Validation loss decreased (0.112229 --> 0.108421).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.132825613021851
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.1008727  Vali Loss: 0.1246824 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9608814  Vali macro F1 0.9458931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.122235536575317
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.1002172  Vali Loss: 0.1088476 Vali Accuracy: 0.9643766  Vali weighted F1: 0.9645262  Vali macro F1 0.9493868 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.130443572998047
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0915441  Vali Loss: 0.3564029 Vali Accuracy: 0.8707379  Vali weighted F1: 0.8746624  Vali macro F1 0.8339823 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.136204719543457
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.1049394  Vali Loss: 0.1435195 Vali Accuracy: 0.9562341  Vali weighted F1: 0.9555292  Vali macro F1 0.9397803 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.1350626945495605
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0918381  Vali Loss: 0.1171481 Vali Accuracy: 0.9608142  Vali weighted F1: 0.9609616  Vali macro F1 0.9465103 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 6.1304285526275635
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0795961  Vali Loss: 0.1021789 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9640455  Vali macro F1 0.9484411 
new best score!!!!
Validation loss decreased (0.108421 --> 0.102179).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.149048566818237
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0749255  Vali Loss: 0.1033260 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9650804  Vali macro F1 0.9508322 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.1507110595703125
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0715416  Vali Loss: 0.0996548 Vali Accuracy: 0.9653944  Vali weighted F1: 0.9656304  Vali macro F1 0.9511274 
new best score!!!!
Validation loss decreased (0.102179 --> 0.099655).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.1486499309539795
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0703654  Vali Loss: 0.1035324 Vali Accuracy: 0.9643766  Vali weighted F1: 0.9646354  Vali macro F1 0.9510150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.12548041343689
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0720282  Vali Loss: 0.0996412 Vali Accuracy: 0.9659033  Vali weighted F1: 0.9661021  Vali macro F1 0.9522285 
new best score!!!!
Validation loss decreased (0.099655 --> 0.099641).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.140684127807617
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0725692  Vali Loss: 0.0992697 Vali Accuracy: 0.9653944  Vali weighted F1: 0.9656012  Vali macro F1 0.9514024 
new best score!!!!
Validation loss decreased (0.099641 --> 0.099270).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.1377527713775635
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0710160  Vali Loss: 0.0956934 Vali Accuracy: 0.9659033  Vali weighted F1: 0.9660832  Vali macro F1 0.9525823 
new best score!!!!
Validation loss decreased (0.099270 --> 0.095693).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.130785942077637
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0695363  Vali Loss: 0.0965127 Vali Accuracy: 0.9669211  Vali weighted F1: 0.9671395  Vali macro F1 0.9530720 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.123336315155029
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0695011  Vali Loss: 0.0993402 Vali Accuracy: 0.9653944  Vali weighted F1: 0.9656552  Vali macro F1 0.9529298 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.115245819091797
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0706181  Vali Loss: 0.0959047 Vali Accuracy: 0.9669211  Vali weighted F1: 0.9670924  Vali macro F1 0.9535603 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.122483491897583
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0675289  Vali Loss: 0.0980119 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675797  Vali macro F1 0.9557969 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.13966965675354
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0681179  Vali Loss: 0.0989772 Vali Accuracy: 0.9669211  Vali weighted F1: 0.9672026  Vali macro F1 0.9565842 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 59 cost time: 6.140656471252441
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0696759  Vali Loss: 0.0957208 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.12901496887207
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0712547  Vali Loss: 0.0956014 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675802  Vali macro F1 0.9554405 
new best score!!!!
Validation loss decreased (0.095693 --> 0.095601).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.135336875915527
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0668801  Vali Loss: 0.0960144 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9676069  Vali macro F1 0.9566127 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.127284526824951
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0672729  Vali Loss: 0.0958727 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9676069  Vali macro F1 0.9566127 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.130108118057251
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0688409  Vali Loss: 0.0953235 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
new best score!!!!
Validation loss decreased (0.095601 --> 0.095324).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 6.130689859390259
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0696326  Vali Loss: 0.0960632 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675802  Vali macro F1 0.9554405 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 6.127096176147461
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0673275  Vali Loss: 0.0960347 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675802  Vali macro F1 0.9554405 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 6.137587070465088
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0676351  Vali Loss: 0.0964478 Vali Accuracy: 0.9664122  Vali weighted F1: 0.9666243  Vali macro F1 0.9553085 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 6.138793706893921
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0679339  Vali Loss: 0.0964739 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9676030  Vali macro F1 0.9565600 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 6.136321544647217
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0682383  Vali Loss: 0.0961904 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675569  Vali macro F1 0.9565004 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 69 cost time: 6.133553743362427
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0695091  Vali Loss: 0.0961883 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675569  Vali macro F1 0.9565004 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.12919807434082
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0671055  Vali Loss: 0.0964075 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675800  Vali macro F1 0.9568454 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.127476215362549
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0669056  Vali Loss: 0.0963535 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680653  Vali macro F1 0.9573288 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.128918647766113
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0662700  Vali Loss: 0.0962533 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.138070583343506
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0688651  Vali Loss: 0.0961362 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 74 cost time: 6.137316942214966
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0671782  Vali Loss: 0.0961395 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 6.127691268920898
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0669726  Vali Loss: 0.0961562 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 6.152158260345459
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0685155  Vali Loss: 0.0961533 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 7.5465087890625
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0702223  Vali Loss: 0.0961453 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 6.14209246635437
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0673810  Vali Loss: 0.0961549 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680882  Vali macro F1 0.9570434 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8994979  Test weighted F1: 0.9042642  Test macro F1 0.8769936 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.418207406997681
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0693439  Vali Loss: 0.0963527 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9681911  Vali macro F1 0.9570090 
Validation loss decreased (inf --> 0.096353).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.124945878982544
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0709172  Vali Loss: 0.0977577 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9674740  Vali macro F1 0.9556735 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.11704421043396
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0681397  Vali Loss: 0.0974458 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9682028  Vali macro F1 0.9559394 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.120303392410278
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0690197  Vali Loss: 0.0946020 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9701033  Vali macro F1 0.9593367 
new best score!!!!
Validation loss decreased (0.096353 --> 0.094602).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.147824287414551
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0699296  Vali Loss: 0.0950021 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9681548  Vali macro F1 0.9564276 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.134345293045044
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0697752  Vali Loss: 0.0944415 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9686578  Vali macro F1 0.9572564 
new best score!!!!
Validation loss decreased (0.094602 --> 0.094441).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.1562042236328125
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0671510  Vali Loss: 0.0962427 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9682132  Vali macro F1 0.9579003 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.159950017929077
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0666955  Vali Loss: 0.0901003 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9686481  Vali macro F1 0.9582398 
new best score!!!!
Validation loss decreased (0.094441 --> 0.090100).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.136156797409058
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0651268  Vali Loss: 0.0914864 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9707388  Vali macro F1 0.9601522 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.124528169631958
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0649860  Vali Loss: 0.0938162 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691601  Vali macro F1 0.9584831 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.133078575134277
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0670621  Vali Loss: 0.0943055 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691674  Vali macro F1 0.9572011 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.128599166870117
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0708084  Vali Loss: 0.0952143 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697293  Vali macro F1 0.9588751 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.145101070404053
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0724754  Vali Loss: 0.0895176 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9696965  Vali macro F1 0.9582677 
new best score!!!!
Validation loss decreased (0.090100 --> 0.089518).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.143375396728516
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0657592  Vali Loss: 0.0933691 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9679969  Vali macro F1 0.9575083 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.1354334354400635
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0685374  Vali Loss: 0.0977722 Vali Accuracy: 0.9669211  Vali weighted F1: 0.9670356  Vali macro F1 0.9544344 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.15282130241394
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0662195  Vali Loss: 0.0942748 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691048  Vali macro F1 0.9568412 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.134553670883179
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0629880  Vali Loss: 0.0930098 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9711898  Vali macro F1 0.9606038 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.142786264419556
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0628544  Vali Loss: 0.0910519 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9702196  Vali macro F1 0.9582230 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 6.137916803359985
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0619695  Vali Loss: 0.0882494 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9706350  Vali macro F1 0.9594432 
new best score!!!!
Validation loss decreased (0.089518 --> 0.088249).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.138872385025024
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0615771  Vali Loss: 0.0869329 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9706570  Vali macro F1 0.9598419 
new best score!!!!
Validation loss decreased (0.088249 --> 0.086933).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.130797624588013
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0627302  Vali Loss: 0.0908220 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9696238  Vali macro F1 0.9573902 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.135603666305542
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0629361  Vali Loss: 0.0928069 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9702371  Vali macro F1 0.9569965 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.12418270111084
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0621837  Vali Loss: 0.0903178 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9705955  Vali macro F1 0.9601927 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.13426947593689
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0626030  Vali Loss: 0.0882895 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9702172  Vali macro F1 0.9587876 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.155930042266846
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0595955  Vali Loss: 0.0916279 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9701771  Vali macro F1 0.9568774 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 6.142780065536499
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0589652  Vali Loss: 0.0911652 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691541  Vali macro F1 0.9554587 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.142349720001221
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0600876  Vali Loss: 0.0906570 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9701823  Vali macro F1 0.9568762 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.13106369972229
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0608925  Vali Loss: 0.0904183 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9706695  Vali macro F1 0.9573905 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.132216215133667
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0614779  Vali Loss: 0.0903324 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9696970  Vali macro F1 0.9563915 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.134058952331543
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0574921  Vali Loss: 0.0898226 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691774  Vali macro F1 0.9565752 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 6.119140148162842
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0628097  Vali Loss: 0.0898002 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691774  Vali macro F1 0.9565752 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.135476112365723
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0623582  Vali Loss: 0.0899157 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691774  Vali macro F1 0.9565752 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.124527215957642
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0613082  Vali Loss: 0.0896928 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9696616  Vali macro F1 0.9570584 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.1408586502075195
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0611717  Vali Loss: 0.0898005 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9696616  Vali macro F1 0.9570584 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.1137964725494385
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0598893  Vali Loss: 0.0897259 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9701635  Vali macro F1 0.9578862 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8788775  Test weighted F1: 0.8867286  Test macro F1 0.8645043 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014943 0.00018335 0.00100705 0.00123609 0.00051813 0.00062696]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.068866491317749
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.3884682  Vali Loss: 0.8747081 Vali Accuracy: 0.6858908  Vali weighted F1: 0.5786643  Vali macro F1 0.2783082 
Validation loss decreased (inf --> 0.874708).  Saving model ...
Epoch: 2 cost time: 6.0211262702941895
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.8089099  Vali Loss: 0.6992282 Vali Accuracy: 0.7590113  Vali weighted F1: 0.6709055  Vali macro F1 0.4333436 
new best score!!!!
Validation loss decreased (0.874708 --> 0.699228).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.015423774719238
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.6556066  Vali Loss: 0.5827007 Vali Accuracy: 0.7816684  Vali weighted F1: 0.7170165  Vali macro F1 0.4948552 
new best score!!!!
Validation loss decreased (0.699228 --> 0.582701).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.01048731803894
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.5683770  Vali Loss: 0.5004897 Vali Accuracy: 0.8249228  Vali weighted F1: 0.7824313  Vali macro F1 0.6973267 
new best score!!!!
Validation loss decreased (0.582701 --> 0.500490).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.023993015289307
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.4870895  Vali Loss: 0.4563858 Vali Accuracy: 0.8357364  Vali weighted F1: 0.7972691  Vali macro F1 0.7186661 
new best score!!!!
Validation loss decreased (0.500490 --> 0.456386).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.011909246444702
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.4333252  Vali Loss: 0.3762426 Vali Accuracy: 0.8702369  Vali weighted F1: 0.8476354  Vali macro F1 0.7841320 
new best score!!!!
Validation loss decreased (0.456386 --> 0.376243).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.015333890914917
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.3773589  Vali Loss: 0.3394572 Vali Accuracy: 0.8877446  Vali weighted F1: 0.8764131  Vali macro F1 0.8265325 
new best score!!!!
Validation loss decreased (0.376243 --> 0.339457).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.005366802215576
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.3303917  Vali Loss: 0.3385599 Vali Accuracy: 0.8892894  Vali weighted F1: 0.8772435  Vali macro F1 0.8279169 
new best score!!!!
Validation loss decreased (0.339457 --> 0.338560).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.0417640209198
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.2598016  Vali Loss: 0.2302384 Vali Accuracy: 0.9279094  Vali weighted F1: 0.9259092  Vali macro F1 0.8857816 
new best score!!!!
Validation loss decreased (0.338560 --> 0.230238).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.035144329071045
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.2250026  Vali Loss: 0.1911457 Vali Accuracy: 0.9382080  Vali weighted F1: 0.9385990  Vali macro F1 0.9012357 
new best score!!!!
Validation loss decreased (0.230238 --> 0.191146).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.019511461257935
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.2084052  Vali Loss: 0.1858962 Vali Accuracy: 0.9387230  Vali weighted F1: 0.9394080  Vali macro F1 0.9037123 
new best score!!!!
Validation loss decreased (0.191146 --> 0.185896).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.011056423187256
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1966601  Vali Loss: 0.1763784 Vali Accuracy: 0.9418126  Vali weighted F1: 0.9412020  Vali macro F1 0.9064433 
new best score!!!!
Validation loss decreased (0.185896 --> 0.176378).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.023694753646851
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1854023  Vali Loss: 0.1732925 Vali Accuracy: 0.9443872  Vali weighted F1: 0.9437991  Vali macro F1 0.9097268 
new best score!!!!
Validation loss decreased (0.176378 --> 0.173293).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.012670040130615
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1720926  Vali Loss: 0.1613782 Vali Accuracy: 0.9469619  Vali weighted F1: 0.9471180  Vali macro F1 0.9138399 
new best score!!!!
Validation loss decreased (0.173293 --> 0.161378).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.021695137023926
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1670953  Vali Loss: 0.1673188 Vali Accuracy: 0.9433574  Vali weighted F1: 0.9440368  Vali macro F1 0.9088130 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.008120536804199
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1663287  Vali Loss: 0.1527349 Vali Accuracy: 0.9474768  Vali weighted F1: 0.9469375  Vali macro F1 0.9143789 
new best score!!!!
Validation loss decreased (0.161378 --> 0.152735).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.0204551219940186
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1645997  Vali Loss: 0.1407955 Vali Accuracy: 0.9515963  Vali weighted F1: 0.9514603  Vali macro F1 0.9209711 
new best score!!!!
Validation loss decreased (0.152735 --> 0.140796).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.032993316650391
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.1549433  Vali Loss: 0.2289043 Vali Accuracy: 0.9165808  Vali weighted F1: 0.9165874  Vali macro F1 0.8746314 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.007002115249634
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.1504142  Vali Loss: 0.1320516 Vali Accuracy: 0.9541710  Vali weighted F1: 0.9541604  Vali macro F1 0.9224417 
new best score!!!!
Validation loss decreased (0.140796 --> 0.132052).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.024931192398071
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.1377422  Vali Loss: 0.1310381 Vali Accuracy: 0.9526262  Vali weighted F1: 0.9529897  Vali macro F1 0.9203563 
new best score!!!!
Validation loss decreased (0.132052 --> 0.131038).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.0216968059539795
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.1419300  Vali Loss: 0.1414162 Vali Accuracy: 0.9521112  Vali weighted F1: 0.9526386  Vali macro F1 0.9229129 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.009610891342163
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.1340780  Vali Loss: 0.1245894 Vali Accuracy: 0.9562307  Vali weighted F1: 0.9564725  Vali macro F1 0.9250300 
new best score!!!!
Validation loss decreased (0.131038 --> 0.124589).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.010953426361084
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.1355401  Vali Loss: 0.1338593 Vali Accuracy: 0.9531411  Vali weighted F1: 0.9525958  Vali macro F1 0.9251068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.013619899749756
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.1480135  Vali Loss: 0.1231526 Vali Accuracy: 0.9521112  Vali weighted F1: 0.9521304  Vali macro F1 0.9213813 
new best score!!!!
Validation loss decreased (0.124589 --> 0.123153).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.017777919769287
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.1286312  Vali Loss: 0.1136578 Vali Accuracy: 0.9557158  Vali weighted F1: 0.9556792  Vali macro F1 0.9258769 
new best score!!!!
Validation loss decreased (0.123153 --> 0.113658).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.031348705291748
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.1269347  Vali Loss: 0.1210117 Vali Accuracy: 0.9618950  Vali weighted F1: 0.9614973  Vali macro F1 0.9382697 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.0151379108428955
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.1215919  Vali Loss: 0.1215287 Vali Accuracy: 0.9562307  Vali weighted F1: 0.9565130  Vali macro F1 0.9281583 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.038235425949097
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.1260929  Vali Loss: 0.1125943 Vali Accuracy: 0.9577755  Vali weighted F1: 0.9579627  Vali macro F1 0.9287053 
new best score!!!!
Validation loss decreased (0.113658 --> 0.112594).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.040839433670044
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.1161568  Vali Loss: 0.1131696 Vali Accuracy: 0.9582904  Vali weighted F1: 0.9584904  Vali macro F1 0.9301460 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.022156000137329
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.1149277  Vali Loss: 0.1034992 Vali Accuracy: 0.9624099  Vali weighted F1: 0.9627612  Vali macro F1 0.9396148 
new best score!!!!
Validation loss decreased (0.112594 --> 0.103499).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.0280890464782715
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.1115671  Vali Loss: 0.0990705 Vali Accuracy: 0.9660144  Vali weighted F1: 0.9661364  Vali macro F1 0.9428037 
new best score!!!!
Validation loss decreased (0.103499 --> 0.099071).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.016816854476929
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.1047912  Vali Loss: 0.1077416 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9634261  Vali macro F1 0.9423954 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.0196778774261475
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.1091557  Vali Loss: 0.1005682 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9637641  Vali macro F1 0.9400406 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.030715703964233
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0994009  Vali Loss: 0.0992699 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9611761  Vali macro F1 0.9335220 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.008281707763672
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.1036820  Vali Loss: 0.1050682 Vali Accuracy: 0.9618950  Vali weighted F1: 0.9618880  Vali macro F1 0.9429623 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.025073289871216
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0993680  Vali Loss: 0.0979882 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9686487  Vali macro F1 0.9538196 
new best score!!!!
Validation loss decreased (0.099071 --> 0.097988).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.044127702713013
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0999990  Vali Loss: 0.0890729 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9666519  Vali macro F1 0.9424719 
new best score!!!!
Validation loss decreased (0.097988 --> 0.089073).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.009795665740967
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0950466  Vali Loss: 0.0913140 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9687355  Vali macro F1 0.9503766 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.028177738189697
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0935238  Vali Loss: 0.1113632 Vali Accuracy: 0.9613800  Vali weighted F1: 0.9620041  Vali macro F1 0.9381195 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.012807607650757
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0933555  Vali Loss: 0.0915863 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9667997  Vali macro F1 0.9477187 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.010602712631226
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0897025  Vali Loss: 0.1188548 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9666986  Vali macro F1 0.9523424 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.003145933151245
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0961379  Vali Loss: 0.0984101 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9669070  Vali macro F1 0.9463281 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 43 cost time: 6.0068395137786865
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0812412  Vali Loss: 0.0868170 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9693906  Vali macro F1 0.9519956 
new best score!!!!
Validation loss decreased (0.089073 --> 0.086817).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.01041579246521
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0768110  Vali Loss: 0.0856754 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724214  Vali macro F1 0.9585613 
new best score!!!!
Validation loss decreased (0.086817 --> 0.085675).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.0137293338775635
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0742494  Vali Loss: 0.0873082 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9704139  Vali macro F1 0.9535262 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.0087504386901855
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0742734  Vali Loss: 0.0846585 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724268  Vali macro F1 0.9586353 
new best score!!!!
Validation loss decreased (0.085675 --> 0.084658).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.028803825378418
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0764192  Vali Loss: 0.0874292 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9709010  Vali macro F1 0.9540250 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.020614385604858
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0746158  Vali Loss: 0.0848268 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9704018  Vali macro F1 0.9532774 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.00612473487854
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0738136  Vali Loss: 0.0834929 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724416  Vali macro F1 0.9573201 
new best score!!!!
Validation loss decreased (0.084658 --> 0.083493).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.016233444213867
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0744248  Vali Loss: 0.0880520 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719581  Vali macro F1 0.9561805 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.014350414276123
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0733722  Vali Loss: 0.0853260 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724696  Vali macro F1 0.9580693 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.015494108200073
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0720675  Vali Loss: 0.0880286 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719581  Vali macro F1 0.9561805 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.013707637786865
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0732939  Vali Loss: 0.0868864 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9694213  Vali macro F1 0.9482903 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.015200853347778
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0729453  Vali Loss: 0.0880652 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9720207  Vali macro F1 0.9590125 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 55 cost time: 6.011010408401489
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0697972  Vali Loss: 0.0852419 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9730078  Vali macro F1 0.9590591 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.036769390106201
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0723547  Vali Loss: 0.0863023 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724994  Vali macro F1 0.9584620 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.027669191360474
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0724953  Vali Loss: 0.0861843 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719899  Vali macro F1 0.9576179 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.039195775985718
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0709652  Vali Loss: 0.0858839 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719899  Vali macro F1 0.9576179 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.010706663131714
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0714202  Vali Loss: 0.0862482 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724773  Vali macro F1 0.9581172 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 60 cost time: 6.012863397598267
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0702804  Vali Loss: 0.0863087 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724773  Vali macro F1 0.9581172 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.027429580688477
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0724016  Vali Loss: 0.0861950 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724773  Vali macro F1 0.9581172 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.012454986572266
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0705227  Vali Loss: 0.0863775 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724773  Vali macro F1 0.9581172 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.0112433433532715
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0702736  Vali Loss: 0.0864341 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724773  Vali macro F1 0.9581172 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.012355804443359
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0726510  Vali Loss: 0.0863448 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724773  Vali macro F1 0.9581172 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9710086  Test weighted F1: 0.9703788  Test macro F1 0.9589019 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.084179639816284
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0728551  Vali Loss: 0.0842176 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724148  Vali macro F1 0.9597222 
Validation loss decreased (inf --> 0.084218).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.036694049835205
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0731395  Vali Loss: 0.0890626 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9704590  Vali macro F1 0.9556533 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.044576644897461
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0721674  Vali Loss: 0.0856847 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9729798  Vali macro F1 0.9613784 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.028722763061523
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0726830  Vali Loss: 0.0866993 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9729661  Vali macro F1 0.9602739 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.054190635681152
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0727835  Vali Loss: 0.0808198 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9734743  Vali macro F1 0.9611534 
new best score!!!!
Validation loss decreased (0.084218 --> 0.080820).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.037256717681885
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0716231  Vali Loss: 0.0842880 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9699127  Vali macro F1 0.9511510 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.034014463424683
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0704767  Vali Loss: 0.0825993 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9714452  Vali macro F1 0.9547099 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.030036687850952
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0721719  Vali Loss: 0.0977639 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9684983  Vali macro F1 0.9533113 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.0343711376190186
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0739843  Vali Loss: 0.0867424 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9699083  Vali macro F1 0.9515247 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.034977436065674
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0724133  Vali Loss: 0.0879585 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9725018  Vali macro F1 0.9587408 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.050262451171875
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0682789  Vali Loss: 0.0867388 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9714685  Vali macro F1 0.9567144 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.036194562911987
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0683580  Vali Loss: 0.0875709 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9709752  Vali macro F1 0.9548958 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.041379690170288
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0715266  Vali Loss: 0.0931507 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9690032  Vali macro F1 0.9515317 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.0389320850372314
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0708715  Vali Loss: 0.0824251 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724869  Vali macro F1 0.9571574 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.03787088394165
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0697779  Vali Loss: 0.0795099 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9739020  Vali macro F1 0.9598802 
new best score!!!!
Validation loss decreased (0.080820 --> 0.079510).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.03635048866272
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0688041  Vali Loss: 0.0981498 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9670384  Vali macro F1 0.9508587 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.046855449676514
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0700417  Vali Loss: 0.0822033 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719771  Vali macro F1 0.9586132 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.061510324478149
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0662080  Vali Loss: 0.0890963 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9714683  Vali macro F1 0.9556387 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.04922890663147
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0675133  Vali Loss: 0.0857338 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9725101  Vali macro F1 0.9605644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.056195020675659
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0671600  Vali Loss: 0.0848084 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9729824  Vali macro F1 0.9599683 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.057600021362305
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0673289  Vali Loss: 0.0850010 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9729889  Vali macro F1 0.9600066 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.041760206222534
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0662579  Vali Loss: 0.0845129 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9729889  Vali macro F1 0.9600066 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.036895990371704
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0662958  Vali Loss: 0.0848401 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724773  Vali macro F1 0.9581172 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.041574001312256
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0658282  Vali Loss: 0.0845891 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724773  Vali macro F1 0.9581172 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.048684120178223
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0663716  Vali Loss: 0.0858466 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719899  Vali macro F1 0.9576179 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.055809497833252
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0677548  Vali Loss: 0.0862168 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719899  Vali macro F1 0.9576179 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.038142442703247
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0654655  Vali Loss: 0.0857418 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719846  Vali macro F1 0.9576043 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.042090177536011
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0666228  Vali Loss: 0.0853971 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719846  Vali macro F1 0.9576043 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.033491134643555
Fine Tuning VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0665224  Vali Loss: 0.0852041 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719846  Vali macro F1 0.9576043 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.053645133972168
Fine Tuning VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0653882  Vali Loss: 0.0851238 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719846  Vali macro F1 0.9576043 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9719831  Test weighted F1: 0.9711694  Test macro F1 0.9596830 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014941 0.00018685 0.00139276 0.00148368 0.00052743 0.00064599]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.909060001373291
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.3813513  Vali Loss: 0.8982044 Vali Accuracy: 0.6801706  Vali weighted F1: 0.5719745  Vali macro F1 0.2754280 
Validation loss decreased (inf --> 0.898204).  Saving model ...
Epoch: 2 cost time: 5.852988243103027
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.7747622  Vali Loss: 0.6981971 Vali Accuracy: 0.7094883  Vali weighted F1: 0.6201842  Vali macro F1 0.3254940 
new best score!!!!
Validation loss decreased (0.898204 --> 0.698197).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.832777261734009
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.6416713  Vali Loss: 0.5804330 Vali Accuracy: 0.7803838  Vali weighted F1: 0.7197848  Vali macro F1 0.4966971 
new best score!!!!
Validation loss decreased (0.698197 --> 0.580433).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.8355371952056885
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.5413702  Vali Loss: 0.5234582 Vali Accuracy: 0.7862473  Vali weighted F1: 0.7369341  Vali macro F1 0.5208854 
new best score!!!!
Validation loss decreased (0.580433 --> 0.523458).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.850829124450684
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.4752205  Vali Loss: 0.4744498 Vali Accuracy: 0.8043710  Vali weighted F1: 0.7675245  Vali macro F1 0.5667910 
new best score!!!!
Validation loss decreased (0.523458 --> 0.474450).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.8427159786224365
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.3932037  Vali Loss: 0.3427516 Vali Accuracy: 0.8624733  Vali weighted F1: 0.8434684  Vali macro F1 0.6616093 
new best score!!!!
Validation loss decreased (0.474450 --> 0.342752).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.839712381362915
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.3347726  Vali Loss: 0.3119722 Vali Accuracy: 0.8885928  Vali weighted F1: 0.8810643  Vali macro F1 0.7663693 
new best score!!!!
Validation loss decreased (0.342752 --> 0.311972).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.834013223648071
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.3023012  Vali Loss: 0.2774151 Vali Accuracy: 0.9045842  Vali weighted F1: 0.9023135  Vali macro F1 0.8226461 
new best score!!!!
Validation loss decreased (0.311972 --> 0.277415).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.8369245529174805
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.2668565  Vali Loss: 0.2464625 Vali Accuracy: 0.9296375  Vali weighted F1: 0.9283842  Vali macro F1 0.8994618 
new best score!!!!
Validation loss decreased (0.277415 --> 0.246462).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.853590488433838
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.2404211  Vali Loss: 0.2140075 Vali Accuracy: 0.9339019  Vali weighted F1: 0.9334718  Vali macro F1 0.9129560 
new best score!!!!
Validation loss decreased (0.246462 --> 0.214007).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.850208759307861
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.2112109  Vali Loss: 0.1851852 Vali Accuracy: 0.9424307  Vali weighted F1: 0.9411675  Vali macro F1 0.9227846 
new best score!!!!
Validation loss decreased (0.214007 --> 0.185185).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.84763765335083
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1955703  Vali Loss: 0.1990879 Vali Accuracy: 0.9323028  Vali weighted F1: 0.9295593  Vali macro F1 0.9068461 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.826196670532227
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1864115  Vali Loss: 0.1610140 Vali Accuracy: 0.9472281  Vali weighted F1: 0.9465754  Vali macro F1 0.9292427 
new best score!!!!
Validation loss decreased (0.185185 --> 0.161014).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.824678182601929
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1752487  Vali Loss: 0.1586429 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9468538  Vali macro F1 0.9306329 
new best score!!!!
Validation loss decreased (0.161014 --> 0.158643).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.828171968460083
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1742156  Vali Loss: 0.1574642 Vali Accuracy: 0.9466951  Vali weighted F1: 0.9463837  Vali macro F1 0.9282865 
new best score!!!!
Validation loss decreased (0.158643 --> 0.157464).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.828325510025024
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1621739  Vali Loss: 0.1831558 Vali Accuracy: 0.9392324  Vali weighted F1: 0.9394492  Vali macro F1 0.9196032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.829151153564453
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1642863  Vali Loss: 0.1458875 Vali Accuracy: 0.9488273  Vali weighted F1: 0.9485657  Vali macro F1 0.9312515 
new best score!!!!
Validation loss decreased (0.157464 --> 0.145888).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.823277711868286
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1649980  Vali Loss: 0.1564400 Vali Accuracy: 0.9504264  Vali weighted F1: 0.9500154  Vali macro F1 0.9332742 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.829913139343262
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.1464652  Vali Loss: 0.1398763 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9545013  Vali macro F1 0.9390438 
new best score!!!!
Validation loss decreased (0.145888 --> 0.139876).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.842731952667236
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.1418578  Vali Loss: 0.1412378 Vali Accuracy: 0.9504264  Vali weighted F1: 0.9503662  Vali macro F1 0.9340386 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.842236757278442
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.1411532  Vali Loss: 0.1422086 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9475481  Vali macro F1 0.9304575 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.8236024379730225
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.1337200  Vali Loss: 0.1302097 Vali Accuracy: 0.9509595  Vali weighted F1: 0.9507859  Vali macro F1 0.9340908 
new best score!!!!
Validation loss decreased (0.139876 --> 0.130210).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.825982332229614
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.1334760  Vali Loss: 0.1258847 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9541337  Vali macro F1 0.9395328 
new best score!!!!
Validation loss decreased (0.130210 --> 0.125885).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.8359010219573975
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.1277702  Vali Loss: 0.1332866 Vali Accuracy: 0.9520256  Vali weighted F1: 0.9516683  Vali macro F1 0.9348047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.824222803115845
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.1247274  Vali Loss: 0.1215941 Vali Accuracy: 0.9552239  Vali weighted F1: 0.9553443  Vali macro F1 0.9415000 
new best score!!!!
Validation loss decreased (0.125885 --> 0.121594).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.8320958614349365
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.1201992  Vali Loss: 0.1389580 Vali Accuracy: 0.9541578  Vali weighted F1: 0.9537226  Vali macro F1 0.9416309 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.83170747756958
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.1148184  Vali Loss: 0.1147316 Vali Accuracy: 0.9568230  Vali weighted F1: 0.9562180  Vali macro F1 0.9446900 
new best score!!!!
Validation loss decreased (0.121594 --> 0.114732).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.82733678817749
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.1116950  Vali Loss: 0.1213993 Vali Accuracy: 0.9568230  Vali weighted F1: 0.9572169  Vali macro F1 0.9464700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.823703289031982
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.1124840  Vali Loss: 0.1098338 Vali Accuracy: 0.9568230  Vali weighted F1: 0.9563101  Vali macro F1 0.9464664 
new best score!!!!
Validation loss decreased (0.114732 --> 0.109834).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.8463499546051025
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.1060717  Vali Loss: 0.1143420 Vali Accuracy: 0.9600213  Vali weighted F1: 0.9597407  Vali macro F1 0.9509141 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.860166549682617
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.1021071  Vali Loss: 0.1092125 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9609432  Vali macro F1 0.9505677 
new best score!!!!
Validation loss decreased (0.109834 --> 0.109213).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.843548059463501
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0992888  Vali Loss: 0.1079143 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9615454  Vali macro F1 0.9517333 
new best score!!!!
Validation loss decreased (0.109213 --> 0.107914).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.83446478843689
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0978146  Vali Loss: 0.1181142 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9606036  Vali macro F1 0.9505611 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.827687740325928
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.1021181  Vali Loss: 0.1052346 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9618174  Vali macro F1 0.9499769 
new best score!!!!
Validation loss decreased (0.107914 --> 0.105235).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.835517406463623
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.1036596  Vali Loss: 0.1114954 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9612397  Vali macro F1 0.9513661 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.832929372787476
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0944639  Vali Loss: 0.0955798 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9650388  Vali macro F1 0.9578943 
new best score!!!!
Validation loss decreased (0.105235 --> 0.095580).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.8341310024261475
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0917393  Vali Loss: 0.1070878 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9611450  Vali macro F1 0.9506214 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.836708307266235
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0891360  Vali Loss: 0.1129536 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9573787  Vali macro F1 0.9475496 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.813463449478149
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0890666  Vali Loss: 0.1170355 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9544366  Vali macro F1 0.9425570 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.832699537277222
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0888190  Vali Loss: 0.1023224 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9609817  Vali macro F1 0.9516384 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.824613809585571
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0839812  Vali Loss: 0.0946764 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9671331  Vali macro F1 0.9590456 
new best score!!!!
Validation loss decreased (0.095580 --> 0.094676).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.840604543685913
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0839731  Vali Loss: 0.0940249 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9667854  Vali macro F1 0.9590239 
new best score!!!!
Validation loss decreased (0.094676 --> 0.094025).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.829401254653931
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0781032  Vali Loss: 0.0939177 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9694730  Vali macro F1 0.9618179 
new best score!!!!
Validation loss decreased (0.094025 --> 0.093918).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.833754539489746
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0765661  Vali Loss: 0.0927255 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9639728  Vali macro F1 0.9533188 
new best score!!!!
Validation loss decreased (0.093918 --> 0.092726).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.833575963973999
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0768906  Vali Loss: 0.0936115 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9674637  Vali macro F1 0.9586294 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.829698085784912
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0837932  Vali Loss: 0.1181830 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9610164  Vali macro F1 0.9463537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.827808380126953
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0831757  Vali Loss: 0.1156258 Vali Accuracy: 0.9568230  Vali weighted F1: 0.9565944  Vali macro F1 0.9432749 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.82928204536438
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0768307  Vali Loss: 0.1219492 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9594013  Vali macro F1 0.9506254 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.833030462265015
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0747494  Vali Loss: 0.0875959 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9682277  Vali macro F1 0.9599481 
new best score!!!!
Validation loss decreased (0.092726 --> 0.087596).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 5.849517822265625
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0643595  Vali Loss: 0.0948045 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9667854  Vali macro F1 0.9576522 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.851649045944214
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0699303  Vali Loss: 0.0898819 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9666820  Vali macro F1 0.9583924 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 5.832010507583618
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0706462  Vali Loss: 0.0886812 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9686967  Vali macro F1 0.9607425 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 5.834720134735107
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0661712  Vali Loss: 0.0906908 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9685581  Vali macro F1 0.9612849 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 5.832162618637085
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0650676  Vali Loss: 0.0969462 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9693538  Vali macro F1 0.9610239 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 55 cost time: 5.829949855804443
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0551177  Vali Loss: 0.0830104 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9717750  Vali macro F1 0.9638481 
new best score!!!!
Validation loss decreased (0.087596 --> 0.083010).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 5.837737798690796
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0536832  Vali Loss: 0.0830115 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9701019  Vali macro F1 0.9622391 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 5.843339920043945
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0534352  Vali Loss: 0.0839281 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9707106  Vali macro F1 0.9623720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 5.8440632820129395
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0567120  Vali Loss: 0.0845324 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9707235  Vali macro F1 0.9628786 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 5.845140695571899
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0526898  Vali Loss: 0.0853770 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9712869  Vali macro F1 0.9634045 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 5.8430116176605225
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0533511  Vali Loss: 0.0831162 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9699623  Vali macro F1 0.9623665 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 61 cost time: 5.855136871337891
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0548656  Vali Loss: 0.0838536 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9728022  Vali macro F1 0.9651920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 5.858742713928223
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0530110  Vali Loss: 0.0841459 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9712490  Vali macro F1 0.9633521 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 5.849395990371704
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0522259  Vali Loss: 0.0845372 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9723959  Vali macro F1 0.9648293 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 5.837475776672363
VALI: Epoch: 64, Steps: 66 | Train Loss: 0.0518485  Vali Loss: 0.0844618 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9723870  Vali macro F1 0.9648526 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 5.832347869873047
VALI: Epoch: 65, Steps: 66 | Train Loss: 0.0514711  Vali Loss: 0.0837582 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9728533  Vali macro F1 0.9652706 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 66 cost time: 5.836128234863281
VALI: Epoch: 66, Steps: 66 | Train Loss: 0.0522627  Vali Loss: 0.0838541 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9723386  Vali macro F1 0.9647754 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 5.841166257858276
VALI: Epoch: 67, Steps: 66 | Train Loss: 0.0515521  Vali Loss: 0.0838694 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9723386  Vali macro F1 0.9647754 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 5.842837810516357
VALI: Epoch: 68, Steps: 66 | Train Loss: 0.0535121  Vali Loss: 0.0839071 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9723386  Vali macro F1 0.9647754 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 5.827451229095459
VALI: Epoch: 69, Steps: 66 | Train Loss: 0.0520036  Vali Loss: 0.0838778 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9723386  Vali macro F1 0.9647754 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 5.83692741394043
VALI: Epoch: 70, Steps: 66 | Train Loss: 0.0530420  Vali Loss: 0.0838248 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9723386  Vali macro F1 0.9647754 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8805253  Test weighted F1: 0.8873589  Test macro F1 0.8504206 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.880793809890747
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0566969  Vali Loss: 0.0832100 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9729276  Vali macro F1 0.9656350 
Validation loss decreased (inf --> 0.083210).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.856940269470215
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0546637  Vali Loss: 0.0836170 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734981  Vali macro F1 0.9652345 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.843693733215332
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0529877  Vali Loss: 0.0847794 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9712132  Vali macro F1 0.9622715 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 5.846574544906616
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0518911  Vali Loss: 0.0835340 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9722667  Vali macro F1 0.9639830 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 5.845042943954468
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0557921  Vali Loss: 0.0811902 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9727762  Vali macro F1 0.9654980 
new best score!!!!
Validation loss decreased (0.083210 --> 0.081190).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 5.864067792892456
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0524788  Vali Loss: 0.0830349 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9717411  Vali macro F1 0.9634870 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.860842943191528
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0524244  Vali Loss: 0.0855671 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9730104  Vali macro F1 0.9654676 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.855376958847046
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0544880  Vali Loss: 0.0834188 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734064  Vali macro F1 0.9655106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.858635902404785
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0509724  Vali Loss: 0.0856910 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9728801  Vali macro F1 0.9649905 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.865056276321411
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0532140  Vali Loss: 0.0840912 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9728524  Vali macro F1 0.9653178 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 5.888695240020752
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0531201  Vali Loss: 0.0808801 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9733725  Vali macro F1 0.9660504 
new best score!!!!
Validation loss decreased (0.081190 --> 0.080880).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 5.879575967788696
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0519332  Vali Loss: 0.0841428 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9722558  Vali macro F1 0.9640068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 5.860121011734009
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0527352  Vali Loss: 0.0844410 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9739384  Vali macro F1 0.9663354 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 5.8483970165252686
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0521296  Vali Loss: 0.0852947 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9712632  Vali macro F1 0.9621396 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 5.858777284622192
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0508217  Vali Loss: 0.0839075 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9740209  Vali macro F1 0.9649471 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 5.86170220375061
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0498568  Vali Loss: 0.0833592 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9724232  Vali macro F1 0.9630726 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 5.870805740356445
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0483560  Vali Loss: 0.0837454 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9729748  Vali macro F1 0.9636422 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 5.854304075241089
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0502821  Vali Loss: 0.0850579 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734705  Vali macro F1 0.9647346 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 5.858734130859375
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0496798  Vali Loss: 0.0856997 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734512  Vali macro F1 0.9644198 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 5.860659837722778
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0505077  Vali Loss: 0.0848997 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734512  Vali macro F1 0.9644198 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 5.882267475128174
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0488180  Vali Loss: 0.0849558 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734620  Vali macro F1 0.9648000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 5.874668836593628
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0481248  Vali Loss: 0.0848710 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734620  Vali macro F1 0.9648000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 5.8665971755981445
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0488909  Vali Loss: 0.0849726 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9739753  Vali macro F1 0.9652704 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 5.8553924560546875
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0480537  Vali Loss: 0.0850165 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9739753  Vali macro F1 0.9652704 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 5.849886178970337
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0488126  Vali Loss: 0.0851884 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734512  Vali macro F1 0.9644198 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 5.8536365032196045
Fine Tuning VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0487821  Vali Loss: 0.0852754 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9739753  Vali macro F1 0.9652704 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8870596  Test weighted F1: 0.8933387  Test macro F1 0.8568326 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001418  0.00018584 0.00096061 0.00123305 0.00052826 0.00064267]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.121845960617065
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.3740318  Vali Loss: 0.8784427 Vali Accuracy: 0.6915271  Vali weighted F1: 0.5894837  Vali macro F1 0.2779617 
Validation loss decreased (inf --> 0.878443).  Saving model ...
Epoch: 2 cost time: 6.130600690841675
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.7871905  Vali Loss: 0.6658038 Vali Accuracy: 0.7676306  Vali weighted F1: 0.6913698  Vali macro F1 0.4496755 
new best score!!!!
Validation loss decreased (0.878443 --> 0.665804).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.137298822402954
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6142947  Vali Loss: 0.5336000 Vali Accuracy: 0.8031456  Vali weighted F1: 0.7681219  Vali macro F1 0.6766362 
new best score!!!!
Validation loss decreased (0.665804 --> 0.533600).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.138500690460205
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5056704  Vali Loss: 0.4678997 Vali Accuracy: 0.8274987  Vali weighted F1: 0.7961824  Vali macro F1 0.7270641 
new best score!!!!
Validation loss decreased (0.533600 --> 0.467900).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.13964581489563
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4503398  Vali Loss: 0.4143908 Vali Accuracy: 0.8528666  Vali weighted F1: 0.8272246  Vali macro F1 0.7681872 
new best score!!!!
Validation loss decreased (0.467900 --> 0.414391).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.1387810707092285
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3957276  Vali Loss: 0.3689727 Vali Accuracy: 0.8655505  Vali weighted F1: 0.8450997  Vali macro F1 0.7911706 
new best score!!!!
Validation loss decreased (0.414391 --> 0.368973).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.144299507141113
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3421844  Vali Loss: 0.2782453 Vali Accuracy: 0.9015728  Vali weighted F1: 0.8963901  Vali macro F1 0.8599896 
new best score!!!!
Validation loss decreased (0.368973 --> 0.278245).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.148071050643921
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2756770  Vali Loss: 0.2494000 Vali Accuracy: 0.9157788  Vali weighted F1: 0.9115120  Vali macro F1 0.8825954 
new best score!!!!
Validation loss decreased (0.278245 --> 0.249400).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.150831460952759
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2402903  Vali Loss: 0.2658681 Vali Accuracy: 0.9127347  Vali weighted F1: 0.9045434  Vali macro F1 0.8743973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.1229164600372314
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2266441  Vali Loss: 0.1953423 Vali Accuracy: 0.9350583  Vali weighted F1: 0.9322299  Vali macro F1 0.9085569 
new best score!!!!
Validation loss decreased (0.249400 --> 0.195342).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.151077032089233
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2070830  Vali Loss: 0.1663164 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9461605  Vali macro F1 0.9224688 
new best score!!!!
Validation loss decreased (0.195342 --> 0.166316).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.1584250926971436
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1843652  Vali Loss: 0.1596307 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9496412  Vali macro F1 0.9297043 
new best score!!!!
Validation loss decreased (0.166316 --> 0.159631).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.162926197052002
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1789043  Vali Loss: 0.1444967 Vali Accuracy: 0.9538305  Vali weighted F1: 0.9537859  Vali macro F1 0.9337682 
new best score!!!!
Validation loss decreased (0.159631 --> 0.144497).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1634721755981445
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1744536  Vali Loss: 0.1501530 Vali Accuracy: 0.9482496  Vali weighted F1: 0.9471103  Vali macro F1 0.9224059 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.134736061096191
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1683927  Vali Loss: 0.1356556 Vali Accuracy: 0.9548453  Vali weighted F1: 0.9544945  Vali macro F1 0.9303221 
new best score!!!!
Validation loss decreased (0.144497 --> 0.135656).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.159072637557983
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1609222  Vali Loss: 0.1401444 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9530828  Vali macro F1 0.9330552 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.145224094390869
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1535895  Vali Loss: 0.1162546 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9608296  Vali macro F1 0.9408105 
new best score!!!!
Validation loss decreased (0.135656 --> 0.116255).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.143859386444092
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1487351  Vali Loss: 0.1111293 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9628988  Vali macro F1 0.9412713 
new best score!!!!
Validation loss decreased (0.116255 --> 0.111129).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.144303560256958
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1437844  Vali Loss: 0.1124598 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9630069  Vali macro F1 0.9438533 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.144808769226074
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1346447  Vali Loss: 0.1130948 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9603843  Vali macro F1 0.9384450 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.1542510986328125
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1317183  Vali Loss: 0.1066372 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9661407  Vali macro F1 0.9449862 
new best score!!!!
Validation loss decreased (0.111129 --> 0.106637).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.177557706832886
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1367394  Vali Loss: 0.1109029 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9609864  Vali macro F1 0.9402320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.139624834060669
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1301372  Vali Loss: 0.1023433 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9649781  Vali macro F1 0.9466279 
new best score!!!!
Validation loss decreased (0.106637 --> 0.102343).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.154139041900635
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1234521  Vali Loss: 0.1009165 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9619478  Vali macro F1 0.9415327 
new best score!!!!
Validation loss decreased (0.102343 --> 0.100917).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.153699159622192
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1219161  Vali Loss: 0.1064405 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9630694  Vali macro F1 0.9443254 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.122130870819092
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1178896  Vali Loss: 0.1074579 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9618107  Vali macro F1 0.9445456 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.136092901229858
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1174604  Vali Loss: 0.0929206 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9670608  Vali macro F1 0.9480508 
new best score!!!!
Validation loss decreased (0.100917 --> 0.092921).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.144560098648071
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1137024  Vali Loss: 0.0907547 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9666902  Vali macro F1 0.9502440 
new best score!!!!
Validation loss decreased (0.092921 --> 0.090755).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.146891832351685
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1063565  Vali Loss: 0.0869486 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9674577  Vali macro F1 0.9496575 
new best score!!!!
Validation loss decreased (0.090755 --> 0.086949).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.161519289016724
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1141219  Vali Loss: 0.0838852 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9695605  Vali macro F1 0.9528974 
new best score!!!!
Validation loss decreased (0.086949 --> 0.083885).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.16304087638855
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1038384  Vali Loss: 0.0833415 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9692264  Vali macro F1 0.9514343 
new best score!!!!
Validation loss decreased (0.083885 --> 0.083341).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.157503604888916
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1033770  Vali Loss: 0.1013929 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9638549  Vali macro F1 0.9455222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.1421074867248535
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.1044828  Vali Loss: 0.0773568 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9690347  Vali macro F1 0.9513773 
new best score!!!!
Validation loss decreased (0.083341 --> 0.077357).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.139046907424927
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.1025145  Vali Loss: 0.0993867 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9648500  Vali macro F1 0.9435583 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.141436576843262
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0905620  Vali Loss: 0.0932049 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649753  Vali macro F1 0.9446858 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.154240369796753
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0921176  Vali Loss: 0.0967644 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9651904  Vali macro F1 0.9440403 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.135942697525024
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.1020466  Vali Loss: 0.0963047 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9630682  Vali macro F1 0.9437887 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.148015022277832
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0868112  Vali Loss: 0.0788151 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9740187  Vali macro F1 0.9607806 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 6.1605095863342285
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0745271  Vali Loss: 0.0772220 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9721112  Vali macro F1 0.9581451 
new best score!!!!
Validation loss decreased (0.077357 --> 0.077222).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.1680381298065186
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0733248  Vali Loss: 0.0743901 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9716198  Vali macro F1 0.9536856 
new best score!!!!
Validation loss decreased (0.077222 --> 0.074390).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.167680740356445
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0734752  Vali Loss: 0.0734119 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9706266  Vali macro F1 0.9530958 
new best score!!!!
Validation loss decreased (0.074390 --> 0.073412).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.160109043121338
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0751099  Vali Loss: 0.0713874 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9751301  Vali macro F1 0.9634718 
new best score!!!!
Validation loss decreased (0.073412 --> 0.071387).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.147184371948242
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0725728  Vali Loss: 0.0728225 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9737025  Vali macro F1 0.9576967 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.133369207382202
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0746498  Vali Loss: 0.0719819 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9726625  Vali macro F1 0.9548222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.129419565200806
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0718275  Vali Loss: 0.0736808 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9726325  Vali macro F1 0.9565124 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.128050804138184
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0743394  Vali Loss: 0.0740495 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727522  Vali macro F1 0.9607415 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.121913433074951
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0723969  Vali Loss: 0.0703914 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9741950  Vali macro F1 0.9625453 
new best score!!!!
Validation loss decreased (0.071387 --> 0.070391).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.13878059387207
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0709354  Vali Loss: 0.0742314 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707260  Vali macro F1 0.9528001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.15362286567688
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0712104  Vali Loss: 0.0717488 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9736415  Vali macro F1 0.9616020 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.154749155044556
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0708867  Vali Loss: 0.0732621 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9761392  Vali macro F1 0.9651679 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.1343560218811035
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0720369  Vali Loss: 0.0721092 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9736569  Vali macro F1 0.9622464 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.1311194896698
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0709920  Vali Loss: 0.0775651 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728295  Vali macro F1 0.9615012 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.123785734176636
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0706435  Vali Loss: 0.0718183 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747148  Vali macro F1 0.9634238 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.13150691986084
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0701456  Vali Loss: 0.0720677 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747148  Vali macro F1 0.9634238 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.131991147994995
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0697499  Vali Loss: 0.0710845 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9742162  Vali macro F1 0.9625739 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.126399278640747
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0669381  Vali Loss: 0.0708903 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747148  Vali macro F1 0.9634238 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.129996299743652
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0688159  Vali Loss: 0.0704210 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747148  Vali macro F1 0.9634238 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 6.143070220947266
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0696042  Vali Loss: 0.0707126 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747148  Vali macro F1 0.9634238 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.152798414230347
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0696390  Vali Loss: 0.0709892 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9742162  Vali macro F1 0.9625739 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.152238607406616
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0684784  Vali Loss: 0.0709702 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9742162  Vali macro F1 0.9625739 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.133866548538208
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0708264  Vali Loss: 0.0709868 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9742162  Vali macro F1 0.9625739 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.137948989868164
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0673563  Vali Loss: 0.0710997 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9742162  Vali macro F1 0.9625739 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9348226  Test weighted F1: 0.9337288  Test macro F1 0.9308862 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.15950083732605
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0723938  Vali Loss: 0.0725842 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9737587  Vali macro F1 0.9618282 
Validation loss decreased (inf --> 0.072584).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.145498991012573
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0737254  Vali Loss: 0.0771490 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9724314  Vali macro F1 0.9602136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.132383823394775
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0717965  Vali Loss: 0.0755401 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9743204  Vali macro F1 0.9627812 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.1579554080963135
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0728966  Vali Loss: 0.0751980 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9751226  Vali macro F1 0.9637889 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.174278497695923
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0707217  Vali Loss: 0.0725767 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9743051  Vali macro F1 0.9624333 
new best score!!!!
Validation loss decreased (0.072584 --> 0.072577).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.153376817703247
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0723648  Vali Loss: 0.0702124 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747519  Vali macro F1 0.9631953 
new best score!!!!
Validation loss decreased (0.072577 --> 0.070212).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.156076192855835
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0694332  Vali Loss: 0.0766497 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9723112  Vali macro F1 0.9602987 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.148317813873291
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0704367  Vali Loss: 0.0710768 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9751946  Vali macro F1 0.9639213 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.135256290435791
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0693460  Vali Loss: 0.0719671 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9748027  Vali macro F1 0.9632819 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.132368087768555
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0697035  Vali Loss: 0.0687488 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9755918  Vali macro F1 0.9642760 
new best score!!!!
Validation loss decreased (0.070212 --> 0.068749).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.128680229187012
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0695692  Vali Loss: 0.0696979 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9761715  Vali macro F1 0.9655221 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.135179281234741
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0692999  Vali Loss: 0.0715293 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9742272  Vali macro F1 0.9619550 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.1542041301727295
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0680577  Vali Loss: 0.0689201 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9752427  Vali macro F1 0.9634045 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.15032696723938
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0665823  Vali Loss: 0.0665217 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9761570  Vali macro F1 0.9645602 
new best score!!!!
Validation loss decreased (0.068749 --> 0.066522).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.161310911178589
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0677921  Vali Loss: 0.0686616 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747630  Vali macro F1 0.9632095 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.145402908325195
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0687041  Vali Loss: 0.0675745 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9746710  Vali macro F1 0.9627383 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.136405944824219
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0666172  Vali Loss: 0.0663233 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9760937  Vali macro F1 0.9648115 
new best score!!!!
Validation loss decreased (0.066522 --> 0.066323).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.149152040481567
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0658901  Vali Loss: 0.0701648 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771054  Vali macro F1 0.9661818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.146899938583374
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0680863  Vali Loss: 0.0682586 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9753376  Vali macro F1 0.9632465 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.145817518234253
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0667770  Vali Loss: 0.0726253 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747281  Vali macro F1 0.9637396 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.148106098175049
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0659742  Vali Loss: 0.0703121 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747427  Vali macro F1 0.9634812 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.16910719871521
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0669873  Vali Loss: 0.0674990 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9756722  Vali macro F1 0.9649966 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 23 cost time: 6.162331581115723
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0667562  Vali Loss: 0.0672187 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776669  Vali macro F1 0.9667829 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.154398441314697
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0618851  Vali Loss: 0.0689884 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9743744  Vali macro F1 0.9632096 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.152458429336548
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0652441  Vali Loss: 0.0653765 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771840  Vali macro F1 0.9662967 
new best score!!!!
Validation loss decreased (0.066323 --> 0.065377).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.164055347442627
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0633608  Vali Loss: 0.0693122 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9753124  Vali macro F1 0.9635216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.15935206413269
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0636812  Vali Loss: 0.0675728 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9752963  Vali macro F1 0.9631734 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.1561830043792725
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0650005  Vali Loss: 0.0653837 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766374  Vali macro F1 0.9660122 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.169426679611206
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0631051  Vali Loss: 0.0662441 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771051  Vali macro F1 0.9664591 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.437476873397827
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0634069  Vali Loss: 0.0671855 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771687  Vali macro F1 0.9662584 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 6.1467225551605225
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0622773  Vali Loss: 0.0660472 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771879  Vali macro F1 0.9666010 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.153109312057495
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0628588  Vali Loss: 0.0659210 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772093  Vali macro F1 0.9663220 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.190295934677124
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0625318  Vali Loss: 0.0654327 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772119  Vali macro F1 0.9663532 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.1477015018463135
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0624932  Vali Loss: 0.0649921 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782290  Vali macro F1 0.9680780 
new best score!!!!
Validation loss decreased (0.065377 --> 0.064992).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 6.142601490020752
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0612127  Vali Loss: 0.0651701 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777205  Vali macro F1 0.9672156 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 6.13605809211731
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0623834  Vali Loss: 0.0646312 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766982  Vali macro F1 0.9661079 
new best score!!!!
Validation loss decreased (0.064992 --> 0.064631).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 6.145000696182251
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0615325  Vali Loss: 0.0651816 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776907  Vali macro F1 0.9674574 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.138805389404297
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0621883  Vali Loss: 0.0664874 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777047  Vali macro F1 0.9671766 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.138339996337891
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0613091  Vali Loss: 0.0655644 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771998  Vali macro F1 0.9669685 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.132413864135742
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0605029  Vali Loss: 0.0645330 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781841  Vali macro F1 0.9679777 
new best score!!!!
Validation loss decreased (0.064631 --> 0.064533).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 41 cost time: 6.147814512252808
Fine Tuning VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0619346  Vali Loss: 0.0663178 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777047  Vali macro F1 0.9671766 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 6.164219856262207
Fine Tuning VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0605937  Vali Loss: 0.0660191 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771788  Vali macro F1 0.9665962 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 6.133364677429199
Fine Tuning VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0582005  Vali Loss: 0.0648812 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9767010  Vali macro F1 0.9661394 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 6.141432523727417
Fine Tuning VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0602174  Vali Loss: 0.0662979 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777242  Vali macro F1 0.9675465 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 6.13458251953125
Fine Tuning VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0603940  Vali Loss: 0.0667240 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777422  Vali macro F1 0.9678941 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 46 cost time: 6.128588914871216
Fine Tuning VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0622320  Vali Loss: 0.0664629 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782331  Vali macro F1 0.9684094 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 47 cost time: 6.136686086654663
Fine Tuning VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0609011  Vali Loss: 0.0661241 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772152  Vali macro F1 0.9666836 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 48 cost time: 6.131228685379028
Fine Tuning VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0623649  Vali Loss: 0.0660923 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772152  Vali macro F1 0.9666836 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 49 cost time: 6.1410462856292725
Fine Tuning VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0608356  Vali Loss: 0.0659165 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772152  Vali macro F1 0.9666836 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 50 cost time: 6.158686637878418
Fine Tuning VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0594127  Vali Loss: 0.0659233 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772152  Vali macro F1 0.9666836 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 51 cost time: 6.164676189422607
Fine Tuning VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0625280  Vali Loss: 0.0658929 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766895  Vali macro F1 0.9661034 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 52 cost time: 6.140650272369385
Fine Tuning VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0604737  Vali Loss: 0.0658691 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771808  Vali macro F1 0.9666199 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 53 cost time: 6.146379232406616
Fine Tuning VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0601929  Vali Loss: 0.0658631 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771808  Vali macro F1 0.9666199 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 54 cost time: 6.155394554138184
Fine Tuning VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0584904  Vali Loss: 0.0658649 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771808  Vali macro F1 0.9666199 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 55 cost time: 6.160492420196533
Fine Tuning VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0604793  Vali Loss: 0.0658365 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771808  Vali macro F1 0.9666199 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9363854  Test weighted F1: 0.9351379  Test macro F1 0.9317867 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014192 0.00017857 0.00096712 0.00121803 0.00047893 0.00060533]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.324803829193115
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.3596760  Vali Loss: 0.8692281 Vali Accuracy: 0.6669956  Vali weighted F1: 0.5583625  Vali macro F1 0.2754914 
Validation loss decreased (inf --> 0.869228).  Saving model ...
Epoch: 2 cost time: 6.316543817520142
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.7663080  Vali Loss: 0.6819664 Vali Accuracy: 0.7661569  Vali weighted F1: 0.7070773  Vali macro F1 0.4975519 
new best score!!!!
Validation loss decreased (0.869228 --> 0.681966).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.332636117935181
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.6256475  Vali Loss: 0.5755820 Vali Accuracy: 0.7715836  Vali weighted F1: 0.7098412  Vali macro F1 0.4950594 
new best score!!!!
Validation loss decreased (0.681966 --> 0.575582).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 7.562246084213257
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.5372637  Vali Loss: 0.5220617 Vali Accuracy: 0.7972373  Vali weighted F1: 0.7477784  Vali macro F1 0.5520872 
new best score!!!!
Validation loss decreased (0.575582 --> 0.522062).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 7.26489782333374
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.4574012  Vali Loss: 0.4333138 Vali Accuracy: 0.8233843  Vali weighted F1: 0.7877051  Vali macro F1 0.6004740 
new best score!!!!
Validation loss decreased (0.522062 --> 0.433314).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.339681386947632
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.3852286  Vali Loss: 0.3036180 Vali Accuracy: 0.9102121  Vali weighted F1: 0.9061586  Vali macro F1 0.8855375 
new best score!!!!
Validation loss decreased (0.433314 --> 0.303618).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.33607292175293
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.3182034  Vali Loss: 0.2539923 Vali Accuracy: 0.9200789  Vali weighted F1: 0.9179492  Vali macro F1 0.8986310 
new best score!!!!
Validation loss decreased (0.303618 --> 0.253992).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.350081205368042
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.2685357  Vali Loss: 0.2390479 Vali Accuracy: 0.9255057  Vali weighted F1: 0.9215982  Vali macro F1 0.9045466 
new best score!!!!
Validation loss decreased (0.253992 --> 0.239048).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.337579965591431
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.2344838  Vali Loss: 0.2134663 Vali Accuracy: 0.9309324  Vali weighted F1: 0.9288535  Vali macro F1 0.9124363 
new best score!!!!
Validation loss decreased (0.239048 --> 0.213466).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.3208746910095215
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.2099137  Vali Loss: 0.1736773 Vali Accuracy: 0.9442526  Vali weighted F1: 0.9429370  Vali macro F1 0.9270595 
new best score!!!!
Validation loss decreased (0.213466 --> 0.173677).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.340025424957275
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.2032422  Vali Loss: 0.1611477 Vali Accuracy: 0.9486926  Vali weighted F1: 0.9486301  Vali macro F1 0.9333146 
new best score!!!!
Validation loss decreased (0.173677 --> 0.161148).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.345491647720337
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1970396  Vali Loss: 0.1641705 Vali Accuracy: 0.9427726  Vali weighted F1: 0.9419801  Vali macro F1 0.9250840 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.318835496902466
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1884086  Vali Loss: 0.1529623 Vali Accuracy: 0.9546127  Vali weighted F1: 0.9541412  Vali macro F1 0.9409096 
new best score!!!!
Validation loss decreased (0.161148 --> 0.152962).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.333461046218872
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1716781  Vali Loss: 0.1416797 Vali Accuracy: 0.9521460  Vali weighted F1: 0.9509086  Vali macro F1 0.9371635 
new best score!!!!
Validation loss decreased (0.152962 --> 0.141680).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.325095176696777
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1680842  Vali Loss: 0.1418651 Vali Accuracy: 0.9531327  Vali weighted F1: 0.9535505  Vali macro F1 0.9386864 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.329912185668945
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.1601130  Vali Loss: 0.1413244 Vali Accuracy: 0.9501727  Vali weighted F1: 0.9488221  Vali macro F1 0.9326365 
new best score!!!!
Validation loss decreased (0.141680 --> 0.141324).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.332921504974365
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.1535766  Vali Loss: 0.1476726 Vali Accuracy: 0.9511593  Vali weighted F1: 0.9515422  Vali macro F1 0.9355348 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.337852716445923
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.1498916  Vali Loss: 0.1292537 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9609435  Vali macro F1 0.9498282 
new best score!!!!
Validation loss decreased (0.141324 --> 0.129254).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.32767391204834
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.1453260  Vali Loss: 0.1216956 Vali Accuracy: 0.9580661  Vali weighted F1: 0.9582109  Vali macro F1 0.9430761 
new best score!!!!
Validation loss decreased (0.129254 --> 0.121696).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.327078104019165
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.1435553  Vali Loss: 0.1260013 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9619525  Vali macro F1 0.9491937 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.3484413623809814
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.1431832  Vali Loss: 0.1239039 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9617639  Vali macro F1 0.9511417 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.351516485214233
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.1341667  Vali Loss: 0.1120099 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9645411  Vali macro F1 0.9533805 
new best score!!!!
Validation loss decreased (0.121696 --> 0.112010).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.332387447357178
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.1306226  Vali Loss: 0.1253775 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9594320  Vali macro F1 0.9470165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.328506231307983
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.1318147  Vali Loss: 0.1105105 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9635171  Vali macro F1 0.9519151 
new best score!!!!
Validation loss decreased (0.112010 --> 0.110511).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.331528902053833
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.1255795  Vali Loss: 0.1088567 Vali Accuracy: 0.9654662  Vali weighted F1: 0.9656449  Vali macro F1 0.9554175 
new best score!!!!
Validation loss decreased (0.110511 --> 0.108857).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.335103988647461
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.1244966  Vali Loss: 0.1097940 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9670786  Vali macro F1 0.9549756 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.3289971351623535
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.1170313  Vali Loss: 0.1190163 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9608311  Vali macro F1 0.9502641 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.339367866516113
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.1192282  Vali Loss: 0.1004948 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9686160  Vali macro F1 0.9579730 
new best score!!!!
Validation loss decreased (0.108857 --> 0.100495).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.33135986328125
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.1143330  Vali Loss: 0.1118965 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9629332  Vali macro F1 0.9517076 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.336053371429443
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.1187310  Vali Loss: 0.1092928 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9625029  Vali macro F1 0.9502979 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.347031116485596
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.1146980  Vali Loss: 0.0959786 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9711499  Vali macro F1 0.9625162 
new best score!!!!
Validation loss decreased (0.100495 --> 0.095979).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.356640815734863
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.1098815  Vali Loss: 0.1047656 Vali Accuracy: 0.9654662  Vali weighted F1: 0.9657859  Vali macro F1 0.9541749 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.330170154571533
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.1076545  Vali Loss: 0.1028410 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9654387  Vali macro F1 0.9540061 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.3425116539001465
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.1002434  Vali Loss: 0.1041344 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9668546  Vali macro F1 0.9550223 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.343288421630859
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.1028970  Vali Loss: 0.1028515 Vali Accuracy: 0.9674396  Vali weighted F1: 0.9676015  Vali macro F1 0.9583335 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.3391077518463135
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.1005081  Vali Loss: 0.1004552 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9680885  Vali macro F1 0.9584851 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 6.348578214645386
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0924452  Vali Loss: 0.0952004 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9687122  Vali macro F1 0.9579246 
new best score!!!!
Validation loss decreased (0.095979 --> 0.095200).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.334139823913574
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0883789  Vali Loss: 0.0952027 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9682234  Vali macro F1 0.9571518 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.336690664291382
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0876555  Vali Loss: 0.0925844 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9692067  Vali macro F1 0.9586894 
new best score!!!!
Validation loss decreased (0.095200 --> 0.092584).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.347720146179199
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0868778  Vali Loss: 0.0923876 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9701504  Vali macro F1 0.9610518 
new best score!!!!
Validation loss decreased (0.092584 --> 0.092388).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.349520444869995
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0876120  Vali Loss: 0.0919773 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9701101  Vali macro F1 0.9609966 
new best score!!!!
Validation loss decreased (0.092388 --> 0.091977).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.329730987548828
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0879743  Vali Loss: 0.0901211 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9706759  Vali macro F1 0.9610245 
new best score!!!!
Validation loss decreased (0.091977 --> 0.090121).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.328978776931763
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0882137  Vali Loss: 0.0884323 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9720674  Vali macro F1 0.9626721 
new best score!!!!
Validation loss decreased (0.090121 --> 0.088432).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.326871395111084
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0895039  Vali Loss: 0.0914286 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9711355  Vali macro F1 0.9615471 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.328336238861084
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0840957  Vali Loss: 0.0940257 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9706106  Vali macro F1 0.9606462 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.332293272018433
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0833291  Vali Loss: 0.0896477 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725609  Vali macro F1 0.9643467 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.3299384117126465
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0853760  Vali Loss: 0.0899235 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715780  Vali macro F1 0.9618703 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.342953443527222
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0832987  Vali Loss: 0.0915431 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9701390  Vali macro F1 0.9607240 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 6.338584899902344
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0841683  Vali Loss: 0.0897811 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9706000  Vali macro F1 0.9612491 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.339646339416504
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0825897  Vali Loss: 0.0896594 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710739  Vali macro F1 0.9617080 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.333580732345581
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0841149  Vali Loss: 0.0896582 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9706000  Vali macro F1 0.9612491 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.3260109424591064
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0841132  Vali Loss: 0.0889461 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710896  Vali macro F1 0.9620257 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.337128639221191
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0850153  Vali Loss: 0.0894054 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715791  Vali macro F1 0.9628024 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 6.344079971313477
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0831536  Vali Loss: 0.0893709 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710896  Vali macro F1 0.9620257 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.338371753692627
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0843232  Vali Loss: 0.0892363 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710896  Vali macro F1 0.9620257 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.336480379104614
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0844041  Vali Loss: 0.0892479 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710896  Vali macro F1 0.9620257 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.358216762542725
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0840556  Vali Loss: 0.0890982 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710896  Vali macro F1 0.9620257 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.36094069480896
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0836939  Vali Loss: 0.0890717 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710896  Vali macro F1 0.9620257 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8743332  Test weighted F1: 0.8657726  Test macro F1 0.6531583 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.390976905822754
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0894424  Vali Loss: 0.0886575 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715768  Vali macro F1 0.9622497 
Validation loss decreased (inf --> 0.088658).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.343099117279053
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0869516  Vali Loss: 0.0901829 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725206  Vali macro F1 0.9642406 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.334810256958008
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0866439  Vali Loss: 0.0877822 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9726492  Vali macro F1 0.9634712 
new best score!!!!
Validation loss decreased (0.088658 --> 0.087782).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.345724105834961
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0840991  Vali Loss: 0.0892941 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9711219  Vali macro F1 0.9608286 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.352212905883789
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0830321  Vali Loss: 0.0886923 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9720069  Vali macro F1 0.9627922 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.351659536361694
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0860940  Vali Loss: 0.0962163 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9705258  Vali macro F1 0.9603088 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.350819110870361
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0854818  Vali Loss: 0.0913092 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9711731  Vali macro F1 0.9617263 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.356516599655151
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0850133  Vali Loss: 0.0869781 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9726280  Vali macro F1 0.9632152 
new best score!!!!
Validation loss decreased (0.087782 --> 0.086978).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.386216402053833
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0836552  Vali Loss: 0.0906969 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710241  Vali macro F1 0.9617891 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.3821470737457275
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0853863  Vali Loss: 0.0916831 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9719787  Vali macro F1 0.9623101 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.352893352508545
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0844887  Vali Loss: 0.0872558 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725961  Vali macro F1 0.9639246 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.359428644180298
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0857432  Vali Loss: 0.0888014 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710768  Vali macro F1 0.9617602 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.361627578735352
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0832993  Vali Loss: 0.0881621 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9721221  Vali macro F1 0.9634660 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 6.347716569900513
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0808496  Vali Loss: 0.0858832 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715622  Vali macro F1 0.9630077 
new best score!!!!
Validation loss decreased (0.086978 --> 0.085883).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.354033946990967
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0830358  Vali Loss: 0.0875951 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9721291  Vali macro F1 0.9629185 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.342364549636841
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0835081  Vali Loss: 0.0888398 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9716196  Vali macro F1 0.9619272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.360936641693115
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0810003  Vali Loss: 0.0865164 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9719765  Vali macro F1 0.9635779 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.360178232192993
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0830544  Vali Loss: 0.0848214 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715917  Vali macro F1 0.9626171 
new best score!!!!
Validation loss decreased (0.085883 --> 0.084821).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.356825113296509
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0818342  Vali Loss: 0.0884866 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9730942  Vali macro F1 0.9642086 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.34500527381897
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0795339  Vali Loss: 0.0887298 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715513  Vali macro F1 0.9626474 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.336911916732788
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0797998  Vali Loss: 0.0840815 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9736205  Vali macro F1 0.9650283 
new best score!!!!
Validation loss decreased (0.084821 --> 0.084082).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.360205173492432
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0793687  Vali Loss: 0.0853044 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725453  Vali macro F1 0.9638166 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.351974010467529
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0798962  Vali Loss: 0.0871649 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715780  Vali macro F1 0.9631697 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.3466949462890625
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0781653  Vali Loss: 0.0903131 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9729935  Vali macro F1 0.9651992 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.34341287612915
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0789843  Vali Loss: 0.0844292 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9720291  Vali macro F1 0.9639867 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.364185571670532
Fine Tuning VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0778385  Vali Loss: 0.0835287 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9730568  Vali macro F1 0.9649765 
new best score!!!!
Validation loss decreased (0.084082 --> 0.083529).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.358805179595947
Fine Tuning VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0769733  Vali Loss: 0.0826735 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9745744  Vali macro F1 0.9671595 
new best score!!!!
Validation loss decreased (0.083529 --> 0.082674).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 6.353586912155151
Fine Tuning VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0787930  Vali Loss: 0.0826358 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9740510  Vali macro F1 0.9663661 
new best score!!!!
Validation loss decreased (0.082674 --> 0.082636).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.339893102645874
Fine Tuning VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0783970  Vali Loss: 0.0878520 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9705417  Vali macro F1 0.9617931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.355469465255737
Fine Tuning VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0775271  Vali Loss: 0.0822278 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9720762  Vali macro F1 0.9634646 
new best score!!!!
Validation loss decreased (0.082636 --> 0.082228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.3546295166015625
Fine Tuning VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0774320  Vali Loss: 0.0848386 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9719418  Vali macro F1 0.9638645 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.343085050582886
Fine Tuning VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0794576  Vali Loss: 0.0835742 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9720279  Vali macro F1 0.9634358 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.329554557800293
Fine Tuning VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0756348  Vali Loss: 0.0805566 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725869  Vali macro F1 0.9639425 
new best score!!!!
Validation loss decreased (0.082228 --> 0.080557).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 6.351176500320435
Fine Tuning VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0766185  Vali Loss: 0.0834383 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9714938  Vali macro F1 0.9631143 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 6.355243682861328
Fine Tuning VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0782641  Vali Loss: 0.0825234 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725610  Vali macro F1 0.9646621 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 6.353595018386841
Fine Tuning VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0760287  Vali Loss: 0.0872419 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9714224  Vali macro F1 0.9629532 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 6.385390996932983
Fine Tuning VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0761040  Vali Loss: 0.0823056 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9744677  Vali macro F1 0.9673514 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 6.364420413970947
Fine Tuning VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0748362  Vali Loss: 0.0824669 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9720620  Vali macro F1 0.9640462 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 39 cost time: 6.3795716762542725
Fine Tuning VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0743868  Vali Loss: 0.0823110 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725688  Vali macro F1 0.9646029 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 6.363716125488281
Fine Tuning VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0756668  Vali Loss: 0.0821812 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725688  Vali macro F1 0.9646029 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 6.368818998336792
Fine Tuning VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0739333  Vali Loss: 0.0821898 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725829  Vali macro F1 0.9643917 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 6.376574754714966
Fine Tuning VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0744802  Vali Loss: 0.0813995 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9720732  Vali macro F1 0.9634920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 6.364809513092041
Fine Tuning VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0751503  Vali Loss: 0.0813163 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9730637  Vali macro F1 0.9648462 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 44 cost time: 6.372844457626343
Fine Tuning VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0760676  Vali Loss: 0.0812956 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9730637  Vali macro F1 0.9648462 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 45 cost time: 6.422563552856445
Fine Tuning VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0733758  Vali Loss: 0.0813174 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725881  Vali macro F1 0.9643852 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 46 cost time: 6.424016714096069
Fine Tuning VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0736317  Vali Loss: 0.0813905 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725881  Vali macro F1 0.9643852 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 47 cost time: 6.411798715591431
Fine Tuning VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0715700  Vali Loss: 0.0813588 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715787  Vali macro F1 0.9632489 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 48 cost time: 6.350332498550415
Fine Tuning VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0721975  Vali Loss: 0.0814476 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715787  Vali macro F1 0.9632489 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8658975  Test weighted F1: 0.8584977  Test macro F1 0.6503277 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014422 0.00016992 0.000999   0.00131579 0.00050025 0.00062814]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.325389623641968
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.3562830  Vali Loss: 0.8261219 Vali Accuracy: 0.6998514  Vali weighted F1: 0.5949632  Vali macro F1 0.2798013 
Validation loss decreased (inf --> 0.826122).  Saving model ...
Epoch: 2 cost time: 6.306331396102905
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.7432786  Vali Loss: 0.6446571 Vali Accuracy: 0.7899950  Vali weighted F1: 0.7445394  Vali macro F1 0.5702403 
new best score!!!!
Validation loss decreased (0.826122 --> 0.644657).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.299611330032349
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.5875832  Vali Loss: 0.5156526 Vali Accuracy: 0.8207033  Vali weighted F1: 0.7864452  Vali macro F1 0.6836002 
new best score!!!!
Validation loss decreased (0.644657 --> 0.515653).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.310441255569458
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.4890148  Vali Loss: 0.4221203 Vali Accuracy: 0.8464586  Vali weighted F1: 0.8137952  Vali macro F1 0.7334739 
new best score!!!!
Validation loss decreased (0.515653 --> 0.422120).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.339428663253784
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.4055906  Vali Loss: 0.3577081 Vali Accuracy: 0.8801387  Vali weighted F1: 0.8603508  Vali macro F1 0.7961384 
new best score!!!!
Validation loss decreased (0.422120 --> 0.357708).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.309708118438721
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.3623375  Vali Loss: 0.3102812 Vali Accuracy: 0.8890540  Vali weighted F1: 0.8785011  Vali macro F1 0.8282518 
new best score!!!!
Validation loss decreased (0.357708 --> 0.310281).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.32097601890564
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.3119023  Vali Loss: 0.2855583 Vali Accuracy: 0.8945022  Vali weighted F1: 0.8933954  Vali macro F1 0.8536519 
new best score!!!!
Validation loss decreased (0.310281 --> 0.285558).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.307785511016846
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2808648  Vali Loss: 0.2327820 Vali Accuracy: 0.9227340  Vali weighted F1: 0.9194720  Vali macro F1 0.8827951 
new best score!!!!
Validation loss decreased (0.285558 --> 0.232782).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.312360048294067
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2504093  Vali Loss: 0.2113557 Vali Accuracy: 0.9291729  Vali weighted F1: 0.9268811  Vali macro F1 0.8891121 
new best score!!!!
Validation loss decreased (0.232782 --> 0.211356).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.310420989990234
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.2249402  Vali Loss: 0.2010065 Vali Accuracy: 0.9286776  Vali weighted F1: 0.9263764  Vali macro F1 0.8883529 
new best score!!!!
Validation loss decreased (0.211356 --> 0.201006).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.312621593475342
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.2097859  Vali Loss: 0.1908636 Vali Accuracy: 0.9291729  Vali weighted F1: 0.9282156  Vali macro F1 0.8882738 
new best score!!!!
Validation loss decreased (0.201006 --> 0.190864).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.320537090301514
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1991957  Vali Loss: 0.1658391 Vali Accuracy: 0.9425458  Vali weighted F1: 0.9416551  Vali macro F1 0.9060052 
new best score!!!!
Validation loss decreased (0.190864 --> 0.165839).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.333660840988159
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1880509  Vali Loss: 0.1778671 Vali Accuracy: 0.9380882  Vali weighted F1: 0.9381276  Vali macro F1 0.9056025 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.329781770706177
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1783469  Vali Loss: 0.1518391 Vali Accuracy: 0.9474988  Vali weighted F1: 0.9473550  Vali macro F1 0.9173831 
new best score!!!!
Validation loss decreased (0.165839 --> 0.151839).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.317751169204712
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1734551  Vali Loss: 0.1584549 Vali Accuracy: 0.9445270  Vali weighted F1: 0.9435347  Vali macro F1 0.9169888 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.311050653457642
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1659994  Vali Loss: 0.1386757 Vali Accuracy: 0.9504705  Vali weighted F1: 0.9502274  Vali macro F1 0.9212938 
new best score!!!!
Validation loss decreased (0.151839 --> 0.138676).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.307620286941528
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1621690  Vali Loss: 0.1391859 Vali Accuracy: 0.9549282  Vali weighted F1: 0.9544271  Vali macro F1 0.9295436 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.295543909072876
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1585520  Vali Loss: 0.1330342 Vali Accuracy: 0.9569094  Vali weighted F1: 0.9565876  Vali macro F1 0.9333402 
new best score!!!!
Validation loss decreased (0.138676 --> 0.133034).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.323137998580933
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1563943  Vali Loss: 0.1372233 Vali Accuracy: 0.9544329  Vali weighted F1: 0.9548996  Vali macro F1 0.9333790 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.306484699249268
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1486486  Vali Loss: 0.1237797 Vali Accuracy: 0.9603764  Vali weighted F1: 0.9605236  Vali macro F1 0.9433850 
new best score!!!!
Validation loss decreased (0.133034 --> 0.123780).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.3225016593933105
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1443484  Vali Loss: 0.1240998 Vali Accuracy: 0.9569094  Vali weighted F1: 0.9573602  Vali macro F1 0.9375276 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.32388162612915
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1415979  Vali Loss: 0.1183822 Vali Accuracy: 0.9588905  Vali weighted F1: 0.9585857  Vali macro F1 0.9389804 
new best score!!!!
Validation loss decreased (0.123780 --> 0.118382).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.310396432876587
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1338952  Vali Loss: 0.1164661 Vali Accuracy: 0.9618623  Vali weighted F1: 0.9621632  Vali macro F1 0.9464765 
new best score!!!!
Validation loss decreased (0.118382 --> 0.116466).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.302445650100708
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1281709  Vali Loss: 0.1098915 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9624043  Vali macro F1 0.9458347 
new best score!!!!
Validation loss decreased (0.116466 --> 0.109892).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.304845094680786
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1292655  Vali Loss: 0.1102278 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9655186  Vali macro F1 0.9499856 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.288999795913696
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1240969  Vali Loss: 0.1019508 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9676411  Vali macro F1 0.9546316 
new best score!!!!
Validation loss decreased (0.109892 --> 0.101951).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.302531480789185
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1279039  Vali Loss: 0.1010449 Vali Accuracy: 0.9638435  Vali weighted F1: 0.9637568  Vali macro F1 0.9453857 
new best score!!!!
Validation loss decreased (0.101951 --> 0.101045).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.311805009841919
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1193867  Vali Loss: 0.0966229 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9681118  Vali macro F1 0.9558219 
new best score!!!!
Validation loss decreased (0.101045 --> 0.096623).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.31284236907959
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1134577  Vali Loss: 0.0906981 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9702625  Vali macro F1 0.9585844 
new best score!!!!
Validation loss decreased (0.096623 --> 0.090698).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.330707550048828
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1160980  Vali Loss: 0.1120387 Vali Accuracy: 0.9583952  Vali weighted F1: 0.9585001  Vali macro F1 0.9424585 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.299752235412598
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.1074701  Vali Loss: 0.0966701 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9664151  Vali macro F1 0.9547581 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.3068366050720215
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.1127451  Vali Loss: 0.0958585 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9689230  Vali macro F1 0.9560241 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.315457582473755
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.1016662  Vali Loss: 0.0941108 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9712958  Vali macro F1 0.9606667 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.304494142532349
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.1024620  Vali Loss: 0.0926957 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9673015  Vali macro F1 0.9562656 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.311084270477295
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0910342  Vali Loss: 0.0848441 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9717693  Vali macro F1 0.9609433 
new best score!!!!
Validation loss decreased (0.090698 --> 0.084844).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.423724889755249
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0882181  Vali Loss: 0.0822389 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9712817  Vali macro F1 0.9602425 
new best score!!!!
Validation loss decreased (0.084844 --> 0.082239).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.306500673294067
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0870534  Vali Loss: 0.0828744 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9717480  Vali macro F1 0.9607767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.322144508361816
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0870775  Vali Loss: 0.0836686 Vali Accuracy: 0.9697870  Vali weighted F1: 0.9698532  Vali macro F1 0.9587971 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.3267858028411865
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0875497  Vali Loss: 0.0808651 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9708407  Vali macro F1 0.9598898 
new best score!!!!
Validation loss decreased (0.082239 --> 0.080865).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.31354832649231
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0855333  Vali Loss: 0.0807106 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9728008  Vali macro F1 0.9622492 
new best score!!!!
Validation loss decreased (0.080865 --> 0.080711).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.316339731216431
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0849340  Vali Loss: 0.0798905 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9732586  Vali macro F1 0.9624224 
new best score!!!!
Validation loss decreased (0.080711 --> 0.079890).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.310705661773682
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0846775  Vali Loss: 0.0793578 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9722993  Vali macro F1 0.9616438 
new best score!!!!
Validation loss decreased (0.079890 --> 0.079358).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.2972412109375
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0871954  Vali Loss: 0.0806045 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9728005  Vali macro F1 0.9616419 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.291961908340454
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0835285  Vali Loss: 0.0820120 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9728005  Vali macro F1 0.9616419 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.301478385925293
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0828125  Vali Loss: 0.0796192 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9718307  Vali macro F1 0.9604796 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.316486120223999
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0841997  Vali Loss: 0.0784303 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9726589  Vali macro F1 0.9617250 
new best score!!!!
Validation loss decreased (0.079358 --> 0.078430).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.336666107177734
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0858764  Vali Loss: 0.0788052 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742840  Vali macro F1 0.9635771 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.308256387710571
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0833991  Vali Loss: 0.0786593 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9757266  Vali macro F1 0.9654120 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.311802864074707
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0822719  Vali Loss: 0.0775838 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9741832  Vali macro F1 0.9637230 
new best score!!!!
Validation loss decreased (0.078430 --> 0.077584).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.306627988815308
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0825600  Vali Loss: 0.0779187 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9746902  Vali macro F1 0.9643448 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.309171199798584
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0807140  Vali Loss: 0.0775872 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742832  Vali macro F1 0.9637005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.301707744598389
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0810283  Vali Loss: 0.0773912 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752588  Vali macro F1 0.9648609 
new best score!!!!
Validation loss decreased (0.077584 --> 0.077391).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.30567479133606
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0787341  Vali Loss: 0.0789532 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742538  Vali macro F1 0.9632491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.305291414260864
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0815849  Vali Loss: 0.0750688 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9751704  Vali macro F1 0.9648001 
new best score!!!!
Validation loss decreased (0.077391 --> 0.075069).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.340921640396118
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0789641  Vali Loss: 0.0780009 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9757575  Vali macro F1 0.9654652 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.3108625411987305
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0829230  Vali Loss: 0.0759264 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752112  Vali macro F1 0.9648913 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.311990737915039
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0823209  Vali Loss: 0.0806956 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9704695  Vali macro F1 0.9594395 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.292372941970825
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0794841  Vali Loss: 0.0767984 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9720814  Vali macro F1 0.9611936 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.285995960235596
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0818781  Vali Loss: 0.0783616 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9733665  Vali macro F1 0.9624274 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 6.283585071563721
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0794041  Vali Loss: 0.0778204 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752705  Vali macro F1 0.9646486 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.284530401229858
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0777233  Vali Loss: 0.0775045 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747516  Vali macro F1 0.9642393 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.291634798049927
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0799229  Vali Loss: 0.0769991 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747516  Vali macro F1 0.9642393 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.311064004898071
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0790230  Vali Loss: 0.0767201 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747516  Vali macro F1 0.9642393 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.304617643356323
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0780212  Vali Loss: 0.0768843 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747903  Vali macro F1 0.9643219 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 65 cost time: 6.285602569580078
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0774039  Vali Loss: 0.0768775 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747903  Vali macro F1 0.9643219 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 6.284831762313843
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0782864  Vali Loss: 0.0768467 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752588  Vali macro F1 0.9648609 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 6.280751943588257
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0770831  Vali Loss: 0.0768474 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747516  Vali macro F1 0.9642393 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.288588762283325
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0789764  Vali Loss: 0.0766938 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752588  Vali macro F1 0.9648609 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.284502983093262
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0774294  Vali Loss: 0.0766910 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747516  Vali macro F1 0.9642393 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7430769  Test weighted F1: 0.7479794  Test macro F1 0.7484964 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.349191427230835
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0807651  Vali Loss: 0.0763905 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9737129  Vali macro F1 0.9636763 
Validation loss decreased (inf --> 0.076390).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.33368444442749
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0819671  Vali Loss: 0.0775297 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9757266  Vali macro F1 0.9654120 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.330946922302246
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0779464  Vali Loss: 0.0748762 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9741837  Vali macro F1 0.9637340 
new best score!!!!
Validation loss decreased (0.076390 --> 0.074876).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.310287714004517
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0790548  Vali Loss: 0.0755622 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9751730  Vali macro F1 0.9648120 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.3229875564575195
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0812692  Vali Loss: 0.0757578 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747519  Vali macro F1 0.9642501 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.321192741394043
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0800647  Vali Loss: 0.0765957 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9731918  Vali macro F1 0.9620413 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.336965799331665
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0781115  Vali Loss: 0.0750984 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9746890  Vali macro F1 0.9643655 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.324595212936401
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0789989  Vali Loss: 0.0762153 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747027  Vali macro F1 0.9647544 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.330064296722412
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0773720  Vali Loss: 0.0756347 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9748195  Vali macro F1 0.9643848 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.336809158325195
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0764157  Vali Loss: 0.0756413 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9753055  Vali macro F1 0.9648626 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.347616672515869
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0788238  Vali Loss: 0.0793196 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9723438  Vali macro F1 0.9608754 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.340381860733032
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0787332  Vali Loss: 0.0755817 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9743222  Vali macro F1 0.9631512 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.346630334854126
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0773423  Vali Loss: 0.0742874 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752374  Vali macro F1 0.9645715 
new best score!!!!
Validation loss decreased (0.074876 --> 0.074287).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.339480400085449
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0758383  Vali Loss: 0.0734919 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9751624  Vali macro F1 0.9649275 
new best score!!!!
Validation loss decreased (0.074287 --> 0.073492).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.322063684463501
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0768729  Vali Loss: 0.0751949 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752900  Vali macro F1 0.9642813 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.330153226852417
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0758050  Vali Loss: 0.0758377 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9746727  Vali macro F1 0.9638150 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.331574440002441
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0754607  Vali Loss: 0.0743088 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762440  Vali macro F1 0.9653092 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.328088045120239
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0754829  Vali Loss: 0.0752863 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9748066  Vali macro F1 0.9638284 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.332547187805176
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0760033  Vali Loss: 0.0737935 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9757959  Vali macro F1 0.9649128 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.336939573287964
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0732485  Vali Loss: 0.0735283 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9757637  Vali macro F1 0.9648580 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.353277683258057
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0726609  Vali Loss: 0.0738272 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.3362040519714355
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0724396  Vali Loss: 0.0727665 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9756950  Vali macro F1 0.9647231 
new best score!!!!
Validation loss decreased (0.073492 --> 0.072766).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.334903240203857
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0708953  Vali Loss: 0.0734201 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9757746  Vali macro F1 0.9647573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.3220648765563965
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0719399  Vali Loss: 0.0730643 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747575  Vali macro F1 0.9636325 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.326365947723389
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0709806  Vali Loss: 0.0737836 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.3283305168151855
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0746946  Vali Loss: 0.0734607 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9767657  Vali macro F1 0.9658663 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.328218936920166
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0731046  Vali Loss: 0.0739719 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 6.357325077056885
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0735761  Vali Loss: 0.0740183 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.347827434539795
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0730185  Vali Loss: 0.0740095 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.336763143539429
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0729165  Vali Loss: 0.0739675 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.334223747253418
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0712826  Vali Loss: 0.0739366 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.322517156600952
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0740397  Vali Loss: 0.0738847 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 33 cost time: 6.325777053833008
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0718579  Vali Loss: 0.0738732 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.334378480911255
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0714701  Vali Loss: 0.0738575 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.323495388031006
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0739740  Vali Loss: 0.0738607 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.337947368621826
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0726662  Vali Loss: 0.0738566 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.350999355316162
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0731821  Vali Loss: 0.0738465 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762805  Vali macro F1 0.9653889 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7449704  Test weighted F1: 0.7492661  Test macro F1 0.7490537 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014641 0.00017768 0.00108108 0.00133156 0.0005     0.00062461]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.177667140960693
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.3665604  Vali Loss: 0.8914287 Vali Accuracy: 0.6818874  Vali weighted F1: 0.5720836  Vali macro F1 0.2778636 
Validation loss decreased (inf --> 0.891429).  Saving model ...
Epoch: 2 cost time: 6.159528970718384
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.7734642  Vali Loss: 0.6928854 Vali Accuracy: 0.7473364  Vali weighted F1: 0.6796769  Vali macro F1 0.4531016 
new best score!!!!
Validation loss decreased (0.891429 --> 0.692885).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.149787425994873
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6205249  Vali Loss: 0.5948510 Vali Accuracy: 0.7650939  Vali weighted F1: 0.7116575  Vali macro F1 0.4960376 
new best score!!!!
Validation loss decreased (0.692885 --> 0.594851).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.1525585651397705
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5518586  Vali Loss: 0.4858695 Vali Accuracy: 0.8330797  Vali weighted F1: 0.7957799  Vali macro F1 0.7337059 
new best score!!!!
Validation loss decreased (0.594851 --> 0.485869).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.16307520866394
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4354100  Vali Loss: 0.3772995 Vali Accuracy: 0.8833080  Vali weighted F1: 0.8726075  Vali macro F1 0.8399312 
new best score!!!!
Validation loss decreased (0.485869 --> 0.377299).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.171158075332642
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3456476  Vali Loss: 0.3009862 Vali Accuracy: 0.9051243  Vali weighted F1: 0.9001277  Vali macro F1 0.8782928 
new best score!!!!
Validation loss decreased (0.377299 --> 0.300986).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.166279554367065
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2952560  Vali Loss: 0.2394396 Vali Accuracy: 0.9294774  Vali weighted F1: 0.9274811  Vali macro F1 0.9085292 
new best score!!!!
Validation loss decreased (0.300986 --> 0.239440).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.162805795669556
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2640829  Vali Loss: 0.2385335 Vali Accuracy: 0.9264333  Vali weighted F1: 0.9236498  Vali macro F1 0.9036009 
new best score!!!!
Validation loss decreased (0.239440 --> 0.238534).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.17833948135376
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2412563  Vali Loss: 0.2042104 Vali Accuracy: 0.9401319  Vali weighted F1: 0.9387685  Vali macro F1 0.9213702 
new best score!!!!
Validation loss decreased (0.238534 --> 0.204210).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 8.3532874584198
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2307865  Vali Loss: 0.2232108 Vali Accuracy: 0.9325216  Vali weighted F1: 0.9320344  Vali macro F1 0.9125845 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.1946022510528564
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2178507  Vali Loss: 0.2092163 Vali Accuracy: 0.9330289  Vali weighted F1: 0.9314543  Vali macro F1 0.9151154 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.167842388153076
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.2068770  Vali Loss: 0.1859860 Vali Accuracy: 0.9411466  Vali weighted F1: 0.9403167  Vali macro F1 0.9234336 
new best score!!!!
Validation loss decreased (0.204210 --> 0.185986).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.170912742614746
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1923861  Vali Loss: 0.1850989 Vali Accuracy: 0.9401319  Vali weighted F1: 0.9388769  Vali macro F1 0.9183709 
new best score!!!!
Validation loss decreased (0.185986 --> 0.185099).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.166428565979004
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1914169  Vali Loss: 0.1635064 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9494141  Vali macro F1 0.9350059 
new best score!!!!
Validation loss decreased (0.185099 --> 0.163506).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.178498268127441
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1761781  Vali Loss: 0.1679685 Vali Accuracy: 0.9462202  Vali weighted F1: 0.9459080  Vali macro F1 0.9301885 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.167241334915161
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1724473  Vali Loss: 0.1691088 Vali Accuracy: 0.9477423  Vali weighted F1: 0.9464664  Vali macro F1 0.9314415 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.190062999725342
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1642378  Vali Loss: 0.1756077 Vali Accuracy: 0.9441908  Vali weighted F1: 0.9428585  Vali macro F1 0.9268670 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.1820807456970215
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1618560  Vali Loss: 0.1623525 Vali Accuracy: 0.9502790  Vali weighted F1: 0.9501011  Vali macro F1 0.9361383 
new best score!!!!
Validation loss decreased (0.163506 --> 0.162352).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.175723075866699
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1609952  Vali Loss: 0.1402582 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9611840  Vali macro F1 0.9489036 
new best score!!!!
Validation loss decreased (0.162352 --> 0.140258).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.171042203903198
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1485083  Vali Loss: 0.1634897 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9481334  Vali macro F1 0.9344930 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.174640417098999
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1444277  Vali Loss: 0.1474097 Vali Accuracy: 0.9553526  Vali weighted F1: 0.9548062  Vali macro F1 0.9414328 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.166866779327393
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1554564  Vali Loss: 0.1333763 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9610334  Vali macro F1 0.9489325 
new best score!!!!
Validation loss decreased (0.140258 --> 0.133376).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.173098802566528
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1377559  Vali Loss: 0.1334893 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9592968  Vali macro F1 0.9464820 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.173455715179443
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1372858  Vali Loss: 0.1360447 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9551760  Vali macro F1 0.9403175 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.170846939086914
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1366127  Vali Loss: 0.1290421 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9584896  Vali macro F1 0.9468227 
new best score!!!!
Validation loss decreased (0.133376 --> 0.129042).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.155287981033325
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1237753  Vali Loss: 0.1234803 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9611430  Vali macro F1 0.9479291 
new best score!!!!
Validation loss decreased (0.129042 --> 0.123480).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.187371492385864
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1245417  Vali Loss: 0.1223644 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9595931  Vali macro F1 0.9458984 
new best score!!!!
Validation loss decreased (0.123480 --> 0.122364).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.169238328933716
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1268585  Vali Loss: 0.1294837 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9606622  Vali macro F1 0.9494947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.16122031211853
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1219121  Vali Loss: 0.1123958 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9604714  Vali macro F1 0.9489434 
new best score!!!!
Validation loss decreased (0.122364 --> 0.112396).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.152254581451416
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1234470  Vali Loss: 0.1355386 Vali Accuracy: 0.9533232  Vali weighted F1: 0.9527847  Vali macro F1 0.9371820 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.174285888671875
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1185307  Vali Loss: 0.1141082 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9631407  Vali macro F1 0.9517711 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.157615900039673
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1129030  Vali Loss: 0.1126991 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9607344  Vali macro F1 0.9448994 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.153829097747803
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.1060167  Vali Loss: 0.1086428 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9616493  Vali macro F1 0.9488039 
new best score!!!!
Validation loss decreased (0.112396 --> 0.108643).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.182712078094482
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.1143751  Vali Loss: 0.1122373 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9634156  Vali macro F1 0.9537286 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.165003061294556
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.1019901  Vali Loss: 0.1026272 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9671049  Vali macro F1 0.9572010 
new best score!!!!
Validation loss decreased (0.108643 --> 0.102627).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.181347131729126
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.1049273  Vali Loss: 0.0925451 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9688706  Vali macro F1 0.9576206 
new best score!!!!
Validation loss decreased (0.102627 --> 0.092545).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.188807487487793
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.1076424  Vali Loss: 0.1205531 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9592208  Vali macro F1 0.9381489 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.1617114543914795
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.1020792  Vali Loss: 0.1274266 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9529658  Vali macro F1 0.9398344 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.157678842544556
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0969370  Vali Loss: 0.0855345 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9694965  Vali macro F1 0.9590802 
new best score!!!!
Validation loss decreased (0.092545 --> 0.085534).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.158933162689209
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0933702  Vali Loss: 0.0988250 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9651656  Vali macro F1 0.9530597 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.155252933502197
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0937741  Vali Loss: 0.0934974 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9663601  Vali macro F1 0.9547679 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.1484901905059814
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.1059098  Vali Loss: 0.1115589 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9629847  Vali macro F1 0.9503372 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.147899627685547
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0876173  Vali Loss: 0.0799536 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9701383  Vali macro F1 0.9597126 
new best score!!!!
Validation loss decreased (0.085534 --> 0.079954).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.138412237167358
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0870356  Vali Loss: 0.0790292 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9714453  Vali macro F1 0.9653289 
new best score!!!!
Validation loss decreased (0.079954 --> 0.079029).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.153112173080444
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0852325  Vali Loss: 0.1222387 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9621871  Vali macro F1 0.9533275 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.157228231430054
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0859187  Vali Loss: 0.0691877 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9770842  Vali macro F1 0.9716090 
new best score!!!!
Validation loss decreased (0.079029 --> 0.069188).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.130403518676758
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0879728  Vali Loss: 0.0799441 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9736804  Vali macro F1 0.9677802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.131360054016113
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0826716  Vali Loss: 0.0746628 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9738901  Vali macro F1 0.9687260 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.13147497177124
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0781080  Vali Loss: 0.0790142 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780706  Vali macro F1 0.9729276 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.136174917221069
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0773468  Vali Loss: 0.0683777 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791082  Vali macro F1 0.9724718 
new best score!!!!
Validation loss decreased (0.069188 --> 0.068378).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.1401166915893555
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0756801  Vali Loss: 0.0752117 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771434  Vali macro F1 0.9690900 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.1322340965271
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0793265  Vali Loss: 0.1100094 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9642489  Vali macro F1 0.9526344 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.131850957870483
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0749268  Vali Loss: 0.0655763 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772712  Vali macro F1 0.9728000 
new best score!!!!
Validation loss decreased (0.068378 --> 0.065576).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.141031503677368
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0754128  Vali Loss: 0.0665127 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791173  Vali macro F1 0.9730397 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.160470247268677
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0716330  Vali Loss: 0.0798966 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9749655  Vali macro F1 0.9679634 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.14672327041626
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0688251  Vali Loss: 0.0722206 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9754220  Vali macro F1 0.9685152 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.146939992904663
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0715286  Vali Loss: 0.0667962 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786497  Vali macro F1 0.9727239 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.131166219711304
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0750868  Vali Loss: 0.0860682 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9726433  Vali macro F1 0.9644215 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 59 cost time: 6.13026237487793
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0627457  Vali Loss: 0.0618921 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807206  Vali macro F1 0.9741124 
new best score!!!!
Validation loss decreased (0.065576 --> 0.061892).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.135509252548218
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0592591  Vali Loss: 0.0637033 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781297  Vali macro F1 0.9716895 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.142767906188965
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0588627  Vali Loss: 0.0643017 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781517  Vali macro F1 0.9719462 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.149670839309692
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0591179  Vali Loss: 0.0619129 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812179  Vali macro F1 0.9751357 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.143702983856201
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0562085  Vali Loss: 0.0602321 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797021  Vali macro F1 0.9730201 
new best score!!!!
Validation loss decreased (0.061892 --> 0.060232).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 6.146388530731201
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0572354  Vali Loss: 0.0597508 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807104  Vali macro F1 0.9748900 
new best score!!!!
Validation loss decreased (0.060232 --> 0.059751).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 6.158217906951904
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0572437  Vali Loss: 0.0587040 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822171  Vali macro F1 0.9765768 
new best score!!!!
Validation loss decreased (0.059751 --> 0.058704).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 6.132081031799316
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0583950  Vali Loss: 0.0590223 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811977  Vali macro F1 0.9746995 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.1466710567474365
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0554881  Vali Loss: 0.0607126 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806994  Vali macro F1 0.9741619 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.1472296714782715
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0566245  Vali Loss: 0.0579878 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827234  Vali macro F1 0.9773837 
new best score!!!!
Validation loss decreased (0.058704 --> 0.057988).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 6.145910024642944
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0565137  Vali Loss: 0.0619190 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801734  Vali macro F1 0.9736830 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.144046068191528
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0569073  Vali Loss: 0.0608407 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821943  Vali macro F1 0.9760371 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.13194727897644
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0556533  Vali Loss: 0.0568431 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827195  Vali macro F1 0.9767999 
new best score!!!!
Validation loss decreased (0.057988 --> 0.056843).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 6.143783092498779
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0531131  Vali Loss: 0.0569614 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832308  Vali macro F1 0.9776294 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 6.144327640533447
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0551790  Vali Loss: 0.0620484 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801767  Vali macro F1 0.9737050 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 6.133310556411743
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0554460  Vali Loss: 0.0642026 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791632  Vali macro F1 0.9720975 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 6.124231338500977
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0549854  Vali Loss: 0.0652840 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781102  Vali macro F1 0.9720257 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 6.133860349655151
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0542422  Vali Loss: 0.0595590 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9816123  Vali macro F1 0.9753159 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 77 cost time: 6.132460594177246
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0541507  Vali Loss: 0.0582921 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811696  Vali macro F1 0.9750633 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 6.126066207885742
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0559450  Vali Loss: 0.0578104 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806586  Vali macro F1 0.9742345 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 6.12680721282959
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0536825  Vali Loss: 0.0571962 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806586  Vali macro F1 0.9742345 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 80 cost time: 6.129860162734985
VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0550218  Vali Loss: 0.0572489 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796427  Vali macro F1 0.9726198 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 81 cost time: 6.134340286254883
VALI: Epoch: 81, Steps: 70 | Train Loss: 0.0533450  Vali Loss: 0.0576700 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801698  Vali macro F1 0.9731002 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 82 cost time: 6.1486656665802
VALI: Epoch: 82, Steps: 70 | Train Loss: 0.0547376  Vali Loss: 0.0575732 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806962  Vali macro F1 0.9735791 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 83 cost time: 6.162530183792114
VALI: Epoch: 83, Steps: 70 | Train Loss: 0.0526341  Vali Loss: 0.0575397 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806962  Vali macro F1 0.9735791 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 84 cost time: 6.149805784225464
VALI: Epoch: 84, Steps: 70 | Train Loss: 0.0523659  Vali Loss: 0.0576218 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806962  Vali macro F1 0.9735791 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 85 cost time: 6.125336647033691
VALI: Epoch: 85, Steps: 70 | Train Loss: 0.0551400  Vali Loss: 0.0575860 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806962  Vali macro F1 0.9735791 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 86 cost time: 6.127502679824829
VALI: Epoch: 86, Steps: 70 | Train Loss: 0.0536741  Vali Loss: 0.0575467 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806962  Vali macro F1 0.9735791 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9281310  Test weighted F1: 0.9284030  Test macro F1 0.8693964 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.176589012145996
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0544818  Vali Loss: 0.0602217 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832545  Vali macro F1 0.9776798 
Validation loss decreased (inf --> 0.060222).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.15224814414978
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0554551  Vali Loss: 0.0600737 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806994  Vali macro F1 0.9745013 
new best score!!!!
Validation loss decreased (0.060222 --> 0.060074).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.144254446029663
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0557068  Vali Loss: 0.0583736 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807161  Vali macro F1 0.9735904 
new best score!!!!
Validation loss decreased (0.060074 --> 0.058374).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.144338846206665
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0536126  Vali Loss: 0.0565348 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821842  Vali macro F1 0.9753472 
new best score!!!!
Validation loss decreased (0.058374 --> 0.056535).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.161870956420898
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0558834  Vali Loss: 0.0579162 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811297  Vali macro F1 0.9742321 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.170565366744995
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0555887  Vali Loss: 0.0557892 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817066  Vali macro F1 0.9755032 
new best score!!!!
Validation loss decreased (0.056535 --> 0.055789).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.161293268203735
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0536019  Vali Loss: 0.0542676 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827090  Vali macro F1 0.9771565 
new best score!!!!
Validation loss decreased (0.055789 --> 0.054268).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.143838405609131
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0533854  Vali Loss: 0.0601066 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801319  Vali macro F1 0.9737296 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.142305612564087
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0548358  Vali Loss: 0.0611119 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801714  Vali macro F1 0.9734160 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.147418737411499
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0532574  Vali Loss: 0.0561313 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782346  Vali macro F1 0.9709354 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.164691925048828
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0550942  Vali Loss: 0.0555103 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822274  Vali macro F1 0.9764017 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.1613991260528564
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0545007  Vali Loss: 0.0585061 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801991  Vali macro F1 0.9734091 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.159752368927002
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0533895  Vali Loss: 0.0561330 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812255  Vali macro F1 0.9746159 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.164813995361328
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0534732  Vali Loss: 0.0538913 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9816720  Vali macro F1 0.9758326 
new best score!!!!
Validation loss decreased (0.054268 --> 0.053891).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.170721530914307
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0553121  Vali Loss: 0.0572192 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806373  Vali macro F1 0.9742110 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.181320428848267
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0527554  Vali Loss: 0.0526031 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807002  Vali macro F1 0.9731881 
new best score!!!!
Validation loss decreased (0.053891 --> 0.052603).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.162146091461182
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0516056  Vali Loss: 0.0583901 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807172  Vali macro F1 0.9733060 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.169053316116333
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0508451  Vali Loss: 0.0579721 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822402  Vali macro F1 0.9760746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.159538269042969
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0507333  Vali Loss: 0.0583430 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807350  Vali macro F1 0.9748788 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.153084754943848
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0526541  Vali Loss: 0.0548001 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827492  Vali macro F1 0.9758250 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.1552252769470215
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0529219  Vali Loss: 0.0538960 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827231  Vali macro F1 0.9761259 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 6.152707576751709
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0512751  Vali Loss: 0.0544579 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837649  Vali macro F1 0.9774572 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.154594659805298
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0510696  Vali Loss: 0.0542760 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832635  Vali macro F1 0.9770147 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.167416095733643
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0496647  Vali Loss: 0.0545422 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832635  Vali macro F1 0.9770147 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.1642844676971436
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0498539  Vali Loss: 0.0552282 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827598  Vali macro F1 0.9762128 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.181411981582642
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0494335  Vali Loss: 0.0545986 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832635  Vali macro F1 0.9770147 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 6.157833814620972
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0496818  Vali Loss: 0.0544047 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832635  Vali macro F1 0.9770147 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.1551673412323
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0495834  Vali Loss: 0.0544093 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832635  Vali macro F1 0.9770147 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.153463125228882
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0496401  Vali Loss: 0.0542781 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832635  Vali macro F1 0.9770147 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.156551837921143
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0520336  Vali Loss: 0.0542559 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832635  Vali macro F1 0.9770147 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.16457462310791
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0505941  Vali Loss: 0.0542444 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832635  Vali macro F1 0.9770147 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9276709  Test weighted F1: 0.9277910  Test macro F1 0.8690117 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013949 0.00018396 0.00103413 0.00129702 0.00048591 0.00059988]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.280038833618164
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.3602828  Vali Loss: 0.8517831 Vali Accuracy: 0.6867530  Vali weighted F1: 0.5806030  Vali macro F1 0.2789391 
Validation loss decreased (inf --> 0.851783).  Saving model ...
Epoch: 2 cost time: 6.265930891036987
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.7616401  Vali Loss: 0.6331873 Vali Accuracy: 0.7758964  Vali weighted F1: 0.7194748  Vali macro F1 0.5497442 
new best score!!!!
Validation loss decreased (0.851783 --> 0.633187).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.260244846343994
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.5747600  Vali Loss: 0.5019897 Vali Accuracy: 0.8261952  Vali weighted F1: 0.7832808  Vali macro F1 0.6906895 
new best score!!!!
Validation loss decreased (0.633187 --> 0.501990).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.242938041687012
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.4689870  Vali Loss: 0.4073285 Vali Accuracy: 0.8535857  Vali weighted F1: 0.8218955  Vali macro F1 0.7379891 
new best score!!!!
Validation loss decreased (0.501990 --> 0.407328).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.256240606307983
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.4068962  Vali Loss: 0.3933732 Vali Accuracy: 0.8575697  Vali weighted F1: 0.8412993  Vali macro F1 0.7732766 
new best score!!!!
Validation loss decreased (0.407328 --> 0.393373).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.259409666061401
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.3669380  Vali Loss: 0.3383809 Vali Accuracy: 0.8829681  Vali weighted F1: 0.8737380  Vali macro F1 0.8226671 
new best score!!!!
Validation loss decreased (0.393373 --> 0.338381).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.257566213607788
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.3118713  Vali Loss: 0.2657661 Vali Accuracy: 0.9088645  Vali weighted F1: 0.9063627  Vali macro F1 0.8630615 
new best score!!!!
Validation loss decreased (0.338381 --> 0.265766).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.2554099559783936
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2673675  Vali Loss: 0.2658740 Vali Accuracy: 0.9068725  Vali weighted F1: 0.9087776  Vali macro F1 0.8712065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.247327089309692
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2452999  Vali Loss: 0.2082049 Vali Accuracy: 0.9267928  Vali weighted F1: 0.9264762  Vali macro F1 0.8914012 
new best score!!!!
Validation loss decreased (0.265766 --> 0.208205).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.265028476715088
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.2299773  Vali Loss: 0.2133820 Vali Accuracy: 0.9287849  Vali weighted F1: 0.9263524  Vali macro F1 0.8941778 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.2733378410339355
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.2123888  Vali Loss: 0.2007300 Vali Accuracy: 0.9327689  Vali weighted F1: 0.9319770  Vali macro F1 0.9029327 
new best score!!!!
Validation loss decreased (0.208205 --> 0.200730).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.276645660400391
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.2053762  Vali Loss: 0.1928832 Vali Accuracy: 0.9347610  Vali weighted F1: 0.9350742  Vali macro F1 0.9027674 
new best score!!!!
Validation loss decreased (0.200730 --> 0.192883).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.259990692138672
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.2037562  Vali Loss: 0.1796733 Vali Accuracy: 0.9392430  Vali weighted F1: 0.9390023  Vali macro F1 0.9080488 
new best score!!!!
Validation loss decreased (0.192883 --> 0.179673).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.249732494354248
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1967288  Vali Loss: 0.1850481 Vali Accuracy: 0.9382470  Vali weighted F1: 0.9373543  Vali macro F1 0.9081297 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.266639709472656
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1827769  Vali Loss: 0.2182548 Vali Accuracy: 0.9332669  Vali weighted F1: 0.9315801  Vali macro F1 0.9040454 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.260905981063843
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1813199  Vali Loss: 0.1668553 Vali Accuracy: 0.9437251  Vali weighted F1: 0.9432898  Vali macro F1 0.9203448 
new best score!!!!
Validation loss decreased (0.179673 --> 0.166855).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.257642507553101
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1680324  Vali Loss: 0.1681760 Vali Accuracy: 0.9452191  Vali weighted F1: 0.9444594  Vali macro F1 0.9213044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.252299547195435
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1692387  Vali Loss: 0.1554751 Vali Accuracy: 0.9506972  Vali weighted F1: 0.9510845  Vali macro F1 0.9302876 
new best score!!!!
Validation loss decreased (0.166855 --> 0.155475).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.27273964881897
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1570676  Vali Loss: 0.1481775 Vali Accuracy: 0.9501992  Vali weighted F1: 0.9503110  Vali macro F1 0.9284902 
new best score!!!!
Validation loss decreased (0.155475 --> 0.148177).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.276576042175293
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1536601  Vali Loss: 0.1865986 Vali Accuracy: 0.9367530  Vali weighted F1: 0.9390473  Vali macro F1 0.9183700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.2618327140808105
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1624894  Vali Loss: 0.1539998 Vali Accuracy: 0.9506972  Vali weighted F1: 0.9507016  Vali macro F1 0.9322316 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.262745141983032
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1498271  Vali Loss: 0.1477943 Vali Accuracy: 0.9571713  Vali weighted F1: 0.9577013  Vali macro F1 0.9405954 
new best score!!!!
Validation loss decreased (0.148177 --> 0.147794).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.252896785736084
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1556696  Vali Loss: 0.1425382 Vali Accuracy: 0.9566733  Vali weighted F1: 0.9569524  Vali macro F1 0.9392185 
new best score!!!!
Validation loss decreased (0.147794 --> 0.142538).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.261898756027222
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1398083  Vali Loss: 0.1438873 Vali Accuracy: 0.9536853  Vali weighted F1: 0.9540720  Vali macro F1 0.9345330 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.249459981918335
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1314804  Vali Loss: 0.1724441 Vali Accuracy: 0.9412351  Vali weighted F1: 0.9401624  Vali macro F1 0.9073439 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.256588459014893
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1366398  Vali Loss: 0.1423463 Vali Accuracy: 0.9526892  Vali weighted F1: 0.9527832  Vali macro F1 0.9313752 
new best score!!!!
Validation loss decreased (0.142538 --> 0.142346).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.265416145324707
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1342299  Vali Loss: 0.1488476 Vali Accuracy: 0.9521912  Vali weighted F1: 0.9532227  Vali macro F1 0.9346816 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.2691404819488525
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1299154  Vali Loss: 0.1604758 Vali Accuracy: 0.9492032  Vali weighted F1: 0.9495966  Vali macro F1 0.9277999 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.279388904571533
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1246646  Vali Loss: 0.1272161 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9606791  Vali macro F1 0.9433373 
new best score!!!!
Validation loss decreased (0.142346 --> 0.127216).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.266916751861572
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1242000  Vali Loss: 0.1280789 Vali Accuracy: 0.9626494  Vali weighted F1: 0.9626921  Vali macro F1 0.9458200 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.254525661468506
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.1197542  Vali Loss: 0.1312644 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9601502  Vali macro F1 0.9429451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.2472193241119385
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.1143660  Vali Loss: 0.1572092 Vali Accuracy: 0.9521912  Vali weighted F1: 0.9520255  Vali macro F1 0.9303876 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.251258850097656
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.1169432  Vali Loss: 0.1368939 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9586203  Vali macro F1 0.9414916 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.253172397613525
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.1099561  Vali Loss: 0.1397579 Vali Accuracy: 0.9531873  Vali weighted F1: 0.9521019  Vali macro F1 0.9323431 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.254670143127441
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.1017059  Vali Loss: 0.1197576 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9646875  Vali macro F1 0.9480499 
new best score!!!!
Validation loss decreased (0.127216 --> 0.119758).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.270946979522705
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0977388  Vali Loss: 0.1198396 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9648934  Vali macro F1 0.9480988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.2591469287872314
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0946499  Vali Loss: 0.1194522 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9639011  Vali macro F1 0.9479718 
new best score!!!!
Validation loss decreased (0.119758 --> 0.119452).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.260169982910156
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0958641  Vali Loss: 0.1176126 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9644345  Vali macro F1 0.9480615 
new best score!!!!
Validation loss decreased (0.119452 --> 0.117613).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.270719528198242
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0940453  Vali Loss: 0.1174332 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9648429  Vali macro F1 0.9479999 
new best score!!!!
Validation loss decreased (0.117613 --> 0.117433).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.285016298294067
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0924074  Vali Loss: 0.1174043 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9644747  Vali macro F1 0.9477389 
new best score!!!!
Validation loss decreased (0.117433 --> 0.117404).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.27044415473938
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0935423  Vali Loss: 0.1173289 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9634793  Vali macro F1 0.9466614 
new best score!!!!
Validation loss decreased (0.117404 --> 0.117329).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.258794069290161
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0932177  Vali Loss: 0.1159459 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9662640  Vali macro F1 0.9498229 
new best score!!!!
Validation loss decreased (0.117329 --> 0.115946).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.25231671333313
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0950361  Vali Loss: 0.1165927 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9643441  Vali macro F1 0.9477962 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.2564568519592285
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0904898  Vali Loss: 0.1172995 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9632949  Vali macro F1 0.9463925 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.255280256271362
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0934367  Vali Loss: 0.1163672 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9639142  Vali macro F1 0.9473945 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.244248390197754
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0934735  Vali Loss: 0.1154190 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9648485  Vali macro F1 0.9486515 
new best score!!!!
Validation loss decreased (0.115946 --> 0.115419).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.261416912078857
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0911996  Vali Loss: 0.1142009 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9648906  Vali macro F1 0.9479102 
new best score!!!!
Validation loss decreased (0.115419 --> 0.114201).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.261738538742065
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0895958  Vali Loss: 0.1158601 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9648381  Vali macro F1 0.9483040 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.262470006942749
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0896370  Vali Loss: 0.1129179 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9668302  Vali macro F1 0.9512385 
new best score!!!!
Validation loss decreased (0.114201 --> 0.112918).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.255917072296143
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0915759  Vali Loss: 0.1141544 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9648993  Vali macro F1 0.9492311 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.257164239883423
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0930762  Vali Loss: 0.1155524 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9658466  Vali macro F1 0.9500279 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.254578590393066
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0902570  Vali Loss: 0.1149511 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9658953  Vali macro F1 0.9500878 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.249529838562012
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0895226  Vali Loss: 0.1148140 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9659327  Vali macro F1 0.9498430 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.263916015625
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0912632  Vali Loss: 0.1149950 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9650002  Vali macro F1 0.9492266 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 55 cost time: 6.250978469848633
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0879705  Vali Loss: 0.1135751 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663083  Vali macro F1 0.9512928 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.268376588821411
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0890260  Vali Loss: 0.1134993 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9668044  Vali macro F1 0.9513480 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.272026062011719
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0884017  Vali Loss: 0.1134688 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9658184  Vali macro F1 0.9496885 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.2708306312561035
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0878664  Vali Loss: 0.1132552 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9658793  Vali macro F1 0.9497237 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.264338493347168
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0886152  Vali Loss: 0.1131823 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9653884  Vali macro F1 0.9488979 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 60 cost time: 6.252922058105469
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0875109  Vali Loss: 0.1131779 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9658793  Vali macro F1 0.9497237 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.252173900604248
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0868124  Vali Loss: 0.1131856 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9658793  Vali macro F1 0.9497237 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.256791114807129
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0881415  Vali Loss: 0.1131985 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9658793  Vali macro F1 0.9497237 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.2513346672058105
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0896409  Vali Loss: 0.1132508 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9653539  Vali macro F1 0.9491731 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.248252868652344
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0875153  Vali Loss: 0.1132588 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9653754  Vali macro F1 0.9497044 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9303924  Test weighted F1: 0.9307691  Test macro F1 0.9016884 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.303943634033203
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0899730  Vali Loss: 0.1139649 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9647027  Vali macro F1 0.9498014 
Validation loss decreased (inf --> 0.113965).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.394587993621826
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0919731  Vali Loss: 0.1166367 Vali Accuracy: 0.9626494  Vali weighted F1: 0.9630868  Vali macro F1 0.9466320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.260425329208374
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0917794  Vali Loss: 0.1144622 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9653633  Vali macro F1 0.9491634 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.250753879547119
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0865637  Vali Loss: 0.1156654 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9644863  Vali macro F1 0.9480965 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.280508041381836
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0913766  Vali Loss: 0.1198416 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9639439  Vali macro F1 0.9478893 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.251850605010986
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0913032  Vali Loss: 0.1169344 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9668788  Vali macro F1 0.9511938 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.263883113861084
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0887356  Vali Loss: 0.1148030 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9642592  Vali macro F1 0.9481709 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.261764049530029
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0874729  Vali Loss: 0.1143868 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663958  Vali macro F1 0.9502852 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.2592926025390625
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0898829  Vali Loss: 0.1120491 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9648374  Vali macro F1 0.9494706 
new best score!!!!
Validation loss decreased (0.113965 --> 0.112049).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.281689405441284
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0889189  Vali Loss: 0.1145733 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9654765  Vali macro F1 0.9496035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.291497707366943
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0867552  Vali Loss: 0.1123285 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9652347  Vali macro F1 0.9500952 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.323418617248535
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0857872  Vali Loss: 0.1122719 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9662879  Vali macro F1 0.9507029 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.275877237319946
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0871645  Vali Loss: 0.1116804 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9668117  Vali macro F1 0.9517883 
new best score!!!!
Validation loss decreased (0.112049 --> 0.111680).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.274543523788452
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0872848  Vali Loss: 0.1104382 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9659316  Vali macro F1 0.9495435 
new best score!!!!
Validation loss decreased (0.111680 --> 0.110438).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.288364887237549
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0847619  Vali Loss: 0.1102909 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9664101  Vali macro F1 0.9504072 
new best score!!!!
Validation loss decreased (0.110438 --> 0.110291).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.271969795227051
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0836496  Vali Loss: 0.1132667 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9644351  Vali macro F1 0.9476687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.274625301361084
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0844841  Vali Loss: 0.1136268 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9643851  Vali macro F1 0.9475683 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.2800092697143555
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0839867  Vali Loss: 0.1113778 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9662527  Vali macro F1 0.9507335 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.283982276916504
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0850192  Vali Loss: 0.1102555 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9658067  Vali macro F1 0.9505631 
new best score!!!!
Validation loss decreased (0.110291 --> 0.110256).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.302093267440796
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0866397  Vali Loss: 0.1131411 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9641980  Vali macro F1 0.9481355 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.275488376617432
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0830783  Vali Loss: 0.1158334 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9631597  Vali macro F1 0.9472389 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.274370193481445
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0877197  Vali Loss: 0.1121252 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9667877  Vali macro F1 0.9516459 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.273289203643799
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0817352  Vali Loss: 0.1122593 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9662867  Vali macro F1 0.9504849 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.287490606307983
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0841377  Vali Loss: 0.1136098 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9652977  Vali macro F1 0.9499392 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.278141021728516
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0818430  Vali Loss: 0.1109317 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9664197  Vali macro F1 0.9503581 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.274502277374268
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0828504  Vali Loss: 0.1104773 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9672969  Vali macro F1 0.9526449 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.289967060089111
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0804216  Vali Loss: 0.1106452 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9668017  Vali macro F1 0.9510454 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.371355772018433
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0827402  Vali Loss: 0.1110175 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9668537  Vali macro F1 0.9511337 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.279972314834595
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0787858  Vali Loss: 0.1105023 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663345  Vali macro F1 0.9505476 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 6.28810715675354
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0803377  Vali Loss: 0.1104768 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663345  Vali macro F1 0.9505476 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.27708625793457
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0811107  Vali Loss: 0.1104367 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663345  Vali macro F1 0.9505476 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.261945724487305
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0819217  Vali Loss: 0.1103338 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663345  Vali macro F1 0.9505476 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.266880750656128
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0833181  Vali Loss: 0.1103060 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663345  Vali macro F1 0.9505476 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.26838231086731
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0819477  Vali Loss: 0.1102989 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663345  Vali macro F1 0.9505476 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9322767  Test weighted F1: 0.9325818  Test macro F1 0.9051466 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 17919
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014618 0.00018175 0.00097182 0.00121655 0.00048263 0.00061162]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.2342307567596436
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.5166677  Vali Loss: 1.0873402 Vali Accuracy: 0.6636501  Vali weighted F1: 0.5593835  Vali macro F1 0.2700795 
Validation loss decreased (inf --> 1.087340).  Saving model ...
Epoch: 2 cost time: 6.231688976287842
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8647695  Vali Loss: 0.6804097 Vali Accuracy: 0.7657114  Vali weighted F1: 0.7064143  Vali macro F1 0.4849552 
new best score!!!!
Validation loss decreased (1.087340 --> 0.680410).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.2430579662323
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6386698  Vali Loss: 0.5516785 Vali Accuracy: 0.7918552  Vali weighted F1: 0.7487300  Vali macro F1 0.5394683 
new best score!!!!
Validation loss decreased (0.680410 --> 0.551678).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.26587700843811
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5541438  Vali Loss: 0.4770176 Vali Accuracy: 0.8174962  Vali weighted F1: 0.7899223  Vali macro F1 0.5938217 
new best score!!!!
Validation loss decreased (0.551678 --> 0.477018).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.249871253967285
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4671916  Vali Loss: 0.3571483 Vali Accuracy: 0.8612368  Vali weighted F1: 0.8439845  Vali macro F1 0.6540929 
new best score!!!!
Validation loss decreased (0.477018 --> 0.357148).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.252539396286011
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3501657  Vali Loss: 0.2669408 Vali Accuracy: 0.9074912  Vali weighted F1: 0.9044831  Vali macro F1 0.8080199 
new best score!!!!
Validation loss decreased (0.357148 --> 0.266941).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.244811534881592
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2682918  Vali Loss: 0.2137759 Vali Accuracy: 0.9351433  Vali weighted F1: 0.9355196  Vali macro F1 0.9019838 
new best score!!!!
Validation loss decreased (0.266941 --> 0.213776).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.247935771942139
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2160540  Vali Loss: 0.1817469 Vali Accuracy: 0.9446958  Vali weighted F1: 0.9441041  Vali macro F1 0.9169955 
new best score!!!!
Validation loss decreased (0.213776 --> 0.181747).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.227942228317261
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1936757  Vali Loss: 0.1598803 Vali Accuracy: 0.9522373  Vali weighted F1: 0.9522021  Vali macro F1 0.9260755 
new best score!!!!
Validation loss decreased (0.181747 --> 0.159880).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.236425876617432
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1862336  Vali Loss: 0.1627103 Vali Accuracy: 0.9502262  Vali weighted F1: 0.9502894  Vali macro F1 0.9234285 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.233748912811279
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1657730  Vali Loss: 0.1481375 Vali Accuracy: 0.9567622  Vali weighted F1: 0.9567386  Vali macro F1 0.9343372 
new best score!!!!
Validation loss decreased (0.159880 --> 0.148137).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.261286497116089
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1642361  Vali Loss: 0.1431277 Vali Accuracy: 0.9572650  Vali weighted F1: 0.9568383  Vali macro F1 0.9329056 
new best score!!!!
Validation loss decreased (0.148137 --> 0.143128).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.244107246398926
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1497470  Vali Loss: 0.1348346 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9581020  Vali macro F1 0.9328722 
new best score!!!!
Validation loss decreased (0.143128 --> 0.134835).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.2396790981292725
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1472701  Vali Loss: 0.1354978 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9611315  Vali macro F1 0.9386455 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.24365234375
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1437241  Vali Loss: 0.1309087 Vali Accuracy: 0.9587733  Vali weighted F1: 0.9592755  Vali macro F1 0.9356100 
new best score!!!!
Validation loss decreased (0.134835 --> 0.130909).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.235895872116089
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1385855  Vali Loss: 0.1290087 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9620309  Vali macro F1 0.9403509 
new best score!!!!
Validation loss decreased (0.130909 --> 0.129009).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.232642412185669
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1421296  Vali Loss: 0.1313144 Vali Accuracy: 0.9602815  Vali weighted F1: 0.9606536  Vali macro F1 0.9409700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.241633653640747
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1327412  Vali Loss: 0.1507950 Vali Accuracy: 0.9492207  Vali weighted F1: 0.9497809  Vali macro F1 0.9289879 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.235517263412476
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1279239  Vali Loss: 0.1309998 Vali Accuracy: 0.9592760  Vali weighted F1: 0.9598568  Vali macro F1 0.9379537 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.235311269760132
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1236986  Vali Loss: 0.1073135 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9689857  Vali macro F1 0.9503297 
new best score!!!!
Validation loss decreased (0.129009 --> 0.107313).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.248930215835571
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1207782  Vali Loss: 0.1185255 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9662804  Vali macro F1 0.9493365 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.262688159942627
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1231722  Vali Loss: 0.1229384 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9650937  Vali macro F1 0.9429682 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.2360875606536865
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1166043  Vali Loss: 0.1262029 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9624018  Vali macro F1 0.9447767 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.237557888031006
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1145087  Vali Loss: 0.1039109 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9724865  Vali macro F1 0.9569348 
new best score!!!!
Validation loss decreased (0.107313 --> 0.103911).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.224985361099243
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1143839  Vali Loss: 0.1169416 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9649613  Vali macro F1 0.9465870 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.228747606277466
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1045260  Vali Loss: 0.1014875 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9711350  Vali macro F1 0.9558077 
new best score!!!!
Validation loss decreased (0.103911 --> 0.101487).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.232769250869751
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1095515  Vali Loss: 0.1054175 Vali Accuracy: 0.9693313  Vali weighted F1: 0.9696614  Vali macro F1 0.9533936 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.232297420501709
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1052046  Vali Loss: 0.1472979 Vali Accuracy: 0.9537456  Vali weighted F1: 0.9550034  Vali macro F1 0.9354153 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.240094900131226
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1056789  Vali Loss: 0.1125637 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9678079  Vali macro F1 0.9507873 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.272975921630859
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0991885  Vali Loss: 0.1553571 Vali Accuracy: 0.9477124  Vali weighted F1: 0.9476819  Vali macro F1 0.9267874 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.22964334487915
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1035168  Vali Loss: 0.1031753 Vali Accuracy: 0.9693313  Vali weighted F1: 0.9696671  Vali macro F1 0.9533897 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.236737966537476
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0871781  Vali Loss: 0.0883670 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9726233  Vali macro F1 0.9584768 
new best score!!!!
Validation loss decreased (0.101487 --> 0.088367).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.234850645065308
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0856025  Vali Loss: 0.0877733 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9716049  Vali macro F1 0.9554033 
new best score!!!!
Validation loss decreased (0.088367 --> 0.087773).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.244666576385498
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0858775  Vali Loss: 0.0872419 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9736042  Vali macro F1 0.9591560 
new best score!!!!
Validation loss decreased (0.087773 --> 0.087242).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.235395669937134
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0838709  Vali Loss: 0.0827987 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9760081  Vali macro F1 0.9629019 
new best score!!!!
Validation loss decreased (0.087242 --> 0.082799).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.222386360168457
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0838856  Vali Loss: 0.0817277 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769683  Vali macro F1 0.9635720 
new best score!!!!
Validation loss decreased (0.082799 --> 0.081728).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.229156970977783
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0821149  Vali Loss: 0.0811659 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754958  Vali macro F1 0.9621395 
new best score!!!!
Validation loss decreased (0.081728 --> 0.081166).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.247246026992798
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0821519  Vali Loss: 0.0822369 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9740788  Vali macro F1 0.9603975 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.255870819091797
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0825851  Vali Loss: 0.0850773 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9731270  Vali macro F1 0.9591114 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.233399868011475
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0817707  Vali Loss: 0.0797460 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769908  Vali macro F1 0.9643283 
new best score!!!!
Validation loss decreased (0.081166 --> 0.079746).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.232176065444946
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0809188  Vali Loss: 0.0811264 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9765252  Vali macro F1 0.9639047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.230961322784424
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0800241  Vali Loss: 0.0801363 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9760059  Vali macro F1 0.9628007 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.226822853088379
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0813752  Vali Loss: 0.0803764 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754837  Vali macro F1 0.9612353 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.231001853942871
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0785136  Vali Loss: 0.0794104 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9755371  Vali macro F1 0.9620644 
new best score!!!!
Validation loss decreased (0.079746 --> 0.079410).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.226535081863403
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0790683  Vali Loss: 0.0798307 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9744635  Vali macro F1 0.9601560 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.241478681564331
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0797299  Vali Loss: 0.0819815 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9736423  Vali macro F1 0.9600455 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.240757465362549
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0779031  Vali Loss: 0.0783918 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764606  Vali macro F1 0.9634802 
new best score!!!!
Validation loss decreased (0.079410 --> 0.078392).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.263500928878784
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0800524  Vali Loss: 0.0802789 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9740916  Vali macro F1 0.9607191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.238234519958496
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0761104  Vali Loss: 0.0789235 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759961  Vali macro F1 0.9627626 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.23875617980957
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0793275  Vali Loss: 0.0808697 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9741027  Vali macro F1 0.9610611 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.2402708530426025
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0774793  Vali Loss: 0.0785491 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754583  Vali macro F1 0.9621529 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.243829727172852
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0769676  Vali Loss: 0.0801095 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9740398  Vali macro F1 0.9608656 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.246045827865601
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0764334  Vali Loss: 0.0786012 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9755003  Vali macro F1 0.9625582 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.240927219390869
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0753060  Vali Loss: 0.0793144 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750311  Vali macro F1 0.9618216 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.256895303726196
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0741518  Vali Loss: 0.0782287 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759568  Vali macro F1 0.9632599 
new best score!!!!
Validation loss decreased (0.078392 --> 0.078229).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.243935585021973
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0751354  Vali Loss: 0.0784108 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754813  Vali macro F1 0.9627833 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.242116451263428
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0753293  Vali Loss: 0.0791183 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750300  Vali macro F1 0.9618429 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.232060194015503
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0758193  Vali Loss: 0.0779153 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759961  Vali macro F1 0.9633446 
new best score!!!!
Validation loss decreased (0.078229 --> 0.077915).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 6.238409757614136
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0743358  Vali Loss: 0.0783488 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754952  Vali macro F1 0.9625121 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.2408740520477295
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0765506  Vali Loss: 0.0785093 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9755141  Vali macro F1 0.9622870 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 6.237250804901123
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0741862  Vali Loss: 0.0791556 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750311  Vali macro F1 0.9618216 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 6.2377800941467285
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0758578  Vali Loss: 0.0782240 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754952  Vali macro F1 0.9625121 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 6.232695817947388
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0742674  Vali Loss: 0.0785372 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750311  Vali macro F1 0.9618216 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 64 cost time: 6.253201961517334
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0769790  Vali Loss: 0.0784514 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750311  Vali macro F1 0.9618216 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 6.248811960220337
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0731693  Vali Loss: 0.0783320 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 6.239093065261841
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0771544  Vali Loss: 0.0782358 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 6.232274770736694
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0743053  Vali Loss: 0.0783198 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 6.232412815093994
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0745618  Vali Loss: 0.0782443 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 69 cost time: 6.241260766983032
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0748403  Vali Loss: 0.0782450 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.234151363372803
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0750873  Vali Loss: 0.0782458 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.233624696731567
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0764716  Vali Loss: 0.0782530 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.236339330673218
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0736582  Vali Loss: 0.0782448 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.261754274368286
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0766239  Vali Loss: 0.0782308 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750112  Vali macro F1 0.9620453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8283905  Test weighted F1: 0.8431347  Test macro F1 0.8169447 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.243098020553589
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0756887  Vali Loss: 0.0779092 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9755114  Vali macro F1 0.9623761 
Validation loss decreased (inf --> 0.077909).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.199230670928955
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0779619  Vali Loss: 0.0772065 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754749  Vali macro F1 0.9627008 
new best score!!!!
Validation loss decreased (0.077909 --> 0.077207).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.209388494491577
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0749774  Vali Loss: 0.0771590 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9774809  Vali macro F1 0.9684058 
new best score!!!!
Validation loss decreased (0.077207 --> 0.077159).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.212817907333374
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0753324  Vali Loss: 0.0778338 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9770219  Vali macro F1 0.9681589 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.2094151973724365
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0762300  Vali Loss: 0.0785027 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750641  Vali macro F1 0.9622092 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.234529972076416
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0767151  Vali Loss: 0.0773374 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9765191  Vali macro F1 0.9652768 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.2165632247924805
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0748465  Vali Loss: 0.0830703 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9765879  Vali macro F1 0.9695208 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.2324042320251465
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0737738  Vali Loss: 0.0749435 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789358  Vali macro F1 0.9713696 
new best score!!!!
Validation loss decreased (0.077159 --> 0.074943).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.212617635726929
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0746335  Vali Loss: 0.0751312 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9774939  Vali macro F1 0.9691739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.228303670883179
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0707952  Vali Loss: 0.0754240 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9779854  Vali macro F1 0.9696835 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.214246988296509
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0750581  Vali Loss: 0.0761144 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764683  Vali macro F1 0.9671138 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.225910425186157
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0707967  Vali Loss: 0.0748597 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9784825  Vali macro F1 0.9732570 
new best score!!!!
Validation loss decreased (0.074943 --> 0.074860).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.217519521713257
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0733664  Vali Loss: 0.0771587 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9775403  Vali macro F1 0.9707177 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.228388547897339
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0742285  Vali Loss: 0.0761597 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9775606  Vali macro F1 0.9722304 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.2291247844696045
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0728009  Vali Loss: 0.0772353 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795065  Vali macro F1 0.9743541 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.222816228866577
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0709101  Vali Loss: 0.0750500 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9774280  Vali macro F1 0.9683818 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.229001760482788
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0719931  Vali Loss: 0.0742287 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794694  Vali macro F1 0.9745701 
new best score!!!!
Validation loss decreased (0.074860 --> 0.074229).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.241662979125977
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0713707  Vali Loss: 0.0797385 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9770707  Vali macro F1 0.9719728 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.223729610443115
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0713422  Vali Loss: 0.0730099 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804391  Vali macro F1 0.9743702 
new best score!!!!
Validation loss decreased (0.074229 --> 0.073010).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.219794750213623
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0706415  Vali Loss: 0.0744768 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9785086  Vali macro F1 0.9732917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.2143919467926025
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0685849  Vali Loss: 0.0751577 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9780012  Vali macro F1 0.9730685 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.212610483169556
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0688343  Vali Loss: 0.0750976 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794930  Vali macro F1 0.9746150 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.209148645401001
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0699801  Vali Loss: 0.0734318 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799992  Vali macro F1 0.9748408 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.215923547744751
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0700044  Vali Loss: 0.0713802 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814589  Vali macro F1 0.9768334 
new best score!!!!
Validation loss decreased (0.073010 --> 0.071380).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.220389366149902
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0713951  Vali Loss: 0.0725514 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9785029  Vali macro F1 0.9720327 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.2463767528533936
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0677511  Vali Loss: 0.0717763 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799776  Vali macro F1 0.9751236 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.252549409866333
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0678433  Vali Loss: 0.0737041 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9810018  Vali macro F1 0.9764588 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.213181018829346
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0684529  Vali Loss: 0.0709523 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804625  Vali macro F1 0.9744045 
new best score!!!!
Validation loss decreased (0.071380 --> 0.070952).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.2185657024383545
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0675376  Vali Loss: 0.0736003 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9785198  Vali macro F1 0.9734282 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.227035045623779
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0677225  Vali Loss: 0.0725502 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794736  Vali macro F1 0.9745817 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.2133355140686035
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0681965  Vali Loss: 0.0716861 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789273  Vali macro F1 0.9733894 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.217984914779663
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0650289  Vali Loss: 0.0702997 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804740  Vali macro F1 0.9729256 
new best score!!!!
Validation loss decreased (0.070952 --> 0.070300).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.218224048614502
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0664582  Vali Loss: 0.0716840 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789744  Vali macro F1 0.9728482 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.223705291748047
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0685347  Vali Loss: 0.0762368 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9785072  Vali macro F1 0.9713608 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.247999429702759
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0684507  Vali Loss: 0.0704601 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799428  Vali macro F1 0.9741186 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.215814590454102
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0631006  Vali Loss: 0.0703037 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799901  Vali macro F1 0.9753114 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.220505237579346
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0652016  Vali Loss: 0.0723700 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809843  Vali macro F1 0.9768977 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 38 cost time: 6.217308282852173
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0655396  Vali Loss: 0.0698892 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794869  Vali macro F1 0.9733406 
new best score!!!!
Validation loss decreased (0.070300 --> 0.069889).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 6.218744516372681
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0621152  Vali Loss: 0.0728041 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9805078  Vali macro F1 0.9759409 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 6.21954083442688
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0661104  Vali Loss: 0.0703854 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809701  Vali macro F1 0.9764783 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 6.21945595741272
Fine Tuning VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0652033  Vali Loss: 0.0706167 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9815162  Vali macro F1 0.9766994 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 6.214859962463379
Fine Tuning VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0642357  Vali Loss: 0.0697996 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799802  Vali macro F1 0.9733315 
new best score!!!!
Validation loss decreased (0.069889 --> 0.069800).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 43 cost time: 6.244086027145386
Fine Tuning VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0645240  Vali Loss: 0.0705280 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9815083  Vali macro F1 0.9764517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 6.222843170166016
Fine Tuning VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0653051  Vali Loss: 0.0715785 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799969  Vali macro F1 0.9740121 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 6.212379693984985
Fine Tuning VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0610493  Vali Loss: 0.0701153 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9805061  Vali macro F1 0.9742255 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 46 cost time: 6.218186855316162
Fine Tuning VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0640031  Vali Loss: 0.0691593 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9810023  Vali macro F1 0.9753556 
new best score!!!!
Validation loss decreased (0.069800 --> 0.069159).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 47 cost time: 6.228172302246094
Fine Tuning VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0612743  Vali Loss: 0.0695232 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819940  Vali macro F1 0.9769889 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 48 cost time: 6.223873615264893
Fine Tuning VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0620750  Vali Loss: 0.0699315 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819961  Vali macro F1 0.9774206 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 49 cost time: 6.222710847854614
Fine Tuning VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0650144  Vali Loss: 0.0686700 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809540  Vali macro F1 0.9748387 
new best score!!!!
Validation loss decreased (0.069159 --> 0.068670).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 6.243700981140137
Fine Tuning VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0608012  Vali Loss: 0.0710419 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9774672  Vali macro F1 0.9707234 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 51 cost time: 8.842429161071777
Fine Tuning VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0603436  Vali Loss: 0.0712463 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789592  Vali macro F1 0.9713937 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 52 cost time: 6.2298743724823
Fine Tuning VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0620229  Vali Loss: 0.0704956 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799928  Vali macro F1 0.9736206 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 53 cost time: 6.204315900802612
Fine Tuning VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0605948  Vali Loss: 0.0690697 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814912  Vali macro F1 0.9766720 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 54 cost time: 6.19998025894165
Fine Tuning VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0610327  Vali Loss: 0.0706355 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9810053  Vali macro F1 0.9751778 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 55 cost time: 6.197401762008667
Fine Tuning VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0599588  Vali Loss: 0.0686727 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819851  Vali macro F1 0.9761670 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 56 cost time: 6.199227333068848
Fine Tuning VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0580667  Vali Loss: 0.0682503 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819851  Vali macro F1 0.9761670 
new best score!!!!
Validation loss decreased (0.068670 --> 0.068250).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 57 cost time: 6.1967527866363525
Fine Tuning VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0581758  Vali Loss: 0.0684944 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819851  Vali macro F1 0.9761670 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 58 cost time: 6.199502944946289
Fine Tuning VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0590413  Vali Loss: 0.0681224 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824888  Vali macro F1 0.9781454 
new best score!!!!
Validation loss decreased (0.068250 --> 0.068122).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 59 cost time: 6.29020881652832
Fine Tuning VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0588322  Vali Loss: 0.0689320 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819856  Vali macro F1 0.9779036 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 60 cost time: 6.225858688354492
Fine Tuning VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0600843  Vali Loss: 0.0678564 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814943  Vali macro F1 0.9765832 
new best score!!!!
Validation loss decreased (0.068122 --> 0.067856).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 61 cost time: 6.205572605133057
Fine Tuning VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0593920  Vali Loss: 0.0692337 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819897  Vali macro F1 0.9773489 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 62 cost time: 6.208319902420044
Fine Tuning VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0611354  Vali Loss: 0.0679351 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814943  Vali macro F1 0.9765832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 63 cost time: 6.191061496734619
Fine Tuning VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0572123  Vali Loss: 0.0677020 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824888  Vali macro F1 0.9781454 
new best score!!!!
Validation loss decreased (0.067856 --> 0.067702).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 64 cost time: 6.195024728775024
Fine Tuning VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0586617  Vali Loss: 0.0679715 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824888  Vali macro F1 0.9781454 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 65 cost time: 6.196349382400513
Fine Tuning VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0574956  Vali Loss: 0.0683776 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824888  Vali macro F1 0.9781454 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 66 cost time: 6.200047016143799
Fine Tuning VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0578125  Vali Loss: 0.0686273 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824888  Vali macro F1 0.9781454 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 67 cost time: 6.198965311050415
Fine Tuning VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0579204  Vali Loss: 0.0679700 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814878  Vali macro F1 0.9753857 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 68 cost time: 6.231794118881226
Fine Tuning VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0569563  Vali Loss: 0.0675560 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814943  Vali macro F1 0.9765832 
new best score!!!!
Validation loss decreased (0.067702 --> 0.067556).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 69 cost time: 6.233669757843018
Fine Tuning VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0568028  Vali Loss: 0.0677194 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814878  Vali macro F1 0.9753857 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 70 cost time: 6.20469069480896
Fine Tuning VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0569675  Vali Loss: 0.0679738 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824888  Vali macro F1 0.9781454 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 71 cost time: 6.202330589294434
Fine Tuning VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0594830  Vali Loss: 0.0672317 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809905  Vali macro F1 0.9746048 
new best score!!!!
Validation loss decreased (0.067556 --> 0.067232).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 72 cost time: 6.205096483230591
Fine Tuning VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0591671  Vali Loss: 0.0674750 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809905  Vali macro F1 0.9746048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 73 cost time: 6.203195095062256
Fine Tuning VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0580623  Vali Loss: 0.0683032 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819856  Vali macro F1 0.9779036 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 74 cost time: 6.199743986129761
Fine Tuning VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0564175  Vali Loss: 0.0676947 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809905  Vali macro F1 0.9746048 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 75 cost time: 6.207059144973755
Fine Tuning VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0595868  Vali Loss: 0.0681780 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824888  Vali macro F1 0.9781454 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 76 cost time: 6.229291200637817
Fine Tuning VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0580284  Vali Loss: 0.0675741 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 77 cost time: 6.226288318634033
Fine Tuning VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0575633  Vali Loss: 0.0676322 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 78 cost time: 6.1954076290130615
Fine Tuning VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0571180  Vali Loss: 0.0676099 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 79 cost time: 6.209836006164551
Fine Tuning VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0576029  Vali Loss: 0.0677776 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 80 cost time: 6.204004287719727
Fine Tuning VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0584413  Vali Loss: 0.0677876 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 81 cost time: 6.205477237701416
Fine Tuning VALI: Epoch: 81, Steps: 70 | Train Loss: 0.0570447  Vali Loss: 0.0678040 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 82 cost time: 6.1964733600616455
Fine Tuning VALI: Epoch: 82, Steps: 70 | Train Loss: 0.0572719  Vali Loss: 0.0678053 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 83 cost time: 6.199819803237915
Fine Tuning VALI: Epoch: 83, Steps: 70 | Train Loss: 0.0591749  Vali Loss: 0.0677926 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 84 cost time: 6.199252128601074
Fine Tuning VALI: Epoch: 84, Steps: 70 | Train Loss: 0.0578777  Vali Loss: 0.0677789 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 85 cost time: 6.200796842575073
Fine Tuning VALI: Epoch: 85, Steps: 70 | Train Loss: 0.0578600  Vali Loss: 0.0677774 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 86 cost time: 6.223639249801636
Fine Tuning VALI: Epoch: 86, Steps: 70 | Train Loss: 0.0583385  Vali Loss: 0.0677724 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819915  Vali macro F1 0.9773641 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8279883  Test weighted F1: 0.8428406  Test macro F1 0.8153323 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00015017 0.00018275 0.0010846  0.0013947  0.00050201 0.00062854]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.032672882080078
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.5114191  Vali Loss: 1.0884044 Vali Accuracy: 0.6303784  Vali weighted F1: 0.5352275  Vali macro F1 0.2570119 
Validation loss decreased (inf --> 1.088404).  Saving model ...
Epoch: 2 cost time: 6.019090890884399
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.8573141  Vali Loss: 0.7314184 Vali Accuracy: 0.7454640  Vali weighted F1: 0.6672868  Vali macro F1 0.4405808 
new best score!!!!
Validation loss decreased (1.088404 --> 0.731418).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.023221969604492
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.6658820  Vali Loss: 0.6101478 Vali Accuracy: 0.7698289  Vali weighted F1: 0.7091310  Vali macro F1 0.4922342 
new best score!!!!
Validation loss decreased (0.731418 --> 0.610148).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.032804727554321
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.5870131  Vali Loss: 0.5784918 Vali Accuracy: 0.7734578  Vali weighted F1: 0.7163134  Vali macro F1 0.4991078 
new best score!!!!
Validation loss decreased (0.610148 --> 0.578492).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.040332794189453
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.5440019  Vali Loss: 0.5071453 Vali Accuracy: 0.8242613  Vali weighted F1: 0.7957152  Vali macro F1 0.7208688 
new best score!!!!
Validation loss decreased (0.578492 --> 0.507145).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.037095069885254
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.4903496  Vali Loss: 0.4858082 Vali Accuracy: 0.8335925  Vali weighted F1: 0.8068227  Vali macro F1 0.7383015 
new best score!!!!
Validation loss decreased (0.507145 --> 0.485808).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.053358554840088
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.4183384  Vali Loss: 0.3658142 Vali Accuracy: 0.8724728  Vali weighted F1: 0.8657745  Vali macro F1 0.8097276 
new best score!!!!
Validation loss decreased (0.485808 --> 0.365814).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.04522442817688
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.3308066  Vali Loss: 0.3135652 Vali Accuracy: 0.8958009  Vali weighted F1: 0.8891123  Vali macro F1 0.8513798 
new best score!!!!
Validation loss decreased (0.365814 --> 0.313565).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.031684637069702
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.2750402  Vali Loss: 0.2443583 Vali Accuracy: 0.9191291  Vali weighted F1: 0.9181392  Vali macro F1 0.8878186 
new best score!!!!
Validation loss decreased (0.313565 --> 0.244358).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.038869619369507
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.2352851  Vali Loss: 0.2496602 Vali Accuracy: 0.9170555  Vali weighted F1: 0.9160128  Vali macro F1 0.8824977 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.032194375991821
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.2220680  Vali Loss: 0.2236151 Vali Accuracy: 0.9315708  Vali weighted F1: 0.9313067  Vali macro F1 0.9064805 
new best score!!!!
Validation loss decreased (0.244358 --> 0.223615).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.035105228424072
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.2023497  Vali Loss: 0.1783389 Vali Accuracy: 0.9424572  Vali weighted F1: 0.9421996  Vali macro F1 0.9206006 
new best score!!!!
Validation loss decreased (0.223615 --> 0.178339).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.03489351272583
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1800399  Vali Loss: 0.1948969 Vali Accuracy: 0.9372732  Vali weighted F1: 0.9377365  Vali macro F1 0.9141452 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.036197185516357
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1755578  Vali Loss: 0.1736403 Vali Accuracy: 0.9440124  Vali weighted F1: 0.9442646  Vali macro F1 0.9227409 
new best score!!!!
Validation loss decreased (0.178339 --> 0.173640).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.042050361633301
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1611814  Vali Loss: 0.1394593 Vali Accuracy: 0.9554173  Vali weighted F1: 0.9557790  Vali macro F1 0.9343398 
new best score!!!!
Validation loss decreased (0.173640 --> 0.139459).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.040788412094116
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1589420  Vali Loss: 0.1567939 Vali Accuracy: 0.9481597  Vali weighted F1: 0.9474833  Vali macro F1 0.9285941 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.043899059295654
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1453660  Vali Loss: 0.1447187 Vali Accuracy: 0.9528253  Vali weighted F1: 0.9528754  Vali macro F1 0.9340950 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.034670114517212
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.1484588  Vali Loss: 0.1283902 Vali Accuracy: 0.9580093  Vali weighted F1: 0.9580090  Vali macro F1 0.9409500 
new best score!!!!
Validation loss decreased (0.139459 --> 0.128390).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.025752782821655
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.1432145  Vali Loss: 0.1763811 Vali Accuracy: 0.9419388  Vali weighted F1: 0.9427826  Vali macro F1 0.9201349 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.025728940963745
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.1339818  Vali Loss: 0.1277813 Vali Accuracy: 0.9523069  Vali weighted F1: 0.9518027  Vali macro F1 0.9320151 
new best score!!!!
Validation loss decreased (0.128390 --> 0.127781).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.034209966659546
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.1280313  Vali Loss: 0.1107397 Vali Accuracy: 0.9637118  Vali weighted F1: 0.9638910  Vali macro F1 0.9475560 
new best score!!!!
Validation loss decreased (0.127781 --> 0.110740).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.022709131240845
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.1204204  Vali Loss: 0.1063872 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9647727  Vali macro F1 0.9485241 
new best score!!!!
Validation loss decreased (0.110740 --> 0.106387).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.033267021179199
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.1159417  Vali Loss: 0.1324930 Vali Accuracy: 0.9528253  Vali weighted F1: 0.9536306  Vali macro F1 0.9371104 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.0359697341918945
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.1111612  Vali Loss: 0.1171043 Vali Accuracy: 0.9574909  Vali weighted F1: 0.9575497  Vali macro F1 0.9387708 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.031121730804443
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.1154722  Vali Loss: 0.1253082 Vali Accuracy: 0.9595645  Vali weighted F1: 0.9601204  Vali macro F1 0.9432544 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.050225734710693
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.1106144  Vali Loss: 0.1160390 Vali Accuracy: 0.9600829  Vali weighted F1: 0.9603068  Vali macro F1 0.9408393 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 6.060346364974976
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.1062041  Vali Loss: 0.1898791 Vali Accuracy: 0.9372732  Vali weighted F1: 0.9362851  Vali macro F1 0.9177997 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 6.035213470458984
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0933409  Vali Loss: 0.0939993 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9690104  Vali macro F1 0.9536039 
new best score!!!!
Validation loss decreased (0.106387 --> 0.093999).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.029070854187012
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0896887  Vali Loss: 0.0975517 Vali Accuracy: 0.9663038  Vali weighted F1: 0.9664861  Vali macro F1 0.9504273 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.033722877502441
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0891012  Vali Loss: 0.0970377 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9657597  Vali macro F1 0.9497431 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.033393859863281
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0863975  Vali Loss: 0.0981268 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9647771  Vali macro F1 0.9478699 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.0307676792144775
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0891032  Vali Loss: 0.0985070 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9642489  Vali macro F1 0.9478836 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.039616346359253
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0841231  Vali Loss: 0.0960441 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9669145  Vali macro F1 0.9502736 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 6.030507326126099
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0866489  Vali Loss: 0.0965501 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9674880  Vali macro F1 0.9516974 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.043570518493652
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0832360  Vali Loss: 0.0962751 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9669459  Vali macro F1 0.9511072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.054666996002197
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0853058  Vali Loss: 0.0951485 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9674880  Vali macro F1 0.9516974 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.032797574996948
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0828883  Vali Loss: 0.0953252 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9674880  Vali macro F1 0.9516974 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.032912015914917
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0838797  Vali Loss: 0.0938630 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9684796  Vali macro F1 0.9527041 
new best score!!!!
Validation loss decreased (0.093999 --> 0.093863).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.034376621246338
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0848133  Vali Loss: 0.0943445 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9674880  Vali macro F1 0.9516974 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.022461891174316
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0842846  Vali Loss: 0.0944348 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9674880  Vali macro F1 0.9516974 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.024136304855347
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0843934  Vali Loss: 0.0954906 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680009  Vali macro F1 0.9525273 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.030012607574463
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0846998  Vali Loss: 0.0960087 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9675053  Vali macro F1 0.9521487 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.026167392730713
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0839373  Vali Loss: 0.0952847 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.03317666053772
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0844657  Vali Loss: 0.0950608 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.0493786334991455
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0834872  Vali Loss: 0.0949186 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.040075778961182
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0850810  Vali Loss: 0.0946632 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.054678916931152
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0853531  Vali Loss: 0.0948570 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.032308578491211
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0855218  Vali Loss: 0.0949840 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 49 cost time: 6.260815620422363
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0833475  Vali Loss: 0.0949375 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.02045750617981
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0849551  Vali Loss: 0.0949294 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.021249532699585
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0847458  Vali Loss: 0.0949112 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.035220623016357
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0827669  Vali Loss: 0.0949137 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.026094913482666
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0833685  Vali Loss: 0.0948806 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680169  Vali macro F1 0.9529765 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9443332  Test weighted F1: 0.9457421  Test macro F1 0.9184885 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.108001947402954
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0861324  Vali Loss: 0.0956439 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9675001  Vali macro F1 0.9521354 
Validation loss decreased (inf --> 0.095644).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.027165412902832
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0853688  Vali Loss: 0.1017527 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9648407  Vali macro F1 0.9490135 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.035732984542847
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0834552  Vali Loss: 0.0904943 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9690998  Vali macro F1 0.9533208 
new best score!!!!
Validation loss decreased (0.095644 --> 0.090494).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.023960828781128
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0846405  Vali Loss: 0.0901686 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9733035  Vali macro F1 0.9580889 
new best score!!!!
Validation loss decreased (0.090494 --> 0.090169).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.033754110336304
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0813776  Vali Loss: 0.0929851 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9690960  Vali macro F1 0.9537488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.044456720352173
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0813880  Vali Loss: 0.0964049 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9658578  Vali macro F1 0.9504324 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.043917179107666
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0839125  Vali Loss: 0.0903048 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9727257  Vali macro F1 0.9575595 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.030347585678101
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0811372  Vali Loss: 0.0895586 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9716457  Vali macro F1 0.9565248 
new best score!!!!
Validation loss decreased (0.090169 --> 0.089559).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.035397529602051
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0818599  Vali Loss: 0.0869108 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9737703  Vali macro F1 0.9591274 
new best score!!!!
Validation loss decreased (0.089559 --> 0.086911).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.02084755897522
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0822485  Vali Loss: 0.0942441 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9675652  Vali macro F1 0.9514228 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.048640966415405
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0812021  Vali Loss: 0.0936563 Vali Accuracy: 0.9663038  Vali weighted F1: 0.9664248  Vali macro F1 0.9503983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.047967195510864
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0793564  Vali Loss: 0.0927819 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9675012  Vali macro F1 0.9505412 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.029929876327515
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0782911  Vali Loss: 0.0940854 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680868  Vali macro F1 0.9503058 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.037213563919067
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0795097  Vali Loss: 0.0848872 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726763  Vali macro F1 0.9570608 
new best score!!!!
Validation loss decreased (0.086911 --> 0.084887).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.048025608062744
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0784724  Vali Loss: 0.0886413 Vali Accuracy: 0.9709694  Vali weighted F1: 0.9711577  Vali macro F1 0.9555018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.045865058898926
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0771412  Vali Loss: 0.0946892 Vali Accuracy: 0.9652670  Vali weighted F1: 0.9653676  Vali macro F1 0.9481512 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.034919500350952
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0770849  Vali Loss: 0.0880676 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9705744  Vali macro F1 0.9542357 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.026930809020996
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0766820  Vali Loss: 0.0911549 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9684649  Vali macro F1 0.9527088 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.03689980506897
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0769432  Vali Loss: 0.0917318 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9697010  Vali macro F1 0.9534397 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 20 cost time: 6.056421756744385
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0760828  Vali Loss: 0.0949712 Vali Accuracy: 0.9652670  Vali weighted F1: 0.9653743  Vali macro F1 0.9486760 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.046002388000488
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0769666  Vali Loss: 0.0958790 Vali Accuracy: 0.9637118  Vali weighted F1: 0.9638304  Vali macro F1 0.9465338 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.051024436950684
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0743823  Vali Loss: 0.0991137 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9642869  Vali macro F1 0.9471861 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.040430068969727
Fine Tuning VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0737463  Vali Loss: 0.0892521 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9690970  Vali macro F1 0.9527489 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.0465192794799805
Fine Tuning VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0735937  Vali Loss: 0.0908349 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9701892  Vali macro F1 0.9545476 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.042388677597046
Fine Tuning VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0743208  Vali Loss: 0.0891285 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9696327  Vali macro F1 0.9533092 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.043591260910034
Fine Tuning VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0719496  Vali Loss: 0.0886288 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9706359  Vali macro F1 0.9546120 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.0483245849609375
Fine Tuning VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0722635  Vali Loss: 0.0887119 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9706359  Vali macro F1 0.9546120 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.035102844238281
Fine Tuning VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0715481  Vali Loss: 0.0886457 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9706359  Vali macro F1 0.9546120 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.047025680541992
Fine Tuning VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0727319  Vali Loss: 0.0892373 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9695584  Vali macro F1 0.9534477 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9471820  Test weighted F1: 0.9486229  Test macro F1 0.9216751 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014843 0.00018235 0.00095238 0.00126904 0.00049925 0.00061652]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.401872634887695
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.5157701  Vali Loss: 1.0663080 Vali Accuracy: 0.6508906  Vali weighted F1: 0.5491190  Vali macro F1 0.2675259 
Validation loss decreased (inf --> 1.066308).  Saving model ...
Epoch: 2 cost time: 6.160903692245483
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8702903  Vali Loss: 0.6779724 Vali Accuracy: 0.7735369  Vali weighted F1: 0.7119772  Vali macro F1 0.4906022 
new best score!!!!
Validation loss decreased (1.066308 --> 0.677972).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.135668516159058
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6427195  Vali Loss: 0.5699867 Vali Accuracy: 0.7806616  Vali weighted F1: 0.7223222  Vali macro F1 0.5036906 
new best score!!!!
Validation loss decreased (0.677972 --> 0.569987).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.139169454574585
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5758908  Vali Loss: 0.5289975 Vali Accuracy: 0.7908397  Vali weighted F1: 0.7351941  Vali macro F1 0.5199888 
new best score!!!!
Validation loss decreased (0.569987 --> 0.528997).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.138216495513916
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4989033  Vali Loss: 0.4480578 Vali Accuracy: 0.8167939  Vali weighted F1: 0.7785712  Vali macro F1 0.5766394 
new best score!!!!
Validation loss decreased (0.528997 --> 0.448058).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.143862724304199
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.4350846  Vali Loss: 0.3924382 Vali Accuracy: 0.8681934  Vali weighted F1: 0.8523411  Vali macro F1 0.8016137 
new best score!!!!
Validation loss decreased (0.448058 --> 0.392438).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.139167070388794
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3708794  Vali Loss: 0.3355861 Vali Accuracy: 0.8798982  Vali weighted F1: 0.8703380  Vali macro F1 0.8261065 
new best score!!!!
Validation loss decreased (0.392438 --> 0.335586).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.144312858581543
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.3448762  Vali Loss: 0.3027591 Vali Accuracy: 0.8977099  Vali weighted F1: 0.8913275  Vali macro F1 0.8544624 
new best score!!!!
Validation loss decreased (0.335586 --> 0.302759).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.149758815765381
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.3126179  Vali Loss: 0.2958301 Vali Accuracy: 0.8992366  Vali weighted F1: 0.8928364  Vali macro F1 0.8580246 
new best score!!!!
Validation loss decreased (0.302759 --> 0.295830).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.156750917434692
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2859285  Vali Loss: 0.2469949 Vali Accuracy: 0.9180662  Vali weighted F1: 0.9146778  Vali macro F1 0.8859196 
new best score!!!!
Validation loss decreased (0.295830 --> 0.246995).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.1620707511901855
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2617170  Vali Loss: 0.2154337 Vali Accuracy: 0.9262087  Vali weighted F1: 0.9239948  Vali macro F1 0.8985416 
new best score!!!!
Validation loss decreased (0.246995 --> 0.215434).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.140232086181641
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.2273722  Vali Loss: 0.2087621 Vali Accuracy: 0.9282443  Vali weighted F1: 0.9261193  Vali macro F1 0.9027509 
new best score!!!!
Validation loss decreased (0.215434 --> 0.208762).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.140670299530029
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.2098563  Vali Loss: 0.2074367 Vali Accuracy: 0.9282443  Vali weighted F1: 0.9249155  Vali macro F1 0.9033979 
new best score!!!!
Validation loss decreased (0.208762 --> 0.207437).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1422295570373535
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.2004906  Vali Loss: 0.1761984 Vali Accuracy: 0.9465649  Vali weighted F1: 0.9457807  Vali macro F1 0.9264945 
new best score!!!!
Validation loss decreased (0.207437 --> 0.176198).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.1339805126190186
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1844318  Vali Loss: 0.1658578 Vali Accuracy: 0.9465649  Vali weighted F1: 0.9461544  Vali macro F1 0.9260376 
new best score!!!!
Validation loss decreased (0.176198 --> 0.165858).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.1399664878845215
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1740455  Vali Loss: 0.1976200 Vali Accuracy: 0.9277354  Vali weighted F1: 0.9245279  Vali macro F1 0.9026715 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.137837886810303
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1783041  Vali Loss: 0.1466501 Vali Accuracy: 0.9496183  Vali weighted F1: 0.9495370  Vali macro F1 0.9294893 
new best score!!!!
Validation loss decreased (0.165858 --> 0.146650).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.143274784088135
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1568365  Vali Loss: 0.1348876 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9557463  Vali macro F1 0.9389401 
new best score!!!!
Validation loss decreased (0.146650 --> 0.134888).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.159590005874634
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1600063  Vali Loss: 0.1432334 Vali Accuracy: 0.9501272  Vali weighted F1: 0.9493165  Vali macro F1 0.9317644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.1500890254974365
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1526452  Vali Loss: 0.1536036 Vali Accuracy: 0.9567430  Vali weighted F1: 0.9576607  Vali macro F1 0.9395434 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.135111331939697
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1426142  Vali Loss: 0.1397817 Vali Accuracy: 0.9521628  Vali weighted F1: 0.9513401  Vali macro F1 0.9327972 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.129359245300293
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1345620  Vali Loss: 0.1259387 Vali Accuracy: 0.9603053  Vali weighted F1: 0.9604597  Vali macro F1 0.9459452 
new best score!!!!
Validation loss decreased (0.134888 --> 0.125939).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.136260747909546
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1330021  Vali Loss: 0.1231305 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9653688  Vali macro F1 0.9529787 
new best score!!!!
Validation loss decreased (0.125939 --> 0.123130).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.1398420333862305
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1381961  Vali Loss: 0.1143242 Vali Accuracy: 0.9669211  Vali weighted F1: 0.9672522  Vali macro F1 0.9541694 
new best score!!!!
Validation loss decreased (0.123130 --> 0.114324).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.14877724647522
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1260852  Vali Loss: 0.1305489 Vali Accuracy: 0.9608142  Vali weighted F1: 0.9614768  Vali macro F1 0.9459611 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.150057315826416
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1212620  Vali Loss: 0.1300557 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9612640  Vali macro F1 0.9470700 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.1362974643707275
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1194592  Vali Loss: 0.1083339 Vali Accuracy: 0.9664122  Vali weighted F1: 0.9669062  Vali macro F1 0.9538668 
new best score!!!!
Validation loss decreased (0.114324 --> 0.108334).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.157038688659668
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1189946  Vali Loss: 0.1245795 Vali Accuracy: 0.9577608  Vali weighted F1: 0.9571817  Vali macro F1 0.9414494 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.143420219421387
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1220838  Vali Loss: 0.1072104 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9672635  Vali macro F1 0.9537155 
new best score!!!!
Validation loss decreased (0.108334 --> 0.107210).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.155486106872559
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1131221  Vali Loss: 0.1052325 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9690108  Vali macro F1 0.9573212 
new best score!!!!
Validation loss decreased (0.107210 --> 0.105233).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.140716314315796
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1059896  Vali Loss: 0.0941198 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9713020  Vali macro F1 0.9597877 
new best score!!!!
Validation loss decreased (0.105233 --> 0.094120).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.151505470275879
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1056578  Vali Loss: 0.1352142 Vali Accuracy: 0.9536896  Vali weighted F1: 0.9528958  Vali macro F1 0.9386264 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.144800424575806
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.1078605  Vali Loss: 0.0924574 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722141  Vali macro F1 0.9596719 
new best score!!!!
Validation loss decreased (0.094120 --> 0.092457).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.144137382507324
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0986880  Vali Loss: 0.1018979 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9692886  Vali macro F1 0.9567116 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.146820545196533
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.1120475  Vali Loss: 0.1014757 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9681908  Vali macro F1 0.9553010 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.147230386734009
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0944282  Vali Loss: 0.1090349 Vali Accuracy: 0.9643766  Vali weighted F1: 0.9647336  Vali macro F1 0.9517968 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.151609420776367
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.1174428  Vali Loss: 0.0917144 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9710090  Vali macro F1 0.9569995 
new best score!!!!
Validation loss decreased (0.092457 --> 0.091714).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.167206525802612
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0905054  Vali Loss: 0.0911139 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9741526  Vali macro F1 0.9614830 
new best score!!!!
Validation loss decreased (0.091714 --> 0.091114).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.1500372886657715
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0907957  Vali Loss: 0.0864830 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727806  Vali macro F1 0.9591956 
new best score!!!!
Validation loss decreased (0.091114 --> 0.086483).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.146987676620483
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0896549  Vali Loss: 0.0833845 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757583  Vali macro F1 0.9639487 
new best score!!!!
Validation loss decreased (0.086483 --> 0.083384).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.1384828090667725
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0859421  Vali Loss: 0.0936424 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9704388  Vali macro F1 0.9577128 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.133020639419556
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0837627  Vali Loss: 0.0848946 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9758300  Vali macro F1 0.9669062 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.140042304992676
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0797934  Vali Loss: 0.0762548 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9751356  Vali macro F1 0.9666353 
new best score!!!!
Validation loss decreased (0.083384 --> 0.076255).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.453410625457764
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0799681  Vali Loss: 0.0895287 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727222  Vali macro F1 0.9614330 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.122686862945557
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0867324  Vali Loss: 0.1345013 Vali Accuracy: 0.9562341  Vali weighted F1: 0.9565852  Vali macro F1 0.9413034 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.125104904174805
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0893163  Vali Loss: 0.0883239 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9700282  Vali macro F1 0.9583704 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.141755819320679
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0757911  Vali Loss: 0.0730549 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9746568  Vali macro F1 0.9657552 
new best score!!!!
Validation loss decreased (0.076255 --> 0.073055).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.14650559425354
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0734892  Vali Loss: 0.0919393 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9707324  Vali macro F1 0.9585076 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.125241041183472
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0721270  Vali Loss: 0.0705940 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9787626  Vali macro F1 0.9717193 
new best score!!!!
Validation loss decreased (0.073055 --> 0.070594).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.132309198379517
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0744083  Vali Loss: 0.1084244 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9678536  Vali macro F1 0.9596365 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.117253541946411
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.1047969  Vali Loss: 0.1110363 Vali Accuracy: 0.9664122  Vali weighted F1: 0.9658981  Vali macro F1 0.9586102 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.121878623962402
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0738068  Vali Loss: 0.0721079 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9777509  Vali macro F1 0.9677605 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.144320964813232
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0656366  Vali Loss: 0.0688932 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9808295  Vali macro F1 0.9745521 
new best score!!!!
Validation loss decreased (0.070594 --> 0.068893).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.129051923751831
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0664775  Vali Loss: 0.0705619 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9803224  Vali macro F1 0.9719960 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.130943536758423
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0581354  Vali Loss: 0.0833187 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9760934  Vali macro F1 0.9685502 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.123310327529907
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0640128  Vali Loss: 0.0772848 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9767913  Vali macro F1 0.9690744 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.149697303771973
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0626335  Vali Loss: 0.0707177 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9803666  Vali macro F1 0.9741243 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.127524137496948
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0612397  Vali Loss: 0.0722600 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9782835  Vali macro F1 0.9713574 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 59 cost time: 6.137500762939453
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0505635  Vali Loss: 0.0619236 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823593  Vali macro F1 0.9772983 
new best score!!!!
Validation loss decreased (0.068893 --> 0.061924).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.135202169418335
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0495345  Vali Loss: 0.0607698 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823394  Vali macro F1 0.9772368 
new best score!!!!
Validation loss decreased (0.061924 --> 0.060770).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.135200262069702
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0484682  Vali Loss: 0.0620830 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818618  Vali macro F1 0.9764985 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.120770215988159
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0470964  Vali Loss: 0.0623835 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818618  Vali macro F1 0.9764985 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.131044387817383
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0482495  Vali Loss: 0.0597668 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818034  Vali macro F1 0.9762474 
new best score!!!!
Validation loss decreased (0.060770 --> 0.059767).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 6.1423914432525635
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0473620  Vali Loss: 0.0654337 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9797322  Vali macro F1 0.9717584 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 6.130234003067017
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0464715  Vali Loss: 0.0601011 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9827931  Vali macro F1 0.9771680 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 6.147111415863037
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0485456  Vali Loss: 0.0605220 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833450  Vali macro F1 0.9781922 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 6.1403648853302
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0478600  Vali Loss: 0.0600936 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9843220  Vali macro F1 0.9791424 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 6.141803503036499
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0476706  Vali Loss: 0.0598817 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828115  Vali macro F1 0.9775356 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 69 cost time: 6.137685060501099
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0476821  Vali Loss: 0.0604065 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833304  Vali macro F1 0.9780552 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.134479761123657
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0483031  Vali Loss: 0.0606483 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828331  Vali macro F1 0.9772548 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.13175106048584
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0466396  Vali Loss: 0.0605891 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818324  Vali macro F1 0.9763335 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.141152858734131
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0468897  Vali Loss: 0.0604622 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818109  Vali macro F1 0.9766143 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.136699199676514
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0465958  Vali Loss: 0.0603364 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823296  Vali macro F1 0.9771338 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 74 cost time: 6.133493185043335
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0462003  Vali Loss: 0.0603261 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818109  Vali macro F1 0.9766143 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 6.1414055824279785
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0460466  Vali Loss: 0.0602964 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823108  Vali macro F1 0.9770742 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 6.158767223358154
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0458045  Vali Loss: 0.0603001 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823108  Vali macro F1 0.9770742 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 6.126974582672119
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0479755  Vali Loss: 0.0602951 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818109  Vali macro F1 0.9766143 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 6.146583318710327
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0468053  Vali Loss: 0.0603115 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823108  Vali macro F1 0.9770742 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8703604  Test weighted F1: 0.8781898  Test macro F1 0.8610109 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.188165903091431
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0489526  Vali Loss: 0.0622414 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818563  Vali macro F1 0.9764794 
Validation loss decreased (inf --> 0.062241).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.150313138961792
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0497313  Vali Loss: 0.0595237 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838364  Vali macro F1 0.9789732 
new best score!!!!
Validation loss decreased (0.062241 --> 0.059524).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.131875991821289
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0483851  Vali Loss: 0.0603349 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9843474  Vali macro F1 0.9794602 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.139129400253296
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0474039  Vali Loss: 0.0603700 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818257  Vali macro F1 0.9757190 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.153861045837402
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0471894  Vali Loss: 0.0613841 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823067  Vali macro F1 0.9762228 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.14799427986145
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0462128  Vali Loss: 0.0589128 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823012  Vali macro F1 0.9775193 
new best score!!!!
Validation loss decreased (0.059524 --> 0.058913).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.178698778152466
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0482493  Vali Loss: 0.0594160 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838485  Vali macro F1 0.9786579 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.152896404266357
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0473431  Vali Loss: 0.0593600 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9843474  Vali macro F1 0.9794602 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.1856372356414795
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0480432  Vali Loss: 0.0609858 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833449  Vali macro F1 0.9775032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.168216943740845
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0455429  Vali Loss: 0.0604495 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9807297  Vali macro F1 0.9740686 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.135035753250122
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0449468  Vali Loss: 0.0594751 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833233  Vali macro F1 0.9793331 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.148713111877441
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0457329  Vali Loss: 0.0647035 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9797355  Vali macro F1 0.9715460 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.151923179626465
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0479791  Vali Loss: 0.0613291 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828300  Vali macro F1 0.9767528 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.155072450637817
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0443957  Vali Loss: 0.0589808 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828171  Vali macro F1 0.9786301 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.15600061416626
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0457169  Vali Loss: 0.0609311 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9822923  Vali macro F1 0.9755915 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.163547039031982
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0449697  Vali Loss: 0.0589090 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818109  Vali macro F1 0.9766143 
new best score!!!!
Validation loss decreased (0.058913 --> 0.058909).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.1740381717681885
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0457557  Vali Loss: 0.0583982 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823090  Vali macro F1 0.9771659 
new best score!!!!
Validation loss decreased (0.058909 --> 0.058398).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.164165019989014
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0464481  Vali Loss: 0.0615816 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828484  Vali macro F1 0.9776435 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.1672632694244385
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0443168  Vali Loss: 0.0606948 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9813407  Vali macro F1 0.9758976 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.152446985244751
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0447147  Vali Loss: 0.0584044 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848250  Vali macro F1 0.9805740 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.156644821166992
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0460343  Vali Loss: 0.0624236 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828435  Vali macro F1 0.9771057 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.15597128868103
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0445901  Vali Loss: 0.0573728 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838039  Vali macro F1 0.9797484 
new best score!!!!
Validation loss decreased (0.058398 --> 0.057373).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.167440414428711
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0441833  Vali Loss: 0.0612055 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818222  Vali macro F1 0.9754596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.162994384765625
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0450856  Vali Loss: 0.0577732 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9843408  Vali macro F1 0.9796218 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.157448768615723
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0432414  Vali Loss: 0.0623816 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828371  Vali macro F1 0.9766471 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.173147916793823
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0446777  Vali Loss: 0.0616268 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9808142  Vali macro F1 0.9740743 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.14996337890625
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0453840  Vali Loss: 0.0599769 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838334  Vali macro F1 0.9793133 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 6.172893285751343
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0416307  Vali Loss: 0.0594543 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9843557  Vali macro F1 0.9794931 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.149574518203735
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0408498  Vali Loss: 0.0587326 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838334  Vali macro F1 0.9793133 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.152676105499268
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0421539  Vali Loss: 0.0588335 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838468  Vali macro F1 0.9787589 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.161272287368774
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0425383  Vali Loss: 0.0586271 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838468  Vali macro F1 0.9787589 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.159858703613281
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0422977  Vali Loss: 0.0585571 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833412  Vali macro F1 0.9779356 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 6.146279811859131
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0421717  Vali Loss: 0.0585417 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833412  Vali macro F1 0.9779356 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.165133714675903
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0417123  Vali Loss: 0.0585251 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833412  Vali macro F1 0.9779356 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.16359543800354
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0398036  Vali Loss: 0.0584459 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833412  Vali macro F1 0.9779356 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.166470050811768
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0412833  Vali Loss: 0.0584161 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833412  Vali macro F1 0.9779356 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.169086456298828
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0411169  Vali Loss: 0.0583740 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833412  Vali macro F1 0.9779356 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8544020  Test weighted F1: 0.8636130  Test macro F1 0.8526975 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014899 0.00018302 0.000998   0.00125313 0.00052329 0.00063052]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.069058656692505
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.5024167  Vali Loss: 1.0814678 Vali Accuracy: 0.6282183  Vali weighted F1: 0.5265939  Vali macro F1 0.2585915 
Validation loss decreased (inf --> 1.081468).  Saving model ...
Epoch: 2 cost time: 6.053515195846558
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.8492150  Vali Loss: 0.7264902 Vali Accuracy: 0.7281153  Vali weighted F1: 0.6387998  Vali macro F1 0.4168950 
new best score!!!!
Validation loss decreased (1.081468 --> 0.726490).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.053840637207031
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.6432756  Vali Loss: 0.6724376 Vali Accuracy: 0.7430484  Vali weighted F1: 0.6803309  Vali macro F1 0.4787735 
new best score!!!!
Validation loss decreased (0.726490 --> 0.672438).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.054629564285278
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.5432171  Vali Loss: 0.5094012 Vali Accuracy: 0.8311020  Vali weighted F1: 0.7950137  Vali macro F1 0.7345650 
new best score!!!!
Validation loss decreased (0.672438 --> 0.509401).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.074646472930908
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.4340517  Vali Loss: 0.4228496 Vali Accuracy: 0.8573635  Vali weighted F1: 0.8429457  Vali macro F1 0.8031165 
new best score!!!!
Validation loss decreased (0.509401 --> 0.422850).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.061015367507935
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.3628391  Vali Loss: 0.3433469 Vali Accuracy: 0.8918641  Vali weighted F1: 0.8863918  Vali macro F1 0.8542951 
new best score!!!!
Validation loss decreased (0.422850 --> 0.343347).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.077712535858154
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.3126742  Vali Loss: 0.2900639 Vali Accuracy: 0.8964985  Vali weighted F1: 0.8961637  Vali macro F1 0.8669127 
new best score!!!!
Validation loss decreased (0.343347 --> 0.290064).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.087952375411987
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.2662633  Vali Loss: 0.2526356 Vali Accuracy: 0.9201854  Vali weighted F1: 0.9191931  Vali macro F1 0.8919570 
new best score!!!!
Validation loss decreased (0.290064 --> 0.252636).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.05640721321106
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.2454139  Vali Loss: 0.2468975 Vali Accuracy: 0.9181256  Vali weighted F1: 0.9161125  Vali macro F1 0.8924801 
new best score!!!!
Validation loss decreased (0.252636 --> 0.246897).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.059852600097656
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.2212140  Vali Loss: 0.2801434 Vali Accuracy: 0.9129763  Vali weighted F1: 0.9126976  Vali macro F1 0.8889603 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.048184156417847
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.2084972  Vali Loss: 0.2175155 Vali Accuracy: 0.9304840  Vali weighted F1: 0.9304049  Vali macro F1 0.9090513 
new best score!!!!
Validation loss decreased (0.246897 --> 0.217515).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.050454378128052
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1941621  Vali Loss: 0.2185564 Vali Accuracy: 0.9356334  Vali weighted F1: 0.9363675  Vali macro F1 0.9201218 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.040583610534668
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1899028  Vali Loss: 0.1827280 Vali Accuracy: 0.9428424  Vali weighted F1: 0.9420220  Vali macro F1 0.9278161 
new best score!!!!
Validation loss decreased (0.217515 --> 0.182728).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.0611207485198975
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1801313  Vali Loss: 0.1866950 Vali Accuracy: 0.9382080  Vali weighted F1: 0.9376130  Vali macro F1 0.9192513 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.051771879196167
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1760139  Vali Loss: 0.1665221 Vali Accuracy: 0.9454171  Vali weighted F1: 0.9442876  Vali macro F1 0.9289827 
new best score!!!!
Validation loss decreased (0.182728 --> 0.166522).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.069099187850952
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1701802  Vali Loss: 0.1680105 Vali Accuracy: 0.9459320  Vali weighted F1: 0.9449248  Vali macro F1 0.9281869 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.065035820007324
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1637493  Vali Loss: 0.2034579 Vali Accuracy: 0.9309990  Vali weighted F1: 0.9284395  Vali macro F1 0.9081475 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.051651954650879
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.1598094  Vali Loss: 0.1515258 Vali Accuracy: 0.9443872  Vali weighted F1: 0.9441948  Vali macro F1 0.9266664 
new best score!!!!
Validation loss decreased (0.166522 --> 0.151526).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.069398403167725
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.1505749  Vali Loss: 0.1605917 Vali Accuracy: 0.9443872  Vali weighted F1: 0.9437306  Vali macro F1 0.9267892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.040106296539307
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.1494357  Vali Loss: 0.1621081 Vali Accuracy: 0.9433574  Vali weighted F1: 0.9435234  Vali macro F1 0.9279056 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.043833255767822
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.1465182  Vali Loss: 0.1469225 Vali Accuracy: 0.9474768  Vali weighted F1: 0.9476926  Vali macro F1 0.9301549 
new best score!!!!
Validation loss decreased (0.151526 --> 0.146923).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.050217866897583
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.1384385  Vali Loss: 0.1418628 Vali Accuracy: 0.9510814  Vali weighted F1: 0.9504976  Vali macro F1 0.9345245 
new best score!!!!
Validation loss decreased (0.146923 --> 0.141863).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.048513889312744
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.1286506  Vali Loss: 0.1540237 Vali Accuracy: 0.9485067  Vali weighted F1: 0.9477941  Vali macro F1 0.9348785 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.042612314224243
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.1244549  Vali Loss: 0.1387342 Vali Accuracy: 0.9505664  Vali weighted F1: 0.9511080  Vali macro F1 0.9367067 
new best score!!!!
Validation loss decreased (0.141863 --> 0.138734).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.055359363555908
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.1198228  Vali Loss: 0.1497853 Vali Accuracy: 0.9500515  Vali weighted F1: 0.9502115  Vali macro F1 0.9367025 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.0702223777771
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.1177248  Vali Loss: 0.1235191 Vali Accuracy: 0.9567456  Vali weighted F1: 0.9567853  Vali macro F1 0.9437122 
new best score!!!!
Validation loss decreased (0.138734 --> 0.123519).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.081071853637695
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.1106484  Vali Loss: 0.1183918 Vali Accuracy: 0.9618950  Vali weighted F1: 0.9620080  Vali macro F1 0.9489231 
new best score!!!!
Validation loss decreased (0.123519 --> 0.118392).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.074420928955078
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.1075221  Vali Loss: 0.1159555 Vali Accuracy: 0.9603502  Vali weighted F1: 0.9603108  Vali macro F1 0.9463864 
new best score!!!!
Validation loss decreased (0.118392 --> 0.115955).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.06423282623291
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.1126818  Vali Loss: 0.1124204 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9654911  Vali macro F1 0.9534429 
new best score!!!!
Validation loss decreased (0.115955 --> 0.112420).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.061307907104492
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.1031706  Vali Loss: 0.1211500 Vali Accuracy: 0.9603502  Vali weighted F1: 0.9602862  Vali macro F1 0.9467947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.061738014221191
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0989003  Vali Loss: 0.1082115 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9686440  Vali macro F1 0.9577892 
new best score!!!!
Validation loss decreased (0.112420 --> 0.108211).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.0698792934417725
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.1004145  Vali Loss: 0.1138749 Vali Accuracy: 0.9598352  Vali weighted F1: 0.9592514  Vali macro F1 0.9471031 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.062248468399048
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.1002695  Vali Loss: 0.1077292 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9631871  Vali macro F1 0.9502107 
new best score!!!!
Validation loss decreased (0.108211 --> 0.107729).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.055671691894531
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0909309  Vali Loss: 0.1050049 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9631906  Vali macro F1 0.9495351 
new best score!!!!
Validation loss decreased (0.107729 --> 0.105005).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.05553674697876
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0935243  Vali Loss: 0.1029655 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9648958  Vali macro F1 0.9511922 
new best score!!!!
Validation loss decreased (0.105005 --> 0.102966).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.07332706451416
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0903351  Vali Loss: 0.0992215 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9648557  Vali macro F1 0.9516914 
new best score!!!!
Validation loss decreased (0.102966 --> 0.099222).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.082972049713135
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0859404  Vali Loss: 0.0952022 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9683425  Vali macro F1 0.9572684 
new best score!!!!
Validation loss decreased (0.099222 --> 0.095202).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.068835973739624
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0812197  Vali Loss: 0.0929285 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9695627  Vali macro F1 0.9586924 
new best score!!!!
Validation loss decreased (0.095202 --> 0.092929).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.069521903991699
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0828624  Vali Loss: 0.1068077 Vali Accuracy: 0.9603502  Vali weighted F1: 0.9608498  Vali macro F1 0.9460475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.067215204238892
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0793211  Vali Loss: 0.0894033 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9710696  Vali macro F1 0.9610495 
new best score!!!!
Validation loss decreased (0.092929 --> 0.089403).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.064801931381226
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0775383  Vali Loss: 0.0836800 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9722272  Vali macro F1 0.9620443 
new best score!!!!
Validation loss decreased (0.089403 --> 0.083680).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.0860583782196045
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0785016  Vali Loss: 0.1100696 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9658546  Vali macro F1 0.9551850 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.054844617843628
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0850344  Vali Loss: 0.0872059 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9686801  Vali macro F1 0.9558907 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.0528342723846436
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0761586  Vali Loss: 0.0930866 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9702843  Vali macro F1 0.9585676 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.068929195404053
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0713363  Vali Loss: 0.0823062 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9738148  Vali macro F1 0.9664750 
new best score!!!!
Validation loss decreased (0.083680 --> 0.082306).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.084131479263306
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0693751  Vali Loss: 0.0873897 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9709464  Vali macro F1 0.9607913 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.064098358154297
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0693971  Vali Loss: 0.0999028 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9706045  Vali macro F1 0.9623028 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.05254864692688
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0657281  Vali Loss: 0.0845495 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9732243  Vali macro F1 0.9672823 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.053195476531982
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0697759  Vali Loss: 0.0932266 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719711  Vali macro F1 0.9639441 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.059140205383301
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0671639  Vali Loss: 0.0737374 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9774686  Vali macro F1 0.9715819 
new best score!!!!
Validation loss decreased (0.082306 --> 0.073737).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.057218551635742
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0643719  Vali Loss: 0.0816958 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9715625  Vali macro F1 0.9642634 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.063930034637451
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0711813  Vali Loss: 0.0796283 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9739605  Vali macro F1 0.9666502 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.064640045166016
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0639649  Vali Loss: 0.0993256 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9694888  Vali macro F1 0.9621507 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.076815843582153
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0593030  Vali Loss: 0.0719552 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9778906  Vali macro F1 0.9718014 
new best score!!!!
Validation loss decreased (0.073737 --> 0.071955).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.083235502243042
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0639372  Vali Loss: 0.0803204 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9775610  Vali macro F1 0.9734930 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.055227279663086
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0578294  Vali Loss: 0.0817793 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9755126  Vali macro F1 0.9701666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.052249193191528
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0549242  Vali Loss: 0.0730850 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9775267  Vali macro F1 0.9722386 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.055077075958252
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0587415  Vali Loss: 0.0799667 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9749835  Vali macro F1 0.9663432 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.055951833724976
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0524698  Vali Loss: 0.0953720 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9682723  Vali macro F1 0.9597968 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 60 cost time: 6.06422233581543
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0476845  Vali Loss: 0.0735794 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9779496  Vali macro F1 0.9730657 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.0564563274383545
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0455660  Vali Loss: 0.0693673 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789813  Vali macro F1 0.9733874 
new best score!!!!
Validation loss decreased (0.071955 --> 0.069367).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.048534870147705
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0428293  Vali Loss: 0.0703134 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9774319  Vali macro F1 0.9712902 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.054617166519165
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0429627  Vali Loss: 0.0707267 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9779434  Vali macro F1 0.9720359 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.071626424789429
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0448912  Vali Loss: 0.0702220 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784566  Vali macro F1 0.9728372 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.092521667480469
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0418004  Vali Loss: 0.0685799 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795219  Vali macro F1 0.9742479 
new best score!!!!
Validation loss decreased (0.069367 --> 0.068580).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 6.073774337768555
VALI: Epoch: 66, Steps: 69 | Train Loss: 0.0440511  Vali Loss: 0.0688223 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805265  Vali macro F1 0.9755884 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.050760984420776
VALI: Epoch: 67, Steps: 69 | Train Loss: 0.0432096  Vali Loss: 0.0691252 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795083  Vali macro F1 0.9739999 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.060774564743042
VALI: Epoch: 68, Steps: 69 | Train Loss: 0.0427459  Vali Loss: 0.0704373 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9790063  Vali macro F1 0.9732777 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.047111988067627
VALI: Epoch: 69, Steps: 69 | Train Loss: 0.0435862  Vali Loss: 0.0683821 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794890  Vali macro F1 0.9742848 
new best score!!!!
Validation loss decreased (0.068580 --> 0.068382).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 6.054014444351196
VALI: Epoch: 70, Steps: 69 | Train Loss: 0.0417117  Vali Loss: 0.0678749 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805242  Vali macro F1 0.9755907 
new best score!!!!
Validation loss decreased (0.068382 --> 0.067875).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 6.054029226303101
VALI: Epoch: 71, Steps: 69 | Train Loss: 0.0421869  Vali Loss: 0.0684661 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789819  Vali macro F1 0.9734409 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 6.044692039489746
VALI: Epoch: 72, Steps: 69 | Train Loss: 0.0417848  Vali Loss: 0.0672210 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795094  Vali macro F1 0.9739890 
new best score!!!!
Validation loss decreased (0.067875 --> 0.067221).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 6.066286325454712
VALI: Epoch: 73, Steps: 69 | Train Loss: 0.0424206  Vali Loss: 0.0683705 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789891  Vali macro F1 0.9737778 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 6.07195258140564
VALI: Epoch: 74, Steps: 69 | Train Loss: 0.0414626  Vali Loss: 0.0693152 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800028  Vali macro F1 0.9750339 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 6.058376312255859
VALI: Epoch: 75, Steps: 69 | Train Loss: 0.0405434  Vali Loss: 0.0678715 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795176  Vali macro F1 0.9742874 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 6.047126770019531
VALI: Epoch: 76, Steps: 69 | Train Loss: 0.0401578  Vali Loss: 0.0655591 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9790190  Vali macro F1 0.9737974 
new best score!!!!
Validation loss decreased (0.067221 --> 0.065559).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 6.062131404876709
VALI: Epoch: 77, Steps: 69 | Train Loss: 0.0406840  Vali Loss: 0.0676995 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9780050  Vali macro F1 0.9730396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 6.058798551559448
VALI: Epoch: 78, Steps: 69 | Train Loss: 0.0385356  Vali Loss: 0.0689633 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789154  Vali macro F1 0.9735903 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 6.065216541290283
VALI: Epoch: 79, Steps: 69 | Train Loss: 0.0387375  Vali Loss: 0.0643438 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800203  Vali macro F1 0.9746127 
new best score!!!!
Validation loss decreased (0.065559 --> 0.064344).  Saving model ...
new best score!!!!
Epoch: 80 cost time: 6.057705402374268
VALI: Epoch: 80, Steps: 69 | Train Loss: 0.0404954  Vali Loss: 0.0654549 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799935  Vali macro F1 0.9747934 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 81 cost time: 6.052117586135864
VALI: Epoch: 81, Steps: 69 | Train Loss: 0.0403107  Vali Loss: 0.0673560 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9779930  Vali macro F1 0.9725134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 82 cost time: 6.0524187088012695
VALI: Epoch: 82, Steps: 69 | Train Loss: 0.0399414  Vali Loss: 0.0664726 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784835  Vali macro F1 0.9729315 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 83 cost time: 6.064897298812866
VALI: Epoch: 83, Steps: 69 | Train Loss: 0.0385778  Vali Loss: 0.0688898 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805282  Vali macro F1 0.9755853 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 84 cost time: 6.062715530395508
VALI: Epoch: 84, Steps: 69 | Train Loss: 0.0408701  Vali Loss: 0.0678916 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800202  Vali macro F1 0.9748388 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 85 cost time: 6.060769319534302
VALI: Epoch: 85, Steps: 69 | Train Loss: 0.0379231  Vali Loss: 0.0669579 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800202  Vali macro F1 0.9748388 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 86 cost time: 6.042324781417847
VALI: Epoch: 86, Steps: 69 | Train Loss: 0.0396082  Vali Loss: 0.0667600 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800202  Vali macro F1 0.9748388 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 87 cost time: 6.052332401275635
VALI: Epoch: 87, Steps: 69 | Train Loss: 0.0390179  Vali Loss: 0.0667720 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800202  Vali macro F1 0.9748388 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 88 cost time: 6.060445070266724
VALI: Epoch: 88, Steps: 69 | Train Loss: 0.0412564  Vali Loss: 0.0665464 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800202  Vali macro F1 0.9748388 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 89 cost time: 6.060734987258911
VALI: Epoch: 89, Steps: 69 | Train Loss: 0.0378884  Vali Loss: 0.0669759 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800189  Vali macro F1 0.9747904 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 90 cost time: 6.064127206802368
VALI: Epoch: 90, Steps: 69 | Train Loss: 0.0396318  Vali Loss: 0.0670221 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800189  Vali macro F1 0.9747904 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 91 cost time: 6.044722557067871
VALI: Epoch: 91, Steps: 69 | Train Loss: 0.0368302  Vali Loss: 0.0669853 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800189  Vali macro F1 0.9747904 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 92 cost time: 6.060693740844727
VALI: Epoch: 92, Steps: 69 | Train Loss: 0.0409276  Vali Loss: 0.0670300 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800202  Vali macro F1 0.9748388 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 93 cost time: 6.064753770828247
VALI: Epoch: 93, Steps: 69 | Train Loss: 0.0386677  Vali Loss: 0.0669695 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800202  Vali macro F1 0.9748388 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 94 cost time: 6.074307680130005
VALI: Epoch: 94, Steps: 69 | Train Loss: 0.0401339  Vali Loss: 0.0669471 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800189  Vali macro F1 0.9747904 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9591522  Test weighted F1: 0.9571975  Test macro F1 0.9406508 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.0805442333221436
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0412967  Vali Loss: 0.0671280 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789798  Vali macro F1 0.9734904 
Validation loss decreased (inf --> 0.067128).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.058146953582764
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0396540  Vali Loss: 0.0670053 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9779480  Vali macro F1 0.9721745 
new best score!!!!
Validation loss decreased (0.067128 --> 0.067005).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.050259828567505
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0406908  Vali Loss: 0.0698465 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789970  Vali macro F1 0.9737925 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.0484137535095215
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0417740  Vali Loss: 0.0677366 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805572  Vali macro F1 0.9756496 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.067742109298706
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0422388  Vali Loss: 0.0678635 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794936  Vali macro F1 0.9742796 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.083304405212402
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0391539  Vali Loss: 0.0664572 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800182  Vali macro F1 0.9748882 
new best score!!!!
Validation loss decreased (0.067005 --> 0.066457).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.075000524520874
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0411187  Vali Loss: 0.0669760 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800653  Vali macro F1 0.9753734 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.085718154907227
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0385949  Vali Loss: 0.0673658 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805265  Vali macro F1 0.9755884 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.086216688156128
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0391714  Vali Loss: 0.0703069 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800198  Vali macro F1 0.9747456 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.062910556793213
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0392860  Vali Loss: 0.0679601 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805452  Vali macro F1 0.9753025 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.064686298370361
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0382441  Vali Loss: 0.0675254 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805465  Vali macro F1 0.9753449 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.068606853485107
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0384183  Vali Loss: 0.0671632 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794925  Vali macro F1 0.9742378 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.074537515640259
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0382842  Vali Loss: 0.0651058 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9790034  Vali macro F1 0.9733040 
new best score!!!!
Validation loss decreased (0.066457 --> 0.065106).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.078730344772339
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0387918  Vali Loss: 0.0671939 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795294  Vali macro F1 0.9736246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.070638656616211
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0387569  Vali Loss: 0.0668555 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9774503  Vali macro F1 0.9711553 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.076587438583374
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0381610  Vali Loss: 0.0680927 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795072  Vali macro F1 0.9739394 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.080104827880859
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0365721  Vali Loss: 0.0692900 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9790144  Vali macro F1 0.9734978 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.081955671310425
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0383843  Vali Loss: 0.0679690 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9785043  Vali macro F1 0.9727076 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.063671827316284
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0342595  Vali Loss: 0.0670665 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784985  Vali macro F1 0.9726444 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.052802801132202
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0359226  Vali Loss: 0.0663818 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795274  Vali macro F1 0.9737603 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.071108818054199
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0370912  Vali Loss: 0.0670474 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789992  Vali macro F1 0.9731987 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.073343992233276
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0363641  Vali Loss: 0.0670006 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789981  Vali macro F1 0.9731511 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.059113502502441
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0380953  Vali Loss: 0.0669461 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795263  Vali macro F1 0.9737125 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 6.061499357223511
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0351946  Vali Loss: 0.0669296 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795263  Vali macro F1 0.9737125 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.0604541301727295
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0378643  Vali Loss: 0.0669235 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795263  Vali macro F1 0.9737125 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.08100152015686
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0369429  Vali Loss: 0.0669349 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795263  Vali macro F1 0.9737125 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.068659782409668
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0349641  Vali Loss: 0.0670130 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789981  Vali macro F1 0.9731511 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.078444719314575
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0367147  Vali Loss: 0.0670894 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789981  Vali macro F1 0.9731511 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9612636  Test weighted F1: 0.9594227  Test macro F1 0.9431885 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014986 0.00018779 0.00137741 0.00144092 0.00052356 0.00064392]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.869584321975708
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.5182252  Vali Loss: 1.1301423 Vali Accuracy: 0.6444563  Vali weighted F1: 0.5552130  Vali macro F1 0.2572485 
Validation loss decreased (inf --> 1.130142).  Saving model ...
Epoch: 2 cost time: 5.828595161437988
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.8723745  Vali Loss: 0.6663463 Vali Accuracy: 0.7670576  Vali weighted F1: 0.6961287  Vali macro F1 0.4508039 
new best score!!!!
Validation loss decreased (1.130142 --> 0.666346).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.8272716999053955
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.6498472  Vali Loss: 0.5721742 Vali Accuracy: 0.7787846  Vali weighted F1: 0.7231604  Vali macro F1 0.4872562 
new best score!!!!
Validation loss decreased (0.666346 --> 0.572174).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.834543228149414
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.5578799  Vali Loss: 0.4936763 Vali Accuracy: 0.8033049  Vali weighted F1: 0.7731484  Vali macro F1 0.5641478 
new best score!!!!
Validation loss decreased (0.572174 --> 0.493676).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.827541828155518
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.4824348  Vali Loss: 0.4275916 Vali Accuracy: 0.8267591  Vali weighted F1: 0.8065304  Vali macro F1 0.6092623 
new best score!!!!
Validation loss decreased (0.493676 --> 0.427592).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.8465588092803955
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.3999224  Vali Loss: 0.3470398 Vali Accuracy: 0.8603412  Vali weighted F1: 0.8481293  Vali macro F1 0.6457117 
new best score!!!!
Validation loss decreased (0.427592 --> 0.347040).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.847977161407471
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.3495721  Vali Loss: 0.3176430 Vali Accuracy: 0.8917910  Vali weighted F1: 0.8942580  Vali macro F1 0.8330154 
new best score!!!!
Validation loss decreased (0.347040 --> 0.317643).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.857476472854614
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.3170243  Vali Loss: 0.2744704 Vali Accuracy: 0.9211087  Vali weighted F1: 0.9204370  Vali macro F1 0.8767772 
new best score!!!!
Validation loss decreased (0.317643 --> 0.274470).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.839176893234253
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.2710637  Vali Loss: 0.2283450 Vali Accuracy: 0.9280384  Vali weighted F1: 0.9256361  Vali macro F1 0.8839387 
new best score!!!!
Validation loss decreased (0.274470 --> 0.228345).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.8508546352386475
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.2313534  Vali Loss: 0.1876674 Vali Accuracy: 0.9525586  Vali weighted F1: 0.9521338  Vali macro F1 0.9344988 
new best score!!!!
Validation loss decreased (0.228345 --> 0.187667).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.845059394836426
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.2014568  Vali Loss: 0.1704691 Vali Accuracy: 0.9530917  Vali weighted F1: 0.9529045  Vali macro F1 0.9306550 
new best score!!!!
Validation loss decreased (0.187667 --> 0.170469).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.831908226013184
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1942372  Vali Loss: 0.1830579 Vali Accuracy: 0.9498934  Vali weighted F1: 0.9501212  Vali macro F1 0.9375421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.832587242126465
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1808330  Vali Loss: 0.1503321 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9612493  Vali macro F1 0.9495965 
new best score!!!!
Validation loss decreased (0.170469 --> 0.150332).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.829795837402344
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1715099  Vali Loss: 0.1628310 Vali Accuracy: 0.9525586  Vali weighted F1: 0.9523395  Vali macro F1 0.9393484 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.836141109466553
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1716884  Vali Loss: 0.1496135 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9585771  Vali macro F1 0.9443434 
new best score!!!!
Validation loss decreased (0.150332 --> 0.149614).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.84022331237793
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1652485  Vali Loss: 0.1435859 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9612538  Vali macro F1 0.9511500 
new best score!!!!
Validation loss decreased (0.149614 --> 0.143586).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.846842288970947
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1565184  Vali Loss: 0.1434803 Vali Accuracy: 0.9589552  Vali weighted F1: 0.9588204  Vali macro F1 0.9471446 
new best score!!!!
Validation loss decreased (0.143586 --> 0.143480).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.852602243423462
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1545611  Vali Loss: 0.1334741 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9631055  Vali macro F1 0.9543748 
new best score!!!!
Validation loss decreased (0.143480 --> 0.133474).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.8635478019714355
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.1462686  Vali Loss: 0.1233426 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9663403  Vali macro F1 0.9569526 
new best score!!!!
Validation loss decreased (0.133474 --> 0.123343).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.860265254974365
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.1437132  Vali Loss: 0.1276238 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9627842  Vali macro F1 0.9438275 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.845050573348999
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.1372046  Vali Loss: 0.1228388 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9660507  Vali macro F1 0.9593764 
new best score!!!!
Validation loss decreased (0.123343 --> 0.122839).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.845073699951172
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.1395364  Vali Loss: 0.1263207 Vali Accuracy: 0.9632196  Vali weighted F1: 0.9638097  Vali macro F1 0.9568188 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.846492767333984
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.1389930  Vali Loss: 0.1269009 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9607240  Vali macro F1 0.9453555 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.8480212688446045
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.1335270  Vali Loss: 0.1173062 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9675709  Vali macro F1 0.9595708 
new best score!!!!
Validation loss decreased (0.122839 --> 0.117306).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.852647304534912
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.1279112  Vali Loss: 0.1129790 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9664513  Vali macro F1 0.9576889 
new best score!!!!
Validation loss decreased (0.117306 --> 0.112979).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.839663743972778
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.1299062  Vali Loss: 0.1119517 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9668601  Vali macro F1 0.9567586 
new best score!!!!
Validation loss decreased (0.112979 --> 0.111952).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.8352155685424805
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.1222249  Vali Loss: 0.1152038 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9657987  Vali macro F1 0.9563792 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.837641716003418
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.1193040  Vali Loss: 0.1051466 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9704326  Vali macro F1 0.9631465 
new best score!!!!
Validation loss decreased (0.111952 --> 0.105147).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.860666751861572
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.1219096  Vali Loss: 0.1102311 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9657627  Vali macro F1 0.9565762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.849963188171387
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.1164512  Vali Loss: 0.1032431 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9679276  Vali macro F1 0.9610374 
new best score!!!!
Validation loss decreased (0.105147 --> 0.103243).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.8448381423950195
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.1066892  Vali Loss: 0.1058248 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9686808  Vali macro F1 0.9611656 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.829440355300903
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.1070129  Vali Loss: 0.1140056 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9622565  Vali macro F1 0.9536227 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.83138370513916
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.1020518  Vali Loss: 0.0968546 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9709880  Vali macro F1 0.9636255 
new best score!!!!
Validation loss decreased (0.103243 --> 0.096855).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.845189332962036
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.1033936  Vali Loss: 0.0979038 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9710139  Vali macro F1 0.9629513 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.839151620864868
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.1025897  Vali Loss: 0.1002797 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9689781  Vali macro F1 0.9604030 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.838850021362305
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0942516  Vali Loss: 0.0974045 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9704162  Vali macro F1 0.9619091 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.843783140182495
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0924770  Vali Loss: 0.0979537 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9710101  Vali macro F1 0.9598640 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.8311614990234375
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0908579  Vali Loss: 0.0976077 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9703511  Vali macro F1 0.9605898 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 5.843128204345703
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0846373  Vali Loss: 0.0931792 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9725581  Vali macro F1 0.9639235 
new best score!!!!
Validation loss decreased (0.096855 --> 0.093179).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.860774040222168
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0800350  Vali Loss: 0.0916383 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752591  Vali macro F1 0.9667679 
new best score!!!!
Validation loss decreased (0.093179 --> 0.091638).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.857802152633667
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0810106  Vali Loss: 0.0911566 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9725852  Vali macro F1 0.9630275 
new best score!!!!
Validation loss decreased (0.091638 --> 0.091157).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.844654321670532
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0818956  Vali Loss: 0.0946973 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9726049  Vali macro F1 0.9632575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.850777626037598
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0801790  Vali Loss: 0.0905797 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9763766  Vali macro F1 0.9672751 
new best score!!!!
Validation loss decreased (0.091157 --> 0.090580).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.850926160812378
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0781522  Vali Loss: 0.0906896 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747792  Vali macro F1 0.9648397 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.836040735244751
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0785126  Vali Loss: 0.0916361 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9731578  Vali macro F1 0.9635931 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.830006122589111
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0786505  Vali Loss: 0.0899226 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752954  Vali macro F1 0.9665088 
new best score!!!!
Validation loss decreased (0.090580 --> 0.089923).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.8389105796813965
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0754277  Vali Loss: 0.0896585 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747035  Vali macro F1 0.9658752 
new best score!!!!
Validation loss decreased (0.089923 --> 0.089659).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 5.844592809677124
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0757505  Vali Loss: 0.0905089 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752570  Vali macro F1 0.9658427 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.819351673126221
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0770474  Vali Loss: 0.0907549 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9742440  Vali macro F1 0.9640285 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.833796501159668
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0751704  Vali Loss: 0.0914982 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758182  Vali macro F1 0.9663482 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.805240631103516
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0761501  Vali Loss: 0.0893302 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9741590  Vali macro F1 0.9646529 
new best score!!!!
Validation loss decreased (0.089659 --> 0.089330).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 5.811254501342773
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0761406  Vali Loss: 0.0898149 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747572  Vali macro F1 0.9659287 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 5.812214374542236
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0749236  Vali Loss: 0.0896838 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9757700  Vali macro F1 0.9673994 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 5.807222366333008
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0738878  Vali Loss: 0.0902124 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747127  Vali macro F1 0.9662646 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 5.815155029296875
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0743513  Vali Loss: 0.0913809 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9725678  Vali macro F1 0.9626855 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 5.799863576889038
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0770577  Vali Loss: 0.0886920 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752635  Vali macro F1 0.9662001 
new best score!!!!
Validation loss decreased (0.089330 --> 0.088692).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 5.812018871307373
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0764862  Vali Loss: 0.0890856 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9763445  Vali macro F1 0.9672704 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 5.806223154067993
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0740286  Vali Loss: 0.0904590 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752554  Vali macro F1 0.9664463 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 5.824277400970459
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0729997  Vali Loss: 0.0885715 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9757787  Vali macro F1 0.9667219 
new best score!!!!
Validation loss decreased (0.088692 --> 0.088572).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 5.818384170532227
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0705455  Vali Loss: 0.0888305 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9757975  Vali macro F1 0.9670691 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 5.818307876586914
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0725888  Vali Loss: 0.0896776 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9753078  Vali macro F1 0.9662261 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 5.809305667877197
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0740614  Vali Loss: 0.0902552 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9741921  Vali macro F1 0.9628146 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 5.80779242515564
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0747637  Vali Loss: 0.0896281 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9757966  Vali macro F1 0.9667306 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 5.7994372844696045
VALI: Epoch: 64, Steps: 66 | Train Loss: 0.0724504  Vali Loss: 0.0873360 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9757787  Vali macro F1 0.9667219 
new best score!!!!
Validation loss decreased (0.088572 --> 0.087336).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 5.8073272705078125
VALI: Epoch: 65, Steps: 66 | Train Loss: 0.0721739  Vali Loss: 0.0915099 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9753570  Vali macro F1 0.9653009 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 5.798426151275635
VALI: Epoch: 66, Steps: 66 | Train Loss: 0.0730792  Vali Loss: 0.0885362 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9731913  Vali macro F1 0.9589674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 5.812687397003174
VALI: Epoch: 67, Steps: 66 | Train Loss: 0.0711383  Vali Loss: 0.0883652 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752679  Vali macro F1 0.9651812 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 5.817836046218872
VALI: Epoch: 68, Steps: 66 | Train Loss: 0.0725343  Vali Loss: 0.0871692 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9735789  Vali macro F1 0.9615796 
new best score!!!!
Validation loss decreased (0.087336 --> 0.087169).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 5.820967674255371
VALI: Epoch: 69, Steps: 66 | Train Loss: 0.0718213  Vali Loss: 0.0875685 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758260  Vali macro F1 0.9667362 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 5.804421901702881
VALI: Epoch: 70, Steps: 66 | Train Loss: 0.0722177  Vali Loss: 0.0904303 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9732484  Vali macro F1 0.9612468 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 5.8030149936676025
VALI: Epoch: 71, Steps: 66 | Train Loss: 0.0707868  Vali Loss: 0.0866189 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9763003  Vali macro F1 0.9675952 
new best score!!!!
Validation loss decreased (0.087169 --> 0.086619).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 5.8278422355651855
VALI: Epoch: 72, Steps: 66 | Train Loss: 0.0704661  Vali Loss: 0.0892427 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758328  Vali macro F1 0.9637865 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 5.822141408920288
VALI: Epoch: 73, Steps: 66 | Train Loss: 0.0713752  Vali Loss: 0.0865763 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9768255  Vali macro F1 0.9684989 
new best score!!!!
Validation loss decreased (0.086619 --> 0.086576).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 5.816607236862183
VALI: Epoch: 74, Steps: 66 | Train Loss: 0.0704029  Vali Loss: 0.0868513 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9725855  Vali macro F1 0.9575110 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 5.800883054733276
VALI: Epoch: 75, Steps: 66 | Train Loss: 0.0714857  Vali Loss: 0.0884165 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747989  Vali macro F1 0.9657577 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 5.818960666656494
VALI: Epoch: 76, Steps: 66 | Train Loss: 0.0675129  Vali Loss: 0.0882433 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752822  Vali macro F1 0.9632327 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 5.816364526748657
VALI: Epoch: 77, Steps: 66 | Train Loss: 0.0676891  Vali Loss: 0.0865924 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758631  Vali macro F1 0.9668210 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 5.8298304080963135
VALI: Epoch: 78, Steps: 66 | Train Loss: 0.0683990  Vali Loss: 0.0881150 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9757886  Vali macro F1 0.9654684 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 79 cost time: 5.814599514007568
VALI: Epoch: 79, Steps: 66 | Train Loss: 0.0670721  Vali Loss: 0.0872058 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9763502  Vali macro F1 0.9676465 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 5.805602788925171
VALI: Epoch: 80, Steps: 66 | Train Loss: 0.0664213  Vali Loss: 0.0868553 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747755  Vali macro F1 0.9638651 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 5.80451774597168
VALI: Epoch: 81, Steps: 66 | Train Loss: 0.0672973  Vali Loss: 0.0866871 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752895  Vali macro F1 0.9643551 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 5.7996296882629395
VALI: Epoch: 82, Steps: 66 | Train Loss: 0.0690750  Vali Loss: 0.0868549 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752895  Vali macro F1 0.9643551 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 5.801761150360107
VALI: Epoch: 83, Steps: 66 | Train Loss: 0.0684555  Vali Loss: 0.0870299 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752895  Vali macro F1 0.9643551 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 84 cost time: 5.803006887435913
VALI: Epoch: 84, Steps: 66 | Train Loss: 0.0662343  Vali Loss: 0.0870235 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752895  Vali macro F1 0.9643551 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 5.799643516540527
VALI: Epoch: 85, Steps: 66 | Train Loss: 0.0693887  Vali Loss: 0.0870050 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758130  Vali macro F1 0.9652441 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 5.8090903759002686
VALI: Epoch: 86, Steps: 66 | Train Loss: 0.0686593  Vali Loss: 0.0870394 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758130  Vali macro F1 0.9652441 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 5.7977824211120605
VALI: Epoch: 87, Steps: 66 | Train Loss: 0.0666806  Vali Loss: 0.0870007 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758130  Vali macro F1 0.9652441 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 88 cost time: 5.804594039916992
VALI: Epoch: 88, Steps: 66 | Train Loss: 0.0671621  Vali Loss: 0.0869857 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758130  Vali macro F1 0.9652441 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8793081  Test weighted F1: 0.8878507  Test macro F1 0.8494842 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.840445280075073
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0704009  Vali Loss: 0.0877249 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9731768  Vali macro F1 0.9575158 
Validation loss decreased (inf --> 0.087725).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.812596797943115
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0713696  Vali Loss: 0.0882247 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9705803  Vali macro F1 0.9544401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.792042016983032
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0711648  Vali Loss: 0.0882110 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9746530  Vali macro F1 0.9652898 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 5.832415819168091
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0696090  Vali Loss: 0.0874680 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747803  Vali macro F1 0.9656742 
new best score!!!!
Validation loss decreased (0.087725 --> 0.087468).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 5.804830074310303
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0686842  Vali Loss: 0.0856961 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9746545  Vali macro F1 0.9625119 
new best score!!!!
Validation loss decreased (0.087468 --> 0.085696).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 5.815213441848755
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0714795  Vali Loss: 0.0880970 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747219  Vali macro F1 0.9607167 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.811605215072632
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0680454  Vali Loss: 0.0863539 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752596  Vali macro F1 0.9612957 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.8178184032440186
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0674952  Vali Loss: 0.0868259 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9753205  Vali macro F1 0.9655029 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.832783937454224
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0675622  Vali Loss: 0.0876993 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9726244  Vali macro F1 0.9575852 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.816446304321289
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0674586  Vali Loss: 0.0861412 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9747420  Vali macro F1 0.9603379 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 5.843990325927734
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0680495  Vali Loss: 0.0889707 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752773  Vali macro F1 0.9665433 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 5.82316780090332
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0669634  Vali Loss: 0.0894106 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9736808  Vali macro F1 0.9589841 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 5.8221094608306885
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0694853  Vali Loss: 0.0896670 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9742702  Vali macro F1 0.9626358 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.816999673843384
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0681676  Vali Loss: 0.0864885 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9736868  Vali macro F1 0.9622739 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 5.821704864501953
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0692839  Vali Loss: 0.0878564 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9752937  Vali macro F1 0.9665295 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 5.819780111312866
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0658460  Vali Loss: 0.0879671 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9753084  Vali macro F1 0.9661475 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 5.823707580566406
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0640032  Vali Loss: 0.0879827 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9763573  Vali macro F1 0.9679296 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 5.813433647155762
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0660277  Vali Loss: 0.0883183 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9763573  Vali macro F1 0.9679296 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 5.82172966003418
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0647429  Vali Loss: 0.0884679 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758082  Vali macro F1 0.9673781 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 5.820852756500244
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0657645  Vali Loss: 0.0882284 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758263  Vali macro F1 0.9670945 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8840487  Test weighted F1: 0.8913438  Test macro F1 0.8526416 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00014229 0.00018477 0.00097087 0.00122549 0.0005322  0.00063735]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.115725517272949
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.5105885  Vali Loss: 1.0820567 Vali Accuracy: 0.6468798  Vali weighted F1: 0.5480349  Vali macro F1 0.2607559 
Validation loss decreased (inf --> 1.082057).  Saving model ...
Epoch: 2 cost time: 6.1183435916900635
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8668626  Vali Loss: 0.6880723 Vali Accuracy: 0.7686454  Vali weighted F1: 0.6877530  Vali macro F1 0.4443751 
new best score!!!!
Validation loss decreased (1.082057 --> 0.688072).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.133588552474976
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6522074  Vali Loss: 0.5965906 Vali Accuracy: 0.7792998  Vali weighted F1: 0.7140738  Vali macro F1 0.4805579 
new best score!!!!
Validation loss decreased (0.688072 --> 0.596591).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.153955459594727
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5826800  Vali Loss: 0.5721503 Vali Accuracy: 0.7970573  Vali weighted F1: 0.7687840  Vali macro F1 0.6990696 
new best score!!!!
Validation loss decreased (0.596591 --> 0.572150).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.151371240615845
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4906585  Vali Loss: 0.4680658 Vali Accuracy: 0.8285134  Vali weighted F1: 0.7991400  Vali macro F1 0.7215019 
new best score!!!!
Validation loss decreased (0.572150 --> 0.468066).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.14016056060791
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3856685  Vali Loss: 0.3391001 Vali Accuracy: 0.8701167  Vali weighted F1: 0.8581060  Vali macro F1 0.7811112 
new best score!!!!
Validation loss decreased (0.468066 --> 0.339100).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.14465594291687
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3185126  Vali Loss: 0.3443803 Vali Accuracy: 0.8711314  Vali weighted F1: 0.8536263  Vali macro F1 0.7880094 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.154911279678345
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2785272  Vali Loss: 0.2472908 Vali Accuracy: 0.9061390  Vali weighted F1: 0.8991704  Vali macro F1 0.8443524 
new best score!!!!
Validation loss decreased (0.339100 --> 0.247291).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.1726202964782715
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2382682  Vali Loss: 0.2740404 Vali Accuracy: 0.9066464  Vali weighted F1: 0.9016480  Vali macro F1 0.8606501 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.138322591781616
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2219066  Vali Loss: 0.2169555 Vali Accuracy: 0.9259259  Vali weighted F1: 0.9276437  Vali macro F1 0.8932035 
new best score!!!!
Validation loss decreased (0.247291 --> 0.216955).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.147842168807983
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1985743  Vali Loss: 0.2066858 Vali Accuracy: 0.9259259  Vali weighted F1: 0.9238573  Vali macro F1 0.8907460 
new best score!!!!
Validation loss decreased (0.216955 --> 0.206686).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.137910604476929
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1785819  Vali Loss: 0.1719778 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9419243  Vali macro F1 0.9132103 
new best score!!!!
Validation loss decreased (0.206686 --> 0.171978).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.131464004516602
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1725994  Vali Loss: 0.1770342 Vali Accuracy: 0.9406393  Vali weighted F1: 0.9408786  Vali macro F1 0.9123810 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.136795520782471
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1635731  Vali Loss: 0.1748878 Vali Accuracy: 0.9391172  Vali weighted F1: 0.9409204  Vali macro F1 0.9125851 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.140512228012085
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1552964  Vali Loss: 0.1283417 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9620380  Vali macro F1 0.9491474 
new best score!!!!
Validation loss decreased (0.171978 --> 0.128342).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.14704704284668
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1448309  Vali Loss: 0.1490694 Vali Accuracy: 0.9533232  Vali weighted F1: 0.9529204  Vali macro F1 0.9347821 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.16473913192749
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1371282  Vali Loss: 0.1266321 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9632170  Vali macro F1 0.9501346 
new best score!!!!
Validation loss decreased (0.128342 --> 0.126632).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.134814023971558
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1388784  Vali Loss: 0.1269682 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9618606  Vali macro F1 0.9498060 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.157801628112793
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1332842  Vali Loss: 0.1192055 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9614469  Vali macro F1 0.9494483 
new best score!!!!
Validation loss decreased (0.126632 --> 0.119206).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.14280366897583
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1234616  Vali Loss: 0.1156409 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9637661  Vali macro F1 0.9453392 
new best score!!!!
Validation loss decreased (0.119206 --> 0.115641).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.144308567047119
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1247497  Vali Loss: 0.1211864 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9587476  Vali macro F1 0.9442573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.135149002075195
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1164180  Vali Loss: 0.1267776 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9604789  Vali macro F1 0.9473109 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.139612197875977
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1181338  Vali Loss: 0.1303934 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9592949  Vali macro F1 0.9459433 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.139725923538208
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1113751  Vali Loss: 0.1285862 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9650087  Vali macro F1 0.9550029 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 6.136067152023315
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1087273  Vali Loss: 0.1534425 Vali Accuracy: 0.9482496  Vali weighted F1: 0.9493486  Vali macro F1 0.9361176 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 6.139458656311035
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0976203  Vali Loss: 0.1133801 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9641088  Vali macro F1 0.9534670 
new best score!!!!
Validation loss decreased (0.115641 --> 0.113380).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.144060373306274
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0962160  Vali Loss: 0.1164198 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9653561  Vali macro F1 0.9554893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.139750003814697
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0948490  Vali Loss: 0.1220638 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9624706  Vali macro F1 0.9521808 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.1341729164123535
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0941875  Vali Loss: 0.1237330 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9631744  Vali macro F1 0.9519272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.131842613220215
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0913368  Vali Loss: 0.1107462 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9673890  Vali macro F1 0.9574307 
new best score!!!!
Validation loss decreased (0.113380 --> 0.110746).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.157112121582031
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0929686  Vali Loss: 0.1127628 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9661040  Vali macro F1 0.9557563 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.146626949310303
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0952156  Vali Loss: 0.1257214 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9636432  Vali macro F1 0.9526656 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.142923831939697
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0920784  Vali Loss: 0.1254737 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9636432  Vali macro F1 0.9526656 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.142073631286621
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0924385  Vali Loss: 0.1196219 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649902  Vali macro F1 0.9551886 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.143404960632324
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0926409  Vali Loss: 0.1131759 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9668886  Vali macro F1 0.9568083 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 36 cost time: 6.16135048866272
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0889559  Vali Loss: 0.1135513 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9674289  Vali macro F1 0.9575164 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.144301414489746
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0919618  Vali Loss: 0.1130698 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9684191  Vali macro F1 0.9589074 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.174762725830078
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0911460  Vali Loss: 0.1142121 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9664818  Vali macro F1 0.9562545 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.146326065063477
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0921125  Vali Loss: 0.1141293 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9659887  Vali macro F1 0.9553991 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.139787912368774
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0908507  Vali Loss: 0.1148709 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9654950  Vali macro F1 0.9545421 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 41 cost time: 6.133414268493652
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0894084  Vali Loss: 0.1141723 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9654950  Vali macro F1 0.9545421 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.139616966247559
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0907748  Vali Loss: 0.1137083 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9664818  Vali macro F1 0.9562545 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.143545627593994
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0928370  Vali Loss: 0.1134644 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669561  Vali macro F1 0.9567242 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.148380994796753
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0880794  Vali Loss: 0.1134772 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669561  Vali macro F1 0.9567242 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.1510374546051025
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0885956  Vali Loss: 0.1128517 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9674311  Vali macro F1 0.9571952 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9145063  Test weighted F1: 0.9154609  Test macro F1 0.9073291 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.182825803756714
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0945996  Vali Loss: 0.1178101 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9645111  Vali macro F1 0.9537998 
Validation loss decreased (inf --> 0.117810).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.171321153640747
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0926755  Vali Loss: 0.1159458 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9654670  Vali macro F1 0.9553347 
new best score!!!!
Validation loss decreased (0.117810 --> 0.115946).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.143122911453247
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0920809  Vali Loss: 0.1131795 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9673332  Vali macro F1 0.9569961 
new best score!!!!
Validation loss decreased (0.115946 --> 0.113179).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.135958671569824
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0932765  Vali Loss: 0.1059721 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9697378  Vali macro F1 0.9597106 
new best score!!!!
Validation loss decreased (0.113179 --> 0.105972).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.142646789550781
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0929984  Vali Loss: 0.1166338 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9655286  Vali macro F1 0.9545216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.163513660430908
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0904259  Vali Loss: 0.1114855 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9678956  Vali macro F1 0.9583852 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.158279895782471
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0907682  Vali Loss: 0.1060478 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9687590  Vali macro F1 0.9581086 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.155387878417969
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0900696  Vali Loss: 0.1099966 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9673608  Vali macro F1 0.9569169 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.1509997844696045
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0892189  Vali Loss: 0.1203016 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9621825  Vali macro F1 0.9512266 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.170851230621338
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0903323  Vali Loss: 0.1186223 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9641027  Vali macro F1 0.9535725 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.15504264831543
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0910295  Vali Loss: 0.1183532 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9650200  Vali macro F1 0.9550396 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.14888334274292
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0879636  Vali Loss: 0.1076199 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9683987  Vali macro F1 0.9587143 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.156197547912598
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0890371  Vali Loss: 0.1213877 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9636443  Vali macro F1 0.9537662 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.140825033187866
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0884759  Vali Loss: 0.1105575 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9664405  Vali macro F1 0.9554769 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.138395547866821
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0863038  Vali Loss: 0.1115571 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9674363  Vali macro F1 0.9574783 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.149691581726074
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0858186  Vali Loss: 0.1083127 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9679202  Vali macro F1 0.9582706 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.165084600448608
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0856650  Vali Loss: 0.1145984 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9645715  Vali macro F1 0.9540015 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.149695158004761
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0837948  Vali Loss: 0.1099529 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9679202  Vali macro F1 0.9582706 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.169657945632935
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0847460  Vali Loss: 0.1116592 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9669608  Vali macro F1 0.9570391 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9190108  Test weighted F1: 0.9196385  Test macro F1 0.9114877 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014168 0.00017867 0.00095969 0.00122549 0.000481   0.00060643]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.306548357009888
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.4946987  Vali Loss: 1.0573249 Vali Accuracy: 0.6472620  Vali weighted F1: 0.5417236  Vali macro F1 0.2684697 
Validation loss decreased (inf --> 1.057325).  Saving model ...
Epoch: 2 cost time: 6.302476406097412
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.8279489  Vali Loss: 0.7313858 Vali Accuracy: 0.7311297  Vali weighted F1: 0.6494816  Vali macro F1 0.4329229 
new best score!!!!
Validation loss decreased (1.057325 --> 0.731386).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.279739618301392
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.6429306  Vali Loss: 0.6158502 Vali Accuracy: 0.7528367  Vali weighted F1: 0.6899020  Vali macro F1 0.4775737 
new best score!!!!
Validation loss decreased (0.731386 --> 0.615850).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.292916536331177
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.5799483  Vali Loss: 0.5766035 Vali Accuracy: 0.7627035  Vali weighted F1: 0.7075876  Vali macro F1 0.5010139 
new best score!!!!
Validation loss decreased (0.615850 --> 0.576604).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.309127330780029
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.5064779  Vali Loss: 0.4894048 Vali Accuracy: 0.7977306  Vali weighted F1: 0.7539809  Vali macro F1 0.5537418 
new best score!!!!
Validation loss decreased (0.576604 --> 0.489405).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.295085668563843
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.3628324  Vali Loss: 0.3156044 Vali Accuracy: 0.9018254  Vali weighted F1: 0.8956835  Vali macro F1 0.8694847 
new best score!!!!
Validation loss decreased (0.489405 --> 0.315604).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.283644914627075
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.2645625  Vali Loss: 0.2558335 Vali Accuracy: 0.9146522  Vali weighted F1: 0.9133218  Vali macro F1 0.8854076 
new best score!!!!
Validation loss decreased (0.315604 --> 0.255834).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.2929065227508545
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.2188938  Vali Loss: 0.2098773 Vali Accuracy: 0.9324124  Vali weighted F1: 0.9334242  Vali macro F1 0.9097989 
new best score!!!!
Validation loss decreased (0.255834 --> 0.209877).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.309217929840088
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.2008204  Vali Loss: 0.1873375 Vali Accuracy: 0.9393192  Vali weighted F1: 0.9393646  Vali macro F1 0.9195697 
new best score!!!!
Validation loss decreased (0.209877 --> 0.187337).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.278215169906616
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1858992  Vali Loss: 0.1906339 Vali Accuracy: 0.9373458  Vali weighted F1: 0.9358922  Vali macro F1 0.9168123 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.285727024078369
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1778752  Vali Loss: 0.1630213 Vali Accuracy: 0.9452393  Vali weighted F1: 0.9452129  Vali macro F1 0.9299422 
new best score!!!!
Validation loss decreased (0.187337 --> 0.163021).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.292860746383667
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1679062  Vali Loss: 0.1634657 Vali Accuracy: 0.9457326  Vali weighted F1: 0.9458910  Vali macro F1 0.9306852 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.294119834899902
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1560857  Vali Loss: 0.1564489 Vali Accuracy: 0.9472126  Vali weighted F1: 0.9476735  Vali macro F1 0.9323370 
new best score!!!!
Validation loss decreased (0.163021 --> 0.156449).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.298396825790405
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1538307  Vali Loss: 0.1518914 Vali Accuracy: 0.9486926  Vali weighted F1: 0.9492682  Vali macro F1 0.9350903 
new best score!!!!
Validation loss decreased (0.156449 --> 0.151891).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.28811502456665
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1549099  Vali Loss: 0.1495384 Vali Accuracy: 0.9501727  Vali weighted F1: 0.9498090  Vali macro F1 0.9332890 
new best score!!!!
Validation loss decreased (0.151891 --> 0.149538).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.282954216003418
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.1464221  Vali Loss: 0.1599617 Vali Accuracy: 0.9472126  Vali weighted F1: 0.9475262  Vali macro F1 0.9319283 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.2786664962768555
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.1451147  Vali Loss: 0.1360039 Vali Accuracy: 0.9551061  Vali weighted F1: 0.9551388  Vali macro F1 0.9422379 
new best score!!!!
Validation loss decreased (0.149538 --> 0.136004).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.292695999145508
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.1398522  Vali Loss: 0.1452562 Vali Accuracy: 0.9560927  Vali weighted F1: 0.9558885  Vali macro F1 0.9442131 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.310415267944336
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.1368291  Vali Loss: 0.1445757 Vali Accuracy: 0.9536260  Vali weighted F1: 0.9540617  Vali macro F1 0.9404304 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.320863246917725
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.1395135  Vali Loss: 0.1891245 Vali Accuracy: 0.9407992  Vali weighted F1: 0.9414990  Vali macro F1 0.9245162 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.296202659606934
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.1299902  Vali Loss: 0.1501670 Vali Accuracy: 0.9491860  Vali weighted F1: 0.9496809  Vali macro F1 0.9362940 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 6.289687871932983
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.1283442  Vali Loss: 0.1552490 Vali Accuracy: 0.9501727  Vali weighted F1: 0.9505417  Vali macro F1 0.9386942 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 6.289790153503418
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.1194907  Vali Loss: 0.1316673 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9589336  Vali macro F1 0.9477358 
new best score!!!!
Validation loss decreased (0.136004 --> 0.131667).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.289685964584351
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.1160380  Vali Loss: 0.1324467 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9590516  Vali macro F1 0.9477738 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.288485527038574
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.1150433  Vali Loss: 0.1354723 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9569593  Vali macro F1 0.9450826 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.299306154251099
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.1137178  Vali Loss: 0.1315439 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9588586  Vali macro F1 0.9478873 
new best score!!!!
Validation loss decreased (0.131667 --> 0.131544).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.291845083236694
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.1155876  Vali Loss: 0.1292462 Vali Accuracy: 0.9575728  Vali weighted F1: 0.9580993  Vali macro F1 0.9465697 
new best score!!!!
Validation loss decreased (0.131544 --> 0.129246).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.308387517929077
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.1131347  Vali Loss: 0.1279031 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9598861  Vali macro F1 0.9494310 
new best score!!!!
Validation loss decreased (0.129246 --> 0.127903).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.28745436668396
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.1132707  Vali Loss: 0.1271887 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9591005  Vali macro F1 0.9478287 
new best score!!!!
Validation loss decreased (0.127903 --> 0.127189).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.28453516960144
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.1141254  Vali Loss: 0.1251015 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9603124  Vali macro F1 0.9492852 
new best score!!!!
Validation loss decreased (0.127189 --> 0.125101).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.2913124561309814
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.1115906  Vali Loss: 0.1268020 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9595919  Vali macro F1 0.9480430 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.283209800720215
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.1111452  Vali Loss: 0.1222312 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9619593  Vali macro F1 0.9510698 
new best score!!!!
Validation loss decreased (0.125101 --> 0.122231).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.295231819152832
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.1131596  Vali Loss: 0.1216597 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9614474  Vali macro F1 0.9507693 
new best score!!!!
Validation loss decreased (0.122231 --> 0.121660).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.286269187927246
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.1112899  Vali Loss: 0.1218648 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9609615  Vali macro F1 0.9501788 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.284204483032227
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.1119491  Vali Loss: 0.1203636 Vali Accuracy: 0.9629995  Vali weighted F1: 0.9632464  Vali macro F1 0.9527494 
new best score!!!!
Validation loss decreased (0.121660 --> 0.120364).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.321846008300781
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.1104394  Vali Loss: 0.1198633 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9648559  Vali macro F1 0.9556913 
new best score!!!!
Validation loss decreased (0.120364 --> 0.119863).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.289295673370361
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.1116989  Vali Loss: 0.1223934 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9619710  Vali macro F1 0.9513320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.283628225326538
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.1129797  Vali Loss: 0.1252731 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9605010  Vali macro F1 0.9493090 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.27662205696106
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.1068433  Vali Loss: 0.1213817 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9629233  Vali macro F1 0.9521930 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.28637957572937
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.1087236  Vali Loss: 0.1275558 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9589807  Vali macro F1 0.9477611 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.280279159545898
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.1078374  Vali Loss: 0.1211090 Vali Accuracy: 0.9620128  Vali weighted F1: 0.9624128  Vali macro F1 0.9516182 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 6.2765045166015625
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.1061711  Vali Loss: 0.1226456 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9613884  Vali macro F1 0.9505788 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.27449107170105
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.1081061  Vali Loss: 0.1231534 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9619432  Vali macro F1 0.9508205 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.303194046020508
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.1097005  Vali Loss: 0.1225954 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9619432  Vali macro F1 0.9508205 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.287250518798828
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.1039236  Vali Loss: 0.1237780 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9608898  Vali macro F1 0.9492438 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.27876615524292
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.1082995  Vali Loss: 0.1244284 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9608777  Vali macro F1 0.9500024 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 6.282192945480347
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.1066239  Vali Loss: 0.1242289 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9609134  Vali macro F1 0.9497517 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.284948110580444
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.1065431  Vali Loss: 0.1238990 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9609134  Vali macro F1 0.9497517 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.281148195266724
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.1073067  Vali Loss: 0.1236624 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9609134  Vali macro F1 0.9497517 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.285270929336548
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.1069460  Vali Loss: 0.1235494 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9614320  Vali macro F1 0.9502441 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.280014991760254
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.1057453  Vali Loss: 0.1234913 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9614320  Vali macro F1 0.9502441 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8935616  Test weighted F1: 0.8759057  Test macro F1 0.6527685 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.344724178314209
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.1105994  Vali Loss: 0.1364408 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9570512  Vali macro F1 0.9460228 
Validation loss decreased (inf --> 0.136441).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.30895733833313
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.1111697  Vali Loss: 0.1204848 Vali Accuracy: 0.9620128  Vali weighted F1: 0.9623203  Vali macro F1 0.9512206 
new best score!!!!
Validation loss decreased (0.136441 --> 0.120485).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.303077697753906
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.1085185  Vali Loss: 0.1254440 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9604657  Vali macro F1 0.9495633 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.296875
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.1062118  Vali Loss: 0.1195718 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9612581  Vali macro F1 0.9500387 
new best score!!!!
Validation loss decreased (0.120485 --> 0.119572).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.304485559463501
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.1094545  Vali Loss: 0.1278553 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9591652  Vali macro F1 0.9479674 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.322924852371216
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1095924  Vali Loss: 0.1191654 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9647173  Vali macro F1 0.9550787 
new best score!!!!
Validation loss decreased (0.119572 --> 0.119165).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.316423416137695
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1092141  Vali Loss: 0.1246501 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9618655  Vali macro F1 0.9517367 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.321807146072388
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1071950  Vali Loss: 0.1272003 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9610771  Vali macro F1 0.9501790 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.334066390991211
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1092141  Vali Loss: 0.1177651 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9647150  Vali macro F1 0.9550755 
new best score!!!!
Validation loss decreased (0.119165 --> 0.117765).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.307042360305786
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1056123  Vali Loss: 0.1182165 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9648450  Vali macro F1 0.9541874 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.328778266906738
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1078320  Vali Loss: 0.1212276 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9643417  Vali macro F1 0.9545939 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.314792633056641
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1077800  Vali Loss: 0.1197264 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9617276  Vali macro F1 0.9505871 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.31415581703186
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1073239  Vali Loss: 0.1239388 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9606558  Vali macro F1 0.9490565 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.320394277572632
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1053166  Vali Loss: 0.1263479 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9615500  Vali macro F1 0.9515366 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 6.316128253936768
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1040876  Vali Loss: 0.1253649 Vali Accuracy: 0.9610261  Vali weighted F1: 0.9614688  Vali macro F1 0.9510871 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.312232971191406
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.1040921  Vali Loss: 0.1184817 Vali Accuracy: 0.9620128  Vali weighted F1: 0.9623415  Vali macro F1 0.9513197 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.298873662948608
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.1045433  Vali Loss: 0.1171930 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9648388  Vali macro F1 0.9549891 
new best score!!!!
Validation loss decreased (0.117765 --> 0.117193).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.316084861755371
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.1031100  Vali Loss: 0.1167802 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9626950  Vali macro F1 0.9525352 
new best score!!!!
Validation loss decreased (0.117193 --> 0.116780).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.3283398151397705
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.1024371  Vali Loss: 0.1164615 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9628635  Vali macro F1 0.9510598 
new best score!!!!
Validation loss decreased (0.116780 --> 0.116461).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.316000938415527
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.1044414  Vali Loss: 0.1188370 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9638949  Vali macro F1 0.9536176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.319803953170776
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.1061561  Vali Loss: 0.1104352 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9651927  Vali macro F1 0.9558693 
new best score!!!!
Validation loss decreased (0.116461 --> 0.110435).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.325140476226807
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.1021254  Vali Loss: 0.1149055 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9642913  Vali macro F1 0.9538060 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.311914682388306
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.1002986  Vali Loss: 0.1142126 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9652273  Vali macro F1 0.9555392 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.314045667648315
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.1013061  Vali Loss: 0.1153212 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9627081  Vali macro F1 0.9524795 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.310126066207886
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.1011493  Vali Loss: 0.1187340 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9618831  Vali macro F1 0.9504442 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.309863328933716
Fine Tuning VALI: Epoch: 26, Steps: 72 | Train Loss: 0.1017306  Vali Loss: 0.1161649 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9653860  Vali macro F1 0.9555510 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.331074237823486
Fine Tuning VALI: Epoch: 27, Steps: 72 | Train Loss: 0.1005916  Vali Loss: 0.1196118 Vali Accuracy: 0.9629995  Vali weighted F1: 0.9633578  Vali macro F1 0.9529459 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.322452545166016
Fine Tuning VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0995335  Vali Loss: 0.1175735 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9638527  Vali macro F1 0.9531904 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.300874948501587
Fine Tuning VALI: Epoch: 29, Steps: 72 | Train Loss: 0.1003657  Vali Loss: 0.1186411 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9638186  Vali macro F1 0.9534447 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.422818422317505
Fine Tuning VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0984142  Vali Loss: 0.1170149 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9648157  Vali macro F1 0.9546755 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.293381690979004
Fine Tuning VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0981832  Vali Loss: 0.1175350 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9643343  Vali macro F1 0.9539328 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 6.294320106506348
Fine Tuning VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0978557  Vali Loss: 0.1173635 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9643343  Vali macro F1 0.9539328 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.305136442184448
Fine Tuning VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0986764  Vali Loss: 0.1175365 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9643343  Vali macro F1 0.9539328 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.3053529262542725
Fine Tuning VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0986051  Vali Loss: 0.1174748 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9643343  Vali macro F1 0.9539328 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.318109750747681
Fine Tuning VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0984670  Vali Loss: 0.1176883 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9643343  Vali macro F1 0.9539328 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.318259000778198
Fine Tuning VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0994383  Vali Loss: 0.1176424 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9643343  Vali macro F1 0.9539328 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8936856  Test weighted F1: 0.8749517  Test macro F1 0.6505472 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0001452  0.00016892 0.00099305 0.00131234 0.00049875 0.00062893]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.262434005737305
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.5085800  Vali Loss: 1.0663430 Vali Accuracy: 0.6815255  Vali weighted F1: 0.5798471  Vali macro F1 0.2722815 
Validation loss decreased (inf --> 1.066343).  Saving model ...
Epoch: 2 cost time: 6.265085935592651
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.8342686  Vali Loss: 0.6641725 Vali Accuracy: 0.7746409  Vali weighted F1: 0.7068440  Vali macro F1 0.4592487 
new best score!!!!
Validation loss decreased (1.066343 --> 0.664172).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.273098945617676
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.6035634  Vali Loss: 0.5226195 Vali Accuracy: 0.7989104  Vali weighted F1: 0.7436149  Vali macro F1 0.5106927 
new best score!!!!
Validation loss decreased (0.664172 --> 0.522620).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.27034330368042
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.4695500  Vali Loss: 0.3598686 Vali Accuracy: 0.8751857  Vali weighted F1: 0.8617832  Vali macro F1 0.8021143 
new best score!!!!
Validation loss decreased (0.522620 --> 0.359869).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.281049013137817
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.3532483  Vali Loss: 0.3308612 Vali Accuracy: 0.8885587  Vali weighted F1: 0.8892085  Vali macro F1 0.8462137 
new best score!!!!
Validation loss decreased (0.359869 --> 0.330861).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.275561809539795
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2927325  Vali Loss: 0.2486742 Vali Accuracy: 0.9192670  Vali weighted F1: 0.9185601  Vali macro F1 0.8844345 
new best score!!!!
Validation loss decreased (0.330861 --> 0.248674).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.282701015472412
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.2508347  Vali Loss: 0.2026505 Vali Accuracy: 0.9366023  Vali weighted F1: 0.9369149  Vali macro F1 0.9058389 
new best score!!!!
Validation loss decreased (0.248674 --> 0.202650).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.2812418937683105
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2224871  Vali Loss: 0.1990785 Vali Accuracy: 0.9375929  Vali weighted F1: 0.9386311  Vali macro F1 0.9093350 
new best score!!!!
Validation loss decreased (0.202650 --> 0.199078).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.252272605895996
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2076562  Vali Loss: 0.1762063 Vali Accuracy: 0.9440317  Vali weighted F1: 0.9443217  Vali macro F1 0.9149575 
new best score!!!!
Validation loss decreased (0.199078 --> 0.176206).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.255002021789551
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1889828  Vali Loss: 0.1718594 Vali Accuracy: 0.9435364  Vali weighted F1: 0.9442951  Vali macro F1 0.9177577 
new best score!!!!
Validation loss decreased (0.176206 --> 0.171859).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.261327266693115
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1823856  Vali Loss: 0.1560921 Vali Accuracy: 0.9484894  Vali weighted F1: 0.9491244  Vali macro F1 0.9239312 
new best score!!!!
Validation loss decreased (0.171859 --> 0.156092).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.252363681793213
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1767024  Vali Loss: 0.1608182 Vali Accuracy: 0.9489846  Vali weighted F1: 0.9481905  Vali macro F1 0.9219132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.2476420402526855
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1657257  Vali Loss: 0.1951728 Vali Accuracy: 0.9380882  Vali weighted F1: 0.9395760  Vali macro F1 0.9103779 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.262446403503418
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1651688  Vali Loss: 0.1429155 Vali Accuracy: 0.9514611  Vali weighted F1: 0.9513805  Vali macro F1 0.9246030 
new best score!!!!
Validation loss decreased (0.156092 --> 0.142915).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.2602925300598145
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1503877  Vali Loss: 0.1358408 Vali Accuracy: 0.9529470  Vali weighted F1: 0.9531907  Vali macro F1 0.9255783 
new best score!!!!
Validation loss decreased (0.142915 --> 0.135841).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.2696709632873535
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1453974  Vali Loss: 0.1351090 Vali Accuracy: 0.9514611  Vali weighted F1: 0.9518764  Vali macro F1 0.9228185 
new best score!!!!
Validation loss decreased (0.135841 --> 0.135109).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.289092302322388
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1427913  Vali Loss: 0.1849945 Vali Accuracy: 0.9425458  Vali weighted F1: 0.9441230  Vali macro F1 0.9176350 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.251120328903198
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1414072  Vali Loss: 0.1879460 Vali Accuracy: 0.9331352  Vali weighted F1: 0.9348947  Vali macro F1 0.9061357 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.253089189529419
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1349735  Vali Loss: 0.1420167 Vali Accuracy: 0.9509658  Vali weighted F1: 0.9521104  Vali macro F1 0.9292514 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.262616872787476
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1327068  Vali Loss: 0.1358631 Vali Accuracy: 0.9559188  Vali weighted F1: 0.9558758  Vali macro F1 0.9315810 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 6.255349636077881
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1289301  Vali Loss: 0.1461305 Vali Accuracy: 0.9484894  Vali weighted F1: 0.9495868  Vali macro F1 0.9203169 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 6.2559428215026855
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1170340  Vali Loss: 0.1183201 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9601430  Vali macro F1 0.9358605 
new best score!!!!
Validation loss decreased (0.135109 --> 0.118320).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.254575490951538
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1127538  Vali Loss: 0.1226361 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9579544  Vali macro F1 0.9339968 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.2576212882995605
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1114402  Vali Loss: 0.1188159 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9597056  Vali macro F1 0.9365989 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.273061990737915
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1125503  Vali Loss: 0.1155110 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9630186  Vali macro F1 0.9411243 
new best score!!!!
Validation loss decreased (0.118320 --> 0.115511).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.258876085281372
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1113685  Vali Loss: 0.1141290 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9645446  Vali macro F1 0.9443763 
new best score!!!!
Validation loss decreased (0.115511 --> 0.114129).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.244535446166992
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1111571  Vali Loss: 0.1169017 Vali Accuracy: 0.9618623  Vali weighted F1: 0.9620784  Vali macro F1 0.9408104 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.24654221534729
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1089999  Vali Loss: 0.1147079 Vali Accuracy: 0.9638435  Vali weighted F1: 0.9639386  Vali macro F1 0.9417307 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.240667104721069
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1088969  Vali Loss: 0.1118829 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9634756  Vali macro F1 0.9415937 
new best score!!!!
Validation loss decreased (0.114129 --> 0.111883).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.240389108657837
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1087323  Vali Loss: 0.1167753 Vali Accuracy: 0.9603764  Vali weighted F1: 0.9606185  Vali macro F1 0.9357592 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.238795280456543
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.1093937  Vali Loss: 0.1162607 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9602705  Vali macro F1 0.9370668 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.252811670303345
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.1097786  Vali Loss: 0.1167587 Vali Accuracy: 0.9608717  Vali weighted F1: 0.9612534  Vali macro F1 0.9393046 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.252872467041016
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.1072741  Vali Loss: 0.1120403 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9635280  Vali macro F1 0.9425651 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.258092403411865
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.1081271  Vali Loss: 0.1199744 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9598884  Vali macro F1 0.9364551 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 6.2618727684021
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.1045050  Vali Loss: 0.1153528 Vali Accuracy: 0.9618623  Vali weighted F1: 0.9620701  Vali macro F1 0.9394041 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.255369663238525
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.1041907  Vali Loss: 0.1134989 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9615875  Vali macro F1 0.9385562 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.250978946685791
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.1038859  Vali Loss: 0.1136238 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9615875  Vali macro F1 0.9385562 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.250447988510132
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.1041715  Vali Loss: 0.1128526 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9630049  Vali macro F1 0.9404100 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.257349729537964
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.1058561  Vali Loss: 0.1139194 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9625523  Vali macro F1 0.9402510 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 40 cost time: 6.250064373016357
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.1046329  Vali Loss: 0.1138635 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9625523  Vali macro F1 0.9402510 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.258591890335083
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.1021233  Vali Loss: 0.1137758 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9625523  Vali macro F1 0.9402510 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.2518463134765625
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.1042484  Vali Loss: 0.1136534 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9625523  Vali macro F1 0.9402510 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.270799875259399
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.1049505  Vali Loss: 0.1136172 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9625523  Vali macro F1 0.9402510 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.249032020568848
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.1049688  Vali Loss: 0.1136482 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9625523  Vali macro F1 0.9402510 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7704142  Test weighted F1: 0.7715713  Test macro F1 0.7635731 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.307066202163696
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.1081971  Vali Loss: 0.1173793 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9601367  Vali macro F1 0.9358444 
Validation loss decreased (inf --> 0.117379).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.274630784988403
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.1097264  Vali Loss: 0.1123520 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9629408  Vali macro F1 0.9396500 
new best score!!!!
Validation loss decreased (0.117379 --> 0.112352).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.282177209854126
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.1112789  Vali Loss: 0.1096291 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9658765  Vali macro F1 0.9463049 
new best score!!!!
Validation loss decreased (0.112352 --> 0.109629).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.2834391593933105
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.1069502  Vali Loss: 0.1125360 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9625552  Vali macro F1 0.9394267 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.263698577880859
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1067811  Vali Loss: 0.1135507 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9631161  Vali macro F1 0.9403047 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.273178815841675
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1057749  Vali Loss: 0.1265351 Vali Accuracy: 0.9559188  Vali weighted F1: 0.9565337  Vali macro F1 0.9350261 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.266475439071655
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1079106  Vali Loss: 0.1134712 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9617046  Vali macro F1 0.9379632 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.2697272300720215
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1029830  Vali Loss: 0.1176486 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9598091  Vali macro F1 0.9357353 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.2850987911224365
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1035453  Vali Loss: 0.1092723 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9630185  Vali macro F1 0.9395015 
new best score!!!!
Validation loss decreased (0.109629 --> 0.109272).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.272069215774536
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1016805  Vali Loss: 0.1119909 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9626377  Vali macro F1 0.9393811 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.263528823852539
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1029350  Vali Loss: 0.1111203 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9645488  Vali macro F1 0.9410634 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.256533145904541
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1017582  Vali Loss: 0.1093136 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9650546  Vali macro F1 0.9433547 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.257210731506348
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1041302  Vali Loss: 0.1092845 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9651382  Vali macro F1 0.9426623 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.256535768508911
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1026757  Vali Loss: 0.1084694 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9646161  Vali macro F1 0.9423535 
new best score!!!!
Validation loss decreased (0.109272 --> 0.108469).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.258226633071899
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0994165  Vali Loss: 0.1106857 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9627588  Vali macro F1 0.9414314 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.288289546966553
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1000356  Vali Loss: 0.1101903 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9636662  Vali macro F1 0.9399625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.261051893234253
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0979585  Vali Loss: 0.1063844 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9635582  Vali macro F1 0.9404448 
new best score!!!!
Validation loss decreased (0.108469 --> 0.106384).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.2916717529296875
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0987269  Vali Loss: 0.1021179 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9658804  Vali macro F1 0.9445998 
new best score!!!!
Validation loss decreased (0.106384 --> 0.102118).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.267036437988281
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1005029  Vali Loss: 0.1142145 Vali Accuracy: 0.9603764  Vali weighted F1: 0.9608898  Vali macro F1 0.9391332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.263935804367065
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1000432  Vali Loss: 0.1101323 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9637405  Vali macro F1 0.9437297 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.257669925689697
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0999333  Vali Loss: 0.1080101 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9646681  Vali macro F1 0.9436767 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.2694172859191895
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0959680  Vali Loss: 0.1098085 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9631953  Vali macro F1 0.9397191 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.274128198623657
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0988165  Vali Loss: 0.1001973 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9660106  Vali macro F1 0.9435125 
new best score!!!!
Validation loss decreased (0.102118 --> 0.100197).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.270925998687744
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0994663  Vali Loss: 0.1007026 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9655399  Vali macro F1 0.9422482 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.274121522903442
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0933339  Vali Loss: 0.1009040 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9659999  Vali macro F1 0.9439839 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.28005313873291
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0964015  Vali Loss: 0.1091335 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9637037  Vali macro F1 0.9412254 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.275838613510132
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0947249  Vali Loss: 0.1003907 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9669201  Vali macro F1 0.9437072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.29021430015564
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0962839  Vali Loss: 0.1145960 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9619299  Vali macro F1 0.9390523 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 29 cost time: 6.260014057159424
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0913050  Vali Loss: 0.1039680 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9645421  Vali macro F1 0.9411141 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.257754564285278
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0928867  Vali Loss: 0.1044370 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9636063  Vali macro F1 0.9401055 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.252172470092773
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0927531  Vali Loss: 0.1037831 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9645421  Vali macro F1 0.9411141 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.247066020965576
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0905958  Vali Loss: 0.1030843 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9650347  Vali macro F1 0.9419579 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.264031171798706
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0922150  Vali Loss: 0.1034317 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9660406  Vali macro F1 0.9437810 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 34 cost time: 6.264930486679077
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0903073  Vali Loss: 0.1033848 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9655624  Vali macro F1 0.9425229 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 6.2769975662231445
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0926258  Vali Loss: 0.1031803 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9650347  Vali macro F1 0.9419579 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 6.282851696014404
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0914086  Vali Loss: 0.1032757 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9650347  Vali macro F1 0.9419579 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 6.2726757526397705
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0907378  Vali Loss: 0.1032841 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9650347  Vali macro F1 0.9419579 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 6.2599711418151855
Fine Tuning VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0908025  Vali Loss: 0.1033276 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9650347  Vali macro F1 0.9419579 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7559763  Test weighted F1: 0.7598032  Test macro F1 0.7563343 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014665 0.00017765 0.00108578 0.00135318 0.00049407 0.00062383]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.0866148471832275
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.5251733  Vali Loss: 1.1250121 Vali Accuracy: 0.6631152  Vali weighted F1: 0.5581900  Vali macro F1 0.2693147 
Validation loss decreased (inf --> 1.125012).  Saving model ...
Epoch: 2 cost time: 6.090170383453369
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8841334  Vali Loss: 0.7266979 Vali Accuracy: 0.7584982  Vali weighted F1: 0.6922831  Vali macro F1 0.4675799 
new best score!!!!
Validation loss decreased (1.125012 --> 0.726698).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.093523025512695
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6621873  Vali Loss: 0.6059724 Vali Accuracy: 0.7666159  Vali weighted F1: 0.7086736  Vali macro F1 0.4894179 
new best score!!!!
Validation loss decreased (0.726698 --> 0.605972).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.080668926239014
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5808516  Vali Loss: 0.5513120 Vali Accuracy: 0.7874176  Vali weighted F1: 0.7347252  Vali macro F1 0.5224690 
new best score!!!!
Validation loss decreased (0.605972 --> 0.551312).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.097523212432861
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4873587  Vali Loss: 0.4214185 Vali Accuracy: 0.8391679  Vali weighted F1: 0.8088335  Vali macro F1 0.6144486 
new best score!!!!
Validation loss decreased (0.551312 --> 0.421418).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.1251747608184814
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.4042390  Vali Loss: 0.3593011 Vali Accuracy: 0.8594622  Vali weighted F1: 0.8399604  Vali macro F1 0.6616084 
new best score!!!!
Validation loss decreased (0.421418 --> 0.359301).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.126140356063843
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3424420  Vali Loss: 0.3268001 Vali Accuracy: 0.8985287  Vali weighted F1: 0.8932425  Vali macro F1 0.8485765 
new best score!!!!
Validation loss decreased (0.359301 --> 0.326800).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.105342388153076
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2792635  Vali Loss: 0.2511396 Vali Accuracy: 0.9223744  Vali weighted F1: 0.9222928  Vali macro F1 0.8884491 
new best score!!!!
Validation loss decreased (0.326800 --> 0.251140).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.109551191329956
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2445412  Vali Loss: 0.2323134 Vali Accuracy: 0.9218671  Vali weighted F1: 0.9233065  Vali macro F1 0.8916712 
new best score!!!!
Validation loss decreased (0.251140 --> 0.232313).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.102958679199219
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2207814  Vali Loss: 0.2057579 Vali Accuracy: 0.9304921  Vali weighted F1: 0.9304320  Vali macro F1 0.9016840 
new best score!!!!
Validation loss decreased (0.232313 --> 0.205758).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.107717037200928
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2040147  Vali Loss: 0.2360479 Vali Accuracy: 0.9203450  Vali weighted F1: 0.9208616  Vali macro F1 0.8902858 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.106210947036743
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1986733  Vali Loss: 0.1946771 Vali Accuracy: 0.9360731  Vali weighted F1: 0.9358572  Vali macro F1 0.9126205 
new best score!!!!
Validation loss decreased (0.205758 --> 0.194677).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.101710319519043
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1800734  Vali Loss: 0.1941679 Vali Accuracy: 0.9345510  Vali weighted F1: 0.9356471  Vali macro F1 0.9030378 
new best score!!!!
Validation loss decreased (0.194677 --> 0.194168).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.107979774475098
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1775312  Vali Loss: 0.2296793 Vali Accuracy: 0.9279554  Vali weighted F1: 0.9271343  Vali macro F1 0.9027492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.1149375438690186
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1682810  Vali Loss: 0.1779652 Vali Accuracy: 0.9396246  Vali weighted F1: 0.9409946  Vali macro F1 0.9218031 
new best score!!!!
Validation loss decreased (0.194168 --> 0.177965).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.120623350143433
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1626041  Vali Loss: 0.1875671 Vali Accuracy: 0.9446981  Vali weighted F1: 0.9448150  Vali macro F1 0.9278859 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.1028783321380615
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1505993  Vali Loss: 0.1525912 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9496418  Vali macro F1 0.9323617 
new best score!!!!
Validation loss decreased (0.177965 --> 0.152591).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.097581386566162
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1539488  Vali Loss: 0.1758687 Vali Accuracy: 0.9431761  Vali weighted F1: 0.9439363  Vali macro F1 0.9272476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.1195807456970215
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1485838  Vali Loss: 0.1526760 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9539071  Vali macro F1 0.9393705 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.115239143371582
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1450363  Vali Loss: 0.1521692 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9499994  Vali macro F1 0.9362112 
new best score!!!!
Validation loss decreased (0.152591 --> 0.152169).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.102563858032227
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1412533  Vali Loss: 0.1471502 Vali Accuracy: 0.9548453  Vali weighted F1: 0.9552420  Vali macro F1 0.9423152 
new best score!!!!
Validation loss decreased (0.152169 --> 0.147150).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.100458383560181
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1387163  Vali Loss: 0.1646319 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9523615  Vali macro F1 0.9390169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.1077516078948975
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1398207  Vali Loss: 0.1368943 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9562515  Vali macro F1 0.9445068 
new best score!!!!
Validation loss decreased (0.147150 --> 0.136894).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.104472875595093
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1336553  Vali Loss: 0.1412776 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9587482  Vali macro F1 0.9466324 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.108737230300903
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1286545  Vali Loss: 0.1992387 Vali Accuracy: 0.9360731  Vali weighted F1: 0.9368100  Vali macro F1 0.9236225 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.117371320724487
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1245675  Vali Loss: 0.1385561 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9574630  Vali macro F1 0.9447541 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.100338459014893
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1223241  Vali Loss: 0.1472951 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9552632  Vali macro F1 0.9444930 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.109224081039429
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1165923  Vali Loss: 0.1420518 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9561734  Vali macro F1 0.9444279 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 6.105475664138794
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1096629  Vali Loss: 0.1324801 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9583924  Vali macro F1 0.9494130 
new best score!!!!
Validation loss decreased (0.136894 --> 0.132480).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.096585988998413
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1060286  Vali Loss: 0.1283773 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9593253  Vali macro F1 0.9502469 
new best score!!!!
Validation loss decreased (0.132480 --> 0.128377).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.100337505340576
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1065619  Vali Loss: 0.1285265 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9587735  Vali macro F1 0.9491438 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.0996034145355225
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1053476  Vali Loss: 0.1331948 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9582975  Vali macro F1 0.9484427 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.102792501449585
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.1034508  Vali Loss: 0.1298441 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9602009  Vali macro F1 0.9510298 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.115905523300171
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.1042936  Vali Loss: 0.1345648 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9574223  Vali macro F1 0.9482011 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.11324405670166
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.1035095  Vali Loss: 0.1261745 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9610985  Vali macro F1 0.9518032 
new best score!!!!
Validation loss decreased (0.128377 --> 0.126175).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.113363742828369
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.1047280  Vali Loss: 0.1246175 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9612811  Vali macro F1 0.9526757 
new best score!!!!
Validation loss decreased (0.126175 --> 0.124617).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.099997043609619
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.1034520  Vali Loss: 0.1275050 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9611667  Vali macro F1 0.9518535 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.094597339630127
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.1039341  Vali Loss: 0.1370190 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9581078  Vali macro F1 0.9493427 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.088997840881348
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.1035441  Vali Loss: 0.1258907 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9607624  Vali macro F1 0.9515181 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.096684455871582
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.1035032  Vali Loss: 0.1401482 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9534170  Vali macro F1 0.9451691 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.101336240768433
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.1036478  Vali Loss: 0.1295472 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9612458  Vali macro F1 0.9535041 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 6.100711345672607
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.1016311  Vali Loss: 0.1264233 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9607521  Vali macro F1 0.9522219 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.11484956741333
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.1023334  Vali Loss: 0.1271527 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9612614  Vali macro F1 0.9527812 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.11750340461731
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0995819  Vali Loss: 0.1273702 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9617579  Vali macro F1 0.9536079 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.102460145950317
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0999890  Vali Loss: 0.1266747 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9622338  Vali macro F1 0.9541508 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.097765684127808
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0990591  Vali Loss: 0.1271738 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9612614  Vali macro F1 0.9527812 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 6.089367389678955
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0997002  Vali Loss: 0.1270831 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9612614  Vali macro F1 0.9527812 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.091015815734863
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.1005032  Vali Loss: 0.1270032 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9617361  Vali macro F1 0.9533219 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.091512203216553
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.1006092  Vali Loss: 0.1270010 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9617361  Vali macro F1 0.9533219 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.103049993515015
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0985218  Vali Loss: 0.1270046 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9617361  Vali macro F1 0.9533219 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.094680309295654
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.1011431  Vali Loss: 0.1270203 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9617361  Vali macro F1 0.9533219 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9240821  Test weighted F1: 0.9243663  Test macro F1 0.8659221 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.126044988632202
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.1063871  Vali Loss: 0.1238948 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9624956  Vali macro F1 0.9549109 
Validation loss decreased (inf --> 0.123895).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.0991575717926025
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.1024364  Vali Loss: 0.1355459 Vali Accuracy: 0.9548453  Vali weighted F1: 0.9553798  Vali macro F1 0.9456132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.086334705352783
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.1007782  Vali Loss: 0.1251835 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9607005  Vali macro F1 0.9519355 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.079211235046387
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.1023010  Vali Loss: 0.1289201 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9608026  Vali macro F1 0.9514145 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.091518878936768
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1007970  Vali Loss: 0.1317855 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597820  Vali macro F1 0.9499671 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.0935375690460205
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0997142  Vali Loss: 0.1311006 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9601490  Vali macro F1 0.9513577 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.089452743530273
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1015876  Vali Loss: 0.1188108 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9617042  Vali macro F1 0.9535966 
new best score!!!!
Validation loss decreased (0.123895 --> 0.118811).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.0902626514434814
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0998444  Vali Loss: 0.1301493 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9621378  Vali macro F1 0.9526324 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.0942466259002686
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0987988  Vali Loss: 0.1313729 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597514  Vali macro F1 0.9507279 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.102392911911011
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1006594  Vali Loss: 0.1202530 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9616966  Vali macro F1 0.9534721 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.135309457778931
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0972119  Vali Loss: 0.1272130 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9613098  Vali macro F1 0.9522375 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.1154258251190186
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0986784  Vali Loss: 0.1275735 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9584294  Vali macro F1 0.9501417 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.096595287322998
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0972286  Vali Loss: 0.1248055 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9602754  Vali macro F1 0.9522621 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.0843586921691895
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0954962  Vali Loss: 0.1262369 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9602552  Vali macro F1 0.9522988 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.087046384811401
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0970270  Vali Loss: 0.1246884 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597803  Vali macro F1 0.9514128 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.09854793548584
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0954303  Vali Loss: 0.1266925 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9592374  Vali macro F1 0.9512760 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.092095375061035
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0934218  Vali Loss: 0.1263825 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597610  Vali macro F1 0.9514508 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 18 cost time: 6.089506387710571
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0958414  Vali Loss: 0.1264456 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597610  Vali macro F1 0.9514508 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.0829243659973145
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0965606  Vali Loss: 0.1263647 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597610  Vali macro F1 0.9514508 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.1006927490234375
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0973560  Vali Loss: 0.1262204 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597610  Vali macro F1 0.9514508 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.102473735809326
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0969121  Vali Loss: 0.1260164 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9597803  Vali macro F1 0.9514128 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.086137056350708
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0995152  Vali Loss: 0.1261680 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9602498  Vali macro F1 0.9519260 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9282231  Test weighted F1: 0.9283375  Test macro F1 0.8714336 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00014041 0.00018215 0.00102459 0.00129702 0.00049213 0.0005963 ]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.224093198776245
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.4983390  Vali Loss: 1.0554542 Vali Accuracy: 0.6623506  Vali weighted F1: 0.5573734  Vali macro F1 0.2714509 
Validation loss decreased (inf --> 1.055454).  Saving model ...
Epoch: 2 cost time: 6.216108798980713
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.8274869  Vali Loss: 0.7002737 Vali Accuracy: 0.7465139  Vali weighted F1: 0.6644207  Vali macro F1 0.4311678 
new best score!!!!
Validation loss decreased (1.055454 --> 0.700274).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.208318710327148
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.6372035  Vali Loss: 0.5887640 Vali Accuracy: 0.7709163  Vali weighted F1: 0.7126025  Vali macro F1 0.4895597 
new best score!!!!
Validation loss decreased (0.700274 --> 0.588764).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.200678825378418
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.5734726  Vali Loss: 0.5557519 Vali Accuracy: 0.7853586  Vali weighted F1: 0.7295557  Vali macro F1 0.5069581 
new best score!!!!
Validation loss decreased (0.588764 --> 0.555752).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.208951473236084
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.5413642  Vali Loss: 0.5506802 Vali Accuracy: 0.7823705  Vali weighted F1: 0.7315988  Vali macro F1 0.5177011 
new best score!!!!
Validation loss decreased (0.555752 --> 0.550680).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.236316919326782
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.5134580  Vali Loss: 0.4810727 Vali Accuracy: 0.8107570  Vali weighted F1: 0.7773084  Vali macro F1 0.5801648 
new best score!!!!
Validation loss decreased (0.550680 --> 0.481073).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.222086668014526
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.4263972  Vali Loss: 0.3766123 Vali Accuracy: 0.8735060  Vali weighted F1: 0.8645373  Vali macro F1 0.8054741 
new best score!!!!
Validation loss decreased (0.481073 --> 0.376612).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.249042987823486
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.3329461  Vali Loss: 0.2963926 Vali Accuracy: 0.8974104  Vali weighted F1: 0.8924828  Vali macro F1 0.8478345 
new best score!!!!
Validation loss decreased (0.376612 --> 0.296393).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.223783016204834
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2736500  Vali Loss: 0.2512570 Vali Accuracy: 0.9168327  Vali weighted F1: 0.9138563  Vali macro F1 0.8767491 
new best score!!!!
Validation loss decreased (0.296393 --> 0.251257).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.21655011177063
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.2400543  Vali Loss: 0.2537264 Vali Accuracy: 0.9153386  Vali weighted F1: 0.9112440  Vali macro F1 0.8797892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.21651291847229
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.2162712  Vali Loss: 0.2606586 Vali Accuracy: 0.9163347  Vali weighted F1: 0.9134412  Vali macro F1 0.8804893 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.219817161560059
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.2167868  Vali Loss: 0.1871465 Vali Accuracy: 0.9362550  Vali weighted F1: 0.9358391  Vali macro F1 0.9056002 
new best score!!!!
Validation loss decreased (0.251257 --> 0.187146).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.20940899848938
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1925743  Vali Loss: 0.1664952 Vali Accuracy: 0.9442231  Vali weighted F1: 0.9440259  Vali macro F1 0.9185008 
new best score!!!!
Validation loss decreased (0.187146 --> 0.166495).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.215348482131958
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1839857  Vali Loss: 0.1824312 Vali Accuracy: 0.9442231  Vali weighted F1: 0.9444399  Vali macro F1 0.9206022 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.220306158065796
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1777278  Vali Loss: 0.1774009 Vali Accuracy: 0.9457171  Vali weighted F1: 0.9454582  Vali macro F1 0.9258973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.23246955871582
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1668748  Vali Loss: 0.1596195 Vali Accuracy: 0.9492032  Vali weighted F1: 0.9487186  Vali macro F1 0.9292837 
new best score!!!!
Validation loss decreased (0.166495 --> 0.159620).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.251339912414551
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1670464  Vali Loss: 0.1621620 Vali Accuracy: 0.9472112  Vali weighted F1: 0.9469277  Vali macro F1 0.9270034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.2199201583862305
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1659261  Vali Loss: 0.1479724 Vali Accuracy: 0.9541833  Vali weighted F1: 0.9535391  Vali macro F1 0.9363747 
new best score!!!!
Validation loss decreased (0.159620 --> 0.147972).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.2244861125946045
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1465929  Vali Loss: 0.1431138 Vali Accuracy: 0.9556773  Vali weighted F1: 0.9556509  Vali macro F1 0.9380341 
new best score!!!!
Validation loss decreased (0.147972 --> 0.143114).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.2201879024505615
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1474454  Vali Loss: 0.1480405 Vali Accuracy: 0.9467131  Vali weighted F1: 0.9475020  Vali macro F1 0.9254314 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.220832109451294
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1393946  Vali Loss: 0.1412928 Vali Accuracy: 0.9526892  Vali weighted F1: 0.9524565  Vali macro F1 0.9328480 
new best score!!!!
Validation loss decreased (0.143114 --> 0.141293).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.213965654373169
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1357255  Vali Loss: 0.1276491 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9607893  Vali macro F1 0.9440057 
new best score!!!!
Validation loss decreased (0.141293 --> 0.127649).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.221097230911255
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1348808  Vali Loss: 0.1258693 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9605135  Vali macro F1 0.9440288 
new best score!!!!
Validation loss decreased (0.127649 --> 0.125869).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.215098142623901
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1268047  Vali Loss: 0.1272934 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9609776  Vali macro F1 0.9402185 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.199041128158569
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1381829  Vali Loss: 0.1292639 Vali Accuracy: 0.9601594  Vali weighted F1: 0.9599846  Vali macro F1 0.9427783 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.225494623184204
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1273238  Vali Loss: 0.1201006 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9643412  Vali macro F1 0.9499411 
new best score!!!!
Validation loss decreased (0.125869 --> 0.120101).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.1994946002960205
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1169259  Vali Loss: 0.1441956 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9580062  Vali macro F1 0.9411692 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.207460165023804
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1212460  Vali Loss: 0.1403455 Vali Accuracy: 0.9492032  Vali weighted F1: 0.9484816  Vali macro F1 0.9297028 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.206933259963989
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1124011  Vali Loss: 0.1242376 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9595028  Vali macro F1 0.9440843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.214176893234253
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1182144  Vali Loss: 0.1378558 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9578983  Vali macro F1 0.9437710 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.201596975326538
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.1130191  Vali Loss: 0.1116450 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9682781  Vali macro F1 0.9564653 
new best score!!!!
Validation loss decreased (0.120101 --> 0.111645).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.219851732254028
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.1083769  Vali Loss: 0.1070164 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9668030  Vali macro F1 0.9525989 
new best score!!!!
Validation loss decreased (0.111645 --> 0.107016).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.212826251983643
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.1009474  Vali Loss: 0.1160995 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9636023  Vali macro F1 0.9509668 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.228753328323364
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.1051677  Vali Loss: 0.1027138 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718878  Vali macro F1 0.9592206 
new best score!!!!
Validation loss decreased (0.107016 --> 0.102714).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.219475030899048
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.1017903  Vali Loss: 0.1106580 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9677485  Vali macro F1 0.9549979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.227612257003784
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0962111  Vali Loss: 0.1201324 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9630597  Vali macro F1 0.9481569 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.21768856048584
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0977890  Vali Loss: 0.1136628 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9638730  Vali macro F1 0.9515578 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.217164516448975
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0951766  Vali Loss: 0.1166287 Vali Accuracy: 0.9611554  Vali weighted F1: 0.9613447  Vali macro F1 0.9484494 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.2107226848602295
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.1003049  Vali Loss: 0.1044512 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9677543  Vali macro F1 0.9540466 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 6.220414161682129
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0864861  Vali Loss: 0.0994351 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9686197  Vali macro F1 0.9560132 
new best score!!!!
Validation loss decreased (0.102714 --> 0.099435).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.233656883239746
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0817092  Vali Loss: 0.1003649 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9682529  Vali macro F1 0.9550166 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.2271506786346436
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0802780  Vali Loss: 0.1010449 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9683922  Vali macro F1 0.9561928 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.21278715133667
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0835237  Vali Loss: 0.0981431 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697218  Vali macro F1 0.9570549 
new best score!!!!
Validation loss decreased (0.099435 --> 0.098143).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.239290714263916
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0813083  Vali Loss: 0.0980373 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702368  Vali macro F1 0.9576215 
new best score!!!!
Validation loss decreased (0.098143 --> 0.098037).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.2119646072387695
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0793138  Vali Loss: 0.0993370 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9672117  Vali macro F1 0.9538307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.210139036178589
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0794315  Vali Loss: 0.0989901 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9673247  Vali macro F1 0.9543607 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.207687854766846
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0795833  Vali Loss: 0.0976366 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697870  Vali macro F1 0.9573670 
new best score!!!!
Validation loss decreased (0.098037 --> 0.097637).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.206268072128296
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0798288  Vali Loss: 0.1002796 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9677572  Vali macro F1 0.9546857 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.204498291015625
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0794869  Vali Loss: 0.0972139 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9698431  Vali macro F1 0.9573157 
new best score!!!!
Validation loss decreased (0.097637 --> 0.097214).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.2183942794799805
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0793797  Vali Loss: 0.0994787 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697221  Vali macro F1 0.9569919 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.210277318954468
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0765540  Vali Loss: 0.0944649 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9711847  Vali macro F1 0.9586308 
new best score!!!!
Validation loss decreased (0.097214 --> 0.094465).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.202069044113159
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0770172  Vali Loss: 0.0971356 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9692174  Vali macro F1 0.9563426 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.200043201446533
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0775228  Vali Loss: 0.0988510 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9706634  Vali macro F1 0.9586687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.23106575012207
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0780486  Vali Loss: 0.0944159 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702094  Vali macro F1 0.9579626 
new best score!!!!
Validation loss decreased (0.094465 --> 0.094416).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.202716588973999
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0782713  Vali Loss: 0.0995083 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697590  Vali macro F1 0.9571602 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.223695755004883
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0808235  Vali Loss: 0.0952377 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9687369  Vali macro F1 0.9565720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.213392496109009
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0749113  Vali Loss: 0.0974733 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9711782  Vali macro F1 0.9582192 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.222305774688721
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0768638  Vali Loss: 0.0953259 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9692585  Vali macro F1 0.9569761 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.2217116355896
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0756005  Vali Loss: 0.0985390 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9687657  Vali macro F1 0.9561075 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 6.20934271812439
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0763151  Vali Loss: 0.0951725 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697419  Vali macro F1 0.9568525 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.199872255325317
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0744076  Vali Loss: 0.0953842 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9692383  Vali macro F1 0.9566710 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.209043264389038
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0748205  Vali Loss: 0.0948198 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707469  Vali macro F1 0.9582920 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.230557203292847
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0761426  Vali Loss: 0.0945077 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702351  Vali macro F1 0.9576827 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.31477689743042
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0731501  Vali Loss: 0.0941999 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702351  Vali macro F1 0.9576827 
new best score!!!!
Validation loss decreased (0.094416 --> 0.094200).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 6.232273101806641
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0751875  Vali Loss: 0.0948088 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702351  Vali macro F1 0.9576827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 7.49382472038269
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0727865  Vali Loss: 0.0944365 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697569  Vali macro F1 0.9572204 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 7.944424867630005
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0752698  Vali Loss: 0.0947439 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.231989860534668
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0745777  Vali Loss: 0.0944509 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707469  Vali macro F1 0.9582920 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.22947096824646
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0745511  Vali Loss: 0.0945609 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 70 cost time: 6.239055395126343
VALI: Epoch: 70, Steps: 71 | Train Loss: 0.0772966  Vali Loss: 0.0945812 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 6.241414546966553
VALI: Epoch: 71, Steps: 71 | Train Loss: 0.0731181  Vali Loss: 0.0945841 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 6.2605156898498535
VALI: Epoch: 72, Steps: 71 | Train Loss: 0.0730362  Vali Loss: 0.0945856 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 6.239420652389526
VALI: Epoch: 73, Steps: 71 | Train Loss: 0.0739724  Vali Loss: 0.0944140 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 6.232061862945557
VALI: Epoch: 74, Steps: 71 | Train Loss: 0.0758281  Vali Loss: 0.0944858 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 75 cost time: 6.241835117340088
VALI: Epoch: 75, Steps: 71 | Train Loss: 0.0750791  Vali Loss: 0.0944925 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 6.232905149459839
VALI: Epoch: 76, Steps: 71 | Train Loss: 0.0752964  Vali Loss: 0.0944962 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 77 cost time: 6.2415266036987305
VALI: Epoch: 77, Steps: 71 | Train Loss: 0.0755877  Vali Loss: 0.0944902 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 78 cost time: 6.24515175819397
VALI: Epoch: 78, Steps: 71 | Train Loss: 0.0760136  Vali Loss: 0.0944892 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 79 cost time: 6.249387979507446
VALI: Epoch: 79, Steps: 71 | Train Loss: 0.0766285  Vali Loss: 0.0944841 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697372  Vali macro F1 0.9574386 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9307249  Test weighted F1: 0.9286468  Test macro F1 0.8754757 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.273268699645996
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0759756  Vali Loss: 0.0929562 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9711841  Vali macro F1 0.9591583 
Validation loss decreased (inf --> 0.092956).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.209290266036987
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0751022  Vali Loss: 0.0975080 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697801  Vali macro F1 0.9563625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.229055404663086
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0745494  Vali Loss: 0.0939541 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9698230  Vali macro F1 0.9571605 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.222742795944214
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0742054  Vali Loss: 0.0934429 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9693300  Vali macro F1 0.9560141 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.210525751113892
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0755525  Vali Loss: 0.0971163 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707351  Vali macro F1 0.9578264 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.244961977005005
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0741184  Vali Loss: 0.0946709 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9722819  Vali macro F1 0.9595334 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.227907657623291
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0747987  Vali Loss: 0.0941995 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702443  Vali macro F1 0.9568075 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.213663101196289
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0715290  Vali Loss: 0.0943740 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9692695  Vali macro F1 0.9565635 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.221550703048706
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0731805  Vali Loss: 0.0950626 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702311  Vali macro F1 0.9568619 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.209045886993408
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0726898  Vali Loss: 0.0981830 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9692003  Vali macro F1 0.9561438 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.2419164180755615
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0711974  Vali Loss: 0.0939164 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712114  Vali macro F1 0.9586236 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.23510217666626
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0707201  Vali Loss: 0.0931887 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707193  Vali macro F1 0.9577957 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.261671543121338
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0722769  Vali Loss: 0.0929352 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707193  Vali macro F1 0.9577957 
new best score!!!!
Validation loss decreased (0.092956 --> 0.092935).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.230673551559448
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0710295  Vali Loss: 0.0931595 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717220  Vali macro F1 0.9592305 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.229095935821533
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0730288  Vali Loss: 0.0934065 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707193  Vali macro F1 0.9577957 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.233372688293457
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0711101  Vali Loss: 0.0927232 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717220  Vali macro F1 0.9592305 
new best score!!!!
Validation loss decreased (0.092935 --> 0.092723).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.234307527542114
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0742431  Vali Loss: 0.0929658 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712436  Vali macro F1 0.9588075 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.235592603683472
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0709869  Vali Loss: 0.0926657 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712436  Vali macro F1 0.9588075 
new best score!!!!
Validation loss decreased (0.092723 --> 0.092666).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.2339653968811035
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0731028  Vali Loss: 0.0935217 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.244548797607422
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0726946  Vali Loss: 0.0933848 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712436  Vali macro F1 0.9588075 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.230252265930176
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0716127  Vali Loss: 0.0929575 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712436  Vali macro F1 0.9588075 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.249183654785156
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0713960  Vali Loss: 0.0928604 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717638  Vali macro F1 0.9592955 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.233009576797485
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0733274  Vali Loss: 0.0933380 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 6.228636264801025
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0723601  Vali Loss: 0.0932405 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.237180948257446
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0726437  Vali Loss: 0.0934280 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.23428750038147
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0697023  Vali Loss: 0.0933030 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.229159593582153
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0715846  Vali Loss: 0.0933261 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 8.373921394348145
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0723166  Vali Loss: 0.0933063 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 29 cost time: 6.23237156867981
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0723611  Vali Loss: 0.0933036 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.245684862136841
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0726819  Vali Loss: 0.0932764 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707474  Vali macro F1 0.9579961 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.238378286361694
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0711248  Vali Loss: 0.0932571 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712436  Vali macro F1 0.9588075 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.241096258163452
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0692158  Vali Loss: 0.0932546 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712436  Vali macro F1 0.9588075 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.237368822097778
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0688194  Vali Loss: 0.0932576 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712436  Vali macro F1 0.9588075 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9336067  Test weighted F1: 0.9320053  Test macro F1 0.8848500 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 17919
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014613 0.00018073 0.00098135 0.00123762 0.00048216 0.00061576]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.200244426727295
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.3999125  Vali Loss: 0.9453316 Vali Accuracy: 0.6616390  Vali weighted F1: 0.5496833  Vali macro F1 0.2730037 
Validation loss decreased (inf --> 0.945332).  Saving model ...
Epoch: 2 cost time: 6.203324556350708
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8004934  Vali Loss: 0.7030196 Vali Accuracy: 0.7702363  Vali weighted F1: 0.7170347  Vali macro F1 0.5201011 
new best score!!!!
Validation loss decreased (0.945332 --> 0.703020).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.193618297576904
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6538025  Vali Loss: 0.5857101 Vali Accuracy: 0.7858220  Vali weighted F1: 0.7400858  Vali macro F1 0.5434608 
new best score!!!!
Validation loss decreased (0.703020 --> 0.585710).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2019641399383545
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.5236410  Vali Loss: 0.4590238 Vali Accuracy: 0.8185018  Vali weighted F1: 0.7878189  Vali macro F1 0.5955057 
new best score!!!!
Validation loss decreased (0.585710 --> 0.459024).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.224735260009766
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.4305707  Vali Loss: 0.3883941 Vali Accuracy: 0.8466566  Vali weighted F1: 0.8233840  Vali macro F1 0.6377462 
new best score!!!!
Validation loss decreased (0.459024 --> 0.388394).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.223683834075928
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3647764  Vali Loss: 0.3105562 Vali Accuracy: 0.8783308  Vali weighted F1: 0.8614835  Vali macro F1 0.6863845 
new best score!!!!
Validation loss decreased (0.388394 --> 0.310556).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.231647729873657
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3236152  Vali Loss: 0.2954477 Vali Accuracy: 0.8868778  Vali weighted F1: 0.8685802  Vali macro F1 0.6995587 
new best score!!!!
Validation loss decreased (0.310556 --> 0.295448).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.200798034667969
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2774598  Vali Loss: 0.2204542 Vali Accuracy: 0.9426848  Vali weighted F1: 0.9423007  Vali macro F1 0.9239004 
new best score!!!!
Validation loss decreased (0.295448 --> 0.220454).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.196744918823242
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2371572  Vali Loss: 0.1935689 Vali Accuracy: 0.9472097  Vali weighted F1: 0.9465119  Vali macro F1 0.9305679 
new best score!!!!
Validation loss decreased (0.220454 --> 0.193569).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.201769113540649
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2042030  Vali Loss: 0.1659224 Vali Accuracy: 0.9492207  Vali weighted F1: 0.9489375  Vali macro F1 0.9364290 
new best score!!!!
Validation loss decreased (0.193569 --> 0.165922).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.202301502227783
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1914538  Vali Loss: 0.1680863 Vali Accuracy: 0.9492207  Vali weighted F1: 0.9491080  Vali macro F1 0.9365514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.199682950973511
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1851081  Vali Loss: 0.1552540 Vali Accuracy: 0.9487179  Vali weighted F1: 0.9482194  Vali macro F1 0.9329550 
new best score!!!!
Validation loss decreased (0.165922 --> 0.155254).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.20093035697937
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1742426  Vali Loss: 0.1444268 Vali Accuracy: 0.9542484  Vali weighted F1: 0.9536888  Vali macro F1 0.9418550 
new best score!!!!
Validation loss decreased (0.155254 --> 0.144427).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.200787544250488
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1681549  Vali Loss: 0.1352000 Vali Accuracy: 0.9567622  Vali weighted F1: 0.9564116  Vali macro F1 0.9431370 
new best score!!!!
Validation loss decreased (0.144427 --> 0.135200).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.213515043258667
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1649487  Vali Loss: 0.1420067 Vali Accuracy: 0.9547511  Vali weighted F1: 0.9541489  Vali macro F1 0.9415760 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.219310522079468
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1556529  Vali Loss: 0.1402001 Vali Accuracy: 0.9582705  Vali weighted F1: 0.9579307  Vali macro F1 0.9442060 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.196743726730347
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1518205  Vali Loss: 0.1236575 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9614250  Vali macro F1 0.9501268 
new best score!!!!
Validation loss decreased (0.135200 --> 0.123657).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.18384861946106
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1426445  Vali Loss: 0.1250738 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9573896  Vali macro F1 0.9460659 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.198198556900024
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1403176  Vali Loss: 0.1197732 Vali Accuracy: 0.9602815  Vali weighted F1: 0.9599867  Vali macro F1 0.9496829 
new best score!!!!
Validation loss decreased (0.123657 --> 0.119773).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.199097394943237
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1309114  Vali Loss: 0.1141202 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9630058  Vali macro F1 0.9524381 
new best score!!!!
Validation loss decreased (0.119773 --> 0.114120).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.193845987319946
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1297626  Vali Loss: 0.1158201 Vali Accuracy: 0.9607843  Vali weighted F1: 0.9604973  Vali macro F1 0.9497924 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.200779914855957
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1238843  Vali Loss: 0.1105356 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9628139  Vali macro F1 0.9532932 
new best score!!!!
Validation loss decreased (0.114120 --> 0.110536).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.194460153579712
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1178869  Vali Loss: 0.1096417 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9628729  Vali macro F1 0.9513316 
new best score!!!!
Validation loss decreased (0.110536 --> 0.109642).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.214526891708374
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1178284  Vali Loss: 0.0998222 Vali Accuracy: 0.9638009  Vali weighted F1: 0.9638557  Vali macro F1 0.9516253 
new best score!!!!
Validation loss decreased (0.109642 --> 0.099822).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.20372200012207
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1109760  Vali Loss: 0.1019856 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9640685  Vali macro F1 0.9518764 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.22347354888916
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1062897  Vali Loss: 0.0976701 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9668246  Vali macro F1 0.9558452 
new best score!!!!
Validation loss decreased (0.099822 --> 0.097670).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.215627431869507
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1091092  Vali Loss: 0.1011840 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9644717  Vali macro F1 0.9503645 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.205854177474976
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0951075  Vali Loss: 0.0944070 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9698894  Vali macro F1 0.9604403 
new best score!!!!
Validation loss decreased (0.097670 --> 0.094407).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.2012715339660645
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0978823  Vali Loss: 0.0919249 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9679099  Vali macro F1 0.9553728 
new best score!!!!
Validation loss decreased (0.094407 --> 0.091925).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.199422359466553
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0946515  Vali Loss: 0.1054286 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9647963  Vali macro F1 0.9533230 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.207064390182495
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0969597  Vali Loss: 0.0926974 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9673547  Vali macro F1 0.9525221 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.20065450668335
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0900972  Vali Loss: 0.0844617 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9677818  Vali macro F1 0.9504467 
new best score!!!!
Validation loss decreased (0.091925 --> 0.084462).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.203534364700317
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0866804  Vali Loss: 0.1187063 Vali Accuracy: 0.9592760  Vali weighted F1: 0.9587621  Vali macro F1 0.9462925 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.215667247772217
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0850465  Vali Loss: 0.0917204 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9699509  Vali macro F1 0.9521514 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.209578990936279
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0858932  Vali Loss: 0.0839912 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9728431  Vali macro F1 0.9627094 
new best score!!!!
Validation loss decreased (0.084462 --> 0.083991).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.2215776443481445
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0854300  Vali Loss: 0.1165490 Vali Accuracy: 0.9602815  Vali weighted F1: 0.9607464  Vali macro F1 0.9471757 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.204584121704102
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0830248  Vali Loss: 0.0875480 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9673300  Vali macro F1 0.9520702 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.196155786514282
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0803872  Vali Loss: 0.0986753 Vali Accuracy: 0.9663147  Vali weighted F1: 0.9664891  Vali macro F1 0.9507240 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.1970765590667725
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0760745  Vali Loss: 0.0824526 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9734234  Vali macro F1 0.9573730 
new best score!!!!
Validation loss decreased (0.083991 --> 0.082453).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.199501037597656
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0723543  Vali Loss: 0.0978447 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9648081  Vali macro F1 0.9510343 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.193340063095093
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0790484  Vali Loss: 0.0861566 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9732402  Vali macro F1 0.9650618 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.197052001953125
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0758948  Vali Loss: 0.0782331 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759650  Vali macro F1 0.9667686 
new best score!!!!
Validation loss decreased (0.082453 --> 0.078233).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.198139190673828
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0756229  Vali Loss: 0.1359987 Vali Accuracy: 0.9532428  Vali weighted F1: 0.9540555  Vali macro F1 0.9437749 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.206589460372925
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0687920  Vali Loss: 0.0881756 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9711962  Vali macro F1 0.9604842 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.19825553894043
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0667247  Vali Loss: 0.0751881 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9784981  Vali macro F1 0.9704497 
new best score!!!!
Validation loss decreased (0.078233 --> 0.075188).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.222425937652588
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0683365  Vali Loss: 0.0738315 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769699  Vali macro F1 0.9645533 
new best score!!!!
Validation loss decreased (0.075188 --> 0.073831).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.196983575820923
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0646000  Vali Loss: 0.0934906 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9678213  Vali macro F1 0.9539731 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.200850248336792
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0696413  Vali Loss: 0.0815590 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9770871  Vali macro F1 0.9691297 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.198918104171753
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0602786  Vali Loss: 0.0738767 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9780440  Vali macro F1 0.9665377 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.19045352935791
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0590857  Vali Loss: 0.0765277 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819429  Vali macro F1 0.9757584 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.193056583404541
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0600831  Vali Loss: 0.0791806 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9751977  Vali macro F1 0.9644054 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 52 cost time: 6.197531223297119
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0532209  Vali Loss: 0.0738767 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9790518  Vali macro F1 0.9701826 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.215050220489502
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0465865  Vali Loss: 0.0704101 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799770  Vali macro F1 0.9715962 
new best score!!!!
Validation loss decreased (0.073831 --> 0.070410).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.215414524078369
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0484959  Vali Loss: 0.0709318 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809791  Vali macro F1 0.9726153 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.221548080444336
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0471386  Vali Loss: 0.0694784 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799803  Vali macro F1 0.9710731 
new best score!!!!
Validation loss decreased (0.070410 --> 0.069478).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.211632013320923
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0461506  Vali Loss: 0.0704336 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799720  Vali macro F1 0.9713475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.19819450378418
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0473046  Vali Loss: 0.0738420 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769862  Vali macro F1 0.9675342 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.197263717651367
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0470343  Vali Loss: 0.0704339 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794756  Vali macro F1 0.9708235 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.197757244110107
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0465411  Vali Loss: 0.0700072 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804721  Vali macro F1 0.9721201 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.207693338394165
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0479043  Vali Loss: 0.0728441 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9790226  Vali macro F1 0.9703723 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 61 cost time: 6.207010984420776
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0466630  Vali Loss: 0.0703906 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795066  Vali macro F1 0.9708454 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.21039605140686
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0457021  Vali Loss: 0.0702923 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9790072  Vali macro F1 0.9691417 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.221939325332642
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0449360  Vali Loss: 0.0710642 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795233  Vali macro F1 0.9711429 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.205512523651123
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0461050  Vali Loss: 0.0706614 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789942  Vali macro F1 0.9703511 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.217301607131958
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0447143  Vali Loss: 0.0723230 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9800365  Vali macro F1 0.9716611 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 66 cost time: 6.205708980560303
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0461794  Vali Loss: 0.0719905 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9800365  Vali macro F1 0.9716611 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.1959404945373535
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0448602  Vali Loss: 0.0717218 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9790257  Vali macro F1 0.9703742 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.198356866836548
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0457954  Vali Loss: 0.0715527 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9790257  Vali macro F1 0.9703742 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.20224928855896
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0468608  Vali Loss: 0.0715945 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9790257  Vali macro F1 0.9703742 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.2044243812561035
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0464181  Vali Loss: 0.0714138 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795066  Vali macro F1 0.9708454 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8305017  Test weighted F1: 0.8412051  Test macro F1 0.7514238 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.228191137313843
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0481160  Vali Loss: 0.0748391 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9774918  Vali macro F1 0.9685873 
Validation loss decreased (inf --> 0.074839).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.215145111083984
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0465478  Vali Loss: 0.0713702 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804877  Vali macro F1 0.9720895 
new best score!!!!
Validation loss decreased (0.074839 --> 0.071370).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.220049142837524
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0453119  Vali Loss: 0.0751061 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789982  Vali macro F1 0.9705935 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.215956449508667
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0451698  Vali Loss: 0.0862954 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9727032  Vali macro F1 0.9627571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.258764743804932
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0461501  Vali Loss: 0.0744424 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9780004  Vali macro F1 0.9681148 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.2011473178863525
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0452604  Vali Loss: 0.0742859 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794703  Vali macro F1 0.9713421 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.206700801849365
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0457482  Vali Loss: 0.0713033 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9785192  Vali macro F1 0.9698788 
new best score!!!!
Validation loss decreased (0.071370 --> 0.071303).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.21836256980896
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0449809  Vali Loss: 0.0711412 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9805447  Vali macro F1 0.9736991 
new best score!!!!
Validation loss decreased (0.071303 --> 0.071141).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.2002644538879395
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0439941  Vali Loss: 0.0691007 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9800348  Vali macro F1 0.9725152 
new best score!!!!
Validation loss decreased (0.071141 --> 0.069101).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.199823617935181
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0438486  Vali Loss: 0.0704873 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809847  Vali macro F1 0.9728589 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.213807821273804
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0443951  Vali Loss: 0.0695485 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794862  Vali macro F1 0.9701339 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.245392322540283
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0441087  Vali Loss: 0.0719875 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9779577  Vali macro F1 0.9675044 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.225219011306763
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0436905  Vali Loss: 0.0673679 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809563  Vali macro F1 0.9725937 
new best score!!!!
Validation loss decreased (0.069101 --> 0.067368).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.2165563106536865
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0441006  Vali Loss: 0.0736623 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795494  Vali macro F1 0.9702245 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.201042652130127
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0446561  Vali Loss: 0.0750847 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9780475  Vali macro F1 0.9681961 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.205266714096069
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0435651  Vali Loss: 0.0688084 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804823  Vali macro F1 0.9709079 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.2141008377075195
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0446556  Vali Loss: 0.0752904 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9775278  Vali macro F1 0.9671198 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.205474138259888
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0438529  Vali Loss: 0.0683451 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789957  Vali macro F1 0.9706564 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 6.205967426300049
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0429540  Vali Loss: 0.0778449 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9756320  Vali macro F1 0.9649899 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.21024489402771
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0414129  Vali Loss: 0.0715266 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9800260  Vali macro F1 0.9712163 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.216432332992554
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0435916  Vali Loss: 0.0673172 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794948  Vali macro F1 0.9714276 
new best score!!!!
Validation loss decreased (0.067368 --> 0.067317).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.227621078491211
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0440080  Vali Loss: 0.0713905 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9784540  Vali macro F1 0.9680381 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.2054338455200195
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0426400  Vali Loss: 0.0764534 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9765589  Vali macro F1 0.9667115 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.205149412155151
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0427820  Vali Loss: 0.0712188 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9785259  Vali macro F1 0.9684533 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.195821523666382
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0414818  Vali Loss: 0.0768627 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9770490  Vali macro F1 0.9681397 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.202139377593994
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0412442  Vali Loss: 0.0697969 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795398  Vali macro F1 0.9697490 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.204763412475586
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0398585  Vali Loss: 0.0697485 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799833  Vali macro F1 0.9716173 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.189929246902466
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0385169  Vali Loss: 0.0696602 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9805068  Vali macro F1 0.9721671 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.194800615310669
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0393941  Vali Loss: 0.0703715 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794772  Vali macro F1 0.9698855 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.237534046173096
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0377587  Vali Loss: 0.0699634 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795015  Vali macro F1 0.9696641 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.253742694854736
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0397614  Vali Loss: 0.0708513 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795229  Vali macro F1 0.9699938 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 6.215598821640015
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0395135  Vali Loss: 0.0706542 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795229  Vali macro F1 0.9699938 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.256953477859497
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0393679  Vali Loss: 0.0703792 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795229  Vali macro F1 0.9699938 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.201218843460083
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0392371  Vali Loss: 0.0702573 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9800007  Vali macro F1 0.9704354 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.211894989013672
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0396931  Vali Loss: 0.0702272 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795229  Vali macro F1 0.9699938 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.199142217636108
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0380974  Vali Loss: 0.0701337 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795229  Vali macro F1 0.9699938 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8332160  Test weighted F1: 0.8434744  Test macro F1 0.7522193 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00015004 0.00018238 0.0010989  0.00140056 0.00050813 0.00061996]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.001408576965332
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.4160368  Vali Loss: 0.9994828 Vali Accuracy: 0.6645931  Vali weighted F1: 0.5551790  Vali macro F1 0.2708341 
Validation loss decreased (inf --> 0.999483).  Saving model ...
Epoch: 2 cost time: 6.017592430114746
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.8302457  Vali Loss: 0.7315795 Vali Accuracy: 0.7532400  Vali weighted F1: 0.6641133  Vali macro F1 0.4374465 
new best score!!!!
Validation loss decreased (0.999483 --> 0.731579).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.03256893157959
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.6879837  Vali Loss: 0.6237263 Vali Accuracy: 0.7724209  Vali weighted F1: 0.7044740  Vali macro F1 0.4807179 
new best score!!!!
Validation loss decreased (0.731579 --> 0.623726).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.006094932556152
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.5356114  Vali Loss: 0.4431981 Vali Accuracy: 0.8216693  Vali weighted F1: 0.7910463  Vali macro F1 0.5693313 
new best score!!!!
Validation loss decreased (0.623726 --> 0.443198).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.016174793243408
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.4180172  Vali Loss: 0.3420846 Vali Accuracy: 0.8532919  Vali weighted F1: 0.8347722  Vali macro F1 0.6375960 
new best score!!!!
Validation loss decreased (0.443198 --> 0.342085).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.0200700759887695
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.3613441  Vali Loss: 0.3192078 Vali Accuracy: 0.8605495  Vali weighted F1: 0.8412817  Vali macro F1 0.6470615 
new best score!!!!
Validation loss decreased (0.342085 --> 0.319208).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.02292013168335
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.3289011  Vali Loss: 0.2959003 Vali Accuracy: 0.8683256  Vali weighted F1: 0.8494483  Vali macro F1 0.6608756 
new best score!!!!
Validation loss decreased (0.319208 --> 0.295900).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.006859064102173
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.2876437  Vali Loss: 0.2331054 Vali Accuracy: 0.9227579  Vali weighted F1: 0.9215866  Vali macro F1 0.8818164 
new best score!!!!
Validation loss decreased (0.295900 --> 0.233105).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.005094528198242
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.2351531  Vali Loss: 0.1937840 Vali Accuracy: 0.9383100  Vali weighted F1: 0.9389114  Vali macro F1 0.9084625 
new best score!!!!
Validation loss decreased (0.233105 --> 0.193784).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.0149757862091064
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.2104100  Vali Loss: 0.1855498 Vali Accuracy: 0.9367548  Vali weighted F1: 0.9364125  Vali macro F1 0.9050841 
new best score!!!!
Validation loss decreased (0.193784 --> 0.185550).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.025365591049194
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1848147  Vali Loss: 0.1846616 Vali Accuracy: 0.9383100  Vali weighted F1: 0.9377728  Vali macro F1 0.9102516 
new best score!!!!
Validation loss decreased (0.185550 --> 0.184662).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.020854949951172
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1713920  Vali Loss: 0.1501143 Vali Accuracy: 0.9543805  Vali weighted F1: 0.9538756  Vali macro F1 0.9328532 
new best score!!!!
Validation loss decreased (0.184662 --> 0.150114).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.02372407913208
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1610247  Vali Loss: 0.1521020 Vali Accuracy: 0.9533437  Vali weighted F1: 0.9527647  Vali macro F1 0.9332375 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.002882719039917
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1594585  Vali Loss: 0.1552791 Vali Accuracy: 0.9517885  Vali weighted F1: 0.9509975  Vali macro F1 0.9273163 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.0116376876831055
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1449112  Vali Loss: 0.1512410 Vali Accuracy: 0.9497149  Vali weighted F1: 0.9492303  Vali macro F1 0.9247103 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 6.004864692687988
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1436405  Vali Loss: 0.1606250 Vali Accuracy: 0.9491965  Vali weighted F1: 0.9487920  Vali macro F1 0.9259242 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 17 cost time: 6.002481937408447
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1361980  Vali Loss: 0.1388923 Vali Accuracy: 0.9569725  Vali weighted F1: 0.9563463  Vali macro F1 0.9382058 
new best score!!!!
Validation loss decreased (0.150114 --> 0.138892).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.013024091720581
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.1325749  Vali Loss: 0.1166968 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9667988  Vali macro F1 0.9500258 
new best score!!!!
Validation loss decreased (0.138892 --> 0.116697).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.013812303543091
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.1264084  Vali Loss: 0.1356572 Vali Accuracy: 0.9590461  Vali weighted F1: 0.9589489  Vali macro F1 0.9417914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.011586666107178
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.1278681  Vali Loss: 0.1332247 Vali Accuracy: 0.9611198  Vali weighted F1: 0.9607167  Vali macro F1 0.9433083 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.025510787963867
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.1160518  Vali Loss: 0.1276185 Vali Accuracy: 0.9606013  Vali weighted F1: 0.9602112  Vali macro F1 0.9423610 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.0289788246154785
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.1181015  Vali Loss: 0.1046746 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9681108  Vali macro F1 0.9523266 
new best score!!!!
Validation loss decreased (0.116697 --> 0.104675).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.003453016281128
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.1099954  Vali Loss: 0.1200458 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9645702  Vali macro F1 0.9459802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.016458988189697
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.1115598  Vali Loss: 0.1031308 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9689668  Vali macro F1 0.9522671 
new best score!!!!
Validation loss decreased (0.104675 --> 0.103131).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.010091781616211
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.1067007  Vali Loss: 0.0953000 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9705363  Vali macro F1 0.9549729 
new best score!!!!
Validation loss decreased (0.103131 --> 0.095300).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.010972738265991
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.1025045  Vali Loss: 0.0945221 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726172  Vali macro F1 0.9577886 
new best score!!!!
Validation loss decreased (0.095300 --> 0.094522).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.040268898010254
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0986775  Vali Loss: 0.0899188 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9715441  Vali macro F1 0.9563520 
new best score!!!!
Validation loss decreased (0.094522 --> 0.089919).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.028293132781982
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0988537  Vali Loss: 0.0921462 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726460  Vali macro F1 0.9573215 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.018685579299927
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0917884  Vali Loss: 0.0894985 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9731564  Vali macro F1 0.9589831 
new best score!!!!
Validation loss decreased (0.089919 --> 0.089499).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.0316667556762695
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0884746  Vali Loss: 0.0813268 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767435  Vali macro F1 0.9629859 
new best score!!!!
Validation loss decreased (0.089499 --> 0.081327).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.038739442825317
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0926025  Vali Loss: 0.0950225 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9694239  Vali macro F1 0.9545292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.023012638092041
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0882581  Vali Loss: 0.0861381 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9703490  Vali macro F1 0.9556570 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.032405853271484
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0863002  Vali Loss: 0.0861262 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9720128  Vali macro F1 0.9575264 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.017250299453735
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0799251  Vali Loss: 0.0803103 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756078  Vali macro F1 0.9609496 
new best score!!!!
Validation loss decreased (0.081327 --> 0.080310).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 9.741124868392944
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0813936  Vali Loss: 0.0765336 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762971  Vali macro F1 0.9623125 
new best score!!!!
Validation loss decreased (0.080310 --> 0.076534).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.078726053237915
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0835937  Vali Loss: 0.0782813 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9778349  Vali macro F1 0.9642450 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.026759624481201
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0781895  Vali Loss: 0.0844363 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9730401  Vali macro F1 0.9588997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.014926195144653
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0743820  Vali Loss: 0.0777892 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747210  Vali macro F1 0.9602581 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.031146287918091
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0733166  Vali Loss: 0.0789291 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9750864  Vali macro F1 0.9605945 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.0240256786346436
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0703709  Vali Loss: 0.0845324 Vali Accuracy: 0.9709694  Vali weighted F1: 0.9712636  Vali macro F1 0.9573618 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 6.037810325622559
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0621742  Vali Loss: 0.0726254 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751689  Vali macro F1 0.9610440 
new best score!!!!
Validation loss decreased (0.076534 --> 0.072625).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.023669719696045
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0576117  Vali Loss: 0.0717083 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756987  Vali macro F1 0.9618010 
new best score!!!!
Validation loss decreased (0.072625 --> 0.071708).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.032142162322998
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0589065  Vali Loss: 0.0699544 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756750  Vali macro F1 0.9610372 
new best score!!!!
Validation loss decreased (0.071708 --> 0.069954).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.015139579772949
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0609325  Vali Loss: 0.0714361 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757060  Vali macro F1 0.9610854 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.022320508956909
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0586258  Vali Loss: 0.0727666 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772390  Vali macro F1 0.9632758 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.018418550491333
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0561240  Vali Loss: 0.0722553 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9777250  Vali macro F1 0.9640847 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.03200888633728
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0578739  Vali Loss: 0.0698524 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766925  Vali macro F1 0.9624898 
new best score!!!!
Validation loss decreased (0.069954 --> 0.069852).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.017543792724609
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0590180  Vali Loss: 0.0728098 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772069  Vali macro F1 0.9639082 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.03309178352356
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0571715  Vali Loss: 0.0715965 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9771882  Vali macro F1 0.9635521 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.030550479888916
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0572825  Vali Loss: 0.0705339 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9761894  Vali macro F1 0.9618918 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.0473761558532715
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0571366  Vali Loss: 0.0687056 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772303  Vali macro F1 0.9628774 
new best score!!!!
Validation loss decreased (0.069852 --> 0.068706).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.014185428619385
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0573871  Vali Loss: 0.0720715 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9761894  Vali macro F1 0.9618918 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.029796123504639
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0567036  Vali Loss: 0.0697179 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9761894  Vali macro F1 0.9618918 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.018007040023804
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0577693  Vali Loss: 0.0699007 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767080  Vali macro F1 0.9627372 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.0366456508636475
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0554124  Vali Loss: 0.0719709 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9771783  Vali macro F1 0.9637588 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.00813889503479
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0552106  Vali Loss: 0.0702701 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 6.019984483718872
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0550549  Vali Loss: 0.0696596 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.021235466003418
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0537521  Vali Loss: 0.0699516 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.050138473510742
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0532638  Vali Loss: 0.0689209 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.030872106552124
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0552338  Vali Loss: 0.0689910 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.034358739852905
VALI: Epoch: 61, Steps: 68 | Train Loss: 0.0529187  Vali Loss: 0.0692968 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 6.02668309211731
VALI: Epoch: 62, Steps: 68 | Train Loss: 0.0550394  Vali Loss: 0.0693489 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.015293598175049
VALI: Epoch: 63, Steps: 68 | Train Loss: 0.0544914  Vali Loss: 0.0692820 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.021263599395752
VALI: Epoch: 64, Steps: 68 | Train Loss: 0.0533133  Vali Loss: 0.0693700 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.013051748275757
VALI: Epoch: 65, Steps: 68 | Train Loss: 0.0548191  Vali Loss: 0.0692998 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 6.029263496398926
VALI: Epoch: 66, Steps: 68 | Train Loss: 0.0539725  Vali Loss: 0.0691840 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766616  Vali macro F1 0.9624423 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9487219  Test weighted F1: 0.9499561  Test macro F1 0.9224079 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.028339385986328
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0576439  Vali Loss: 0.0684672 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762096  Vali macro F1 0.9615375 
Validation loss decreased (inf --> 0.068467).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.0161566734313965
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0549800  Vali Loss: 0.0740493 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766738  Vali macro F1 0.9626991 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.020323753356934
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0569467  Vali Loss: 0.0713095 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9761894  Vali macro F1 0.9618918 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 5.997171640396118
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0565303  Vali Loss: 0.0675031 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9777467  Vali macro F1 0.9639561 
new best score!!!!
Validation loss decreased (0.068467 --> 0.067503).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.006558179855347
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0582071  Vali Loss: 0.0692804 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767032  Vali macro F1 0.9627449 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.010509252548218
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0571533  Vali Loss: 0.0705484 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772166  Vali macro F1 0.9635966 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.00594425201416
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0576073  Vali Loss: 0.0688544 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767032  Vali macro F1 0.9627449 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.00764536857605
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0548563  Vali Loss: 0.0684855 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756750  Vali macro F1 0.9610372 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.006936073303223
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0548962  Vali Loss: 0.0721424 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772166  Vali macro F1 0.9635966 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.00986385345459
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0538697  Vali Loss: 0.0671064 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9777502  Vali macro F1 0.9638285 
new best score!!!!
Validation loss decreased (0.067503 --> 0.067106).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.023972272872925
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0550520  Vali Loss: 0.0719755 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772002  Vali macro F1 0.9639117 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.040830135345459
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0525210  Vali Loss: 0.0685681 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766799  Vali macro F1 0.9627227 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.029544115066528
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0557473  Vali Loss: 0.0699353 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751526  Vali macro F1 0.9607952 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.011185884475708
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0520951  Vali Loss: 0.0720613 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9746611  Vali macro F1 0.9601590 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.010629892349243
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0518215  Vali Loss: 0.0722878 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751228  Vali macro F1 0.9608500 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.017502307891846
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0522918  Vali Loss: 0.0701794 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756583  Vali macro F1 0.9613519 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.015298366546631
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0517970  Vali Loss: 0.0695095 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756583  Vali macro F1 0.9613519 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.0169830322265625
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0520557  Vali Loss: 0.0689141 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756583  Vali macro F1 0.9613519 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.0104944705963135
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0518378  Vali Loss: 0.0701081 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751386  Vali macro F1 0.9605050 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.03118634223938
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0515091  Vali Loss: 0.0696840 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751386  Vali macro F1 0.9605050 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 21 cost time: 6.041326999664307
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0511446  Vali Loss: 0.0697326 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751386  Vali macro F1 0.9605050 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.028254508972168
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0510565  Vali Loss: 0.0694696 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751386  Vali macro F1 0.9605050 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.014247179031372
Fine Tuning VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0527268  Vali Loss: 0.0693113 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751386  Vali macro F1 0.9605050 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.016159296035767
Fine Tuning VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0506390  Vali Loss: 0.0694353 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751386  Vali macro F1 0.9605050 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.005564451217651
Fine Tuning VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0538113  Vali Loss: 0.0694058 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9751386  Vali macro F1 0.9605050 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9484139  Test weighted F1: 0.9495011  Test macro F1 0.9231764 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014912 0.00018123 0.00097087 0.00125    0.00049702 0.00061805]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.210144519805908
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4301998  Vali Loss: 1.0053567 Vali Accuracy: 0.6575064  Vali weighted F1: 0.5454627  Vali macro F1 0.2675711 
Validation loss decreased (inf --> 1.005357).  Saving model ...
Epoch: 2 cost time: 6.118461608886719
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8120644  Vali Loss: 0.6714206 Vali Accuracy: 0.7801527  Vali weighted F1: 0.7154931  Vali macro F1 0.4985025 
new best score!!!!
Validation loss decreased (1.005357 --> 0.671421).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.123220682144165
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5665725  Vali Loss: 0.4229046 Vali Accuracy: 0.8310433  Vali weighted F1: 0.8059710  Vali macro F1 0.6009744 
new best score!!!!
Validation loss decreased (0.671421 --> 0.422905).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.138999938964844
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4060843  Vali Loss: 0.3651173 Vali Accuracy: 0.8371501  Vali weighted F1: 0.8179739  Vali macro F1 0.6118550 
new best score!!!!
Validation loss decreased (0.422905 --> 0.365117).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.1298627853393555
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3562773  Vali Loss: 0.3400974 Vali Accuracy: 0.8631043  Vali weighted F1: 0.8443576  Vali macro F1 0.6560424 
new best score!!!!
Validation loss decreased (0.365117 --> 0.340097).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.143934965133667
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3377706  Vali Loss: 0.3083071 Vali Accuracy: 0.8651399  Vali weighted F1: 0.8482873  Vali macro F1 0.6613300 
new best score!!!!
Validation loss decreased (0.340097 --> 0.308307).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.142028093338013
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2932590  Vali Loss: 0.2495314 Vali Accuracy: 0.9109415  Vali weighted F1: 0.9072260  Vali macro F1 0.8584841 
new best score!!!!
Validation loss decreased (0.308307 --> 0.249531).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.141427755355835
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2338920  Vali Loss: 0.2101932 Vali Accuracy: 0.9307888  Vali weighted F1: 0.9300601  Vali macro F1 0.8977054 
new best score!!!!
Validation loss decreased (0.249531 --> 0.210193).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.130536794662476
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2231406  Vali Loss: 0.1890513 Vali Accuracy: 0.9374046  Vali weighted F1: 0.9369323  Vali macro F1 0.9064514 
new best score!!!!
Validation loss decreased (0.210193 --> 0.189051).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.134088754653931
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1993615  Vali Loss: 0.1770632 Vali Accuracy: 0.9409669  Vali weighted F1: 0.9405098  Vali macro F1 0.9108856 
new best score!!!!
Validation loss decreased (0.189051 --> 0.177063).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.1396448612213135
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1863140  Vali Loss: 0.1649717 Vali Accuracy: 0.9409669  Vali weighted F1: 0.9398947  Vali macro F1 0.9087172 
new best score!!!!
Validation loss decreased (0.177063 --> 0.164972).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.142563581466675
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1824197  Vali Loss: 0.1704643 Vali Accuracy: 0.9399491  Vali weighted F1: 0.9391557  Vali macro F1 0.9113866 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.155683517456055
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1711818  Vali Loss: 0.1406115 Vali Accuracy: 0.9475827  Vali weighted F1: 0.9474711  Vali macro F1 0.9231461 
new best score!!!!
Validation loss decreased (0.164972 --> 0.140611).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.144850969314575
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1623663  Vali Loss: 0.1448125 Vali Accuracy: 0.9496183  Vali weighted F1: 0.9490572  Vali macro F1 0.9228589 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.15057373046875
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1529395  Vali Loss: 0.1367548 Vali Accuracy: 0.9541985  Vali weighted F1: 0.9542441  Vali macro F1 0.9351808 
new best score!!!!
Validation loss decreased (0.140611 --> 0.136755).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.139890670776367
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1465885  Vali Loss: 0.1806650 Vali Accuracy: 0.9297710  Vali weighted F1: 0.9295762  Vali macro F1 0.9043434 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.123509883880615
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1457292  Vali Loss: 0.1268636 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9570478  Vali macro F1 0.9375727 
new best score!!!!
Validation loss decreased (0.136755 --> 0.126864).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.1338419914245605
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1404185  Vali Loss: 0.1322140 Vali Accuracy: 0.9552163  Vali weighted F1: 0.9542176  Vali macro F1 0.9365150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.123993635177612
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1366083  Vali Loss: 0.1257928 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9550696  Vali macro F1 0.9369781 
new best score!!!!
Validation loss decreased (0.126864 --> 0.125793).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.122746229171753
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1306573  Vali Loss: 0.1255103 Vali Accuracy: 0.9536896  Vali weighted F1: 0.9534606  Vali macro F1 0.9321042 
new best score!!!!
Validation loss decreased (0.125793 --> 0.125510).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.125890731811523
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1351408  Vali Loss: 0.1224957 Vali Accuracy: 0.9608142  Vali weighted F1: 0.9605448  Vali macro F1 0.9415476 
new best score!!!!
Validation loss decreased (0.125510 --> 0.122496).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.127329349517822
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1407567  Vali Loss: 0.1350579 Vali Accuracy: 0.9506361  Vali weighted F1: 0.9515239  Vali macro F1 0.9306887 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.107638120651245
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1272157  Vali Loss: 0.1198373 Vali Accuracy: 0.9587786  Vali weighted F1: 0.9589323  Vali macro F1 0.9404295 
new best score!!!!
Validation loss decreased (0.122496 --> 0.119837).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.1255645751953125
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1182049  Vali Loss: 0.1117177 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9608525  Vali macro F1 0.9452994 
new best score!!!!
Validation loss decreased (0.119837 --> 0.111718).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.111266374588013
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1195769  Vali Loss: 0.1129873 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9564376  Vali macro F1 0.9366261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.105295658111572
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1169220  Vali Loss: 0.1090220 Vali Accuracy: 0.9582697  Vali weighted F1: 0.9581162  Vali macro F1 0.9398864 
new best score!!!!
Validation loss decreased (0.111718 --> 0.109022).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.111668348312378
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1104923  Vali Loss: 0.1116271 Vali Accuracy: 0.9628499  Vali weighted F1: 0.9633553  Vali macro F1 0.9495081 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.11729884147644
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1056739  Vali Loss: 0.1017662 Vali Accuracy: 0.9618321  Vali weighted F1: 0.9620654  Vali macro F1 0.9448790 
new best score!!!!
Validation loss decreased (0.109022 --> 0.101766).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.120605945587158
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1094118  Vali Loss: 0.0935416 Vali Accuracy: 0.9653944  Vali weighted F1: 0.9655964  Vali macro F1 0.9500736 
new best score!!!!
Validation loss decreased (0.101766 --> 0.093542).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.114275932312012
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.1068181  Vali Loss: 0.0927644 Vali Accuracy: 0.9669211  Vali weighted F1: 0.9669836  Vali macro F1 0.9525013 
new best score!!!!
Validation loss decreased (0.093542 --> 0.092764).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.131881475448608
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.1086503  Vali Loss: 0.1086997 Vali Accuracy: 0.9587786  Vali weighted F1: 0.9596030  Vali macro F1 0.9429966 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.116759777069092
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.1086681  Vali Loss: 0.1039874 Vali Accuracy: 0.9603053  Vali weighted F1: 0.9597762  Vali macro F1 0.9426525 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.141476154327393
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0976515  Vali Loss: 0.0937119 Vali Accuracy: 0.9618321  Vali weighted F1: 0.9620105  Vali macro F1 0.9447419 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.129873752593994
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0977867  Vali Loss: 0.1248999 Vali Accuracy: 0.9470738  Vali weighted F1: 0.9486047  Vali macro F1 0.9313429 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.116283655166626
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.1009254  Vali Loss: 0.1152032 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9582541  Vali macro F1 0.9459953 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 36 cost time: 6.119041204452515
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0856117  Vali Loss: 0.0851399 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9686273  Vali macro F1 0.9600328 
new best score!!!!
Validation loss decreased (0.092764 --> 0.085140).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.113015651702881
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0799368  Vali Loss: 0.0823748 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9715630  Vali macro F1 0.9615273 
new best score!!!!
Validation loss decreased (0.085140 --> 0.082375).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.120766878128052
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0792936  Vali Loss: 0.0803690 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9706253  Vali macro F1 0.9597803 
new best score!!!!
Validation loss decreased (0.082375 --> 0.080369).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.118071794509888
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0795405  Vali Loss: 0.0807337 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9711810  Vali macro F1 0.9612421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.1128089427948
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0805745  Vali Loss: 0.0821966 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691546  Vali macro F1 0.9581079 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.125661373138428
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0793233  Vali Loss: 0.0816668 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9716906  Vali macro F1 0.9639563 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.131868362426758
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0784917  Vali Loss: 0.0811205 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9726570  Vali macro F1 0.9639948 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.120452642440796
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0775327  Vali Loss: 0.0834289 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697386  Vali macro F1 0.9601261 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 6.125415802001953
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0770683  Vali Loss: 0.0807203 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9692157  Vali macro F1 0.9595383 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.1345884799957275
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0783478  Vali Loss: 0.0812331 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9707341  Vali macro F1 0.9623374 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.12248158454895
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0768422  Vali Loss: 0.0811116 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9696664  Vali macro F1 0.9608924 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.127939224243164
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0754536  Vali Loss: 0.0813163 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9696664  Vali macro F1 0.9608924 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.1133599281311035
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0795275  Vali Loss: 0.0817060 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697044  Vali macro F1 0.9609206 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.131390810012817
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0756634  Vali Loss: 0.0816203 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697044  Vali macro F1 0.9609206 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.128940105438232
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0767412  Vali Loss: 0.0815236 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697044  Vali macro F1 0.9609206 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.125388145446777
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0785372  Vali Loss: 0.0813571 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697044  Vali macro F1 0.9609206 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.11042332649231
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0797164  Vali Loss: 0.0813870 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697044  Vali macro F1 0.9609206 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.110716819763184
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0829734  Vali Loss: 0.0813534 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691809  Vali macro F1 0.9604073 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9209252  Test weighted F1: 0.9236061  Test macro F1 0.9114025 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.1544508934021
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0786376  Vali Loss: 0.0872829 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691960  Vali macro F1 0.9607286 
Validation loss decreased (inf --> 0.087283).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.116171360015869
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0789272  Vali Loss: 0.0791374 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9712094  Vali macro F1 0.9625242 
new best score!!!!
Validation loss decreased (0.087283 --> 0.079137).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.122790336608887
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0801782  Vali Loss: 0.0877829 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9682935  Vali macro F1 0.9589536 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.11989951133728
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0786712  Vali Loss: 0.0805166 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9721705  Vali macro F1 0.9640617 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.138444423675537
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0778608  Vali Loss: 0.0809997 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9716591  Vali macro F1 0.9636159 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.151092290878296
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0765188  Vali Loss: 0.0784018 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9712080  Vali macro F1 0.9631671 
new best score!!!!
Validation loss decreased (0.079137 --> 0.078402).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.128939151763916
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0767774  Vali Loss: 0.0794803 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9741057  Vali macro F1 0.9655303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.119189500808716
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0777899  Vali Loss: 0.0772254 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9707087  Vali macro F1 0.9623458 
new best score!!!!
Validation loss decreased (0.078402 --> 0.077225).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.120995998382568
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0764773  Vali Loss: 0.0852523 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9686830  Vali macro F1 0.9576001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.11685848236084
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0766288  Vali Loss: 0.0793817 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9717377  Vali macro F1 0.9631540 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.120875835418701
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0718672  Vali Loss: 0.0800151 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9705759  Vali macro F1 0.9582435 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.1157004833221436
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0704166  Vali Loss: 0.0766716 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9726958  Vali macro F1 0.9628899 
new best score!!!!
Validation loss decreased (0.077225 --> 0.076672).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.1368491649627686
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0732789  Vali Loss: 0.0779678 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9702242  Vali macro F1 0.9619012 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.152808904647827
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0735006  Vali Loss: 0.0780671 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9707008  Vali macro F1 0.9599317 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.131281614303589
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0741553  Vali Loss: 0.0797493 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9716117  Vali macro F1 0.9619648 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.133321285247803
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0764693  Vali Loss: 0.0761112 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722286  Vali macro F1 0.9620734 
new best score!!!!
Validation loss decreased (0.076672 --> 0.076111).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.128243446350098
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0734170  Vali Loss: 0.0799568 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9712567  Vali macro F1 0.9626713 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.119938135147095
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0710041  Vali Loss: 0.0777508 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9712134  Vali macro F1 0.9625426 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.132132291793823
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0714544  Vali Loss: 0.0814550 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9721667  Vali macro F1 0.9641636 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.13524603843689
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0711827  Vali Loss: 0.0748487 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722515  Vali macro F1 0.9633107 
new best score!!!!
Validation loss decreased (0.076111 --> 0.074849).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.126412868499756
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0708679  Vali Loss: 0.0751406 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9712131  Vali macro F1 0.9609931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.133765935897827
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0706232  Vali Loss: 0.0734708 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9746782  Vali macro F1 0.9656202 
new best score!!!!
Validation loss decreased (0.074849 --> 0.073471).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.133590459823608
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0701450  Vali Loss: 0.0801631 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691621  Vali macro F1 0.9581077 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.128181219100952
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0712983  Vali Loss: 0.0744865 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9717446  Vali macro F1 0.9622950 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.107323408126831
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0722898  Vali Loss: 0.0794440 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9701557  Vali macro F1 0.9611854 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.12431001663208
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0726625  Vali Loss: 0.0758534 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9711800  Vali macro F1 0.9616522 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.120721101760864
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0712560  Vali Loss: 0.0722294 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737060  Vali macro F1 0.9646412 
new best score!!!!
Validation loss decreased (0.073471 --> 0.072229).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 6.122918367385864
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0687154  Vali Loss: 0.0758418 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9717971  Vali macro F1 0.9623922 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.12131667137146
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0715537  Vali Loss: 0.0748019 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9731930  Vali macro F1 0.9644263 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.125123500823975
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0656129  Vali Loss: 0.0712343 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9752069  Vali macro F1 0.9661786 
new best score!!!!
Validation loss decreased (0.072229 --> 0.071234).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.13489294052124
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0667846  Vali Loss: 0.0728599 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9736388  Vali macro F1 0.9654631 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.135736465454102
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0707963  Vali Loss: 0.0737420 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9726705  Vali macro F1 0.9638336 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.12591028213501
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0696890  Vali Loss: 0.0806753 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9698041  Vali macro F1 0.9615437 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.1213555335998535
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0683359  Vali Loss: 0.0777705 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9711743  Vali macro F1 0.9616481 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.1180620193481445
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0677654  Vali Loss: 0.0777731 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9708355  Vali macro F1 0.9622799 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 36 cost time: 6.121480464935303
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0680511  Vali Loss: 0.0747397 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737203  Vali macro F1 0.9649113 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.124132394790649
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0675153  Vali Loss: 0.0769080 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9711680  Vali macro F1 0.9607631 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.1079747676849365
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0646625  Vali Loss: 0.0732485 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9732110  Vali macro F1 0.9631856 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.125687837600708
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0647226  Vali Loss: 0.0834528 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9678386  Vali macro F1 0.9574649 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.133005380630493
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0645964  Vali Loss: 0.0764167 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9716495  Vali macro F1 0.9612070 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 41 cost time: 6.131908893585205
Fine Tuning VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0621399  Vali Loss: 0.0742716 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9726729  Vali macro F1 0.9623609 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 6.139736175537109
Fine Tuning VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0625949  Vali Loss: 0.0751809 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9721612  Vali macro F1 0.9621079 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 6.1310131549835205
Fine Tuning VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0622557  Vali Loss: 0.0751291 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727112  Vali macro F1 0.9639015 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 6.119463205337524
Fine Tuning VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0646688  Vali Loss: 0.0731349 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9726990  Vali macro F1 0.9629325 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 6.122283697128296
Fine Tuning VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0629044  Vali Loss: 0.0749031 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9716764  Vali macro F1 0.9616214 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8923256  Test weighted F1: 0.8957365  Test macro F1 0.8911393 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014928 0.00018298 0.000999   0.0012837  0.00052329 0.00061805]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.031148672103882
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.4310899  Vali Loss: 1.0128308 Vali Accuracy: 0.6647786  Vali weighted F1: 0.5577315  Vali macro F1 0.2719996 
Validation loss decreased (inf --> 1.012831).  Saving model ...
Epoch: 2 cost time: 6.020571708679199
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.8340408  Vali Loss: 0.7318848 Vali Accuracy: 0.7440783  Vali weighted F1: 0.6609585  Vali macro F1 0.4391808 
new best score!!!!
Validation loss decreased (1.012831 --> 0.731885).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.037469863891602
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.6667654  Vali Loss: 0.5798933 Vali Accuracy: 0.7857878  Vali weighted F1: 0.7468154  Vali macro F1 0.5489562 
new best score!!!!
Validation loss decreased (0.731885 --> 0.579893).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.033123731613159
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.5160959  Vali Loss: 0.4551739 Vali Accuracy: 0.8135942  Vali weighted F1: 0.7826249  Vali macro F1 0.5929460 
new best score!!!!
Validation loss decreased (0.579893 --> 0.455174).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.036849021911621
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.4088186  Vali Loss: 0.3659595 Vali Accuracy: 0.8511843  Vali weighted F1: 0.8288204  Vali macro F1 0.6556759 
new best score!!!!
Validation loss decreased (0.455174 --> 0.365960).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.029904127120972
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.3571523  Vali Loss: 0.3272460 Vali Accuracy: 0.9037075  Vali weighted F1: 0.8987956  Vali macro F1 0.8628080 
new best score!!!!
Validation loss decreased (0.365960 --> 0.327246).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.03298282623291
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.2836902  Vali Loss: 0.2721729 Vali Accuracy: 0.9170958  Vali weighted F1: 0.9118557  Vali macro F1 0.8858325 
new best score!!!!
Validation loss decreased (0.327246 --> 0.272173).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.0359766483306885
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.2481710  Vali Loss: 0.2341031 Vali Accuracy: 0.9248198  Vali weighted F1: 0.9240212  Vali macro F1 0.8966519 
new best score!!!!
Validation loss decreased (0.272173 --> 0.234103).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.037035703659058
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.2267816  Vali Loss: 0.2010934 Vali Accuracy: 0.9361483  Vali weighted F1: 0.9361485  Vali macro F1 0.9138036 
new best score!!!!
Validation loss decreased (0.234103 --> 0.201093).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.035244941711426
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.2155127  Vali Loss: 0.2138539 Vali Accuracy: 0.9330587  Vali weighted F1: 0.9315458  Vali macro F1 0.9075403 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.029193639755249
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.2003879  Vali Loss: 0.1880602 Vali Accuracy: 0.9407827  Vali weighted F1: 0.9406441  Vali macro F1 0.9190522 
new best score!!!!
Validation loss decreased (0.201093 --> 0.188060).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.051879167556763
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1901703  Vali Loss: 0.2167253 Vali Accuracy: 0.9248198  Vali weighted F1: 0.9260367  Vali macro F1 0.8994375 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.038327217102051
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1761859  Vali Loss: 0.1721310 Vali Accuracy: 0.9412976  Vali weighted F1: 0.9415603  Vali macro F1 0.9211866 
new best score!!!!
Validation loss decreased (0.188060 --> 0.172131).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.035404920578003
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1697703  Vali Loss: 0.1622696 Vali Accuracy: 0.9449022  Vali weighted F1: 0.9445214  Vali macro F1 0.9265752 
new best score!!!!
Validation loss decreased (0.172131 --> 0.162270).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.036510467529297
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1607999  Vali Loss: 0.1783447 Vali Accuracy: 0.9423275  Vali weighted F1: 0.9409180  Vali macro F1 0.9224850 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.0294508934021
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1590361  Vali Loss: 0.1660228 Vali Accuracy: 0.9438723  Vali weighted F1: 0.9425786  Vali macro F1 0.9260324 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.031731605529785
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1498016  Vali Loss: 0.1499081 Vali Accuracy: 0.9459320  Vali weighted F1: 0.9465702  Vali macro F1 0.9277526 
new best score!!!!
Validation loss decreased (0.162270 --> 0.149908).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.0396058559417725
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.1450320  Vali Loss: 0.1506493 Vali Accuracy: 0.9423275  Vali weighted F1: 0.9421101  Vali macro F1 0.9229224 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.035765171051025
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.1415456  Vali Loss: 0.1333664 Vali Accuracy: 0.9521112  Vali weighted F1: 0.9520765  Vali macro F1 0.9354907 
new best score!!!!
Validation loss decreased (0.149908 --> 0.133366).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.027652025222778
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.1338478  Vali Loss: 0.1307008 Vali Accuracy: 0.9531411  Vali weighted F1: 0.9532164  Vali macro F1 0.9366143 
new best score!!!!
Validation loss decreased (0.133366 --> 0.130701).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.054539680480957
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.1362162  Vali Loss: 0.1286077 Vali Accuracy: 0.9510814  Vali weighted F1: 0.9506741  Vali macro F1 0.9349650 
new best score!!!!
Validation loss decreased (0.130701 --> 0.128608).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.047370195388794
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.1293544  Vali Loss: 0.1299759 Vali Accuracy: 0.9495366  Vali weighted F1: 0.9498644  Vali macro F1 0.9325728 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.033864259719849
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.1245738  Vali Loss: 0.1240080 Vali Accuracy: 0.9505664  Vali weighted F1: 0.9511548  Vali macro F1 0.9334569 
new best score!!!!
Validation loss decreased (0.128608 --> 0.124008).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.031919002532959
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.1241484  Vali Loss: 0.1201100 Vali Accuracy: 0.9536560  Vali weighted F1: 0.9538794  Vali macro F1 0.9371808 
new best score!!!!
Validation loss decreased (0.124008 --> 0.120110).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.034651041030884
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.1162724  Vali Loss: 0.1406372 Vali Accuracy: 0.9474768  Vali weighted F1: 0.9463324  Vali macro F1 0.9315216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.019371509552002
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.1251631  Vali Loss: 0.1352188 Vali Accuracy: 0.9536560  Vali weighted F1: 0.9539210  Vali macro F1 0.9389271 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.029431581497192
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.1203838  Vali Loss: 0.1093201 Vali Accuracy: 0.9572606  Vali weighted F1: 0.9572572  Vali macro F1 0.9442413 
new best score!!!!
Validation loss decreased (0.120110 --> 0.109320).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.039049863815308
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.1187660  Vali Loss: 0.1112527 Vali Accuracy: 0.9562307  Vali weighted F1: 0.9567463  Vali macro F1 0.9428232 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.028956651687622
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.1058480  Vali Loss: 0.1095095 Vali Accuracy: 0.9567456  Vali weighted F1: 0.9569767  Vali macro F1 0.9406915 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.044497489929199
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.1094343  Vali Loss: 0.1046608 Vali Accuracy: 0.9572606  Vali weighted F1: 0.9573685  Vali macro F1 0.9420535 
new best score!!!!
Validation loss decreased (0.109320 --> 0.104661).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.044280767440796
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.1036580  Vali Loss: 0.1059419 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9629889  Vali macro F1 0.9489119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.0464091300964355
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0974935  Vali Loss: 0.1026441 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9636368  Vali macro F1 0.9516520 
new best score!!!!
Validation loss decreased (0.104661 --> 0.102644).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.031644821166992
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0985870  Vali Loss: 0.1058458 Vali Accuracy: 0.9572606  Vali weighted F1: 0.9566791  Vali macro F1 0.9429588 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.025690078735352
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0916999  Vali Loss: 0.1154179 Vali Accuracy: 0.9577755  Vali weighted F1: 0.9579388  Vali macro F1 0.9414194 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.029138565063477
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0986620  Vali Loss: 0.0986785 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9660537  Vali macro F1 0.9532598 
new best score!!!!
Validation loss decreased (0.102644 --> 0.098678).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.030061960220337
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0998576  Vali Loss: 0.1015302 Vali Accuracy: 0.9624099  Vali weighted F1: 0.9627447  Vali macro F1 0.9495261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.027029752731323
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0899048  Vali Loss: 0.0951809 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9654740  Vali macro F1 0.9543270 
new best score!!!!
Validation loss decreased (0.098678 --> 0.095181).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.025364637374878
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0853099  Vali Loss: 0.0995871 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9657455  Vali macro F1 0.9525694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.029202938079834
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0853780  Vali Loss: 0.0994760 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9629932  Vali macro F1 0.9494551 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.042984962463379
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0840383  Vali Loss: 0.0875927 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9688037  Vali macro F1 0.9564254 
new best score!!!!
Validation loss decreased (0.095181 --> 0.087593).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.046935081481934
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0824330  Vali Loss: 0.1181996 Vali Accuracy: 0.9598352  Vali weighted F1: 0.9603482  Vali macro F1 0.9472539 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.01802659034729
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0828319  Vali Loss: 0.0942819 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9642223  Vali macro F1 0.9520361 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.018514394760132
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0769449  Vali Loss: 0.0799118 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9712844  Vali macro F1 0.9586269 
new best score!!!!
Validation loss decreased (0.087593 --> 0.079912).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.035252809524536
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0791567  Vali Loss: 0.0972583 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9645137  Vali macro F1 0.9525929 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.034270763397217
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0765357  Vali Loss: 0.0877031 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9646619  Vali macro F1 0.9531576 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.023365020751953
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0810285  Vali Loss: 0.0976044 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9632680  Vali macro F1 0.9508642 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.031245470046997
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0706163  Vali Loss: 0.0904861 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9680855  Vali macro F1 0.9554368 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.018689870834351
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0711334  Vali Loss: 0.0790927 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9712948  Vali macro F1 0.9609394 
new best score!!!!
Validation loss decreased (0.079912 --> 0.079093).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.045623302459717
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0735175  Vali Loss: 0.0742578 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9743119  Vali macro F1 0.9643481 
new best score!!!!
Validation loss decreased (0.079093 --> 0.074258).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.039614915847778
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0715521  Vali Loss: 0.0732163 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748755  Vali macro F1 0.9649094 
new best score!!!!
Validation loss decreased (0.074258 --> 0.073216).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.039148807525635
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0629128  Vali Loss: 0.0709983 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9741616  Vali macro F1 0.9643371 
new best score!!!!
Validation loss decreased (0.073216 --> 0.070998).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.03083062171936
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0627359  Vali Loss: 0.0731000 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9733944  Vali macro F1 0.9641421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.026883602142334
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0687682  Vali Loss: 0.0756904 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9711898  Vali macro F1 0.9597471 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.021851062774658
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0634498  Vali Loss: 0.0883654 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9671609  Vali macro F1 0.9571715 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.024540662765503
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0646602  Vali Loss: 0.0702607 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748203  Vali macro F1 0.9659254 
new best score!!!!
Validation loss decreased (0.070998 --> 0.070261).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.0170958042144775
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0676489  Vali Loss: 0.0683053 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9779114  Vali macro F1 0.9691062 
new best score!!!!
Validation loss decreased (0.070261 --> 0.068305).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 6.0280866622924805
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0622319  Vali Loss: 0.0731080 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9756159  Vali macro F1 0.9663464 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.039348363876343
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0563501  Vali Loss: 0.0695353 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9756893  Vali macro F1 0.9676373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.025724411010742
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0550098  Vali Loss: 0.0677161 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9785277  Vali macro F1 0.9715635 
new best score!!!!
Validation loss decreased (0.068305 --> 0.067716).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.037421703338623
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0543600  Vali Loss: 0.0646976 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805522  Vali macro F1 0.9745963 
new best score!!!!
Validation loss decreased (0.067716 --> 0.064698).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.021268844604492
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0540251  Vali Loss: 0.0683435 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9743624  Vali macro F1 0.9677630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.013990879058838
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0560893  Vali Loss: 0.0887666 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9652658  Vali macro F1 0.9549869 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.025084018707275
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0524072  Vali Loss: 0.0724929 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9772963  Vali macro F1 0.9706093 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.0198564529418945
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0538391  Vali Loss: 0.0699292 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773145  Vali macro F1 0.9712999 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.027647018432617
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0454541  Vali Loss: 0.0680171 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9762290  Vali macro F1 0.9702048 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 66 cost time: 6.024271011352539
VALI: Epoch: 66, Steps: 69 | Train Loss: 0.0407883  Vali Loss: 0.0631660 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810209  Vali macro F1 0.9760079 
new best score!!!!
Validation loss decreased (0.064698 --> 0.063166).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 6.0362725257873535
VALI: Epoch: 67, Steps: 69 | Train Loss: 0.0406596  Vali Loss: 0.0596402 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810474  Vali macro F1 0.9754793 
new best score!!!!
Validation loss decreased (0.063166 --> 0.059640).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 6.045416355133057
VALI: Epoch: 68, Steps: 69 | Train Loss: 0.0393801  Vali Loss: 0.0580051 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820688  Vali macro F1 0.9772014 
new best score!!!!
Validation loss decreased (0.059640 --> 0.058005).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 6.0480568408966064
VALI: Epoch: 69, Steps: 69 | Train Loss: 0.0392477  Vali Loss: 0.0617227 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820703  Vali macro F1 0.9764171 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.021148920059204
VALI: Epoch: 70, Steps: 69 | Train Loss: 0.0383559  Vali Loss: 0.0601307 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9826023  Vali macro F1 0.9770714 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.014299154281616
VALI: Epoch: 71, Steps: 69 | Train Loss: 0.0381710  Vali Loss: 0.0594309 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809928  Vali macro F1 0.9753206 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.014910459518433
VALI: Epoch: 72, Steps: 69 | Train Loss: 0.0387348  Vali Loss: 0.0604962 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810333  Vali macro F1 0.9749960 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.023080348968506
VALI: Epoch: 73, Steps: 69 | Train Loss: 0.0387788  Vali Loss: 0.0588191 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815620  Vali macro F1 0.9763054 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 74 cost time: 6.016748666763306
VALI: Epoch: 74, Steps: 69 | Train Loss: 0.0381972  Vali Loss: 0.0582156 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820589  Vali macro F1 0.9767766 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 6.007364749908447
VALI: Epoch: 75, Steps: 69 | Train Loss: 0.0368490  Vali Loss: 0.0580388 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810025  Vali macro F1 0.9756203 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 6.024605751037598
VALI: Epoch: 76, Steps: 69 | Train Loss: 0.0380266  Vali Loss: 0.0578905 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804698  Vali macro F1 0.9749631 
new best score!!!!
Validation loss decreased (0.058005 --> 0.057891).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 6.035043239593506
VALI: Epoch: 77, Steps: 69 | Train Loss: 0.0380109  Vali Loss: 0.0571733 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810211  Vali macro F1 0.9754017 
new best score!!!!
Validation loss decreased (0.057891 --> 0.057173).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 6.042005777359009
VALI: Epoch: 78, Steps: 69 | Train Loss: 0.0390607  Vali Loss: 0.0570616 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810211  Vali macro F1 0.9754017 
new best score!!!!
Validation loss decreased (0.057173 --> 0.057062).  Saving model ...
new best score!!!!
Epoch: 79 cost time: 6.0331597328186035
VALI: Epoch: 79, Steps: 69 | Train Loss: 0.0375550  Vali Loss: 0.0574320 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 6.012529611587524
VALI: Epoch: 80, Steps: 69 | Train Loss: 0.0377043  Vali Loss: 0.0575125 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 6.015830755233765
VALI: Epoch: 81, Steps: 69 | Train Loss: 0.0373412  Vali Loss: 0.0574913 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820457  Vali macro F1 0.9771618 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 6.015985727310181
VALI: Epoch: 82, Steps: 69 | Train Loss: 0.0370355  Vali Loss: 0.0572704 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 6.019198656082153
VALI: Epoch: 83, Steps: 69 | Train Loss: 0.0346845  Vali Loss: 0.0575958 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 84 cost time: 6.008113145828247
VALI: Epoch: 84, Steps: 69 | Train Loss: 0.0364746  Vali Loss: 0.0576125 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 6.024428129196167
VALI: Epoch: 85, Steps: 69 | Train Loss: 0.0367575  Vali Loss: 0.0576499 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 6.041297674179077
VALI: Epoch: 86, Steps: 69 | Train Loss: 0.0371464  Vali Loss: 0.0576851 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 6.029646873474121
VALI: Epoch: 87, Steps: 69 | Train Loss: 0.0355257  Vali Loss: 0.0576701 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 88 cost time: 6.020081996917725
VALI: Epoch: 88, Steps: 69 | Train Loss: 0.0360404  Vali Loss: 0.0576079 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 89 cost time: 6.023752212524414
VALI: Epoch: 89, Steps: 69 | Train Loss: 0.0361642  Vali Loss: 0.0576052 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 6.014368295669556
VALI: Epoch: 90, Steps: 69 | Train Loss: 0.0356104  Vali Loss: 0.0575993 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 91 cost time: 6.014086723327637
VALI: Epoch: 91, Steps: 69 | Train Loss: 0.0351103  Vali Loss: 0.0576032 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 92 cost time: 6.0099265575408936
VALI: Epoch: 92, Steps: 69 | Train Loss: 0.0374284  Vali Loss: 0.0575998 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 93 cost time: 6.018940687179565
VALI: Epoch: 93, Steps: 69 | Train Loss: 0.0381164  Vali Loss: 0.0576056 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815339  Vali macro F1 0.9762743 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9656489  Test weighted F1: 0.9643495  Test macro F1 0.9505401 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.087130069732666
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0401748  Vali Loss: 0.0586282 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805854  Vali macro F1 0.9749829 
Validation loss decreased (inf --> 0.058628).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.050359725952148
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0383222  Vali Loss: 0.0585069 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815065  Vali macro F1 0.9761498 
new best score!!!!
Validation loss decreased (0.058628 --> 0.058507).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.022578001022339
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0359700  Vali Loss: 0.0569548 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810177  Vali macro F1 0.9760381 
new best score!!!!
Validation loss decreased (0.058507 --> 0.056955).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.019487619400024
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0377339  Vali Loss: 0.0584866 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809714  Vali macro F1 0.9760256 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.045999050140381
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0379922  Vali Loss: 0.0581647 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789342  Vali macro F1 0.9730701 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.042801141738892
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0350755  Vali Loss: 0.0574227 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815127  Vali macro F1 0.9765099 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.035504341125488
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0372691  Vali Loss: 0.0550195 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830821  Vali macro F1 0.9785501 
new best score!!!!
Validation loss decreased (0.056955 --> 0.055019).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.0294189453125
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0365643  Vali Loss: 0.0571951 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820554  Vali macro F1 0.9772105 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.04056715965271
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0347529  Vali Loss: 0.0559055 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798752  Vali macro F1 0.9744725 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.03194522857666
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0371879  Vali Loss: 0.0563213 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814632  Vali macro F1 0.9761753 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.039916753768921
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0356439  Vali Loss: 0.0563273 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815358  Vali macro F1 0.9762419 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.019901990890503
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0340282  Vali Loss: 0.0582204 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815537  Vali macro F1 0.9754727 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.0267767906188965
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0348680  Vali Loss: 0.0559825 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810050  Vali macro F1 0.9749788 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.040675163269043
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0338222  Vali Loss: 0.0565601 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805465  Vali macro F1 0.9747339 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.032033681869507
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0337263  Vali Loss: 0.0591881 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815493  Vali macro F1 0.9757307 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.030915021896362
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0343568  Vali Loss: 0.0556576 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815265  Vali macro F1 0.9765462 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.032386541366577
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0365117  Vali Loss: 0.0543241 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815178  Vali macro F1 0.9766101 
new best score!!!!
Validation loss decreased (0.055019 --> 0.054324).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.056996583938599
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0340945  Vali Loss: 0.0586537 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814935  Vali macro F1 0.9760130 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.056777238845825
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0345260  Vali Loss: 0.0573225 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804315  Vali macro F1 0.9750263 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.034980058670044
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0343723  Vali Loss: 0.0555115 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800045  Vali macro F1 0.9746626 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.04081916809082
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0356200  Vali Loss: 0.0605832 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825447  Vali macro F1 0.9767574 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.038593769073486
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0348610  Vali Loss: 0.0532647 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809459  Vali macro F1 0.9754033 
new best score!!!!
Validation loss decreased (0.054324 --> 0.053265).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.026604175567627
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0331892  Vali Loss: 0.0554094 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9821023  Vali macro F1 0.9762480 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.043830394744873
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0347770  Vali Loss: 0.0567968 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805285  Vali macro F1 0.9748082 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.056115627288818
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0335585  Vali Loss: 0.0559352 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815568  Vali macro F1 0.9759672 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.033938646316528
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0321014  Vali Loss: 0.0560952 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799526  Vali macro F1 0.9751352 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.049052715301514
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0329343  Vali Loss: 0.0546873 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815320  Vali macro F1 0.9768680 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 6.044805526733398
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0331062  Vali Loss: 0.0551817 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815066  Vali macro F1 0.9768099 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.036103010177612
Fine Tuning VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0317018  Vali Loss: 0.0556107 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804680  Vali macro F1 0.9753856 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.027228355407715
Fine Tuning VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0312039  Vali Loss: 0.0563863 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810121  Vali macro F1 0.9756828 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.021966218948364
Fine Tuning VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0308171  Vali Loss: 0.0556320 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809922  Vali macro F1 0.9759167 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.026998043060303
Fine Tuning VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0308204  Vali Loss: 0.0553925 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809922  Vali macro F1 0.9759167 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 6.027836799621582
Fine Tuning VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0308501  Vali Loss: 0.0554417 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809922  Vali macro F1 0.9759167 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.033978462219238
Fine Tuning VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0305100  Vali Loss: 0.0554915 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809922  Vali macro F1 0.9759167 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.0307042598724365
Fine Tuning VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0323668  Vali Loss: 0.0555375 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809922  Vali macro F1 0.9759167 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.054192543029785
Fine Tuning VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0321344  Vali Loss: 0.0555732 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809922  Vali macro F1 0.9759167 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.045347213745117
Fine Tuning VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0315966  Vali Loss: 0.0555332 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809922  Vali macro F1 0.9759167 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9644307  Test weighted F1: 0.9624587  Test macro F1 0.9464176 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014959 0.00018678 0.00138313 0.00145985 0.00052882 0.00064809]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.828597545623779
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.4411304  Vali Loss: 1.0514464 Vali Accuracy: 0.6743070  Vali weighted F1: 0.5691871  Vali macro F1 0.2728676 
Validation loss decreased (inf --> 1.051446).  Saving model ...
Epoch: 2 cost time: 5.808650255203247
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.8317664  Vali Loss: 0.7291770 Vali Accuracy: 0.6966951  Vali weighted F1: 0.6020298  Vali macro F1 0.3041694 
new best score!!!!
Validation loss decreased (1.051446 --> 0.729177).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.811296701431274
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.6596084  Vali Loss: 0.6130670 Vali Accuracy: 0.7766525  Vali weighted F1: 0.7185097  Vali macro F1 0.4923386 
new best score!!!!
Validation loss decreased (0.729177 --> 0.613067).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.81512713432312
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.5620252  Vali Loss: 0.5330947 Vali Accuracy: 0.7867804  Vali weighted F1: 0.7418934  Vali macro F1 0.5212761 
new best score!!!!
Validation loss decreased (0.613067 --> 0.533095).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.823501348495483
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.4815569  Vali Loss: 0.4656914 Vali Accuracy: 0.8144989  Vali weighted F1: 0.7889577  Vali macro F1 0.5870807 
new best score!!!!
Validation loss decreased (0.533095 --> 0.465691).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.835150480270386
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.4093473  Vali Loss: 0.3882628 Vali Accuracy: 0.8331557  Vali weighted F1: 0.8115594  Vali macro F1 0.6124874 
new best score!!!!
Validation loss decreased (0.465691 --> 0.388263).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.8298211097717285
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.3710425  Vali Loss: 0.3452579 Vali Accuracy: 0.8949893  Vali weighted F1: 0.8901825  Vali macro F1 0.8480045 
new best score!!!!
Validation loss decreased (0.388263 --> 0.345258).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.85236120223999
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.3391032  Vali Loss: 0.3042589 Vali Accuracy: 0.9083156  Vali weighted F1: 0.9050412  Vali macro F1 0.8675545 
new best score!!!!
Validation loss decreased (0.345258 --> 0.304259).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.835428237915039
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.3016852  Vali Loss: 0.2753113 Vali Accuracy: 0.9141791  Vali weighted F1: 0.9099808  Vali macro F1 0.8767534 
new best score!!!!
Validation loss decreased (0.304259 --> 0.275311).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.834665298461914
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.2635474  Vali Loss: 0.2683563 Vali Accuracy: 0.9093817  Vali weighted F1: 0.9060667  Vali macro F1 0.8626741 
new best score!!!!
Validation loss decreased (0.275311 --> 0.268356).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.8276777267456055
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.2345554  Vali Loss: 0.2189814 Vali Accuracy: 0.9317697  Vali weighted F1: 0.9300752  Vali macro F1 0.9110443 
new best score!!!!
Validation loss decreased (0.268356 --> 0.218981).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.825362682342529
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.2093984  Vali Loss: 0.2193434 Vali Accuracy: 0.9296375  Vali weighted F1: 0.9257821  Vali macro F1 0.9078645 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.8286614418029785
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1985163  Vali Loss: 0.1682282 Vali Accuracy: 0.9461620  Vali weighted F1: 0.9455766  Vali macro F1 0.9273291 
new best score!!!!
Validation loss decreased (0.218981 --> 0.168228).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.8349609375
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1811714  Vali Loss: 0.1793825 Vali Accuracy: 0.9466951  Vali weighted F1: 0.9451665  Vali macro F1 0.9317432 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.823731422424316
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1746761  Vali Loss: 0.1644718 Vali Accuracy: 0.9488273  Vali weighted F1: 0.9480065  Vali macro F1 0.9326099 
new best score!!!!
Validation loss decreased (0.168228 --> 0.164472).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.8337297439575195
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1650849  Vali Loss: 0.1435311 Vali Accuracy: 0.9557569  Vali weighted F1: 0.9554209  Vali macro F1 0.9438568 
new best score!!!!
Validation loss decreased (0.164472 --> 0.143531).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.863832950592041
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1622390  Vali Loss: 0.1476885 Vali Accuracy: 0.9504264  Vali weighted F1: 0.9510930  Vali macro F1 0.9388673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.82037091255188
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1519352  Vali Loss: 0.1575296 Vali Accuracy: 0.9466951  Vali weighted F1: 0.9465080  Vali macro F1 0.9300911 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.82203221321106
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.1470155  Vali Loss: 0.1385614 Vali Accuracy: 0.9536247  Vali weighted F1: 0.9536446  Vali macro F1 0.9418639 
new best score!!!!
Validation loss decreased (0.143531 --> 0.138561).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.8283562660217285
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.1388224  Vali Loss: 0.1244071 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9626515  Vali macro F1 0.9515230 
new best score!!!!
Validation loss decreased (0.138561 --> 0.124407).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.834798097610474
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.1405500  Vali Loss: 0.1127112 Vali Accuracy: 0.9621535  Vali weighted F1: 0.9620773  Vali macro F1 0.9510833 
new best score!!!!
Validation loss decreased (0.124407 --> 0.112711).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.825106859207153
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.1321615  Vali Loss: 0.1317473 Vali Accuracy: 0.9562900  Vali weighted F1: 0.9563667  Vali macro F1 0.9453585 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.825777769088745
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.1288414  Vali Loss: 0.1123616 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9627544  Vali macro F1 0.9519084 
new best score!!!!
Validation loss decreased (0.112711 --> 0.112362).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.827319622039795
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.1246736  Vali Loss: 0.1170040 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9617434  Vali macro F1 0.9527666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.828066110610962
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.1183869  Vali Loss: 0.1194776 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9591525  Vali macro F1 0.9475472 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.833472967147827
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.1221371  Vali Loss: 0.1294898 Vali Accuracy: 0.9530917  Vali weighted F1: 0.9525408  Vali macro F1 0.9387936 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.842085599899292
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.1132229  Vali Loss: 0.1306902 Vali Accuracy: 0.9536247  Vali weighted F1: 0.9532445  Vali macro F1 0.9484753 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.820155620574951
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.1145432  Vali Loss: 0.1098540 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9612823  Vali macro F1 0.9413516 
new best score!!!!
Validation loss decreased (0.112362 --> 0.109854).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.828198194503784
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.1082631  Vali Loss: 0.1132457 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9589048  Vali macro F1 0.9421717 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.8231306076049805
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.1127944  Vali Loss: 0.0963172 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697537  Vali macro F1 0.9659932 
new best score!!!!
Validation loss decreased (0.109854 --> 0.096317).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.826200485229492
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.1061084  Vali Loss: 0.1045993 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9662372  Vali macro F1 0.9623538 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.813410043716431
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0986914  Vali Loss: 0.1065728 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9626185  Vali macro F1 0.9518418 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.831612825393677
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0974548  Vali Loss: 0.0946720 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9647248  Vali macro F1 0.9556326 
new best score!!!!
Validation loss decreased (0.096317 --> 0.094672).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.815639019012451
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0935763  Vali Loss: 0.0982905 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9669125  Vali macro F1 0.9625213 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.829352140426636
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0935666  Vali Loss: 0.0914113 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9703065  Vali macro F1 0.9648424 
new best score!!!!
Validation loss decreased (0.094672 --> 0.091411).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.84831690788269
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0927799  Vali Loss: 0.0941695 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9675804  Vali macro F1 0.9628801 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.815139055252075
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0922827  Vali Loss: 0.1127281 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9612487  Vali macro F1 0.9569176 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.826432704925537
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0867257  Vali Loss: 0.0924566 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9689643  Vali macro F1 0.9657399 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.8252246379852295
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0902968  Vali Loss: 0.1072697 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9634564  Vali macro F1 0.9578513 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 5.828543186187744
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0789759  Vali Loss: 0.1122583 Vali Accuracy: 0.9509595  Vali weighted F1: 0.9519126  Vali macro F1 0.9488135 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 5.819747447967529
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0710878  Vali Loss: 0.0888446 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9676277  Vali macro F1 0.9630782 
new best score!!!!
Validation loss decreased (0.091411 --> 0.088845).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.831697463989258
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0691169  Vali Loss: 0.0828678 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9681884  Vali macro F1 0.9639849 
new best score!!!!
Validation loss decreased (0.088845 --> 0.082868).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.82930588722229
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0688168  Vali Loss: 0.0841053 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9681472  Vali macro F1 0.9642630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.823676824569702
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0677999  Vali Loss: 0.0813782 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9665425  Vali macro F1 0.9622251 
new best score!!!!
Validation loss decreased (0.082868 --> 0.081378).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.845369100570679
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0672671  Vali Loss: 0.0811860 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9691925  Vali macro F1 0.9649051 
new best score!!!!
Validation loss decreased (0.081378 --> 0.081186).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 5.828487873077393
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0656440  Vali Loss: 0.0797234 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9687528  Vali macro F1 0.9644811 
new best score!!!!
Validation loss decreased (0.081186 --> 0.079723).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.817735195159912
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0688431  Vali Loss: 0.0836483 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9713949  Vali macro F1 0.9684717 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.8277976512908936
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0654136  Vali Loss: 0.0891985 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9675991  Vali macro F1 0.9633921 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 5.833079099655151
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0684738  Vali Loss: 0.0824844 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9714011  Vali macro F1 0.9690597 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 5.8150551319122314
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0648647  Vali Loss: 0.0801222 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9708733  Vali macro F1 0.9688628 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 5.819516897201538
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0645864  Vali Loss: 0.0822047 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9713742  Vali macro F1 0.9687209 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 5.8165812492370605
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0653533  Vali Loss: 0.0809025 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9702970  Vali macro F1 0.9673147 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 5.82486367225647
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0648442  Vali Loss: 0.0811518 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697763  Vali macro F1 0.9664888 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 5.830708026885986
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0665130  Vali Loss: 0.0818808 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697763  Vali macro F1 0.9664888 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 5.8381335735321045
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0634048  Vali Loss: 0.0807019 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697763  Vali macro F1 0.9664888 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 5.815226793289185
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0646047  Vali Loss: 0.0809447 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9702963  Vali macro F1 0.9670377 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 57 cost time: 5.820614814758301
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0631449  Vali Loss: 0.0806329 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697763  Vali macro F1 0.9664888 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 5.814417123794556
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0627323  Vali Loss: 0.0809676 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697763  Vali macro F1 0.9664888 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 5.809737920761108
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0658919  Vali Loss: 0.0810386 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697763  Vali macro F1 0.9664888 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 5.817802429199219
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0643499  Vali Loss: 0.0807616 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697763  Vali macro F1 0.9664888 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 5.816727876663208
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0656386  Vali Loss: 0.0805612 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697763  Vali macro F1 0.9664888 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8957719  Test weighted F1: 0.8988669  Test macro F1 0.8635912 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.860305547714233
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0662663  Vali Loss: 0.0839600 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9713949  Vali macro F1 0.9684717 
Validation loss decreased (inf --> 0.083960).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.850812196731567
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0672672  Vali Loss: 0.0813642 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9702187  Vali macro F1 0.9664483 
new best score!!!!
Validation loss decreased (0.083960 --> 0.081364).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.830520868301392
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0654557  Vali Loss: 0.0866066 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9692577  Vali macro F1 0.9660680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.820152997970581
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0695295  Vali Loss: 0.0868821 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9692427  Vali macro F1 0.9659687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.824548006057739
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0672259  Vali Loss: 0.0806513 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9717799  Vali macro F1 0.9691790 
new best score!!!!
Validation loss decreased (0.081364 --> 0.080651).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 5.834734916687012
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0663730  Vali Loss: 0.0827977 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9686315  Vali macro F1 0.9643484 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.824740171432495
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0640556  Vali Loss: 0.0840259 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9708629  Vali macro F1 0.9682484 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.8222880363464355
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0635270  Vali Loss: 0.0814249 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9707300  Vali macro F1 0.9683691 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.825637340545654
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0639394  Vali Loss: 0.0859468 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697362  Vali macro F1 0.9668463 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.83495569229126
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0626588  Vali Loss: 0.0768052 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9719835  Vali macro F1 0.9693250 
new best score!!!!
Validation loss decreased (0.080651 --> 0.076805).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 5.8269431591033936
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0651288  Vali Loss: 0.0803519 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9701880  Vali macro F1 0.9667094 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 5.841663122177124
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0657820  Vali Loss: 0.0851027 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9675025  Vali macro F1 0.9639359 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 5.815449237823486
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0653565  Vali Loss: 0.0789335 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9687368  Vali macro F1 0.9649146 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.816323280334473
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0627783  Vali Loss: 0.0843173 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9691670  Vali macro F1 0.9649530 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 5.823164224624634
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0630229  Vali Loss: 0.0846281 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9696633  Vali macro F1 0.9669699 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 5.825767517089844
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0613418  Vali Loss: 0.0807086 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9702879  Vali macro F1 0.9669819 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 5.818216323852539
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0611535  Vali Loss: 0.0783248 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9708328  Vali macro F1 0.9678524 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 5.826803207397461
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0605299  Vali Loss: 0.0849707 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9696839  Vali macro F1 0.9663199 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 5.822077035903931
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0620287  Vali Loss: 0.0883584 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9698015  Vali macro F1 0.9664707 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 5.83747935295105
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0622795  Vali Loss: 0.0783134 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9717821  Vali macro F1 0.9684639 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 5.836866855621338
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0567853  Vali Loss: 0.0783245 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697605  Vali macro F1 0.9657857 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 5.825840473175049
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0587213  Vali Loss: 0.0787929 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9692348  Vali macro F1 0.9652977 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 5.817480564117432
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0599356  Vali Loss: 0.0799377 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697678  Vali macro F1 0.9658521 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 5.816488742828369
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0591543  Vali Loss: 0.0789842 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9687146  Vali macro F1 0.9644727 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 5.813819408416748
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0596196  Vali Loss: 0.0800065 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9697552  Vali macro F1 0.9661705 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8964126  Test weighted F1: 0.9003218  Test macro F1 0.8657468 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001419  0.00018467 0.00096712 0.00125    0.0005291  0.00064599]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.112732172012329
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.3910314  Vali Loss: 0.9524530 Vali Accuracy: 0.6778285  Vali weighted F1: 0.5731359  Vali macro F1 0.2773879 
Validation loss decreased (inf --> 0.952453).  Saving model ...
Epoch: 2 cost time: 6.110219478607178
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.7988397  Vali Loss: 0.6782528 Vali Accuracy: 0.7584982  Vali weighted F1: 0.6763045  Vali macro F1 0.4480580 
new best score!!!!
Validation loss decreased (0.952453 --> 0.678253).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.1416175365448
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6058759  Vali Loss: 0.4655851 Vali Accuracy: 0.8239472  Vali weighted F1: 0.7925795  Vali macro F1 0.5859403 
new best score!!!!
Validation loss decreased (0.678253 --> 0.465585).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.116756439208984
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4502480  Vali Loss: 0.3737423 Vali Accuracy: 0.8401826  Vali weighted F1: 0.8150266  Vali macro F1 0.6074825 
new best score!!!!
Validation loss decreased (0.465585 --> 0.373742).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.1258556842803955
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3776572  Vali Loss: 0.3275665 Vali Accuracy: 0.8488077  Vali weighted F1: 0.8258348  Vali macro F1 0.6204384 
new best score!!!!
Validation loss decreased (0.373742 --> 0.327567).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.128085136413574
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3309198  Vali Loss: 0.2666648 Vali Accuracy: 0.9096905  Vali weighted F1: 0.9066725  Vali macro F1 0.8603809 
new best score!!!!
Validation loss decreased (0.327567 --> 0.266665).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.146150588989258
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2866556  Vali Loss: 0.2574047 Vali Accuracy: 0.9091832  Vali weighted F1: 0.9101448  Vali macro F1 0.8696096 
new best score!!!!
Validation loss decreased (0.266665 --> 0.257405).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.11804986000061
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2480061  Vali Loss: 0.1987309 Vali Accuracy: 0.9345510  Vali weighted F1: 0.9339242  Vali macro F1 0.9012350 
new best score!!!!
Validation loss decreased (0.257405 --> 0.198731).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.121077537536621
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2236022  Vali Loss: 0.2723749 Vali Accuracy: 0.9101979  Vali weighted F1: 0.9061509  Vali macro F1 0.8807823 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.122859001159668
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2030592  Vali Loss: 0.1727021 Vali Accuracy: 0.9457128  Vali weighted F1: 0.9454012  Vali macro F1 0.9247323 
new best score!!!!
Validation loss decreased (0.198731 --> 0.172702).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.113735914230347
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1853186  Vali Loss: 0.1571618 Vali Accuracy: 0.9502790  Vali weighted F1: 0.9496209  Vali macro F1 0.9331429 
new best score!!!!
Validation loss decreased (0.172702 --> 0.157162).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.14702582359314
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1784049  Vali Loss: 0.1459192 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9536267  Vali macro F1 0.9391088 
new best score!!!!
Validation loss decreased (0.157162 --> 0.145919).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.134184837341309
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1659897  Vali Loss: 0.1522617 Vali Accuracy: 0.9518011  Vali weighted F1: 0.9512369  Vali macro F1 0.9360131 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.121446847915649
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1542746  Vali Loss: 0.1352174 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9569943  Vali macro F1 0.9440968 
new best score!!!!
Validation loss decreased (0.145919 --> 0.135217).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.122233629226685
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1537970  Vali Loss: 0.1256818 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9601023  Vali macro F1 0.9474838 
new best score!!!!
Validation loss decreased (0.135217 --> 0.125682).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.1243040561676025
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1436245  Vali Loss: 0.1264464 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9575705  Vali macro F1 0.9435669 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.121514081954956
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1403564  Vali Loss: 0.1216886 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9609628  Vali macro F1 0.9485161 
new best score!!!!
Validation loss decreased (0.125682 --> 0.121689).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.113825559616089
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1336464  Vali Loss: 0.1238493 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9609460  Vali macro F1 0.9488264 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.127823352813721
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1352884  Vali Loss: 0.1158783 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9621941  Vali macro F1 0.9490320 
new best score!!!!
Validation loss decreased (0.121689 --> 0.115878).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.124706745147705
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1249897  Vali Loss: 0.1485624 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9505664  Vali macro F1 0.9367487 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.139296531677246
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1262244  Vali Loss: 0.1174112 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9606481  Vali macro F1 0.9486956 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.141729831695557
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1194766  Vali Loss: 0.1039327 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9671509  Vali macro F1 0.9559027 
new best score!!!!
Validation loss decreased (0.115878 --> 0.103933).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.124833822250366
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1159788  Vali Loss: 0.1296010 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9588832  Vali macro F1 0.9424813 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.1180970668792725
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1115162  Vali Loss: 0.0994631 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9682439  Vali macro F1 0.9588827 
new best score!!!!
Validation loss decreased (0.103933 --> 0.099463).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.116247653961182
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1026986  Vali Loss: 0.0988719 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9673348  Vali macro F1 0.9567253 
new best score!!!!
Validation loss decreased (0.099463 --> 0.098872).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.123696327209473
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1028427  Vali Loss: 0.1081837 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9643947  Vali macro F1 0.9510836 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.117538690567017
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1027444  Vali Loss: 0.0883891 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9706360  Vali macro F1 0.9617138 
new best score!!!!
Validation loss decreased (0.098872 --> 0.088389).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.125159978866577
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1018551  Vali Loss: 0.0958752 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9715393  Vali macro F1 0.9621895 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.133925199508667
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0944627  Vali Loss: 0.0986996 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9708310  Vali macro F1 0.9616215 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.145474672317505
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0910709  Vali Loss: 0.0966956 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9710009  Vali macro F1 0.9628323 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.121885538101196
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0859855  Vali Loss: 0.0862402 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9729206  Vali macro F1 0.9654390 
new best score!!!!
Validation loss decreased (0.088389 --> 0.086240).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.114669561386108
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0861572  Vali Loss: 0.0933278 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707919  Vali macro F1 0.9631106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.114161014556885
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0853692  Vali Loss: 0.1008898 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9687936  Vali macro F1 0.9588877 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.1207334995269775
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0799436  Vali Loss: 0.0869392 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9735875  Vali macro F1 0.9643749 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.111433982849121
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0788812  Vali Loss: 0.0857267 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9731668  Vali macro F1 0.9606305 
new best score!!!!
Validation loss decreased (0.086240 --> 0.085727).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.124876976013184
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0758264  Vali Loss: 0.0801849 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9730566  Vali macro F1 0.9632307 
new best score!!!!
Validation loss decreased (0.085727 --> 0.080185).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.121357440948486
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0735297  Vali Loss: 0.0774899 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9757304  Vali macro F1 0.9686189 
new best score!!!!
Validation loss decreased (0.080185 --> 0.077490).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.14410400390625
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0720553  Vali Loss: 0.0763873 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9752284  Vali macro F1 0.9649938 
new best score!!!!
Validation loss decreased (0.077490 --> 0.076387).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.157687187194824
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0728176  Vali Loss: 0.0803603 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9767286  Vali macro F1 0.9692890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.105322360992432
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0683225  Vali Loss: 0.0853255 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772175  Vali macro F1 0.9692622 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.17300009727478
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0670987  Vali Loss: 0.0743509 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772472  Vali macro F1 0.9683496 
new best score!!!!
Validation loss decreased (0.076387 --> 0.074351).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.078109979629517
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0634928  Vali Loss: 0.0761834 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9767416  Vali macro F1 0.9678504 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.077240943908691
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0646572  Vali Loss: 0.0829773 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9750472  Vali macro F1 0.9665424 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.082873582839966
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0677933  Vali Loss: 0.0690356 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9808280  Vali macro F1 0.9743162 
new best score!!!!
Validation loss decreased (0.074351 --> 0.069036).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.076512098312378
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0591332  Vali Loss: 0.0717639 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802598  Vali macro F1 0.9724136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.070730209350586
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0626988  Vali Loss: 0.0716550 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791267  Vali macro F1 0.9727355 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.093817949295044
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0599409  Vali Loss: 0.0699247 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792967  Vali macro F1 0.9739401 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.094050168991089
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0606761  Vali Loss: 0.0683180 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772874  Vali macro F1 0.9696313 
new best score!!!!
Validation loss decreased (0.069036 --> 0.068318).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.079152345657349
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0605927  Vali Loss: 0.0699545 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9779057  Vali macro F1 0.9713485 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.079994201660156
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0552117  Vali Loss: 0.0756956 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9753112  Vali macro F1 0.9684239 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.086797475814819
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0541229  Vali Loss: 0.0613012 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812366  Vali macro F1 0.9752921 
new best score!!!!
Validation loss decreased (0.068318 --> 0.061301).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.072734117507935
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0539720  Vali Loss: 0.0765642 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771389  Vali macro F1 0.9694495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.075905799865723
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0555300  Vali Loss: 0.0704324 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823965  Vali macro F1 0.9761938 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.07121729850769
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0542492  Vali Loss: 0.0654946 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787474  Vali macro F1 0.9714772 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.0834314823150635
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0592635  Vali Loss: 0.0597983 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823242  Vali macro F1 0.9759334 
new best score!!!!
Validation loss decreased (0.061301 --> 0.059798).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.087313652038574
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0530627  Vali Loss: 0.0601738 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9814240  Vali macro F1 0.9753517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.091402769088745
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0532799  Vali Loss: 0.0543591 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842759  Vali macro F1 0.9782302 
new best score!!!!
Validation loss decreased (0.059798 --> 0.054359).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.0782554149627686
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0534887  Vali Loss: 0.0673551 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9805948  Vali macro F1 0.9736552 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.069040298461914
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0447571  Vali Loss: 0.0594779 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832372  Vali macro F1 0.9767676 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.0803303718566895
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0436198  Vali Loss: 0.0678804 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828317  Vali macro F1 0.9758804 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.069864273071289
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0457131  Vali Loss: 0.0597155 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823455  Vali macro F1 0.9751023 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.096526622772217
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0477934  Vali Loss: 0.0748263 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9805621  Vali macro F1 0.9734520 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 63 cost time: 6.072499990463257
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0405084  Vali Loss: 0.0551442 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843378  Vali macro F1 0.9782607 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 6.083113670349121
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0370478  Vali Loss: 0.0543628 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838484  Vali macro F1 0.9780666 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 6.090769290924072
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0381549  Vali Loss: 0.0540971 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837945  Vali macro F1 0.9776496 
new best score!!!!
Validation loss decreased (0.054359 --> 0.054097).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 6.095619440078735
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0341760  Vali Loss: 0.0544465 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838407  Vali macro F1 0.9777322 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.077399015426636
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0354126  Vali Loss: 0.0566919 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812785  Vali macro F1 0.9744312 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.077884674072266
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0367953  Vali Loss: 0.0533840 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847999  Vali macro F1 0.9790166 
new best score!!!!
Validation loss decreased (0.054097 --> 0.053384).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 6.080386638641357
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0353599  Vali Loss: 0.0541188 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843577  Vali macro F1 0.9783427 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.072128534317017
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0351733  Vali Loss: 0.0606003 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812269  Vali macro F1 0.9743238 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.077322483062744
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0373289  Vali Loss: 0.0549807 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848599  Vali macro F1 0.9791239 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.0810065269470215
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0334815  Vali Loss: 0.0552341 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843315  Vali macro F1 0.9779398 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.074060916900635
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0349554  Vali Loss: 0.0532599 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833200  Vali macro F1 0.9768846 
new best score!!!!
Validation loss decreased (0.053384 --> 0.053260).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 6.093062400817871
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0344912  Vali Loss: 0.0534834 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838069  Vali macro F1 0.9780017 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 6.079388380050659
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0339849  Vali Loss: 0.0560246 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843047  Vali macro F1 0.9779066 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 6.062957048416138
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0344894  Vali Loss: 0.0546089 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848337  Vali macro F1 0.9787858 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 6.073995113372803
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0337494  Vali Loss: 0.0542302 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838424  Vali macro F1 0.9777911 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 6.0707314014434814
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0347102  Vali Loss: 0.0524526 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832840  Vali macro F1 0.9768847 
new best score!!!!
Validation loss decreased (0.053260 --> 0.052453).  Saving model ...
new best score!!!!
Epoch: 79 cost time: 6.085050344467163
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0356689  Vali Loss: 0.0621806 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817651  Vali macro F1 0.9746541 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 6.073908090591431
VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0330998  Vali Loss: 0.0573350 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822683  Vali macro F1 0.9754568 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 6.07003116607666
VALI: Epoch: 81, Steps: 70 | Train Loss: 0.0354504  Vali Loss: 0.0536237 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848134  Vali macro F1 0.9787496 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 6.081679105758667
VALI: Epoch: 82, Steps: 70 | Train Loss: 0.0327793  Vali Loss: 0.0536528 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838047  Vali macro F1 0.9770951 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 6.0831592082977295
VALI: Epoch: 83, Steps: 70 | Train Loss: 0.0339644  Vali Loss: 0.0545759 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843595  Vali macro F1 0.9783744 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 84 cost time: 6.074626684188843
VALI: Epoch: 84, Steps: 70 | Train Loss: 0.0322166  Vali Loss: 0.0549419 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838354  Vali macro F1 0.9774423 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 6.066633701324463
VALI: Epoch: 85, Steps: 70 | Train Loss: 0.0324571  Vali Loss: 0.0544955 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838666  Vali macro F1 0.9778226 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 6.070298671722412
VALI: Epoch: 86, Steps: 70 | Train Loss: 0.0318393  Vali Loss: 0.0547485 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838567  Vali macro F1 0.9774988 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 6.069659233093262
VALI: Epoch: 87, Steps: 70 | Train Loss: 0.0331857  Vali Loss: 0.0548487 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838440  Vali macro F1 0.9777797 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 88 cost time: 6.067292213439941
VALI: Epoch: 88, Steps: 70 | Train Loss: 0.0310305  Vali Loss: 0.0546211 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843593  Vali macro F1 0.9783295 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 89 cost time: 6.071036100387573
VALI: Epoch: 89, Steps: 70 | Train Loss: 0.0322891  Vali Loss: 0.0545695 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843405  Vali macro F1 0.9782772 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 6.071863174438477
VALI: Epoch: 90, Steps: 70 | Train Loss: 0.0327993  Vali Loss: 0.0546036 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838440  Vali macro F1 0.9777797 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 91 cost time: 6.087031602859497
VALI: Epoch: 91, Steps: 70 | Train Loss: 0.0336696  Vali Loss: 0.0545155 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843593  Vali macro F1 0.9783295 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 92 cost time: 6.0859057903289795
VALI: Epoch: 92, Steps: 70 | Train Loss: 0.0316897  Vali Loss: 0.0543558 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843593  Vali macro F1 0.9783295 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 93 cost time: 6.073125123977661
VALI: Epoch: 93, Steps: 70 | Train Loss: 0.0330473  Vali Loss: 0.0542796 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843593  Vali macro F1 0.9783295 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9325244  Test weighted F1: 0.9307824  Test macro F1 0.9318461 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.1403608322143555
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0348024  Vali Loss: 0.0601583 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807738  Vali macro F1 0.9735844 
Validation loss decreased (inf --> 0.060158).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.130243301391602
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0325554  Vali Loss: 0.0521468 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838304  Vali macro F1 0.9781078 
new best score!!!!
Validation loss decreased (0.060158 --> 0.052147).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.112315654754639
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0330566  Vali Loss: 0.0534207 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842865  Vali macro F1 0.9785013 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.122898817062378
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0343573  Vali Loss: 0.0559538 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823566  Vali macro F1 0.9760014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.128777027130127
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0343079  Vali Loss: 0.0543953 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862985  Vali macro F1 0.9808950 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.139211654663086
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0334062  Vali Loss: 0.0568253 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837981  Vali macro F1 0.9770692 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.132599115371704
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0337714  Vali Loss: 0.0572895 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823434  Vali macro F1 0.9755974 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.121299505233765
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0336686  Vali Loss: 0.0537772 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843466  Vali macro F1 0.9786417 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.123552322387695
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0351053  Vali Loss: 0.0553147 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853360  Vali macro F1 0.9796323 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.127051115036011
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0334820  Vali Loss: 0.0543091 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857893  Vali macro F1 0.9800851 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.128215074539185
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0323845  Vali Loss: 0.0542874 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843374  Vali macro F1 0.9782887 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.131049633026123
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0326710  Vali Loss: 0.0566141 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833077  Vali macro F1 0.9765665 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.125793695449829
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0315796  Vali Loss: 0.0559692 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843764  Vali macro F1 0.9780220 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.13843035697937
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0300349  Vali Loss: 0.0559487 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843561  Vali macro F1 0.9779854 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.132446527481079
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0299900  Vali Loss: 0.0556272 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843581  Vali macro F1 0.9782960 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.15025520324707
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0311623  Vali Loss: 0.0555285 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838230  Vali macro F1 0.9776944 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.134204626083374
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0305901  Vali Loss: 0.0549144 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848606  Vali macro F1 0.9791885 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9334436  Test weighted F1: 0.9318262  Test macro F1 0.9328469 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014207 0.00017835 0.00097371 0.0011976  0.0004817  0.0006035 ]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.29731822013855
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.4047926  Vali Loss: 0.9587633 Vali Accuracy: 0.6595955  Vali weighted F1: 0.5489544  Vali macro F1 0.2710609 
Validation loss decreased (inf --> 0.958763).  Saving model ...
Epoch: 2 cost time: 6.29631495475769
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.8030189  Vali Loss: 0.6902212 Vali Accuracy: 0.7572768  Vali weighted F1: 0.6772129  Vali macro F1 0.4592989 
new best score!!!!
Validation loss decreased (0.958763 --> 0.690221).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.272220134735107
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.5979063  Vali Loss: 0.4553787 Vali Accuracy: 0.8214110  Vali weighted F1: 0.7939563  Vali macro F1 0.5837825 
new best score!!!!
Validation loss decreased (0.690221 --> 0.455379).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.288142681121826
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.4321011  Vali Loss: 0.3902537 Vali Accuracy: 0.8342378  Vali weighted F1: 0.8042587  Vali macro F1 0.5987831 
new best score!!!!
Validation loss decreased (0.455379 --> 0.390254).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.313711881637573
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.3956636  Vali Loss: 0.3395600 Vali Accuracy: 0.8495313  Vali weighted F1: 0.8304262  Vali macro F1 0.6298162 
new best score!!!!
Validation loss decreased (0.390254 --> 0.339560).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.3110785484313965
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.3554529  Vali Loss: 0.3185551 Vali Accuracy: 0.8593981  Vali weighted F1: 0.8387032  Vali macro F1 0.6476029 
new best score!!!!
Validation loss decreased (0.339560 --> 0.318555).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.304184675216675
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.3134063  Vali Loss: 0.2548333 Vali Accuracy: 0.9102121  Vali weighted F1: 0.9101209  Vali macro F1 0.8701782 
new best score!!!!
Validation loss decreased (0.318555 --> 0.254833).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.293853282928467
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.2524635  Vali Loss: 0.2024726 Vali Accuracy: 0.9333991  Vali weighted F1: 0.9324802  Vali macro F1 0.9016529 
new best score!!!!
Validation loss decreased (0.254833 --> 0.202473).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.308829069137573
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.2136338  Vali Loss: 0.1785990 Vali Accuracy: 0.9403059  Vali weighted F1: 0.9399792  Vali macro F1 0.9154079 
new best score!!!!
Validation loss decreased (0.202473 --> 0.178599).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.292233467102051
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1934253  Vali Loss: 0.1651937 Vali Accuracy: 0.9462259  Vali weighted F1: 0.9452149  Vali macro F1 0.9266202 
new best score!!!!
Validation loss decreased (0.178599 --> 0.165194).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.300049781799316
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1838361  Vali Loss: 0.1901759 Vali Accuracy: 0.9378392  Vali weighted F1: 0.9359422  Vali macro F1 0.9158362 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.283165216445923
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1674311  Vali Loss: 0.1494612 Vali Accuracy: 0.9477060  Vali weighted F1: 0.9477452  Vali macro F1 0.9253612 
new best score!!!!
Validation loss decreased (0.165194 --> 0.149461).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.295339107513428
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1592751  Vali Loss: 0.1465726 Vali Accuracy: 0.9536260  Vali weighted F1: 0.9535722  Vali macro F1 0.9379610 
new best score!!!!
Validation loss decreased (0.149461 --> 0.146573).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.307465553283691
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1543277  Vali Loss: 0.1291778 Vali Accuracy: 0.9555994  Vali weighted F1: 0.9552195  Vali macro F1 0.9400322 
new best score!!!!
Validation loss decreased (0.146573 --> 0.129178).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.310612916946411
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1477160  Vali Loss: 0.1324372 Vali Accuracy: 0.9580661  Vali weighted F1: 0.9585085  Vali macro F1 0.9432514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.294071435928345
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.1447243  Vali Loss: 0.1337476 Vali Accuracy: 0.9546127  Vali weighted F1: 0.9549516  Vali macro F1 0.9377285 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.286501169204712
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.1363470  Vali Loss: 0.1204349 Vali Accuracy: 0.9580661  Vali weighted F1: 0.9579364  Vali macro F1 0.9432329 
new best score!!!!
Validation loss decreased (0.129178 --> 0.120435).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.2771711349487305
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.1305618  Vali Loss: 0.1211035 Vali Accuracy: 0.9546127  Vali weighted F1: 0.9542771  Vali macro F1 0.9385844 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.283658027648926
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.1270700  Vali Loss: 0.1160324 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9593781  Vali macro F1 0.9456370 
new best score!!!!
Validation loss decreased (0.120435 --> 0.116032).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.288538455963135
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.1217545  Vali Loss: 0.1213699 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9564742  Vali macro F1 0.9428462 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.287388801574707
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.1208251  Vali Loss: 0.1411057 Vali Accuracy: 0.9496793  Vali weighted F1: 0.9499151  Vali macro F1 0.9362260 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.297692060470581
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.1202855  Vali Loss: 0.1099035 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9588186  Vali macro F1 0.9446146 
new best score!!!!
Validation loss decreased (0.116032 --> 0.109903).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.304177761077881
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.1160140  Vali Loss: 0.1191843 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9591208  Vali macro F1 0.9472326 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.2858757972717285
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.1175404  Vali Loss: 0.1105592 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9597987  Vali macro F1 0.9470295 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.305439710617065
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.1108312  Vali Loss: 0.1032962 Vali Accuracy: 0.9659595  Vali weighted F1: 0.9659288  Vali macro F1 0.9538189 
new best score!!!!
Validation loss decreased (0.109903 --> 0.103296).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.297593593597412
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.1052962  Vali Loss: 0.1092457 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9612405  Vali macro F1 0.9487642 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.2854087352752686
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.1090422  Vali Loss: 0.1014124 Vali Accuracy: 0.9659595  Vali weighted F1: 0.9659614  Vali macro F1 0.9544781 
new best score!!!!
Validation loss decreased (0.103296 --> 0.101412).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.282595634460449
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.1054841  Vali Loss: 0.1015225 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9690212  Vali macro F1 0.9571194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.297550678253174
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0994293  Vali Loss: 0.0913733 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9694759  Vali macro F1 0.9595488 
new best score!!!!
Validation loss decreased (0.101412 --> 0.091373).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.289155006408691
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0918476  Vali Loss: 0.0920684 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9678599  Vali macro F1 0.9552998 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.283897876739502
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0978101  Vali Loss: 0.0997596 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9652173  Vali macro F1 0.9519600 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.295841693878174
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0915748  Vali Loss: 0.0961465 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9681204  Vali macro F1 0.9557353 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.274245023727417
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0857256  Vali Loss: 0.0880656 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710304  Vali macro F1 0.9598250 
new best score!!!!
Validation loss decreased (0.091373 --> 0.088066).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.302626848220825
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0963273  Vali Loss: 0.1165932 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9598925  Vali macro F1 0.9476291 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.284032106399536
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0878298  Vali Loss: 0.0993104 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9661799  Vali macro F1 0.9538398 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.279524087905884
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0851843  Vali Loss: 0.1006733 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9670779  Vali macro F1 0.9546622 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.2812278270721436
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0867658  Vali Loss: 0.0871437 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9718765  Vali macro F1 0.9612830 
new best score!!!!
Validation loss decreased (0.088066 --> 0.087144).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.280767440795898
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0786437  Vali Loss: 0.0882596 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710782  Vali macro F1 0.9599930 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.281621217727661
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0829918  Vali Loss: 0.0931022 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9688902  Vali macro F1 0.9578310 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.278912782669067
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0847405  Vali Loss: 0.0878315 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715767  Vali macro F1 0.9601667 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.2801268100738525
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0758279  Vali Loss: 0.0810878 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9738743  Vali macro F1 0.9632696 
new best score!!!!
Validation loss decreased (0.087144 --> 0.081088).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.29710841178894
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0741203  Vali Loss: 0.0877121 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9730473  Vali macro F1 0.9615524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.294697999954224
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0746847  Vali Loss: 0.0828889 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9733241  Vali macro F1 0.9617170 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.273592948913574
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0707785  Vali Loss: 0.0977488 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9700035  Vali macro F1 0.9595418 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.28760027885437
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0725351  Vali Loss: 0.0773862 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9749635  Vali macro F1 0.9642793 
new best score!!!!
Validation loss decreased (0.081088 --> 0.077386).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.282426357269287
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0707830  Vali Loss: 0.0807719 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9733350  Vali macro F1 0.9637951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.271153450012207
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0662838  Vali Loss: 0.1102162 Vali Accuracy: 0.9659595  Vali weighted F1: 0.9658107  Vali macro F1 0.9550745 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.290802478790283
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0695698  Vali Loss: 0.0828429 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9736126  Vali macro F1 0.9631018 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.2898032665252686
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0661586  Vali Loss: 0.0760930 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9773378  Vali macro F1 0.9670579 
new best score!!!!
Validation loss decreased (0.077386 --> 0.076093).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.2798402309417725
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0635366  Vali Loss: 0.0721090 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9744966  Vali macro F1 0.9642183 
new best score!!!!
Validation loss decreased (0.076093 --> 0.072109).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.306122303009033
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0683130  Vali Loss: 0.0716941 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9758948  Vali macro F1 0.9666666 
new best score!!!!
Validation loss decreased (0.072109 --> 0.071694).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.306780815124512
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0601315  Vali Loss: 0.0712755 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9763837  Vali macro F1 0.9680406 
new best score!!!!
Validation loss decreased (0.071694 --> 0.071275).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.291860103607178
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0591154  Vali Loss: 0.0927185 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9747069  Vali macro F1 0.9641308 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.281822681427002
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0610670  Vali Loss: 0.0848598 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9724630  Vali macro F1 0.9625585 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.281831979751587
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0738947  Vali Loss: 0.0809524 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9712411  Vali macro F1 0.9601370 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.292367219924927
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0555771  Vali Loss: 0.0762308 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777601  Vali macro F1 0.9695774 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.2898077964782715
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0567265  Vali Loss: 0.0674328 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9789223  Vali macro F1 0.9694790 
new best score!!!!
Validation loss decreased (0.071275 --> 0.067433).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.299433469772339
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0535625  Vali Loss: 0.0721755 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9739188  Vali macro F1 0.9633091 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.281801462173462
VALI: Epoch: 59, Steps: 72 | Train Loss: 0.0556747  Vali Loss: 0.0876508 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9740860  Vali macro F1 0.9645870 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.3124940395355225
VALI: Epoch: 60, Steps: 72 | Train Loss: 0.0603311  Vali Loss: 0.0724020 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9767706  Vali macro F1 0.9656193 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.307055234909058
VALI: Epoch: 61, Steps: 72 | Train Loss: 0.0527649  Vali Loss: 0.0769006 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9752271  Vali macro F1 0.9653053 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.299291133880615
VALI: Epoch: 62, Steps: 72 | Train Loss: 0.0628129  Vali Loss: 0.0962144 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9699197  Vali macro F1 0.9621738 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 63 cost time: 6.302912950515747
VALI: Epoch: 63, Steps: 72 | Train Loss: 0.0518315  Vali Loss: 0.0664746 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803410  Vali macro F1 0.9732017 
new best score!!!!
Validation loss decreased (0.067433 --> 0.066475).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 6.299653053283691
VALI: Epoch: 64, Steps: 72 | Train Loss: 0.0488087  Vali Loss: 0.0638229 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813191  Vali macro F1 0.9733002 
new best score!!!!
Validation loss decreased (0.066475 --> 0.063823).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 6.295849323272705
VALI: Epoch: 65, Steps: 72 | Train Loss: 0.0452169  Vali Loss: 0.0635452 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798128  Vali macro F1 0.9702774 
new best score!!!!
Validation loss decreased (0.063823 --> 0.063545).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 6.290119171142578
VALI: Epoch: 66, Steps: 72 | Train Loss: 0.0441079  Vali Loss: 0.0645422 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808863  Vali macro F1 0.9714599 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.2895894050598145
VALI: Epoch: 67, Steps: 72 | Train Loss: 0.0436627  Vali Loss: 0.0645657 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798874  Vali macro F1 0.9706449 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.294384956359863
VALI: Epoch: 68, Steps: 72 | Train Loss: 0.0438610  Vali Loss: 0.0638462 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802997  Vali macro F1 0.9711386 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.306295394897461
VALI: Epoch: 69, Steps: 72 | Train Loss: 0.0423471  Vali Loss: 0.0653293 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797893  Vali macro F1 0.9710695 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.285310983657837
VALI: Epoch: 70, Steps: 72 | Train Loss: 0.0428490  Vali Loss: 0.0632610 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813604  Vali macro F1 0.9720781 
new best score!!!!
Validation loss decreased (0.063545 --> 0.063261).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 6.317137956619263
VALI: Epoch: 71, Steps: 72 | Train Loss: 0.0414132  Vali Loss: 0.0624270 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9828128  Vali macro F1 0.9740706 
new best score!!!!
Validation loss decreased (0.063261 --> 0.062427).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 6.298872709274292
VALI: Epoch: 72, Steps: 72 | Train Loss: 0.0424740  Vali Loss: 0.0641976 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808369  Vali macro F1 0.9718100 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 6.272794485092163
VALI: Epoch: 73, Steps: 72 | Train Loss: 0.0398567  Vali Loss: 0.0636434 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818173  Vali macro F1 0.9728192 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 6.289819240570068
VALI: Epoch: 74, Steps: 72 | Train Loss: 0.0392228  Vali Loss: 0.0627485 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808300  Vali macro F1 0.9716982 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 6.285306453704834
VALI: Epoch: 75, Steps: 72 | Train Loss: 0.0393840  Vali Loss: 0.0622093 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818212  Vali macro F1 0.9725206 
new best score!!!!
Validation loss decreased (0.062427 --> 0.062209).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 6.2868406772613525
VALI: Epoch: 76, Steps: 72 | Train Loss: 0.0408400  Vali Loss: 0.0629043 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812551  Vali macro F1 0.9723303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 6.287511825561523
VALI: Epoch: 77, Steps: 72 | Train Loss: 0.0414153  Vali Loss: 0.0629842 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817990  Vali macro F1 0.9724573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 6.288606643676758
VALI: Epoch: 78, Steps: 72 | Train Loss: 0.0391859  Vali Loss: 0.0620368 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822781  Vali macro F1 0.9733157 
new best score!!!!
Validation loss decreased (0.062209 --> 0.062037).  Saving model ...
new best score!!!!
Epoch: 79 cost time: 6.31333065032959
VALI: Epoch: 79, Steps: 72 | Train Loss: 0.0374071  Vali Loss: 0.0658438 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808232  Vali macro F1 0.9715563 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 6.297513723373413
VALI: Epoch: 80, Steps: 72 | Train Loss: 0.0411604  Vali Loss: 0.0627849 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817770  Vali macro F1 0.9722360 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 6.296790838241577
VALI: Epoch: 81, Steps: 72 | Train Loss: 0.0388292  Vali Loss: 0.0618632 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812965  Vali macro F1 0.9716496 
new best score!!!!
Validation loss decreased (0.062037 --> 0.061863).  Saving model ...
new best score!!!!
Epoch: 82 cost time: 6.280962705612183
VALI: Epoch: 82, Steps: 72 | Train Loss: 0.0390687  Vali Loss: 0.0618052 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9828202  Vali macro F1 0.9738037 
new best score!!!!
Validation loss decreased (0.061863 --> 0.061805).  Saving model ...
new best score!!!!
Epoch: 83 cost time: 6.286406993865967
VALI: Epoch: 83, Steps: 72 | Train Loss: 0.0376890  Vali Loss: 0.0629622 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832399  Vali macro F1 0.9742971 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 6.31830358505249
VALI: Epoch: 84, Steps: 72 | Train Loss: 0.0379999  Vali Loss: 0.0629773 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827735  Vali macro F1 0.9736612 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 85 cost time: 6.5344932079315186
VALI: Epoch: 85, Steps: 72 | Train Loss: 0.0406631  Vali Loss: 0.0633006 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817699  Vali macro F1 0.9721497 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 86 cost time: 6.525896072387695
VALI: Epoch: 86, Steps: 72 | Train Loss: 0.0390194  Vali Loss: 0.0627428 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822337  Vali macro F1 0.9726954 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 87 cost time: 6.514052629470825
VALI: Epoch: 87, Steps: 72 | Train Loss: 0.0387640  Vali Loss: 0.0622581 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822952  Vali macro F1 0.9734572 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 88 cost time: 6.526124000549316
VALI: Epoch: 88, Steps: 72 | Train Loss: 0.0367726  Vali Loss: 0.0627823 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822898  Vali macro F1 0.9735664 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 89 cost time: 6.51227879524231
VALI: Epoch: 89, Steps: 72 | Train Loss: 0.0371229  Vali Loss: 0.0620192 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822963  Vali macro F1 0.9729075 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 90 cost time: 6.543890714645386
VALI: Epoch: 90, Steps: 72 | Train Loss: 0.0379062  Vali Loss: 0.0622798 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827671  Vali macro F1 0.9736677 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 91 cost time: 6.5238120555877686
VALI: Epoch: 91, Steps: 72 | Train Loss: 0.0371766  Vali Loss: 0.0625409 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817661  Vali macro F1 0.9729308 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 92 cost time: 6.517919301986694
VALI: Epoch: 92, Steps: 72 | Train Loss: 0.0385881  Vali Loss: 0.0625358 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832494  Vali macro F1 0.9741812 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 93 cost time: 6.529155015945435
VALI: Epoch: 93, Steps: 72 | Train Loss: 0.0381420  Vali Loss: 0.0624664 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827634  Vali macro F1 0.9737478 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 94 cost time: 6.516927480697632
VALI: Epoch: 94, Steps: 72 | Train Loss: 0.0368540  Vali Loss: 0.0625005 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827634  Vali macro F1 0.9737478 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 95 cost time: 6.509598016738892
VALI: Epoch: 95, Steps: 72 | Train Loss: 0.0372387  Vali Loss: 0.0625251 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827634  Vali macro F1 0.9737478 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 96 cost time: 6.512566566467285
VALI: Epoch: 96, Steps: 72 | Train Loss: 0.0372434  Vali Loss: 0.0624162 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827634  Vali macro F1 0.9737478 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 97 cost time: 6.529818296432495
VALI: Epoch: 97, Steps: 72 | Train Loss: 0.0381464  Vali Loss: 0.0625103 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827634  Vali macro F1 0.9737478 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8876070  Test weighted F1: 0.8731701  Test macro F1 0.6602390 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.387258291244507
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0403850  Vali Loss: 0.0668354 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9823429  Vali macro F1 0.9733681 
Validation loss decreased (inf --> 0.066835).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3413660526275635
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0395053  Vali Loss: 0.0634972 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812921  Vali macro F1 0.9718320 
new best score!!!!
Validation loss decreased (0.066835 --> 0.063497).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.3296287059783936
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0406851  Vali Loss: 0.0629436 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827693  Vali macro F1 0.9736399 
new best score!!!!
Validation loss decreased (0.063497 --> 0.062944).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.336559772491455
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0376099  Vali Loss: 0.0625201 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822973  Vali macro F1 0.9730089 
new best score!!!!
Validation loss decreased (0.062944 --> 0.062520).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.3477301597595215
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0374324  Vali Loss: 0.0645048 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808143  Vali macro F1 0.9717621 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.33911657333374
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0370790  Vali Loss: 0.0619584 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817237  Vali macro F1 0.9718937 
new best score!!!!
Validation loss decreased (0.062520 --> 0.061958).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.330184459686279
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0375817  Vali Loss: 0.0624866 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822832  Vali macro F1 0.9731228 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.344941139221191
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0378102  Vali Loss: 0.0626087 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9828130  Vali macro F1 0.9742995 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.399710655212402
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0389711  Vali Loss: 0.0611724 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847227  Vali macro F1 0.9761789 
new best score!!!!
Validation loss decreased (0.061958 --> 0.061172).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.409822225570679
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0392477  Vali Loss: 0.0611779 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807934  Vali macro F1 0.9714508 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.330169439315796
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0370710  Vali Loss: 0.0611144 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842440  Vali macro F1 0.9757821 
new best score!!!!
Validation loss decreased (0.061172 --> 0.061114).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.3359599113464355
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0388504  Vali Loss: 0.0621879 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817718  Vali macro F1 0.9723731 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.3383049964904785
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0377020  Vali Loss: 0.0615046 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817808  Vali macro F1 0.9721839 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.3245322704315186
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0382083  Vali Loss: 0.0612998 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817362  Vali macro F1 0.9725235 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.3290793895721436
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0372297  Vali Loss: 0.0621813 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9838200  Vali macro F1 0.9745104 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.336413621902466
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0366925  Vali Loss: 0.0615768 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822488  Vali macro F1 0.9731588 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 6.336735725402832
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0383932  Vali Loss: 0.0643105 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817849  Vali macro F1 0.9726254 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.3408801555633545
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0359892  Vali Loss: 0.0611600 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837395  Vali macro F1 0.9751621 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.359022378921509
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0364819  Vali Loss: 0.0610941 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837855  Vali macro F1 0.9754156 
new best score!!!!
Validation loss decreased (0.061114 --> 0.061094).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.3346476554870605
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0361630  Vali Loss: 0.0638018 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818313  Vali macro F1 0.9728681 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.337319612503052
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0346260  Vali Loss: 0.0616384 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837361  Vali macro F1 0.9750809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.337053537368774
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0354953  Vali Loss: 0.0636187 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807841  Vali macro F1 0.9713813 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.33025860786438
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0363659  Vali Loss: 0.0628848 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812806  Vali macro F1 0.9720490 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.3287670612335205
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0363075  Vali Loss: 0.0602898 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832679  Vali macro F1 0.9743694 
new best score!!!!
Validation loss decreased (0.061094 --> 0.060290).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.3346545696258545
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0348431  Vali Loss: 0.0607179 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837486  Vali macro F1 0.9754517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.344204902648926
Fine Tuning VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0344098  Vali Loss: 0.0609595 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847187  Vali macro F1 0.9764184 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.3527750968933105
Fine Tuning VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0346055  Vali Loss: 0.0620407 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827573  Vali macro F1 0.9733055 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.3324058055877686
Fine Tuning VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0354690  Vali Loss: 0.0602436 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842465  Vali macro F1 0.9753641 
new best score!!!!
Validation loss decreased (0.060290 --> 0.060244).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.323320627212524
Fine Tuning VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0354616  Vali Loss: 0.0615268 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817656  Vali macro F1 0.9723795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.324528455734253
Fine Tuning VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0344008  Vali Loss: 0.0632237 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827566  Vali macro F1 0.9743755 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.3373963832855225
Fine Tuning VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0352817  Vali Loss: 0.0605594 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837638  Vali macro F1 0.9754701 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.33422327041626
Fine Tuning VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0336248  Vali Loss: 0.0616574 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817910  Vali macro F1 0.9725625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.335880994796753
Fine Tuning VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0326575  Vali Loss: 0.0649580 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817810  Vali macro F1 0.9731991 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 34 cost time: 6.323476791381836
Fine Tuning VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0340481  Vali Loss: 0.0626569 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832494  Vali macro F1 0.9746463 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 6.340936183929443
Fine Tuning VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0346180  Vali Loss: 0.0627927 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827736  Vali macro F1 0.9741264 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 6.320468425750732
Fine Tuning VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0353656  Vali Loss: 0.0624733 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827736  Vali macro F1 0.9741264 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 6.34899640083313
Fine Tuning VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0313069  Vali Loss: 0.0628162 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827736  Vali macro F1 0.9741264 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 6.3244545459747314
Fine Tuning VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0330280  Vali Loss: 0.0624585 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832494  Vali macro F1 0.9746463 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 39 cost time: 6.335452318191528
Fine Tuning VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0336977  Vali Loss: 0.0624739 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832494  Vali macro F1 0.9746463 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 6.339167833328247
Fine Tuning VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0334309  Vali Loss: 0.0623397 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832494  Vali macro F1 0.9746463 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 6.338624000549316
Fine Tuning VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0322943  Vali Loss: 0.0623405 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832494  Vali macro F1 0.9746463 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 6.331711292266846
Fine Tuning VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0329896  Vali Loss: 0.0623320 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832494  Vali macro F1 0.9746463 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 6.339908838272095
Fine Tuning VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0345651  Vali Loss: 0.0623666 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832494  Vali macro F1 0.9746463 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8832651  Test weighted F1: 0.8689398  Test macro F1 0.6575458 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014443 0.00016863 0.00100908 0.00133333 0.00050075 0.00063331]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.332378387451172
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.3991038  Vali Loss: 0.9563265 Vali Accuracy: 0.6676573  Vali weighted F1: 0.5596372  Vali macro F1 0.2714625 
Validation loss decreased (inf --> 0.956327).  Saving model ...
Epoch: 2 cost time: 6.312402248382568
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.7866265  Vali Loss: 0.6740413 Vali Accuracy: 0.7657256  Vali weighted F1: 0.6920055  Vali macro F1 0.4703053 
new best score!!!!
Validation loss decreased (0.956327 --> 0.674041).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.305519104003906
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.5802637  Vali Loss: 0.4759605 Vali Accuracy: 0.8291233  Vali weighted F1: 0.8054344  Vali macro F1 0.6107332 
new best score!!!!
Validation loss decreased (0.674041 --> 0.475960).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.296025037765503
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.4119741  Vali Loss: 0.3484581 Vali Accuracy: 0.8603269  Vali weighted F1: 0.8429178  Vali macro F1 0.6533907 
new best score!!!!
Validation loss decreased (0.475960 --> 0.348458).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.295006036758423
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.3530116  Vali Loss: 0.3100567 Vali Accuracy: 0.8672610  Vali weighted F1: 0.8507192  Vali macro F1 0.6605568 
new best score!!!!
Validation loss decreased (0.348458 --> 0.310057).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.312052965164185
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.3025283  Vali Loss: 0.2506416 Vali Accuracy: 0.9078752  Vali weighted F1: 0.9079117  Vali macro F1 0.8593066 
new best score!!!!
Validation loss decreased (0.310057 --> 0.250642).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.319029808044434
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.2600458  Vali Loss: 0.2285519 Vali Accuracy: 0.9212481  Vali weighted F1: 0.9215904  Vali macro F1 0.8759750 
new best score!!!!
Validation loss decreased (0.250642 --> 0.228552).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.30633020401001
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2240271  Vali Loss: 0.1917053 Vali Accuracy: 0.9306587  Vali weighted F1: 0.9319543  Vali macro F1 0.9012286 
new best score!!!!
Validation loss decreased (0.228552 --> 0.191705).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.308229207992554
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2014981  Vali Loss: 0.1917775 Vali Accuracy: 0.9385835  Vali weighted F1: 0.9378827  Vali macro F1 0.9113777 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.331066846847534
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1837766  Vali Loss: 0.1677940 Vali Accuracy: 0.9474988  Vali weighted F1: 0.9470965  Vali macro F1 0.9231236 
new best score!!!!
Validation loss decreased (0.191705 --> 0.167794).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.3144755363464355
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1729693  Vali Loss: 0.1502430 Vali Accuracy: 0.9514611  Vali weighted F1: 0.9517246  Vali macro F1 0.9293885 
new best score!!!!
Validation loss decreased (0.167794 --> 0.150243).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.320811986923218
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1624399  Vali Loss: 0.1451090 Vali Accuracy: 0.9559188  Vali weighted F1: 0.9555312  Vali macro F1 0.9342905 
new best score!!!!
Validation loss decreased (0.150243 --> 0.145109).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.304678201675415
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1539316  Vali Loss: 0.1541971 Vali Accuracy: 0.9539376  Vali weighted F1: 0.9535376  Vali macro F1 0.9329355 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.302674770355225
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1542161  Vali Loss: 0.1406055 Vali Accuracy: 0.9559188  Vali weighted F1: 0.9564005  Vali macro F1 0.9348848 
new best score!!!!
Validation loss decreased (0.145109 --> 0.140606).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.298833608627319
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1482574  Vali Loss: 0.1331782 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9594293  Vali macro F1 0.9411296 
new best score!!!!
Validation loss decreased (0.140606 --> 0.133178).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.300526142120361
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1456800  Vali Loss: 0.1306652 Vali Accuracy: 0.9588905  Vali weighted F1: 0.9587536  Vali macro F1 0.9384589 
new best score!!!!
Validation loss decreased (0.133178 --> 0.130665).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.304824590682983
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1332895  Vali Loss: 0.1341308 Vali Accuracy: 0.9603764  Vali weighted F1: 0.9610918  Vali macro F1 0.9438578 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.315428256988525
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1334903  Vali Loss: 0.1258583 Vali Accuracy: 0.9603764  Vali weighted F1: 0.9603144  Vali macro F1 0.9418386 
new best score!!!!
Validation loss decreased (0.130665 --> 0.125858).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.3132407665252686
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1335172  Vali Loss: 0.1367524 Vali Accuracy: 0.9559188  Vali weighted F1: 0.9554809  Vali macro F1 0.9368700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.309443473815918
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1269873  Vali Loss: 0.1303001 Vali Accuracy: 0.9569094  Vali weighted F1: 0.9568641  Vali macro F1 0.9384586 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.319376707077026
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1226360  Vali Loss: 0.1385661 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9571068  Vali macro F1 0.9379767 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.304277420043945
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1194345  Vali Loss: 0.1109436 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9665514  Vali macro F1 0.9499299 
new best score!!!!
Validation loss decreased (0.125858 --> 0.110944).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.301687002182007
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1218153  Vali Loss: 0.1356185 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9593093  Vali macro F1 0.9433066 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.3077476024627686
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1133814  Vali Loss: 0.1115778 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9651376  Vali macro F1 0.9484391 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.298203945159912
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1058035  Vali Loss: 0.1100200 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9668923  Vali macro F1 0.9502425 
new best score!!!!
Validation loss decreased (0.110944 --> 0.110020).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.292194128036499
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1080285  Vali Loss: 0.1350550 Vali Accuracy: 0.9588905  Vali weighted F1: 0.9588082  Vali macro F1 0.9425262 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.294872760772705
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1038088  Vali Loss: 0.1217299 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9620492  Vali macro F1 0.9456142 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.306528806686401
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1064673  Vali Loss: 0.1080895 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9664248  Vali macro F1 0.9499430 
new best score!!!!
Validation loss decreased (0.110020 --> 0.108089).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.327493667602539
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1028872  Vali Loss: 0.1080512 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9663823  Vali macro F1 0.9492765 
new best score!!!!
Validation loss decreased (0.108089 --> 0.108051).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.309984922409058
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0944818  Vali Loss: 0.1077740 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9679024  Vali macro F1 0.9529367 
new best score!!!!
Validation loss decreased (0.108051 --> 0.107774).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.298520088195801
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0974101  Vali Loss: 0.1193342 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9643289  Vali macro F1 0.9476711 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.293318510055542
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0928440  Vali Loss: 0.1016145 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9659593  Vali macro F1 0.9493621 
new best score!!!!
Validation loss decreased (0.107774 --> 0.101615).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.306965589523315
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0916586  Vali Loss: 0.1015035 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9677811  Vali macro F1 0.9519799 
new best score!!!!
Validation loss decreased (0.101615 --> 0.101504).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.304313659667969
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0893570  Vali Loss: 0.0970769 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9692733  Vali macro F1 0.9536371 
new best score!!!!
Validation loss decreased (0.101504 --> 0.097077).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.296751260757446
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0888403  Vali Loss: 0.0947511 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9692679  Vali macro F1 0.9547519 
new best score!!!!
Validation loss decreased (0.097077 --> 0.094751).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.29669451713562
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0841225  Vali Loss: 0.0947704 Vali Accuracy: 0.9697870  Vali weighted F1: 0.9700601  Vali macro F1 0.9545134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.305009365081787
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0876941  Vali Loss: 0.1194039 Vali Accuracy: 0.9618623  Vali weighted F1: 0.9620522  Vali macro F1 0.9451004 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.3275322914123535
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0807218  Vali Loss: 0.0883018 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9713891  Vali macro F1 0.9556630 
new best score!!!!
Validation loss decreased (0.094751 --> 0.088302).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.30157208442688
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0799186  Vali Loss: 0.0873650 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9744894  Vali macro F1 0.9591536 
new best score!!!!
Validation loss decreased (0.088302 --> 0.087365).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.300158739089966
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0881799  Vali Loss: 0.0944792 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9709860  Vali macro F1 0.9547847 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.296587944030762
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0768043  Vali Loss: 0.0989300 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9696928  Vali macro F1 0.9534382 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.294524431228638
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0771691  Vali Loss: 0.0883168 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9737536  Vali macro F1 0.9597768 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.293013334274292
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0710376  Vali Loss: 0.0918992 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9723791  Vali macro F1 0.9583041 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.31030535697937
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0787832  Vali Loss: 0.0857321 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9708286  Vali macro F1 0.9552511 
new best score!!!!
Validation loss decreased (0.087365 --> 0.085732).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.288707733154297
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0681376  Vali Loss: 0.0846448 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9738931  Vali macro F1 0.9582417 
new best score!!!!
Validation loss decreased (0.085732 --> 0.084645).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.312190055847168
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0707230  Vali Loss: 0.0868061 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9710195  Vali macro F1 0.9551473 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.325407981872559
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0686700  Vali Loss: 0.1153304 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9610570  Vali macro F1 0.9441419 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.289299011230469
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0704224  Vali Loss: 0.0806645 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9764280  Vali macro F1 0.9624266 
new best score!!!!
Validation loss decreased (0.084645 --> 0.080665).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.305276870727539
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0630961  Vali Loss: 0.0858246 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9763727  Vali macro F1 0.9653451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.314071178436279
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0655158  Vali Loss: 0.0818333 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9759846  Vali macro F1 0.9623338 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.291503667831421
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0624003  Vali Loss: 0.0853674 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9760786  Vali macro F1 0.9620623 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.288574457168579
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0624810  Vali Loss: 0.0867512 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9734899  Vali macro F1 0.9618046 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.294018030166626
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0638357  Vali Loss: 0.0998234 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9708094  Vali macro F1 0.9603811 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 6.302139520645142
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0538206  Vali Loss: 0.0789142 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9778144  Vali macro F1 0.9687974 
new best score!!!!
Validation loss decreased (0.080665 --> 0.078914).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.323442459106445
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0517995  Vali Loss: 0.0759250 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793611  Vali macro F1 0.9709931 
new best score!!!!
Validation loss decreased (0.078914 --> 0.075925).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.304054260253906
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0494619  Vali Loss: 0.0749512 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803689  Vali macro F1 0.9717380 
new best score!!!!
Validation loss decreased (0.075925 --> 0.074951).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 6.301017999649048
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0486281  Vali Loss: 0.0756698 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803828  Vali macro F1 0.9720222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.298261880874634
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0497861  Vali Loss: 0.0765840 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9799019  Vali macro F1 0.9715031 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.311327695846558
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0491718  Vali Loss: 0.0762489 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9804055  Vali macro F1 0.9723115 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.290376901626587
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0489797  Vali Loss: 0.0739032 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793712  Vali macro F1 0.9703188 
new best score!!!!
Validation loss decreased (0.074951 --> 0.073903).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.302627801895142
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0498087  Vali Loss: 0.0772023 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784606  Vali macro F1 0.9696954 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.301988363265991
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0483736  Vali Loss: 0.0747879 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9804055  Vali macro F1 0.9723115 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.304875612258911
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0475883  Vali Loss: 0.0773128 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779311  Vali macro F1 0.9694085 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.316174745559692
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0480992  Vali Loss: 0.0761765 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9804209  Vali macro F1 0.9726164 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.3180015087127686
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0465787  Vali Loss: 0.0749531 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788849  Vali macro F1 0.9698556 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 66 cost time: 6.308880805969238
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0469331  Vali Loss: 0.0755633 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9794137  Vali macro F1 0.9709778 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.298904180526733
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0457305  Vali Loss: 0.0755704 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789316  Vali macro F1 0.9701859 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.297194719314575
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0458191  Vali Loss: 0.0754151 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789316  Vali macro F1 0.9701859 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.292839765548706
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0480274  Vali Loss: 0.0751681 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784682  Vali macro F1 0.9693521 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.3192408084869385
VALI: Epoch: 70, Steps: 71 | Train Loss: 0.0465065  Vali Loss: 0.0754564 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784682  Vali macro F1 0.9693521 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 71 cost time: 6.294004917144775
VALI: Epoch: 71, Steps: 71 | Train Loss: 0.0468182  Vali Loss: 0.0754567 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784682  Vali macro F1 0.9693521 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 6.302675008773804
VALI: Epoch: 72, Steps: 71 | Train Loss: 0.0460874  Vali Loss: 0.0754361 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784682  Vali macro F1 0.9693521 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 6.317456245422363
VALI: Epoch: 73, Steps: 71 | Train Loss: 0.0460765  Vali Loss: 0.0753615 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784682  Vali macro F1 0.9693521 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 6.31492018699646
VALI: Epoch: 74, Steps: 71 | Train Loss: 0.0453291  Vali Loss: 0.0753113 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784495  Vali macro F1 0.9693943 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 6.3023598194122314
VALI: Epoch: 75, Steps: 71 | Train Loss: 0.0436718  Vali Loss: 0.0753605 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9784495  Vali macro F1 0.9693943 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7827219  Test weighted F1: 0.7878683  Test macro F1 0.8204759 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.357992172241211
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0499375  Vali Loss: 0.0771469 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9774789  Vali macro F1 0.9684513 
Validation loss decreased (inf --> 0.077147).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3490941524505615
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0490757  Vali Loss: 0.0757685 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9804256  Vali macro F1 0.9723642 
new best score!!!!
Validation loss decreased (0.077147 --> 0.075769).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.480953693389893
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0485425  Vali Loss: 0.0774441 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779505  Vali macro F1 0.9692469 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.335281133651733
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0476388  Vali Loss: 0.0756383 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793275  Vali macro F1 0.9704364 
new best score!!!!
Validation loss decreased (0.075769 --> 0.075638).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.3362672328948975
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0468570  Vali Loss: 0.0749004 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803676  Vali macro F1 0.9725920 
new best score!!!!
Validation loss decreased (0.075638 --> 0.074900).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.363663673400879
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0495279  Vali Loss: 0.0755610 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779264  Vali macro F1 0.9686509 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.359152317047119
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0473047  Vali Loss: 0.0752127 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788094  Vali macro F1 0.9697497 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.3359534740448
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0486931  Vali Loss: 0.0741963 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789567  Vali macro F1 0.9703228 
new best score!!!!
Validation loss decreased (0.074900 --> 0.074196).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.341769456863403
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0467206  Vali Loss: 0.0764119 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798697  Vali macro F1 0.9714384 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.339183807373047
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0463801  Vali Loss: 0.0758725 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9799161  Vali macro F1 0.9718238 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.472054481506348
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0450262  Vali Loss: 0.0741582 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803520  Vali macro F1 0.9713746 
new best score!!!!
Validation loss decreased (0.074196 --> 0.074158).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.340756416320801
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0479540  Vali Loss: 0.0764113 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798245  Vali macro F1 0.9717520 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.336070537567139
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0457007  Vali Loss: 0.0753271 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798526  Vali macro F1 0.9711300 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.326536178588867
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0467075  Vali Loss: 0.0741283 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803995  Vali macro F1 0.9708666 
new best score!!!!
Validation loss decreased (0.074158 --> 0.074128).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.361093282699585
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0461592  Vali Loss: 0.0739658 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798602  Vali macro F1 0.9708814 
new best score!!!!
Validation loss decreased (0.074128 --> 0.073966).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.369839668273926
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0455811  Vali Loss: 0.0758548 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789477  Vali macro F1 0.9700647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.347400426864624
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0455111  Vali Loss: 0.0775870 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9775060  Vali macro F1 0.9687432 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.327254772186279
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0452591  Vali Loss: 0.0738155 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793070  Vali macro F1 0.9700346 
new best score!!!!
Validation loss decreased (0.073966 --> 0.073815).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.336658000946045
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0437386  Vali Loss: 0.0780705 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9774995  Vali macro F1 0.9690492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.347185134887695
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0433786  Vali Loss: 0.0761814 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779872  Vali macro F1 0.9695329 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.345476865768433
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0437999  Vali Loss: 0.0723621 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793862  Vali macro F1 0.9700181 
new best score!!!!
Validation loss decreased (0.073815 --> 0.072362).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.34639310836792
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0428612  Vali Loss: 0.0727726 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798219  Vali macro F1 0.9710478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.353102207183838
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0446045  Vali Loss: 0.0771187 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779574  Vali macro F1 0.9693132 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.350874185562134
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0416164  Vali Loss: 0.0722496 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803596  Vali macro F1 0.9717335 
new best score!!!!
Validation loss decreased (0.072362 --> 0.072250).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.362300157546997
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0425558  Vali Loss: 0.0739908 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793961  Vali macro F1 0.9706323 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.342551946640015
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0428076  Vali Loss: 0.0768522 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9804024  Vali macro F1 0.9727052 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.691501617431641
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0431261  Vali Loss: 0.0743817 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793618  Vali macro F1 0.9705641 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.331381797790527
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0436227  Vali Loss: 0.0761552 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798887  Vali macro F1 0.9711804 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.334048748016357
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0443259  Vali Loss: 0.0750795 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788749  Vali macro F1 0.9700995 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 30 cost time: 6.330970525741577
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0405578  Vali Loss: 0.0766471 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779390  Vali macro F1 0.9692497 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.333305835723877
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0413034  Vali Loss: 0.0741719 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803759  Vali macro F1 0.9718037 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.426230192184448
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0415732  Vali Loss: 0.0737561 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793365  Vali macro F1 0.9702502 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.363998651504517
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0429077  Vali Loss: 0.0753591 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789106  Vali macro F1 0.9699933 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.366121768951416
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0398750  Vali Loss: 0.0739720 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9818598  Vali macro F1 0.9742077 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 35 cost time: 6.334846019744873
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0427568  Vali Loss: 0.0736913 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808627  Vali macro F1 0.9722880 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 6.347857713699341
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0378451  Vali Loss: 0.0738107 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9813473  Vali macro F1 0.9730844 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 6.476114749908447
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0386181  Vali Loss: 0.0734257 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803920  Vali macro F1 0.9717764 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 6.338858604431152
Fine Tuning VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0404764  Vali Loss: 0.0743249 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798784  Vali macro F1 0.9715634 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 6.3415141105651855
Fine Tuning VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0396977  Vali Loss: 0.0742592 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9804007  Vali macro F1 0.9718009 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7782249  Test weighted F1: 0.7835768  Test macro F1 0.8171202 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014624 0.00017832 0.00108342 0.00132979 0.00049529 0.00062696]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.269335746765137
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.4202083  Vali Loss: 0.9789369 Vali Accuracy: 0.6727549  Vali weighted F1: 0.5683963  Vali macro F1 0.2727960 
Validation loss decreased (inf --> 0.978937).  Saving model ...
Epoch: 2 cost time: 6.162945985794067
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.8139052  Vali Loss: 0.7171116 Vali Accuracy: 0.7564688  Vali weighted F1: 0.6797482  Vali macro F1 0.4530373 
new best score!!!!
Validation loss decreased (0.978937 --> 0.717112).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.152571201324463
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.6201259  Vali Loss: 0.5407620 Vali Accuracy: 0.8046677  Vali weighted F1: 0.7642303  Vali macro F1 0.5580416 
new best score!!!!
Validation loss decreased (0.717112 --> 0.540762).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.13781213760376
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4577531  Vali Loss: 0.4056768 Vali Accuracy: 0.8371385  Vali weighted F1: 0.8144777  Vali macro F1 0.6130147 
new best score!!!!
Validation loss decreased (0.540762 --> 0.405677).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.15732216835022
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3947094  Vali Loss: 0.3685824 Vali Accuracy: 0.8437341  Vali weighted F1: 0.8256409  Vali macro F1 0.6273933 
new best score!!!!
Validation loss decreased (0.405677 --> 0.368582).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.170520305633545
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.3591954  Vali Loss: 0.3457150 Vali Accuracy: 0.8630137  Vali weighted F1: 0.8490551  Vali macro F1 0.6609420 
new best score!!!!
Validation loss decreased (0.368582 --> 0.345715).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.156830310821533
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.3331415  Vali Loss: 0.3149317 Vali Accuracy: 0.8726535  Vali weighted F1: 0.8558930  Vali macro F1 0.6725109 
new best score!!!!
Validation loss decreased (0.345715 --> 0.314932).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.164403438568115
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.3052172  Vali Loss: 0.2987962 Vali Accuracy: 0.8772197  Vali weighted F1: 0.8600273  Vali macro F1 0.6791016 
new best score!!!!
Validation loss decreased (0.314932 --> 0.298796).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.159327745437622
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.2805383  Vali Loss: 0.2402615 Vali Accuracy: 0.9279554  Vali weighted F1: 0.9274040  Vali macro F1 0.8952334 
new best score!!!!
Validation loss decreased (0.298796 --> 0.240262).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.172453165054321
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.2364460  Vali Loss: 0.2104423 Vali Accuracy: 0.9320142  Vali weighted F1: 0.9314308  Vali macro F1 0.8911375 
new best score!!!!
Validation loss decreased (0.240262 --> 0.210442).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.165785551071167
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.2150721  Vali Loss: 0.1811205 Vali Accuracy: 0.9365804  Vali weighted F1: 0.9357545  Vali macro F1 0.9129782 
new best score!!!!
Validation loss decreased (0.210442 --> 0.181121).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.170292615890503
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1984555  Vali Loss: 0.1762255 Vali Accuracy: 0.9436834  Vali weighted F1: 0.9442807  Vali macro F1 0.9267273 
new best score!!!!
Validation loss decreased (0.181121 --> 0.176225).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.167467355728149
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1930882  Vali Loss: 0.2030012 Vali Accuracy: 0.9330289  Vali weighted F1: 0.9317126  Vali macro F1 0.9126158 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 12.05919075012207
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1823984  Vali Loss: 0.1675965 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9501959  Vali macro F1 0.9374427 
new best score!!!!
Validation loss decreased (0.176225 --> 0.167597).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.232749938964844
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1680329  Vali Loss: 0.1596078 Vali Accuracy: 0.9477423  Vali weighted F1: 0.9470256  Vali macro F1 0.9281063 
new best score!!!!
Validation loss decreased (0.167597 --> 0.159608).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.141331195831299
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1538161  Vali Loss: 0.1238833 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9570116  Vali macro F1 0.9426102 
new best score!!!!
Validation loss decreased (0.159608 --> 0.123883).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.137617111206055
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1484378  Vali Loss: 0.1209134 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9619504  Vali macro F1 0.9516389 
new best score!!!!
Validation loss decreased (0.123883 --> 0.120913).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.129645109176636
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1463323  Vali Loss: 0.1131042 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9646335  Vali macro F1 0.9546222 
new best score!!!!
Validation loss decreased (0.120913 --> 0.113104).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.162628650665283
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1409213  Vali Loss: 0.1362722 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9551405  Vali macro F1 0.9426695 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.1752846240997314
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1335634  Vali Loss: 0.1402079 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9457324  Vali macro F1 0.9322821 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.14926815032959
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1308447  Vali Loss: 0.1097301 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9588904  Vali macro F1 0.9458673 
new best score!!!!
Validation loss decreased (0.113104 --> 0.109730).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.148008584976196
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1244704  Vali Loss: 0.1020672 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9688712  Vali macro F1 0.9595798 
new best score!!!!
Validation loss decreased (0.109730 --> 0.102067).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.134995460510254
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.1218314  Vali Loss: 0.1978735 Vali Accuracy: 0.9340436  Vali weighted F1: 0.9306788  Vali macro F1 0.9138930 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.147808790206909
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.1202220  Vali Loss: 0.1334736 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9504728  Vali macro F1 0.9396155 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.1468329429626465
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1188468  Vali Loss: 0.0926552 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707047  Vali macro F1 0.9607110 
new best score!!!!
Validation loss decreased (0.102067 --> 0.092655).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.140095949172974
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.1038424  Vali Loss: 0.0946420 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9700136  Vali macro F1 0.9575534 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.158749580383301
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.1053995  Vali Loss: 0.0866722 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9714336  Vali macro F1 0.9570639 
new best score!!!!
Validation loss decreased (0.092655 --> 0.086672).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.161296606063843
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.1062155  Vali Loss: 0.0945403 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9682483  Vali macro F1 0.9570408 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.1768412590026855
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.1034353  Vali Loss: 0.0980443 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9672778  Vali macro F1 0.9592920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.153652906417847
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0907450  Vali Loss: 0.1129220 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9624101  Vali macro F1 0.9521132 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.1453163623809814
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0926146  Vali Loss: 0.0736578 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9768734  Vali macro F1 0.9660302 
new best score!!!!
Validation loss decreased (0.086672 --> 0.073658).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.139758825302124
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0885438  Vali Loss: 0.0842522 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9706441  Vali macro F1 0.9615407 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.129612684249878
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0924185  Vali Loss: 0.0885134 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9694538  Vali macro F1 0.9581032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.1401166915893555
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0837576  Vali Loss: 0.0770275 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747743  Vali macro F1 0.9644270 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.13820743560791
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0855024  Vali Loss: 0.0708087 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778721  Vali macro F1 0.9677566 
new best score!!!!
Validation loss decreased (0.073658 --> 0.070809).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.14960789680481
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0826664  Vali Loss: 0.1290503 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9529634  Vali macro F1 0.9399476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.163589715957642
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0830952  Vali Loss: 0.0876779 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9714004  Vali macro F1 0.9610755 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.147571563720703
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0782207  Vali Loss: 0.0639437 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778306  Vali macro F1 0.9668815 
new best score!!!!
Validation loss decreased (0.070809 --> 0.063944).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.150726079940796
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0850315  Vali Loss: 0.0738123 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9760032  Vali macro F1 0.9651323 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.141790390014648
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0772717  Vali Loss: 0.1006449 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9667259  Vali macro F1 0.9607085 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.1464080810546875
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0733700  Vali Loss: 0.0616613 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828432  Vali macro F1 0.9765228 
new best score!!!!
Validation loss decreased (0.063944 --> 0.061661).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.153371334075928
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0697223  Vali Loss: 0.1518458 Vali Accuracy: 0.9441908  Vali weighted F1: 0.9445995  Vali macro F1 0.9354586 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.1463587284088135
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0819328  Vali Loss: 0.0748663 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9765090  Vali macro F1 0.9704818 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.137002229690552
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0695395  Vali Loss: 0.0866593 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9705748  Vali macro F1 0.9627574 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.150069952011108
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0705777  Vali Loss: 0.0928866 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9675059  Vali macro F1 0.9634482 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.1579132080078125
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0680172  Vali Loss: 0.1533613 Vali Accuracy: 0.9446981  Vali weighted F1: 0.9454952  Vali macro F1 0.9299124 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 6.160516023635864
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0639342  Vali Loss: 0.0632830 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819612  Vali macro F1 0.9752148 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.1512980461120605
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0595397  Vali Loss: 0.0615268 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823556  Vali macro F1 0.9762389 
new best score!!!!
Validation loss decreased (0.061661 --> 0.061527).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.150012016296387
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0571707  Vali Loss: 0.0621516 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823823  Vali macro F1 0.9785727 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.138483047485352
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0552251  Vali Loss: 0.0607798 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9834006  Vali macro F1 0.9801357 
new best score!!!!
Validation loss decreased (0.061527 --> 0.060780).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.1359782218933105
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0564178  Vali Loss: 0.0632290 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9813903  Vali macro F1 0.9778679 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.13843560218811
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0565306  Vali Loss: 0.0610578 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828417  Vali macro F1 0.9795841 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.138601779937744
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0552690  Vali Loss: 0.0622561 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9813322  Vali macro F1 0.9779474 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.148966550827026
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0565118  Vali Loss: 0.0593702 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838449  Vali macro F1 0.9800634 
new best score!!!!
Validation loss decreased (0.060780 --> 0.059370).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.151649475097656
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0558600  Vali Loss: 0.0680470 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9803529  Vali macro F1 0.9767846 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.171662330627441
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0559925  Vali Loss: 0.0622919 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833596  Vali macro F1 0.9800851 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.147370338439941
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0541792  Vali Loss: 0.0617042 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829213  Vali macro F1 0.9789390 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.1352458000183105
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0539849  Vali Loss: 0.0620637 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828546  Vali macro F1 0.9792609 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.123493194580078
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0536956  Vali Loss: 0.0617436 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819144  Vali macro F1 0.9785623 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 6.133936643600464
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0534820  Vali Loss: 0.0585441 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843947  Vali macro F1 0.9810404 
new best score!!!!
Validation loss decreased (0.059370 --> 0.058544).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.141884088516235
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0531292  Vali Loss: 0.0578962 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843947  Vali macro F1 0.9810404 
new best score!!!!
Validation loss decreased (0.058544 --> 0.057896).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.133751630783081
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0531167  Vali Loss: 0.0588400 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843766  Vali macro F1 0.9812714 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.154651880264282
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0536271  Vali Loss: 0.0581254 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843766  Vali macro F1 0.9812714 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.160737991333008
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0536067  Vali Loss: 0.0572387 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843947  Vali macro F1 0.9810404 
new best score!!!!
Validation loss decreased (0.057896 --> 0.057239).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 6.1491076946258545
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0533121  Vali Loss: 0.0581323 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843947  Vali macro F1 0.9810404 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 6.133002758026123
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0545233  Vali Loss: 0.0596859 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828842  Vali macro F1 0.9797387 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 6.126276969909668
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0533647  Vali Loss: 0.0589359 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838702  Vali macro F1 0.9806885 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.137023210525513
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0515480  Vali Loss: 0.0577778 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.141769170761108
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0526912  Vali Loss: 0.0587104 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838837  Vali macro F1 0.9807960 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 70 cost time: 6.136590480804443
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0518903  Vali Loss: 0.0583231 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 6.141782999038696
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0533602  Vali Loss: 0.0582115 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 6.164764642715454
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0527227  Vali Loss: 0.0581566 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 6.15045952796936
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0518032  Vali Loss: 0.0580924 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 6.1500139236450195
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0547323  Vali Loss: 0.0580256 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 75 cost time: 6.140238046646118
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0522214  Vali Loss: 0.0580300 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 6.151611566543579
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0533609  Vali Loss: 0.0580251 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 77 cost time: 6.142967224121094
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0550199  Vali Loss: 0.0580355 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 78 cost time: 6.127401351928711
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0529870  Vali Loss: 0.0580480 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 79 cost time: 6.1399829387664795
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0540287  Vali Loss: 0.0580452 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838684  Vali macro F1 0.9793988 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9402779  Test weighted F1: 0.9414343  Test macro F1 0.9090710 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.195256948471069
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0512698  Vali Loss: 0.0623472 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824253  Vali macro F1 0.9790508 
Validation loss decreased (inf --> 0.062347).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.1472039222717285
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0553026  Vali Loss: 0.0617055 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829432  Vali macro F1 0.9793975 
new best score!!!!
Validation loss decreased (0.062347 --> 0.061705).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.153178930282593
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0539515  Vali Loss: 0.0585918 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833647  Vali macro F1 0.9801080 
new best score!!!!
Validation loss decreased (0.061705 --> 0.058592).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.128497838973999
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0550848  Vali Loss: 0.0563799 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848832  Vali macro F1 0.9818361 
new best score!!!!
Validation loss decreased (0.058592 --> 0.056380).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.150953531265259
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0511439  Vali Loss: 0.0609422 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9813771  Vali macro F1 0.9768118 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.139008522033691
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0540602  Vali Loss: 0.0566407 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9854136  Vali macro F1 0.9821146 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.132181406021118
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0515029  Vali Loss: 0.0565212 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843758  Vali macro F1 0.9799839 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.13576865196228
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0526826  Vali Loss: 0.0590802 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9844138  Vali macro F1 0.9797682 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.132192134857178
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0545029  Vali Loss: 0.0616767 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9834503  Vali macro F1 0.9782539 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.1427319049835205
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0531883  Vali Loss: 0.0570226 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833837  Vali macro F1 0.9784224 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.1577308177948
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0495263  Vali Loss: 0.0697957 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9788697  Vali macro F1 0.9735466 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.177029371261597
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0534122  Vali Loss: 0.0634282 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9808678  Vali macro F1 0.9750606 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.147402048110962
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0527265  Vali Loss: 0.0560106 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838808  Vali macro F1 0.9792420 
new best score!!!!
Validation loss decreased (0.056380 --> 0.056011).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.151758909225464
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0512958  Vali Loss: 0.0612635 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833367  Vali macro F1 0.9787399 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.14028000831604
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0546982  Vali Loss: 0.0582705 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833694  Vali macro F1 0.9782936 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.153124570846558
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0502933  Vali Loss: 0.0595250 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9834019  Vali macro F1 0.9784386 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.961859703063965
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0508815  Vali Loss: 0.0606913 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9818270  Vali macro F1 0.9756183 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.16536021232605
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0501902  Vali Loss: 0.0578696 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843705  Vali macro F1 0.9795981 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.161572217941284
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0490201  Vali Loss: 0.0568874 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848783  Vali macro F1 0.9801835 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.3779072761535645
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0482939  Vali Loss: 0.0572726 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843705  Vali macro F1 0.9795981 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.230082035064697
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0502451  Vali Loss: 0.0574626 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833899  Vali macro F1 0.9786713 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.1411449909210205
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0491595  Vali Loss: 0.0585945 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833899  Vali macro F1 0.9786713 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.140225887298584
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0495606  Vali Loss: 0.0576948 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833899  Vali macro F1 0.9786713 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 6.1561994552612305
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0487629  Vali Loss: 0.0574795 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833899  Vali macro F1 0.9786713 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.151791572570801
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0487836  Vali Loss: 0.0575231 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833899  Vali macro F1 0.9786713 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.139830112457275
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0488690  Vali Loss: 0.0573393 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833899  Vali macro F1 0.9786713 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.1329262256622314
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0479369  Vali Loss: 0.0573984 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833899  Vali macro F1 0.9786713 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.141146183013916
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0460546  Vali Loss: 0.0574422 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833899  Vali macro F1 0.9786713 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9406460  Test weighted F1: 0.9417495  Test macro F1 0.9077265 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013998 0.00018225 0.00103093 0.00127065 0.00049751 0.0005988 ]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.241598129272461
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.4022546  Vali Loss: 0.9849390 Vali Accuracy: 0.6568725  Vali weighted F1: 0.5432508  Vali macro F1 0.2675665 
Validation loss decreased (inf --> 0.984939).  Saving model ...
Epoch: 2 cost time: 6.248170375823975
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.8009533  Vali Loss: 0.7271331 Vali Accuracy: 0.7475100  Vali weighted F1: 0.6727740  Vali macro F1 0.4622409 
new best score!!!!
Validation loss decreased (0.984939 --> 0.727133).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.248311281204224
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.6540851  Vali Loss: 0.5835089 Vali Accuracy: 0.7838645  Vali weighted F1: 0.7462019  Vali macro F1 0.5528869 
new best score!!!!
Validation loss decreased (0.727133 --> 0.583509).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 7.6792685985565186
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.5494888  Vali Loss: 0.4755419 Vali Accuracy: 0.8092629  Vali weighted F1: 0.7835383  Vali macro F1 0.5955556 
new best score!!!!
Validation loss decreased (0.583509 --> 0.475542).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.2394020557403564
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.4321557  Vali Loss: 0.4287657 Vali Accuracy: 0.8321713  Vali weighted F1: 0.8043192  Vali macro F1 0.6170278 
new best score!!!!
Validation loss decreased (0.475542 --> 0.428766).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.22848105430603
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.3587641  Vali Loss: 0.3047815 Vali Accuracy: 0.8784861  Vali weighted F1: 0.8639346  Vali macro F1 0.6841865 
new best score!!!!
Validation loss decreased (0.428766 --> 0.304782).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.222874641418457
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.2955096  Vali Loss: 0.2488251 Vali Accuracy: 0.9218127  Vali weighted F1: 0.9206581  Vali macro F1 0.8940368 
new best score!!!!
Validation loss decreased (0.304782 --> 0.248825).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.247656583786011
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2507594  Vali Loss: 0.2481860 Vali Accuracy: 0.9118526  Vali weighted F1: 0.9067933  Vali macro F1 0.8794531 
new best score!!!!
Validation loss decreased (0.248825 --> 0.248186).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.26765513420105
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.2142892  Vali Loss: 0.2086840 Vali Accuracy: 0.9332669  Vali weighted F1: 0.9320828  Vali macro F1 0.9136591 
new best score!!!!
Validation loss decreased (0.248186 --> 0.208684).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.217928409576416
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1986733  Vali Loss: 0.1857590 Vali Accuracy: 0.9372510  Vali weighted F1: 0.9359904  Vali macro F1 0.9205342 
new best score!!!!
Validation loss decreased (0.208684 --> 0.185759).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.243826150894165
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1847425  Vali Loss: 0.1847615 Vali Accuracy: 0.9382470  Vali weighted F1: 0.9379225  Vali macro F1 0.9233435 
new best score!!!!
Validation loss decreased (0.185759 --> 0.184761).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.227961778640747
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1796501  Vali Loss: 0.1717497 Vali Accuracy: 0.9412351  Vali weighted F1: 0.9420193  Vali macro F1 0.9277822 
new best score!!!!
Validation loss decreased (0.184761 --> 0.171750).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.233741521835327
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1738305  Vali Loss: 0.1657160 Vali Accuracy: 0.9472112  Vali weighted F1: 0.9462803  Vali macro F1 0.9346514 
new best score!!!!
Validation loss decreased (0.171750 --> 0.165716).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.236042499542236
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1652939  Vali Loss: 0.1569769 Vali Accuracy: 0.9492032  Vali weighted F1: 0.9488486  Vali macro F1 0.9381598 
new best score!!!!
Validation loss decreased (0.165716 --> 0.156977).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.225027084350586
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1670597  Vali Loss: 0.1654647 Vali Accuracy: 0.9472112  Vali weighted F1: 0.9453907  Vali macro F1 0.9362099 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.246077299118042
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1579019  Vali Loss: 0.1448469 Vali Accuracy: 0.9516932  Vali weighted F1: 0.9518226  Vali macro F1 0.9393094 
new best score!!!!
Validation loss decreased (0.156977 --> 0.144847).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.256656885147095
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1482592  Vali Loss: 0.1590169 Vali Accuracy: 0.9516932  Vali weighted F1: 0.9521912  Vali macro F1 0.9390057 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.23655891418457
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1462150  Vali Loss: 0.1410630 Vali Accuracy: 0.9541833  Vali weighted F1: 0.9541948  Vali macro F1 0.9445887 
new best score!!!!
Validation loss decreased (0.144847 --> 0.141063).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.231346607208252
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1426675  Vali Loss: 0.1309295 Vali Accuracy: 0.9571713  Vali weighted F1: 0.9573514  Vali macro F1 0.9476367 
new best score!!!!
Validation loss decreased (0.141063 --> 0.130930).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.235987424850464
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1354999  Vali Loss: 0.1302843 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9582696  Vali macro F1 0.9491810 
new best score!!!!
Validation loss decreased (0.130930 --> 0.130284).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.223100185394287
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1385792  Vali Loss: 0.1272881 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9587057  Vali macro F1 0.9497670 
new best score!!!!
Validation loss decreased (0.130284 --> 0.127288).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.229857683181763
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.1298730  Vali Loss: 0.1260127 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9617224  Vali macro F1 0.9520518 
new best score!!!!
Validation loss decreased (0.127288 --> 0.126013).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.233136177062988
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.1254873  Vali Loss: 0.1212595 Vali Accuracy: 0.9591633  Vali weighted F1: 0.9593290  Vali macro F1 0.9507343 
new best score!!!!
Validation loss decreased (0.126013 --> 0.121259).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.240227222442627
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.1283145  Vali Loss: 0.1198369 Vali Accuracy: 0.9601594  Vali weighted F1: 0.9603082  Vali macro F1 0.9500738 
new best score!!!!
Validation loss decreased (0.121259 --> 0.119837).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.262551546096802
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.1157909  Vali Loss: 0.1325586 Vali Accuracy: 0.9556773  Vali weighted F1: 0.9563733  Vali macro F1 0.9466128 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.2629618644714355
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.1145389  Vali Loss: 0.1194240 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9583930  Vali macro F1 0.9477366 
new best score!!!!
Validation loss decreased (0.119837 --> 0.119424).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.233417510986328
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.1186319  Vali Loss: 0.1084034 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9632242  Vali macro F1 0.9545783 
new best score!!!!
Validation loss decreased (0.119424 --> 0.108403).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.225615978240967
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.1069811  Vali Loss: 0.1277597 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9581077  Vali macro F1 0.9504636 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.225494146347046
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.1035982  Vali Loss: 0.1128050 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9645523  Vali macro F1 0.9557307 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.2401649951934814
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.1011657  Vali Loss: 0.1357835 Vali Accuracy: 0.9511952  Vali weighted F1: 0.9517578  Vali macro F1 0.9367329 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.228142499923706
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0941892  Vali Loss: 0.1296727 Vali Accuracy: 0.9561753  Vali weighted F1: 0.9558263  Vali macro F1 0.9453841 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.227806568145752
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.1012642  Vali Loss: 0.1254885 Vali Accuracy: 0.9546813  Vali weighted F1: 0.9554437  Vali macro F1 0.9471471 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 6.235089540481567
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0843683  Vali Loss: 0.0937808 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718699  Vali macro F1 0.9644144 
new best score!!!!
Validation loss decreased (0.108403 --> 0.093781).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.233412742614746
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0827869  Vali Loss: 0.0955895 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9695015  Vali macro F1 0.9603029 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.247995853424072
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0830407  Vali Loss: 0.0993435 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9689595  Vali macro F1 0.9603907 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.24116063117981
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0817943  Vali Loss: 0.0934349 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9700373  Vali macro F1 0.9625576 
new best score!!!!
Validation loss decreased (0.093781 --> 0.093435).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.230049133300781
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0801332  Vali Loss: 0.0944442 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9689216  Vali macro F1 0.9594863 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.232500791549683
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0809991  Vali Loss: 0.0972142 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9699236  Vali macro F1 0.9601366 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.2371604442596436
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0821363  Vali Loss: 0.0929789 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9693619  Vali macro F1 0.9593863 
new best score!!!!
Validation loss decreased (0.093435 --> 0.092979).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.223511457443237
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0799821  Vali Loss: 0.0963341 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9704941  Vali macro F1 0.9618521 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.2345921993255615
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0789725  Vali Loss: 0.0898827 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9703302  Vali macro F1 0.9601727 
new best score!!!!
Validation loss decreased (0.092979 --> 0.089883).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.25364875793457
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0776296  Vali Loss: 0.0917674 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723713  Vali macro F1 0.9628636 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.251629590988159
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0774201  Vali Loss: 0.0916403 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9714299  Vali macro F1 0.9617596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.23696231842041
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0781447  Vali Loss: 0.0925958 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9705042  Vali macro F1 0.9619369 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.233843088150024
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0781451  Vali Loss: 0.0932021 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9699399  Vali macro F1 0.9610414 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.226576805114746
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0734157  Vali Loss: 0.0917763 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9710339  Vali macro F1 0.9625996 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.219850778579712
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0771325  Vali Loss: 0.0903659 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9704155  Vali macro F1 0.9612996 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.223952770233154
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0759440  Vali Loss: 0.0897214 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9709041  Vali macro F1 0.9620516 
new best score!!!!
Validation loss decreased (0.089883 --> 0.089721).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.225297927856445
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0732775  Vali Loss: 0.0896565 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9709041  Vali macro F1 0.9620516 
new best score!!!!
Validation loss decreased (0.089721 --> 0.089656).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.225449562072754
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0750938  Vali Loss: 0.0897890 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9699406  Vali macro F1 0.9602150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.251761436462402
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0754929  Vali Loss: 0.0899403 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9714187  Vali macro F1 0.9625364 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.2512078285217285
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0752190  Vali Loss: 0.0896415 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9724010  Vali macro F1 0.9631354 
new best score!!!!
Validation loss decreased (0.089656 --> 0.089642).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.229731559753418
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0756609  Vali Loss: 0.0888908 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9719082  Vali macro F1 0.9627562 
new best score!!!!
Validation loss decreased (0.089642 --> 0.088891).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.23845911026001
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0768861  Vali Loss: 0.0885939 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9719082  Vali macro F1 0.9627562 
new best score!!!!
Validation loss decreased (0.088891 --> 0.088594).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.237301349639893
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0741081  Vali Loss: 0.0889721 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9718836  Vali macro F1 0.9629393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.225182056427002
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0735112  Vali Loss: 0.0889653 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.219034910202026
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0748380  Vali Loss: 0.0890881 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713700  Vali macro F1 0.9624558 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.231556177139282
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0756520  Vali Loss: 0.0890775 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9719012  Vali macro F1 0.9622336 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.22808051109314
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0753448  Vali Loss: 0.0892895 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728735  Vali macro F1 0.9638536 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 60 cost time: 6.2479634284973145
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0737395  Vali Loss: 0.0892571 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728735  Vali macro F1 0.9638536 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.245816230773926
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0737019  Vali Loss: 0.0891980 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.235432386398315
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0737665  Vali Loss: 0.0892404 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728735  Vali macro F1 0.9638536 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.236722707748413
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0737898  Vali Loss: 0.0891846 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.225823879241943
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0736251  Vali Loss: 0.0891874 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 65 cost time: 6.220831632614136
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0752834  Vali Loss: 0.0891839 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 6.219938278198242
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0746462  Vali Loss: 0.0891932 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 6.216673374176025
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0740262  Vali Loss: 0.0891867 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.239278078079224
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0764498  Vali Loss: 0.0891780 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.25248122215271
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0739805  Vali Loss: 0.0891692 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723604  Vali macro F1 0.9633710 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9153181  Test weighted F1: 0.9167023  Test macro F1 0.8925853 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 17919
pruned model Parameter : 21838
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.306534290313721
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0765816  Vali Loss: 0.0952010 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9695391  Vali macro F1 0.9606258 
Validation loss decreased (inf --> 0.095201).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.235580205917358
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0757255  Vali Loss: 0.0916927 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9714209  Vali macro F1 0.9607214 
new best score!!!!
Validation loss decreased (0.095201 --> 0.091693).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.24707818031311
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0762647  Vali Loss: 0.0946766 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9709163  Vali macro F1 0.9609254 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.232218027114868
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0749332  Vali Loss: 0.0884735 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728348  Vali macro F1 0.9638530 
new best score!!!!
Validation loss decreased (0.091693 --> 0.088473).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.241626024246216
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0767405  Vali Loss: 0.0856087 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723664  Vali macro F1 0.9626499 
new best score!!!!
Validation loss decreased (0.088473 --> 0.085609).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.242859125137329
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0730133  Vali Loss: 0.0890487 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9714335  Vali macro F1 0.9618664 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.269992351531982
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0744030  Vali Loss: 0.0880354 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9710391  Vali macro F1 0.9613108 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.261709690093994
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0731748  Vali Loss: 0.0868741 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728973  Vali macro F1 0.9636693 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.264903545379639
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0727684  Vali Loss: 0.0869751 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738473  Vali macro F1 0.9632702 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.264300346374512
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0718361  Vali Loss: 0.0933837 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9699809  Vali macro F1 0.9589587 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.240220308303833
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0714771  Vali Loss: 0.0851246 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728281  Vali macro F1 0.9608891 
new best score!!!!
Validation loss decreased (0.085609 --> 0.085125).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.251996040344238
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0734110  Vali Loss: 0.0843518 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9724210  Vali macro F1 0.9623684 
new best score!!!!
Validation loss decreased (0.085125 --> 0.084352).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.252597332000732
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0712865  Vali Loss: 0.0859902 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723405  Vali macro F1 0.9628317 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.260222673416138
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0687110  Vali Loss: 0.0851811 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733907  Vali macro F1 0.9618469 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.260019063949585
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0710826  Vali Loss: 0.0900798 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723505  Vali macro F1 0.9618196 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.259984731674194
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0710399  Vali Loss: 0.0850109 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9729243  Vali macro F1 0.9624613 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.400994300842285
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0695259  Vali Loss: 0.0827650 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9747897  Vali macro F1 0.9649763 
new best score!!!!
Validation loss decreased (0.084352 --> 0.082765).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.273223400115967
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0674896  Vali Loss: 0.0833527 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728464  Vali macro F1 0.9611217 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.242359399795532
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0691989  Vali Loss: 0.0997230 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9674412  Vali macro F1 0.9566001 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.248867511749268
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0693664  Vali Loss: 0.0851952 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742418  Vali macro F1 0.9643204 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.25986123085022
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0677150  Vali Loss: 0.0846605 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9748462  Vali macro F1 0.9650361 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.2467498779296875
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0697045  Vali Loss: 0.0873452 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733489  Vali macro F1 0.9629817 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.245141506195068
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0650659  Vali Loss: 0.0835726 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733766  Vali macro F1 0.9632752 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.25271201133728
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0654498  Vali Loss: 0.0826914 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9748447  Vali macro F1 0.9649240 
new best score!!!!
Validation loss decreased (0.082765 --> 0.082691).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.257040739059448
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0651430  Vali Loss: 0.0826613 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743144  Vali macro F1 0.9642108 
new best score!!!!
Validation loss decreased (0.082691 --> 0.082661).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.281945466995239
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0642791  Vali Loss: 0.0832280 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733766  Vali macro F1 0.9632752 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.237912893295288
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0656602  Vali Loss: 0.0825259 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743740  Vali macro F1 0.9641004 
new best score!!!!
Validation loss decreased (0.082661 --> 0.082526).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 6.238538503646851
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0641107  Vali Loss: 0.0821731 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743328  Vali macro F1 0.9641421 
new best score!!!!
Validation loss decreased (0.082526 --> 0.082173).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.253163576126099
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0638522  Vali Loss: 0.0829279 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738030  Vali macro F1 0.9637647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.270713567733765
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0635061  Vali Loss: 0.0823274 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743117  Vali macro F1 0.9643298 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.255563020706177
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0658488  Vali Loss: 0.0822314 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738545  Vali macro F1 0.9637082 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.259557247161865
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0633567  Vali Loss: 0.0821324 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738545  Vali macro F1 0.9637082 
new best score!!!!
Validation loss decreased (0.082173 --> 0.082132).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.276075601577759
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0669845  Vali Loss: 0.0829318 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733430  Vali macro F1 0.9632623 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.269390106201172
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0647310  Vali Loss: 0.0828116 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738325  Vali macro F1 0.9638948 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.237810373306274
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0644082  Vali Loss: 0.0826462 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743144  Vali macro F1 0.9642108 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.233758211135864
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0650100  Vali Loss: 0.0826712 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738344  Vali macro F1 0.9637746 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.240022897720337
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0643047  Vali Loss: 0.0822134 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9748491  Vali macro F1 0.9646173 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 38 cost time: 6.237035512924194
Fine Tuning VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0644010  Vali Loss: 0.0822986 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743347  Vali macro F1 0.9640219 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 6.246654033660889
Fine Tuning VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0642667  Vali Loss: 0.0824155 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743347  Vali macro F1 0.9640219 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 6.243419647216797
Fine Tuning VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0653111  Vali Loss: 0.0825631 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743347  Vali macro F1 0.9640219 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 6.249368906021118
Fine Tuning VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0629953  Vali Loss: 0.0824907 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738545  Vali macro F1 0.9637082 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 6.27827787399292
Fine Tuning VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0651593  Vali Loss: 0.0827468 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738325  Vali macro F1 0.9638948 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 43 cost time: 6.257227182388306
Fine Tuning VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0643725  Vali Loss: 0.0827673 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738325  Vali macro F1 0.9638948 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 6.2513439655303955
Fine Tuning VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0633759  Vali Loss: 0.0827724 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738325  Vali macro F1 0.9638948 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 6.258696794509888
Fine Tuning VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0676076  Vali Loss: 0.0827797 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738325  Vali macro F1 0.9638948 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 46 cost time: 6.246748685836792
Fine Tuning VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0665623  Vali Loss: 0.0827698 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738325  Vali macro F1 0.9638948 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 47 cost time: 6.254112482070923
Fine Tuning VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0640033  Vali Loss: 0.0827757 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738325  Vali macro F1 0.9638948 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9172024  Test weighted F1: 0.9185088  Test macro F1 0.8946844 

============================= JOB FEEDBACK =============================

NodeName=uc2n561
Job ID: 20948441
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 09:59:20
CPU Efficiency: 4.98% of 8-08:23:00 core-walltime
Job Wall-clock time: 10:01:09
Memory Utilized: 5.02 GB
Memory Efficiency: 0.00% of 0.00 MB
