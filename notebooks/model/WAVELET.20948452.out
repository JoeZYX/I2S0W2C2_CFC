Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 636195
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0027933  0.00240964 0.00243309 0.00330033 0.00526316 0.00581395
 0.00303951 0.00290698 0.00234742 0.00421941]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 2.392361640930176
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1817580  Vali Loss: 1.7698713 Vali Accuracy: 0.3898305  Vali weighted F1: 0.3321475  Vali macro F1 0.2979549 
Validation loss decreased (inf --> 1.769871).  Saving model ...
Epoch: 2 cost time: 1.3385546207427979
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4184125  Vali Loss: 0.9768507 Vali Accuracy: 0.6723164  Vali weighted F1: 0.6522942  Vali macro F1 0.6177384 
new best score!!!!
Validation loss decreased (1.769871 --> 0.976851).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3352060317993164
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.9225280  Vali Loss: 0.6519169 Vali Accuracy: 0.7711864  Vali weighted F1: 0.7520154  Vali macro F1 0.7132832 
new best score!!!!
Validation loss decreased (0.976851 --> 0.651917).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3444960117340088
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6603684  Vali Loss: 0.5015358 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8291361  Vali macro F1 0.8051177 
new best score!!!!
Validation loss decreased (0.651917 --> 0.501536).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3593802452087402
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4920131  Vali Loss: 0.3805935 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8377909  Vali macro F1 0.7952292 
new best score!!!!
Validation loss decreased (0.501536 --> 0.380593).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3629183769226074
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3975934  Vali Loss: 0.3276117 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8345406  Vali macro F1 0.7897326 
new best score!!!!
Validation loss decreased (0.380593 --> 0.327612).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3617725372314453
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.3245970  Vali Loss: 0.2635708 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8727841  Vali macro F1 0.8379273 
new best score!!!!
Validation loss decreased (0.327612 --> 0.263571).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.358673334121704
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2864436  Vali Loss: 0.2147863 Vali Accuracy: 0.9180791  Vali weighted F1: 0.8984372  Vali macro F1 0.8473068 
new best score!!!!
Validation loss decreased (0.263571 --> 0.214786).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3625891208648682
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2338604  Vali Loss: 0.1966465 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9166285  Vali macro F1 0.8742045 
new best score!!!!
Validation loss decreased (0.214786 --> 0.196647).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3611862659454346
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2035945  Vali Loss: 0.1513200 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9385348  Vali macro F1 0.9102483 
new best score!!!!
Validation loss decreased (0.196647 --> 0.151320).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3584856986999512
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1794999  Vali Loss: 0.1352217 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9316625  Vali macro F1 0.8938830 
new best score!!!!
Validation loss decreased (0.151320 --> 0.135222).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.357480764389038
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1626198  Vali Loss: 0.1620787 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9330377  Vali macro F1 0.9052362 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3616211414337158
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1527443  Vali Loss: 0.1270354 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9280195  Vali macro F1 0.8923938 
new best score!!!!
Validation loss decreased (0.135222 --> 0.127035).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3575689792633057
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1474255  Vali Loss: 0.1568322 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9197495  Vali macro F1 0.8820190 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3572430610656738
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1338155  Vali Loss: 0.1157730 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9214557  Vali macro F1 0.8822613 
new best score!!!!
Validation loss decreased (0.127035 --> 0.115773).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3569862842559814
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1287685  Vali Loss: 0.1110611 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9508678  Vali macro F1 0.9285569 
new best score!!!!
Validation loss decreased (0.115773 --> 0.111061).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3601627349853516
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1216159  Vali Loss: 0.1243707 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9324744  Vali macro F1 0.9019228 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3283295631408691
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1106487  Vali Loss: 0.0932866 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9545147  Vali macro F1 0.9328682 
new best score!!!!
Validation loss decreased (0.111061 --> 0.093287).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3274321556091309
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1019445  Vali Loss: 0.1117742 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9431466  Vali macro F1 0.9178250 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3333401679992676
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0994899  Vali Loss: 0.0929702 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9569337  Vali macro F1 0.9339364 
new best score!!!!
Validation loss decreased (0.093287 --> 0.092970).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3308115005493164
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0918055  Vali Loss: 0.1061849 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9543391  Vali macro F1 0.9343184 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.3309662342071533
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0905391  Vali Loss: 0.0933885 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9573952  Vali macro F1 0.9390933 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 1.329909324645996
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0840936  Vali Loss: 0.0891995 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632806  Vali macro F1 0.9498254 
new best score!!!!
Validation loss decreased (0.092970 --> 0.089199).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.331176996231079
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0830796  Vali Loss: 0.1046491 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9386859  Vali macro F1 0.9035834 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3298041820526123
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0918226  Vali Loss: 0.1421918 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9434342  Vali macro F1 0.9258893 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.3301849365234375
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0925214  Vali Loss: 0.0867236 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9629094  Vali macro F1 0.9521592 
new best score!!!!
Validation loss decreased (0.089199 --> 0.086724).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3311924934387207
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0783732  Vali Loss: 0.0620199 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773619  Vali macro F1 0.9712333 
new best score!!!!
Validation loss decreased (0.086724 --> 0.062020).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.331563949584961
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0643050  Vali Loss: 0.0498406 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858378  Vali macro F1 0.9812523 
new best score!!!!
Validation loss decreased (0.062020 --> 0.049841).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3294339179992676
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0554024  Vali Loss: 0.0417900 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915294  Vali macro F1 0.9908467 
new best score!!!!
Validation loss decreased (0.049841 --> 0.041790).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3334341049194336
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0421608  Vali Loss: 0.0641582 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742529  Vali macro F1 0.9636306 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.332096815109253
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0371624  Vali Loss: 0.0334152 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886654  Vali macro F1 0.9831502 
new best score!!!!
Validation loss decreased (0.041790 --> 0.033415).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3311302661895752
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0466464  Vali Loss: 0.0485916 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859046  Vali macro F1 0.9851651 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.334501028060913
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0384594  Vali Loss: 0.0348861 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915327  Vali macro F1 0.9898868 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.332080364227295
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0302974  Vali Loss: 0.0266113 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887272  Vali macro F1 0.9875083 
new best score!!!!
Validation loss decreased (0.033415 --> 0.026611).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3362774848937988
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0300195  Vali Loss: 0.0362142 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829607  Vali macro F1 0.9758261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3286569118499756
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0319357  Vali Loss: 0.0461392 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772108  Vali macro F1 0.9681180 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3305847644805908
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0240711  Vali Loss: 0.0343686 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858480  Vali macro F1 0.9836870 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3341143131256104
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0202694  Vali Loss: 0.0337893 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832096  Vali macro F1 0.9772114 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 1.3344905376434326
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0171511  Vali Loss: 0.0355329 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887074  Vali macro F1 0.9907368 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 1.3324425220489502
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0165643  Vali Loss: 0.0276312 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887074  Vali macro F1 0.9907368 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3356366157531738
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0138262  Vali Loss: 0.0273578 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887074  Vali macro F1 0.9907368 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.330742597579956
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0126602  Vali Loss: 0.0202101 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
new best score!!!!
Validation loss decreased (0.026611 --> 0.020210).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.333444595336914
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0140907  Vali Loss: 0.0200331 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
new best score!!!!
Validation loss decreased (0.020210 --> 0.020033).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3310365676879883
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0143267  Vali Loss: 0.0214521 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.331425666809082
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0113592  Vali Loss: 0.0153663 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9980128 
new best score!!!!
Validation loss decreased (0.020033 --> 0.015366).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3385717868804932
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0133398  Vali Loss: 0.0181211 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.334263801574707
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0137535  Vali Loss: 0.0173713 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3343052864074707
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0128886  Vali Loss: 0.0195974 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.331824779510498
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0117657  Vali Loss: 0.0203178 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.3323867321014404
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0109429  Vali Loss: 0.0154175 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 1.3291001319885254
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0105017  Vali Loss: 0.0153884 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.3472425937652588
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0111139  Vali Loss: 0.0153226 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
new best score!!!!
Validation loss decreased (0.015366 --> 0.015323).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.3320660591125488
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0115550  Vali Loss: 0.0154052 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3318758010864258
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0113487  Vali Loss: 0.0155917 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.331498622894287
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0113921  Vali Loss: 0.0156217 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.329455852508545
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0113597  Vali Loss: 0.0157506 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.3314344882965088
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0112443  Vali Loss: 0.0158559 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 1.3305656909942627
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0105710  Vali Loss: 0.0158671 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3298401832580566
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0101546  Vali Loss: 0.0158683 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.3313992023468018
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0111559  Vali Loss: 0.0158654 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.3332624435424805
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0104168  Vali Loss: 0.0158626 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.331310510635376
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0113149  Vali Loss: 0.0158552 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 63 cost time: 1.3301899433135986
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0105952  Vali Loss: 0.0158553 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.329530954360962
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0107094  Vali Loss: 0.0158578 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.3298137187957764
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0096421  Vali Loss: 0.0158598 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.3307602405548096
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0121968  Vali Loss: 0.0158610 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.3317227363586426
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0113840  Vali Loss: 0.0158603 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920903  Test macro F1 0.9907185 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4911623001098633
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0120584  Vali Loss: 0.0160403 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943382  Vali macro F1 0.9950892 
Validation loss decreased (inf --> 0.016040).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4625053405761719
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0117592  Vali Loss: 0.0153717 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
new best score!!!!
Validation loss decreased (0.016040 --> 0.015372).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.4620084762573242
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0103837  Vali Loss: 0.0200700 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886859  Vali macro F1 0.9883379 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.459972620010376
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0098892  Vali Loss: 0.0281293 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858810  Vali macro F1 0.9859722 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.460709810256958
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0092213  Vali Loss: 0.0293019 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858810  Vali macro F1 0.9859722 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.4613099098205566
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0092392  Vali Loss: 0.0350813 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830449  Vali macro F1 0.9811913 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.462217092514038
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0099250  Vali Loss: 0.0351048 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858810  Vali macro F1 0.9859722 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.4619133472442627
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0087108  Vali Loss: 0.0257079 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9903727 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.461867332458496
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0092238  Vali Loss: 0.0190092 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886859  Vali macro F1 0.9883379 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.4619083404541016
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0077970  Vali Loss: 0.0243019 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886859  Vali macro F1 0.9883379 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.462592363357544
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0096214  Vali Loss: 0.0247783 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886859  Vali macro F1 0.9883379 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.4614779949188232
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0088410  Vali Loss: 0.0278529 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886756  Vali macro F1 0.9855437 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.4605152606964111
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0067459  Vali Loss: 0.0267628 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886756  Vali macro F1 0.9855437 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.4626998901367188
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0077210  Vali Loss: 0.0251943 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915117  Vali macro F1 0.9903246 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.4615530967712402
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0071662  Vali Loss: 0.0246968 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915117  Vali macro F1 0.9903246 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.4607908725738525
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0074981  Vali Loss: 0.0243661 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915117  Vali macro F1 0.9903246 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.4608941078186035
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0065307  Vali Loss: 0.0247953 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886859  Vali macro F1 0.9883379 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9875566  Test weighted F1: 0.9876126  Test macro F1 0.9872327 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00280112 0.00243902 0.00238095 0.00328947 0.00561798 0.00568182
 0.00304878 0.00282486 0.00238095 0.00420168]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.339883804321289
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1848025  Vali Loss: 1.7981830 Vali Accuracy: 0.3446328  Vali weighted F1: 0.2798473  Vali macro F1 0.2475148 
Validation loss decreased (inf --> 1.798183).  Saving model ...
Epoch: 2 cost time: 1.3336246013641357
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4473045  Vali Loss: 0.9724241 Vali Accuracy: 0.6638418  Vali weighted F1: 0.6382098  Vali macro F1 0.6047711 
new best score!!!!
Validation loss decreased (1.798183 --> 0.972424).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.333920955657959
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.9320327  Vali Loss: 0.6797137 Vali Accuracy: 0.7457627  Vali weighted F1: 0.7193675  Vali macro F1 0.6878670 
new best score!!!!
Validation loss decreased (0.972424 --> 0.679714).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.333129644393921
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6783032  Vali Loss: 0.5008846 Vali Accuracy: 0.8276836  Vali weighted F1: 0.8254313  Vali macro F1 0.7955094 
new best score!!!!
Validation loss decreased (0.679714 --> 0.500885).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3336474895477295
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.5201860  Vali Loss: 0.3914810 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8371840  Vali macro F1 0.7942051 
new best score!!!!
Validation loss decreased (0.500885 --> 0.391481).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3324241638183594
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.4091693  Vali Loss: 0.3066036 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8879560  Vali macro F1 0.8662894 
new best score!!!!
Validation loss decreased (0.391481 --> 0.306604).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3314461708068848
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.3346532  Vali Loss: 0.2682541 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8756666  Vali macro F1 0.8471234 
new best score!!!!
Validation loss decreased (0.306604 --> 0.268254).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3326737880706787
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2838208  Vali Loss: 0.2195800 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9034548  Vali macro F1 0.8724390 
new best score!!!!
Validation loss decreased (0.268254 --> 0.219580).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3325538635253906
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2401161  Vali Loss: 0.1995336 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8940030  Vali macro F1 0.8468693 
new best score!!!!
Validation loss decreased (0.219580 --> 0.199534).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.333122968673706
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2191852  Vali Loss: 0.1806350 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8922158  Vali macro F1 0.8425601 
new best score!!!!
Validation loss decreased (0.199534 --> 0.180635).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3367257118225098
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1893713  Vali Loss: 0.1549564 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9103636  Vali macro F1 0.8678640 
new best score!!!!
Validation loss decreased (0.180635 --> 0.154956).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3315825462341309
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1668058  Vali Loss: 0.1540002 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9280573  Vali macro F1 0.8971277 
new best score!!!!
Validation loss decreased (0.154956 --> 0.154000).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3324947357177734
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1476670  Vali Loss: 0.1318520 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9399873  Vali macro F1 0.9153925 
new best score!!!!
Validation loss decreased (0.154000 --> 0.131852).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.329775094985962
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1350315  Vali Loss: 0.1247551 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9373925  Vali macro F1 0.9064250 
new best score!!!!
Validation loss decreased (0.131852 --> 0.124755).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3309168815612793
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1247766  Vali Loss: 0.1061635 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9302692  Vali macro F1 0.8962681 
new best score!!!!
Validation loss decreased (0.124755 --> 0.106164).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.330683946609497
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1127747  Vali Loss: 0.1007265 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9423337  Vali macro F1 0.9095579 
new best score!!!!
Validation loss decreased (0.106164 --> 0.100727).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3324530124664307
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1114399  Vali Loss: 0.1439457 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9075382  Vali macro F1 0.8650857 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3317716121673584
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1150102  Vali Loss: 0.1057710 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9574222  Vali macro F1 0.9426320 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 1.3310930728912354
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1002552  Vali Loss: 0.1136407 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9499228  Vali macro F1 0.9293422 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 1.3328533172607422
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0976414  Vali Loss: 0.1097605 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9601910  Vali macro F1 0.9490381 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 1.3342671394348145
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0845489  Vali Loss: 0.0942966 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9570804  Vali macro F1 0.9437944 
new best score!!!!
Validation loss decreased (0.100727 --> 0.094297).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.334176778793335
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0741702  Vali Loss: 0.0757021 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746052  Vali macro F1 0.9689905 
new best score!!!!
Validation loss decreased (0.094297 --> 0.075702).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.336226224899292
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0601574  Vali Loss: 0.0460937 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
new best score!!!!
Validation loss decreased (0.075702 --> 0.046094).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.33919095993042
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0536285  Vali Loss: 0.0517332 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9860412  Vali macro F1 0.9858647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3361036777496338
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0435808  Vali Loss: 0.0518956 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9860412  Vali macro F1 0.9858647 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.3510017395019531
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0378217  Vali Loss: 0.0416648 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801409  Vali macro F1 0.9711984 
new best score!!!!
Validation loss decreased (0.046094 --> 0.041665).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3360233306884766
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0381794  Vali Loss: 0.0415513 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887379  Vali macro F1 0.9856718 
new best score!!!!
Validation loss decreased (0.041665 --> 0.041551).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3336162567138672
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0344459  Vali Loss: 0.0369222 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859210  Vali macro F1 0.9809234 
new best score!!!!
Validation loss decreased (0.041551 --> 0.036922).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.332089900970459
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0348695  Vali Loss: 0.0435619 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859046  Vali macro F1 0.9851651 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3343923091888428
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0351552  Vali Loss: 0.0297326 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915190  Vali macro F1 0.9880937 
new best score!!!!
Validation loss decreased (0.036922 --> 0.029733).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3350462913513184
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0259927  Vali Loss: 0.0373806 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829842  Vali macro F1 0.9784122 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3320035934448242
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0261579  Vali Loss: 0.0165594 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
new best score!!!!
Validation loss decreased (0.029733 --> 0.016559).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3328757286071777
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0275752  Vali Loss: 0.0195187 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971816  Vali macro F1 0.9976392 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3332006931304932
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0213028  Vali Loss: 0.0246101 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943744  Vali macro F1 0.9952991 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 1.334089756011963
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0235248  Vali Loss: 0.0199735 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943744  Vali macro F1 0.9952991 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 1.334179401397705
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0187355  Vali Loss: 0.0318012 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 1.3348379135131836
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0189979  Vali Loss: 0.0287300 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858373  Vali macro F1 0.9833943 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 1.3340072631835938
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0141896  Vali Loss: 0.0215646 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915087  Vali macro F1 0.9905340 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.3340513706207275
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0118338  Vali Loss: 0.0259266 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886734  Vali macro F1 0.9881751 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.333228349685669
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0127429  Vali Loss: 0.0228744 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886734  Vali macro F1 0.9881751 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 1.3369605541229248
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0117336  Vali Loss: 0.0222329 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 1.3341805934906006
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0109908  Vali Loss: 0.0206412 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 1.3358447551727295
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0125860  Vali Loss: 0.0206005 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3331127166748047
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0127168  Vali Loss: 0.0201658 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.3343861103057861
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0109167  Vali Loss: 0.0193496 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 1.3354065418243408
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0111409  Vali Loss: 0.0195640 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 1.3353660106658936
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0102179  Vali Loss: 0.0209307 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9875566  Test weighted F1: 0.9875726  Test macro F1 0.9874367 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4657068252563477
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0204506  Vali Loss: 0.0322774 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915740  Vali macro F1 0.9904526 
Validation loss decreased (inf --> 0.032277).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4665117263793945
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0170463  Vali Loss: 0.0255501 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
new best score!!!!
Validation loss decreased (0.032277 --> 0.025550).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.466034173965454
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0182320  Vali Loss: 0.0204569 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
new best score!!!!
Validation loss decreased (0.025550 --> 0.020457).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4664463996887207
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0163641  Vali Loss: 0.0216128 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.4654507637023926
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0143999  Vali Loss: 0.0238390 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.4672980308532715
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0132345  Vali Loss: 0.0231016 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.4651052951812744
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0126935  Vali Loss: 0.0148582 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
new best score!!!!
Validation loss decreased (0.020457 --> 0.014858).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.466536283493042
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0162373  Vali Loss: 0.0258222 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.4662082195281982
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0125676  Vali Loss: 0.0191322 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.4666345119476318
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0129202  Vali Loss: 0.0225726 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.4671986103057861
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0105379  Vali Loss: 0.0221209 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.466263771057129
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0099443  Vali Loss: 0.0238405 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 1.4656076431274414
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0112294  Vali Loss: 0.0189593 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.4660015106201172
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0112480  Vali Loss: 0.0193801 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.4650802612304688
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0123698  Vali Loss: 0.0163796 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.465242624282837
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0104842  Vali Loss: 0.0178794 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.4674010276794434
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0095839  Vali Loss: 0.0222050 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 1.466052532196045
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0104048  Vali Loss: 0.0218237 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.4659438133239746
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0100315  Vali Loss: 0.0204302 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.465144395828247
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0094533  Vali Loss: 0.0191548 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.4669721126556396
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0085728  Vali Loss: 0.0192162 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.4664881229400635
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0091836  Vali Loss: 0.0195581 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898210  Test macro F1 0.9882428 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00276243 0.00239234 0.00246305 0.00330033 0.00595238 0.00574713
 0.00308642 0.00291545 0.00232019 0.00390625]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3323705196380615
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1937733  Vali Loss: 1.8307991 Vali Accuracy: 0.3615819  Vali weighted F1: 0.2886873  Vali macro F1 0.2541038 
Validation loss decreased (inf --> 1.830799).  Saving model ...
Epoch: 2 cost time: 1.3317723274230957
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4817463  Vali Loss: 0.9651463 Vali Accuracy: 0.7090395  Vali weighted F1: 0.6841198  Vali macro F1 0.6460999 
new best score!!!!
Validation loss decreased (1.830799 --> 0.965146).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3325181007385254
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.9237204  Vali Loss: 0.6632222 Vali Accuracy: 0.7485876  Vali weighted F1: 0.7481513  Vali macro F1 0.7368100 
new best score!!!!
Validation loss decreased (0.965146 --> 0.663222).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.332646131515503
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6543035  Vali Loss: 0.4875842 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8342763  Vali macro F1 0.8134067 
new best score!!!!
Validation loss decreased (0.663222 --> 0.487584).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.331895351409912
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4971470  Vali Loss: 0.3710442 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8611476  Vali macro F1 0.8363068 
new best score!!!!
Validation loss decreased (0.487584 --> 0.371044).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3301682472229004
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3845074  Vali Loss: 0.3218488 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8634015  Vali macro F1 0.8263314 
new best score!!!!
Validation loss decreased (0.371044 --> 0.321849).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3304402828216553
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.3177235  Vali Loss: 0.2583897 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9023162  Vali macro F1 0.8771531 
new best score!!!!
Validation loss decreased (0.321849 --> 0.258390).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.330270528793335
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2709830  Vali Loss: 0.2154586 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9160384  Vali macro F1 0.8842089 
new best score!!!!
Validation loss decreased (0.258390 --> 0.215459).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3297410011291504
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2360575  Vali Loss: 0.1917450 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9261115  Vali macro F1 0.8972589 
new best score!!!!
Validation loss decreased (0.215459 --> 0.191745).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3299403190612793
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2073470  Vali Loss: 0.1721247 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9322715  Vali macro F1 0.9031977 
new best score!!!!
Validation loss decreased (0.191745 --> 0.172125).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3335886001586914
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1906150  Vali Loss: 0.1775404 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9143132  Vali macro F1 0.8791408 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.3301746845245361
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1749614  Vali Loss: 0.1339034 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9264460  Vali macro F1 0.8876506 
new best score!!!!
Validation loss decreased (0.172125 --> 0.133903).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3347461223602295
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1492074  Vali Loss: 0.1225006 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9485307  Vali macro F1 0.9198554 
new best score!!!!
Validation loss decreased (0.133903 --> 0.122501).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3309307098388672
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1300274  Vali Loss: 0.1357232 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9441074  Vali macro F1 0.9236859 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3467061519622803
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1139714  Vali Loss: 0.1030055 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9423159  Vali macro F1 0.9178386 
new best score!!!!
Validation loss decreased (0.122501 --> 0.103005).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.330280065536499
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1075805  Vali Loss: 0.0899058 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9680622  Vali macro F1 0.9536139 
new best score!!!!
Validation loss decreased (0.103005 --> 0.089906).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3318800926208496
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0992214  Vali Loss: 0.1155352 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9342007  Vali macro F1 0.9094571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3285508155822754
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0848955  Vali Loss: 0.0772880 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717662  Vali macro F1 0.9598037 
new best score!!!!
Validation loss decreased (0.089906 --> 0.077288).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3318290710449219
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0741916  Vali Loss: 0.0761581 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9683870  Vali macro F1 0.9560919 
new best score!!!!
Validation loss decreased (0.077288 --> 0.076158).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3318734169006348
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0718827  Vali Loss: 0.0641995 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9740182  Vali macro F1 0.9612364 
new best score!!!!
Validation loss decreased (0.076158 --> 0.064199).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3329417705535889
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0626363  Vali Loss: 0.0797976 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660637  Vali macro F1 0.9619423 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.3312609195709229
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0541781  Vali Loss: 0.0517937 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858703  Vali macro F1 0.9831189 
new best score!!!!
Validation loss decreased (0.064199 --> 0.051794).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3327667713165283
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0493176  Vali Loss: 0.0560542 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773338  Vali macro F1 0.9736477 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3321402072906494
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0467032  Vali Loss: 0.0527048 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858999  Vali macro F1 0.9854621 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.3303115367889404
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0475151  Vali Loss: 0.0536861 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800298  Vali macro F1 0.9713703 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 1.3301763534545898
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0398534  Vali Loss: 0.0557669 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774285  Vali macro F1 0.9712386 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 1.3311519622802734
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0315883  Vali Loss: 0.0363205 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887010  Vali macro F1 0.9855026 
new best score!!!!
Validation loss decreased (0.051794 --> 0.036321).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.332611322402954
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0332429  Vali Loss: 0.0583496 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745106  Vali macro F1 0.9670324 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3306806087493896
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0340245  Vali Loss: 0.0303401 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
new best score!!!!
Validation loss decreased (0.036321 --> 0.030340).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3319652080535889
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0284576  Vali Loss: 0.0352613 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915371  Vali macro F1 0.9902835 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3365273475646973
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0266860  Vali Loss: 0.0431665 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743439  Vali macro F1 0.9686553 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3356711864471436
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0235919  Vali Loss: 0.0294414 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915209  Vali macro F1 0.9879637 
new best score!!!!
Validation loss decreased (0.030340 --> 0.029441).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3355777263641357
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0183999  Vali Loss: 0.0360808 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858493  Vali macro F1 0.9835979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3332881927490234
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0307270  Vali Loss: 0.0252912 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915209  Vali macro F1 0.9879637 
new best score!!!!
Validation loss decreased (0.029441 --> 0.025291).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3333337306976318
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0213539  Vali Loss: 0.0198720 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943570  Vali macro F1 0.9927446 
new best score!!!!
Validation loss decreased (0.025291 --> 0.019872).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3322901725769043
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0185448  Vali Loss: 0.0176476 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943570  Vali macro F1 0.9927446 
new best score!!!!
Validation loss decreased (0.019872 --> 0.017648).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3324470520019531
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0201111  Vali Loss: 0.0323057 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886745  Vali macro F1 0.9856231 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3315412998199463
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0173962  Vali Loss: 0.0295118 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886966  Vali macro F1 0.9851060 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.3309752941131592
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0124831  Vali Loss: 0.0266356 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.332815408706665
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0145071  Vali Loss: 0.0211386 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915209  Vali macro F1 0.9879637 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 1.333631992340088
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0162440  Vali Loss: 0.0134613 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.017648 --> 0.013461).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3337764739990234
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0136420  Vali Loss: 0.0347564 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3399004936218262
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0182935  Vali Loss: 0.0452722 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830126  Vali macro F1 0.9821027 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3330738544464111
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0173631  Vali Loss: 0.0401444 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886929  Vali macro F1 0.9876883 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.3478176593780518
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0146553  Vali Loss: 0.0297073 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886630  Vali macro F1 0.9833188 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 1.3334441184997559
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0155964  Vali Loss: 0.0336994 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 1.3365976810455322
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0108509  Vali Loss: 0.0207860 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3349270820617676
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0082445  Vali Loss: 0.0162703 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.3343544006347656
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0069897  Vali Loss: 0.0174301 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.3334205150604248
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0074664  Vali Loss: 0.0194185 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.3350129127502441
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0066642  Vali Loss: 0.0205785 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 1.3347599506378174
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0060590  Vali Loss: 0.0204947 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.3331003189086914
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0073321  Vali Loss: 0.0202262 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.3329548835754395
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0071757  Vali Loss: 0.0199597 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 1.3340444564819336
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0062496  Vali Loss: 0.0196916 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 1.3332219123840332
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0065077  Vali Loss: 0.0194702 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886855  Test macro F1 0.9881823 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4736969470977783
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0104535  Vali Loss: 0.0159688 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
Validation loss decreased (inf --> 0.015969).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4725708961486816
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0086883  Vali Loss: 0.0197799 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4749436378479004
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0069728  Vali Loss: 0.0220855 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4727890491485596
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0072359  Vali Loss: 0.0207537 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.47654128074646
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0068564  Vali Loss: 0.0199462 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.4742209911346436
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0081916  Vali Loss: 0.0222538 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.47444748878479
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0066176  Vali Loss: 0.0166605 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4744129180908203
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0059467  Vali Loss: 0.0244448 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.4736030101776123
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0060013  Vali Loss: 0.0115943 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943571  Vali macro F1 0.9955221 
new best score!!!!
Validation loss decreased (0.015969 --> 0.011594).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.473036527633667
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0056260  Vali Loss: 0.0135270 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.4760596752166748
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0056676  Vali Loss: 0.0180083 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915307  Vali macro F1 0.9907575 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.4745440483093262
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0048636  Vali Loss: 0.0165517 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 1.474193811416626
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0043306  Vali Loss: 0.0234254 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 1.4740626811981201
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0043304  Vali Loss: 0.0211393 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 1.4745161533355713
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0047143  Vali Loss: 0.0208262 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.4768657684326172
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0038897  Vali Loss: 0.0208624 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.4753475189208984
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0047144  Vali Loss: 0.0216167 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.4802236557006836
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0040774  Vali Loss: 0.0219622 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 1.4769525527954102
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0061014  Vali Loss: 0.0188106 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 1.4747827053070068
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0040713  Vali Loss: 0.0190137 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.475248098373413
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0051469  Vali Loss: 0.0193372 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 1.4749586582183838
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0042599  Vali Loss: 0.0194916 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 1.4760756492614746
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0044972  Vali Loss: 0.0195613 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 1.4735634326934814
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0043734  Vali Loss: 0.0197027 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920979  Test macro F1 0.9899570 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00280899 0.00242718 0.00236967 0.00330033 0.00574713 0.00581395
 0.00315457 0.00280112 0.002331   0.00411523]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3348026275634766
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2017045  Vali Loss: 1.8857668 Vali Accuracy: 0.3192090  Vali weighted F1: 0.2510964  Vali macro F1 0.2107351 
Validation loss decreased (inf --> 1.885767).  Saving model ...
Epoch: 2 cost time: 1.331113338470459
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.5184347  Vali Loss: 0.9803095 Vali Accuracy: 0.6751412  Vali weighted F1: 0.6684355  Vali macro F1 0.6453776 
new best score!!!!
Validation loss decreased (1.885767 --> 0.980309).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.332512378692627
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.9469800  Vali Loss: 0.6802061 Vali Accuracy: 0.7485876  Vali weighted F1: 0.7240096  Vali macro F1 0.6876976 
new best score!!!!
Validation loss decreased (0.980309 --> 0.680206).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3314294815063477
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6646588  Vali Loss: 0.5017363 Vali Accuracy: 0.8276836  Vali weighted F1: 0.8228391  Vali macro F1 0.8041594 
new best score!!!!
Validation loss decreased (0.680206 --> 0.501736).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3323829174041748
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.5061080  Vali Loss: 0.3706407 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8686101  Vali macro F1 0.8417742 
new best score!!!!
Validation loss decreased (0.501736 --> 0.370641).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3345232009887695
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3872176  Vali Loss: 0.2891015 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8668495  Vali macro F1 0.8292761 
new best score!!!!
Validation loss decreased (0.370641 --> 0.289102).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3349051475524902
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.3200213  Vali Loss: 0.2676368 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8708757  Vali macro F1 0.8370294 
new best score!!!!
Validation loss decreased (0.289102 --> 0.267637).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3343379497528076
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2643963  Vali Loss: 0.1937651 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9301581  Vali macro F1 0.8959851 
new best score!!!!
Validation loss decreased (0.267637 --> 0.193765).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3339521884918213
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2232267  Vali Loss: 0.1700605 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9375701  Vali macro F1 0.9105425 
new best score!!!!
Validation loss decreased (0.193765 --> 0.170060).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3336234092712402
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1938623  Vali Loss: 0.1510109 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9158992  Vali macro F1 0.8764708 
new best score!!!!
Validation loss decreased (0.170060 --> 0.151011).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.332409381866455
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1748933  Vali Loss: 0.1523687 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9348308  Vali macro F1 0.9061636 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.3319783210754395
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1527010  Vali Loss: 0.1219821 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9486657  Vali macro F1 0.9242562 
new best score!!!!
Validation loss decreased (0.151011 --> 0.121982).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3337876796722412
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1355472  Vali Loss: 0.1054213 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9518730  Vali macro F1 0.9256227 
new best score!!!!
Validation loss decreased (0.121982 --> 0.105421).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3863909244537354
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1273176  Vali Loss: 0.1313937 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9272194  Vali macro F1 0.9009809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.4086551666259766
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1175746  Vali Loss: 0.1077086 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9240281  Vali macro F1 0.8794763 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 1.4111428260803223
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1065682  Vali Loss: 0.1107061 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9386912  Vali macro F1 0.9093192 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 1.4170944690704346
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1115026  Vali Loss: 0.1030991 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9441936  Vali macro F1 0.9154542 
new best score!!!!
Validation loss decreased (0.105421 --> 0.103099).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.409381628036499
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0966025  Vali Loss: 0.1017685 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9474933  Vali macro F1 0.9166144 
new best score!!!!
Validation loss decreased (0.103099 --> 0.101769).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.4092423915863037
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0910578  Vali Loss: 0.0917557 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9464572  Vali macro F1 0.9185905 
new best score!!!!
Validation loss decreased (0.101769 --> 0.091756).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.4187383651733398
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0758759  Vali Loss: 0.0856676 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9581680  Vali macro F1 0.9366352 
new best score!!!!
Validation loss decreased (0.091756 --> 0.085668).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.412268877029419
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0732525  Vali Loss: 0.0710011 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714202  Vali macro F1 0.9603718 
new best score!!!!
Validation loss decreased (0.085668 --> 0.071001).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.4279146194458008
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0694784  Vali Loss: 0.0681647 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715015  Vali macro F1 0.9641187 
new best score!!!!
Validation loss decreased (0.071001 --> 0.068165).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.4115347862243652
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0576326  Vali Loss: 0.0619078 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830570  Vali macro F1 0.9780799 
new best score!!!!
Validation loss decreased (0.068165 --> 0.061908).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.4133224487304688
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0521641  Vali Loss: 0.0652540 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772800  Vali macro F1 0.9678603 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.4136157035827637
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0510312  Vali Loss: 0.0450944 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886928  Vali macro F1 0.9861067 
new best score!!!!
Validation loss decreased (0.061908 --> 0.045094).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.4118804931640625
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0471445  Vali Loss: 0.0517292 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885405  Vali macro F1 0.9848578 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.3637676239013672
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0329255  Vali Loss: 0.0387235 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886855  Vali macro F1 0.9856890 
new best score!!!!
Validation loss decreased (0.045094 --> 0.038724).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3362817764282227
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0277662  Vali Loss: 0.0407763 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858697  Vali macro F1 0.9829291 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3343398571014404
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0252941  Vali Loss: 0.0362065 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886855  Vali macro F1 0.9856890 
new best score!!!!
Validation loss decreased (0.038724 --> 0.036206).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3381237983703613
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0331102  Vali Loss: 0.0500674 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829524  Vali macro F1 0.9764302 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3360867500305176
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0293406  Vali Loss: 0.0498264 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774117  Vali macro F1 0.9734248 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3387658596038818
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0345145  Vali Loss: 0.0400826 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858378  Vali macro F1 0.9812523 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.3400845527648926
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0314635  Vali Loss: 0.0625072 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688091  Vali macro F1 0.9642292 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 1.3421881198883057
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0235948  Vali Loss: 0.0354734 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858673  Vali macro F1 0.9833284 
new best score!!!!
Validation loss decreased (0.036206 --> 0.035473).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3332736492156982
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0167939  Vali Loss: 0.0272615 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915238  Vali macro F1 0.9884890 
new best score!!!!
Validation loss decreased (0.035473 --> 0.027261).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3386719226837158
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0140468  Vali Loss: 0.0286622 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915283  Vali macro F1 0.9909261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.333115816116333
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0112037  Vali Loss: 0.0287326 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887050  Vali macro F1 0.9861669 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3326139450073242
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0136106  Vali Loss: 0.0235184 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
new best score!!!!
Validation loss decreased (0.027261 --> 0.023518).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.335097074508667
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0130809  Vali Loss: 0.0585565 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829530  Vali macro F1 0.9763893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3405394554138184
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0191980  Vali Loss: 0.0198231 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915294  Vali macro F1 0.9908467 
new best score!!!!
Validation loss decreased (0.023518 --> 0.019823).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3350942134857178
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0159998  Vali Loss: 0.0213184 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915319  Vali macro F1 0.9881154 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.336038589477539
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0151994  Vali Loss: 0.0358711 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886953  Vali macro F1 0.9851188 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3338649272918701
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0118430  Vali Loss: 0.0188427 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915283  Vali macro F1 0.9909261 
new best score!!!!
Validation loss decreased (0.019823 --> 0.018843).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3357696533203125
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0120954  Vali Loss: 0.0160060 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915044  Vali macro F1 0.9936897 
new best score!!!!
Validation loss decreased (0.018843 --> 0.016006).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3351633548736572
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0117272  Vali Loss: 0.0269821 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887220  Vali macro F1 0.9885166 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3368537425994873
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0074033  Vali Loss: 0.0533152 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828974  Vali macro F1 0.9797191 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.3336660861968994
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0070705  Vali Loss: 0.0274744 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915283  Vali macro F1 0.9909261 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.3362257480621338
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0093296  Vali Loss: 0.0239662 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915294  Vali macro F1 0.9908467 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 1.3344471454620361
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0072574  Vali Loss: 0.0249910 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915283  Vali macro F1 0.9909261 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 50 cost time: 1.3384616374969482
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0068960  Vali Loss: 0.0257775 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.3310959339141846
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0057142  Vali Loss: 0.0250663 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.3460917472839355
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0054286  Vali Loss: 0.0263265 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.3337106704711914
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0054261  Vali Loss: 0.0245444 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 1.3339550495147705
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0053212  Vali Loss: 0.0228958 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 55 cost time: 1.3356618881225586
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0048691  Vali Loss: 0.0228523 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.3358633518218994
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0051068  Vali Loss: 0.0228430 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.3338463306427002
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0047936  Vali Loss: 0.0229394 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.3344001770019531
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0049978  Vali Loss: 0.0229735 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.3340308666229248
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0046336  Vali Loss: 0.0229632 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9946565 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9852730  Test macro F1 0.9825481 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4708325862884521
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0094131  Vali Loss: 0.0159282 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915238  Vali macro F1 0.9912653 
Validation loss decreased (inf --> 0.015928).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4729604721069336
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0071567  Vali Loss: 0.0201927 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4698669910430908
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0064400  Vali Loss: 0.0208616 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4706065654754639
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0068266  Vali Loss: 0.0315438 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.470679759979248
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0055238  Vali Loss: 0.0245577 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.4725816249847412
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0051459  Vali Loss: 0.0250328 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4725148677825928
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0056380  Vali Loss: 0.0206151 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4741954803466797
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0050898  Vali Loss: 0.0206578 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.4710683822631836
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0039810  Vali Loss: 0.0195703 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4718475341796875
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0046771  Vali Loss: 0.0340928 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.4697260856628418
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0050910  Vali Loss: 0.0307424 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.470984697341919
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0048204  Vali Loss: 0.0241019 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4736456871032715
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0043248  Vali Loss: 0.0218399 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.4705140590667725
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0043956  Vali Loss: 0.0224291 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4718122482299805
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0040918  Vali Loss: 0.0232083 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.471806526184082
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0040162  Vali Loss: 0.0230754 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886753  Test macro F1 0.9885619 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00275482 0.00243902 0.00239808 0.00322581 0.00564972 0.00588235
 0.00319489 0.00285714 0.00235294 0.00404858]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3352742195129395
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2004435  Vali Loss: 1.8523907 Vali Accuracy: 0.3954802  Vali weighted F1: 0.3038757  Vali macro F1 0.2639536 
Validation loss decreased (inf --> 1.852391).  Saving model ...
Epoch: 2 cost time: 1.3356163501739502
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.5027242  Vali Loss: 1.0255546 Vali Accuracy: 0.6864407  Vali weighted F1: 0.6816030  Vali macro F1 0.6382110 
new best score!!!!
Validation loss decreased (1.852391 --> 1.025555).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3396821022033691
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.9469395  Vali Loss: 0.6411071 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8275513  Vali macro F1 0.7600002 
new best score!!!!
Validation loss decreased (1.025555 --> 0.641107).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3323752880096436
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6709703  Vali Loss: 0.4733457 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8688677  Vali macro F1 0.8115869 
new best score!!!!
Validation loss decreased (0.641107 --> 0.473346).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3494970798492432
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4948940  Vali Loss: 0.3634440 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8627664  Vali macro F1 0.7990874 
new best score!!!!
Validation loss decreased (0.473346 --> 0.363444).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3338587284088135
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3936809  Vali Loss: 0.2853386 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9069148  Vali macro F1 0.8497036 
new best score!!!!
Validation loss decreased (0.363444 --> 0.285339).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.334463119506836
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.3185770  Vali Loss: 0.2333639 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9180579  Vali macro F1 0.8669348 
new best score!!!!
Validation loss decreased (0.285339 --> 0.233364).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3347370624542236
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2669231  Vali Loss: 0.1888735 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9350495  Vali macro F1 0.8791388 
new best score!!!!
Validation loss decreased (0.233364 --> 0.188873).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.335331678390503
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2238914  Vali Loss: 0.1682248 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9315420  Vali macro F1 0.8798360 
new best score!!!!
Validation loss decreased (0.188873 --> 0.168225).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3349242210388184
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1999326  Vali Loss: 0.1458289 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9051527  Vali macro F1 0.8354877 
new best score!!!!
Validation loss decreased (0.168225 --> 0.145829).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3404359817504883
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1734776  Vali Loss: 0.1566489 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9309265  Vali macro F1 0.8669049 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.334301233291626
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1541699  Vali Loss: 0.1214880 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9391943  Vali macro F1 0.8898019 
new best score!!!!
Validation loss decreased (0.145829 --> 0.121488).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3359112739562988
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1401995  Vali Loss: 0.1151836 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9403055  Vali macro F1 0.8763464 
new best score!!!!
Validation loss decreased (0.121488 --> 0.115184).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3356173038482666
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1245167  Vali Loss: 0.1184884 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9151182  Vali macro F1 0.8466720 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3339531421661377
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1133393  Vali Loss: 0.0827339 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9487149  Vali macro F1 0.8921318 
new best score!!!!
Validation loss decreased (0.115184 --> 0.082734).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3355190753936768
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1064912  Vali Loss: 0.0991264 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9459253  Vali macro F1 0.9018871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.334299087524414
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1078850  Vali Loss: 0.0793325 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604427  Vali macro F1 0.9255662 
new best score!!!!
Validation loss decreased (0.082734 --> 0.079333).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.334214210510254
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0952332  Vali Loss: 0.0699401 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9576884  Vali macro F1 0.9132694 
new best score!!!!
Validation loss decreased (0.079333 --> 0.069940).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.332836389541626
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0946364  Vali Loss: 0.0844426 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9610307  Vali macro F1 0.9239029 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.332664966583252
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0786376  Vali Loss: 0.0700180 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9637384  Vali macro F1 0.9311218 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.3358666896820068
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0762673  Vali Loss: 0.0553034 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9691691  Vali macro F1 0.9291707 
new best score!!!!
Validation loss decreased (0.069940 --> 0.055303).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.335033655166626
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0607581  Vali Loss: 0.0466203 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717472  Vali macro F1 0.9420248 
new best score!!!!
Validation loss decreased (0.055303 --> 0.046620).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3341035842895508
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0576893  Vali Loss: 0.0530479 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9720889  Vali macro F1 0.9473062 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3340950012207031
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0498927  Vali Loss: 0.0430500 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774097  Vali macro F1 0.9554589 
new best score!!!!
Validation loss decreased (0.046620 --> 0.043050).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3348534107208252
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0584099  Vali Loss: 0.0619321 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9635539  Vali macro F1 0.9342059 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3343956470489502
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0472427  Vali Loss: 0.0377811 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803448  Vali macro F1 0.9625495 
new best score!!!!
Validation loss decreased (0.043050 --> 0.037781).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3333301544189453
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0381581  Vali Loss: 0.0461017 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9748485  Vali macro F1 0.9548577 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3295977115631104
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0355314  Vali Loss: 0.0262188 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9883822  Vali macro F1 0.9768956 
new best score!!!!
Validation loss decreased (0.037781 --> 0.026219).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3329904079437256
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0319761  Vali Loss: 0.0325322 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776333  Vali macro F1 0.9608939 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3311009407043457
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0287689  Vali Loss: 0.0303037 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859163  Vali macro F1 0.9827555 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.3310115337371826
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0257000  Vali Loss: 0.0416362 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9855614  Vali macro F1 0.9737923 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 1.331160545349121
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0349929  Vali Loss: 0.0419343 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9748856  Vali macro F1 0.9550149 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 1.3371527194976807
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0405124  Vali Loss: 0.0323362 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886497  Vali macro F1 0.9811325 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 1.3318870067596436
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0271406  Vali Loss: 0.0215220 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943239  Vali macro F1 0.9900932 
new best score!!!!
Validation loss decreased (0.026219 --> 0.021522).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3428497314453125
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0226802  Vali Loss: 0.0194269 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.021522 --> 0.019427).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3358447551727295
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0196138  Vali Loss: 0.0175799 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.019427 --> 0.017580).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3342242240905762
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0173412  Vali Loss: 0.0160856 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.017580 --> 0.016086).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3336913585662842
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0171963  Vali Loss: 0.0160352 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.016086 --> 0.016035).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3311865329742432
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0159003  Vali Loss: 0.0154796 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.016035 --> 0.015480).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3339357376098633
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0177973  Vali Loss: 0.0145765 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.015480 --> 0.014577).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3338794708251953
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0158156  Vali Loss: 0.0161628 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.334486484527588
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0148167  Vali Loss: 0.0152727 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3400452136993408
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0155001  Vali Loss: 0.0149005 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3351423740386963
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0148710  Vali Loss: 0.0139051 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.014577 --> 0.013905).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.337813138961792
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0140129  Vali Loss: 0.0138804 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.013905 --> 0.013880).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3354382514953613
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0159634  Vali Loss: 0.0138292 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.013880 --> 0.013829).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3345038890838623
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0140418  Vali Loss: 0.0143228 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3334643840789795
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0130051  Vali Loss: 0.0158068 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.3328475952148438
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0140502  Vali Loss: 0.0148486 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.3338713645935059
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0137380  Vali Loss: 0.0149332 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.3328683376312256
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0116252  Vali Loss: 0.0137575 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.013829 --> 0.013758).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.338212013244629
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0136629  Vali Loss: 0.0153209 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.335141897201538
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0128340  Vali Loss: 0.0136734 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.013758 --> 0.013673).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.3354308605194092
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0144268  Vali Loss: 0.0135871 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.013673 --> 0.013587).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.3338277339935303
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0119593  Vali Loss: 0.0144216 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.333716630935669
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0126974  Vali Loss: 0.0158946 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.3345370292663574
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0122567  Vali Loss: 0.0164484 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.333282232284546
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0119497  Vali Loss: 0.0137485 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.334740161895752
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0121266  Vali Loss: 0.0134173 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.013587 --> 0.013417).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.3348352909088135
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0132306  Vali Loss: 0.0126423 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.013417 --> 0.012642).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.3338992595672607
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0134395  Vali Loss: 0.0139778 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 1.3326234817504883
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0108821  Vali Loss: 0.0138232 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 1.3354227542877197
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0109946  Vali Loss: 0.0134418 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 1.3370118141174316
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0114025  Vali Loss: 0.0133123 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 1.3357419967651367
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0119919  Vali Loss: 0.0130895 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 66 cost time: 1.350447177886963
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0109877  Vali Loss: 0.0130461 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.3337335586547852
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0105874  Vali Loss: 0.0131843 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 1.3369333744049072
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0106594  Vali Loss: 0.0133716 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 1.335021734237671
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0127080  Vali Loss: 0.0134949 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 1.3374035358428955
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0108397  Vali Loss: 0.0134774 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 71 cost time: 1.3370976448059082
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0115275  Vali Loss: 0.0134900 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.3341073989868164
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0121560  Vali Loss: 0.0134948 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.334702730178833
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0132974  Vali Loss: 0.0134945 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.3366589546203613
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0116774  Vali Loss: 0.0134889 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 1.336303949356079
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0112096  Vali Loss: 0.0134750 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9943630  Test weighted F1: 0.9943646  Test macro F1 0.9936058 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4596943855285645
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0131762  Vali Loss: 0.0182818 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886722  Vali macro F1 0.9855804 
Validation loss decreased (inf --> 0.018282).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.458625078201294
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0117391  Vali Loss: 0.0171617 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915054  Vali macro F1 0.9880712 
new best score!!!!
Validation loss decreased (0.018282 --> 0.017162).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.4592430591583252
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0120549  Vali Loss: 0.0139928 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.017162 --> 0.013993).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.458632230758667
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0106982  Vali Loss: 0.0144856 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.4577364921569824
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0112385  Vali Loss: 0.0145459 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.4574041366577148
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0130291  Vali Loss: 0.0153311 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915054  Vali macro F1 0.9880712 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.4580013751983643
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0122199  Vali Loss: 0.0176667 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915054  Vali macro F1 0.9880712 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.4577326774597168
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0100781  Vali Loss: 0.0144314 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915054  Vali macro F1 0.9880712 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.4579901695251465
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0119034  Vali Loss: 0.0129892 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914959  Vali macro F1 0.9880503 
new best score!!!!
Validation loss decreased (0.013993 --> 0.012989).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.458533525466919
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0106719  Vali Loss: 0.0113658 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.012989 --> 0.011366).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.45912766456604
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0086807  Vali Loss: 0.0130835 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915054  Vali macro F1 0.9880712 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4577147960662842
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0092545  Vali Loss: 0.0113261 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.011366 --> 0.011326).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.4576935768127441
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0090421  Vali Loss: 0.0100367 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.011326 --> 0.010037).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.4583911895751953
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0090510  Vali Loss: 0.0105094 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.458223819732666
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0089270  Vali Loss: 0.0103169 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.4561779499053955
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0092016  Vali Loss: 0.0098361 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.010037 --> 0.009836).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.4569063186645508
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0084399  Vali Loss: 0.0100964 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.4577414989471436
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0078153  Vali Loss: 0.0111745 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.4569904804229736
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0102305  Vali Loss: 0.0108738 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.4579052925109863
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0079641  Vali Loss: 0.0099487 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.4583392143249512
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0084812  Vali Loss: 0.0118740 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943166  Vali macro F1 0.9911599 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 1.4586260318756104
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0084386  Vali Loss: 0.0111036 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943166  Vali macro F1 0.9911599 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.4581608772277832
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0086896  Vali Loss: 0.0103449 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 1.4555940628051758
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0071783  Vali Loss: 0.0105316 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 1.4576513767242432
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0066988  Vali Loss: 0.0104737 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 1.4583179950714111
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0076767  Vali Loss: 0.0103369 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 1.4575929641723633
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0101476  Vali Loss: 0.0103402 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 1.4569547176361084
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0071070  Vali Loss: 0.0103217 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 1.4574782848358154
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0061899  Vali Loss: 0.0103087 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 1.455369234085083
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0075481  Vali Loss: 0.0102738 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 1.4567744731903076
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0074733  Vali Loss: 0.0102444 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9921082  Test weighted F1: 0.9920863  Test macro F1 0.9914476 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 636195
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.002849   0.00238663 0.00242718 0.00324675 0.00552486 0.00552486
 0.00308642 0.00288184 0.00236407 0.0041841 ]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.396981954574585
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1869864  Vali Loss: 1.7926529 Vali Accuracy: 0.3502825  Vali weighted F1: 0.2449286  Vali macro F1 0.1984582 
Validation loss decreased (inf --> 1.792653).  Saving model ...
Epoch: 2 cost time: 1.3382062911987305
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.3922036  Vali Loss: 0.8486677 Vali Accuracy: 0.6892655  Vali weighted F1: 0.6766202  Vali macro F1 0.6374708 
new best score!!!!
Validation loss decreased (1.792653 --> 0.848668).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3403987884521484
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8344144  Vali Loss: 0.5699180 Vali Accuracy: 0.7937853  Vali weighted F1: 0.7724112  Vali macro F1 0.7234009 
new best score!!!!
Validation loss decreased (0.848668 --> 0.569918).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3397276401519775
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5702648  Vali Loss: 0.3735959 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8503404  Vali macro F1 0.7915071 
new best score!!!!
Validation loss decreased (0.569918 --> 0.373596).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3391788005828857
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4207047  Vali Loss: 0.2758104 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8881854  Vali macro F1 0.8444946 
new best score!!!!
Validation loss decreased (0.373596 --> 0.275810).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3408334255218506
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3317892  Vali Loss: 0.2271032 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9134282  Vali macro F1 0.8751755 
new best score!!!!
Validation loss decreased (0.275810 --> 0.227103).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3383283615112305
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2670238  Vali Loss: 0.2090335 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9001210  Vali macro F1 0.8521009 
new best score!!!!
Validation loss decreased (0.227103 --> 0.209034).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3382909297943115
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2357081  Vali Loss: 0.1446299 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9348103  Vali macro F1 0.8808953 
new best score!!!!
Validation loss decreased (0.209034 --> 0.144630).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3386573791503906
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1996405  Vali Loss: 0.1511731 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9158661  Vali macro F1 0.8600097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 1.3395800590515137
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1767087  Vali Loss: 0.1200138 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9432702  Vali macro F1 0.8938446 
new best score!!!!
Validation loss decreased (0.144630 --> 0.120014).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.339005470275879
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1546422  Vali Loss: 0.1039357 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9326500  Vali macro F1 0.8743775 
new best score!!!!
Validation loss decreased (0.120014 --> 0.103936).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3385016918182373
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1406817  Vali Loss: 0.1049087 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9345757  Vali macro F1 0.8615414 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3403587341308594
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1388134  Vali Loss: 0.1052859 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9506261  Vali macro F1 0.9088499 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 1.3450076580047607
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1245678  Vali Loss: 0.0831818 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9543568  Vali macro F1 0.9060932 
new best score!!!!
Validation loss decreased (0.103936 --> 0.083182).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3378283977508545
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1139023  Vali Loss: 0.0912833 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9404779  Vali macro F1 0.8859757 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3559236526489258
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1088840  Vali Loss: 0.0875697 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9354722  Vali macro F1 0.8767103 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 1.3411741256713867
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1066742  Vali Loss: 0.0837015 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9621590  Vali macro F1 0.9273123 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 1.338304042816162
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0991003  Vali Loss: 0.0670435 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9707602  Vali macro F1 0.9403509 
new best score!!!!
Validation loss decreased (0.083182 --> 0.067044).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3372139930725098
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0881244  Vali Loss: 0.0687456 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687694  Vali macro F1 0.9421552 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3381686210632324
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0802820  Vali Loss: 0.0565944 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745736  Vali macro F1 0.9506001 
new best score!!!!
Validation loss decreased (0.067044 --> 0.056594).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.339691400527954
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0712940  Vali Loss: 0.0651137 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9690605  Vali macro F1 0.9452089 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.338806390762329
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0652018  Vali Loss: 0.0600671 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746798  Vali macro F1 0.9570292 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 1.338395357131958
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0714698  Vali Loss: 0.0371761 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831590  Vali macro F1 0.9680164 
new best score!!!!
Validation loss decreased (0.056594 --> 0.037176).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.340193271636963
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0592465  Vali Loss: 0.0398475 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831590  Vali macro F1 0.9680164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3402695655822754
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0559008  Vali Loss: 0.0335073 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9854450  Vali macro F1 0.9719013 
new best score!!!!
Validation loss decreased (0.037176 --> 0.033507).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3397769927978516
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0520903  Vali Loss: 0.0385907 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803315  Vali macro F1 0.9653329 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.3401551246643066
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0483438  Vali Loss: 0.0261775 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886185  Vali macro F1 0.9825506 
new best score!!!!
Validation loss decreased (0.033507 --> 0.026177).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3383281230926514
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0347125  Vali Loss: 0.0322218 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831586  Vali macro F1 0.9676736 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3374927043914795
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0336577  Vali Loss: 0.0278439 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9884896  Vali macro F1 0.9786898 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.340482234954834
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0358971  Vali Loss: 0.0421122 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9790174  Vali macro F1 0.9573427 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 1.3386240005493164
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0360750  Vali Loss: 0.0192008 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858727  Vali macro F1 0.9730304 
new best score!!!!
Validation loss decreased (0.026177 --> 0.019201).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.338078260421753
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0254139  Vali Loss: 0.0213335 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859461  Vali macro F1 0.9769757 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3373560905456543
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0248664  Vali Loss: 0.0340585 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9854496  Vali macro F1 0.9719090 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3366069793701172
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0248545  Vali Loss: 0.0143599 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
new best score!!!!
Validation loss decreased (0.019201 --> 0.014360).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3366374969482422
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0260934  Vali Loss: 0.0269025 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915620  Vali macro F1 0.9853863 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3363096714019775
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0264675  Vali Loss: 0.0191034 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885350  Vali macro F1 0.9750916 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3379547595977783
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0278404  Vali Loss: 0.0243120 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886507  Vali macro F1 0.9825586 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3371045589447021
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0220982  Vali Loss: 0.0104562 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.014360 --> 0.010456).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3348217010498047
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0184693  Vali Loss: 0.0195729 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9884896  Vali macro F1 0.9786898 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3401291370391846
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0192252  Vali Loss: 0.0239266 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887690  Vali macro F1 0.9798810 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.3360350131988525
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0170386  Vali Loss: 0.0136128 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 1.3359100818634033
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0206476  Vali Loss: 0.0221136 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943597  Vali macro F1 0.9913038 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 1.3406274318695068
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0154920  Vali Loss: 0.0223497 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859257  Vali macro F1 0.9810849 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 1.3359405994415283
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0137986  Vali Loss: 0.0092581 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
new best score!!!!
Validation loss decreased (0.010456 --> 0.009258).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3551499843597412
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0102596  Vali Loss: 0.0084686 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.009258 --> 0.008469).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.335639238357544
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0105797  Vali Loss: 0.0084418 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.008469 --> 0.008442).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3384590148925781
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0102007  Vali Loss: 0.0081111 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.008442 --> 0.008111).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3351671695709229
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0094464  Vali Loss: 0.0082275 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.335174322128296
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0086210  Vali Loss: 0.0082698 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.3363409042358398
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0091270  Vali Loss: 0.0084691 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.3372132778167725
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0094955  Vali Loss: 0.0081842 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.3353853225708008
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0090807  Vali Loss: 0.0077791 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.008111 --> 0.007779).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.3363900184631348
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0085376  Vali Loss: 0.0084282 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3380587100982666
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0086848  Vali Loss: 0.0083710 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3386318683624268
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0079650  Vali Loss: 0.0086081 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.3423974514007568
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0082126  Vali Loss: 0.0088519 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.3412079811096191
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0072697  Vali Loss: 0.0082830 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 58 cost time: 1.3417322635650635
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0068605  Vali Loss: 0.0082558 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3423268795013428
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0074432  Vali Loss: 0.0087991 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.340308427810669
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0074835  Vali Loss: 0.0092621 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.3425655364990234
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0072616  Vali Loss: 0.0092656 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.3436145782470703
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0070587  Vali Loss: 0.0088713 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 63 cost time: 1.3433101177215576
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0073072  Vali Loss: 0.0088372 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.3404908180236816
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0074709  Vali Loss: 0.0087994 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.33992600440979
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0068029  Vali Loss: 0.0087730 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.3406684398651123
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0077756  Vali Loss: 0.0087299 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.341374158859253
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0071832  Vali Loss: 0.0087329 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898344  Test macro F1 0.9868398 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4664828777313232
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0088260  Vali Loss: 0.0088611 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
Validation loss decreased (inf --> 0.008861).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4640390872955322
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0079804  Vali Loss: 0.0083551 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.008861 --> 0.008355).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.4630820751190186
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0078594  Vali Loss: 0.0079388 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.008355 --> 0.007939).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4681341648101807
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0076413  Vali Loss: 0.0078566 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.007939 --> 0.007857).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4633512496948242
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0074578  Vali Loss: 0.0110304 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.4656901359558105
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0062331  Vali Loss: 0.0068040 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.007857 --> 0.006804).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.4650194644927979
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0063413  Vali Loss: 0.0090552 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.4651355743408203
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0066734  Vali Loss: 0.0110682 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.4640438556671143
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0059825  Vali Loss: 0.0046720 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006804 --> 0.004672).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.4667549133300781
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0068774  Vali Loss: 0.0085506 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914396  Vali macro F1 0.9848619 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.4653873443603516
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0059901  Vali Loss: 0.0091024 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.4638102054595947
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0053994  Vali Loss: 0.0052985 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 1.464475393295288
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0049307  Vali Loss: 0.0060095 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 1.4645802974700928
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0061626  Vali Loss: 0.0078598 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 1.4643466472625732
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0042408  Vali Loss: 0.0083287 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.4667742252349854
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0038793  Vali Loss: 0.0089646 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.465827465057373
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0037298  Vali Loss: 0.0055727 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.4636542797088623
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0050151  Vali Loss: 0.0136880 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 1.4652564525604248
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0046391  Vali Loss: 0.0051208 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 1.46329927444458
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0045009  Vali Loss: 0.0052131 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.4665946960449219
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0052364  Vali Loss: 0.0052641 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 1.4632542133331299
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0037533  Vali Loss: 0.0056389 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 1.4650557041168213
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0036606  Vali Loss: 0.0056362 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 1.4640705585479736
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0047056  Vali Loss: 0.0062954 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898379  Test macro F1 0.9881533 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00271739 0.002331   0.00242131 0.00326797 0.00595238 0.00578035
 0.00303951 0.00301205 0.00238095 0.00404858]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.342949390411377
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1841562  Vali Loss: 1.7718265 Vali Accuracy: 0.3389831  Vali weighted F1: 0.2423619  Vali macro F1 0.2002310 
Validation loss decreased (inf --> 1.771827).  Saving model ...
Epoch: 2 cost time: 1.3431382179260254
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.3677479  Vali Loss: 0.8724797 Vali Accuracy: 0.6384181  Vali weighted F1: 0.6153537  Vali macro F1 0.5814225 
new best score!!!!
Validation loss decreased (1.771827 --> 0.872480).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3411145210266113
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8343005  Vali Loss: 0.5499087 Vali Accuracy: 0.8079096  Vali weighted F1: 0.7869178  Vali macro F1 0.7320962 
new best score!!!!
Validation loss decreased (0.872480 --> 0.549909).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3413581848144531
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5838751  Vali Loss: 0.3804376 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8689447  Vali macro F1 0.8375877 
new best score!!!!
Validation loss decreased (0.549909 --> 0.380438).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3453481197357178
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4289702  Vali Loss: 0.2852981 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8984997  Vali macro F1 0.8446012 
new best score!!!!
Validation loss decreased (0.380438 --> 0.285298).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3480808734893799
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3346157  Vali Loss: 0.2240828 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9209006  Vali macro F1 0.8725680 
new best score!!!!
Validation loss decreased (0.285298 --> 0.224083).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3442249298095703
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2693757  Vali Loss: 0.1698911 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9300112  Vali macro F1 0.8755826 
new best score!!!!
Validation loss decreased (0.224083 --> 0.169891).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3605165481567383
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2273871  Vali Loss: 0.1685943 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8954189  Vali macro F1 0.8375788 
new best score!!!!
Validation loss decreased (0.169891 --> 0.168594).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3428573608398438
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1972783  Vali Loss: 0.1356324 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9410647  Vali macro F1 0.9004462 
new best score!!!!
Validation loss decreased (0.168594 --> 0.135632).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3471150398254395
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1659432  Vali Loss: 0.1075936 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9582996  Vali macro F1 0.9159250 
new best score!!!!
Validation loss decreased (0.135632 --> 0.107594).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3439075946807861
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1437676  Vali Loss: 0.1084900 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9291491  Vali macro F1 0.8763452 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.3426976203918457
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1370894  Vali Loss: 0.0991988 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9591699  Vali macro F1 0.9289654 
new best score!!!!
Validation loss decreased (0.107594 --> 0.099199).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.344733715057373
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1310367  Vali Loss: 0.0944558 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9423044  Vali macro F1 0.8922958 
new best score!!!!
Validation loss decreased (0.099199 --> 0.094456).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3418588638305664
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1166065  Vali Loss: 0.0875501 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605685  Vali macro F1 0.9275487 
new best score!!!!
Validation loss decreased (0.094456 --> 0.087550).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3417046070098877
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1126189  Vali Loss: 0.0797770 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9494845  Vali macro F1 0.9024622 
new best score!!!!
Validation loss decreased (0.087550 --> 0.079777).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3419947624206543
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0883347  Vali Loss: 0.0543272 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9882726  Vali macro F1 0.9742424 
new best score!!!!
Validation loss decreased (0.079777 --> 0.054327).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.342432975769043
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0811692  Vali Loss: 0.0562938 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802279  Vali macro F1 0.9623724 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3436989784240723
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0841182  Vali Loss: 0.0666649 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742594  Vali macro F1 0.9500939 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 1.3426930904388428
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0757504  Vali Loss: 0.0701371 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9678642  Vali macro F1 0.9425829 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 1.3436555862426758
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0720760  Vali Loss: 0.0561902 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802279  Vali macro F1 0.9623724 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 1.3453142642974854
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0722388  Vali Loss: 0.0560234 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9764898  Vali macro F1 0.9592126 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 1.3412399291992188
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0527315  Vali Loss: 0.0387570 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887644  Vali macro F1 0.9798734 
new best score!!!!
Validation loss decreased (0.054327 --> 0.038757).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.337695598602295
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0444515  Vali Loss: 0.0384528 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802578  Vali macro F1 0.9683874 
new best score!!!!
Validation loss decreased (0.038757 --> 0.038453).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3349435329437256
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0415138  Vali Loss: 0.0358015 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858221  Vali macro F1 0.9768979 
new best score!!!!
Validation loss decreased (0.038453 --> 0.035802).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3368542194366455
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0384239  Vali Loss: 0.0325862 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887799  Vali macro F1 0.9761404 
new best score!!!!
Validation loss decreased (0.035802 --> 0.032586).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3352704048156738
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0388100  Vali Loss: 0.0309738 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
new best score!!!!
Validation loss decreased (0.032586 --> 0.030974).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3345417976379395
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0349078  Vali Loss: 0.0313764 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914446  Vali macro F1 0.9852123 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3352112770080566
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0384899  Vali Loss: 0.0280972 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914446  Vali macro F1 0.9852123 
new best score!!!!
Validation loss decreased (0.030974 --> 0.028097).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3343250751495361
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0366201  Vali Loss: 0.0257619 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.028097 --> 0.025762).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.335228681564331
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0354089  Vali Loss: 0.0254642 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.025762 --> 0.025464).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3372979164123535
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0336417  Vali Loss: 0.0247554 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.025464 --> 0.024755).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3356804847717285
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0333463  Vali Loss: 0.0265263 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887399  Vali macro F1 0.9796294 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3364522457122803
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0318619  Vali Loss: 0.0239779 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.024755 --> 0.023978).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3359463214874268
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0296296  Vali Loss: 0.0224120 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.023978 --> 0.022412).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.341972827911377
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0298365  Vali Loss: 0.0222901 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.022412 --> 0.022290).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.338592290878296
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0277745  Vali Loss: 0.0216465 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.022290 --> 0.021646).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3367335796356201
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0304365  Vali Loss: 0.0249988 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3368875980377197
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0294465  Vali Loss: 0.0210662 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943132  Vali macro F1 0.9902210 
new best score!!!!
Validation loss decreased (0.021646 --> 0.021066).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3536548614501953
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0285241  Vali Loss: 0.0235045 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3368127346038818
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0275747  Vali Loss: 0.0198988 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.021066 --> 0.019899).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3381459712982178
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0279201  Vali Loss: 0.0209316 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3355014324188232
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0264039  Vali Loss: 0.0177083 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.019899 --> 0.017708).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3361940383911133
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0268052  Vali Loss: 0.0197782 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3351538181304932
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0253268  Vali Loss: 0.0176610 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.017708 --> 0.017661).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3366515636444092
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0255470  Vali Loss: 0.0183396 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3363099098205566
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0255725  Vali Loss: 0.0175183 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.017661 --> 0.017518).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3445992469787598
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0248716  Vali Loss: 0.0204662 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3410072326660156
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0245250  Vali Loss: 0.0166250 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.017518 --> 0.016625).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3358988761901855
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0255003  Vali Loss: 0.0170231 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3371555805206299
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0260600  Vali Loss: 0.0156476 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016625 --> 0.015648).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.3351669311523438
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0240484  Vali Loss: 0.0157377 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.3376657962799072
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0233425  Vali Loss: 0.0200153 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887399  Vali macro F1 0.9796294 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.336052656173706
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0228223  Vali Loss: 0.0144730 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015648 --> 0.014473).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.3340718746185303
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0233138  Vali Loss: 0.0179831 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.335221767425537
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0215376  Vali Loss: 0.0147234 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.3360085487365723
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0219813  Vali Loss: 0.0164721 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.3398644924163818
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0198106  Vali Loss: 0.0146420 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.3354840278625488
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0206862  Vali Loss: 0.0131833 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014473 --> 0.013183).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.3374018669128418
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0194055  Vali Loss: 0.0136658 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.3396625518798828
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0186439  Vali Loss: 0.0149313 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.3378989696502686
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0192425  Vali Loss: 0.0154591 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.3353400230407715
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0188996  Vali Loss: 0.0135961 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.336738109588623
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0212177  Vali Loss: 0.0139618 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 64 cost time: 1.3368923664093018
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0183264  Vali Loss: 0.0135603 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.3364238739013672
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0172007  Vali Loss: 0.0129948 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.013183 --> 0.012995).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.338526964187622
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0196809  Vali Loss: 0.0131090 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.3368003368377686
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0182642  Vali Loss: 0.0130736 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 1.349623680114746
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0203327  Vali Loss: 0.0133074 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 1.3383245468139648
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0208881  Vali Loss: 0.0136305 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 1.3389973640441895
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0185202  Vali Loss: 0.0135165 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 71 cost time: 1.3387792110443115
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0190632  Vali Loss: 0.0134598 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.3368806838989258
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0185200  Vali Loss: 0.0134059 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.3358097076416016
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0187333  Vali Loss: 0.0133535 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.3361499309539795
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0184394  Vali Loss: 0.0132960 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 1.3390605449676514
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0201855  Vali Loss: 0.0132347 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 76 cost time: 1.336073398590088
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0207766  Vali Loss: 0.0132326 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 1.3417937755584717
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0189133  Vali Loss: 0.0132342 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 1.3400006294250488
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0201695  Vali Loss: 0.0132332 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 1.3401358127593994
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0171217  Vali Loss: 0.0132329 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 1.33721923828125
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0197814  Vali Loss: 0.0132298 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920591  Test macro F1 0.9911051 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4693012237548828
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0208767  Vali Loss: 0.0135396 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
Validation loss decreased (inf --> 0.013540).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.466843843460083
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0201706  Vali Loss: 0.0144707 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4657411575317383
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0177294  Vali Loss: 0.0134613 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.013540 --> 0.013461).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4657542705535889
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0168925  Vali Loss: 0.0127155 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.013461 --> 0.012715).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4685640335083008
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0168494  Vali Loss: 0.0103418 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.012715 --> 0.010342).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.464773178100586
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0179746  Vali Loss: 0.0103158 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.010342 --> 0.010316).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.4661049842834473
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0171858  Vali Loss: 0.0118859 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.4673717021942139
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0189908  Vali Loss: 0.0113553 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.4676179885864258
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0149017  Vali Loss: 0.0124129 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.4672646522521973
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0140864  Vali Loss: 0.0100416 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.010316 --> 0.010042).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.4684882164001465
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0145474  Vali Loss: 0.0105130 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4672811031341553
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0149644  Vali Loss: 0.0110719 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4678230285644531
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0158015  Vali Loss: 0.0115605 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.468076229095459
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0123203  Vali Loss: 0.0105145 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4652392864227295
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0141059  Vali Loss: 0.0098557 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.010042 --> 0.009856).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.467777967453003
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0144801  Vali Loss: 0.0137181 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.4664700031280518
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0121192  Vali Loss: 0.0124013 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.4671964645385742
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0122588  Vali Loss: 0.0079975 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.009856 --> 0.007997).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.4666800498962402
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0118020  Vali Loss: 0.0100961 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.4666566848754883
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0129205  Vali Loss: 0.0079967 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007997 --> 0.007997).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 1.4654834270477295
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0129609  Vali Loss: 0.0108279 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.4686753749847412
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0123904  Vali Loss: 0.0079768 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007997 --> 0.007977).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.4668889045715332
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0117011  Vali Loss: 0.0084253 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.4663009643554688
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0101298  Vali Loss: 0.0076539 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007977 --> 0.007654).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 1.4668805599212646
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0115026  Vali Loss: 0.0086129 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 1.467057466506958
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0102041  Vali Loss: 0.0069409 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007654 --> 0.006941).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 1.4681031703948975
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0097589  Vali Loss: 0.0074551 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 1.46669340133667
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0103032  Vali Loss: 0.0058134 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.006941 --> 0.005813).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 1.4667377471923828
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0102212  Vali Loss: 0.0078304 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.4658775329589844
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0083676  Vali Loss: 0.0084497 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.4676151275634766
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0110182  Vali Loss: 0.0100618 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915919  Vali macro F1 0.9822145 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 1.4665625095367432
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0114141  Vali Loss: 0.0065437 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 1.467775821685791
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0095759  Vali Loss: 0.0057489 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005813 --> 0.005749).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 1.469001054763794
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0113531  Vali Loss: 0.0077695 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 1.4654114246368408
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0082629  Vali Loss: 0.0067122 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 1.465179443359375
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0088325  Vali Loss: 0.0081485 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 1.4659950733184814
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0077252  Vali Loss: 0.0057061 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005749 --> 0.005706).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 38 cost time: 1.4661839008331299
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0068645  Vali Loss: 0.0054019 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.005706 --> 0.005402).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 1.4663681983947754
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0088707  Vali Loss: 0.0067899 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 1.4659645557403564
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0079987  Vali Loss: 0.0059187 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 1.4695017337799072
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0088924  Vali Loss: 0.0101877 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 1.470651626586914
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0087569  Vali Loss: 0.0047079 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005402 --> 0.004708).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 43 cost time: 1.4668445587158203
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0080780  Vali Loss: 0.0049341 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 1.4682371616363525
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0081479  Vali Loss: 0.0097805 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 1.4660310745239258
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0082489  Vali Loss: 0.0041455 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004708 --> 0.004145).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 1.4685485363006592
Fine Tuning VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0073087  Vali Loss: 0.0096545 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 47 cost time: 1.4702746868133545
Fine Tuning VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0087316  Vali Loss: 0.0123730 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943359  Vali macro F1 0.9912032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 48 cost time: 1.4680631160736084
Fine Tuning VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0061620  Vali Loss: 0.0067383 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 49 cost time: 1.4702224731445312
Fine Tuning VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0079268  Vali Loss: 0.0041972 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 50 cost time: 1.4709115028381348
Fine Tuning VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0062532  Vali Loss: 0.0091327 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 51 cost time: 1.4693429470062256
Fine Tuning VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0068155  Vali Loss: 0.0041129 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.004145 --> 0.004113).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 52 cost time: 1.4680671691894531
Fine Tuning VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0082907  Vali Loss: 0.0049426 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 53 cost time: 1.4663875102996826
Fine Tuning VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0088291  Vali Loss: 0.0061867 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 54 cost time: 1.4666790962219238
Fine Tuning VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0051630  Vali Loss: 0.0036000 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004113 --> 0.003600).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 55 cost time: 1.46964693069458
Fine Tuning VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0058452  Vali Loss: 0.0085845 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971771  Vali macro F1 0.9976665 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 56 cost time: 1.4707095623016357
Fine Tuning VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0066845  Vali Loss: 0.0036646 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 57 cost time: 1.4700918197631836
Fine Tuning VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0051643  Vali Loss: 0.0041178 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 58 cost time: 1.4666335582733154
Fine Tuning VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0072168  Vali Loss: 0.0100651 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 59 cost time: 1.4675395488739014
Fine Tuning VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0058855  Vali Loss: 0.0061262 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 60 cost time: 1.4681789875030518
Fine Tuning VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0060264  Vali Loss: 0.0060588 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 61 cost time: 1.4674162864685059
Fine Tuning VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0050795  Vali Loss: 0.0058131 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 62 cost time: 1.4682300090789795
Fine Tuning VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0053516  Vali Loss: 0.0060472 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 63 cost time: 1.4688851833343506
Fine Tuning VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0053316  Vali Loss: 0.0061756 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 64 cost time: 1.467320442199707
Fine Tuning VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0062195  Vali Loss: 0.0058187 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 65 cost time: 1.4669017791748047
Fine Tuning VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0042612  Vali Loss: 0.0057804 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 66 cost time: 1.4685747623443604
Fine Tuning VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0057445  Vali Loss: 0.0057580 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 67 cost time: 1.4679410457611084
Fine Tuning VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0051118  Vali Loss: 0.0057572 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 68 cost time: 1.4739112854003906
Fine Tuning VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0058428  Vali Loss: 0.0057468 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 69 cost time: 1.4657742977142334
Fine Tuning VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0052061  Vali Loss: 0.0057513 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943401  Test macro F1 0.9948455 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00280112 0.00239808 0.00241546 0.00322581 0.00549451 0.00552486
 0.00324675 0.00292398 0.00236967 0.00396825]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3417744636535645
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1782102  Vali Loss: 1.7569933 Vali Accuracy: 0.3559322  Vali weighted F1: 0.2525984  Vali macro F1 0.2125335 
Validation loss decreased (inf --> 1.756993).  Saving model ...
Epoch: 2 cost time: 1.348698616027832
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.3687264  Vali Loss: 0.8310938 Vali Accuracy: 0.6920904  Vali weighted F1: 0.6643016  Vali macro F1 0.6160235 
new best score!!!!
Validation loss decreased (1.756993 --> 0.831094).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3472628593444824
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8350196  Vali Loss: 0.5576494 Vali Accuracy: 0.8107345  Vali weighted F1: 0.7969402  Vali macro F1 0.7432969 
new best score!!!!
Validation loss decreased (0.831094 --> 0.557649).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.348952293395996
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5900844  Vali Loss: 0.4061279 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8245436  Vali macro F1 0.7647333 
new best score!!!!
Validation loss decreased (0.557649 --> 0.406128).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3485829830169678
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4480972  Vali Loss: 0.3082384 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9019770  Vali macro F1 0.8620969 
new best score!!!!
Validation loss decreased (0.406128 --> 0.308238).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3507063388824463
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3557830  Vali Loss: 0.2563482 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8736763  Vali macro F1 0.8116476 
new best score!!!!
Validation loss decreased (0.308238 --> 0.256348).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3449060916900635
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2857927  Vali Loss: 0.1986937 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9049614  Vali macro F1 0.8610145 
new best score!!!!
Validation loss decreased (0.256348 --> 0.198694).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.344991683959961
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2374438  Vali Loss: 0.1791465 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8893336  Vali macro F1 0.8269679 
new best score!!!!
Validation loss decreased (0.198694 --> 0.179147).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3441617488861084
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2026491  Vali Loss: 0.1393984 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9334958  Vali macro F1 0.8875320 
new best score!!!!
Validation loss decreased (0.179147 --> 0.139398).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.347303867340088
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1758779  Vali Loss: 0.1226717 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9542186  Vali macro F1 0.9201660 
new best score!!!!
Validation loss decreased (0.139398 --> 0.122672).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3426392078399658
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1580325  Vali Loss: 0.1193159 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9185828  Vali macro F1 0.8511722 
new best score!!!!
Validation loss decreased (0.122672 --> 0.119316).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3417484760284424
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1444445  Vali Loss: 0.1053980 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9558742  Vali macro F1 0.9168519 
new best score!!!!
Validation loss decreased (0.119316 --> 0.105398).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3411648273468018
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1347246  Vali Loss: 0.1076233 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9317792  Vali macro F1 0.8776758 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.3391807079315186
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1173913  Vali Loss: 0.0916192 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661369  Vali macro F1 0.9432432 
new best score!!!!
Validation loss decreased (0.105398 --> 0.091619).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3359944820404053
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1111476  Vali Loss: 0.0807203 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684796  Vali macro F1 0.9468786 
new best score!!!!
Validation loss decreased (0.091619 --> 0.080720).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3356568813323975
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0985381  Vali Loss: 0.0576652 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9755753  Vali macro F1 0.9494320 
new best score!!!!
Validation loss decreased (0.080720 --> 0.057665).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3355770111083984
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0881873  Vali Loss: 0.0753317 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9645861  Vali macro F1 0.9368197 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3369128704071045
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0918006  Vali Loss: 0.0655548 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9798179  Vali macro F1 0.9637929 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 1.336665391921997
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0861563  Vali Loss: 0.0549483 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831067  Vali macro F1 0.9680382 
new best score!!!!
Validation loss decreased (0.057665 --> 0.054948).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.339381217956543
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0692243  Vali Loss: 0.0415437 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857610  Vali macro F1 0.9754954 
new best score!!!!
Validation loss decreased (0.054948 --> 0.041544).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3388967514038086
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0581449  Vali Loss: 0.0383166 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885611  Vali macro F1 0.9776543 
new best score!!!!
Validation loss decreased (0.041544 --> 0.038317).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3401734828948975
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0513175  Vali Loss: 0.0498412 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9856808  Vali macro F1 0.9752496 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3396811485290527
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0648125  Vali Loss: 0.0525435 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745641  Vali macro F1 0.9633621 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.342911720275879
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0524639  Vali Loss: 0.0277192 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885588  Vali macro F1 0.9778136 
new best score!!!!
Validation loss decreased (0.038317 --> 0.027719).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3407070636749268
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0465047  Vali Loss: 0.0251983 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915289  Vali macro F1 0.9852030 
new best score!!!!
Validation loss decreased (0.027719 --> 0.025198).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3424348831176758
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0352847  Vali Loss: 0.0226062 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914718  Vali macro F1 0.9815718 
new best score!!!!
Validation loss decreased (0.025198 --> 0.022606).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3444454669952393
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0288772  Vali Loss: 0.0240983 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.339888095855713
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0306654  Vali Loss: 0.0189323 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
new best score!!!!
Validation loss decreased (0.022606 --> 0.018932).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3383383750915527
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0254854  Vali Loss: 0.0149873 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914320  Vali macro F1 0.9840896 
new best score!!!!
Validation loss decreased (0.018932 --> 0.014987).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3388681411743164
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0248487  Vali Loss: 0.0163367 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3388497829437256
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0196233  Vali Loss: 0.0122572 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014987 --> 0.012257).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3413331508636475
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0177460  Vali Loss: 0.0124721 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3373239040374756
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0157571  Vali Loss: 0.0125470 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3383848667144775
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0127280  Vali Loss: 0.0104450 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.012257 --> 0.010445).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3364958763122559
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0142084  Vali Loss: 0.0090761 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.010445 --> 0.009076).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3362021446228027
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0197848  Vali Loss: 0.0075788 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.009076 --> 0.007579).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3372926712036133
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0154732  Vali Loss: 0.0125234 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.337348222732544
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0176412  Vali Loss: 0.0167413 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.337167739868164
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0177201  Vali Loss: 0.0237965 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858774  Vali macro F1 0.9805269 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.337186336517334
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0140416  Vali Loss: 0.0108161 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 1.3341715335845947
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0116823  Vali Loss: 0.0093771 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 1.3369567394256592
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0089228  Vali Loss: 0.0092615 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3345608711242676
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0087387  Vali Loss: 0.0090419 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3360588550567627
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0082207  Vali Loss: 0.0092929 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.3358404636383057
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0075774  Vali Loss: 0.0102673 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 1.3373908996582031
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0078808  Vali Loss: 0.0095776 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 1.3341917991638184
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0084802  Vali Loss: 0.0094876 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3352570533752441
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0070641  Vali Loss: 0.0094455 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.3357205390930176
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0071368  Vali Loss: 0.0093911 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.3359932899475098
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0065225  Vali Loss: 0.0094300 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.3347938060760498
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0068183  Vali Loss: 0.0094472 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920918  Test macro F1 0.9911936 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.465540885925293
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0126497  Vali Loss: 0.0077653 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
Validation loss decreased (inf --> 0.007765).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4656803607940674
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0085047  Vali Loss: 0.0071962 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007765 --> 0.007196).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.466365098953247
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0090691  Vali Loss: 0.0070079 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007196 --> 0.007008).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4698843955993652
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0098984  Vali Loss: 0.0086846 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.4644505977630615
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0079589  Vali Loss: 0.0085642 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.4688143730163574
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0071073  Vali Loss: 0.0082237 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.4660890102386475
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0080098  Vali Loss: 0.0084957 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.465466022491455
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0068783  Vali Loss: 0.0091664 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.4663126468658447
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0072680  Vali Loss: 0.0118048 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.4677095413208008
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0080294  Vali Loss: 0.0094284 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.4678962230682373
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0063968  Vali Loss: 0.0078238 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.4667518138885498
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0060167  Vali Loss: 0.0055806 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007008 --> 0.005581).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.4663376808166504
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0068392  Vali Loss: 0.0106261 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.4673759937286377
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0063315  Vali Loss: 0.0095236 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.4687252044677734
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0060069  Vali Loss: 0.0105563 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.4679644107818604
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0070084  Vali Loss: 0.0105175 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915076  Vali macro F1 0.9891834 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.466156244277954
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0055075  Vali Loss: 0.0075559 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 1.4675493240356445
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0062065  Vali Loss: 0.0075968 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.4662766456604004
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0054884  Vali Loss: 0.0075385 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.4647653102874756
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0054643  Vali Loss: 0.0077424 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.4677917957305908
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0055837  Vali Loss: 0.0080906 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.464634895324707
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0052354  Vali Loss: 0.0082389 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 1.4650497436523438
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0048515  Vali Loss: 0.0082423 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.464704990386963
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0045993  Vali Loss: 0.0082336 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.4657721519470215
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0056704  Vali Loss: 0.0082127 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.4685280323028564
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0053162  Vali Loss: 0.0082165 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.4661154747009277
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0052152  Vali Loss: 0.0082918 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909552  Test macro F1 0.9889742 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00271003 0.00234742 0.00247525 0.00337838 0.00540541 0.00584795
 0.00310559 0.00282486 0.00240964 0.00411523]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3509855270385742
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1869221  Vali Loss: 1.7814284 Vali Accuracy: 0.3559322  Vali weighted F1: 0.2640668  Vali macro F1 0.2258010 
Validation loss decreased (inf --> 1.781428).  Saving model ...
Epoch: 2 cost time: 1.3439784049987793
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.3903873  Vali Loss: 0.8515836 Vali Accuracy: 0.6807910  Vali weighted F1: 0.6613937  Vali macro F1 0.6255418 
new best score!!!!
Validation loss decreased (1.781428 --> 0.851584).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.360706090927124
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8332817  Vali Loss: 0.5359987 Vali Accuracy: 0.8163842  Vali weighted F1: 0.8152874  Vali macro F1 0.7757462 
new best score!!!!
Validation loss decreased (0.851584 --> 0.535999).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3429391384124756
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5777605  Vali Loss: 0.3808107 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8606083  Vali macro F1 0.7991820 
new best score!!!!
Validation loss decreased (0.535999 --> 0.380811).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.341982126235962
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4313137  Vali Loss: 0.3006323 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8687713  Vali macro F1 0.8230497 
new best score!!!!
Validation loss decreased (0.380811 --> 0.300632).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.344559907913208
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3329335  Vali Loss: 0.2159603 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9123212  Vali macro F1 0.8437326 
new best score!!!!
Validation loss decreased (0.300632 --> 0.215960).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3418910503387451
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2670107  Vali Loss: 0.1737159 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9104459  Vali macro F1 0.8490672 
new best score!!!!
Validation loss decreased (0.215960 --> 0.173716).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3378593921661377
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2202903  Vali Loss: 0.1510864 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9241976  Vali macro F1 0.8667700 
new best score!!!!
Validation loss decreased (0.173716 --> 0.151086).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3423607349395752
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1933017  Vali Loss: 0.1317588 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9409531  Vali macro F1 0.9067006 
new best score!!!!
Validation loss decreased (0.151086 --> 0.131759).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3431601524353027
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1588009  Vali Loss: 0.1064356 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9626821  Vali macro F1 0.9279791 
new best score!!!!
Validation loss decreased (0.131759 --> 0.106436).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.342214822769165
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1491065  Vali Loss: 0.1059892 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9394777  Vali macro F1 0.8892911 
new best score!!!!
Validation loss decreased (0.106436 --> 0.105989).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3426837921142578
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1382389  Vali Loss: 0.1052236 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9499021  Vali macro F1 0.9152808 
new best score!!!!
Validation loss decreased (0.105989 --> 0.105224).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3440427780151367
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1264462  Vali Loss: 0.0825018 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803811  Vali macro F1 0.9585004 
new best score!!!!
Validation loss decreased (0.105224 --> 0.082502).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3434662818908691
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1101394  Vali Loss: 0.0700674 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800045  Vali macro F1 0.9600058 
new best score!!!!
Validation loss decreased (0.082502 --> 0.070067).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3451623916625977
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1064678  Vali Loss: 0.0769109 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9679341  Vali macro F1 0.9379086 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.344702959060669
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1088351  Vali Loss: 0.0722834 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687725  Vali macro F1 0.9423391 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 1.3458802700042725
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1059053  Vali Loss: 0.0666395 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9799852  Vali macro F1 0.9637958 
new best score!!!!
Validation loss decreased (0.070067 --> 0.066640).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3445897102355957
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0911822  Vali Loss: 0.0614281 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9734119  Vali macro F1 0.9476703 
new best score!!!!
Validation loss decreased (0.066640 --> 0.061428).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3452506065368652
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0737011  Vali Loss: 0.0574682 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9737710  Vali macro F1 0.9516065 
new best score!!!!
Validation loss decreased (0.061428 --> 0.057468).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.335982084274292
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0625154  Vali Loss: 0.0342857 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857667  Vali macro F1 0.9757354 
new best score!!!!
Validation loss decreased (0.057468 --> 0.034286).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.340219259262085
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0516681  Vali Loss: 0.0331809 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829120  Vali macro F1 0.9695003 
new best score!!!!
Validation loss decreased (0.034286 --> 0.033181).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3373987674713135
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0453681  Vali Loss: 0.0383943 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9798304  Vali macro F1 0.9587746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3393125534057617
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0417839  Vali Loss: 0.0289334 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9798304  Vali macro F1 0.9587746 
new best score!!!!
Validation loss decreased (0.033181 --> 0.028933).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.33902907371521
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0425321  Vali Loss: 0.0398820 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887799  Vali macro F1 0.9761404 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3406178951263428
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0335104  Vali Loss: 0.0307359 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828869  Vali macro F1 0.9694850 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.3390476703643799
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0301246  Vali Loss: 0.0260472 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
new best score!!!!
Validation loss decreased (0.028933 --> 0.026047).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3416688442230225
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0272429  Vali Loss: 0.0389237 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9790285  Vali macro F1 0.9560964 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3398420810699463
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0320131  Vali Loss: 0.0637458 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659765  Vali macro F1 0.9605381 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3459630012512207
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0487465  Vali Loss: 0.0269555 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857667  Vali macro F1 0.9757354 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.3403770923614502
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0386194  Vali Loss: 0.0274031 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858730  Vali macro F1 0.9733732 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 1.3537044525146484
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0264671  Vali Loss: 0.0299920 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858229  Vali macro F1 0.9765766 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 1.341271162033081
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0269279  Vali Loss: 0.0229130 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858730  Vali macro F1 0.9733732 
new best score!!!!
Validation loss decreased (0.026047 --> 0.022913).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3388519287109375
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0205284  Vali Loss: 0.0213978 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
new best score!!!!
Validation loss decreased (0.022913 --> 0.021398).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3393230438232422
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0180646  Vali Loss: 0.0211923 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858730  Vali macro F1 0.9733732 
new best score!!!!
Validation loss decreased (0.021398 --> 0.021192).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3432600498199463
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0160990  Vali Loss: 0.0216805 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858730  Vali macro F1 0.9733732 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3393127918243408
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0168521  Vali Loss: 0.0211370 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858730  Vali macro F1 0.9733732 
new best score!!!!
Validation loss decreased (0.021192 --> 0.021137).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3433046340942383
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0158972  Vali Loss: 0.0202382 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
new best score!!!!
Validation loss decreased (0.021137 --> 0.020238).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3390753269195557
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0154549  Vali Loss: 0.0200595 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
new best score!!!!
Validation loss decreased (0.020238 --> 0.020059).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3411383628845215
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0143125  Vali Loss: 0.0206932 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3370881080627441
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0155640  Vali Loss: 0.0197141 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858730  Vali macro F1 0.9733732 
new best score!!!!
Validation loss decreased (0.020059 --> 0.019714).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.337890625
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0139678  Vali Loss: 0.0197232 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886443  Vali macro F1 0.9792307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3356854915618896
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0127872  Vali Loss: 0.0195937 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
new best score!!!!
Validation loss decreased (0.019714 --> 0.019594).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.336364984512329
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0142087  Vali Loss: 0.0197570 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3367247581481934
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0141210  Vali Loss: 0.0187909 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886443  Vali macro F1 0.9792307 
new best score!!!!
Validation loss decreased (0.019594 --> 0.018791).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3388171195983887
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0129942  Vali Loss: 0.0193965 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3369004726409912
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0142487  Vali Loss: 0.0184891 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886443  Vali macro F1 0.9792307 
new best score!!!!
Validation loss decreased (0.018791 --> 0.018489).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.336205005645752
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0128403  Vali Loss: 0.0181693 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
new best score!!!!
Validation loss decreased (0.018489 --> 0.018169).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3375976085662842
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0133288  Vali Loss: 0.0181065 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.018169 --> 0.018106).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3357417583465576
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0116516  Vali Loss: 0.0199000 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885645  Vali macro F1 0.9780536 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3382763862609863
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0126096  Vali Loss: 0.0185832 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914320  Vali macro F1 0.9840896 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.336623191833496
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0111540  Vali Loss: 0.0196745 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3369059562683105
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0120997  Vali Loss: 0.0181420 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.3374903202056885
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0105724  Vali Loss: 0.0186123 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 1.337770938873291
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0114201  Vali Loss: 0.0183855 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.335890769958496
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0113115  Vali Loss: 0.0179711 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.018106 --> 0.017971).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.337493896484375
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0113346  Vali Loss: 0.0176493 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017971 --> 0.017649).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.3369700908660889
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0112988  Vali Loss: 0.0175302 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017649 --> 0.017530).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.3415045738220215
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0107443  Vali Loss: 0.0174417 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017530 --> 0.017442).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.3350911140441895
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0103344  Vali Loss: 0.0174215 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017442 --> 0.017422).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.353696584701538
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0106284  Vali Loss: 0.0173451 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017422 --> 0.017345).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.3349206447601318
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0104144  Vali Loss: 0.0173357 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017345 --> 0.017336).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.3376281261444092
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0112119  Vali Loss: 0.0172948 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017336 --> 0.017295).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.3383913040161133
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0114666  Vali Loss: 0.0172696 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017295 --> 0.017270).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.341068983078003
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0107728  Vali Loss: 0.0173259 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.346015214920044
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0107499  Vali Loss: 0.0172829 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.342998743057251
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0105890  Vali Loss: 0.0173289 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 1.342905044555664
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0110662  Vali Loss: 0.0172993 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 1.3460209369659424
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0121703  Vali Loss: 0.0175412 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 69 cost time: 1.3443498611450195
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0113141  Vali Loss: 0.0175214 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 1.3438401222229004
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0112902  Vali Loss: 0.0175168 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 1.3443658351898193
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0101622  Vali Loss: 0.0175145 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 1.345384120941162
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0118135  Vali Loss: 0.0175086 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 1.3464117050170898
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0109485  Vali Loss: 0.0175173 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 74 cost time: 1.3456170558929443
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0102993  Vali Loss: 0.0175180 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.3450262546539307
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0118896  Vali Loss: 0.0175170 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 1.3437952995300293
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0109620  Vali Loss: 0.0175174 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 1.344935655593872
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0094477  Vali Loss: 0.0175178 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 1.3443126678466797
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0106057  Vali Loss: 0.0175185 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909493  Test macro F1 0.9880097 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4664618968963623
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0106310  Vali Loss: 0.0170245 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
Validation loss decreased (inf --> 0.017025).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4595732688903809
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0113030  Vali Loss: 0.0170892 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9757143 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4615681171417236
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0098034  Vali Loss: 0.0181968 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4608662128448486
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0098088  Vali Loss: 0.0150247 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017025 --> 0.015025).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4605247974395752
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0100274  Vali Loss: 0.0159966 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.4605135917663574
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0097706  Vali Loss: 0.0140257 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.015025 --> 0.014026).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.459702491760254
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0080799  Vali Loss: 0.0155834 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.4601521492004395
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0091707  Vali Loss: 0.0159562 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.4605698585510254
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0077480  Vali Loss: 0.0156646 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.4652032852172852
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0095151  Vali Loss: 0.0149627 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914718  Vali macro F1 0.9815718 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 1.4611480236053467
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0106111  Vali Loss: 0.0157401 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 1.4598236083984375
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0080547  Vali Loss: 0.0142776 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.4606425762176514
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0085663  Vali Loss: 0.0138305 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9757143 
new best score!!!!
Validation loss decreased (0.014026 --> 0.013830).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.4613919258117676
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0092747  Vali Loss: 0.0147486 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.4596786499023438
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0079249  Vali Loss: 0.0171526 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.4605722427368164
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0076042  Vali Loss: 0.0157265 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.4613561630249023
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0072167  Vali Loss: 0.0153009 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.4612605571746826
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0079304  Vali Loss: 0.0164400 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 1.4595518112182617
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0065779  Vali Loss: 0.0164451 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.46220064163208
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0064892  Vali Loss: 0.0161852 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.4616620540618896
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0073820  Vali Loss: 0.0157705 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.4635467529296875
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0073213  Vali Loss: 0.0155959 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.4610517024993896
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0080216  Vali Loss: 0.0155153 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 1.4604432582855225
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0073463  Vali Loss: 0.0155244 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 1.4615914821624756
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0072957  Vali Loss: 0.0155128 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 1.46089506149292
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0058746  Vali Loss: 0.0154994 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 1.4612524509429932
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0063054  Vali Loss: 0.0154948 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 1.4613080024719238
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0063617  Vali Loss: 0.0155059 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920848  Test macro F1 0.9900269 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265252 0.00243309 0.00246305 0.00332226 0.00571429 0.00568182
 0.00314465 0.0028169  0.00238663 0.00409836]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3458442687988281
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1661875  Vali Loss: 1.7970447 Vali Accuracy: 0.3333333  Vali weighted F1: 0.2356831  Vali macro F1 0.2273687 
Validation loss decreased (inf --> 1.797045).  Saving model ...
Epoch: 2 cost time: 1.3452322483062744
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.3900858  Vali Loss: 0.9728758 Vali Accuracy: 0.6355932  Vali weighted F1: 0.5953776  Vali macro F1 0.5863082 
new best score!!!!
Validation loss decreased (1.797045 --> 0.972876).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3404457569122314
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8784678  Vali Loss: 0.6471707 Vali Accuracy: 0.7485876  Vali weighted F1: 0.7330608  Vali macro F1 0.7075139 
new best score!!!!
Validation loss decreased (0.972876 --> 0.647171).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3432352542877197
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6062749  Vali Loss: 0.4683169 Vali Accuracy: 0.8389831  Vali weighted F1: 0.8318026  Vali macro F1 0.7909881 
new best score!!!!
Validation loss decreased (0.647171 --> 0.468317).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3410406112670898
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4395531  Vali Loss: 0.3324754 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9163111  Vali macro F1 0.9006464 
new best score!!!!
Validation loss decreased (0.468317 --> 0.332475).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3481762409210205
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3392978  Vali Loss: 0.2659987 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8807159  Vali macro F1 0.8332076 
new best score!!!!
Validation loss decreased (0.332475 --> 0.265999).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3415238857269287
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2762912  Vali Loss: 0.2263909 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8946750  Vali macro F1 0.8508068 
new best score!!!!
Validation loss decreased (0.265999 --> 0.226391).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3584537506103516
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2336236  Vali Loss: 0.1990438 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8980280  Vali macro F1 0.8521014 
new best score!!!!
Validation loss decreased (0.226391 --> 0.199044).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3428001403808594
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2012973  Vali Loss: 0.1567839 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9153620  Vali macro F1 0.8677686 
new best score!!!!
Validation loss decreased (0.199044 --> 0.156784).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3412275314331055
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1673874  Vali Loss: 0.1363345 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9434515  Vali macro F1 0.9165220 
new best score!!!!
Validation loss decreased (0.156784 --> 0.136335).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3429148197174072
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1510972  Vali Loss: 0.1324222 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9036624  Vali macro F1 0.8525190 
new best score!!!!
Validation loss decreased (0.136335 --> 0.132422).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3426551818847656
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1341599  Vali Loss: 0.1241897 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9279197  Vali macro F1 0.8901670 
new best score!!!!
Validation loss decreased (0.132422 --> 0.124190).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3408656120300293
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1282947  Vali Loss: 0.1223661 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9406184  Vali macro F1 0.9125116 
new best score!!!!
Validation loss decreased (0.124190 --> 0.122366).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3367581367492676
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1215600  Vali Loss: 0.1070692 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9517238  Vali macro F1 0.9287248 
new best score!!!!
Validation loss decreased (0.122366 --> 0.107069).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3372468948364258
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1103999  Vali Loss: 0.1124113 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9391230  Vali macro F1 0.9063335 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3365044593811035
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1044667  Vali Loss: 0.0986034 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717655  Vali macro F1 0.9595231 
new best score!!!!
Validation loss decreased (0.107069 --> 0.098603).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3336834907531738
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0995285  Vali Loss: 0.1052530 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9230030  Vali macro F1 0.8827802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3361661434173584
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0946957  Vali Loss: 0.0959503 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9578614  Vali macro F1 0.9355617 
new best score!!!!
Validation loss decreased (0.098603 --> 0.095950).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3331589698791504
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0901236  Vali Loss: 0.0919298 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632056  Vali macro F1 0.9479765 
new best score!!!!
Validation loss decreased (0.095950 --> 0.091930).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3338291645050049
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0810653  Vali Loss: 0.0910701 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604054  Vali macro F1 0.9433713 
new best score!!!!
Validation loss decreased (0.091930 --> 0.091070).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3358721733093262
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0744821  Vali Loss: 0.0996398 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9499767  Vali macro F1 0.9314956 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.3465893268585205
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0690683  Vali Loss: 0.0733813 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688564  Vali macro F1 0.9595214 
new best score!!!!
Validation loss decreased (0.091070 --> 0.073381).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3352177143096924
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0594237  Vali Loss: 0.0648170 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715803  Vali macro F1 0.9642970 
new best score!!!!
Validation loss decreased (0.073381 --> 0.064817).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.335763692855835
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0587097  Vali Loss: 0.0747865 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9712889  Vali macro F1 0.9599253 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3351223468780518
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0531296  Vali Loss: 0.0653373 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715524  Vali macro F1 0.9614282 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.3342256546020508
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0452167  Vali Loss: 0.0558935 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773693  Vali macro F1 0.9687750 
new best score!!!!
Validation loss decreased (0.064817 --> 0.055894).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3359932899475098
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0546544  Vali Loss: 0.0811362 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715620  Vali macro F1 0.9631478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.336756706237793
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0592847  Vali Loss: 0.0552418 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
new best score!!!!
Validation loss decreased (0.055894 --> 0.055242).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.336808681488037
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0434833  Vali Loss: 0.0509173 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830649  Vali macro F1 0.9781278 
new best score!!!!
Validation loss decreased (0.055242 --> 0.050917).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.336705207824707
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0310978  Vali Loss: 0.0543310 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858737  Vali macro F1 0.9816117 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3363161087036133
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0299666  Vali Loss: 0.0475186 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858625  Vali macro F1 0.9802488 
new best score!!!!
Validation loss decreased (0.050917 --> 0.047519).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3965721130371094
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0346538  Vali Loss: 0.0503871 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773082  Vali macro F1 0.9696751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3345699310302734
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0286854  Vali Loss: 0.0452467 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886871  Vali macro F1 0.9872173 
new best score!!!!
Validation loss decreased (0.047519 --> 0.045247).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3822710514068604
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0224171  Vali Loss: 0.0413082 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858739  Vali macro F1 0.9838265 
new best score!!!!
Validation loss decreased (0.045247 --> 0.041308).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.4030239582061768
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0248130  Vali Loss: 0.0307215 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915250  Vali macro F1 0.9906338 
new best score!!!!
Validation loss decreased (0.041308 --> 0.030722).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3962273597717285
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0254730  Vali Loss: 0.0449739 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830395  Vali macro F1 0.9798137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3897666931152344
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0226771  Vali Loss: 0.0373284 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830377  Vali macro F1 0.9804103 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3353378772735596
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0287341  Vali Loss: 0.0473089 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830342  Vali macro F1 0.9781051 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3369536399841309
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0234689  Vali Loss: 0.0633762 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746316  Vali macro F1 0.9715195 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.3374121189117432
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0227598  Vali Loss: 0.0652209 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716618  Vali macro F1 0.9645844 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 1.3383362293243408
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0176334  Vali Loss: 0.0368432 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9859776 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3396003246307373
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0121477  Vali Loss: 0.0336932 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3398852348327637
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0107638  Vali Loss: 0.0392460 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3404490947723389
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0104467  Vali Loss: 0.0385994 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.3372201919555664
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0088066  Vali Loss: 0.0378143 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 1.3403105735778809
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0099165  Vali Loss: 0.0376996 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3378400802612305
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0087311  Vali Loss: 0.0377056 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3366143703460693
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0103759  Vali Loss: 0.0374855 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.333754301071167
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0100428  Vali Loss: 0.0373124 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.335395097732544
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0110902  Vali Loss: 0.0366389 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9830891  Test weighted F1: 0.9830260  Test macro F1 0.9791018 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4729981422424316
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0230877  Vali Loss: 0.0361838 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9859776 
Validation loss decreased (inf --> 0.036184).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.47267484664917
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0150838  Vali Loss: 0.0380324 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4712438583374023
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0141095  Vali Loss: 0.0390447 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4724442958831787
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0114087  Vali Loss: 0.0305213 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9859776 
new best score!!!!
Validation loss decreased (0.036184 --> 0.030521).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4713683128356934
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0125908  Vali Loss: 0.0338767 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.4724204540252686
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0108087  Vali Loss: 0.0329691 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.471740961074829
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0104542  Vali Loss: 0.0348801 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 1.4720942974090576
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0094301  Vali Loss: 0.0326540 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 1.4712350368499756
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0105100  Vali Loss: 0.0335069 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 1.4708659648895264
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0083788  Vali Loss: 0.0373765 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.470780372619629
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0087328  Vali Loss: 0.0339268 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.4729945659637451
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0081496  Vali Loss: 0.0311401 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 1.4696815013885498
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0088661  Vali Loss: 0.0321956 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887150  Vali macro F1 0.9849252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 1.469970941543579
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0086060  Vali Loss: 0.0379235 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858898  Vali macro F1 0.9827739 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 1.4721057415008545
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0076869  Vali Loss: 0.0373916 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858898  Vali macro F1 0.9827739 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.4691979885101318
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0072111  Vali Loss: 0.0355464 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858898  Vali macro F1 0.9827739 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.4705750942230225
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0073064  Vali Loss: 0.0344096 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858898  Vali macro F1 0.9827739 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.4713284969329834
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0077601  Vali Loss: 0.0349439 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858898  Vali macro F1 0.9827739 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 1.4721214771270752
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0085166  Vali Loss: 0.0349082 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858898  Vali macro F1 0.9827739 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9842165  Test weighted F1: 0.9842110  Test macro F1 0.9823989 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 636195
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00269542 0.00226757 0.00255102 0.0031348  0.00578035 0.00578035
 0.00319489 0.00290698 0.0023753  0.00420168]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3941736221313477
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1760233  Vali Loss: 1.8018637 Vali Accuracy: 0.3531073  Vali weighted F1: 0.3143749  Vali macro F1 0.2685762 
Validation loss decreased (inf --> 1.801864).  Saving model ...
Epoch: 2 cost time: 1.344735860824585
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4288055  Vali Loss: 0.9403398 Vali Accuracy: 0.6694915  Vali weighted F1: 0.6501206  Vali macro F1 0.6257897 
new best score!!!!
Validation loss decreased (1.801864 --> 0.940340).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3507676124572754
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8601166  Vali Loss: 0.6295444 Vali Accuracy: 0.7683616  Vali weighted F1: 0.7444519  Vali macro F1 0.7118969 
new best score!!!!
Validation loss decreased (0.940340 --> 0.629544).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3467295169830322
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5984277  Vali Loss: 0.4635683 Vali Accuracy: 0.8305085  Vali weighted F1: 0.8124044  Vali macro F1 0.7706938 
new best score!!!!
Validation loss decreased (0.629544 --> 0.463568).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.34852933883667
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4298983  Vali Loss: 0.3496836 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8713625  Vali macro F1 0.8513471 
new best score!!!!
Validation loss decreased (0.463568 --> 0.349684).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3459510803222656
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3382962  Vali Loss: 0.2771518 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8853727  Vali macro F1 0.8575221 
new best score!!!!
Validation loss decreased (0.349684 --> 0.277152).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3461101055145264
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2859233  Vali Loss: 0.2527653 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8720474  Vali macro F1 0.8358666 
new best score!!!!
Validation loss decreased (0.277152 --> 0.252765).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3430311679840088
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2508619  Vali Loss: 0.2141615 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9274892  Vali macro F1 0.9026426 
new best score!!!!
Validation loss decreased (0.252765 --> 0.214161).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.344416856765747
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2121908  Vali Loss: 0.1775063 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9183391  Vali macro F1 0.8876651 
new best score!!!!
Validation loss decreased (0.214161 --> 0.177506).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3466625213623047
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1878290  Vali Loss: 0.1691957 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8874168  Vali macro F1 0.8441996 
new best score!!!!
Validation loss decreased (0.177506 --> 0.169196).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3429925441741943
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1657688  Vali Loss: 0.1563820 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9272955  Vali macro F1 0.8984481 
new best score!!!!
Validation loss decreased (0.169196 --> 0.156382).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3413007259368896
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1464609  Vali Loss: 0.1515704 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9098593  Vali macro F1 0.8729222 
new best score!!!!
Validation loss decreased (0.156382 --> 0.151570).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3386893272399902
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1455665  Vali Loss: 0.1372675 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9148195  Vali macro F1 0.8679304 
new best score!!!!
Validation loss decreased (0.151570 --> 0.137268).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3453142642974854
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1299615  Vali Loss: 0.1345261 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9294963  Vali macro F1 0.9026056 
new best score!!!!
Validation loss decreased (0.137268 --> 0.134526).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3447644710540771
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1315109  Vali Loss: 0.1467070 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9397138  Vali macro F1 0.9177148 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3438620567321777
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1230808  Vali Loss: 0.1348951 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9175715  Vali macro F1 0.8835153 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 1.3432769775390625
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1152370  Vali Loss: 0.1465485 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9126466  Vali macro F1 0.8800546 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 1.3444552421569824
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1039962  Vali Loss: 0.1342792 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9138494  Vali macro F1 0.8812465 
new best score!!!!
Validation loss decreased (0.134526 --> 0.134279).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3422691822052002
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0973302  Vali Loss: 0.1234070 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9323436  Vali macro F1 0.9043224 
new best score!!!!
Validation loss decreased (0.134279 --> 0.123407).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3479323387145996
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0877807  Vali Loss: 0.1123867 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9592707  Vali macro F1 0.9413563 
new best score!!!!
Validation loss decreased (0.123407 --> 0.112387).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3436553478240967
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0877666  Vali Loss: 0.1253324 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9353449  Vali macro F1 0.9015043 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.3626503944396973
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0853012  Vali Loss: 0.1284920 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9490906  Vali macro F1 0.9293662 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 1.3403193950653076
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0838580  Vali Loss: 0.1198313 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9406513  Vali macro F1 0.9192036 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 1.3453896045684814
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0789660  Vali Loss: 0.1039959 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687841  Vali macro F1 0.9570848 
new best score!!!!
Validation loss decreased (0.112387 --> 0.103996).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3426697254180908
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0806864  Vali Loss: 0.1163002 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9573169  Vali macro F1 0.9454877 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3451886177062988
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0674352  Vali Loss: 0.0892878 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627392  Vali macro F1 0.9474739 
new best score!!!!
Validation loss decreased (0.103996 --> 0.089288).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3447237014770508
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0565183  Vali Loss: 0.0988276 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627675  Vali macro F1 0.9481237 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.346282720565796
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0566846  Vali Loss: 0.0667981 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859260  Vali macro F1 0.9831713 
new best score!!!!
Validation loss decreased (0.089288 --> 0.066798).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3519997596740723
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0471704  Vali Loss: 0.0759198 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714895  Vali macro F1 0.9596372 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3444323539733887
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0585907  Vali Loss: 0.0653552 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831172  Vali macro F1 0.9815149 
new best score!!!!
Validation loss decreased (0.066798 --> 0.065355).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.348762035369873
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0443591  Vali Loss: 0.0856395 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660959  Vali macro F1 0.9554682 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3409178256988525
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0569508  Vali Loss: 0.0637060 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773475  Vali macro F1 0.9723289 
new best score!!!!
Validation loss decreased (0.065355 --> 0.063706).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3413546085357666
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0550658  Vali Loss: 0.0918186 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661734  Vali macro F1 0.9601148 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3412888050079346
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0451353  Vali Loss: 0.0534656 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858825  Vali macro F1 0.9845030 
new best score!!!!
Validation loss decreased (0.063706 --> 0.053466).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3417158126831055
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0359309  Vali Loss: 0.0819234 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688639  Vali macro F1 0.9586750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3430933952331543
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0401204  Vali Loss: 0.0628660 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831104  Vali macro F1 0.9800224 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3417272567749023
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0381394  Vali Loss: 0.0878228 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745862  Vali macro F1 0.9695062 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3392200469970703
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0312450  Vali Loss: 0.0652555 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802905  Vali macro F1 0.9764534 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 1.3421070575714111
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0334025  Vali Loss: 0.0534597 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830952  Vali macro F1 0.9820039 
new best score!!!!
Validation loss decreased (0.053466 --> 0.053460).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3432590961456299
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0318060  Vali Loss: 0.0641721 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803002  Vali macro F1 0.9756851 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3427846431732178
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0300484  Vali Loss: 0.0633818 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746535  Vali macro F1 0.9693431 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.3435614109039307
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0253991  Vali Loss: 0.0386642 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
new best score!!!!
Validation loss decreased (0.053460 --> 0.038664).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.343637466430664
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0180181  Vali Loss: 0.0423779 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830979  Vali macro F1 0.9822253 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3431494235992432
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0168642  Vali Loss: 0.0377616 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859160  Vali macro F1 0.9866251 
new best score!!!!
Validation loss decreased (0.038664 --> 0.037762).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3434054851531982
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0150516  Vali Loss: 0.0322977 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915258  Vali macro F1 0.9912834 
new best score!!!!
Validation loss decreased (0.037762 --> 0.032298).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3445968627929688
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0149985  Vali Loss: 0.0537897 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802490  Vali macro F1 0.9759248 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3823697566986084
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0269443  Vali Loss: 0.0750092 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662511  Vali macro F1 0.9602800 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3458831310272217
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0443572  Vali Loss: 0.0495393 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859040  Vali macro F1 0.9813340 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.342391014099121
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0197459  Vali Loss: 0.0640314 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774823  Vali macro F1 0.9714579 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.3467559814453125
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0146958  Vali Loss: 0.0351875 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9900334 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 51 cost time: 1.3474304676055908
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0119650  Vali Loss: 0.0339806 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.346639633178711
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0108683  Vali Loss: 0.0329931 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.3465604782104492
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0092673  Vali Loss: 0.0324343 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.3499646186828613
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0095543  Vali Loss: 0.0320653 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
new best score!!!!
Validation loss decreased (0.032298 --> 0.032065).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.3496127128601074
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0104977  Vali Loss: 0.0326646 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.3498170375823975
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0085148  Vali Loss: 0.0311147 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
new best score!!!!
Validation loss decreased (0.032065 --> 0.031115).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.3497040271759033
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0099151  Vali Loss: 0.0301911 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
new best score!!!!
Validation loss decreased (0.031115 --> 0.030191).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.350222110748291
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0078025  Vali Loss: 0.0291762 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
new best score!!!!
Validation loss decreased (0.030191 --> 0.029176).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.349442481994629
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0084165  Vali Loss: 0.0296194 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.3491439819335938
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0077375  Vali Loss: 0.0301976 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.349125862121582
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0076364  Vali Loss: 0.0305596 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.3489210605621338
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0077929  Vali Loss: 0.0294287 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.3509368896484375
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0075988  Vali Loss: 0.0293305 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 64 cost time: 1.3502883911132812
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0078168  Vali Loss: 0.0291826 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.3492329120635986
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0071821  Vali Loss: 0.0293033 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.3481841087341309
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0069380  Vali Loss: 0.0293287 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 1.3490862846374512
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0071809  Vali Loss: 0.0292400 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 1.349564552307129
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0083312  Vali Loss: 0.0292329 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 69 cost time: 1.3510985374450684
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0080706  Vali Loss: 0.0292340 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 1.3459279537200928
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0078271  Vali Loss: 0.0292533 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 1.345975637435913
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0069253  Vali Loss: 0.0292566 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 1.3475239276885986
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0075234  Vali Loss: 0.0292559 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 1.3457071781158447
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0071878  Vali Loss: 0.0292448 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932096  Test macro F1 0.9917343 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.469308614730835
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0084209  Vali Loss: 0.0282492 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
Validation loss decreased (inf --> 0.028249).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4653103351593018
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0075775  Vali Loss: 0.0288705 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4661917686462402
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0070252  Vali Loss: 0.0269254 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
new best score!!!!
Validation loss decreased (0.028249 --> 0.026925).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4680511951446533
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0076061  Vali Loss: 0.0325962 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915258  Vali macro F1 0.9912834 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.4667346477508545
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0094154  Vali Loss: 0.0254320 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
new best score!!!!
Validation loss decreased (0.026925 --> 0.025432).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.4664843082427979
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0074290  Vali Loss: 0.0262465 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4694528579711914
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0074292  Vali Loss: 0.0294117 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915258  Vali macro F1 0.9912834 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4664456844329834
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0061829  Vali Loss: 0.0278621 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.467667818069458
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0065044  Vali Loss: 0.0310041 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887386  Vali macro F1 0.9887843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.469160795211792
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0061189  Vali Loss: 0.0293758 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915199  Vali macro F1 0.9922740 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.4697470664978027
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0067609  Vali Loss: 0.0265546 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4678773880004883
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0073939  Vali Loss: 0.0337703 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887033  Vali macro F1 0.9891242 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.46736741065979
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0075244  Vali Loss: 0.0315489 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887386  Vali macro F1 0.9887843 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.4661238193511963
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0053749  Vali Loss: 0.0272078 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4676120281219482
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0050270  Vali Loss: 0.0283960 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887033  Vali macro F1 0.9891242 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 1.4648897647857666
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0053405  Vali Loss: 0.0279973 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887033  Vali macro F1 0.9891242 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.4664883613586426
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0051801  Vali Loss: 0.0273594 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887033  Vali macro F1 0.9891242 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.4654641151428223
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0050069  Vali Loss: 0.0273667 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915258  Vali macro F1 0.9912834 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.4676237106323242
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0052664  Vali Loss: 0.0274958 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887033  Vali macro F1 0.9891242 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.4685938358306885
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0046505  Vali Loss: 0.0275341 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887033  Vali macro F1 0.9891242 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932096  Test macro F1 0.9917343 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00289855 0.0023753  0.00243309 0.00328947 0.00584795 0.00581395
 0.00306748 0.00289855 0.002331   0.00383142]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.341672658920288
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1727571  Vali Loss: 1.7651348 Vali Accuracy: 0.3587571  Vali weighted F1: 0.3273246  Vali macro F1 0.2845961 
Validation loss decreased (inf --> 1.765135).  Saving model ...
Epoch: 2 cost time: 1.3372538089752197
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.3859276  Vali Loss: 0.8981497 Vali Accuracy: 0.7033898  Vali weighted F1: 0.6841535  Vali macro F1 0.6553226 
new best score!!!!
Validation loss decreased (1.765135 --> 0.898150).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3383874893188477
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8507641  Vali Loss: 0.6017339 Vali Accuracy: 0.7824859  Vali weighted F1: 0.7716962  Vali macro F1 0.7343853 
new best score!!!!
Validation loss decreased (0.898150 --> 0.601734).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3402099609375
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5823010  Vali Loss: 0.4642829 Vali Accuracy: 0.8022599  Vali weighted F1: 0.7840731  Vali macro F1 0.7520602 
new best score!!!!
Validation loss decreased (0.601734 --> 0.464283).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3417692184448242
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4334617  Vali Loss: 0.3466182 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8266923  Vali macro F1 0.7936321 
new best score!!!!
Validation loss decreased (0.464283 --> 0.346618).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3447504043579102
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3431902  Vali Loss: 0.2871676 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8796475  Vali macro F1 0.8481333 
new best score!!!!
Validation loss decreased (0.346618 --> 0.287168).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3441076278686523
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2845100  Vali Loss: 0.2633546 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8791475  Vali macro F1 0.8485305 
new best score!!!!
Validation loss decreased (0.287168 --> 0.263355).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.344172716140747
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2537118  Vali Loss: 0.2335887 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8999813  Vali macro F1 0.8797076 
new best score!!!!
Validation loss decreased (0.263355 --> 0.233589).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3459689617156982
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2311445  Vali Loss: 0.2186302 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8967641  Vali macro F1 0.8563800 
new best score!!!!
Validation loss decreased (0.233589 --> 0.218630).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.350856065750122
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1997680  Vali Loss: 0.1902511 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8791467  Vali macro F1 0.8350254 
new best score!!!!
Validation loss decreased (0.218630 --> 0.190251).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3448808193206787
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1781163  Vali Loss: 0.1698310 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9088284  Vali macro F1 0.8743040 
new best score!!!!
Validation loss decreased (0.190251 --> 0.169831).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3635752201080322
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1645630  Vali Loss: 0.1467841 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9372779  Vali macro F1 0.9068424 
new best score!!!!
Validation loss decreased (0.169831 --> 0.146784).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3446977138519287
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1512600  Vali Loss: 0.1435139 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9464746  Vali macro F1 0.9282064 
new best score!!!!
Validation loss decreased (0.146784 --> 0.143514).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3429155349731445
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1461454  Vali Loss: 0.1357475 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8902025  Vali macro F1 0.8477767 
new best score!!!!
Validation loss decreased (0.143514 --> 0.135747).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3458073139190674
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1322142  Vali Loss: 0.1416789 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9323729  Vali macro F1 0.9069478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.342188835144043
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1247446  Vali Loss: 0.1355865 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9456364  Vali macro F1 0.9232147 
new best score!!!!
Validation loss decreased (0.135747 --> 0.135586).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3433029651641846
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1138751  Vali Loss: 0.1325403 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9433696  Vali macro F1 0.9203829 
new best score!!!!
Validation loss decreased (0.135586 --> 0.132540).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3451740741729736
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1119703  Vali Loss: 0.1364227 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9045617  Vali macro F1 0.8658515 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3396027088165283
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1000455  Vali Loss: 0.1294138 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9419339  Vali macro F1 0.9209368 
new best score!!!!
Validation loss decreased (0.132540 --> 0.129414).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.343001365661621
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0927077  Vali Loss: 0.1171179 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9470304  Vali macro F1 0.9260136 
new best score!!!!
Validation loss decreased (0.129414 --> 0.117118).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3407068252563477
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0867497  Vali Loss: 0.1095729 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9574172  Vali macro F1 0.9432214 
new best score!!!!
Validation loss decreased (0.117118 --> 0.109573).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3416216373443604
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0813096  Vali Loss: 0.1036358 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9599145  Vali macro F1 0.9450387 
new best score!!!!
Validation loss decreased (0.109573 --> 0.103636).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.341766357421875
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0848354  Vali Loss: 0.0913441 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773777  Vali macro F1 0.9699187 
new best score!!!!
Validation loss decreased (0.103636 --> 0.091344).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.34089994430542
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0838946  Vali Loss: 0.0887060 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718100  Vali macro F1 0.9672453 
new best score!!!!
Validation loss decreased (0.091344 --> 0.088706).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.344874620437622
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0663227  Vali Loss: 0.0725078 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745013  Vali macro F1 0.9639813 
new best score!!!!
Validation loss decreased (0.088706 --> 0.072508).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3426463603973389
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0579077  Vali Loss: 0.0671223 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831158  Vali macro F1 0.9788341 
new best score!!!!
Validation loss decreased (0.072508 --> 0.067122).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3433620929718018
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0658103  Vali Loss: 0.1100503 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9547028  Vali macro F1 0.9326951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3424899578094482
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0708824  Vali Loss: 0.0907431 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9536224  Vali macro F1 0.9358151 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3478097915649414
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0700490  Vali Loss: 0.0778077 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9682727  Vali macro F1 0.9584540 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.3425793647766113
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0585346  Vali Loss: 0.0601921 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831107  Vali macro F1 0.9801202 
new best score!!!!
Validation loss decreased (0.067122 --> 0.060192).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3427503108978271
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0495420  Vali Loss: 0.1085870 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9507655  Vali macro F1 0.9335983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3421273231506348
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0517965  Vali Loss: 0.0764794 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9629730  Vali macro F1 0.9502442 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.3413488864898682
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0395094  Vali Loss: 0.0508917 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801327  Vali macro F1 0.9789274 
new best score!!!!
Validation loss decreased (0.060192 --> 0.050892).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3440585136413574
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0288800  Vali Loss: 0.0500618 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876501 
new best score!!!!
Validation loss decreased (0.050892 --> 0.050062).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3445513248443604
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0228832  Vali Loss: 0.0443425 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858705  Vali macro F1 0.9852627 
new best score!!!!
Validation loss decreased (0.050062 --> 0.044342).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3434653282165527
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0255797  Vali Loss: 0.0596771 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745977  Vali macro F1 0.9679131 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.343189001083374
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0294412  Vali Loss: 0.0709166 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687470  Vali macro F1 0.9572014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3388926982879639
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0254775  Vali Loss: 0.0446646 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886926  Vali macro F1 0.9876420 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3430218696594238
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0201125  Vali Loss: 0.0418271 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859378  Vali macro F1 0.9875131 
new best score!!!!
Validation loss decreased (0.044342 --> 0.041827).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3432366847991943
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0201324  Vali Loss: 0.0428119 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886806  Vali macro F1 0.9875763 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3576676845550537
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0172675  Vali Loss: 0.0386547 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914880  Vali macro F1 0.9912058 
new best score!!!!
Validation loss decreased (0.041827 --> 0.038655).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3449161052703857
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0139454  Vali Loss: 0.0499003 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775545  Vali macro F1 0.9731529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3447697162628174
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0168332  Vali Loss: 0.0422439 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831791  Vali macro F1 0.9790385 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3419830799102783
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0134183  Vali Loss: 0.0381888 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831285  Vali macro F1 0.9797676 
new best score!!!!
Validation loss decreased (0.038655 --> 0.038189).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3421595096588135
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0134021  Vali Loss: 0.0790374 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744256  Vali macro F1 0.9722549 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.344686508178711
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0320822  Vali Loss: 0.0610887 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858848  Vali macro F1 0.9856582 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.3483490943908691
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0216799  Vali Loss: 0.0367977 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858444  Vali macro F1 0.9856708 
new best score!!!!
Validation loss decreased (0.038189 --> 0.036798).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3439912796020508
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0185393  Vali Loss: 0.0327374 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920499 
new best score!!!!
Validation loss decreased (0.036798 --> 0.032737).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.347125768661499
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0169769  Vali Loss: 0.0457550 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803229  Vali macro F1 0.9806555 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3445351123809814
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0113330  Vali Loss: 0.0379881 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859292  Vali macro F1 0.9875552 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3452625274658203
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0108709  Vali Loss: 0.0386907 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886887  Vali macro F1 0.9896625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3404650688171387
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0108787  Vali Loss: 0.0306798 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920499 
new best score!!!!
Validation loss decreased (0.032737 --> 0.030680).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.3376660346984863
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0085654  Vali Loss: 0.0430541 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887342  Vali macro F1 0.9887378 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.339357614517212
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0072700  Vali Loss: 0.0437020 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914880  Vali macro F1 0.9912058 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3414015769958496
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0082100  Vali Loss: 0.0407185 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.3415000438690186
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0061288  Vali Loss: 0.0432365 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858236  Vali macro F1 0.9852875 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.3408002853393555
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0047253  Vali Loss: 0.0479682 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858775  Vali macro F1 0.9840216 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 58 cost time: 1.3416337966918945
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0043720  Vali Loss: 0.0438647 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886300  Vali macro F1 0.9883053 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3383708000183105
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0040686  Vali Loss: 0.0431252 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886300  Vali macro F1 0.9883053 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.3394920825958252
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0045284  Vali Loss: 0.0421734 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.3408303260803223
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0044927  Vali Loss: 0.0417288 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.341597557067871
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0041369  Vali Loss: 0.0409256 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 63 cost time: 1.3390967845916748
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0044225  Vali Loss: 0.0409882 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.3394100666046143
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0038966  Vali Loss: 0.0408865 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.3411059379577637
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0044202  Vali Loss: 0.0408924 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.3407797813415527
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0042888  Vali Loss: 0.0410675 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.345285415649414
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0050441  Vali Loss: 0.0409520 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914972  Vali macro F1 0.9907261 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9966063  Test weighted F1: 0.9966094  Test macro F1 0.9956310 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4539806842803955
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0073089  Vali Loss: 0.0306814 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943408  Vali macro F1 0.9944305 
Validation loss decreased (inf --> 0.030681).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.456061601638794
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0063835  Vali Loss: 0.0355301 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859044  Vali macro F1 0.9851420 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4584741592407227
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0065575  Vali Loss: 0.0333569 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9900307 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4539365768432617
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0070795  Vali Loss: 0.0309632 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943408  Vali macro F1 0.9944305 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.454106092453003
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0056392  Vali Loss: 0.0314528 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943408  Vali macro F1 0.9944305 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.4548239707946777
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0063131  Vali Loss: 0.0359182 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943408  Vali macro F1 0.9944305 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.455622911453247
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0051171  Vali Loss: 0.0376200 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914880  Vali macro F1 0.9912058 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4523494243621826
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0051307  Vali Loss: 0.0421160 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887447  Vali macro F1 0.9864424 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.452791690826416
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0045142  Vali Loss: 0.0373290 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943408  Vali macro F1 0.9944305 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4559104442596436
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0049535  Vali Loss: 0.0412570 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859281  Vali macro F1 0.9832926 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.453805923461914
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0041373  Vali Loss: 0.0404452 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9900307 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4531469345092773
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0035159  Vali Loss: 0.0400018 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9900307 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4518282413482666
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0035812  Vali Loss: 0.0398276 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9900307 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.4538731575012207
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0056560  Vali Loss: 0.0391435 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943408  Vali macro F1 0.9944305 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4548771381378174
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0038938  Vali Loss: 0.0392590 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943408  Vali macro F1 0.9944305 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.4541542530059814
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0039168  Vali Loss: 0.0392523 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943408  Vali macro F1 0.9944305 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9988688  Test weighted F1: 0.9988721  Test macro F1 0.9985206 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00274725 0.00243309 0.00232558 0.00318471 0.00578035 0.00609756
 0.00320513 0.00299401 0.002331   0.00393701]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3348009586334229
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1711186  Vali Loss: 1.7843972 Vali Accuracy: 0.3672316  Vali weighted F1: 0.3265319  Vali macro F1 0.2831460 
Validation loss decreased (inf --> 1.784397).  Saving model ...
Epoch: 2 cost time: 1.3380300998687744
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4027012  Vali Loss: 0.9581721 Vali Accuracy: 0.6694915  Vali weighted F1: 0.6467667  Vali macro F1 0.6211721 
new best score!!!!
Validation loss decreased (1.784397 --> 0.958172).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3374741077423096
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8531059  Vali Loss: 0.6493113 Vali Accuracy: 0.7683616  Vali weighted F1: 0.7659991  Vali macro F1 0.7436629 
new best score!!!!
Validation loss decreased (0.958172 --> 0.649311).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3389053344726562
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5892604  Vali Loss: 0.4867913 Vali Accuracy: 0.8107345  Vali weighted F1: 0.8023489  Vali macro F1 0.7753636 
new best score!!!!
Validation loss decreased (0.649311 --> 0.486791).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3388659954071045
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4471592  Vali Loss: 0.3608214 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8728717  Vali macro F1 0.8498331 
new best score!!!!
Validation loss decreased (0.486791 --> 0.360821).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.335270643234253
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3476967  Vali Loss: 0.2903481 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8538594  Vali macro F1 0.8159009 
new best score!!!!
Validation loss decreased (0.360821 --> 0.290348).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.338794231414795
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2896287  Vali Loss: 0.2475406 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8831110  Vali macro F1 0.8583347 
new best score!!!!
Validation loss decreased (0.290348 --> 0.247541).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3361563682556152
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2478233  Vali Loss: 0.2243021 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8922491  Vali macro F1 0.8680783 
new best score!!!!
Validation loss decreased (0.247541 --> 0.224302).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3375887870788574
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2178933  Vali Loss: 0.2229394 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9225861  Vali macro F1 0.9058295 
new best score!!!!
Validation loss decreased (0.224302 --> 0.222939).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3369104862213135
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1948947  Vali Loss: 0.1978466 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8675820  Vali macro F1 0.8254963 
new best score!!!!
Validation loss decreased (0.222939 --> 0.197847).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.343132495880127
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1677966  Vali Loss: 0.1533894 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9042151  Vali macro F1 0.8684269 
new best score!!!!
Validation loss decreased (0.197847 --> 0.153389).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3365497589111328
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1518011  Vali Loss: 0.1555691 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8861948  Vali macro F1 0.8436699 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.354768991470337
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1508619  Vali Loss: 0.1435970 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9236407  Vali macro F1 0.8807529 
new best score!!!!
Validation loss decreased (0.153389 --> 0.143597).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3386211395263672
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1343334  Vali Loss: 0.1384400 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9269113  Vali macro F1 0.8881693 
new best score!!!!
Validation loss decreased (0.143597 --> 0.138440).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.337129831314087
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1174673  Vali Loss: 0.1435258 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9385388  Vali macro F1 0.9124367 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3379590511322021
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1119690  Vali Loss: 0.1429639 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9316219  Vali macro F1 0.8947288 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 1.338141679763794
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1059278  Vali Loss: 0.1225251 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630853  Vali macro F1 0.9470989 
new best score!!!!
Validation loss decreased (0.138440 --> 0.122525).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3363871574401855
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1013494  Vali Loss: 0.1312831 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9549659  Vali macro F1 0.9364678 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3364458084106445
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0943411  Vali Loss: 0.1341056 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9146765  Vali macro F1 0.8802442 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.3346261978149414
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0915108  Vali Loss: 0.1526407 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8962121  Vali macro F1 0.8571741 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 1.338224172592163
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1158543  Vali Loss: 0.1562698 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9318414  Vali macro F1 0.9053594 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 1.3372364044189453
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1186082  Vali Loss: 0.1342102 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9266595  Vali macro F1 0.8996956 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 1.3374121189117432
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0940703  Vali Loss: 0.1215170 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9515452  Vali macro F1 0.9321190 
new best score!!!!
Validation loss decreased (0.122525 --> 0.121517).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3386495113372803
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0886241  Vali Loss: 0.1158761 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9548306  Vali macro F1 0.9373760 
new best score!!!!
Validation loss decreased (0.121517 --> 0.115876).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3361413478851318
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0833210  Vali Loss: 0.1132456 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9520402  Vali macro F1 0.9352432 
new best score!!!!
Validation loss decreased (0.115876 --> 0.113246).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3365097045898438
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0810620  Vali Loss: 0.1127255 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9518870  Vali macro F1 0.9332256 
new best score!!!!
Validation loss decreased (0.113246 --> 0.112726).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3376266956329346
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0777107  Vali Loss: 0.1108582 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9518870  Vali macro F1 0.9332256 
new best score!!!!
Validation loss decreased (0.112726 --> 0.110858).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3415553569793701
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0768822  Vali Loss: 0.1061331 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662230  Vali macro F1 0.9536929 
new best score!!!!
Validation loss decreased (0.110858 --> 0.106133).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.337719202041626
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0761854  Vali Loss: 0.1081761 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9548375  Vali macro F1 0.9365666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3390824794769287
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0735887  Vali Loss: 0.1058654 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9577358  Vali macro F1 0.9408918 
new best score!!!!
Validation loss decreased (0.106133 --> 0.105865).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3394255638122559
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0722850  Vali Loss: 0.1030593 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662390  Vali macro F1 0.9526357 
new best score!!!!
Validation loss decreased (0.105865 --> 0.103059).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3387088775634766
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0734790  Vali Loss: 0.1025373 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9577358  Vali macro F1 0.9408918 
new best score!!!!
Validation loss decreased (0.103059 --> 0.102537).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3386478424072266
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0717285  Vali Loss: 0.0998720 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605942  Vali macro F1 0.9451799 
new best score!!!!
Validation loss decreased (0.102537 --> 0.099872).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3377742767333984
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0718398  Vali Loss: 0.1000704 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9575595  Vali macro F1 0.9408918 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.339942455291748
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0675213  Vali Loss: 0.0951365 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9634207  Vali macro F1 0.9494429 
new best score!!!!
Validation loss decreased (0.099872 --> 0.095137).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3365039825439453
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0651367  Vali Loss: 0.0966738 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9690462  Vali macro F1 0.9581757 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3467769622802734
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0651177  Vali Loss: 0.0926814 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9690091  Vali macro F1 0.9579419 
new best score!!!!
Validation loss decreased (0.095137 --> 0.092681).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3367087841033936
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0650635  Vali Loss: 0.0936785 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604872  Vali macro F1 0.9452623 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.3399558067321777
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0646865  Vali Loss: 0.0929612 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632279  Vali macro F1 0.9495916 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.343773365020752
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0645162  Vali Loss: 0.0908788 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9690462  Vali macro F1 0.9581757 
new best score!!!!
Validation loss decreased (0.092681 --> 0.090879).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3419394493103027
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0631301  Vali Loss: 0.0888242 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9690462  Vali macro F1 0.9581757 
new best score!!!!
Validation loss decreased (0.090879 --> 0.088824).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.345850944519043
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0596527  Vali Loss: 0.0883831 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632279  Vali macro F1 0.9495916 
new best score!!!!
Validation loss decreased (0.088824 --> 0.088383).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3374156951904297
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0574183  Vali Loss: 0.0865413 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718508  Vali macro F1 0.9626042 
new best score!!!!
Validation loss decreased (0.088383 --> 0.086541).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3372180461883545
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0568540  Vali Loss: 0.0853423 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746718  Vali macro F1 0.9669085 
new best score!!!!
Validation loss decreased (0.086541 --> 0.085342).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3399970531463623
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0578550  Vali Loss: 0.0852157 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717866  Vali macro F1 0.9626536 
new best score!!!!
Validation loss decreased (0.085342 --> 0.085216).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3378374576568604
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0576154  Vali Loss: 0.0859693 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659657  Vali macro F1 0.9538920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3351478576660156
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0553452  Vali Loss: 0.0844041 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688963  Vali macro F1 0.9582913 
new best score!!!!
Validation loss decreased (0.085216 --> 0.084404).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.334721326828003
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0544634  Vali Loss: 0.0749967 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774794  Vali macro F1 0.9712167 
new best score!!!!
Validation loss decreased (0.084404 --> 0.074997).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3366594314575195
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0518884  Vali Loss: 0.0784978 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3377842903137207
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0501382  Vali Loss: 0.0753506 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802974  Vali macro F1 0.9756413 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3364169597625732
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0520585  Vali Loss: 0.0937355 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9599491  Vali macro F1 0.9449310 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.336414098739624
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0511066  Vali Loss: 0.0757194 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717866  Vali macro F1 0.9626536 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.3350508213043213
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0468931  Vali Loss: 0.0759124 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717866  Vali macro F1 0.9626536 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 1.3370890617370605
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0470345  Vali Loss: 0.0765213 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717866  Vali macro F1 0.9626536 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3364946842193604
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0465029  Vali Loss: 0.0728888 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
new best score!!!!
Validation loss decreased (0.074997 --> 0.072889).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.3334970474243164
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0486228  Vali Loss: 0.0701151 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802974  Vali macro F1 0.9756413 
new best score!!!!
Validation loss decreased (0.072889 --> 0.070115).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.3342599868774414
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0476298  Vali Loss: 0.0719721 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.3368027210235596
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0440759  Vali Loss: 0.0707241 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.3357555866241455
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0491354  Vali Loss: 0.0703845 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 1.3361766338348389
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0458568  Vali Loss: 0.0706180 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 1.3360068798065186
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0490325  Vali Loss: 0.0709089 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 1.337442398071289
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0449050  Vali Loss: 0.0709632 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.3347382545471191
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0458538  Vali Loss: 0.0708884 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.3364062309265137
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0443167  Vali Loss: 0.0707883 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.3422060012817383
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0444455  Vali Loss: 0.0707230 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.3415873050689697
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0470111  Vali Loss: 0.0704966 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 67 cost time: 1.3335845470428467
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0466585  Vali Loss: 0.0705309 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.3423240184783936
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0447077  Vali Loss: 0.0705299 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.3405578136444092
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0465230  Vali Loss: 0.0705342 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.3510706424713135
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0466028  Vali Loss: 0.0705509 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 1.3393957614898682
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0453297  Vali Loss: 0.0705392 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9739819  Test weighted F1: 0.9735600  Test macro F1 0.9628494 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.455183506011963
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0489769  Vali Loss: 0.0636706 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
Validation loss decreased (inf --> 0.063671).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4526867866516113
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0466959  Vali Loss: 0.0702991 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.451782464981079
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0458544  Vali Loss: 0.0830299 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659657  Vali macro F1 0.9538920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.455312967300415
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0431896  Vali Loss: 0.0627162 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
new best score!!!!
Validation loss decreased (0.063671 --> 0.062716).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4557456970214844
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0403737  Vali Loss: 0.0755995 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688963  Vali macro F1 0.9582913 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.457298755645752
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0386113  Vali Loss: 0.0630881 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774792  Vali macro F1 0.9713163 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.4533460140228271
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0397253  Vali Loss: 0.0665332 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717866  Vali macro F1 0.9626536 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 1.4561128616333008
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0391875  Vali Loss: 0.0570661 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
new best score!!!!
Validation loss decreased (0.062716 --> 0.057066).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.4521117210388184
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0364967  Vali Loss: 0.0559924 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
new best score!!!!
Validation loss decreased (0.057066 --> 0.055992).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.4531400203704834
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0339544  Vali Loss: 0.0473143 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
new best score!!!!
Validation loss decreased (0.055992 --> 0.047314).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.4529476165771484
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0326511  Vali Loss: 0.0552781 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4550061225891113
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0334122  Vali Loss: 0.0572736 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802974  Vali macro F1 0.9756413 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4554321765899658
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0328167  Vali Loss: 0.0493584 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.4557387828826904
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0315624  Vali Loss: 0.0560920 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718560  Vali macro F1 0.9648049 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4546315670013428
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0291572  Vali Loss: 0.0557479 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746449  Vali macro F1 0.9669911 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 1.4574453830718994
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0292153  Vali Loss: 0.0411340 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
new best score!!!!
Validation loss decreased (0.047314 --> 0.041134).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.453723669052124
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0263405  Vali Loss: 0.0572876 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746903  Vali macro F1 0.9691300 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.453986406326294
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0249833  Vali Loss: 0.0508068 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802974  Vali macro F1 0.9756413 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.4544949531555176
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0253167  Vali Loss: 0.0454592 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.4547109603881836
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0264569  Vali Loss: 0.0464430 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859177  Vali macro F1 0.9843407 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.4560959339141846
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0279637  Vali Loss: 0.0482739 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 1.4539854526519775
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0262425  Vali Loss: 0.0490689 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.4559135437011719
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0236648  Vali Loss: 0.0486239 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 1.4545273780822754
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0256665  Vali Loss: 0.0473159 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 1.4538609981536865
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0250772  Vali Loss: 0.0452799 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 1.460306167602539
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0231346  Vali Loss: 0.0461102 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 1.454374074935913
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0235114  Vali Loss: 0.0459478 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 1.4553017616271973
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0232505  Vali Loss: 0.0458796 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 1.452282190322876
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0223903  Vali Loss: 0.0457775 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 1.4534740447998047
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0220476  Vali Loss: 0.0458300 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 1.4539363384246826
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0213475  Vali Loss: 0.0459770 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831076  Vali macro F1 0.9799786 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9807692  Test weighted F1: 0.9807386  Test macro F1 0.9761879 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00280899 0.0023753  0.00248139 0.00325733 0.00568182 0.00568182
 0.00302115 0.00291545 0.00233645 0.00409836]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3404028415679932
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1719460  Vali Loss: 1.7815288 Vali Accuracy: 0.3757062  Vali weighted F1: 0.3421119  Vali macro F1 0.2980686 
Validation loss decreased (inf --> 1.781529).  Saving model ...
Epoch: 2 cost time: 1.3378081321716309
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4056507  Vali Loss: 0.9365403 Vali Accuracy: 0.7005650  Vali weighted F1: 0.6898331  Vali macro F1 0.6610595 
new best score!!!!
Validation loss decreased (1.781529 --> 0.936540).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3389792442321777
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8459624  Vali Loss: 0.6526290 Vali Accuracy: 0.7401130  Vali weighted F1: 0.7278645  Vali macro F1 0.6977681 
new best score!!!!
Validation loss decreased (0.936540 --> 0.652629).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3387598991394043
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5927132  Vali Loss: 0.4712128 Vali Accuracy: 0.8192090  Vali weighted F1: 0.7998262  Vali macro F1 0.7647194 
new best score!!!!
Validation loss decreased (0.652629 --> 0.471213).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3382930755615234
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4400964  Vali Loss: 0.3500823 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8661636  Vali macro F1 0.8462061 
new best score!!!!
Validation loss decreased (0.471213 --> 0.350082).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3392462730407715
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3425582  Vali Loss: 0.2956373 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8490516  Vali macro F1 0.8201057 
new best score!!!!
Validation loss decreased (0.350082 --> 0.295637).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3414342403411865
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2797791  Vali Loss: 0.2436856 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8948785  Vali macro F1 0.8728203 
new best score!!!!
Validation loss decreased (0.295637 --> 0.243686).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3379793167114258
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2380015  Vali Loss: 0.2333688 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8954952  Vali macro F1 0.8761334 
new best score!!!!
Validation loss decreased (0.243686 --> 0.233369).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3370084762573242
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2044472  Vali Loss: 0.1887638 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9170853  Vali macro F1 0.8856373 
new best score!!!!
Validation loss decreased (0.233369 --> 0.188764).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3367609977722168
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1796708  Vali Loss: 0.1800660 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8806337  Vali macro F1 0.8383610 
new best score!!!!
Validation loss decreased (0.188764 --> 0.180066).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.337918996810913
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1654825  Vali Loss: 0.1817956 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8846150  Vali macro F1 0.8423180 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.3365280628204346
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1555094  Vali Loss: 0.1641167 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8851738  Vali macro F1 0.8470166 
new best score!!!!
Validation loss decreased (0.180066 --> 0.164117).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3367459774017334
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1444347  Vali Loss: 0.1459558 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9205293  Vali macro F1 0.8839566 
new best score!!!!
Validation loss decreased (0.164117 --> 0.145956).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.337632417678833
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1342675  Vali Loss: 0.1414099 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9146552  Vali macro F1 0.8641555 
new best score!!!!
Validation loss decreased (0.145956 --> 0.141410).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3378028869628906
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1349908  Vali Loss: 0.1335484 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8930866  Vali macro F1 0.8501472 
new best score!!!!
Validation loss decreased (0.141410 --> 0.133548).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3380310535430908
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1241999  Vali Loss: 0.1257206 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9119697  Vali macro F1 0.8738921 
new best score!!!!
Validation loss decreased (0.133548 --> 0.125721).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3351483345031738
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1097661  Vali Loss: 0.1248769 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9091452  Vali macro F1 0.8715094 
new best score!!!!
Validation loss decreased (0.125721 --> 0.124877).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3359930515289307
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1033863  Vali Loss: 0.1306865 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9589901  Vali macro F1 0.9400141 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3417372703552246
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1059322  Vali Loss: 0.1290881 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9389084  Vali macro F1 0.9123761 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.3471195697784424
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1035889  Vali Loss: 0.1270557 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9455324  Vali macro F1 0.9235571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 1.3428099155426025
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0989924  Vali Loss: 0.1258312 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9466332  Vali macro F1 0.9279075 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 1.35121750831604
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0878987  Vali Loss: 0.1225491 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9129391  Vali macro F1 0.8769743 
new best score!!!!
Validation loss decreased (0.124877 --> 0.122549).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.34564208984375
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0859730  Vali Loss: 0.1198230 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9366040  Vali macro F1 0.9018264 
new best score!!!!
Validation loss decreased (0.122549 --> 0.119823).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3440089225769043
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0876396  Vali Loss: 0.1109658 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631215  Vali macro F1 0.9513843 
new best score!!!!
Validation loss decreased (0.119823 --> 0.110966).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3361265659332275
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0732531  Vali Loss: 0.1157300 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9532104  Vali macro F1 0.9341609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3355965614318848
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0732963  Vali Loss: 0.1664489 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9078232  Vali macro F1 0.8717841 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 1.3354477882385254
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0857294  Vali Loss: 0.1137403 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9568450  Vali macro F1 0.9403426 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 1.3370490074157715
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0731549  Vali Loss: 0.1019191 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9455531  Vali macro F1 0.9168750 
new best score!!!!
Validation loss decreased (0.110966 --> 0.101919).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3373453617095947
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0736267  Vali Loss: 0.1115497 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9481341  Vali macro F1 0.9291768 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3396944999694824
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0660479  Vali Loss: 0.0819611 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770030  Vali macro F1 0.9689919 
new best score!!!!
Validation loss decreased (0.101919 --> 0.081961).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3411734104156494
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0534624  Vali Loss: 0.0993974 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9564450  Vali macro F1 0.9389726 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3404037952423096
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0392252  Vali Loss: 0.0502389 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943324  Vali macro F1 0.9923636 
new best score!!!!
Validation loss decreased (0.081961 --> 0.050239).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3411877155303955
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0300085  Vali Loss: 0.0974391 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9564825  Vali macro F1 0.9388563 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3360495567321777
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0344128  Vali Loss: 0.0478369 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887197  Vali macro F1 0.9874824 
new best score!!!!
Validation loss decreased (0.050239 --> 0.047837).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.335998296737671
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0265335  Vali Loss: 0.0547777 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830896  Vali macro F1 0.9814323 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.337646484375
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0292360  Vali Loss: 0.0725379 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717131  Vali macro F1 0.9614814 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3369841575622559
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0280574  Vali Loss: 0.0702335 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717171  Vali macro F1 0.9616504 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3396861553192139
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0199327  Vali Loss: 0.0604378 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831142  Vali macro F1 0.9788314 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 1.3370225429534912
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0227714  Vali Loss: 0.0449420 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920499 
new best score!!!!
Validation loss decreased (0.047837 --> 0.044942).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3430523872375488
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0233833  Vali Loss: 0.0460255 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876501 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.344573974609375
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0224773  Vali Loss: 0.0390548 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876501 
new best score!!!!
Validation loss decreased (0.044942 --> 0.039055).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.343611478805542
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0153455  Vali Loss: 0.0422174 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3431205749511719
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0136972  Vali Loss: 0.0484141 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830351  Vali macro F1 0.9805831 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3359649181365967
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0137928  Vali Loss: 0.0344726 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
new best score!!!!
Validation loss decreased (0.039055 --> 0.034473).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3410651683807373
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0112423  Vali Loss: 0.0554428 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859177  Vali macro F1 0.9843407 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3350193500518799
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0171931  Vali Loss: 0.0325344 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887197  Vali macro F1 0.9874824 
new best score!!!!
Validation loss decreased (0.034473 --> 0.032534).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3376054763793945
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0139230  Vali Loss: 0.0419463 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859105  Vali macro F1 0.9863572 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3379731178283691
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0149590  Vali Loss: 0.0279094 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915464  Vali macro F1 0.9920726 
new best score!!!!
Validation loss decreased (0.032534 --> 0.027909).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3427188396453857
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0126185  Vali Loss: 0.0330894 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859108  Vali macro F1 0.9851501 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3354179859161377
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0123943  Vali Loss: 0.0319110 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915167  Vali macro F1 0.9920495 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3567147254943848
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0118368  Vali Loss: 0.0396273 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887361  Vali macro F1 0.9875334 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3379921913146973
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0078461  Vali Loss: 0.0249139 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
new best score!!!!
Validation loss decreased (0.027909 --> 0.024914).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.3385915756225586
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0098434  Vali Loss: 0.0216837 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971668  Vali macro F1 0.9968145 
new best score!!!!
Validation loss decreased (0.024914 --> 0.021684).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.3372879028320312
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0089611  Vali Loss: 0.0465294 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859469  Vali macro F1 0.9865543 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3362538814544678
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0160672  Vali Loss: 0.0364660 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887289  Vali macro F1 0.9895499 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.3374826908111572
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0122257  Vali Loss: 0.0217161 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915503  Vali macro F1 0.9920225 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.3370022773742676
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0117741  Vali Loss: 0.0292786 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9898633 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.3389239311218262
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0094130  Vali Loss: 0.0306603 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887653  Vali macro F1 0.9897470 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 59 cost time: 1.3387103080749512
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0064587  Vali Loss: 0.0321430 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887653  Vali macro F1 0.9897470 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.3383312225341797
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0060625  Vali Loss: 0.0334501 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887653  Vali macro F1 0.9897470 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.3396179676055908
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0059070  Vali Loss: 0.0343947 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859408  Vali macro F1 0.9873644 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.3365795612335205
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0057931  Vali Loss: 0.0323681 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859408  Vali macro F1 0.9873644 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.3384745121002197
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0048071  Vali Loss: 0.0317626 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859408  Vali macro F1 0.9873644 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 64 cost time: 1.3352985382080078
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0054695  Vali Loss: 0.0317425 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859408  Vali macro F1 0.9873644 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.3387489318847656
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0045136  Vali Loss: 0.0317462 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859408  Vali macro F1 0.9873644 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.3380188941955566
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0050382  Vali Loss: 0.0318105 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859408  Vali macro F1 0.9873644 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 1.3388383388519287
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0049963  Vali Loss: 0.0318240 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859408  Vali macro F1 0.9873644 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 1.3372273445129395
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0055852  Vali Loss: 0.0318662 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859408  Vali macro F1 0.9873644 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886766  Test macro F1 0.9845350 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4707372188568115
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0072829  Vali Loss: 0.0224196 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971668  Vali macro F1 0.9968145 
Validation loss decreased (inf --> 0.022420).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4711380004882812
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0066295  Vali Loss: 0.0229611 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943487  Vali macro F1 0.9924147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.469419240951538
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0063787  Vali Loss: 0.0200271 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971668  Vali macro F1 0.9968145 
new best score!!!!
Validation loss decreased (0.022420 --> 0.020027).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4672605991363525
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0057487  Vali Loss: 0.0205506 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.4711143970489502
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0053417  Vali Loss: 0.0227792 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915605  Vali macro F1 0.9899147 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.4715237617492676
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0044954  Vali Loss: 0.0246941 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.4719340801239014
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0039715  Vali Loss: 0.0288218 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887361  Vali macro F1 0.9875334 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.4690392017364502
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0041299  Vali Loss: 0.0285679 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.4738903045654297
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0049857  Vali Loss: 0.0276723 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.4702355861663818
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0041898  Vali Loss: 0.0247082 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.4726343154907227
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0039143  Vali Loss: 0.0288323 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859472  Vali macro F1 0.9853472 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.470745325088501
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0038406  Vali Loss: 0.0230927 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.470731496810913
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0044923  Vali Loss: 0.0221764 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887653  Vali macro F1 0.9897470 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.469254493713379
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0040160  Vali Loss: 0.0225540 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887653  Vali macro F1 0.9897470 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.4698710441589355
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0032543  Vali Loss: 0.0227836 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887653  Vali macro F1 0.9897470 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.4711530208587646
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0046923  Vali Loss: 0.0228570 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887653  Vali macro F1 0.9897470 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.4712154865264893
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0035823  Vali Loss: 0.0227360 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887653  Vali macro F1 0.9897470 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.4682893753051758
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0036520  Vali Loss: 0.0231666 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859472  Vali macro F1 0.9853472 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909442  Test macro F1 0.9877448 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00282486 0.00235294 0.00242718 0.00328947 0.00549451 0.00552486
 0.00319489 0.00276243 0.00244499 0.00416667]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3456292152404785
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1660596  Vali Loss: 1.7624678 Vali Accuracy: 0.3841808  Vali weighted F1: 0.3453878  Vali macro F1 0.2854315 
Validation loss decreased (inf --> 1.762468).  Saving model ...
Epoch: 2 cost time: 1.3527092933654785
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.3943473  Vali Loss: 0.9188217 Vali Accuracy: 0.6751412  Vali weighted F1: 0.6536977  Vali macro F1 0.6313363 
new best score!!!!
Validation loss decreased (1.762468 --> 0.918822).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.4044134616851807
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8283333  Vali Loss: 0.5863057 Vali Accuracy: 0.8107345  Vali weighted F1: 0.8099741  Vali macro F1 0.7541618 
new best score!!!!
Validation loss decreased (0.918822 --> 0.586306).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.4039804935455322
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5696519  Vali Loss: 0.4029307 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8678614  Vali macro F1 0.7927391 
new best score!!!!
Validation loss decreased (0.586306 --> 0.402931).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3722074031829834
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4289842  Vali Loss: 0.3174005 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9132746  Vali macro F1 0.8835651 
new best score!!!!
Validation loss decreased (0.402931 --> 0.317400).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3832314014434814
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3303065  Vali Loss: 0.2617917 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8938495  Vali macro F1 0.8233597 
new best score!!!!
Validation loss decreased (0.317400 --> 0.261792).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3377633094787598
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2783287  Vali Loss: 0.1984443 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9512640  Vali macro F1 0.9063615 
new best score!!!!
Validation loss decreased (0.261792 --> 0.198444).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3379201889038086
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2485564  Vali Loss: 0.1774270 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9365642  Vali macro F1 0.9017479 
new best score!!!!
Validation loss decreased (0.198444 --> 0.177427).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3436298370361328
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2121660  Vali Loss: 0.1553557 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9337539  Vali macro F1 0.8538048 
new best score!!!!
Validation loss decreased (0.177427 --> 0.155356).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3398990631103516
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1801112  Vali Loss: 0.1353510 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9518915  Vali macro F1 0.9025860 
new best score!!!!
Validation loss decreased (0.155356 --> 0.135351).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3419525623321533
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1612938  Vali Loss: 0.1166110 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9595781  Vali macro F1 0.9130990 
new best score!!!!
Validation loss decreased (0.135351 --> 0.116611).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.345942497253418
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1434920  Vali Loss: 0.1030718 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9573192  Vali macro F1 0.8982013 
new best score!!!!
Validation loss decreased (0.116611 --> 0.103072).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3392102718353271
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1367974  Vali Loss: 0.1015394 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9525092  Vali macro F1 0.8991913 
new best score!!!!
Validation loss decreased (0.103072 --> 0.101539).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3439807891845703
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1378309  Vali Loss: 0.1012282 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9572694  Vali macro F1 0.9079378 
new best score!!!!
Validation loss decreased (0.101539 --> 0.101228).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3451135158538818
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1277451  Vali Loss: 0.1008338 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9450858  Vali macro F1 0.8632954 
new best score!!!!
Validation loss decreased (0.101228 --> 0.100834).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.343013048171997
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1282760  Vali Loss: 0.0782239 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9534840  Vali macro F1 0.8800000 
new best score!!!!
Validation loss decreased (0.100834 --> 0.078224).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3423588275909424
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1126045  Vali Loss: 0.0811833 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9623827  Vali macro F1 0.9129927 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3726840019226074
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1087057  Vali Loss: 0.0691690 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632799  Vali macro F1 0.9084697 
new best score!!!!
Validation loss decreased (0.078224 --> 0.069169).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3409621715545654
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1030369  Vali Loss: 0.0677285 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9737115  Vali macro F1 0.9405270 
new best score!!!!
Validation loss decreased (0.069169 --> 0.067729).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.359607458114624
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1137193  Vali Loss: 0.0611226 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858367  Vali macro F1 0.9627586 
new best score!!!!
Validation loss decreased (0.067729 --> 0.061123).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3442292213439941
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0941914  Vali Loss: 0.0596063 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770714  Vali macro F1 0.9444653 
new best score!!!!
Validation loss decreased (0.061123 --> 0.059606).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3440372943878174
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0867750  Vali Loss: 0.1024490 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9625623  Vali macro F1 0.9314338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3443512916564941
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0825592  Vali Loss: 0.0643169 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801977  Vali macro F1 0.9572533 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.3431427478790283
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0793177  Vali Loss: 0.0469661 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9824378  Vali macro F1 0.9586808 
new best score!!!!
Validation loss decreased (0.059606 --> 0.046966).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3437676429748535
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0702055  Vali Loss: 0.0501949 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858765  Vali macro F1 0.9679754 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.344848394393921
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0594664  Vali Loss: 0.0378174 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830508  Vali macro F1 0.9554945 
new best score!!!!
Validation loss decreased (0.046966 --> 0.037817).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3437650203704834
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0549774  Vali Loss: 0.0435067 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830473  Vali macro F1 0.9629712 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3432233333587646
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0524437  Vali Loss: 0.0298987 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
new best score!!!!
Validation loss decreased (0.037817 --> 0.029899).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3449616432189941
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0410265  Vali Loss: 0.0335256 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830150  Vali macro F1 0.9602393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.344785451889038
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0433935  Vali Loss: 0.0360439 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9888379  Vali macro F1 0.9733071 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.3424601554870605
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0510075  Vali Loss: 0.0378292 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9827287  Vali macro F1 0.9640259 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 1.3466532230377197
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0380478  Vali Loss: 0.0253812 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913828  Vali macro F1 0.9772791 
new best score!!!!
Validation loss decreased (0.029899 --> 0.025381).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3417003154754639
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0330315  Vali Loss: 0.0226657 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.025381 --> 0.022666).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3445603847503662
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0325670  Vali Loss: 0.0394250 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887037  Vali macro F1 0.9752585 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.3433678150177002
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0351120  Vali Loss: 0.0197075 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943456  Vali macro F1 0.9900324 
new best score!!!!
Validation loss decreased (0.022666 --> 0.019707).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3430774211883545
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0212391  Vali Loss: 0.0178502 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
new best score!!!!
Validation loss decreased (0.019707 --> 0.017850).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.343064546585083
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0185946  Vali Loss: 0.0189719 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913828  Vali macro F1 0.9772791 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3430497646331787
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0156288  Vali Loss: 0.0142896 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.017850 --> 0.014290).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3436875343322754
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0161325  Vali Loss: 0.0145038 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3438379764556885
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0148098  Vali Loss: 0.0140580 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.014290 --> 0.014058).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.343181848526001
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0205675  Vali Loss: 0.0174534 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913828  Vali macro F1 0.9772791 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.343005895614624
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0136270  Vali Loss: 0.0150623 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3433749675750732
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0129007  Vali Loss: 0.0172233 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943534  Vali macro F1 0.9900733 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.344411849975586
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0186424  Vali Loss: 0.0190737 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.343097448348999
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0192535  Vali Loss: 0.0163239 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971708  Vali macro F1 0.9972270 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 1.349071741104126
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0166811  Vali Loss: 0.0180054 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914741  Vali macro F1 0.9822270 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.343970775604248
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0104935  Vali Loss: 0.0127204 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
new best score!!!!
Validation loss decreased (0.014058 --> 0.012720).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3564398288726807
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0089611  Vali Loss: 0.0107269 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
new best score!!!!
Validation loss decreased (0.012720 --> 0.010727).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.346252679824829
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0086456  Vali Loss: 0.0114558 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3438971042633057
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0091078  Vali Loss: 0.0105001 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.010727 --> 0.010500).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.346001148223877
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0096077  Vali Loss: 0.0101474 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010500 --> 0.010147).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.3447160720825195
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0069390  Vali Loss: 0.0120989 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.3421547412872314
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0068027  Vali Loss: 0.0114620 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.3431599140167236
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0079737  Vali Loss: 0.0099379 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.010147 --> 0.009938).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.3431100845336914
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0069576  Vali Loss: 0.0101753 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.342766284942627
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0070738  Vali Loss: 0.0109806 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.3432579040527344
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0065598  Vali Loss: 0.0111554 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.3431193828582764
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0078121  Vali Loss: 0.0105224 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.3442697525024414
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0070771  Vali Loss: 0.0100643 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 1.3442773818969727
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0075056  Vali Loss: 0.0100172 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.3437929153442383
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0075459  Vali Loss: 0.0098917 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.009938 --> 0.009892).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.344783067703247
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0069319  Vali Loss: 0.0099267 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.3443503379821777
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0064020  Vali Loss: 0.0099727 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.3448591232299805
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0063185  Vali Loss: 0.0099827 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.3457908630371094
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0076211  Vali Loss: 0.0100331 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.3443377017974854
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0061188  Vali Loss: 0.0101080 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 67 cost time: 1.3449461460113525
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0062967  Vali Loss: 0.0101127 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.3511943817138672
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0068550  Vali Loss: 0.0101022 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.3445539474487305
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0071750  Vali Loss: 0.0100713 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.3465547561645508
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0078923  Vali Loss: 0.0100516 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 1.3452174663543701
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0063927  Vali Loss: 0.0100430 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 72 cost time: 1.345839023590088
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0071710  Vali Loss: 0.0100426 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 1.3452999591827393
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0069027  Vali Loss: 0.0100429 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 1.3453307151794434
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0064529  Vali Loss: 0.0100448 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 1.3508639335632324
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0071601  Vali Loss: 0.0100454 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 1.3459141254425049
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0076876  Vali Loss: 0.0100456 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9921082  Test weighted F1: 0.9921179  Test macro F1 0.9921186 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4790446758270264
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0077538  Vali Loss: 0.0116910 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
Validation loss decreased (inf --> 0.011691).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4679901599884033
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0060915  Vali Loss: 0.0129015 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913828  Vali macro F1 0.9772791 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4661140441894531
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0066557  Vali Loss: 0.0107598 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
new best score!!!!
Validation loss decreased (0.011691 --> 0.010760).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4672603607177734
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0064913  Vali Loss: 0.0100364 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.010760 --> 0.010036).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4665732383728027
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0064859  Vali Loss: 0.0079029 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.010036 --> 0.007903).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.4679815769195557
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0077130  Vali Loss: 0.0107074 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4669649600982666
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0061642  Vali Loss: 0.0088131 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4676353931427002
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0054840  Vali Loss: 0.0083783 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.4674646854400635
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0048164  Vali Loss: 0.0086375 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4689228534698486
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0048673  Vali Loss: 0.0096812 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.4680333137512207
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0042942  Vali Loss: 0.0084307 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4676246643066406
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0077891  Vali Loss: 0.0105723 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4684925079345703
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0057771  Vali Loss: 0.0083224 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.470322847366333
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0049303  Vali Loss: 0.0080148 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4676508903503418
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0050392  Vali Loss: 0.0080043 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 1.4667072296142578
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0044811  Vali Loss: 0.0080703 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.4664103984832764
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0047653  Vali Loss: 0.0077666 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.007903 --> 0.007767).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 1.467705488204956
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0042471  Vali Loss: 0.0077807 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.4718048572540283
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0043565  Vali Loss: 0.0079241 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.466928482055664
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0036071  Vali Loss: 0.0080592 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.4680285453796387
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0045047  Vali Loss: 0.0081761 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.468501091003418
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0050374  Vali Loss: 0.0083733 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 1.4671940803527832
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0057718  Vali Loss: 0.0083827 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.4665117263793945
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0047689  Vali Loss: 0.0083728 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.4677364826202393
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0041659  Vali Loss: 0.0083987 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.466153860092163
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0039533  Vali Loss: 0.0083990 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.4663302898406982
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0041322  Vali Loss: 0.0083997 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 28 cost time: 1.4680039882659912
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0036735  Vali Loss: 0.0083989 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.4677116870880127
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0041253  Vali Loss: 0.0083988 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.469933271408081
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0041463  Vali Loss: 0.0083996 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 1.4659605026245117
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0035607  Vali Loss: 0.0084016 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 1.4686541557312012
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0046668  Vali Loss: 0.0084003 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909808  Test weighted F1: 0.9909996  Test macro F1 0.9909468 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 636195
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00278552 0.00240385 0.00239808 0.00333333 0.00561798 0.00591716
 0.003125   0.00287356 0.00234192 0.00398406]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.442110300064087
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2127585  Vali Loss: 1.9792889 Vali Accuracy: 0.3276836  Vali weighted F1: 0.2950304  Vali macro F1 0.2902336 
Validation loss decreased (inf --> 1.979289).  Saving model ...
Epoch: 2 cost time: 1.3959259986877441
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4798161  Vali Loss: 1.0751189 Vali Accuracy: 0.6497175  Vali weighted F1: 0.6414714  Vali macro F1 0.6397200 
new best score!!!!
Validation loss decreased (1.979289 --> 1.075119).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.353865623474121
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8719543  Vali Loss: 0.6872401 Vali Accuracy: 0.7598870  Vali weighted F1: 0.7435320  Vali macro F1 0.7339454 
new best score!!!!
Validation loss decreased (1.075119 --> 0.687240).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3470396995544434
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5862575  Vali Loss: 0.5069351 Vali Accuracy: 0.8107345  Vali weighted F1: 0.7841158  Vali macro F1 0.7640709 
new best score!!!!
Validation loss decreased (0.687240 --> 0.506935).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.351010799407959
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4321258  Vali Loss: 0.4122052 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8585897  Vali macro F1 0.8434780 
new best score!!!!
Validation loss decreased (0.506935 --> 0.412205).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3468694686889648
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3333949  Vali Loss: 0.3344390 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8549669  Vali macro F1 0.8311649 
new best score!!!!
Validation loss decreased (0.412205 --> 0.334439).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3466570377349854
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2728677  Vali Loss: 0.2614313 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8991076  Vali macro F1 0.8759769 
new best score!!!!
Validation loss decreased (0.334439 --> 0.261431).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3485252857208252
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2192501  Vali Loss: 0.2323147 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8883160  Vali macro F1 0.8562091 
new best score!!!!
Validation loss decreased (0.261431 --> 0.232315).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3476214408874512
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1942996  Vali Loss: 0.2201616 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9108825  Vali macro F1 0.8862195 
new best score!!!!
Validation loss decreased (0.232315 --> 0.220162).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3478689193725586
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1664340  Vali Loss: 0.1971615 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9251325  Vali macro F1 0.9027584 
new best score!!!!
Validation loss decreased (0.220162 --> 0.197161).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.347477912902832
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1532475  Vali Loss: 0.1781157 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9214110  Vali macro F1 0.8961099 
new best score!!!!
Validation loss decreased (0.197161 --> 0.178116).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3452520370483398
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1355331  Vali Loss: 0.1642793 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9420189  Vali macro F1 0.9256223 
new best score!!!!
Validation loss decreased (0.178116 --> 0.164279).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3475139141082764
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1340584  Vali Loss: 0.1626265 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9576399  Vali macro F1 0.9484703 
new best score!!!!
Validation loss decreased (0.164279 --> 0.162626).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3470628261566162
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1191464  Vali Loss: 0.1541439 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9240231  Vali macro F1 0.9028460 
new best score!!!!
Validation loss decreased (0.162626 --> 0.154144).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.34895658493042
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1100169  Vali Loss: 0.1556034 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9129616  Vali macro F1 0.8874691 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.345346450805664
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1090496  Vali Loss: 0.1367004 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9223959  Vali macro F1 0.9003333 
new best score!!!!
Validation loss decreased (0.154144 --> 0.136700).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3490302562713623
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1008939  Vali Loss: 0.1308408 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631077  Vali macro F1 0.9543100 
new best score!!!!
Validation loss decreased (0.136700 --> 0.130841).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.345813274383545
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0900226  Vali Loss: 0.1875875 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9079149  Vali macro F1 0.8805810 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3451144695281982
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0930088  Vali Loss: 0.1074884 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774038  Vali macro F1 0.9723348 
new best score!!!!
Validation loss decreased (0.130841 --> 0.107488).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3531184196472168
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0804703  Vali Loss: 0.1133525 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744751  Vali macro F1 0.9695951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.348372459411621
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0805386  Vali Loss: 0.1303640 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744410  Vali macro F1 0.9697376 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3643643856048584
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0697351  Vali Loss: 0.1205520 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9563234  Vali macro F1 0.9450256 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 1.3491742610931396
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0674702  Vali Loss: 0.0838033 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743898  Vali macro F1 0.9680503 
new best score!!!!
Validation loss decreased (0.107488 --> 0.083803).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3539268970489502
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0563867  Vali Loss: 0.0913491 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802240  Vali macro F1 0.9775673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3526432514190674
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0562595  Vali Loss: 0.0611094 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858703  Vali macro F1 0.9836561 
new best score!!!!
Validation loss decreased (0.083803 --> 0.061109).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3569059371948242
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0594261  Vali Loss: 0.0724431 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886633  Vali macro F1 0.9890762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.3530116081237793
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0543296  Vali Loss: 0.0773016 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829796  Vali macro F1 0.9798907 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.3543131351470947
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0433049  Vali Loss: 0.0871948 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715861  Vali macro F1 0.9699682 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 1.3544974327087402
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0356754  Vali Loss: 0.0401025 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915215  Vali macro F1 0.9899217 
new best score!!!!
Validation loss decreased (0.061109 --> 0.040103).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3547377586364746
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0302443  Vali Loss: 0.0674626 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886966  Vali macro F1 0.9876745 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3528602123260498
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0238031  Vali Loss: 0.0520660 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800922  Vali macro F1 0.9758144 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.351958990097046
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0318181  Vali Loss: 0.0381493 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886928  Vali macro F1 0.9887735 
new best score!!!!
Validation loss decreased (0.040103 --> 0.038149).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.353919506072998
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0218652  Vali Loss: 0.0288291 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915215  Vali macro F1 0.9899217 
new best score!!!!
Validation loss decreased (0.038149 --> 0.028829).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3512663841247559
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0180983  Vali Loss: 0.0386771 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914910  Vali macro F1 0.9929519 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.3533101081848145
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0158246  Vali Loss: 0.0193959 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
new best score!!!!
Validation loss decreased (0.028829 --> 0.019396).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3498694896697998
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0140515  Vali Loss: 0.0514263 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886651  Vali macro F1 0.9891043 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3520925045013428
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0165127  Vali Loss: 0.0847325 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771710  Vali macro F1 0.9721167 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3449902534484863
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0355706  Vali Loss: 0.0680928 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886341  Vali macro F1 0.9892161 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3452041149139404
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0327864  Vali Loss: 0.0501518 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886617  Vali macro F1 0.9876342 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.3504509925842285
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0214051  Vali Loss: 0.0536004 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9900491 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 1.344984531402588
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0155597  Vali Loss: 0.0446736 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3464539051055908
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0135418  Vali Loss: 0.0382410 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3478188514709473
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0104914  Vali Loss: 0.0307664 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3497989177703857
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0107505  Vali Loss: 0.0166007 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
new best score!!!!
Validation loss decreased (0.019396 --> 0.016601).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3548550605773926
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0100110  Vali Loss: 0.0132173 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016601 --> 0.013217).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.351846694946289
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0100665  Vali Loss: 0.0130907 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.013217 --> 0.013091).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3489165306091309
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0088447  Vali Loss: 0.0128431 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.013091 --> 0.012843).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3564677238464355
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0093597  Vali Loss: 0.0142592 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.3520381450653076
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0085867  Vali Loss: 0.0136408 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.3611509799957275
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0084596  Vali Loss: 0.0126776 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012843 --> 0.012678).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.3504154682159424
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0080164  Vali Loss: 0.0119235 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.012678 --> 0.011923).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.3508880138397217
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0077955  Vali Loss: 0.0115783 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.011923 --> 0.011578).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.3511273860931396
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0074577  Vali Loss: 0.0116500 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3461313247680664
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0078993  Vali Loss: 0.0128591 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3488891124725342
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0084071  Vali Loss: 0.0113422 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011578 --> 0.011342).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.35239577293396
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0081746  Vali Loss: 0.0105469 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.011342 --> 0.010547).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.3487439155578613
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0073570  Vali Loss: 0.0101726 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.010547 --> 0.010173).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.3474323749542236
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0077932  Vali Loss: 0.0104752 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3557686805725098
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0074323  Vali Loss: 0.0109478 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.3486850261688232
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0066884  Vali Loss: 0.0112785 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.345841407775879
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0068284  Vali Loss: 0.0127279 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.3461284637451172
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0070605  Vali Loss: 0.0129327 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 63 cost time: 1.3487746715545654
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0061597  Vali Loss: 0.0129371 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.3461081981658936
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0072576  Vali Loss: 0.0129167 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.349301815032959
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0065031  Vali Loss: 0.0128477 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.3505465984344482
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0071548  Vali Loss: 0.0128165 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.346672773361206
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0068083  Vali Loss: 0.0127606 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 68 cost time: 1.3520433902740479
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0063319  Vali Loss: 0.0127587 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.3489770889282227
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0071631  Vali Loss: 0.0127552 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.3479523658752441
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0063854  Vali Loss: 0.0127467 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 1.3508720397949219
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0083306  Vali Loss: 0.0127358 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 1.3524363040924072
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0074910  Vali Loss: 0.0127203 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898251  Test macro F1 0.9875303 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4612972736358643
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0084947  Vali Loss: 0.0111853 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
Validation loss decreased (inf --> 0.011185).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4598941802978516
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0064617  Vali Loss: 0.0116732 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4584825038909912
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0058848  Vali Loss: 0.0135598 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.460653305053711
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0065902  Vali Loss: 0.0116477 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.4619488716125488
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0055602  Vali Loss: 0.0098377 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
new best score!!!!
Validation loss decreased (0.011185 --> 0.009838).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.4623637199401855
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0050405  Vali Loss: 0.0126121 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.459911584854126
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0051369  Vali Loss: 0.0129309 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4581282138824463
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0078731  Vali Loss: 0.0126590 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.460299015045166
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0051348  Vali Loss: 0.0135173 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4595975875854492
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0056720  Vali Loss: 0.0162198 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.4607999324798584
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0044653  Vali Loss: 0.0143539 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.461242437362671
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0045807  Vali Loss: 0.0140556 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4601714611053467
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0049833  Vali Loss: 0.0165873 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.4593968391418457
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0044402  Vali Loss: 0.0144609 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4656939506530762
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0051688  Vali Loss: 0.0123327 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 1.466557502746582
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0041142  Vali Loss: 0.0121828 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.4632325172424316
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0039960  Vali Loss: 0.0122166 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.4611968994140625
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0041229  Vali Loss: 0.0121848 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.4609363079071045
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0045334  Vali Loss: 0.0122068 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.4588191509246826
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0039692  Vali Loss: 0.0122148 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909542  Test macro F1 0.9884215 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00275482 0.00232558 0.00247525 0.00333333 0.00561798 0.00617284
 0.0031348  0.00288184 0.00239234 0.00378788]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3422489166259766
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2084080  Vali Loss: 1.9747018 Vali Accuracy: 0.2627119  Vali weighted F1: 0.2239462  Vali macro F1 0.2217258 
Validation loss decreased (inf --> 1.974702).  Saving model ...
Epoch: 2 cost time: 1.338669776916504
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4753378  Vali Loss: 1.0402035 Vali Accuracy: 0.6242938  Vali weighted F1: 0.6278955  Vali macro F1 0.6291074 
new best score!!!!
Validation loss decreased (1.974702 --> 1.040204).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3404955863952637
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8535504  Vali Loss: 0.7115294 Vali Accuracy: 0.7429379  Vali weighted F1: 0.7348972  Vali macro F1 0.7259961 
new best score!!!!
Validation loss decreased (1.040204 --> 0.711529).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3426885604858398
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5839726  Vali Loss: 0.5183452 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8351705  Vali macro F1 0.8292690 
new best score!!!!
Validation loss decreased (0.711529 --> 0.518345).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.342226266860962
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4319835  Vali Loss: 0.4158364 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8236274  Vali macro F1 0.7981646 
new best score!!!!
Validation loss decreased (0.518345 --> 0.415836).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.340108871459961
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3348851  Vali Loss: 0.3153478 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8568344  Vali macro F1 0.8336439 
new best score!!!!
Validation loss decreased (0.415836 --> 0.315348).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3407795429229736
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2765500  Vali Loss: 0.2649866 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8741215  Vali macro F1 0.8459383 
new best score!!!!
Validation loss decreased (0.315348 --> 0.264987).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3406355381011963
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2344531  Vali Loss: 0.2404260 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8810862  Vali macro F1 0.8513617 
new best score!!!!
Validation loss decreased (0.264987 --> 0.240426).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3418078422546387
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2103803  Vali Loss: 0.2191328 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9159087  Vali macro F1 0.8914363 
new best score!!!!
Validation loss decreased (0.240426 --> 0.219133).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3382377624511719
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1790117  Vali Loss: 0.1909806 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9157858  Vali macro F1 0.8896686 
new best score!!!!
Validation loss decreased (0.219133 --> 0.190981).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3481054306030273
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1535082  Vali Loss: 0.1774975 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9488431  Vali macro F1 0.9346774 
new best score!!!!
Validation loss decreased (0.190981 --> 0.177497).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3412187099456787
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1377510  Vali Loss: 0.1676745 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9074849  Vali macro F1 0.8796331 
new best score!!!!
Validation loss decreased (0.177497 --> 0.167674).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3566842079162598
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1271862  Vali Loss: 0.2093144 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9394248  Vali macro F1 0.9263845 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.3382465839385986
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1319923  Vali Loss: 0.1659879 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9485303  Vali macro F1 0.9355179 
new best score!!!!
Validation loss decreased (0.167674 --> 0.165988).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3413214683532715
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1107885  Vali Loss: 0.1597903 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9567709  Vali macro F1 0.9456792 
new best score!!!!
Validation loss decreased (0.165988 --> 0.159790).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.344545602798462
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1062692  Vali Loss: 0.1558254 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9387426  Vali macro F1 0.9227308 
new best score!!!!
Validation loss decreased (0.159790 --> 0.155825).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3414735794067383
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1032537  Vali Loss: 0.1388947 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659296  Vali macro F1 0.9566764 
new best score!!!!
Validation loss decreased (0.155825 --> 0.138895).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3413677215576172
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0963354  Vali Loss: 0.1377294 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9591462  Vali macro F1 0.9474406 
new best score!!!!
Validation loss decreased (0.138895 --> 0.137729).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3372819423675537
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0973222  Vali Loss: 0.1312293 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684534  Vali macro F1 0.9601126 
new best score!!!!
Validation loss decreased (0.137729 --> 0.131229).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3449866771697998
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0890455  Vali Loss: 0.1313567 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858329  Vali macro F1 0.9852482 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3427743911743164
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0797281  Vali Loss: 0.1254691 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773972  Vali macro F1 0.9722899 
new best score!!!!
Validation loss decreased (0.131229 --> 0.125469).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3422129154205322
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0733243  Vali Loss: 0.1166904 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714425  Vali macro F1 0.9641824 
new best score!!!!
Validation loss decreased (0.125469 --> 0.116690).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3432788848876953
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0768247  Vali Loss: 0.1044770 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801656  Vali macro F1 0.9773242 
new best score!!!!
Validation loss decreased (0.116690 --> 0.104477).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3421316146850586
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0660079  Vali Loss: 0.1032293 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689132  Vali macro F1 0.9607387 
new best score!!!!
Validation loss decreased (0.104477 --> 0.103229).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3470170497894287
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0675804  Vali Loss: 0.0953338 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772963  Vali macro F1 0.9721526 
new best score!!!!
Validation loss decreased (0.103229 --> 0.095334).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3437764644622803
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0674271  Vali Loss: 0.0622808 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801795  Vali macro F1 0.9756906 
new best score!!!!
Validation loss decreased (0.095334 --> 0.062281).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3417975902557373
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0568648  Vali Loss: 0.0807757 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801749  Vali macro F1 0.9760719 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.343228816986084
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0547536  Vali Loss: 0.0875329 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858686  Vali macro F1 0.9838241 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3418118953704834
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0454846  Vali Loss: 0.0741841 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886974  Vali macro F1 0.9862101 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.3451323509216309
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0427401  Vali Loss: 0.0762289 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772957  Vali macro F1 0.9746832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 1.3425772190093994
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0429100  Vali Loss: 0.0531223 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915259  Vali macro F1 0.9911981 
new best score!!!!
Validation loss decreased (0.062281 --> 0.053122).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3406050205230713
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0350540  Vali Loss: 0.0565859 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801649  Vali macro F1 0.9769795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3458199501037598
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0386190  Vali Loss: 0.0861581 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801804  Vali macro F1 0.9757507 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3408868312835693
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0383540  Vali Loss: 0.0558921 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829941  Vali macro F1 0.9810541 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 1.3409276008605957
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0305941  Vali Loss: 0.0493732 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829846  Vali macro F1 0.9792179 
new best score!!!!
Validation loss decreased (0.053122 --> 0.049373).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.341876745223999
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0252519  Vali Loss: 0.0627567 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858649  Vali macro F1 0.9849560 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3463988304138184
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0228130  Vali Loss: 0.0243689 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915220  Vali macro F1 0.9910593 
new best score!!!!
Validation loss decreased (0.049373 --> 0.024369).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3470189571380615
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0269001  Vali Loss: 0.0471930 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914808  Vali macro F1 0.9911313 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.3473095893859863
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0203400  Vali Loss: 0.0199817 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915186  Vali macro F1 0.9895891 
new best score!!!!
Validation loss decreased (0.024369 --> 0.019982).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3441879749298096
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0178168  Vali Loss: 0.0192381 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.019982 --> 0.019238).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3425729274749756
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0131494  Vali Loss: 0.0317396 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915259  Vali macro F1 0.9911981 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.349212408065796
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0120815  Vali Loss: 0.0237398 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3422164916992188
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0143526  Vali Loss: 0.0447131 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887113  Vali macro F1 0.9886796 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.343273401260376
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0165918  Vali Loss: 0.0194213 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.341827630996704
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0128669  Vali Loss: 0.0235828 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 1.340444803237915
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0097423  Vali Loss: 0.0190536 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.019238 --> 0.019054).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.343447208404541
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0082596  Vali Loss: 0.0156838 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.019054 --> 0.015684).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3410356044769287
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0085077  Vali Loss: 0.0141702 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.015684 --> 0.014170).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3409523963928223
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0082494  Vali Loss: 0.0142583 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3417987823486328
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0077102  Vali Loss: 0.0151785 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9908465 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3419277667999268
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0077137  Vali Loss: 0.0149157 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9908465 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3437321186065674
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0075739  Vali Loss: 0.0157482 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9908465 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.3397700786590576
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0077890  Vali Loss: 0.0144974 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 1.3428606986999512
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0067859  Vali Loss: 0.0142972 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3417375087738037
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0077488  Vali Loss: 0.0141545 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
new best score!!!!
Validation loss decreased (0.014170 --> 0.014154).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.3423311710357666
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0069555  Vali Loss: 0.0139766 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
new best score!!!!
Validation loss decreased (0.014154 --> 0.013977).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.343515157699585
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0067445  Vali Loss: 0.0137948 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
new best score!!!!
Validation loss decreased (0.013977 --> 0.013795).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.3471627235412598
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0069332  Vali Loss: 0.0137969 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3418326377868652
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0077204  Vali Loss: 0.0137946 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
new best score!!!!
Validation loss decreased (0.013795 --> 0.013795).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.3416187763214111
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0077134  Vali Loss: 0.0137972 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.3431735038757324
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0074228  Vali Loss: 0.0137916 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
new best score!!!!
Validation loss decreased (0.013795 --> 0.013792).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.3433032035827637
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0068880  Vali Loss: 0.0137948 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9908465 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.3421030044555664
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0072303  Vali Loss: 0.0137955 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9908465 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.3444294929504395
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0065103  Vali Loss: 0.0138186 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.341799020767212
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0073894  Vali Loss: 0.0138454 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.341465950012207
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0075072  Vali Loss: 0.0140723 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 67 cost time: 1.3421013355255127
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0073610  Vali Loss: 0.0140965 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.3501949310302734
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0064495  Vali Loss: 0.0140982 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.3434886932373047
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0072872  Vali Loss: 0.0141187 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.358370304107666
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0073032  Vali Loss: 0.0141321 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 1.3433506488800049
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0068865  Vali Loss: 0.0141452 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 72 cost time: 1.3442442417144775
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0074206  Vali Loss: 0.0141463 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 1.341702938079834
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0068352  Vali Loss: 0.0141463 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 1.3446078300476074
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0071599  Vali Loss: 0.0141471 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 1.3404746055603027
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0069938  Vali Loss: 0.0141440 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 1.345329999923706
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0067188  Vali Loss: 0.0141412 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932167  Test macro F1 0.9933071 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.463458776473999
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0072032  Vali Loss: 0.0094431 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
Validation loss decreased (inf --> 0.009443).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.469658613204956
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0071262  Vali Loss: 0.0101402 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4633362293243408
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0078451  Vali Loss: 0.0147636 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.46372389793396
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0078948  Vali Loss: 0.0104587 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.4635982513427734
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0065319  Vali Loss: 0.0115925 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.4627656936645508
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0055379  Vali Loss: 0.0102332 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4670023918151855
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0047775  Vali Loss: 0.0098910 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4624183177947998
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0051324  Vali Loss: 0.0107897 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.4646022319793701
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0054380  Vali Loss: 0.0136603 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4617836475372314
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0067378  Vali Loss: 0.0127291 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.4644098281860352
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0056561  Vali Loss: 0.0139624 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915234  Vali macro F1 0.9913061 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4625751972198486
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0050801  Vali Loss: 0.0149958 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4619817733764648
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0046589  Vali Loss: 0.0154797 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.4667844772338867
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0045693  Vali Loss: 0.0154333 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4638559818267822
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0043530  Vali Loss: 0.0143634 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.4631776809692383
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0045572  Vali Loss: 0.0142918 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9935533 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943472  Test macro F1 0.9941999 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00268097 0.00233645 0.0025     0.00338983 0.00584795 0.00595238
 0.0030581  0.00294118 0.00234742 0.00389105]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3418288230895996
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2136865  Vali Loss: 1.9881298 Vali Accuracy: 0.2994350  Vali weighted F1: 0.2485072  Vali macro F1 0.2367493 
Validation loss decreased (inf --> 1.988130).  Saving model ...
Epoch: 2 cost time: 1.3396503925323486
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4772909  Vali Loss: 1.0502834 Vali Accuracy: 0.6666667  Vali weighted F1: 0.6500508  Vali macro F1 0.6314462 
new best score!!!!
Validation loss decreased (1.988130 --> 1.050283).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3399817943572998
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8527351  Vali Loss: 0.6908083 Vali Accuracy: 0.7401130  Vali weighted F1: 0.7157947  Vali macro F1 0.7002161 
new best score!!!!
Validation loss decreased (1.050283 --> 0.690808).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3409264087677002
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5672948  Vali Loss: 0.4936240 Vali Accuracy: 0.8305085  Vali weighted F1: 0.8099550  Vali macro F1 0.7881139 
new best score!!!!
Validation loss decreased (0.690808 --> 0.493624).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3526780605316162
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4225008  Vali Loss: 0.3967677 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8628914  Vali macro F1 0.8538592 
new best score!!!!
Validation loss decreased (0.493624 --> 0.396768).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.346311092376709
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3217947  Vali Loss: 0.2949974 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9032969  Vali macro F1 0.8814154 
new best score!!!!
Validation loss decreased (0.396768 --> 0.294997).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.347005844116211
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2555886  Vali Loss: 0.2386629 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8939835  Vali macro F1 0.8624808 
new best score!!!!
Validation loss decreased (0.294997 --> 0.238663).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3447544574737549
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2109587  Vali Loss: 0.2233488 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9235843  Vali macro F1 0.9065529 
new best score!!!!
Validation loss decreased (0.238663 --> 0.223349).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3470523357391357
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1765058  Vali Loss: 0.2138833 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9370851  Vali macro F1 0.9217471 
new best score!!!!
Validation loss decreased (0.223349 --> 0.213883).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.346912145614624
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1535591  Vali Loss: 0.1841365 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9434602  Vali macro F1 0.9332383 
new best score!!!!
Validation loss decreased (0.213883 --> 0.184137).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3473057746887207
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1375654  Vali Loss: 0.1590806 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9523517  Vali macro F1 0.9396432 
new best score!!!!
Validation loss decreased (0.184137 --> 0.159081).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3470568656921387
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1207149  Vali Loss: 0.1662024 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9769582  Vali macro F1 0.9724528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3445136547088623
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1126757  Vali Loss: 0.1455006 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773002  Vali macro F1 0.9752285 
new best score!!!!
Validation loss decreased (0.159081 --> 0.145501).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3444983959197998
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1036920  Vali Loss: 0.1420272 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742074  Vali macro F1 0.9679469 
new best score!!!!
Validation loss decreased (0.145501 --> 0.142027).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3431885242462158
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1074027  Vali Loss: 0.1515162 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9574168  Vali macro F1 0.9509492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3406164646148682
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0939889  Vali Loss: 0.1159950 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717466  Vali macro F1 0.9659083 
new best score!!!!
Validation loss decreased (0.142027 --> 0.115995).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3374998569488525
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0872980  Vali Loss: 0.0979660 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9740245  Vali macro F1 0.9660989 
new best score!!!!
Validation loss decreased (0.115995 --> 0.097966).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.340482473373413
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0737461  Vali Loss: 0.0939973 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801243  Vali macro F1 0.9774757 
new best score!!!!
Validation loss decreased (0.097966 --> 0.093997).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.341580867767334
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0800386  Vali Loss: 0.1136750 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716323  Vali macro F1 0.9667962 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3397510051727295
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0770392  Vali Loss: 0.0712445 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886683  Vali macro F1 0.9860370 
new best score!!!!
Validation loss decreased (0.093997 --> 0.071244).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3452281951904297
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0621308  Vali Loss: 0.0884421 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773452  Vali macro F1 0.9749409 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.343724012374878
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0530453  Vali Loss: 0.0692251 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9799933  Vali macro F1 0.9742257 
new best score!!!!
Validation loss decreased (0.071244 --> 0.069225).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3416037559509277
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0560380  Vali Loss: 0.0720466 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830706  Vali macro F1 0.9814493 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3443751335144043
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0481318  Vali Loss: 0.0550551 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830133  Vali macro F1 0.9814092 
new best score!!!!
Validation loss decreased (0.069225 --> 0.055055).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3419005870819092
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0434057  Vali Loss: 0.0525039 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915131  Vali macro F1 0.9899103 
new best score!!!!
Validation loss decreased (0.055055 --> 0.052504).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3444867134094238
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0379614  Vali Loss: 0.0423222 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915339  Vali macro F1 0.9921884 
new best score!!!!
Validation loss decreased (0.052504 --> 0.042322).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.343513011932373
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0346831  Vali Loss: 0.0529075 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887593  Vali macro F1 0.9884107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3427352905273438
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0289357  Vali Loss: 0.0640304 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831187  Vali macro F1 0.9823482 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3412976264953613
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0293513  Vali Loss: 0.0680039 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886651  Vali macro F1 0.9891043 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.346604824066162
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0348909  Vali Loss: 0.0953810 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802797  Vali macro F1 0.9791088 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 1.3506762981414795
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0282201  Vali Loss: 0.0333617 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915224  Vali macro F1 0.9913770 
new best score!!!!
Validation loss decreased (0.042322 --> 0.033362).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3415541648864746
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0219239  Vali Loss: 0.0421408 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9952246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3601112365722656
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0273327  Vali Loss: 0.0451885 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858510  Vali macro F1 0.9870273 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3438987731933594
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0266493  Vali Loss: 0.0300111 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915881  Vali macro F1 0.9907967 
new best score!!!!
Validation loss decreased (0.033362 --> 0.030011).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3441839218139648
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0215693  Vali Loss: 0.0320054 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887044  Vali macro F1 0.9896405 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3432533740997314
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0232742  Vali Loss: 0.0224956 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943483  Vali macro F1 0.9952246 
new best score!!!!
Validation loss decreased (0.030011 --> 0.022496).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3457756042480469
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0225302  Vali Loss: 0.0371116 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943567  Vali macro F1 0.9952273 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3480463027954102
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0176537  Vali Loss: 0.0288155 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.3387231826782227
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0187602  Vali Loss: 0.0389764 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886806  Vali macro F1 0.9896308 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.3408684730529785
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0160542  Vali Loss: 0.0618240 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914939  Vali macro F1 0.9914903 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 1.3401720523834229
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0202054  Vali Loss: 0.0432019 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887312  Vali macro F1 0.9885242 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 1.3457155227661133
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0159331  Vali Loss: 0.0207337 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943627  Vali macro F1 0.9945744 
new best score!!!!
Validation loss decreased (0.022496 --> 0.020734).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3403911590576172
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0119990  Vali Loss: 0.0343043 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.339674472808838
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0110988  Vali Loss: 0.0422327 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.3430523872375488
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0109594  Vali Loss: 0.0316332 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 1.3420641422271729
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0106280  Vali Loss: 0.0249778 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 1.340834140777588
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0083691  Vali Loss: 0.0258546 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 48 cost time: 1.3413374423980713
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0106779  Vali Loss: 0.0247975 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.3394179344177246
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0101432  Vali Loss: 0.0238187 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.342524766921997
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0116901  Vali Loss: 0.0239816 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.341447114944458
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0094079  Vali Loss: 0.0245468 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.3479764461517334
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0100222  Vali Loss: 0.0248321 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 53 cost time: 1.3427085876464844
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0108343  Vali Loss: 0.0247955 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3411927223205566
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0103772  Vali Loss: 0.0249479 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.340914011001587
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0095068  Vali Loss: 0.0251920 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.3392212390899658
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0086400  Vali Loss: 0.0252236 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.3420915603637695
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0097002  Vali Loss: 0.0252978 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943519  Test macro F1 0.9932567 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4630193710327148
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0114970  Vali Loss: 0.0158470 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
Validation loss decreased (inf --> 0.015847).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4612867832183838
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0088347  Vali Loss: 0.0254923 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4616661071777344
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0092785  Vali Loss: 0.0278347 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915289  Vali macro F1 0.9927703 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4624958038330078
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0084430  Vali Loss: 0.0367138 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.4632322788238525
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0091952  Vali Loss: 0.0090585 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
new best score!!!!
Validation loss decreased (0.015847 --> 0.009058).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.463080883026123
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0071948  Vali Loss: 0.0202204 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.461557149887085
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0075000  Vali Loss: 0.0164752 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4612338542938232
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0075938  Vali Loss: 0.0391367 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.4623517990112305
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0089098  Vali Loss: 0.0273381 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943862  Vali macro F1 0.9950431 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4624972343444824
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0088919  Vali Loss: 0.0164441 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943627  Vali macro F1 0.9945744 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.4621233940124512
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0077550  Vali Loss: 0.0227263 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943627  Vali macro F1 0.9945744 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4639642238616943
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0084705  Vali Loss: 0.0311746 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915718  Vali macro F1 0.9920069 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.461418628692627
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0074790  Vali Loss: 0.0505468 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915058  Vali macro F1 0.9923019 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.4621741771697998
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0058729  Vali Loss: 0.0440263 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4625909328460693
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0062516  Vali Loss: 0.0557547 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887148  Vali macro F1 0.9897344 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 1.4628894329071045
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0068881  Vali Loss: 0.0536776 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887148  Vali macro F1 0.9897344 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.4617457389831543
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0056588  Vali Loss: 0.0493828 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915289  Vali macro F1 0.9927703 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.4614381790161133
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0047716  Vali Loss: 0.0458905 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915289  Vali macro F1 0.9927703 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.4603371620178223
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0054315  Vali Loss: 0.0450575 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.4626579284667969
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0064703  Vali Loss: 0.0454998 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943519  Test macro F1 0.9932567 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263158 0.00242718 0.002457   0.003367   0.00598802 0.00571429
 0.00310559 0.002849   0.00240964 0.003861  ]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3485229015350342
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2042089  Vali Loss: 1.9579977 Vali Accuracy: 0.3248588  Vali weighted F1: 0.2722708  Vali macro F1 0.2667480 
Validation loss decreased (inf --> 1.957998).  Saving model ...
Epoch: 2 cost time: 1.3466529846191406
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4358880  Vali Loss: 1.0694938 Vali Accuracy: 0.5790960  Vali weighted F1: 0.5594791  Vali macro F1 0.5548022 
new best score!!!!
Validation loss decreased (1.957998 --> 1.069494).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3485369682312012
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8362010  Vali Loss: 0.6924827 Vali Accuracy: 0.7683616  Vali weighted F1: 0.7484578  Vali macro F1 0.7365128 
new best score!!!!
Validation loss decreased (1.069494 --> 0.692483).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.346747636795044
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5810098  Vali Loss: 0.5079338 Vali Accuracy: 0.8446328  Vali weighted F1: 0.8215210  Vali macro F1 0.7961537 
new best score!!!!
Validation loss decreased (0.692483 --> 0.507934).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3475291728973389
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4345823  Vali Loss: 0.3998883 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8488896  Vali macro F1 0.8351981 
new best score!!!!
Validation loss decreased (0.507934 --> 0.399888).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3454673290252686
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3437476  Vali Loss: 0.3456819 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8560546  Vali macro F1 0.8351344 
new best score!!!!
Validation loss decreased (0.399888 --> 0.345682).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3485407829284668
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2874946  Vali Loss: 0.2762937 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8945096  Vali macro F1 0.8736294 
new best score!!!!
Validation loss decreased (0.345682 --> 0.276294).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3479893207550049
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2330707  Vali Loss: 0.2281883 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9238451  Vali macro F1 0.9035065 
new best score!!!!
Validation loss decreased (0.276294 --> 0.228188).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3636410236358643
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1951658  Vali Loss: 0.2049454 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9239606  Vali macro F1 0.9026047 
new best score!!!!
Validation loss decreased (0.228188 --> 0.204945).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3525347709655762
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1713600  Vali Loss: 0.2014688 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8883029  Vali macro F1 0.8578101 
new best score!!!!
Validation loss decreased (0.204945 --> 0.201469).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.374929666519165
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1511014  Vali Loss: 0.1649139 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9371358  Vali macro F1 0.9217747 
new best score!!!!
Validation loss decreased (0.201469 --> 0.164914).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3560497760772705
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1309820  Vali Loss: 0.1684763 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9594580  Vali macro F1 0.9493377 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3537676334381104
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1207575  Vali Loss: 0.1473093 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9434860  Vali macro F1 0.9293204 
new best score!!!!
Validation loss decreased (0.164914 --> 0.147309).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3482012748718262
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1206914  Vali Loss: 0.1761172 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9434786  Vali macro F1 0.9275607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3491294384002686
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1171990  Vali Loss: 0.1680181 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9324044  Vali macro F1 0.9110305 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 1.3500361442565918
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1056320  Vali Loss: 0.1533784 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9494955  Vali macro F1 0.9373714 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 1.3511576652526855
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0951645  Vali Loss: 0.1378331 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9556859  Vali macro F1 0.9442019 
new best score!!!!
Validation loss decreased (0.147309 --> 0.137833).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3492929935455322
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0851875  Vali Loss: 0.1362747 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9475828  Vali macro F1 0.9339298 
new best score!!!!
Validation loss decreased (0.137833 --> 0.136275).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3557250499725342
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0859091  Vali Loss: 0.1259343 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9415667  Vali macro F1 0.9249780 
new best score!!!!
Validation loss decreased (0.136275 --> 0.125934).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3470115661621094
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0849199  Vali Loss: 0.1066527 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801749  Vali macro F1 0.9760719 
new best score!!!!
Validation loss decreased (0.125934 --> 0.106653).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.347299337387085
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0807431  Vali Loss: 0.1104535 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801748  Vali macro F1 0.9775445 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.34771728515625
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0832887  Vali Loss: 0.1158787 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9656724  Vali macro F1 0.9609067 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 1.3500597476959229
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0718569  Vali Loss: 0.1086780 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744265  Vali macro F1 0.9733503 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 1.3531363010406494
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0690139  Vali Loss: 0.0806432 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800637  Vali macro F1 0.9759276 
new best score!!!!
Validation loss decreased (0.106653 --> 0.080643).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3563635349273682
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0567639  Vali Loss: 0.0753691 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9900491 
new best score!!!!
Validation loss decreased (0.080643 --> 0.075369).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3512630462646484
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0580149  Vali Loss: 0.0562322 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943453  Vali macro F1 0.9937665 
new best score!!!!
Validation loss decreased (0.075369 --> 0.056232).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3526935577392578
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0559838  Vali Loss: 0.0612814 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829928  Vali macro F1 0.9815137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3504421710968018
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0442952  Vali Loss: 0.0411623 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887593  Vali macro F1 0.9884107 
new best score!!!!
Validation loss decreased (0.056232 --> 0.041162).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3563313484191895
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0401222  Vali Loss: 0.0550384 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886974  Vali macro F1 0.9894074 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3541929721832275
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0371943  Vali Loss: 0.0348739 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
new best score!!!!
Validation loss decreased (0.041162 --> 0.034874).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.35288405418396
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0341584  Vali Loss: 0.0505973 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886651  Vali macro F1 0.9891043 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3501026630401611
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0288313  Vali Loss: 0.0336187 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858286  Vali macro F1 0.9864867 
new best score!!!!
Validation loss decreased (0.034874 --> 0.033619).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3505210876464844
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0335130  Vali Loss: 0.0667150 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745306  Vali macro F1 0.9766096 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.346998929977417
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0340348  Vali Loss: 0.0274379 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915512  Vali macro F1 0.9915304 
new best score!!!!
Validation loss decreased (0.033619 --> 0.027438).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3493473529815674
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0305098  Vali Loss: 0.0475371 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915865  Vali macro F1 0.9909392 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3482635021209717
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0245495  Vali Loss: 0.0392951 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915865  Vali macro F1 0.9909392 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3569128513336182
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0238091  Vali Loss: 0.0564036 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887312  Vali macro F1 0.9885242 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3494532108306885
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0197545  Vali Loss: 0.0213948 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943485  Vali macro F1 0.9939041 
new best score!!!!
Validation loss decreased (0.027438 --> 0.021395).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3638787269592285
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0194618  Vali Loss: 0.0724974 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830135  Vali macro F1 0.9836969 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3507907390594482
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0217742  Vali Loss: 0.0183015 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943771  Vali macro F1 0.9953780 
new best score!!!!
Validation loss decreased (0.021395 --> 0.018302).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3523638248443604
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0130761  Vali Loss: 0.0453815 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887577  Vali macro F1 0.9885532 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3503882884979248
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0136693  Vali Loss: 0.0396625 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887608  Vali macro F1 0.9883993 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3525629043579102
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0134982  Vali Loss: 0.0255947 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915422  Vali macro F1 0.9922961 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.349989652633667
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0151762  Vali Loss: 0.0243857 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9944110  Vali macro F1 0.9931861 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.3553755283355713
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0168150  Vali Loss: 0.0167960 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
new best score!!!!
Validation loss decreased (0.018302 --> 0.016796).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3489973545074463
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0134073  Vali Loss: 0.0397575 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3543477058410645
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0112134  Vali Loss: 0.0162320 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
new best score!!!!
Validation loss decreased (0.016796 --> 0.016232).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3471589088439941
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0086984  Vali Loss: 0.0242156 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914860  Vali macro F1 0.9907674 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.3496615886688232
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0095782  Vali Loss: 0.0169174 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943381  Vali macro F1 0.9946676 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.3488852977752686
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0091601  Vali Loss: 0.0151676 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
new best score!!!!
Validation loss decreased (0.016232 --> 0.015168).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.3509113788604736
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0121254  Vali Loss: 0.0264157 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943463  Vali macro F1 0.9953668 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.3509514331817627
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0112601  Vali Loss: 0.0121238 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971744  Vali macro F1 0.9977517 
new best score!!!!
Validation loss decreased (0.015168 --> 0.012124).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.3528976440429688
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0104034  Vali Loss: 0.0318484 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3503108024597168
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0077032  Vali Loss: 0.0160716 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943460  Vali macro F1 0.9955005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3521831035614014
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0078577  Vali Loss: 0.0317049 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943695  Vali macro F1 0.9946934 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.348642349243164
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0096802  Vali Loss: 0.0412088 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858705  Vali macro F1 0.9868362 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.3493080139160156
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0146054  Vali Loss: 0.0355098 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859580  Vali macro F1 0.9859307 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 58 cost time: 1.348137378692627
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0109893  Vali Loss: 0.0236092 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915339  Vali macro F1 0.9921884 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3512377738952637
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0079222  Vali Loss: 0.0096558 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012124 --> 0.009656).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.3509762287139893
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0065512  Vali Loss: 0.0085961 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
new best score!!!!
Validation loss decreased (0.009656 --> 0.008596).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.3498632907867432
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0055868  Vali Loss: 0.0084443 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
new best score!!!!
Validation loss decreased (0.008596 --> 0.008444).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.3480174541473389
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0050576  Vali Loss: 0.0082349 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
new best score!!!!
Validation loss decreased (0.008444 --> 0.008235).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.348254680633545
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0058872  Vali Loss: 0.0086037 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.3488454818725586
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0053074  Vali Loss: 0.0078876 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
new best score!!!!
Validation loss decreased (0.008235 --> 0.007888).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.349684476852417
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0045782  Vali Loss: 0.0070443 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007888 --> 0.007044).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.3574857711791992
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0043477  Vali Loss: 0.0068576 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007044 --> 0.006858).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.3528470993041992
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0048346  Vali Loss: 0.0067612 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006858 --> 0.006761).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.3692638874053955
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0052634  Vali Loss: 0.0069332 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.3505852222442627
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0045568  Vali Loss: 0.0070601 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.3495392799377441
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0042863  Vali Loss: 0.0068594 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 1.3482437133789062
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0046720  Vali Loss: 0.0056830 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006761 --> 0.005683).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 1.3500921726226807
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0039185  Vali Loss: 0.0056880 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 1.3475992679595947
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0039977  Vali Loss: 0.0061256 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 1.3463008403778076
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0040625  Vali Loss: 0.0061906 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 1.347738265991211
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0038255  Vali Loss: 0.0058815 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 1.3470182418823242
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0036120  Vali Loss: 0.0056115 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005683 --> 0.005611).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 1.349463939666748
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0036408  Vali Loss: 0.0056940 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 1.3480987548828125
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0034193  Vali Loss: 0.0059174 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 1.3484532833099365
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0037498  Vali Loss: 0.0061901 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 80 cost time: 1.347285509109497
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0036348  Vali Loss: 0.0063167 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 81 cost time: 1.349243402481079
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0033547  Vali Loss: 0.0061437 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 82 cost time: 1.3462841510772705
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0031940  Vali Loss: 0.0061076 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 83 cost time: 1.3481175899505615
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0028538  Vali Loss: 0.0060939 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 84 cost time: 1.3468101024627686
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0032357  Vali Loss: 0.0060520 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 85 cost time: 1.3489503860473633
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0037830  Vali Loss: 0.0059986 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 86 cost time: 1.3470754623413086
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0034789  Vali Loss: 0.0059419 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 87 cost time: 1.3478124141693115
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0033475  Vali Loss: 0.0059398 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 88 cost time: 1.3476393222808838
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0032180  Vali Loss: 0.0059373 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 89 cost time: 1.3508694171905518
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0034909  Vali Loss: 0.0059279 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 90 cost time: 1.3518505096435547
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0034656  Vali Loss: 0.0059240 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 91 cost time: 1.3523693084716797
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0036989  Vali Loss: 0.0059248 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909337  Test macro F1 0.9904551 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4644348621368408
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0039626  Vali Loss: 0.0040793 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.004079).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4633097648620605
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0042552  Vali Loss: 0.0047676 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4612452983856201
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0029002  Vali Loss: 0.0064291 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.462428092956543
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0030054  Vali Loss: 0.0064121 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.4637324810028076
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0026387  Vali Loss: 0.0054055 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.4623818397521973
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0027940  Vali Loss: 0.0071408 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.46262526512146
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0026087  Vali Loss: 0.0042893 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4631896018981934
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0024911  Vali Loss: 0.0048611 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.4609434604644775
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0028295  Vali Loss: 0.0069921 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4604642391204834
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0025724  Vali Loss: 0.0080838 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.4632713794708252
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0026165  Vali Loss: 0.0056808 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4615771770477295
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0021081  Vali Loss: 0.0045426 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4623138904571533
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0018691  Vali Loss: 0.0042550 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.4633255004882812
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0020034  Vali Loss: 0.0040955 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4632537364959717
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0022879  Vali Loss: 0.0040397 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004079 --> 0.004040).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.4649651050567627
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0022404  Vali Loss: 0.0046214 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.4603073596954346
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0022192  Vali Loss: 0.0046227 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971744  Vali macro F1 0.9977517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.4630930423736572
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0022696  Vali Loss: 0.0044916 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971744  Vali macro F1 0.9977517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.4616758823394775
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0018674  Vali Loss: 0.0042648 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.4636187553405762
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0025748  Vali Loss: 0.0043738 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 21 cost time: 1.4628667831420898
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0017647  Vali Loss: 0.0043759 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.4631190299987793
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0020207  Vali Loss: 0.0043550 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.4621574878692627
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0019645  Vali Loss: 0.0043258 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.4620766639709473
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0018644  Vali Loss: 0.0042925 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.4634664058685303
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0046538  Vali Loss: 0.0042707 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 26 cost time: 1.462090253829956
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0021337  Vali Loss: 0.0042748 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.462601661682129
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0019972  Vali Loss: 0.0042711 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.465113639831543
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0018998  Vali Loss: 0.0042685 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.4618432521820068
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0020181  Vali Loss: 0.0042639 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.4616179466247559
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0021082  Vali Loss: 0.0042617 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920783  Test macro F1 0.9918011 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.0027027  0.00240385 0.00242131 0.00319489 0.00574713 0.00617284
 0.00315457 0.0028169  0.00246305 0.00390625]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3632919788360596
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1933305  Vali Loss: 1.8937362 Vali Accuracy: 0.3220339  Vali weighted F1: 0.3175630  Vali macro F1 0.2968564 
Validation loss decreased (inf --> 1.893736).  Saving model ...
Epoch: 2 cost time: 1.3448283672332764
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4181660  Vali Loss: 0.9414469 Vali Accuracy: 0.6920904  Vali weighted F1: 0.6839725  Vali macro F1 0.6651718 
new best score!!!!
Validation loss decreased (1.893736 --> 0.941447).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3427462577819824
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8163025  Vali Loss: 0.6084757 Vali Accuracy: 0.7966102  Vali weighted F1: 0.7775645  Vali macro F1 0.7344856 
new best score!!!!
Validation loss decreased (0.941447 --> 0.608476).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3439359664916992
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5433798  Vali Loss: 0.4315631 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8717752  Vali macro F1 0.8440804 
new best score!!!!
Validation loss decreased (0.608476 --> 0.431563).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3427972793579102
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4008752  Vali Loss: 0.3271119 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8871539  Vali macro F1 0.8446518 
new best score!!!!
Validation loss decreased (0.431563 --> 0.327112).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3431520462036133
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3264779  Vali Loss: 0.2676046 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8976397  Vali macro F1 0.8540892 
new best score!!!!
Validation loss decreased (0.327112 --> 0.267605).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3435328006744385
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2625673  Vali Loss: 0.2302078 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9319704  Vali macro F1 0.9003518 
new best score!!!!
Validation loss decreased (0.267605 --> 0.230208).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3445935249328613
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2158756  Vali Loss: 0.1875554 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9051064  Vali macro F1 0.8486940 
new best score!!!!
Validation loss decreased (0.230208 --> 0.187555).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.344391107559204
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1770434  Vali Loss: 0.1578602 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9314390  Vali macro F1 0.8867477 
new best score!!!!
Validation loss decreased (0.187555 --> 0.157860).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3445751667022705
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1626969  Vali Loss: 0.1640088 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9187825  Vali macro F1 0.8721850 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 1.3451204299926758
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1483986  Vali Loss: 0.1409828 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9349790  Vali macro F1 0.8938996 
new best score!!!!
Validation loss decreased (0.157860 --> 0.140983).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.344541072845459
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1266389  Vali Loss: 0.1288635 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9367293  Vali macro F1 0.8976166 
new best score!!!!
Validation loss decreased (0.140983 --> 0.128863).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3423190116882324
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1177421  Vali Loss: 0.1241793 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9500294  Vali macro F1 0.9218484 
new best score!!!!
Validation loss decreased (0.128863 --> 0.124179).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3421008586883545
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1124293  Vali Loss: 0.1232911 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9371687  Vali macro F1 0.8983979 
new best score!!!!
Validation loss decreased (0.124179 --> 0.123291).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3404309749603271
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1041566  Vali Loss: 0.1310266 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9365997  Vali macro F1 0.9000837 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3410625457763672
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1036490  Vali Loss: 0.1201033 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9493210  Vali macro F1 0.9177611 
new best score!!!!
Validation loss decreased (0.123291 --> 0.120103).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3433201313018799
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0885449  Vali Loss: 0.1120489 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9435911  Vali macro F1 0.9103695 
new best score!!!!
Validation loss decreased (0.120103 --> 0.112049).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3452963829040527
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0915300  Vali Loss: 0.1265288 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9249015  Vali macro F1 0.8772890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3427088260650635
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0919181  Vali Loss: 0.1003114 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9654510  Vali macro F1 0.9442846 
new best score!!!!
Validation loss decreased (0.112049 --> 0.100311).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3429651260375977
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0835276  Vali Loss: 0.1004842 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9557707  Vali macro F1 0.9343053 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.346975326538086
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0723742  Vali Loss: 0.1155201 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9522869  Vali macro F1 0.9281390 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3436789512634277
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0739486  Vali Loss: 0.0953917 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714142  Vali macro F1 0.9574412 
new best score!!!!
Validation loss decreased (0.100311 --> 0.095392).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3460195064544678
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0598623  Vali Loss: 0.0854020 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9502616  Vali macro F1 0.9275879 
new best score!!!!
Validation loss decreased (0.095392 --> 0.085402).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3460144996643066
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0513415  Vali Loss: 0.0709064 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801776  Vali macro F1 0.9752743 
new best score!!!!
Validation loss decreased (0.085402 --> 0.070906).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3433527946472168
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0509589  Vali Loss: 0.0656235 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802712  Vali macro F1 0.9747735 
new best score!!!!
Validation loss decreased (0.070906 --> 0.065624).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3456916809082031
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0468979  Vali Loss: 0.0595141 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887036  Vali macro F1 0.9848664 
new best score!!!!
Validation loss decreased (0.065624 --> 0.059514).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3505580425262451
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0484449  Vali Loss: 0.0537356 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829168  Vali macro F1 0.9750829 
new best score!!!!
Validation loss decreased (0.059514 --> 0.053736).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.348022699356079
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0425645  Vali Loss: 0.0706289 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772144  Vali macro F1 0.9669366 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.359689474105835
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0370644  Vali Loss: 0.0444736 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830579  Vali macro F1 0.9775921 
new best score!!!!
Validation loss decreased (0.053736 --> 0.044474).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3463826179504395
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0284447  Vali Loss: 0.0448412 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858881  Vali macro F1 0.9826015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3463234901428223
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0267316  Vali Loss: 0.0427677 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887112  Vali macro F1 0.9875983 
new best score!!!!
Validation loss decreased (0.044474 --> 0.042768).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3451008796691895
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0250516  Vali Loss: 0.0836700 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718004  Vali macro F1 0.9649080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3446385860443115
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0324889  Vali Loss: 0.0998419 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9682587  Vali macro F1 0.9541779 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3445508480072021
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0303255  Vali Loss: 0.0438497 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887112  Vali macro F1 0.9875983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 1.3442165851593018
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0223531  Vali Loss: 0.0394239 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9854592 
new best score!!!!
Validation loss decreased (0.042768 --> 0.039424).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3447883129119873
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0186394  Vali Loss: 0.0412074 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830579  Vali macro F1 0.9775921 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3486785888671875
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0195784  Vali Loss: 0.0540641 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858990  Vali macro F1 0.9823084 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.348546028137207
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0182043  Vali Loss: 0.0658787 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773396  Vali macro F1 0.9697314 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3474838733673096
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0166796  Vali Loss: 0.0639614 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858990  Vali macro F1 0.9823084 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.347233533859253
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0219133  Vali Loss: 0.0478668 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915378  Vali macro F1 0.9926015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 1.3507757186889648
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0143740  Vali Loss: 0.0496245 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915378  Vali macro F1 0.9926015 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.347332239151001
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0116429  Vali Loss: 0.0477323 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9948664 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3444795608520508
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0106123  Vali Loss: 0.0429478 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9948664 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.34389066696167
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0100161  Vali Loss: 0.0411636 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9948664 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.3450829982757568
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0094992  Vali Loss: 0.0413051 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915378  Vali macro F1 0.9926015 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 1.3452677726745605
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0090583  Vali Loss: 0.0414907 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915378  Vali macro F1 0.9926015 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3442564010620117
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0093231  Vali Loss: 0.0416793 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915378  Vali macro F1 0.9926015 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3443632125854492
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0096048  Vali Loss: 0.0417718 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915378  Vali macro F1 0.9926015 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.3439712524414062
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0095549  Vali Loss: 0.0417673 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915378  Vali macro F1 0.9926015 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.345613718032837
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0084129  Vali Loss: 0.0416188 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9948664 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9864713  Test weighted F1: 0.9865019  Test macro F1 0.9818279 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4610416889190674
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0159422  Vali Loss: 0.0360116 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887112  Vali macro F1 0.9875983 
Validation loss decreased (inf --> 0.036012).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4587829113006592
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0149050  Vali Loss: 0.0381893 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4628067016601562
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0141994  Vali Loss: 0.0415427 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4592297077178955
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0137006  Vali Loss: 0.0424266 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830579  Vali macro F1 0.9775921 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.4608314037322998
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0143172  Vali Loss: 0.0373547 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9854592 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.457578182220459
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0117834  Vali Loss: 0.0393369 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858881  Vali macro F1 0.9826015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4612579345703125
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0110399  Vali Loss: 0.0391550 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858881  Vali macro F1 0.9826015 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.45884108543396
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0102733  Vali Loss: 0.0406445 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858881  Vali macro F1 0.9826015 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.4609289169311523
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0101308  Vali Loss: 0.0393274 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4587881565093994
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0117697  Vali Loss: 0.0346364 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
new best score!!!!
Validation loss decreased (0.036012 --> 0.034636).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.462329387664795
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0097484  Vali Loss: 0.0452899 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.456883430480957
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0092784  Vali Loss: 0.0360031 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.460857629776001
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0088436  Vali Loss: 0.0343296 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
new best score!!!!
Validation loss decreased (0.034636 --> 0.034330).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.460038185119629
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0090052  Vali Loss: 0.0357614 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.4604382514953613
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0078812  Vali Loss: 0.0414601 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.4592525959014893
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0092967  Vali Loss: 0.0364566 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.460242509841919
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0086391  Vali Loss: 0.0323019 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
new best score!!!!
Validation loss decreased (0.034330 --> 0.032302).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 1.459939956665039
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0067716  Vali Loss: 0.0324261 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.462097406387329
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0076806  Vali Loss: 0.0375772 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.4585309028625488
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0066678  Vali Loss: 0.0346644 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915290  Vali macro F1 0.9877241 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.4624943733215332
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0081558  Vali Loss: 0.0358923 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.4604854583740234
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0069529  Vali Loss: 0.0341451 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915290  Vali macro F1 0.9877241 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 1.4605917930603027
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0064348  Vali Loss: 0.0337212 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.4573628902435303
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0075685  Vali Loss: 0.0339741 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.4612786769866943
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0068928  Vali Loss: 0.0337156 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.4584882259368896
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0056169  Vali Loss: 0.0339893 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.4630515575408936
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0067744  Vali Loss: 0.0341624 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 1.4598097801208496
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0078586  Vali Loss: 0.0341728 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.4634530544281006
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0069044  Vali Loss: 0.0343063 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.4587202072143555
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0053771  Vali Loss: 0.0343859 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 1.461841106414795
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0066894  Vali Loss: 0.0343962 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 1.460540771484375
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0058784  Vali Loss: 0.0343960 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9875986  Test weighted F1: 0.9876390  Test macro F1 0.9843872 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 636195
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0025974  0.00241546 0.00248756 0.00307692 0.00561798 0.00621118
 0.0031746  0.00286533 0.00241546 0.00413223]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.4007244110107422
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1936720  Vali Loss: 1.8839491 Vali Accuracy: 0.2824859  Vali weighted F1: 0.1825248  Vali macro F1 0.1577199 
Validation loss decreased (inf --> 1.883949).  Saving model ...
Epoch: 2 cost time: 1.3481674194335938
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4903338  Vali Loss: 1.0132504 Vali Accuracy: 0.6327684  Vali weighted F1: 0.6109527  Vali macro F1 0.5700413 
new best score!!!!
Validation loss decreased (1.883949 --> 1.013250).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3476307392120361
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8795018  Vali Loss: 0.6114400 Vali Accuracy: 0.7881356  Vali weighted F1: 0.7704111  Vali macro F1 0.7291329 
new best score!!!!
Validation loss decreased (1.013250 --> 0.611440).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.350132703781128
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5834839  Vali Loss: 0.4172273 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8228472  Vali macro F1 0.7725376 
new best score!!!!
Validation loss decreased (0.611440 --> 0.417227).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.347031831741333
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4250574  Vali Loss: 0.3318075 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8486974  Vali macro F1 0.7992678 
new best score!!!!
Validation loss decreased (0.417227 --> 0.331807).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.346529245376587
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3380802  Vali Loss: 0.2681432 Vali Accuracy: 0.9011299  Vali weighted F1: 0.9006884  Vali macro F1 0.8609586 
new best score!!!!
Validation loss decreased (0.331807 --> 0.268143).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3463613986968994
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2791607  Vali Loss: 0.2139823 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9303650  Vali macro F1 0.8875849 
new best score!!!!
Validation loss decreased (0.268143 --> 0.213982).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3477072715759277
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2416393  Vali Loss: 0.1908325 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9139045  Vali macro F1 0.8619792 
new best score!!!!
Validation loss decreased (0.213982 --> 0.190832).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.346498966217041
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2081159  Vali Loss: 0.1727544 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9050302  Vali macro F1 0.8488718 
new best score!!!!
Validation loss decreased (0.190832 --> 0.172754).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3467392921447754
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1785280  Vali Loss: 0.1423560 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9386408  Vali macro F1 0.9007639 
new best score!!!!
Validation loss decreased (0.172754 --> 0.142356).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3452939987182617
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1542374  Vali Loss: 0.1298060 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9125162  Vali macro F1 0.8579319 
new best score!!!!
Validation loss decreased (0.142356 --> 0.129806).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3474256992340088
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1398451  Vali Loss: 0.1199370 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9411172  Vali macro F1 0.8983334 
new best score!!!!
Validation loss decreased (0.129806 --> 0.119937).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.344543218612671
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1372879  Vali Loss: 0.1168543 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9125162  Vali macro F1 0.8579319 
new best score!!!!
Validation loss decreased (0.119937 --> 0.116854).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3454360961914062
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1313847  Vali Loss: 0.1153335 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9378519  Vali macro F1 0.9009868 
new best score!!!!
Validation loss decreased (0.116854 --> 0.115334).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3458168506622314
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1157130  Vali Loss: 0.1051127 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9463185  Vali macro F1 0.9086011 
new best score!!!!
Validation loss decreased (0.115334 --> 0.105113).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3472213745117188
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1094601  Vali Loss: 0.1072370 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9435575  Vali macro F1 0.9044887 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.3460402488708496
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1091820  Vali Loss: 0.1113174 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9247509  Vali macro F1 0.8667199 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 1.3443453311920166
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1037754  Vali Loss: 0.1009304 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9340233  Vali macro F1 0.8911751 
new best score!!!!
Validation loss decreased (0.105113 --> 0.100930).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3458032608032227
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1044067  Vali Loss: 0.0940652 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9241535  Vali macro F1 0.8731024 
new best score!!!!
Validation loss decreased (0.100930 --> 0.094065).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3453874588012695
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1029042  Vali Loss: 0.0989010 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9415590  Vali macro F1 0.8974847 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3452496528625488
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0977267  Vali Loss: 0.1169736 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9411172  Vali macro F1 0.8983334 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.344916820526123
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1057889  Vali Loss: 0.1090468 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9341132  Vali macro F1 0.8928810 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 1.3445191383361816
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0993801  Vali Loss: 0.0930158 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9372277  Vali macro F1 0.8957403 
new best score!!!!
Validation loss decreased (0.094065 --> 0.093016).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3458521366119385
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0917862  Vali Loss: 0.0891443 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9421577  Vali macro F1 0.9023810 
new best score!!!!
Validation loss decreased (0.093016 --> 0.089144).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3468127250671387
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0842126  Vali Loss: 0.0827494 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9441330  Vali macro F1 0.9053846 
new best score!!!!
Validation loss decreased (0.089144 --> 0.082749).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3471887111663818
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0794635  Vali Loss: 0.0851775 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9498512  Vali macro F1 0.9118280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.350111722946167
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0787259  Vali Loss: 0.0935613 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9460076  Vali macro F1 0.9070960 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.3469064235687256
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0783178  Vali Loss: 0.0851886 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9460076  Vali macro F1 0.9070960 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 1.366715431213379
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0786798  Vali Loss: 0.0943463 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9497828  Vali macro F1 0.9179577 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 1.347132682800293
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0723163  Vali Loss: 0.0817622 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9594685  Vali macro F1 0.9282155 
new best score!!!!
Validation loss decreased (0.082749 --> 0.081762).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3466851711273193
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0679884  Vali Loss: 0.0856494 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9569887  Vali macro F1 0.9309312 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.34818434715271
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0587285  Vali Loss: 0.0950290 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9625536  Vali macro F1 0.9450045 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.3468029499053955
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0589673  Vali Loss: 0.0823330 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9613665  Vali macro F1 0.9346430 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.3450894355773926
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0606060  Vali Loss: 0.0672017 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745152  Vali macro F1 0.9556757 
new best score!!!!
Validation loss decreased (0.081762 --> 0.067202).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3454718589782715
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0451523  Vali Loss: 0.0723258 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689451  Vali macro F1 0.9514095 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3448514938354492
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0421751  Vali Loss: 0.0577428 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770134  Vali macro F1 0.9598039 
new best score!!!!
Validation loss decreased (0.067202 --> 0.057743).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3457324504852295
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0365750  Vali Loss: 0.0454790 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9824788  Vali macro F1 0.9692500 
new best score!!!!
Validation loss decreased (0.057743 --> 0.045479).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3450214862823486
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0340459  Vali Loss: 0.0476101 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9824788  Vali macro F1 0.9692500 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.3445117473602295
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0291442  Vali Loss: 0.0458413 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800096  Vali macro F1 0.9651064 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.3446662425994873
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0230382  Vali Loss: 0.0426624 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
new best score!!!!
Validation loss decreased (0.045479 --> 0.042662).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.345160961151123
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0205979  Vali Loss: 0.0390322 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9855263  Vali macro F1 0.9746444 
new best score!!!!
Validation loss decreased (0.042662 --> 0.039032).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.345810890197754
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0173070  Vali Loss: 0.0438421 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3448879718780518
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0141136  Vali Loss: 0.0315718 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.039032 --> 0.031572).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3480267524719238
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0174894  Vali Loss: 0.0479975 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9827601  Vali macro F1 0.9698529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3488550186157227
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0210195  Vali Loss: 0.0403089 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.345329999923706
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0171811  Vali Loss: 0.0387979 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.3472392559051514
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0174535  Vali Loss: 0.0379067 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.343369483947754
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0230738  Vali Loss: 0.0542607 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858757  Vali macro F1 0.9756098 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 1.3432304859161377
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0205827  Vali Loss: 0.0517448 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9824788  Vali macro F1 0.9692500 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3472514152526855
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0137883  Vali Loss: 0.0362023 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914327  Vali macro F1 0.9850456 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.350015640258789
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0104921  Vali Loss: 0.0314586 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
new best score!!!!
Validation loss decreased (0.031572 --> 0.031459).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.349848985671997
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0112067  Vali Loss: 0.0356522 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.3488092422485352
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0096736  Vali Loss: 0.0376069 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.3424029350280762
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0086859  Vali Loss: 0.0337785 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 1.3497893810272217
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0098111  Vali Loss: 0.0338908 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 1.3459031581878662
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0088422  Vali Loss: 0.0356523 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 1.359973669052124
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0089964  Vali Loss: 0.0357377 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.347445011138916
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0095120  Vali Loss: 0.0359099 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.348296880722046
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0075372  Vali Loss: 0.0361863 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 1.3451197147369385
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0084946  Vali Loss: 0.0361307 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 1.3467791080474854
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0084286  Vali Loss: 0.0359935 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 1.3479199409484863
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0090191  Vali Loss: 0.0359393 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.3510360717773438
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0088489  Vali Loss: 0.0358973 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.3456523418426514
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0093332  Vali Loss: 0.0358611 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.348513126373291
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0096505  Vali Loss: 0.0358290 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.348254680633545
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0084716  Vali Loss: 0.0358668 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898201  Test macro F1 0.9874286 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4774374961853027
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0100564  Vali Loss: 0.0314455 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
Validation loss decreased (inf --> 0.031445).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4747302532196045
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0094581  Vali Loss: 0.0363479 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4706001281738281
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0085408  Vali Loss: 0.0333401 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.475536823272705
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0105433  Vali Loss: 0.0371129 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.4703545570373535
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0075074  Vali Loss: 0.0326601 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.4744868278503418
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0085739  Vali Loss: 0.0398815 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4725029468536377
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0075097  Vali Loss: 0.0393934 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4763431549072266
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0071178  Vali Loss: 0.0269154 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.031445 --> 0.026915).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.4692456722259521
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0063299  Vali Loss: 0.0362840 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.4765000343322754
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0067842  Vali Loss: 0.0353003 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.4713404178619385
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0061476  Vali Loss: 0.0312207 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.4763216972351074
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0057483  Vali Loss: 0.0393826 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.4700915813446045
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0058967  Vali Loss: 0.0268152 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.026915 --> 0.026815).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.4753081798553467
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0061058  Vali Loss: 0.0410220 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.470719814300537
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0064295  Vali Loss: 0.0281457 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.4773123264312744
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0060945  Vali Loss: 0.0371360 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.4707281589508057
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0065603  Vali Loss: 0.0280854 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.4769437313079834
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0079177  Vali Loss: 0.0265300 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.026815 --> 0.026530).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.4692583084106445
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0057531  Vali Loss: 0.0325078 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.4758858680725098
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0052074  Vali Loss: 0.0376928 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.4695274829864502
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0046897  Vali Loss: 0.0284520 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.4778797626495361
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0048076  Vali Loss: 0.0322254 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.4688467979431152
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0041196  Vali Loss: 0.0359320 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 1.4777729511260986
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0050012  Vali Loss: 0.0359246 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 1.4711809158325195
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0041320  Vali Loss: 0.0346110 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 1.4771387577056885
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0039593  Vali Loss: 0.0338104 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 1.4720306396484375
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0043978  Vali Loss: 0.0334957 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 1.4770183563232422
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0042667  Vali Loss: 0.0330816 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 1.4701097011566162
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0042740  Vali Loss: 0.0331319 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.4743878841400146
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0041692  Vali Loss: 0.0331507 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.4700210094451904
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0043605  Vali Loss: 0.0331833 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 1.4746263027191162
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0041262  Vali Loss: 0.0332353 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 1.4698395729064941
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0037886  Vali Loss: 0.0333511 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909504  Test macro F1 0.9892780 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00266667 0.00239234 0.0023753  0.00332226 0.00595238 0.00568182
 0.00320513 0.00302115 0.00234192 0.00390625]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3415701389312744
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1761051  Vali Loss: 1.8233079 Vali Accuracy: 0.3135593  Vali weighted F1: 0.2370042  Vali macro F1 0.2064310 
Validation loss decreased (inf --> 1.823308).  Saving model ...
Epoch: 2 cost time: 1.3427612781524658
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4143358  Vali Loss: 0.9588105 Vali Accuracy: 0.6666667  Vali weighted F1: 0.6704857  Vali macro F1 0.6366720 
new best score!!!!
Validation loss decreased (1.823308 --> 0.958810).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3402049541473389
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8626977  Vali Loss: 0.6135420 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8183388  Vali macro F1 0.7997444 
new best score!!!!
Validation loss decreased (0.958810 --> 0.613542).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3370087146759033
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5883737  Vali Loss: 0.4206816 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8623579  Vali macro F1 0.8347332 
new best score!!!!
Validation loss decreased (0.613542 --> 0.420682).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3359706401824951
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4426874  Vali Loss: 0.3351402 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8560790  Vali macro F1 0.8031032 
new best score!!!!
Validation loss decreased (0.420682 --> 0.335140).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3370542526245117
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3485658  Vali Loss: 0.2669067 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8983126  Vali macro F1 0.8567658 
new best score!!!!
Validation loss decreased (0.335140 --> 0.266907).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3384647369384766
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2822255  Vali Loss: 0.2433466 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9080834  Vali macro F1 0.8630459 
new best score!!!!
Validation loss decreased (0.266907 --> 0.243347).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.336930274963379
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2451102  Vali Loss: 0.2131006 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8963607  Vali macro F1 0.8425941 
new best score!!!!
Validation loss decreased (0.243347 --> 0.213101).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3375868797302246
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2062899  Vali Loss: 0.1799584 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9197972  Vali macro F1 0.8782619 
new best score!!!!
Validation loss decreased (0.213101 --> 0.179958).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3413934707641602
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1743020  Vali Loss: 0.1506729 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9547231  Vali macro F1 0.9328488 
new best score!!!!
Validation loss decreased (0.179958 --> 0.150673).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3356797695159912
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1526697  Vali Loss: 0.1546220 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9096586  Vali macro F1 0.8549203 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.3529512882232666
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1403500  Vali Loss: 0.1320191 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9367750  Vali macro F1 0.8912599 
new best score!!!!
Validation loss decreased (0.150673 --> 0.132019).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.334362268447876
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1319826  Vali Loss: 0.1335184 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9319724  Vali macro F1 0.8865869 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.336165189743042
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1167333  Vali Loss: 0.1389985 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9349917  Vali macro F1 0.8961361 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 1.336681604385376
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1195752  Vali Loss: 0.1333966 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9346659  Vali macro F1 0.8965536 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 1.3368220329284668
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1083401  Vali Loss: 0.1170698 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9231797  Vali macro F1 0.8777741 
new best score!!!!
Validation loss decreased (0.132019 --> 0.117070).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3373076915740967
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1062985  Vali Loss: 0.1209570 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9514042  Vali macro F1 0.9180605 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3386342525482178
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1046033  Vali Loss: 0.1053861 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9413128  Vali macro F1 0.9052431 
new best score!!!!
Validation loss decreased (0.117070 --> 0.105386).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3356757164001465
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1138953  Vali Loss: 0.1218872 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9432007  Vali macro F1 0.9104232 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3386900424957275
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0978998  Vali Loss: 0.1082522 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9435440  Vali macro F1 0.9051016 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.3388781547546387
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0859089  Vali Loss: 0.0968424 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9522460  Vali macro F1 0.9201483 
new best score!!!!
Validation loss decreased (0.105386 --> 0.096842).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3388872146606445
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0787636  Vali Loss: 0.0921572 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9538093  Vali macro F1 0.9229662 
new best score!!!!
Validation loss decreased (0.096842 --> 0.092157).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3381357192993164
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0792788  Vali Loss: 0.0835657 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9621236  Vali macro F1 0.9353786 
new best score!!!!
Validation loss decreased (0.092157 --> 0.083566).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3390140533447266
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0712812  Vali Loss: 0.0752682 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9701579  Vali macro F1 0.9474359 
new best score!!!!
Validation loss decreased (0.083566 --> 0.075268).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3377833366394043
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0587109  Vali Loss: 0.0714737 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9682461  Vali macro F1 0.9482030 
new best score!!!!
Validation loss decreased (0.075268 --> 0.071474).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3389925956726074
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0606080  Vali Loss: 0.0772398 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9619110  Vali macro F1 0.9324176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.337611198425293
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0529012  Vali Loss: 0.0817826 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9644125  Vali macro F1 0.9419376 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.3373842239379883
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0718038  Vali Loss: 0.0617169 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771578  Vali macro F1 0.9607656 
new best score!!!!
Validation loss decreased (0.071474 --> 0.061717).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3374223709106445
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0509361  Vali Loss: 0.0746336 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9799260  Vali macro F1 0.9667316 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3397796154022217
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0473488  Vali Loss: 0.0875973 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9709490  Vali macro F1 0.9527148 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.3386588096618652
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0363473  Vali Loss: 0.0579034 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770134  Vali macro F1 0.9598039 
new best score!!!!
Validation loss decreased (0.061717 --> 0.057903).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3421194553375244
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0312144  Vali Loss: 0.0388866 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887140  Vali macro F1 0.9804762 
new best score!!!!
Validation loss decreased (0.057903 --> 0.038887).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.343212604522705
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0299003  Vali Loss: 0.0481441 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9827601  Vali macro F1 0.9698529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.343040943145752
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0338653  Vali Loss: 0.0447122 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9827011  Vali macro F1 0.9725165 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 1.3443610668182373
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0305683  Vali Loss: 0.0429609 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887070  Vali macro F1 0.9856411 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 1.3532254695892334
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0259778  Vali Loss: 0.0644421 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801020  Vali macro F1 0.9692664 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 1.3408727645874023
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0244199  Vali Loss: 0.0465678 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829663  Vali macro F1 0.9734237 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 1.3415610790252686
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0259593  Vali Loss: 0.0354590 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915162  Vali macro F1 0.9870700 
new best score!!!!
Validation loss decreased (0.038887 --> 0.035459).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3397438526153564
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0177499  Vali Loss: 0.0343117 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.035459 --> 0.034312).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3411612510681152
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0148956  Vali Loss: 0.0289585 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.034312 --> 0.028958).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3515143394470215
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0153984  Vali Loss: 0.0276863 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.028958 --> 0.027686).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3449716567993164
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0138534  Vali Loss: 0.0279172 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3382728099822998
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0136893  Vali Loss: 0.0276498 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.027686 --> 0.027650).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3398525714874268
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0150954  Vali Loss: 0.0289424 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3404524326324463
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0132037  Vali Loss: 0.0281534 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.3401358127593994
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0129607  Vali Loss: 0.0296329 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915162  Vali macro F1 0.9870700 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.3382930755615234
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0135008  Vali Loss: 0.0299867 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.3381562232971191
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0129334  Vali Loss: 0.0300487 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 1.3384754657745361
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0117151  Vali Loss: 0.0298827 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3372383117675781
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0127835  Vali Loss: 0.0290294 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3380098342895508
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0130434  Vali Loss: 0.0282825 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3366639614105225
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0124760  Vali Loss: 0.0276617 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.340616226196289
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0141944  Vali Loss: 0.0276081 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.027650 --> 0.027608).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.340024471282959
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0126885  Vali Loss: 0.0275068 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.027608 --> 0.027507).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.340425729751587
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0121225  Vali Loss: 0.0274520 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.027507 --> 0.027452).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.3411715030670166
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0131645  Vali Loss: 0.0274749 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.3407070636749268
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0120350  Vali Loss: 0.0276139 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.3433489799499512
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0123145  Vali Loss: 0.0276021 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 1.3378660678863525
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0119191  Vali Loss: 0.0275595 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 1.3393735885620117
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0121402  Vali Loss: 0.0273257 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.027452 --> 0.027326).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.3390939235687256
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0126012  Vali Loss: 0.0275115 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 1.3390648365020752
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0131093  Vali Loss: 0.0271748 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.027326 --> 0.027175).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.339172124862671
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0125065  Vali Loss: 0.0272070 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.3378591537475586
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0133937  Vali Loss: 0.0270487 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.027175 --> 0.027049).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.3366460800170898
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0110579  Vali Loss: 0.0269730 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.027049 --> 0.026973).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.3393995761871338
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0134364  Vali Loss: 0.0271838 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.341719150543213
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0124709  Vali Loss: 0.0267999 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.026973 --> 0.026800).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.340728521347046
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0114620  Vali Loss: 0.0271377 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.3555519580841064
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0115544  Vali Loss: 0.0272673 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.3404438495635986
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0134223  Vali Loss: 0.0274213 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 1.3425803184509277
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0123301  Vali Loss: 0.0271051 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 1.3408441543579102
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0125002  Vali Loss: 0.0270393 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 73 cost time: 1.340027093887329
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0117437  Vali Loss: 0.0270608 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 1.3389792442321777
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0130047  Vali Loss: 0.0270295 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 1.339818000793457
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0116213  Vali Loss: 0.0269940 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 1.3465232849121094
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0127703  Vali Loss: 0.0269633 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 1.3410367965698242
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0127276  Vali Loss: 0.0269213 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 78 cost time: 1.3388562202453613
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0118623  Vali Loss: 0.0269185 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 1.339797019958496
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0126480  Vali Loss: 0.0269177 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 1.3397786617279053
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0112061  Vali Loss: 0.0269172 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 1.3393208980560303
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0118994  Vali Loss: 0.0269186 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 1.3363442420959473
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0115345  Vali Loss: 0.0269180 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9830317  Test weighted F1: 0.9830727  Test macro F1 0.9763975 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.470538854598999
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0130871  Vali Loss: 0.0245694 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
Validation loss decreased (inf --> 0.024569).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4665172100067139
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0120010  Vali Loss: 0.0283667 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915162  Vali macro F1 0.9870700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.466817855834961
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0119498  Vali Loss: 0.0285555 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915162  Vali macro F1 0.9870700 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4677436351776123
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0116244  Vali Loss: 0.0316041 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.4679584503173828
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0120125  Vali Loss: 0.0186693 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.024569 --> 0.018669).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.4670953750610352
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0103355  Vali Loss: 0.0244496 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4695158004760742
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0093598  Vali Loss: 0.0236492 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.469531536102295
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0093234  Vali Loss: 0.0199246 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.469590663909912
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0082382  Vali Loss: 0.0197416 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.470641851425171
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0087484  Vali Loss: 0.0201835 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.4695990085601807
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0096197  Vali Loss: 0.0222285 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4664268493652344
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0101522  Vali Loss: 0.0367571 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.4671404361724854
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0112051  Vali Loss: 0.0189864 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.468198299407959
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0093548  Vali Loss: 0.0286428 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.4656562805175781
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0092909  Vali Loss: 0.0259327 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 1.4689483642578125
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0072215  Vali Loss: 0.0242525 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.467829704284668
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0074067  Vali Loss: 0.0249486 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.4668359756469727
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0080309  Vali Loss: 0.0250951 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.4670841693878174
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0086804  Vali Loss: 0.0257796 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.4655985832214355
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0065661  Vali Loss: 0.0260371 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9819005  Test weighted F1: 0.9819946  Test macro F1 0.9769606 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00277008 0.00236407 0.00247525 0.00325733 0.00543478 0.00574713
 0.00328947 0.00277008 0.00242131 0.00393701]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.335289716720581
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1724714  Vali Loss: 1.8390114 Vali Accuracy: 0.3135593  Vali weighted F1: 0.2329619  Vali macro F1 0.2027148 
Validation loss decreased (inf --> 1.839011).  Saving model ...
Epoch: 2 cost time: 1.3345897197723389
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4402358  Vali Loss: 0.9780646 Vali Accuracy: 0.6723164  Vali weighted F1: 0.6662054  Vali macro F1 0.6370078 
new best score!!!!
Validation loss decreased (1.839011 --> 0.978065).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.333608627319336
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8802946  Vali Loss: 0.6229821 Vali Accuracy: 0.7796610  Vali weighted F1: 0.7728133  Vali macro F1 0.7441881 
new best score!!!!
Validation loss decreased (0.978065 --> 0.622982).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3326857089996338
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6063938  Vali Loss: 0.4440754 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8537888  Vali macro F1 0.8211452 
new best score!!!!
Validation loss decreased (0.622982 --> 0.444075).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3325679302215576
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4525483  Vali Loss: 0.3337151 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8583647  Vali macro F1 0.8076220 
new best score!!!!
Validation loss decreased (0.444075 --> 0.333715).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3299684524536133
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3601560  Vali Loss: 0.2816437 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8725448  Vali macro F1 0.8204004 
new best score!!!!
Validation loss decreased (0.333715 --> 0.281644).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.332197666168213
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2918760  Vali Loss: 0.2399461 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9094438  Vali macro F1 0.8609111 
new best score!!!!
Validation loss decreased (0.281644 --> 0.239946).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3327336311340332
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2502981  Vali Loss: 0.1878176 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9290400  Vali macro F1 0.8943272 
new best score!!!!
Validation loss decreased (0.239946 --> 0.187818).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3330864906311035
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2057718  Vali Loss: 0.1810544 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9222905  Vali macro F1 0.8869875 
new best score!!!!
Validation loss decreased (0.187818 --> 0.181054).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3346548080444336
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1769379  Vali Loss: 0.1444948 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9195369  Vali macro F1 0.8724474 
new best score!!!!
Validation loss decreased (0.181054 --> 0.144495).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3320326805114746
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1622652  Vali Loss: 0.1385433 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9156498  Vali macro F1 0.8649376 
new best score!!!!
Validation loss decreased (0.144495 --> 0.138543).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.331791639328003
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1436181  Vali Loss: 0.1155817 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9547930  Vali macro F1 0.9237079 
new best score!!!!
Validation loss decreased (0.138543 --> 0.115582).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3337814807891846
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1344453  Vali Loss: 0.1328821 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9375800  Vali macro F1 0.9046369 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.3325669765472412
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1370260  Vali Loss: 0.1153948 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9247575  Vali macro F1 0.8675541 
new best score!!!!
Validation loss decreased (0.115582 --> 0.115395).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3324666023254395
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1236617  Vali Loss: 0.1085513 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9275850  Vali macro F1 0.8698413 
new best score!!!!
Validation loss decreased (0.115395 --> 0.108551).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3335673809051514
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1124419  Vali Loss: 0.1018606 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9594685  Vali macro F1 0.9282155 
new best score!!!!
Validation loss decreased (0.108551 --> 0.101861).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.335127592086792
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1036814  Vali Loss: 0.0949778 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9518620  Vali macro F1 0.9162763 
new best score!!!!
Validation loss decreased (0.101861 --> 0.094978).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3380560874938965
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0985256  Vali Loss: 0.0984559 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9550441  Vali macro F1 0.9263869 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3388822078704834
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1021941  Vali Loss: 0.1206418 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9219235  Vali macro F1 0.8644327 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.3455519676208496
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1131001  Vali Loss: 0.0990284 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9397419  Vali macro F1 0.8957403 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 1.338712215423584
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0985469  Vali Loss: 0.0890529 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9498512  Vali macro F1 0.9118280 
new best score!!!!
Validation loss decreased (0.094978 --> 0.089053).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.361180067062378
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0950559  Vali Loss: 0.0839363 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688519  Vali macro F1 0.9458258 
new best score!!!!
Validation loss decreased (0.089053 --> 0.083936).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3419580459594727
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0833514  Vali Loss: 0.0751615 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742981  Vali macro F1 0.9551368 
new best score!!!!
Validation loss decreased (0.083936 --> 0.075161).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3404262065887451
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0856097  Vali Loss: 0.0786834 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661421  Vali macro F1 0.9414286 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3385088443756104
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0750012  Vali Loss: 0.1007482 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9478070  Vali macro F1 0.9145644 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.339036464691162
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0698127  Vali Loss: 0.0949771 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9599434  Vali macro F1 0.9393650 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 1.3393526077270508
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0626261  Vali Loss: 0.0808445 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9541142  Vali macro F1 0.9244076 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 1.3382773399353027
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0572845  Vali Loss: 0.0675314 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801233  Vali macro F1 0.9681620 
new best score!!!!
Validation loss decreased (0.075161 --> 0.067531).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.338524341583252
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0479936  Vali Loss: 0.0533838 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9797368  Vali macro F1 0.9645022 
new best score!!!!
Validation loss decreased (0.067531 --> 0.053384).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3391234874725342
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0481833  Vali Loss: 0.0599770 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9765164  Vali macro F1 0.9605725 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3420870304107666
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0444905  Vali Loss: 0.0475034 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9827601  Vali macro F1 0.9698529 
new best score!!!!
Validation loss decreased (0.053384 --> 0.047503).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3403894901275635
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0361546  Vali Loss: 0.0636337 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9768265  Vali macro F1 0.9649928 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3403842449188232
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0303899  Vali Loss: 0.0583675 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9765253  Vali macro F1 0.9615660 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3391757011413574
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0286884  Vali Loss: 0.0370182 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858072  Vali macro F1 0.9780653 
new best score!!!!
Validation loss decreased (0.047503 --> 0.037018).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3400177955627441
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0259336  Vali Loss: 0.0401649 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800733  Vali macro F1 0.9706682 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3424365520477295
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0194591  Vali Loss: 0.0336789 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886683  Vali macro F1 0.9856889 
new best score!!!!
Validation loss decreased (0.037018 --> 0.033679).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.343522310256958
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0220166  Vali Loss: 0.0457778 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830891  Vali macro F1 0.9770675 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3438386917114258
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0328703  Vali Loss: 0.0672520 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9796536  Vali macro F1 0.9671221 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.34238862991333
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0274359  Vali Loss: 0.0457958 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915285  Vali macro F1 0.9905133 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.3392012119293213
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0215865  Vali Loss: 0.0414816 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830668  Vali macro F1 0.9786484 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 1.3376381397247314
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0166814  Vali Loss: 0.0267177 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
new best score!!!!
Validation loss decreased (0.033679 --> 0.026718).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3426852226257324
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0183619  Vali Loss: 0.0383700 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9856815  Vali macro F1 0.9777741 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3400099277496338
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0169112  Vali Loss: 0.0344245 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3418347835540771
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0142031  Vali Loss: 0.0420574 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886751  Vali macro F1 0.9877505 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.3379607200622559
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0147694  Vali Loss: 0.0506751 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831811  Vali macro F1 0.9801726 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 1.3400375843048096
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0200001  Vali Loss: 0.0526456 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 1.3409934043884277
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0158764  Vali Loss: 0.0373182 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3372814655303955
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0109972  Vali Loss: 0.0282840 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.343935251235962
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0100705  Vali Loss: 0.0294797 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.3407950401306152
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0085207  Vali Loss: 0.0260944 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.026718 --> 0.026094).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.3378164768218994
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0096719  Vali Loss: 0.0278049 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.337733268737793
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0082726  Vali Loss: 0.0319488 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.3569066524505615
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0100359  Vali Loss: 0.0330405 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.339188575744629
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0088125  Vali Loss: 0.0337212 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915355  Vali macro F1 0.9853309 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.340843677520752
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0087965  Vali Loss: 0.0336806 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 1.3400623798370361
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0077883  Vali Loss: 0.0337855 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.3393969535827637
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0081531  Vali Loss: 0.0337702 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.3406691551208496
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0070640  Vali Loss: 0.0336494 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 1.3381497859954834
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0075682  Vali Loss: 0.0335136 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 1.3384411334991455
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0081392  Vali Loss: 0.0333787 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 1.3353214263916016
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0082005  Vali Loss: 0.0333812 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 1.3375017642974854
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0083526  Vali Loss: 0.0333716 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 1.3357112407684326
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0077852  Vali Loss: 0.0333735 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 1.3359897136688232
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0086304  Vali Loss: 0.0333535 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 1.3362269401550293
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0076569  Vali Loss: 0.0333296 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943403  Test macro F1 0.9940248 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4805901050567627
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0098485  Vali Loss: 0.0300831 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
Validation loss decreased (inf --> 0.030083).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4791324138641357
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0092823  Vali Loss: 0.0310194 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4759676456451416
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0079697  Vali Loss: 0.0277425 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
new best score!!!!
Validation loss decreased (0.030083 --> 0.027743).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.476944923400879
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0082322  Vali Loss: 0.0310671 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.4778187274932861
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0072474  Vali Loss: 0.0339376 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.4765064716339111
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0073998  Vali Loss: 0.0289290 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.477207899093628
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0065412  Vali Loss: 0.0311670 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.4781811237335205
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0056076  Vali Loss: 0.0302700 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.4765880107879639
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0059028  Vali Loss: 0.0394482 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.4801580905914307
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0055322  Vali Loss: 0.0319054 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.4753773212432861
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0058163  Vali Loss: 0.0276720 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
new best score!!!!
Validation loss decreased (0.027743 --> 0.027672).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.4772813320159912
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0053040  Vali Loss: 0.0271961 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
new best score!!!!
Validation loss decreased (0.027672 --> 0.027196).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.4793469905853271
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0069259  Vali Loss: 0.0286944 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.478534460067749
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0050908  Vali Loss: 0.0334641 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.476534128189087
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0049258  Vali Loss: 0.0402210 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915251  Vali macro F1 0.9880635 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.4781630039215088
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0050371  Vali Loss: 0.0336307 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.4768164157867432
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0060993  Vali Loss: 0.0311647 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 1.4758274555206299
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0050778  Vali Loss: 0.0308619 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.4769160747528076
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0043160  Vali Loss: 0.0306861 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.4777882099151611
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0050689  Vali Loss: 0.0302614 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.4775230884552002
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0048657  Vali Loss: 0.0301546 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.4768519401550293
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0049936  Vali Loss: 0.0308324 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 1.4772529602050781
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0045178  Vali Loss: 0.0308199 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.475437879562378
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0046025  Vali Loss: 0.0307801 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.4762349128723145
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0041942  Vali Loss: 0.0307688 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.4781014919281006
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0044100  Vali Loss: 0.0307669 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.4759140014648438
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0046592  Vali Loss: 0.0307740 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943432  Vali macro F1 0.9929472 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9966063  Test weighted F1: 0.9966053  Test macro F1 0.9958896 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00271003 0.0023753  0.00240964 0.00321543 0.00543478 0.00591716
 0.00318471 0.00295858 0.00248756 0.00381679]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3445558547973633
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1844640  Vali Loss: 1.8417259 Vali Accuracy: 0.3022599  Vali weighted F1: 0.2224658  Vali macro F1 0.1976943 
Validation loss decreased (inf --> 1.841726).  Saving model ...
Epoch: 2 cost time: 1.3410935401916504
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4418872  Vali Loss: 0.9966793 Vali Accuracy: 0.6271186  Vali weighted F1: 0.6212048  Vali macro F1 0.5874928 
new best score!!!!
Validation loss decreased (1.841726 --> 0.996679).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3381857872009277
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.8953704  Vali Loss: 0.6720281 Vali Accuracy: 0.7372881  Vali weighted F1: 0.7343095  Vali macro F1 0.7054124 
new best score!!!!
Validation loss decreased (0.996679 --> 0.672028).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.337634801864624
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6137303  Vali Loss: 0.4356584 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8252920  Vali macro F1 0.7759657 
new best score!!!!
Validation loss decreased (0.672028 --> 0.435658).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3372249603271484
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4535909  Vali Loss: 0.3501361 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8677345  Vali macro F1 0.8184743 
new best score!!!!
Validation loss decreased (0.435658 --> 0.350136).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3347446918487549
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3605380  Vali Loss: 0.2866762 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8752694  Vali macro F1 0.8262877 
new best score!!!!
Validation loss decreased (0.350136 --> 0.286676).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3356518745422363
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2995382  Vali Loss: 0.2817178 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8804057  Vali macro F1 0.8337164 
new best score!!!!
Validation loss decreased (0.286676 --> 0.281718).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3403398990631104
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2601911  Vali Loss: 0.1984889 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9048361  Vali macro F1 0.8575942 
new best score!!!!
Validation loss decreased (0.281718 --> 0.198489).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3379521369934082
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2158537  Vali Loss: 0.1612920 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9362873  Vali macro F1 0.9027507 
new best score!!!!
Validation loss decreased (0.198489 --> 0.161292).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3370647430419922
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1798577  Vali Loss: 0.1488264 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9452127  Vali macro F1 0.9140816 
new best score!!!!
Validation loss decreased (0.161292 --> 0.148826).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3401222229003906
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1592255  Vali Loss: 0.1390842 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9277381  Vali macro F1 0.8901390 
new best score!!!!
Validation loss decreased (0.148826 --> 0.139084).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.335416555404663
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1497022  Vali Loss: 0.1334494 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9378857  Vali macro F1 0.8992550 
new best score!!!!
Validation loss decreased (0.139084 --> 0.133449).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3426234722137451
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1385374  Vali Loss: 0.1156802 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9335743  Vali macro F1 0.8857773 
new best score!!!!
Validation loss decreased (0.133449 --> 0.115680).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3366429805755615
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1349551  Vali Loss: 0.1195409 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9247619  Vali macro F1 0.8675612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3357741832733154
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1256148  Vali Loss: 0.1160513 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9300736  Vali macro F1 0.8861329 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 1.3360645771026611
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1289904  Vali Loss: 0.1273518 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9293748  Vali macro F1 0.8902606 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 1.3560192584991455
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1219717  Vali Loss: 0.1192560 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9341894  Vali macro F1 0.8965265 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 18 cost time: 1.3373181819915771
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1108251  Vali Loss: 0.1017179 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9566715  Vali macro F1 0.9285484 
new best score!!!!
Validation loss decreased (0.115680 --> 0.101718).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.336747646331787
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1050311  Vali Loss: 0.0984957 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9387138  Vali macro F1 0.8961747 
new best score!!!!
Validation loss decreased (0.101718 --> 0.098496).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3363633155822754
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1068610  Vali Loss: 0.1192490 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9372935  Vali macro F1 0.8976359 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.338932991027832
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0986435  Vali Loss: 0.1005201 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9500939  Vali macro F1 0.9167997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3396830558776855
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1014983  Vali Loss: 0.0896458 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9486267  Vali macro F1 0.9131305 
new best score!!!!
Validation loss decreased (0.098496 --> 0.089646).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.337003469467163
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0910719  Vali Loss: 0.0857709 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9598341  Vali macro F1 0.9338481 
new best score!!!!
Validation loss decreased (0.089646 --> 0.085771).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3381543159484863
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0897644  Vali Loss: 0.0894976 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9462198  Vali macro F1 0.9110644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3386869430541992
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0853401  Vali Loss: 0.0855782 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9566455  Vali macro F1 0.9259354 
new best score!!!!
Validation loss decreased (0.085771 --> 0.085578).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3386926651000977
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0792691  Vali Loss: 0.0825521 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9573787  Vali macro F1 0.9253056 
new best score!!!!
Validation loss decreased (0.085578 --> 0.082552).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3395147323608398
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0708351  Vali Loss: 0.0809469 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631886  Vali macro F1 0.9359760 
new best score!!!!
Validation loss decreased (0.082552 --> 0.080947).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3359336853027344
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0671697  Vali Loss: 0.0653656 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9693226  Vali macro F1 0.9457672 
new best score!!!!
Validation loss decreased (0.080947 --> 0.065366).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3389437198638916
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0583011  Vali Loss: 0.0659084 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9733120  Vali macro F1 0.9550553 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3374264240264893
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0554613  Vali Loss: 0.0491950 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829485  Vali macro F1 0.9702899 
new best score!!!!
Validation loss decreased (0.065366 --> 0.049195).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3376827239990234
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0470785  Vali Loss: 0.0500129 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3372447490692139
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0448054  Vali Loss: 0.0531067 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9824788  Vali macro F1 0.9692500 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.3371241092681885
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0414575  Vali Loss: 0.0549242 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9827119  Vali macro F1 0.9717510 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.3385329246520996
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0356809  Vali Loss: 0.0539746 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858926  Vali macro F1 0.9755516 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 1.3365569114685059
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0386896  Vali Loss: 0.0510237 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9765361  Vali macro F1 0.9608004 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 36 cost time: 1.337742567062378
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0362916  Vali Loss: 0.0290291 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
new best score!!!!
Validation loss decreased (0.049195 --> 0.029029).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3382022380828857
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0263640  Vali Loss: 0.0361589 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9824788  Vali macro F1 0.9692500 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.33713960647583
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0254937  Vali Loss: 0.0240931 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.029029 --> 0.024093).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3398284912109375
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0239289  Vali Loss: 0.0253840 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.339390516281128
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0225344  Vali Loss: 0.0224345 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
new best score!!!!
Validation loss decreased (0.024093 --> 0.022435).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3406388759613037
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0218133  Vali Loss: 0.0224615 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3379294872283936
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0206733  Vali Loss: 0.0214717 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
new best score!!!!
Validation loss decreased (0.022435 --> 0.021472).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3400866985321045
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0219575  Vali Loss: 0.0200262 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
new best score!!!!
Validation loss decreased (0.021472 --> 0.020026).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3404533863067627
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0207966  Vali Loss: 0.0182236 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.020026 --> 0.018224).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3384411334991455
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0224297  Vali Loss: 0.0207553 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3412880897521973
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0221138  Vali Loss: 0.0190289 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.338602066040039
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0207433  Vali Loss: 0.0196424 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.3491215705871582
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0197160  Vali Loss: 0.0220275 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 1.3403537273406982
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0199125  Vali Loss: 0.0196197 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 1.338789463043213
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0183013  Vali Loss: 0.0192551 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.337998867034912
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0198405  Vali Loss: 0.0191852 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.3399295806884766
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0185868  Vali Loss: 0.0188230 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.3386449813842773
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0187700  Vali Loss: 0.0188051 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 1.3386943340301514
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0198821  Vali Loss: 0.0185343 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 1.3361778259277344
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0201338  Vali Loss: 0.0185355 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.338860273361206
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0188571  Vali Loss: 0.0185694 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.3369557857513428
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0192987  Vali Loss: 0.0185872 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.3370881080627441
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0188211  Vali Loss: 0.0185722 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.3369593620300293
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0189694  Vali Loss: 0.0185967 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943415  Test macro F1 0.9943961 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.472069501876831
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0221940  Vali Loss: 0.0187998 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
Validation loss decreased (inf --> 0.018800).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.471052885055542
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0215498  Vali Loss: 0.0227110 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914327  Vali macro F1 0.9850456 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4690330028533936
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0219885  Vali Loss: 0.0189235 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.4689064025878906
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0213648  Vali Loss: 0.0210574 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.4684860706329346
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0187153  Vali Loss: 0.0168524 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.018800 --> 0.016852).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.4724819660186768
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0197144  Vali Loss: 0.0217431 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914327  Vali macro F1 0.9850456 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4690990447998047
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0183418  Vali Loss: 0.0158203 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.016852 --> 0.015820).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.4710843563079834
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0161797  Vali Loss: 0.0147622 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.015820 --> 0.014762).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.4717020988464355
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0173115  Vali Loss: 0.0153668 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.4749395847320557
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0152501  Vali Loss: 0.0139313 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014762 --> 0.013931).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.4712488651275635
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0152260  Vali Loss: 0.0134748 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013931 --> 0.013475).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.4710025787353516
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0160022  Vali Loss: 0.0151875 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.470776081085205
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0169316  Vali Loss: 0.0150048 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.4756035804748535
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0140141  Vali Loss: 0.0110293 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013475 --> 0.011029).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.4696600437164307
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0142028  Vali Loss: 0.0125723 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.4737119674682617
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0147501  Vali Loss: 0.0112560 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.4700639247894287
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0144419  Vali Loss: 0.0108660 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011029 --> 0.010866).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 1.469513177871704
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0157493  Vali Loss: 0.0101496 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010866 --> 0.010150).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.4695994853973389
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0153577  Vali Loss: 0.0121625 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.4697892665863037
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0119324  Vali Loss: 0.0103799 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.4680373668670654
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0128879  Vali Loss: 0.0103280 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.4693689346313477
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0125066  Vali Loss: 0.0106909 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.4715020656585693
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0116000  Vali Loss: 0.0102826 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 24 cost time: 1.4746742248535156
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0127625  Vali Loss: 0.0107267 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 1.4673540592193604
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0130216  Vali Loss: 0.0100376 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010150 --> 0.010038).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 1.4709444046020508
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0114161  Vali Loss: 0.0105083 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.4701027870178223
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0113187  Vali Loss: 0.0085309 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010038 --> 0.008531).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 1.4711346626281738
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0116144  Vali Loss: 0.0098968 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.4684412479400635
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0109071  Vali Loss: 0.0096282 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.471257209777832
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0103535  Vali Loss: 0.0071372 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008531 --> 0.007137).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 1.4723389148712158
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0090271  Vali Loss: 0.0086629 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 1.4700086116790771
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0100898  Vali Loss: 0.0095821 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 1.4714062213897705
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0102996  Vali Loss: 0.0100154 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 1.4709556102752686
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0108101  Vali Loss: 0.0092011 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 1.4733946323394775
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0098647  Vali Loss: 0.0116069 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 36 cost time: 1.4693737030029297
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0087686  Vali Loss: 0.0117930 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 1.4710040092468262
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0088011  Vali Loss: 0.0116649 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 1.4684295654296875
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0085360  Vali Loss: 0.0109567 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 1.4674246311187744
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0095089  Vali Loss: 0.0107486 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 1.4693350791931152
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0078405  Vali Loss: 0.0101187 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 41 cost time: 1.471834659576416
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0091854  Vali Loss: 0.0101318 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 1.470592737197876
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0100484  Vali Loss: 0.0100511 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 1.4683191776275635
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0081565  Vali Loss: 0.0100832 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 1.4705944061279297
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0089052  Vali Loss: 0.0101179 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 1.4696474075317383
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0091956  Vali Loss: 0.0101613 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9954751  Test weighted F1: 0.9954801  Test macro F1 0.9953023 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00280112 0.00238095 0.00246914 0.00320513 0.00543478 0.00588235
 0.00315457 0.00289017 0.00235849 0.00404858]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3355495929718018
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1882600  Vali Loss: 1.8002871 Vali Accuracy: 0.3248588  Vali weighted F1: 0.2422335  Vali macro F1 0.1861611 
Validation loss decreased (inf --> 1.800287).  Saving model ...
Epoch: 2 cost time: 1.3364264965057373
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.4522395  Vali Loss: 0.9921905 Vali Accuracy: 0.6892655  Vali weighted F1: 0.6712586  Vali macro F1 0.6451541 
new best score!!!!
Validation loss decreased (1.800287 --> 0.992190).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3340728282928467
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.9021164  Vali Loss: 0.6724387 Vali Accuracy: 0.7966102  Vali weighted F1: 0.7821712  Vali macro F1 0.7593429 
new best score!!!!
Validation loss decreased (0.992190 --> 0.672439).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3334214687347412
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.6124489  Vali Loss: 0.4904223 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8179940  Vali macro F1 0.7812012 
new best score!!!!
Validation loss decreased (0.672439 --> 0.490422).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3343594074249268
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.4594266  Vali Loss: 0.3954168 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8674162  Vali macro F1 0.8384480 
new best score!!!!
Validation loss decreased (0.490422 --> 0.395417).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3355419635772705
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.3729933  Vali Loss: 0.3011642 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8903544  Vali macro F1 0.8559378 
new best score!!!!
Validation loss decreased (0.395417 --> 0.301164).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.335792064666748
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2984959  Vali Loss: 0.2420456 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9127351  Vali macro F1 0.8821088 
new best score!!!!
Validation loss decreased (0.301164 --> 0.242046).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3366053104400635
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2538525  Vali Loss: 0.2239559 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9400856  Vali macro F1 0.9232091 
new best score!!!!
Validation loss decreased (0.242046 --> 0.223956).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3352019786834717
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2163706  Vali Loss: 0.1922920 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9114107  Vali macro F1 0.8643849 
new best score!!!!
Validation loss decreased (0.223956 --> 0.192292).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3356683254241943
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1772091  Vali Loss: 0.1481752 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9185030  Vali macro F1 0.8596829 
new best score!!!!
Validation loss decreased (0.192292 --> 0.148175).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3355474472045898
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1593152  Vali Loss: 0.1349461 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9117845  Vali macro F1 0.8592577 
new best score!!!!
Validation loss decreased (0.148175 --> 0.134946).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3364977836608887
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1465544  Vali Loss: 0.1450897 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9226950  Vali macro F1 0.8676011 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3362751007080078
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1338988  Vali Loss: 0.1262142 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9359264  Vali macro F1 0.9053515 
new best score!!!!
Validation loss decreased (0.134946 --> 0.126214).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3351948261260986
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1321830  Vali Loss: 0.1362788 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9476406  Vali macro F1 0.9266071 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3362469673156738
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1483872  Vali Loss: 0.1273826 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689745  Vali macro F1 0.9504399 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 1.3358616828918457
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1180399  Vali Loss: 0.1129304 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605257  Vali macro F1 0.9452466 
new best score!!!!
Validation loss decreased (0.126214 --> 0.112930).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3354580402374268
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1128228  Vali Loss: 0.1049778 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9417979  Vali macro F1 0.9019133 
new best score!!!!
Validation loss decreased (0.112930 --> 0.104978).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.335505723953247
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1081724  Vali Loss: 0.0971830 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631980  Vali macro F1 0.9395543 
new best score!!!!
Validation loss decreased (0.104978 --> 0.097183).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3352024555206299
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1067660  Vali Loss: 0.1018135 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9160544  Vali macro F1 0.8648331 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3348639011383057
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0943377  Vali Loss: 0.0844075 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9623716  Vali macro F1 0.9338455 
new best score!!!!
Validation loss decreased (0.097183 --> 0.084407).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3376471996307373
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0859416  Vali Loss: 0.0773987 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774435  Vali macro F1 0.9620871 
new best score!!!!
Validation loss decreased (0.084407 --> 0.077399).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3365566730499268
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0832105  Vali Loss: 0.0786607 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9730849  Vali macro F1 0.9538894 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3373594284057617
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0757517  Vali Loss: 0.0651796 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9741953  Vali macro F1 0.9615823 
new best score!!!!
Validation loss decreased (0.077399 --> 0.065180).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.336012363433838
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0712155  Vali Loss: 0.0673278 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9764972  Vali macro F1 0.9573333 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3424501419067383
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0680352  Vali Loss: 0.0460811 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915383  Vali macro F1 0.9878204 
new best score!!!!
Validation loss decreased (0.065180 --> 0.046081).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3375492095947266
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0614604  Vali Loss: 0.0522384 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830225  Vali macro F1 0.9777334 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.338163137435913
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0530026  Vali Loss: 0.0492550 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801530  Vali macro F1 0.9777538 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.3361589908599854
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0478146  Vali Loss: 0.0538082 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858886  Vali macro F1 0.9823698 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 1.3553285598754883
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0425098  Vali Loss: 0.0317786 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
new best score!!!!
Validation loss decreased (0.046081 --> 0.031779).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3377938270568848
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0341982  Vali Loss: 0.0272080 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915383  Vali macro F1 0.9878204 
new best score!!!!
Validation loss decreased (0.031779 --> 0.027208).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3365342617034912
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0311691  Vali Loss: 0.0379712 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885845  Vali macro F1 0.9823716 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.336582899093628
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0394992  Vali Loss: 0.0315682 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887152  Vali macro F1 0.9828361 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.338519811630249
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0305432  Vali Loss: 0.0251177 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
new best score!!!!
Validation loss decreased (0.027208 --> 0.025118).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.336118459701538
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0264913  Vali Loss: 0.0176729 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943644  Vali macro F1 0.9899749 
new best score!!!!
Validation loss decreased (0.025118 --> 0.017673).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3366684913635254
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0201950  Vali Loss: 0.0169883 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
new best score!!!!
Validation loss decreased (0.017673 --> 0.016988).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3377084732055664
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0178729  Vali Loss: 0.0192662 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915242  Vali macro F1 0.9906582 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3362455368041992
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0159602  Vali Loss: 0.0199317 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3357083797454834
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0154895  Vali Loss: 0.0215644 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.336237907409668
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0181197  Vali Loss: 0.0184594 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.3357675075531006
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0144257  Vali Loss: 0.0157385 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915365  Vali macro F1 0.9901053 
new best score!!!!
Validation loss decreased (0.016988 --> 0.015739).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3353757858276367
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0141065  Vali Loss: 0.0129258 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971755  Vali macro F1 0.9977270 
new best score!!!!
Validation loss decreased (0.015739 --> 0.012926).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3330998420715332
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0143931  Vali Loss: 0.0187982 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3379433155059814
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0112082  Vali Loss: 0.0172109 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3367037773132324
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0110534  Vali Loss: 0.0162859 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.336925745010376
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0150866  Vali Loss: 0.0229073 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943644  Vali macro F1 0.9899749 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 1.3353428840637207
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0169722  Vali Loss: 0.0140618 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 1.3364589214324951
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0104240  Vali Loss: 0.0125244 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
new best score!!!!
Validation loss decreased (0.012926 --> 0.012524).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3357276916503906
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0084783  Vali Loss: 0.0124065 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
new best score!!!!
Validation loss decreased (0.012524 --> 0.012406).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.335536241531372
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0085115  Vali Loss: 0.0133254 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.335582971572876
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0067093  Vali Loss: 0.0148396 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3373973369598389
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0067743  Vali Loss: 0.0150493 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3385484218597412
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0060346  Vali Loss: 0.0144568 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.3362739086151123
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0061919  Vali Loss: 0.0142902 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 1.3371644020080566
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0054720  Vali Loss: 0.0143347 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3353278636932373
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0054743  Vali Loss: 0.0143626 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.3406376838684082
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0063313  Vali Loss: 0.0142582 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.3355255126953125
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0058535  Vali Loss: 0.0141715 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.335660457611084
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0061860  Vali Loss: 0.0142060 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 59 cost time: 1.3338954448699951
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0060475  Vali Loss: 0.0142161 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.3342311382293701
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0060772  Vali Loss: 0.0142221 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.334623098373413
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0066173  Vali Loss: 0.0142272 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.3517887592315674
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0061638  Vali Loss: 0.0142329 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.334897756576538
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0057090  Vali Loss: 0.0142439 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898534  Test weighted F1: 0.9898571  Test macro F1 0.9877677 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 636195
pruned model Parameter : 639314
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4645721912384033
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0074210  Vali Loss: 0.0173610 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943494  Vali macro F1 0.9922350 
Validation loss decreased (inf --> 0.017361).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4640498161315918
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0059358  Vali Loss: 0.0116157 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
new best score!!!!
Validation loss decreased (0.017361 --> 0.011616).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.4636127948760986
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0049770  Vali Loss: 0.0157125 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9928202 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.4628376960754395
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0055962  Vali Loss: 0.0123388 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.463151454925537
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0048840  Vali Loss: 0.0139933 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.4629967212677002
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0073723  Vali Loss: 0.0150070 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.4649083614349365
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0050787  Vali Loss: 0.0148636 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.4630439281463623
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0053449  Vali Loss: 0.0142745 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.4633424282073975
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0046676  Vali Loss: 0.0170159 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9928202 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.4702482223510742
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0041748  Vali Loss: 0.0143803 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.4673807621002197
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0039428  Vali Loss: 0.0137411 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.4623491764068604
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0036229  Vali Loss: 0.0138410 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.46494460105896
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0038393  Vali Loss: 0.0136240 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.4632282257080078
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0034529  Vali Loss: 0.0135814 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.46285080909729
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0035348  Vali Loss: 0.0136691 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.4626824855804443
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0036679  Vali Loss: 0.0138102 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.462453842163086
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0043138  Vali Loss: 0.0137561 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898534  Test weighted F1: 0.9898497  Test macro F1 0.9865010 

============================= JOB FEEDBACK =============================

NodeName=uc2n564
Job ID: 20948452
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 00:59:59
CPU Efficiency: 4.82% of 20:44:20 core-walltime
Job Wall-clock time: 01:02:13
Memory Utilized: 4.82 GB
Memory Efficiency: 0.00% of 0.00 MB
