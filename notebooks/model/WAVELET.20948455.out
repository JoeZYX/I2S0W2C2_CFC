Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 408860
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.7513439655303955
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3558165  Vali Loss: 1.1503616 Vali Accuracy: 0.7481203  Vali weighted F1: 0.7282633  Vali macro F1 0.7204001 
Validation loss decreased (inf --> 1.150362).  Saving model ...
Epoch: 2 cost time: 4.633771181106567
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8313279  Vali Loss: 0.4647721 Vali Accuracy: 0.9360902  Vali weighted F1: 0.9293285  Vali macro F1 0.9277024 
new best score!!!!
Validation loss decreased (1.150362 --> 0.464772).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.65520715713501
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4003797  Vali Loss: 0.2554452 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9642392  Vali macro F1 0.9632167 
new best score!!!!
Validation loss decreased (0.464772 --> 0.255445).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.637621641159058
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2458354  Vali Loss: 0.1634172 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9688323  Vali macro F1 0.9684002 
new best score!!!!
Validation loss decreased (0.255445 --> 0.163417).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.659887790679932
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1623390  Vali Loss: 0.1107300 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9719087  Vali macro F1 0.9713894 
new best score!!!!
Validation loss decreased (0.163417 --> 0.110730).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.64091420173645
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1164580  Vali Loss: 0.0835911 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847569  Vali macro F1 0.9843673 
new best score!!!!
Validation loss decreased (0.110730 --> 0.083591).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.630194664001465
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0906132  Vali Loss: 0.0650407 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823864  Vali macro F1 0.9818547 
new best score!!!!
Validation loss decreased (0.083591 --> 0.065041).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.651024580001831
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0684653  Vali Loss: 0.0510551 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887218  Vali macro F1 0.9883041 
new best score!!!!
Validation loss decreased (0.065041 --> 0.051055).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.626678943634033
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0541288  Vali Loss: 0.0410293 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.051055 --> 0.041029).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.6531901359558105
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0506048  Vali Loss: 0.0416257 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.631938457489014
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0393987  Vali Loss: 0.0383270 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899613  Vali macro F1 0.9893936 
new best score!!!!
Validation loss decreased (0.041029 --> 0.038327).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.645097494125366
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0349947  Vali Loss: 0.0342530 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.038327 --> 0.034253).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.637477397918701
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0307651  Vali Loss: 0.0281855 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.034253 --> 0.028186).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.630441904067993
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0355469  Vali Loss: 0.0337001 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.654985427856445
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0266146  Vali Loss: 0.0284995 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912123  Vali macro F1 0.9910111 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 4.638719081878662
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0248421  Vali Loss: 0.0330867 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 4.659664630889893
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0253904  Vali Loss: 0.0196785 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.028186 --> 0.019679).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.644007682800293
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0219328  Vali Loss: 0.0280439 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.660881757736206
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0198574  Vali Loss: 0.0189758 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.019679 --> 0.018976).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.65142822265625
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0165621  Vali Loss: 0.0204464 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.652313947677612
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0243931  Vali Loss: 0.0263463 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 4.6691882610321045
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0196251  Vali Loss: 0.0286119 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 4.650505304336548
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0241267  Vali Loss: 0.0230364 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 4.673577070236206
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0145715  Vali Loss: 0.0174047 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.018976 --> 0.017405).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.655459880828857
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0171577  Vali Loss: 0.0190909 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874725  Vali macro F1 0.9870026 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.672952890396118
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0159771  Vali Loss: 0.0196827 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.661901235580444
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0108124  Vali Loss: 0.0164211 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.017405 --> 0.016421).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.655503988265991
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0114480  Vali Loss: 0.0187399 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.6734912395477295
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0150826  Vali Loss: 0.0217654 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874053  Vali macro F1 0.9865539 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.653618812561035
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0171190  Vali Loss: 0.0199938 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 4.67423677444458
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0115390  Vali Loss: 0.0286811 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861015  Vali macro F1 0.9856261 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 4.663268327713013
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0091708  Vali Loss: 0.0161935 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
new best score!!!!
Validation loss decreased (0.016421 --> 0.016194).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.675102949142456
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0100628  Vali Loss: 0.0222307 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899441  Vali macro F1 0.9897249 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.665508270263672
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0075285  Vali Loss: 0.0204969 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899821  Vali macro F1 0.9897554 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 4.658859014511108
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0073722  Vali Loss: 0.0190419 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 4.673952102661133
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0099317  Vali Loss: 0.0174107 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 4.660128831863403
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0105599  Vali Loss: 0.0219337 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 4.675568342208862
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0077237  Vali Loss: 0.0189258 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 4.661420106887817
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0065199  Vali Loss: 0.0191755 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 4.677121639251709
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0059098  Vali Loss: 0.0197723 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 4.670724630355835
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0058668  Vali Loss: 0.0190433 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 4.659236907958984
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0053660  Vali Loss: 0.0177186 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 4.676738500595093
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0055436  Vali Loss: 0.0175504 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.657225131988525
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0050719  Vali Loss: 0.0175313 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 4.679841041564941
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0048567  Vali Loss: 0.0175801 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 4.661229133605957
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0053215  Vali Loss: 0.0175675 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 4.680857419967651
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0051626  Vali Loss: 0.0175967 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8789474  Test weighted F1: 0.8551006  Test macro F1 0.8551006 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.25767183303833
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0073388  Vali Loss: 0.0192339 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
Validation loss decreased (inf --> 0.019234).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.273940801620483
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0070095  Vali Loss: 0.0186424 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
new best score!!!!
Validation loss decreased (0.019234 --> 0.018642).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.256765127182007
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0058074  Vali Loss: 0.0188499 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.27289080619812
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0059759  Vali Loss: 0.0179989 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
new best score!!!!
Validation loss decreased (0.018642 --> 0.017999).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.26437520980835
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0057365  Vali Loss: 0.0189901 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.253941059112549
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0054704  Vali Loss: 0.0151003 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.017999 --> 0.015100).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.2769787311553955
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0051280  Vali Loss: 0.0153469 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.256399154663086
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0047607  Vali Loss: 0.0151677 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.272123098373413
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0048098  Vali Loss: 0.0146698 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.015100 --> 0.014670).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.258085012435913
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0042136  Vali Loss: 0.0153805 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.2718727588653564
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0044539  Vali Loss: 0.0158070 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.260528087615967
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0037347  Vali Loss: 0.0164969 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.253732442855835
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0043217  Vali Loss: 0.0158139 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.27389121055603
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0037812  Vali Loss: 0.0166609 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 6.255665063858032
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0039155  Vali Loss: 0.0157114 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.271747827529907
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0044486  Vali Loss: 0.0160057 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.25270676612854
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0037096  Vali Loss: 0.0161826 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.271989345550537
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0036690  Vali Loss: 0.0171196 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.266523361206055
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0039257  Vali Loss: 0.0158195 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.254657030105591
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0029816  Vali Loss: 0.0157213 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.273672819137573
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0029947  Vali Loss: 0.0157072 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.252825498580933
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0032320  Vali Loss: 0.0159355 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.2712562084198
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0031802  Vali Loss: 0.0160327 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.253574371337891
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0029237  Vali Loss: 0.0162546 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9289474  Test weighted F1: 0.9244905  Test macro F1 0.9244905 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.797066688537598
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3671922  Vali Loss: 1.1188466 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8173479  Vali macro F1 0.8138102 
Validation loss decreased (inf --> 1.118847).  Saving model ...
Epoch: 2 cost time: 4.666728734970093
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8131176  Vali Loss: 0.4652162 Vali Accuracy: 0.9273183  Vali weighted F1: 0.9222009  Vali macro F1 0.9188764 
new best score!!!!
Validation loss decreased (1.118847 --> 0.465216).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.687248945236206
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3901369  Vali Loss: 0.2499581 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9576236  Vali macro F1 0.9563158 
new best score!!!!
Validation loss decreased (0.465216 --> 0.249958).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.674159288406372
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2405558  Vali Loss: 0.1681272 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9728786  Vali macro F1 0.9722815 
new best score!!!!
Validation loss decreased (0.249958 --> 0.168127).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.6894447803497314
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1720433  Vali Loss: 0.1084379 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9831563  Vali macro F1 0.9827775 
new best score!!!!
Validation loss decreased (0.168127 --> 0.108438).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.676129102706909
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1166003  Vali Loss: 0.0786681 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9855796  Vali macro F1 0.9854530 
new best score!!!!
Validation loss decreased (0.108438 --> 0.078668).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.668148517608643
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0877245  Vali Loss: 0.0644986 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872441  Vali macro F1 0.9870319 
new best score!!!!
Validation loss decreased (0.078668 --> 0.064499).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.688152074813843
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0701511  Vali Loss: 0.0605419 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860446  Vali macro F1 0.9857709 
new best score!!!!
Validation loss decreased (0.064499 --> 0.060542).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.668806314468384
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0586104  Vali Loss: 0.0482918 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9857741  Vali macro F1 0.9854656 
new best score!!!!
Validation loss decreased (0.060542 --> 0.048292).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.688642263412476
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0470372  Vali Loss: 0.0489840 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859551  Vali macro F1 0.9854721 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.672873497009277
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0406893  Vali Loss: 0.0360975 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.048292 --> 0.036097).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.689539194107056
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0346105  Vali Loss: 0.0316966 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911405  Vali macro F1 0.9909313 
new best score!!!!
Validation loss decreased (0.036097 --> 0.031697).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.679133653640747
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0313869  Vali Loss: 0.0290983 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911405  Vali macro F1 0.9909313 
new best score!!!!
Validation loss decreased (0.031697 --> 0.029098).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.67516827583313
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0280030  Vali Loss: 0.0314305 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874122  Vali macro F1 0.9869929 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.688596963882446
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0249587  Vali Loss: 0.0250569 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.029098 --> 0.025057).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.669668197631836
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0224597  Vali Loss: 0.0261923 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.688685178756714
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0226179  Vali Loss: 0.0286589 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886626  Vali macro F1 0.9883554 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.673135042190552
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0279710  Vali Loss: 0.0256858 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 4.690957069396973
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0196942  Vali Loss: 0.0269878 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 4.677415132522583
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0203975  Vali Loss: 0.0186605 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.025057 --> 0.018661).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.670635223388672
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0191607  Vali Loss: 0.0220810 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.69791316986084
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0159177  Vali Loss: 0.0206530 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.668378591537476
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0180219  Vali Loss: 0.0143485 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936958  Vali macro F1 0.9934383 
new best score!!!!
Validation loss decreased (0.018661 --> 0.014349).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.690669298171997
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0348245  Vali Loss: 0.0206056 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 4.673444986343384
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0263780  Vali Loss: 0.0179829 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 4.691087961196899
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0171654  Vali Loss: 0.0171104 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 4.684809446334839
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0130418  Vali Loss: 0.0156550 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 4.673034191131592
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0122845  Vali Loss: 0.0148504 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 4.693114280700684
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0106336  Vali Loss: 0.0146440 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 4.675639629364014
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0090544  Vali Loss: 0.0145276 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 4.696347951889038
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0092376  Vali Loss: 0.0142164 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.014349 --> 0.014216).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.67420768737793
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0085651  Vali Loss: 0.0144140 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.692438125610352
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0084826  Vali Loss: 0.0135942 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.014216 --> 0.013594).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 4.680845022201538
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0081157  Vali Loss: 0.0135950 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 4.672501564025879
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0082326  Vali Loss: 0.0138384 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 4.6909966468811035
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0076377  Vali Loss: 0.0139871 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 4.672408103942871
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0075935  Vali Loss: 0.0139890 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 4.691381216049194
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0075688  Vali Loss: 0.0138001 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 4.682727336883545
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0077019  Vali Loss: 0.0138019 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 4.693797588348389
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0075875  Vali Loss: 0.0137924 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 4.685259103775024
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0073880  Vali Loss: 0.0137778 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 4.67480206489563
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0075102  Vali Loss: 0.0137835 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 4.692811965942383
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0077004  Vali Loss: 0.0137771 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 4.673900842666626
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0074154  Vali Loss: 0.0137762 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 4.692862510681152
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0071686  Vali Loss: 0.0137774 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 4.677650451660156
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0078075  Vali Loss: 0.0137768 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 4.692336797714233
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0079752  Vali Loss: 0.0137817 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 4.687277793884277
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0074278  Vali Loss: 0.0137842 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9114035  Test weighted F1: 0.8955418  Test macro F1 0.8955418 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.263887882232666
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0085606  Vali Loss: 0.0132734 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
Validation loss decreased (inf --> 0.013273).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2442591190338135
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0073358  Vali Loss: 0.0129835 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.013273 --> 0.012984).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.26145076751709
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0071772  Vali Loss: 0.0130886 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.253575325012207
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0074483  Vali Loss: 0.0133970 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.2462193965911865
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0065504  Vali Loss: 0.0124764 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.012984 --> 0.012476).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.261368751525879
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0068173  Vali Loss: 0.0142209 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.247054576873779
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0058901  Vali Loss: 0.0125702 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.261797666549683
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0064008  Vali Loss: 0.0137985 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.243750333786011
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0057208  Vali Loss: 0.0118707 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.012476 --> 0.011871).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.258058547973633
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0054453  Vali Loss: 0.0119260 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.24879789352417
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0048314  Vali Loss: 0.0119340 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.246549129486084
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0046433  Vali Loss: 0.0114966 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.011871 --> 0.011497).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.260571479797363
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0047787  Vali Loss: 0.0119240 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.246554374694824
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0046900  Vali Loss: 0.0115470 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.259061813354492
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0050562  Vali Loss: 0.0115619 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.245951890945435
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0044226  Vali Loss: 0.0109851 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.011497 --> 0.010985).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.262387275695801
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0040686  Vali Loss: 0.0116173 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.249483108520508
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0044478  Vali Loss: 0.0124925 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.2426722049713135
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0042694  Vali Loss: 0.0117185 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.267560958862305
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0040117  Vali Loss: 0.0110413 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.242286682128906
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0036925  Vali Loss: 0.0113140 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 22 cost time: 6.255750417709351
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0042126  Vali Loss: 0.0150404 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912097  Vali macro F1 0.9908993 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.245498895645142
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0060412  Vali Loss: 0.0133211 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.259713888168335
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0037094  Vali Loss: 0.0120007 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.247308015823364
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0042547  Vali Loss: 0.0120019 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.244419097900391
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0053089  Vali Loss: 0.0108722 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.010985 --> 0.010872).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.26106333732605
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0036717  Vali Loss: 0.0118238 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.240445375442505
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0040407  Vali Loss: 0.0131367 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.260085344314575
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0044862  Vali Loss: 0.0122269 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.244732141494751
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0030785  Vali Loss: 0.0122926 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.255059719085693
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0039803  Vali Loss: 0.0120828 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 32 cost time: 6.252028465270996
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0037499  Vali Loss: 0.0121909 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.239157676696777
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0037698  Vali Loss: 0.0122276 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.253302335739136
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0032385  Vali Loss: 0.0121628 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.233288526535034
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0038388  Vali Loss: 0.0122680 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.2503204345703125
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0031207  Vali Loss: 0.0123143 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 37 cost time: 6.235682487487793
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0030757  Vali Loss: 0.0123158 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.258367300033569
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0030340  Vali Loss: 0.0123149 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.244899034500122
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0037135  Vali Loss: 0.0123276 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.231707334518433
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0033619  Vali Loss: 0.0123283 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.258656024932861
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0033851  Vali Loss: 0.0123260 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8912281  Test weighted F1: 0.8578790  Test macro F1 0.8578790 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.745194435119629
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3550606  Vali Loss: 1.1212409 Vali Accuracy: 0.8020050  Vali weighted F1: 0.7943421  Vali macro F1 0.7876547 
Validation loss decreased (inf --> 1.121241).  Saving model ...
Epoch: 2 cost time: 4.655923366546631
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8042588  Vali Loss: 0.4255100 Vali Accuracy: 0.9498747  Vali weighted F1: 0.9479090  Vali macro F1 0.9457709 
new best score!!!!
Validation loss decreased (1.121241 --> 0.425510).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.646148443222046
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3886024  Vali Loss: 0.2264707 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9733383  Vali macro F1 0.9728666 
new best score!!!!
Validation loss decreased (0.425510 --> 0.226471).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.670832633972168
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2260755  Vali Loss: 0.1453715 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845288  Vali macro F1 0.9839630 
new best score!!!!
Validation loss decreased (0.226471 --> 0.145372).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.656104564666748
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1605702  Vali Loss: 0.1000930 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.145372 --> 0.100093).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.669584512710571
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1084291  Vali Loss: 0.0706012 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
new best score!!!!
Validation loss decreased (0.100093 --> 0.070601).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.6525537967681885
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0780018  Vali Loss: 0.0522491 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.070601 --> 0.052249).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.668547630310059
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0614356  Vali Loss: 0.0425900 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924118  Vali macro F1 0.9923376 
new best score!!!!
Validation loss decreased (0.052249 --> 0.042590).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.663776874542236
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0479660  Vali Loss: 0.0327780 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.042590 --> 0.032778).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.6513307094573975
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0429901  Vali Loss: 0.0376982 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885186  Vali macro F1 0.9881833 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.67138409614563
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0394641  Vali Loss: 0.0323840 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923879  Vali macro F1 0.9921759 
new best score!!!!
Validation loss decreased (0.032778 --> 0.032384).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.652198791503906
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0329344  Vali Loss: 0.0247685 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.032384 --> 0.024769).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.672053337097168
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0286117  Vali Loss: 0.0195185 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.024769 --> 0.019519).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.657415866851807
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0303067  Vali Loss: 0.0245375 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.675645112991333
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0275712  Vali Loss: 0.0185124 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9947947 
new best score!!!!
Validation loss decreased (0.019519 --> 0.018512).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.663522958755493
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0250271  Vali Loss: 0.0156533 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.018512 --> 0.015653).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.652971982955933
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0215884  Vali Loss: 0.0229547 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937171  Vali macro F1 0.9934664 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.675405263900757
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0186280  Vali Loss: 0.0141783 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.015653 --> 0.014178).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.655104160308838
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0147727  Vali Loss: 0.0108877 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.014178 --> 0.010888).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.6739044189453125
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0126050  Vali Loss: 0.0124898 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.654974937438965
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0124808  Vali Loss: 0.0103809 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.010888 --> 0.010381).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.674959897994995
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0140419  Vali Loss: 0.0121905 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.665506362915039
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0133682  Vali Loss: 0.0108189 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.660689115524292
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0152029  Vali Loss: 0.0427454 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845352  Vali macro F1 0.9838517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 4.673668384552002
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0260417  Vali Loss: 0.0100749 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
new best score!!!!
Validation loss decreased (0.010381 --> 0.010075).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.6542487144470215
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0252875  Vali Loss: 0.0125360 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 4.672978401184082
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0150857  Vali Loss: 0.0097134 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.010075 --> 0.009713).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.656476974487305
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0151348  Vali Loss: 0.0101425 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.671413421630859
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0112868  Vali Loss: 0.0091619 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
new best score!!!!
Validation loss decreased (0.009713 --> 0.009162).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.664778232574463
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0104109  Vali Loss: 0.0101622 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9947947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.654682397842407
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0084558  Vali Loss: 0.0113583 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 4.674549341201782
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0083747  Vali Loss: 0.0097804 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 4.660868883132935
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0112515  Vali Loss: 0.0088989 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.009162 --> 0.008899).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 4.675448894500732
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0088554  Vali Loss: 0.0111351 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 4.6549153327941895
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0188091  Vali Loss: 0.0112517 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 4.672486066818237
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0101061  Vali Loss: 0.0078378 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.008899 --> 0.007838).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 4.6620495319366455
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0063274  Vali Loss: 0.0081393 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 4.653210163116455
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0065385  Vali Loss: 0.0063483 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.007838 --> 0.006348).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 4.670132160186768
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0107052  Vali Loss: 0.0074469 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 4.651753187179565
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0112233  Vali Loss: 0.0155103 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9960918 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 4.6702985763549805
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0106850  Vali Loss: 0.0062516 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
new best score!!!!
Validation loss decreased (0.006348 --> 0.006252).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 4.655099630355835
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0076116  Vali Loss: 0.0055148 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
new best score!!!!
Validation loss decreased (0.006252 --> 0.005515).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.670379161834717
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0092659  Vali Loss: 0.0072528 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.661291122436523
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0103046  Vali Loss: 0.0074682 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 4.648871660232544
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0119520  Vali Loss: 0.0060889 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 4.671044588088989
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0064099  Vali Loss: 0.0062931 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 4.651485919952393
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0047309  Vali Loss: 0.0047325 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.005515 --> 0.004732).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 4.671928405761719
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0049363  Vali Loss: 0.0060954 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 4.656856536865234
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0074103  Vali Loss: 0.0046210 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.004732 --> 0.004621).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 4.673010349273682
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0049344  Vali Loss: 0.0050649 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 4.662247180938721
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0037559  Vali Loss: 0.0083145 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 4.652674674987793
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0107861  Vali Loss: 0.0082797 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962425  Vali macro F1 0.9962159 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 4.670875549316406
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0056298  Vali Loss: 0.0064352 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 4.651765823364258
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0059064  Vali Loss: 0.0049667 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 55 cost time: 4.668805122375488
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0047777  Vali Loss: 0.0043502 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.004621 --> 0.004350).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 4.654178857803345
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0040018  Vali Loss: 0.0044297 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 4.671013832092285
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0037200  Vali Loss: 0.0046940 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 4.6603827476501465
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0033961  Vali Loss: 0.0034573 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.004350 --> 0.003457).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 4.656097173690796
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0034486  Vali Loss: 0.0036554 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 4.670758485794067
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0034006  Vali Loss: 0.0041450 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 4.653609991073608
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0034625  Vali Loss: 0.0041249 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 4.670621871948242
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0028747  Vali Loss: 0.0041568 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 4.653916597366333
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0038805  Vali Loss: 0.0056639 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 64 cost time: 4.672744512557983
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0027473  Vali Loss: 0.0056406 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 4.66245698928833
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0031658  Vali Loss: 0.0056083 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 4.652062177658081
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0037583  Vali Loss: 0.0054178 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 4.675054550170898
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0027933  Vali Loss: 0.0053028 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 4.654427766799927
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0036775  Vali Loss: 0.0052841 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 69 cost time: 4.674774885177612
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0030532  Vali Loss: 0.0052804 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 4.657145738601685
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0032515  Vali Loss: 0.0052807 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 4.6734209060668945
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0029212  Vali Loss: 0.0052857 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 4.666111469268799
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0025886  Vali Loss: 0.0052881 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 4.655545949935913
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0027903  Vali Loss: 0.0052895 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9201754  Test weighted F1: 0.9171363  Test macro F1 0.9171363 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.282705783843994
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0033497  Vali Loss: 0.0046868 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
Validation loss decreased (inf --> 0.004687).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3120276927948
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0032651  Vali Loss: 0.0042075 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.004687 --> 0.004208).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.290037155151367
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0031656  Vali Loss: 0.0034884 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.004208 --> 0.003488).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.279637575149536
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0030028  Vali Loss: 0.0053273 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.3057215213775635
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0026788  Vali Loss: 0.0049687 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.271409034729004
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0023161  Vali Loss: 0.0034604 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
new best score!!!!
Validation loss decreased (0.003488 --> 0.003460).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.2877795696258545
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0022481  Vali Loss: 0.0042817 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.271823883056641
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0022074  Vali Loss: 0.0032320 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.003460 --> 0.003232).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.292324542999268
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0027934  Vali Loss: 0.0043178 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.2788472175598145
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0024020  Vali Loss: 0.0029747 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.003232 --> 0.002975).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.275988578796387
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0023918  Vali Loss: 0.0030714 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.292864084243774
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0022198  Vali Loss: 0.0029416 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.002975 --> 0.002942).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.2679784297943115
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0020732  Vali Loss: 0.0027180 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.002942 --> 0.002718).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.289966583251953
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0022971  Vali Loss: 0.0042806 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.277301549911499
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0016716  Vali Loss: 0.0040171 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.28966498374939
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0017571  Vali Loss: 0.0038115 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.28192663192749
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0016624  Vali Loss: 0.0034229 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.2732672691345215
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0015586  Vali Loss: 0.0037817 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 6.299252510070801
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0013938  Vali Loss: 0.0038322 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.276256322860718
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0016212  Vali Loss: 0.0038089 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.290282249450684
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0016957  Vali Loss: 0.0040674 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.280125379562378
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0019096  Vali Loss: 0.0043369 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.289846897125244
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0015857  Vali Loss: 0.0039380 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.286996603012085
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0015650  Vali Loss: 0.0039399 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.277029991149902
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0012277  Vali Loss: 0.0039699 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.293847560882568
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0013362  Vali Loss: 0.0039463 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.280765056610107
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0012926  Vali Loss: 0.0039443 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.299275159835815
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0015179  Vali Loss: 0.0039552 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9429825  Test weighted F1: 0.9404153  Test macro F1 0.9404153 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.758692026138306
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3802316  Vali Loss: 1.1354465 Vali Accuracy: 0.8295739  Vali weighted F1: 0.8158505  Vali macro F1 0.8094670 
Validation loss decreased (inf --> 1.135447).  Saving model ...
Epoch: 2 cost time: 4.689570426940918
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8214049  Vali Loss: 0.4325405 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9455486  Vali macro F1 0.9448805 
new best score!!!!
Validation loss decreased (1.135447 --> 0.432541).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.668332576751709
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3904351  Vali Loss: 0.2416035 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9737435  Vali macro F1 0.9731098 
new best score!!!!
Validation loss decreased (0.432541 --> 0.241603).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.6851630210876465
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2323129  Vali Loss: 0.1553119 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9730500  Vali macro F1 0.9725265 
new best score!!!!
Validation loss decreased (0.241603 --> 0.155312).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.671193599700928
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1467574  Vali Loss: 0.1023180 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9856634  Vali macro F1 0.9854826 
new best score!!!!
Validation loss decreased (0.155312 --> 0.102318).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.6883323192596436
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1049535  Vali Loss: 0.0860776 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847118  Vali macro F1 0.9842105 
new best score!!!!
Validation loss decreased (0.102318 --> 0.086078).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.6843273639678955
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0856658  Vali Loss: 0.0643686 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898599  Vali macro F1 0.9896314 
new best score!!!!
Validation loss decreased (0.086078 --> 0.064369).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.673391103744507
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0632858  Vali Loss: 0.0477806 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924680  Vali macro F1 0.9920815 
new best score!!!!
Validation loss decreased (0.064369 --> 0.047781).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.691577196121216
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0514468  Vali Loss: 0.0465302 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9858444  Vali macro F1 0.9854892 
new best score!!!!
Validation loss decreased (0.047781 --> 0.046530).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.671507358551025
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0423714  Vali Loss: 0.0397267 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899337  Vali macro F1 0.9894641 
new best score!!!!
Validation loss decreased (0.046530 --> 0.039727).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.691813707351685
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0364448  Vali Loss: 0.0347328 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885605  Vali macro F1 0.9879673 
new best score!!!!
Validation loss decreased (0.039727 --> 0.034733).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.674877882003784
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0371399  Vali Loss: 0.0410452 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847725  Vali macro F1 0.9841100 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 4.692124128341675
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0575703  Vali Loss: 0.0373037 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886906  Vali macro F1 0.9881725 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 4.683202028274536
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0350197  Vali Loss: 0.0350431 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846388  Vali macro F1 0.9841175 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 4.673203229904175
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0287301  Vali Loss: 0.0271857 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912244  Vali macro F1 0.9907752 
new best score!!!!
Validation loss decreased (0.034733 --> 0.027186).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.691213130950928
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0265077  Vali Loss: 0.0287895 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.675032377243042
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0312341  Vali Loss: 0.0296515 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886012  Vali macro F1 0.9883291 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.689382791519165
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0212018  Vali Loss: 0.0208841 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924680  Vali macro F1 0.9920815 
new best score!!!!
Validation loss decreased (0.027186 --> 0.020884).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.673352479934692
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0183572  Vali Loss: 0.0275211 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872116  Vali macro F1 0.9869113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 4.6891303062438965
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0179926  Vali Loss: 0.0290495 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899337  Vali macro F1 0.9894641 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 4.678974628448486
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0219075  Vali Loss: 0.0160055 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962369  Vali macro F1 0.9959805 
new best score!!!!
Validation loss decreased (0.020884 --> 0.016005).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.667529344558716
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0195480  Vali Loss: 0.0293285 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886568  Vali macro F1 0.9881470 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.688288450241089
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0187269  Vali Loss: 0.0201650 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.670421361923218
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0162810  Vali Loss: 0.0416057 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823895  Vali macro F1 0.9807507 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 4.695693254470825
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0173180  Vali Loss: 0.0197128 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887212  Vali macro F1 0.9881852 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 4.676451206207275
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0209839  Vali Loss: 0.0183020 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912042  Vali macro F1 0.9907378 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 4.6902947425842285
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0128366  Vali Loss: 0.0181443 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912042  Vali macro F1 0.9907378 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.67828631401062
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0117461  Vali Loss: 0.0179174 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912042  Vali macro F1 0.9907378 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 4.670724630355835
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0112484  Vali Loss: 0.0187466 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 4.689333200454712
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0106115  Vali Loss: 0.0174143 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912042  Vali macro F1 0.9907378 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 4.670314788818359
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0104166  Vali Loss: 0.0191015 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 32 cost time: 4.689501523971558
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0097975  Vali Loss: 0.0189566 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.673498153686523
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0102429  Vali Loss: 0.0188861 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.694743394851685
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0099033  Vali Loss: 0.0188373 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.681294918060303
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0100813  Vali Loss: 0.0185742 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 4.670523405075073
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0100844  Vali Loss: 0.0180131 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8192982  Test weighted F1: 0.7725856  Test macro F1 0.7725856 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.283444881439209
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0160365  Vali Loss: 0.0225781 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912037  Vali macro F1 0.9907752 
Validation loss decreased (inf --> 0.022578).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.289262056350708
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0124672  Vali Loss: 0.0224766 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899557  Vali macro F1 0.9896176 
new best score!!!!
Validation loss decreased (0.022578 --> 0.022477).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.284140586853027
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0121837  Vali Loss: 0.0203595 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912037  Vali macro F1 0.9907752 
new best score!!!!
Validation loss decreased (0.022477 --> 0.020360).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.274085283279419
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0114032  Vali Loss: 0.0184562 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912037  Vali macro F1 0.9907752 
new best score!!!!
Validation loss decreased (0.020360 --> 0.018456).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.290300607681274
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0107973  Vali Loss: 0.0155227 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.018456 --> 0.015523).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.272190570831299
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0095400  Vali Loss: 0.0159737 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.289968252182007
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0096298  Vali Loss: 0.0158405 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924680  Vali macro F1 0.9920815 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.272157430648804
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0089318  Vali Loss: 0.0172887 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912037  Vali macro F1 0.9907752 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.294608116149902
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0091996  Vali Loss: 0.0172978 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924680  Vali macro F1 0.9920815 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.284721612930298
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0080971  Vali Loss: 0.0173640 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912037  Vali macro F1 0.9907752 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.271111488342285
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0106227  Vali Loss: 0.0155701 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899579  Vali macro F1 0.9894808 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.284571170806885
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0079121  Vali Loss: 0.0169892 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912037  Vali macro F1 0.9907752 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.2705817222595215
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0087463  Vali Loss: 0.0152758 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924680  Vali macro F1 0.9920815 
new best score!!!!
Validation loss decreased (0.015523 --> 0.015276).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.286662578582764
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0079890  Vali Loss: 0.0184377 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899337  Vali macro F1 0.9894641 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.2716240882873535
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0081962  Vali Loss: 0.0145530 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
new best score!!!!
Validation loss decreased (0.015276 --> 0.014553).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.288366317749023
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0072721  Vali Loss: 0.0164128 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912037  Vali macro F1 0.9907752 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.279235363006592
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0058437  Vali Loss: 0.0150879 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.275627851486206
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0073856  Vali Loss: 0.0208792 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899337  Vali macro F1 0.9894641 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.2885942459106445
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0067695  Vali Loss: 0.0146120 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.271895885467529
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0064896  Vali Loss: 0.0174052 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886906  Vali macro F1 0.9881725 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.289940118789673
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0073620  Vali Loss: 0.0170366 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886906  Vali macro F1 0.9881725 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.276028633117676
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0070320  Vali Loss: 0.0157416 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899579  Vali macro F1 0.9894808 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.287987947463989
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0057708  Vali Loss: 0.0153360 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.276422739028931
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0059011  Vali Loss: 0.0153385 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.270338773727417
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0055289  Vali Loss: 0.0158385 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.292886734008789
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0057522  Vali Loss: 0.0158368 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.272090196609497
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0063419  Vali Loss: 0.0158275 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.293298244476318
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0062898  Vali Loss: 0.0158068 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.275847673416138
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0064500  Vali Loss: 0.0158366 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.290065765380859
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0059736  Vali Loss: 0.0158301 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912198  Vali macro F1 0.9907847 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8271930  Test weighted F1: 0.7848210  Test macro F1 0.7848210 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.734396934509277
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3510616  Vali Loss: 1.1053699 Vali Accuracy: 0.8208020  Vali weighted F1: 0.8044214  Vali macro F1 0.8002411 
Validation loss decreased (inf --> 1.105370).  Saving model ...
Epoch: 2 cost time: 4.683185338973999
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.7953122  Vali Loss: 0.4315323 Vali Accuracy: 0.9335840  Vali weighted F1: 0.9253461  Vali macro F1 0.9235650 
new best score!!!!
Validation loss decreased (1.105370 --> 0.431532).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.665752649307251
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3800445  Vali Loss: 0.2357317 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9611853  Vali macro F1 0.9596065 
new best score!!!!
Validation loss decreased (0.431532 --> 0.235732).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.681538343429565
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2301782  Vali Loss: 0.1464574 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9761549  Vali macro F1 0.9752828 
new best score!!!!
Validation loss decreased (0.235732 --> 0.146457).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.675248384475708
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1454358  Vali Loss: 0.1100493 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9794134  Vali macro F1 0.9787781 
new best score!!!!
Validation loss decreased (0.146457 --> 0.110049).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.6671788692474365
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1040776  Vali Loss: 0.0799285 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872609  Vali macro F1 0.9868398 
new best score!!!!
Validation loss decreased (0.110049 --> 0.079928).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.685851097106934
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0796137  Vali Loss: 0.0609558 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885177  Vali macro F1 0.9882566 
new best score!!!!
Validation loss decreased (0.079928 --> 0.060956).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.672914266586304
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0628397  Vali Loss: 0.0532935 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861566  Vali macro F1 0.9856701 
new best score!!!!
Validation loss decreased (0.060956 --> 0.053294).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.687077522277832
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0485037  Vali Loss: 0.0440872 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.053294 --> 0.044087).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.675252437591553
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0453995  Vali Loss: 0.0415826 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.044087 --> 0.041583).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.686563730239868
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0385988  Vali Loss: 0.0376527 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.041583 --> 0.037653).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.678013324737549
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0325023  Vali Loss: 0.0320380 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872799  Vali macro F1 0.9869704 
new best score!!!!
Validation loss decreased (0.037653 --> 0.032038).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.667565107345581
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0268067  Vali Loss: 0.0323394 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 4.688082695007324
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0266238  Vali Loss: 0.0318306 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.032038 --> 0.031831).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.667326211929321
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0226174  Vali Loss: 0.0303595 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.031831 --> 0.030359).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.6901280879974365
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0212380  Vali Loss: 0.0282353 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872116  Vali macro F1 0.9869113 
new best score!!!!
Validation loss decreased (0.030359 --> 0.028235).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.669277667999268
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0196659  Vali Loss: 0.0250055 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.028235 --> 0.025005).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.695963382720947
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0184854  Vali Loss: 0.0291112 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.67956018447876
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0242131  Vali Loss: 0.0333104 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 4.66770339012146
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0180597  Vali Loss: 0.0232251 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.025005 --> 0.023225).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.689120769500732
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0146531  Vali Loss: 0.0357691 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.666776180267334
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0138025  Vali Loss: 0.0229315 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.023225 --> 0.022931).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.686496019363403
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0195930  Vali Loss: 0.0271220 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 4.670276880264282
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0131640  Vali Loss: 0.0167822 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.022931 --> 0.016782).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.684964656829834
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0134186  Vali Loss: 0.0178660 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.677950859069824
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0103123  Vali Loss: 0.0208375 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.664367914199829
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0087453  Vali Loss: 0.0189919 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 4.68579888343811
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0087331  Vali Loss: 0.0200321 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 4.667139768600464
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0265552  Vali Loss: 0.0279607 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 4.686825752258301
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0165465  Vali Loss: 0.0249355 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.6697096824646
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0139398  Vali Loss: 0.0244133 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 4.685908555984497
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0118066  Vali Loss: 0.0210520 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 4.676527261734009
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0107266  Vali Loss: 0.0203380 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 4.667300224304199
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0099966  Vali Loss: 0.0207086 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 4.686030626296997
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0093956  Vali Loss: 0.0207519 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.666625738143921
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0093281  Vali Loss: 0.0206924 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.683901309967041
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0091456  Vali Loss: 0.0207448 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.669031858444214
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0091866  Vali Loss: 0.0206543 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.682142019271851
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0092815  Vali Loss: 0.0205817 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8245614  Test weighted F1: 0.7780649  Test macro F1 0.7780649 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.309670925140381
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0117662  Vali Loss: 0.0179910 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
Validation loss decreased (inf --> 0.017991).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.328490257263184
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0090934  Vali Loss: 0.0176224 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.017991 --> 0.017622).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.306324481964111
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0085216  Vali Loss: 0.0202688 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.331127882003784
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0079540  Vali Loss: 0.0185858 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.314424276351929
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0080315  Vali Loss: 0.0201961 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.304758787155151
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0074354  Vali Loss: 0.0204203 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.325591802597046
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0071769  Vali Loss: 0.0208473 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.306712865829468
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0065508  Vali Loss: 0.0178969 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.328116416931152
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0064193  Vali Loss: 0.0192889 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.30761456489563
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0063303  Vali Loss: 0.0189934 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.323816537857056
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0069290  Vali Loss: 0.0213918 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.315757751464844
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0071869  Vali Loss: 0.0205865 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.292825222015381
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0061278  Vali Loss: 0.0204869 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.325724124908447
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0054956  Vali Loss: 0.0205327 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.305938959121704
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0058422  Vali Loss: 0.0206259 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.323458194732666
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0058342  Vali Loss: 0.0206091 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.315288782119751
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0057991  Vali Loss: 0.0206948 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8342105  Test weighted F1: 0.7903062  Test macro F1 0.7903062 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.771237850189209
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3535983  Vali Loss: 1.1306627 Vali Accuracy: 0.8120301  Vali weighted F1: 0.7923107  Vali macro F1 0.7846029 
Validation loss decreased (inf --> 1.130663).  Saving model ...
Epoch: 2 cost time: 4.65920877456665
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8280368  Vali Loss: 0.4678311 Vali Accuracy: 0.9398496  Vali weighted F1: 0.9379058  Vali macro F1 0.9348842 
new best score!!!!
Validation loss decreased (1.130663 --> 0.467831).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.676537752151489
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3943709  Vali Loss: 0.2376226 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9817236  Vali macro F1 0.9815272 
new best score!!!!
Validation loss decreased (0.467831 --> 0.237623).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.660097122192383
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2265347  Vali Loss: 0.1407343 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884282  Vali macro F1 0.9881960 
new best score!!!!
Validation loss decreased (0.237623 --> 0.140734).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.67875862121582
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1489484  Vali Loss: 0.0956811 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897302  Vali macro F1 0.9894905 
new best score!!!!
Validation loss decreased (0.140734 --> 0.095681).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.672192811965942
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1122745  Vali Loss: 0.0743586 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9883346  Vali macro F1 0.9881609 
new best score!!!!
Validation loss decreased (0.095681 --> 0.074359).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.668489456176758
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0862414  Vali Loss: 0.0551445 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923879  Vali macro F1 0.9921759 
new best score!!!!
Validation loss decreased (0.074359 --> 0.055144).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.683760404586792
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0666885  Vali Loss: 0.0468944 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936655  Vali macro F1 0.9934965 
new best score!!!!
Validation loss decreased (0.055144 --> 0.046894).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.661868095397949
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0587767  Vali Loss: 0.0409684 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923879  Vali macro F1 0.9921759 
new best score!!!!
Validation loss decreased (0.046894 --> 0.040968).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.68277382850647
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0484963  Vali Loss: 0.0324114 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.040968 --> 0.032411).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.665716171264648
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0397381  Vali Loss: 0.0299151 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.032411 --> 0.029915).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.681704998016357
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0342090  Vali Loss: 0.0282123 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.029915 --> 0.028212).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.670975923538208
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0296482  Vali Loss: 0.0214653 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.028212 --> 0.021465).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.662649154663086
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0277547  Vali Loss: 0.0215013 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.6808130741119385
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0237493  Vali Loss: 0.0187437 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.021465 --> 0.018744).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.657682418823242
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0237687  Vali Loss: 0.0175505 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.018744 --> 0.017550).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.681180715560913
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0236690  Vali Loss: 0.0247627 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924125  Vali macro F1 0.9923999 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.660198926925659
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0239104  Vali Loss: 0.0172028 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
new best score!!!!
Validation loss decreased (0.017550 --> 0.017203).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.677330493927002
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0183854  Vali Loss: 0.0154122 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
new best score!!!!
Validation loss decreased (0.017203 --> 0.015412).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.666739463806152
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0211370  Vali Loss: 0.0166118 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936655  Vali macro F1 0.9934965 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.657609462738037
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0182751  Vali Loss: 0.0157155 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 4.677653551101685
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0162890  Vali Loss: 0.0162073 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936887  Vali macro F1 0.9936543 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 4.6608710289001465
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0161696  Vali Loss: 0.0187734 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911349  Vali macro F1 0.9910793 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 4.675212860107422
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0140510  Vali Loss: 0.0149882 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
new best score!!!!
Validation loss decreased (0.015412 --> 0.014988).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.662996053695679
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0263453  Vali Loss: 0.0179661 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924162  Vali macro F1 0.9923377 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.679595947265625
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0219875  Vali Loss: 0.0154500 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936887  Vali macro F1 0.9936543 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.665363788604736
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0148123  Vali Loss: 0.0155154 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936856  Vali macro F1 0.9933101 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 4.659536361694336
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0133917  Vali Loss: 0.0206592 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949718  Vali macro F1 0.9946391 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 4.677088022232056
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0152788  Vali Loss: 0.0196630 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9937452 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 4.659513473510742
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0129990  Vali Loss: 0.0138482 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936860  Vali macro F1 0.9937175 
new best score!!!!
Validation loss decreased (0.014988 --> 0.013848).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.6779210567474365
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0103584  Vali Loss: 0.0118111 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.013848 --> 0.011811).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.663000583648682
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0115787  Vali Loss: 0.0105454 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.011811 --> 0.010545).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.680047512054443
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0107408  Vali Loss: 0.0109095 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.673587322235107
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0094671  Vali Loss: 0.0093588 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.010545 --> 0.009359).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.663818120956421
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0083879  Vali Loss: 0.0113179 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.682597875595093
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0089331  Vali Loss: 0.0101853 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.6648948192596436
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0078335  Vali Loss: 0.0113401 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.6825010776519775
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0076007  Vali Loss: 0.0116763 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.665199518203735
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0076745  Vali Loss: 0.0103974 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 4.684284925460815
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0076181  Vali Loss: 0.0104029 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.676246881484985
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0076164  Vali Loss: 0.0105485 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.664144039154053
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0075079  Vali Loss: 0.0107806 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.685952425003052
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0070592  Vali Loss: 0.0108685 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 4.663848876953125
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0079373  Vali Loss: 0.0109316 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 4.682926416397095
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0068800  Vali Loss: 0.0109263 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.666330099105835
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0073393  Vali Loss: 0.0109417 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.6833555698394775
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0071879  Vali Loss: 0.0109593 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.671430587768555
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0069745  Vali Loss: 0.0109598 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.6652915477752686
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0076138  Vali Loss: 0.0109717 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9271930  Test weighted F1: 0.9234893  Test macro F1 0.9234893 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.253178119659424
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0085140  Vali Loss: 0.0098577 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
Validation loss decreased (inf --> 0.009858).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.268331289291382
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0071513  Vali Loss: 0.0093888 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.009858 --> 0.009389).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.255199432373047
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0072760  Vali Loss: 0.0110910 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.250822305679321
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0073604  Vali Loss: 0.0090052 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.009389 --> 0.009005).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.263350009918213
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0071131  Vali Loss: 0.0121839 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.24658989906311
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0062026  Vali Loss: 0.0128387 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.269341707229614
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0053924  Vali Loss: 0.0134200 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.25273871421814
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0059975  Vali Loss: 0.0139466 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.268754720687866
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0051427  Vali Loss: 0.0112104 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.2498390674591064
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0048109  Vali Loss: 0.0123484 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.2508063316345215
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0049487  Vali Loss: 0.0128385 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.266520023345947
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0042053  Vali Loss: 0.0115017 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.246312141418457
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0052105  Vali Loss: 0.0130929 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.2675580978393555
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0047984  Vali Loss: 0.0131943 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.247339487075806
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0038749  Vali Loss: 0.0131282 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.272934675216675
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0043634  Vali Loss: 0.0127373 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.254967451095581
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0043792  Vali Loss: 0.0125710 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.246016979217529
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0040554  Vali Loss: 0.0125357 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.267321348190308
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0041910  Vali Loss: 0.0125735 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9271930  Test weighted F1: 0.9238121  Test macro F1 0.9238121 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.8088250160217285
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3686564  Vali Loss: 1.1486261 Vali Accuracy: 0.8120301  Vali weighted F1: 0.7952525  Vali macro F1 0.7914000 
Validation loss decreased (inf --> 1.148626).  Saving model ...
Epoch: 2 cost time: 4.687605857849121
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8253619  Vali Loss: 0.4661307 Vali Accuracy: 0.9335840  Vali weighted F1: 0.9276402  Vali macro F1 0.9249507 
new best score!!!!
Validation loss decreased (1.148626 --> 0.466131).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.679253578186035
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4064059  Vali Loss: 0.2463357 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9663383  Vali macro F1 0.9654243 
new best score!!!!
Validation loss decreased (0.466131 --> 0.246336).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.698797702789307
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2392699  Vali Loss: 0.1558298 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9803616  Vali macro F1 0.9799475 
new best score!!!!
Validation loss decreased (0.246336 --> 0.155830).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.679388046264648
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1535061  Vali Loss: 0.1085977 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9858812  Vali macro F1 0.9855559 
new best score!!!!
Validation loss decreased (0.155830 --> 0.108598).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.698077917098999
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1058222  Vali Loss: 0.0816136 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9760871  Vali macro F1 0.9756017 
new best score!!!!
Validation loss decreased (0.108598 --> 0.081614).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.68150782585144
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0863555  Vali Loss: 0.0620422 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859585  Vali macro F1 0.9857014 
new best score!!!!
Validation loss decreased (0.081614 --> 0.062042).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.697202205657959
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0663493  Vali Loss: 0.0596423 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9805010  Vali macro F1 0.9800176 
new best score!!!!
Validation loss decreased (0.062042 --> 0.059642).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.6868767738342285
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0549828  Vali Loss: 0.0452501 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.059642 --> 0.045250).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.681161880493164
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0469998  Vali Loss: 0.0485527 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845675  Vali macro F1 0.9841914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.701280117034912
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0426982  Vali Loss: 0.0371459 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886605  Vali macro F1 0.9883540 
new best score!!!!
Validation loss decreased (0.045250 --> 0.037146).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.686476230621338
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0388831  Vali Loss: 0.0381933 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 4.699524164199829
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0327786  Vali Loss: 0.0332550 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
new best score!!!!
Validation loss decreased (0.037146 --> 0.033255).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.683468818664551
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0287351  Vali Loss: 0.0324015 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846504  Vali macro F1 0.9842781 
new best score!!!!
Validation loss decreased (0.033255 --> 0.032401).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.702326059341431
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0254763  Vali Loss: 0.0245911 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886907  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.032401 --> 0.024591).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.690221071243286
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0248460  Vali Loss: 0.0351273 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872116  Vali macro F1 0.9869113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.681757211685181
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0216528  Vali Loss: 0.0256377 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.698599338531494
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0188637  Vali Loss: 0.0247569 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 4.679880380630493
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0228640  Vali Loss: 0.0385811 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845675  Vali macro F1 0.9841914 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 4.6999452114105225
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0201524  Vali Loss: 0.0292688 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848775  Vali macro F1 0.9844926 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 4.682972192764282
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0175630  Vali Loss: 0.0234682 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873920  Vali macro F1 0.9869548 
new best score!!!!
Validation loss decreased (0.024591 --> 0.023468).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.698328733444214
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0156181  Vali Loss: 0.0284839 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846657  Vali macro F1 0.9842789 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.690450191497803
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0209521  Vali Loss: 0.0269554 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873920  Vali macro F1 0.9869548 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.6807334423065186
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0140838  Vali Loss: 0.0259909 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 4.702225208282471
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0138253  Vali Loss: 0.0254824 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 4.686636686325073
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0128582  Vali Loss: 0.0256586 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873920  Vali macro F1 0.9869548 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 27 cost time: 4.702865123748779
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0132837  Vali Loss: 0.0259780 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873920  Vali macro F1 0.9869548 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.687696933746338
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0129308  Vali Loss: 0.0255900 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 4.705358028411865
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0132098  Vali Loss: 0.0254104 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 4.691196441650391
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0130028  Vali Loss: 0.0257162 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 4.685011386871338
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0124205  Vali Loss: 0.0255472 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 32 cost time: 4.702030420303345
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0127557  Vali Loss: 0.0255383 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.681509017944336
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0131428  Vali Loss: 0.0255312 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.701948165893555
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0128879  Vali Loss: 0.0255275 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.684032678604126
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0125421  Vali Loss: 0.0253667 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 4.701305150985718
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0126363  Vali Loss: 0.0253630 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9359649  Test weighted F1: 0.9189946  Test macro F1 0.9189946 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.259849786758423
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0143961  Vali Loss: 0.0209372 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
Validation loss decreased (inf --> 0.020937).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.276474952697754
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0153816  Vali Loss: 0.0258747 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.26016902923584
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0130645  Vali Loss: 0.0246056 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.27272891998291
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0132577  Vali Loss: 0.0233870 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.261862516403198
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0142883  Vali Loss: 0.0267822 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.256674289703369
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0106308  Vali Loss: 0.0217429 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.275574684143066
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0103687  Vali Loss: 0.0228429 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.259088039398193
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0098747  Vali Loss: 0.0238147 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.27305006980896
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0101181  Vali Loss: 0.0229950 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.259211540222168
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0092178  Vali Loss: 0.0218137 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.275094509124756
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0096495  Vali Loss: 0.0219737 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.26471471786499
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0090878  Vali Loss: 0.0227634 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.257721662521362
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0094700  Vali Loss: 0.0230035 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.273607969284058
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0087937  Vali Loss: 0.0229730 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.2592973709106445
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0091346  Vali Loss: 0.0228592 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.274393081665039
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0096754  Vali Loss: 0.0228812 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9403509  Test weighted F1: 0.9256513  Test macro F1 0.9256513 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.7591142654418945
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3604986  Vali Loss: 1.1519994 Vali Accuracy: 0.7969925  Vali weighted F1: 0.7863553  Vali macro F1 0.7807191 
Validation loss decreased (inf --> 1.151999).  Saving model ...
Epoch: 2 cost time: 4.6894402503967285
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8110090  Vali Loss: 0.4405712 Vali Accuracy: 0.9523810  Vali weighted F1: 0.9478566  Vali macro F1 0.9464128 
new best score!!!!
Validation loss decreased (1.151999 --> 0.440571).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.670531988143921
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3846094  Vali Loss: 0.2372716 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9769331  Vali macro F1 0.9763519 
new best score!!!!
Validation loss decreased (0.440571 --> 0.237272).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.691987991333008
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2166684  Vali Loss: 0.1409867 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860760  Vali macro F1 0.9853220 
new best score!!!!
Validation loss decreased (0.237272 --> 0.140987).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.6757636070251465
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1411855  Vali Loss: 0.0990205 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9922639  Vali macro F1 0.9923292 
new best score!!!!
Validation loss decreased (0.140987 --> 0.099021).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.690565824508667
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0998369  Vali Loss: 0.0623772 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949070  Vali macro F1 0.9949160 
new best score!!!!
Validation loss decreased (0.099021 --> 0.062377).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.6842663288116455
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0708900  Vali Loss: 0.0465571 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.062377 --> 0.046557).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.674201011657715
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0565513  Vali Loss: 0.0405877 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936655  Vali macro F1 0.9934965 
new best score!!!!
Validation loss decreased (0.046557 --> 0.040588).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.6911704540252686
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0467902  Vali Loss: 0.0337710 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.040588 --> 0.033771).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.674663066864014
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0428736  Vali Loss: 0.0292074 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949872  Vali macro F1 0.9945973 
new best score!!!!
Validation loss decreased (0.033771 --> 0.029207).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.693847179412842
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0376743  Vali Loss: 0.0226849 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.029207 --> 0.022685).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.676809549331665
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0309605  Vali Loss: 0.0209118 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.022685 --> 0.020912).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.6933753490448
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0241260  Vali Loss: 0.0160204 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.020912 --> 0.016020).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.684860706329346
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0246019  Vali Loss: 0.0157780 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.016020 --> 0.015778).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.673240661621094
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0196454  Vali Loss: 0.0117402 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.015778 --> 0.011740).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.695979356765747
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0201649  Vali Loss: 0.0134948 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.671993970870972
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0174566  Vali Loss: 0.0185544 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949778  Vali macro F1 0.9948418 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.690492630004883
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0178491  Vali Loss: 0.0109812 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.011740 --> 0.010981).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.678773403167725
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0154181  Vali Loss: 0.0126343 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 4.694685697555542
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0166483  Vali Loss: 0.0117322 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974767  Vali macro F1 0.9975797 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 4.6819658279418945
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0129277  Vali Loss: 0.0104843 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.010981 --> 0.010484).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.675070524215698
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0102601  Vali Loss: 0.0075818 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.010484 --> 0.007582).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.692680597305298
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0096978  Vali Loss: 0.0083194 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 4.676075458526611
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0115457  Vali Loss: 0.0108218 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987466  Vali macro F1 0.9984959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 4.692672967910767
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0236933  Vali Loss: 0.0132333 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974939  Vali macro F1 0.9971956 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 4.676518440246582
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0224962  Vali Loss: 0.0111935 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 4.692163705825806
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0122091  Vali Loss: 0.0071631 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.007582 --> 0.007163).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.682125806808472
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0144792  Vali Loss: 0.0094654 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.6717259883880615
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0128071  Vali Loss: 0.0092814 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.6931774616241455
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0154064  Vali Loss: 0.0083785 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 4.676852703094482
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0099600  Vali Loss: 0.0058215 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007163 --> 0.005821).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.695004224777222
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0159109  Vali Loss: 0.0118085 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962389  Vali macro F1 0.9956897 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.682771682739258
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0131483  Vali Loss: 0.0105148 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9961924  Vali macro F1 0.9962479 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.695265054702759
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0226596  Vali Loss: 0.0109422 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.6868062019348145
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0122864  Vali Loss: 0.0049873 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005821 --> 0.004987).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.673847436904907
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0173821  Vali Loss: 0.0111171 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 4.694217920303345
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0075440  Vali Loss: 0.0051716 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 4.676704406738281
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0059453  Vali Loss: 0.0087813 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974899  Vali macro F1 0.9973910 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 4.695385694503784
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0109856  Vali Loss: 0.0061446 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 4.675768613815308
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0060459  Vali Loss: 0.0033384 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004987 --> 0.003338).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 4.6955246925354
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0032708  Vali Loss: 0.0036648 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 4.689908742904663
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0029081  Vali Loss: 0.0038308 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 4.676330804824829
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0063773  Vali Loss: 0.0033866 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 4.698742389678955
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0038220  Vali Loss: 0.0047224 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 4.678146123886108
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0030844  Vali Loss: 0.0033362 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.003338 --> 0.003336).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 4.69951319694519
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0023602  Vali Loss: 0.0030696 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
new best score!!!!
Validation loss decreased (0.003336 --> 0.003070).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 4.682050943374634
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0027717  Vali Loss: 0.0028370 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.003070 --> 0.002837).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 4.699404716491699
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0061822  Vali Loss: 0.0031760 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 4.692330598831177
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0029760  Vali Loss: 0.0022568 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002837 --> 0.002257).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 4.68563985824585
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0020607  Vali Loss: 0.0037847 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 4.700398921966553
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0048031  Vali Loss: 0.0055509 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 4.681172132492065
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0068018  Vali Loss: 0.0047239 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987478  Vali macro F1 0.9988382 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 4.700137138366699
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0034919  Vali Loss: 0.0020007 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002257 --> 0.002001).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 4.68518590927124
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0020839  Vali Loss: 0.0027295 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 4.700154066085815
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0027157  Vali Loss: 0.0029934 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 4.6907172203063965
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0026999  Vali Loss: 0.0053056 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 4.6853086948394775
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0065512  Vali Loss: 0.0018609 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002001 --> 0.001861).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 4.704064130783081
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0027029  Vali Loss: 0.0021180 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 4.69166111946106
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0025112  Vali Loss: 0.0039503 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 4.705286026000977
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0038876  Vali Loss: 0.0025398 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 4.688388347625732
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0019346  Vali Loss: 0.0014836 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001861 --> 0.001484).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 4.704852819442749
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0024031  Vali Loss: 0.0022580 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 4.693659543991089
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0015402  Vali Loss: 0.0021023 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 4.686832427978516
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0011455  Vali Loss: 0.0020206 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 4.704891920089722
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0011129  Vali Loss: 0.0007574 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001484 --> 0.000757).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 4.686113119125366
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0009073  Vali Loss: 0.0024969 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 4.708682537078857
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0009303  Vali Loss: 0.0019721 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 4.684892654418945
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0008164  Vali Loss: 0.0022192 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 4.702447414398193
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0007949  Vali Loss: 0.0017568 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 4.692578077316284
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0007256  Vali Loss: 0.0020326 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 71 cost time: 4.683196544647217
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0006864  Vali Loss: 0.0020481 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 4.703395128250122
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0007333  Vali Loss: 0.0020333 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 4.684800863265991
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0006990  Vali Loss: 0.0017841 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 4.702195882797241
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0006871  Vali Loss: 0.0017641 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 4.684859752655029
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0006603  Vali Loss: 0.0017835 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 76 cost time: 4.706524133682251
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0006539  Vali Loss: 0.0017872 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 4.694990158081055
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0008207  Vali Loss: 0.0018940 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 4.684253931045532
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0006724  Vali Loss: 0.0019234 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 4.702025890350342
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0007182  Vali Loss: 0.0019277 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 4.68213677406311
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0006743  Vali Loss: 0.0019332 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7912281  Test weighted F1: 0.7686718  Test macro F1 0.7686718 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.264574289321899
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0008380  Vali Loss: 0.0022448 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
Validation loss decreased (inf --> 0.002245).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2571094036102295
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0006979  Vali Loss: 0.0039920 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.27415919303894
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0006640  Vali Loss: 0.0032681 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.257036924362183
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0005256  Vali Loss: 0.0028133 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.271652460098267
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0005458  Vali Loss: 0.0004086 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002245 --> 0.000409).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.258207082748413
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0006321  Vali Loss: 0.0039669 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.269963264465332
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0004345  Vali Loss: 0.0031987 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.266098499298096
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0005587  Vali Loss: 0.0030468 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.255317687988281
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0005969  Vali Loss: 0.0007879 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.271121501922607
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0004235  Vali Loss: 0.0016440 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.254388093948364
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0003966  Vali Loss: 0.0018289 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.2724974155426025
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0012579  Vali Loss: 0.0007945 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.256533861160278
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0005877  Vali Loss: 0.0021452 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.2691285610198975
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0015145  Vali Loss: 0.0003668 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000409 --> 0.000367).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.2593700885772705
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0005708  Vali Loss: 0.0002386 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000367 --> 0.000239).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.2551491260528564
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0012871  Vali Loss: 0.0026879 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.26908802986145
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0005695  Vali Loss: 0.0015051 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.257045030593872
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0003370  Vali Loss: 0.0019438 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.270038366317749
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0002873  Vali Loss: 0.0023893 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.254374980926514
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0003013  Vali Loss: 0.0025303 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.2692482471466064
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0003066  Vali Loss: 0.0026705 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.259108781814575
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0002803  Vali Loss: 0.0026560 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.253601312637329
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0003877  Vali Loss: 0.0026000 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.271194696426392
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0002679  Vali Loss: 0.0025050 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.25390887260437
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0002595  Vali Loss: 0.0024152 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.274583339691162
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0002521  Vali Loss: 0.0024105 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.25529408454895
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0002451  Vali Loss: 0.0024067 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.268506288528442
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0003071  Vali Loss: 0.0023963 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.2623419761657715
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0002652  Vali Loss: 0.0023865 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.252779722213745
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0002607  Vali Loss: 0.0023786 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7885965  Test weighted F1: 0.7589108  Test macro F1 0.7589108 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 408860
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.773633241653442
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3255046  Vali Loss: 1.1675128 Vali Accuracy: 0.7994987  Vali weighted F1: 0.7812424  Vali macro F1 0.7855961 
Validation loss decreased (inf --> 1.167513).  Saving model ...
Epoch: 2 cost time: 4.681119441986084
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.7786985  Vali Loss: 0.5026330 Vali Accuracy: 0.9022556  Vali weighted F1: 0.8945558  Vali macro F1 0.8924897 
new best score!!!!
Validation loss decreased (1.167513 --> 0.502633).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.674896001815796
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3885088  Vali Loss: 0.2841352 Vali Accuracy: 0.9573935  Vali weighted F1: 0.9524870  Vali macro F1 0.9523845 
new best score!!!!
Validation loss decreased (0.502633 --> 0.284135).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.667871952056885
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2444184  Vali Loss: 0.1993905 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9629166  Vali macro F1 0.9628794 
new best score!!!!
Validation loss decreased (0.284135 --> 0.199390).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.686908006668091
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1840210  Vali Loss: 0.1409357 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9793649  Vali macro F1 0.9795951 
new best score!!!!
Validation loss decreased (0.199390 --> 0.140936).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.670111179351807
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1234476  Vali Loss: 0.1088944 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821569  Vali macro F1 0.9819006 
new best score!!!!
Validation loss decreased (0.140936 --> 0.108894).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.687165021896362
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0939816  Vali Loss: 0.0809113 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875156  Vali macro F1 0.9876711 
new best score!!!!
Validation loss decreased (0.108894 --> 0.080911).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.674994945526123
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0781725  Vali Loss: 0.0637128 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885256  Vali macro F1 0.9886486 
new best score!!!!
Validation loss decreased (0.080911 --> 0.063713).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.689640283584595
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0623966  Vali Loss: 0.0607080 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9812404  Vali macro F1 0.9814044 
new best score!!!!
Validation loss decreased (0.063713 --> 0.060708).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.680612087249756
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0532868  Vali Loss: 0.0417639 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923629  Vali macro F1 0.9924214 
new best score!!!!
Validation loss decreased (0.060708 --> 0.041764).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.678960084915161
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0475304  Vali Loss: 0.0602193 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9784374  Vali macro F1 0.9785558 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.6955249309539795
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0543895  Vali Loss: 0.0449204 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885197  Vali macro F1 0.9884756 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.676663875579834
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0430785  Vali Loss: 0.0332422 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924442  Vali macro F1 0.9925862 
new best score!!!!
Validation loss decreased (0.041764 --> 0.033242).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.694397211074829
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0326816  Vali Loss: 0.0275483 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
new best score!!!!
Validation loss decreased (0.033242 --> 0.027548).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.680341720581055
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0273232  Vali Loss: 0.0256898 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924962 
new best score!!!!
Validation loss decreased (0.027548 --> 0.025690).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.6943581104278564
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0253994  Vali Loss: 0.0222958 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936730  Vali macro F1 0.9937632 
new best score!!!!
Validation loss decreased (0.025690 --> 0.022296).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.686504364013672
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0239455  Vali Loss: 0.0332740 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861480  Vali macro F1 0.9862349 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.676432132720947
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0430627  Vali Loss: 0.0357760 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9870501  Vali macro F1 0.9871581 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 4.696997880935669
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0287190  Vali Loss: 0.0215658 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936486  Vali macro F1 0.9937116 
new best score!!!!
Validation loss decreased (0.022296 --> 0.021566).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.682827949523926
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0216909  Vali Loss: 0.0194849 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.021566 --> 0.019485).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.697411060333252
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0200614  Vali Loss: 0.0164974 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949808  Vali macro F1 0.9949751 
new best score!!!!
Validation loss decreased (0.019485 --> 0.016497).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.679001569747925
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0223123  Vali Loss: 0.0168079 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937352  Vali macro F1 0.9937334 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.697624206542969
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0210095  Vali Loss: 0.0241942 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898596  Vali macro F1 0.9898308 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.688351631164551
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0182291  Vali Loss: 0.0146740 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
new best score!!!!
Validation loss decreased (0.016497 --> 0.014674).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.681056976318359
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0172117  Vali Loss: 0.0116314 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014674 --> 0.011631).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.698884010314941
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0189443  Vali Loss: 0.0140274 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 4.6816418170928955
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0147482  Vali Loss: 0.0117175 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 4.702122926712036
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0127756  Vali Loss: 0.0166455 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 4.69160532951355
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0184621  Vali Loss: 0.0127633 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 4.703399181365967
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0137986  Vali Loss: 0.0099133 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.011631 --> 0.009913).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.6956095695495605
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0124452  Vali Loss: 0.0135219 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 4.688352346420288
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0128631  Vali Loss: 0.0261926 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899834  Vali macro F1 0.9899796 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 4.70515251159668
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0160717  Vali Loss: 0.0122607 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 4.687931299209595
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0122629  Vali Loss: 0.0086341 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.009913 --> 0.008634).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.710524082183838
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0106451  Vali Loss: 0.0150631 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.694090366363525
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0139656  Vali Loss: 0.0147866 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924864  Vali macro F1 0.9925532 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.711499929428101
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0127505  Vali Loss: 0.0132164 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.709132432937622
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0087839  Vali Loss: 0.0133223 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962577  Vali macro F1 0.9965017 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.695117712020874
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0085450  Vali Loss: 0.0072975 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008634 --> 0.007297).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.713690519332886
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0064004  Vali Loss: 0.0064052 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.007297 --> 0.006405).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 4.790743589401245
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0124981  Vali Loss: 0.0121599 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9949761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 4.714963436126709
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0094744  Vali Loss: 0.0060211 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006405 --> 0.006021).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.6959428787231445
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0061492  Vali Loss: 0.0056078 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.006021 --> 0.005608).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 4.7134175300598145
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0067559  Vali Loss: 0.0056779 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 4.707887887954712
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0051498  Vali Loss: 0.0084893 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 4.731995344161987
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0050767  Vali Loss: 0.0063671 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 4.718474388122559
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0050644  Vali Loss: 0.0087046 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 4.69767951965332
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0063045  Vali Loss: 0.0103758 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 4.717004060745239
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0066640  Vali Loss: 0.0082638 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962236  Vali macro F1 0.9962949 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 4.700051784515381
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0047191  Vali Loss: 0.0105693 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 4.71654200553894
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0043343  Vali Loss: 0.0085506 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 4.706465005874634
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0041263  Vali Loss: 0.0087030 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 4.6989593505859375
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0042260  Vali Loss: 0.0084993 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 4.712680816650391
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0039524  Vali Loss: 0.0085093 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 4.694754362106323
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0040708  Vali Loss: 0.0084974 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 4.713901042938232
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0038399  Vali Loss: 0.0085205 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 4.691261291503906
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0039276  Vali Loss: 0.0084569 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 4.707783460617065
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0040932  Vali Loss: 0.0084561 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8710526  Test weighted F1: 0.8524078  Test macro F1 0.8524078 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.350916862487793
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0048013  Vali Loss: 0.0061771 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
Validation loss decreased (inf --> 0.006177).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.301853179931641
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0042734  Vali Loss: 0.0053659 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.006177 --> 0.005366).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.286449193954468
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0040259  Vali Loss: 0.0051471 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.005366 --> 0.005147).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.303652763366699
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0043355  Vali Loss: 0.0077528 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.292511463165283
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0050942  Vali Loss: 0.0049741 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
new best score!!!!
Validation loss decreased (0.005147 --> 0.004974).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.28322434425354
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0036566  Vali Loss: 0.0074140 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.293558120727539
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0033927  Vali Loss: 0.0057822 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.278634071350098
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0037373  Vali Loss: 0.0067570 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.295562267303467
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0043181  Vali Loss: 0.0069229 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.2780537605285645
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0039926  Vali Loss: 0.0063676 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.295450210571289
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0036096  Vali Loss: 0.0038944 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.004974 --> 0.003894).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.289922714233398
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0031229  Vali Loss: 0.0044007 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.280843257904053
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0030626  Vali Loss: 0.0042687 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.293692111968994
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0028837  Vali Loss: 0.0044694 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.272955417633057
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0026747  Vali Loss: 0.0050482 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.295605659484863
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0027168  Vali Loss: 0.0046330 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.275838851928711
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0024103  Vali Loss: 0.0045966 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.295702695846558
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0024028  Vali Loss: 0.0045490 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.284120559692383
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0026541  Vali Loss: 0.0045424 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.27843451499939
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0022950  Vali Loss: 0.0045188 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.2916259765625
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0029828  Vali Loss: 0.0044954 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 6.275979995727539
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0025563  Vali Loss: 0.0044838 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.287308216094971
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0027019  Vali Loss: 0.0044795 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.275559902191162
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0027077  Vali Loss: 0.0044722 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.290960788726807
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0027169  Vali Loss: 0.0044723 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.286150217056274
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025406  Vali Loss: 0.0044793 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8982456  Test weighted F1: 0.8900098  Test macro F1 0.8900098 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.793315172195435
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3408724  Vali Loss: 1.1736976 Vali Accuracy: 0.7944862  Vali weighted F1: 0.7809994  Vali macro F1 0.7828217 
Validation loss decreased (inf --> 1.173698).  Saving model ...
Epoch: 2 cost time: 4.6750569343566895
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.7855183  Vali Loss: 0.4946652 Vali Accuracy: 0.8771930  Vali weighted F1: 0.8698182  Vali macro F1 0.8669340 
new best score!!!!
Validation loss decreased (1.173698 --> 0.494665).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.68972110748291
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3929755  Vali Loss: 0.2861722 Vali Accuracy: 0.9573935  Vali weighted F1: 0.9559446  Vali macro F1 0.9559962 
new best score!!!!
Validation loss decreased (0.494665 --> 0.286172).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.680469274520874
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2512677  Vali Loss: 0.2004000 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9733120  Vali macro F1 0.9728149 
new best score!!!!
Validation loss decreased (0.286172 --> 0.200400).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.671193599700928
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1848230  Vali Loss: 0.1471394 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9797247  Vali macro F1 0.9793404 
new best score!!!!
Validation loss decreased (0.200400 --> 0.147139).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.688801288604736
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1269262  Vali Loss: 0.1140529 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845540  Vali macro F1 0.9845196 
new best score!!!!
Validation loss decreased (0.147139 --> 0.114053).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.671949148178101
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0958902  Vali Loss: 0.0774258 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911535  Vali macro F1 0.9913695 
new best score!!!!
Validation loss decreased (0.114053 --> 0.077426).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.688635587692261
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0761627  Vali Loss: 0.0581812 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911154  Vali macro F1 0.9912494 
new best score!!!!
Validation loss decreased (0.077426 --> 0.058181).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.676125526428223
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0601494  Vali Loss: 0.0626088 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837392  Vali macro F1 0.9839097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 4.689843654632568
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0510274  Vali Loss: 0.0439067 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923629  Vali macro F1 0.9924214 
new best score!!!!
Validation loss decreased (0.058181 --> 0.043907).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.683333396911621
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0445044  Vali Loss: 0.0444056 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.673213005065918
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0410154  Vali Loss: 0.0342982 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910702  Vali macro F1 0.9911236 
new best score!!!!
Validation loss decreased (0.043907 --> 0.034298).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.692128419876099
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0323840  Vali Loss: 0.0296984 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923998  Vali macro F1 0.9925381 
new best score!!!!
Validation loss decreased (0.034298 --> 0.029698).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.671306848526001
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0348302  Vali Loss: 0.0293103 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936870  Vali macro F1 0.9938693 
new best score!!!!
Validation loss decreased (0.029698 --> 0.029310).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.693706750869751
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0303310  Vali Loss: 0.0228624 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
new best score!!!!
Validation loss decreased (0.029310 --> 0.022862).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.677788257598877
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0332464  Vali Loss: 0.0313946 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924069  Vali macro F1 0.9925714 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.691868782043457
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0223461  Vali Loss: 0.0196813 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
new best score!!!!
Validation loss decreased (0.022862 --> 0.019681).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.686606168746948
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0209534  Vali Loss: 0.0191492 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9951399 
new best score!!!!
Validation loss decreased (0.019681 --> 0.019149).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.675227165222168
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0210069  Vali Loss: 0.0202942 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 4.701203107833862
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0237401  Vali Loss: 0.0171298 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.019149 --> 0.017130).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.679806470870972
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0192620  Vali Loss: 0.0228928 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912075  Vali macro F1 0.9913481 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.69681453704834
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0219890  Vali Loss: 0.0252913 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911820  Vali macro F1 0.9912402 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.679479360580444
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0214249  Vali Loss: 0.0225823 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911211  Vali macro F1 0.9912812 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 4.699443578720093
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0160903  Vali Loss: 0.0209935 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949717  Vali macro F1 0.9950434 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 4.688520669937134
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0158231  Vali Loss: 0.0129662 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962367  Vali macro F1 0.9963372 
new best score!!!!
Validation loss decreased (0.017130 --> 0.012966).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.682151556015015
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0170218  Vali Loss: 0.0148093 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 4.699654579162598
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0202991  Vali Loss: 0.0229310 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937412  Vali macro F1 0.9939712 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 4.683272838592529
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0148700  Vali Loss: 0.0192443 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912000  Vali macro F1 0.9913663 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 4.702257394790649
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0137463  Vali Loss: 0.0135221 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937462  Vali macro F1 0.9938162 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 4.68293571472168
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0121568  Vali Loss: 0.0121121 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
new best score!!!!
Validation loss decreased (0.012966 --> 0.012112).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.7036566734313965
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0116037  Vali Loss: 0.0121275 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962367  Vali macro F1 0.9963372 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 4.69119668006897
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0087369  Vali Loss: 0.0105493 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.012112 --> 0.010549).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.6819000244140625
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0099133  Vali Loss: 0.0139998 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949846 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.7005321979522705
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0088102  Vali Loss: 0.0089150 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.010549 --> 0.008915).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.684322118759155
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0150965  Vali Loss: 0.0160475 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.701855659484863
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0110026  Vali Loss: 0.0105485 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.6866912841796875
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0120861  Vali Loss: 0.0126107 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.700660228729248
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0073982  Vali Loss: 0.0132637 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.689609050750732
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0065762  Vali Loss: 0.0084014 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.008915 --> 0.008401).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.680334806442261
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0067155  Vali Loss: 0.0075736 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008401 --> 0.007574).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 4.699265003204346
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0084450  Vali Loss: 0.0109956 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 4.678967237472534
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0082756  Vali Loss: 0.0112339 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 4.697497367858887
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0078712  Vali Loss: 0.0084491 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 4.6800971031188965
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0149568  Vali Loss: 0.0132932 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936787  Vali macro F1 0.9937449 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 4.696061849594116
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0091315  Vali Loss: 0.0058190 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007574 --> 0.005819).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 4.687690734863281
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0054828  Vali Loss: 0.0052422 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.005819 --> 0.005242).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 4.678293228149414
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0057372  Vali Loss: 0.0122500 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 4.6965391635894775
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0061531  Vali Loss: 0.0053786 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 4.676999807357788
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0044166  Vali Loss: 0.0055664 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 4.695823431015015
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0085401  Vali Loss: 0.0050785 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005242 --> 0.005078).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 4.679579257965088
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0058285  Vali Loss: 0.0051386 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 4.699326992034912
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0045651  Vali Loss: 0.0029128 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005078 --> 0.002913).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 4.6887688636779785
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0040098  Vali Loss: 0.0027548 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002913 --> 0.002755).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 4.676696538925171
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0064842  Vali Loss: 0.0162185 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 4.695842742919922
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0237736  Vali Loss: 0.0113695 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 4.6740336418151855
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0090340  Vali Loss: 0.0099846 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949950  Vali macro F1 0.9952267 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 4.692428827285767
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0053794  Vali Loss: 0.0065466 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 4.675311326980591
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0046410  Vali Loss: 0.0049397 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 59 cost time: 4.693155288696289
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0042591  Vali Loss: 0.0040192 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 4.681573152542114
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0038209  Vali Loss: 0.0047653 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 4.672797679901123
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0036464  Vali Loss: 0.0043008 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 4.694587469100952
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0037295  Vali Loss: 0.0036546 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 4.6781065464019775
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0038737  Vali Loss: 0.0043687 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 64 cost time: 4.694753646850586
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0034323  Vali Loss: 0.0043301 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 4.677282333374023
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0035038  Vali Loss: 0.0040747 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 4.690036058425903
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0032434  Vali Loss: 0.0039482 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 4.682447195053101
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0029275  Vali Loss: 0.0039501 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 4.672288179397583
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0038939  Vali Loss: 0.0040390 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9421053  Test weighted F1: 0.9260812  Test macro F1 0.9260812 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.272215843200684
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0061120  Vali Loss: 0.0052318 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
Validation loss decreased (inf --> 0.005232).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.284596681594849
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0028346  Vali Loss: 0.0044316 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005232 --> 0.004432).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.282008409500122
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0027878  Vali Loss: 0.0048468 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.26986289024353
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0040804  Vali Loss: 0.0027143 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004432 --> 0.002714).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.282588958740234
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0030436  Vali Loss: 0.0036720 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.264862537384033
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0027025  Vali Loss: 0.0022143 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.002714 --> 0.002214).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.282719135284424
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0027955  Vali Loss: 0.0016924 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002214 --> 0.001692).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.271273612976074
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0024822  Vali Loss: 0.0034230 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.28511643409729
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0024667  Vali Loss: 0.0046390 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.2784423828125
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0024053  Vali Loss: 0.0018038 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.265066385269165
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0023684  Vali Loss: 0.0014127 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001692 --> 0.001413).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.28333592414856
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0026409  Vali Loss: 0.0026553 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.265140533447266
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0031771  Vali Loss: 0.0077706 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.285868167877197
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0027491  Vali Loss: 0.0014555 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.267083406448364
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0022360  Vali Loss: 0.0011700 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001413 --> 0.001170).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.284075498580933
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0028068  Vali Loss: 0.0015171 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.277852773666382
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022481  Vali Loss: 0.0018400 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.264327049255371
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0022881  Vali Loss: 0.0018015 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.286210775375366
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0019211  Vali Loss: 0.0013579 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.269177436828613
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0018855  Vali Loss: 0.0012237 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 21 cost time: 6.290608882904053
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0018345  Vali Loss: 0.0010108 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001170 --> 0.001011).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.272240877151489
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0017992  Vali Loss: 0.0009249 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001011 --> 0.000925).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.288312673568726
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0025203  Vali Loss: 0.0021040 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.2814836502075195
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0027299  Vali Loss: 0.0012929 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.2687671184539795
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0034214  Vali Loss: 0.0010865 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.280695199966431
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018654  Vali Loss: 0.0049483 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.268115282058716
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0018485  Vali Loss: 0.0040671 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 6.285648345947266
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0020535  Vali Loss: 0.0039022 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.272942304611206
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0017199  Vali Loss: 0.0038570 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.289569139480591
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0017569  Vali Loss: 0.0035260 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.27984094619751
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0019406  Vali Loss: 0.0034798 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.270224571228027
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0017005  Vali Loss: 0.0029582 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 6.287930727005005
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0016620  Vali Loss: 0.0029989 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.271197080612183
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0014751  Vali Loss: 0.0029780 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.290736675262451
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0018808  Vali Loss: 0.0029729 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.271754741668701
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0023710  Vali Loss: 0.0029448 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.285572052001953
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0016799  Vali Loss: 0.0029492 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9412281  Test weighted F1: 0.9246674  Test macro F1 0.9246674 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.761120319366455
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3260769  Vali Loss: 1.1833787 Vali Accuracy: 0.7456140  Vali weighted F1: 0.7157042  Vali macro F1 0.7188178 
Validation loss decreased (inf --> 1.183379).  Saving model ...
Epoch: 2 cost time: 4.694960117340088
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.7842962  Vali Loss: 0.4808671 Vali Accuracy: 0.9147870  Vali weighted F1: 0.9085570  Vali macro F1 0.9089208 
new best score!!!!
Validation loss decreased (1.183379 --> 0.480867).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.675435781478882
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3948417  Vali Loss: 0.2779903 Vali Accuracy: 0.9523810  Vali weighted F1: 0.9514002  Vali macro F1 0.9505695 
new best score!!!!
Validation loss decreased (0.480867 --> 0.277990).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.6920106410980225
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2426488  Vali Loss: 0.1825352 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808183  Vali macro F1 0.9805216 
new best score!!!!
Validation loss decreased (0.277990 --> 0.182535).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.681410074234009
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1613031  Vali Loss: 0.1202901 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845774  Vali macro F1 0.9846023 
new best score!!!!
Validation loss decreased (0.182535 --> 0.120290).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.672016620635986
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1161848  Vali Loss: 0.0878255 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845708  Vali macro F1 0.9846715 
new best score!!!!
Validation loss decreased (0.120290 --> 0.087826).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.687671422958374
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0881902  Vali Loss: 0.0663758 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
new best score!!!!
Validation loss decreased (0.087826 --> 0.066376).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.681712865829468
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0677598  Vali Loss: 0.0537986 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861042  Vali macro F1 0.9858903 
new best score!!!!
Validation loss decreased (0.066376 --> 0.053799).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.695438623428345
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0567572  Vali Loss: 0.0526125 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822901  Vali macro F1 0.9823954 
new best score!!!!
Validation loss decreased (0.053799 --> 0.052612).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.675915479660034
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0428967  Vali Loss: 0.0312100 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936486  Vali macro F1 0.9937116 
new best score!!!!
Validation loss decreased (0.052612 --> 0.031210).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.6956024169921875
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0371798  Vali Loss: 0.0342173 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911167  Vali macro F1 0.9911749 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.687353134155273
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0360103  Vali Loss: 0.0336879 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.678931474685669
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0314949  Vali Loss: 0.0343805 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886978  Vali macro F1 0.9887074 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 4.69840931892395
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0287017  Vali Loss: 0.0229393 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.031210 --> 0.022939).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.679997444152832
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0241931  Vali Loss: 0.0208405 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949846 
new best score!!!!
Validation loss decreased (0.022939 --> 0.020840).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.696730136871338
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0199709  Vali Loss: 0.0302410 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911488  Vali macro F1 0.9911262 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.682856321334839
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0207101  Vali Loss: 0.0230470 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.698651313781738
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0210727  Vali Loss: 0.0259942 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 4.689084768295288
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0179864  Vali Loss: 0.0198919 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
new best score!!!!
Validation loss decreased (0.020840 --> 0.019892).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.681214332580566
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0222655  Vali Loss: 0.0187411 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
new best score!!!!
Validation loss decreased (0.019892 --> 0.018741).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.699842929840088
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0215146  Vali Loss: 0.0193726 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911820  Vali macro F1 0.9912402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.677104949951172
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0163906  Vali Loss: 0.0203564 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924638  Vali macro F1 0.9925384 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.699659824371338
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0182970  Vali Loss: 0.0164242 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
new best score!!!!
Validation loss decreased (0.018741 --> 0.016424).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.683090686798096
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0178103  Vali Loss: 0.0159284 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
new best score!!!!
Validation loss decreased (0.016424 --> 0.015928).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.698358535766602
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0188828  Vali Loss: 0.0142610 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936193  Vali macro F1 0.9937556 
new best score!!!!
Validation loss decreased (0.015928 --> 0.014261).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.689029693603516
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0170337  Vali Loss: 0.0131824 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.014261 --> 0.013182).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.681070804595947
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0138106  Vali Loss: 0.0159373 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.6966187953948975
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0113386  Vali Loss: 0.0083223 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
new best score!!!!
Validation loss decreased (0.013182 --> 0.008322).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.68024206161499
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0107899  Vali Loss: 0.0086153 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 4.6973724365234375
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0120223  Vali Loss: 0.0123386 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 4.682373523712158
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0143827  Vali Loss: 0.0142513 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 4.698383092880249
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0092168  Vali Loss: 0.0076462 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
new best score!!!!
Validation loss decreased (0.008322 --> 0.007646).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.6877992153167725
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0125593  Vali Loss: 0.0201737 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912354  Vali macro F1 0.9913714 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.676101922988892
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0160392  Vali Loss: 0.0154587 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9949761 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 4.69717001914978
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0100574  Vali Loss: 0.0066056 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
new best score!!!!
Validation loss decreased (0.007646 --> 0.006606).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.6788599491119385
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0257855  Vali Loss: 0.0181524 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923629  Vali macro F1 0.9924214 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 4.696491956710815
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0122361  Vali Loss: 0.0084331 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 4.6828413009643555
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0110447  Vali Loss: 0.0166169 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 4.696866989135742
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0076132  Vali Loss: 0.0067203 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 4.686509132385254
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0055348  Vali Loss: 0.0068151 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974937 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 4.678720235824585
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0056044  Vali Loss: 0.0056496 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006606 --> 0.005650).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 4.698658227920532
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0043000  Vali Loss: 0.0053585 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005650 --> 0.005359).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.676508665084839
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0046494  Vali Loss: 0.0055948 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.698294401168823
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0041636  Vali Loss: 0.0052163 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005359 --> 0.005216).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 4.681511640548706
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0043448  Vali Loss: 0.0055881 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.697106122970581
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0043241  Vali Loss: 0.0056724 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.6856396198272705
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0041035  Vali Loss: 0.0058551 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.677013635635376
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0040098  Vali Loss: 0.0057686 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.696439266204834
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0036898  Vali Loss: 0.0059347 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 4.677204370498657
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0041818  Vali Loss: 0.0059589 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 4.6954545974731445
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0038588  Vali Loss: 0.0059413 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 4.6815876960754395
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0037033  Vali Loss: 0.0059717 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 4.695260524749756
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0042567  Vali Loss: 0.0060919 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 4.687804698944092
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0039172  Vali Loss: 0.0060942 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 4.6772661209106445
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0045711  Vali Loss: 0.0060987 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 4.695594310760498
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0038571  Vali Loss: 0.0060952 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 4.676861763000488
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0042454  Vali Loss: 0.0060953 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 4.699688673019409
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0039148  Vali Loss: 0.0060853 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 4.679217338562012
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0039302  Vali Loss: 0.0060829 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8991228  Test weighted F1: 0.8816372  Test macro F1 0.8816372 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.2927258014678955
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0041187  Vali Loss: 0.0066533 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
Validation loss decreased (inf --> 0.006653).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.272633790969849
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0038120  Vali Loss: 0.0061414 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006653 --> 0.006141).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.2887609004974365
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0036748  Vali Loss: 0.0069832 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.270167112350464
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0035604  Vali Loss: 0.0052555 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006141 --> 0.005255).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.287851572036743
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0035226  Vali Loss: 0.0063409 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.279861927032471
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0032829  Vali Loss: 0.0059905 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.270680904388428
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0038857  Vali Loss: 0.0074001 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.291072845458984
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0052706  Vali Loss: 0.0035370 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.005255 --> 0.003537).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.273037433624268
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0038607  Vali Loss: 0.0040983 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.288967609405518
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0033241  Vali Loss: 0.0027764 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003537 --> 0.002776).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.276706218719482
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0023745  Vali Loss: 0.0032922 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.2887349128723145
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0029340  Vali Loss: 0.0035372 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.280721426010132
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0034974  Vali Loss: 0.0050020 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.2716264724731445
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0029950  Vali Loss: 0.0027520 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.002776 --> 0.002752).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.287023544311523
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0028332  Vali Loss: 0.0019704 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002752 --> 0.001970).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.271201133728027
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0027755  Vali Loss: 0.0029481 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.296297073364258
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0027733  Vali Loss: 0.0043475 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.272719144821167
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0021433  Vali Loss: 0.0047074 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.290095090866089
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0018755  Vali Loss: 0.0047240 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.280745267868042
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0049415  Vali Loss: 0.0066971 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 21 cost time: 6.271246433258057
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0031011  Vali Loss: 0.0027126 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.287353515625
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024324  Vali Loss: 0.0060839 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.269330263137817
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0023274  Vali Loss: 0.0040409 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.287689924240112
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0027690  Vali Loss: 0.0043903 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.270541429519653
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0022293  Vali Loss: 0.0035958 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 6.289088726043701
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0026159  Vali Loss: 0.0038592 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.278773784637451
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0019913  Vali Loss: 0.0039063 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.268204212188721
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0026359  Vali Loss: 0.0039904 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.294343709945679
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0024395  Vali Loss: 0.0041421 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.270720958709717
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0023033  Vali Loss: 0.0042224 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9008772  Test weighted F1: 0.8836186  Test macro F1 0.8836186 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.786213636398315
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3325322  Vali Loss: 1.1189297 Vali Accuracy: 0.7919799  Vali weighted F1: 0.7813058  Vali macro F1 0.7825715 
Validation loss decreased (inf --> 1.118930).  Saving model ...
Epoch: 2 cost time: 4.670119047164917
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.7771211  Vali Loss: 0.4869802 Vali Accuracy: 0.9035088  Vali weighted F1: 0.9008557  Vali macro F1 0.8978975 
new best score!!!!
Validation loss decreased (1.118930 --> 0.486980).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.68989372253418
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3955793  Vali Loss: 0.2867514 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9500925  Vali macro F1 0.9479105 
new best score!!!!
Validation loss decreased (0.486980 --> 0.286751).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.6717259883880615
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2388122  Vali Loss: 0.1829569 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9689262  Vali macro F1 0.9685453 
new best score!!!!
Validation loss decreased (0.286751 --> 0.182957).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.688503265380859
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1629522  Vali Loss: 0.1182205 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821645  Vali macro F1 0.9817466 
new best score!!!!
Validation loss decreased (0.182957 --> 0.118221).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.670953035354614
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1168354  Vali Loss: 0.0991236 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836365  Vali macro F1 0.9834140 
new best score!!!!
Validation loss decreased (0.118221 --> 0.099124).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.688212633132935
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0911795  Vali Loss: 0.0729668 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862792  Vali macro F1 0.9865010 
new best score!!!!
Validation loss decreased (0.099124 --> 0.072967).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.678930759429932
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0721006  Vali Loss: 0.0569923 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911154  Vali macro F1 0.9912494 
new best score!!!!
Validation loss decreased (0.072967 --> 0.056992).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.669665813446045
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0608267  Vali Loss: 0.0489752 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911533  Vali macro F1 0.9912163 
new best score!!!!
Validation loss decreased (0.056992 --> 0.048975).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.693328619003296
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0500285  Vali Loss: 0.0406053 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911154  Vali macro F1 0.9912494 
new best score!!!!
Validation loss decreased (0.048975 --> 0.040605).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.671299457550049
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0451806  Vali Loss: 0.0684993 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9745718  Vali macro F1 0.9748139 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.688810348510742
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0636125  Vali Loss: 0.0590932 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9858428  Vali macro F1 0.9861072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.673543691635132
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0625268  Vali Loss: 0.0430610 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9850557  Vali macro F1 0.9852807 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 4.68964695930481
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0382750  Vali Loss: 0.0278862 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
new best score!!!!
Validation loss decreased (0.040605 --> 0.027886).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.6772301197052
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0318564  Vali Loss: 0.0299547 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862792  Vali macro F1 0.9865010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.672083616256714
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0297358  Vali Loss: 0.0266602 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899624  Vali macro F1 0.9901829 
new best score!!!!
Validation loss decreased (0.027886 --> 0.026660).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.690566539764404
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0245401  Vali Loss: 0.0200264 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.026660 --> 0.020026).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.671494722366333
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0253073  Vali Loss: 0.0240907 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924693  Vali macro F1 0.9925643 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.6875410079956055
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0232252  Vali Loss: 0.0202800 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 4.673882722854614
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0187013  Vali Loss: 0.0186094 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
new best score!!!!
Validation loss decreased (0.020026 --> 0.018609).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.689759016036987
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0166480  Vali Loss: 0.0188335 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937352  Vali macro F1 0.9937334 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.679439306259155
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0180994  Vali Loss: 0.0156188 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936787  Vali macro F1 0.9938315 
new best score!!!!
Validation loss decreased (0.018609 --> 0.015619).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.670254230499268
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0165749  Vali Loss: 0.0153052 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9951090 
new best score!!!!
Validation loss decreased (0.015619 --> 0.015305).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.689022064208984
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0148791  Vali Loss: 0.0150858 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
new best score!!!!
Validation loss decreased (0.015305 --> 0.015086).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.670613050460815
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0132617  Vali Loss: 0.0146672 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9975655 
new best score!!!!
Validation loss decreased (0.015086 --> 0.014667).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.689263105392456
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0210856  Vali Loss: 0.0137813 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936787  Vali macro F1 0.9938207 
new best score!!!!
Validation loss decreased (0.014667 --> 0.013781).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.670377254486084
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0175268  Vali Loss: 0.0129443 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9951090 
new best score!!!!
Validation loss decreased (0.013781 --> 0.012944).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.689536809921265
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0160601  Vali Loss: 0.0154276 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950032  Vali macro F1 0.9951622 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.680806636810303
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0130686  Vali Loss: 0.0138177 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.671598672866821
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0120176  Vali Loss: 0.0137598 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949008  Vali macro F1 0.9949818 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 4.691225528717041
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0136682  Vali Loss: 0.0159532 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950032  Vali macro F1 0.9951622 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 4.674731731414795
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0113194  Vali Loss: 0.0115211 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950010  Vali macro F1 0.9949838 
new best score!!!!
Validation loss decreased (0.012944 --> 0.011521).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.6957902908325195
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0122799  Vali Loss: 0.0118097 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.680659770965576
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0100373  Vali Loss: 0.0088139 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.011521 --> 0.008814).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.697088003158569
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0138257  Vali Loss: 0.0145444 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.6870622634887695
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0133260  Vali Loss: 0.0126980 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.677753925323486
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0169845  Vali Loss: 0.0235975 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900432  Vali macro F1 0.9901336 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.696615695953369
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0150731  Vali Loss: 0.0088347 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.677114248275757
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0092218  Vali Loss: 0.0107050 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 4.695988655090332
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0074120  Vali Loss: 0.0093619 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.682550668716431
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0068423  Vali Loss: 0.0080643 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
new best score!!!!
Validation loss decreased (0.008814 --> 0.008064).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 4.699867010116577
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0066517  Vali Loss: 0.0078201 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
new best score!!!!
Validation loss decreased (0.008064 --> 0.007820).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.691228866577148
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0070868  Vali Loss: 0.0080038 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.677509784698486
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0070957  Vali Loss: 0.0080690 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 4.698957443237305
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0065099  Vali Loss: 0.0082347 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 4.678536653518677
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0064320  Vali Loss: 0.0081838 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 4.699113368988037
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0063163  Vali Loss: 0.0083922 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 48 cost time: 4.682513236999512
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0063695  Vali Loss: 0.0084308 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 4.69885778427124
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0063515  Vali Loss: 0.0083613 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 4.691237688064575
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0061847  Vali Loss: 0.0083961 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 4.681445360183716
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0062547  Vali Loss: 0.0083144 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 4.698808431625366
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0060944  Vali Loss: 0.0083345 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 53 cost time: 4.679792165756226
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0060318  Vali Loss: 0.0083299 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 4.703994274139404
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0058615  Vali Loss: 0.0083316 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 4.6864399909973145
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0059728  Vali Loss: 0.0083367 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 4.7087082862854
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0063598  Vali Loss: 0.0083305 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 4.698945760726929
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0062582  Vali Loss: 0.0083327 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7991228  Test weighted F1: 0.7476305  Test macro F1 0.7476305 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.303840398788452
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0067606  Vali Loss: 0.0084420 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
Validation loss decreased (inf --> 0.008442).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.284376382827759
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0059278  Vali Loss: 0.0084099 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.008442 --> 0.008410).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.298813819885254
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0056860  Vali Loss: 0.0081682 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
new best score!!!!
Validation loss decreased (0.008410 --> 0.008168).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.287527322769165
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0052056  Vali Loss: 0.0085063 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.281978368759155
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0058033  Vali Loss: 0.0084936 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.310321092605591
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0053785  Vali Loss: 0.0056167 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008168 --> 0.005617).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.27923059463501
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0049758  Vali Loss: 0.0073784 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.300263404846191
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0048908  Vali Loss: 0.0070545 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.278443813323975
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0047775  Vali Loss: 0.0079227 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.301241397857666
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0047006  Vali Loss: 0.0075083 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.293310880661011
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0046896  Vali Loss: 0.0076096 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9962619 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.280052185058594
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0046659  Vali Loss: 0.0069783 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.306881904602051
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0054220  Vali Loss: 0.0081254 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.279336214065552
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0048844  Vali Loss: 0.0114258 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.301237344741821
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0048040  Vali Loss: 0.0063108 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.280988454818726
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0039560  Vali Loss: 0.0084708 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.29836893081665
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0033891  Vali Loss: 0.0080618 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.2932305335998535
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0040154  Vali Loss: 0.0073505 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.2789037227630615
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0035931  Vali Loss: 0.0068253 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.291134357452393
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0038391  Vali Loss: 0.0071257 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.268695831298828
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0036260  Vali Loss: 0.0069661 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7368421  Test weighted F1: 0.6606224  Test macro F1 0.6606224 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.782978773117065
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3523058  Vali Loss: 1.1619391 Vali Accuracy: 0.7681704  Vali weighted F1: 0.7572455  Vali macro F1 0.7603244 
Validation loss decreased (inf --> 1.161939).  Saving model ...
Epoch: 2 cost time: 4.681013345718384
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.7876826  Vali Loss: 0.4688272 Vali Accuracy: 0.9197995  Vali weighted F1: 0.9183643  Vali macro F1 0.9176262 
new best score!!!!
Validation loss decreased (1.161939 --> 0.468827).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.697468996047974
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3780939  Vali Loss: 0.2564930 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9584253  Vali macro F1 0.9573997 
new best score!!!!
Validation loss decreased (0.468827 --> 0.256493).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.6783599853515625
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2332096  Vali Loss: 0.1764570 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9757041  Vali macro F1 0.9753468 
new best score!!!!
Validation loss decreased (0.256493 --> 0.176457).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.699925899505615
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1626632  Vali Loss: 0.1100513 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885828  Vali macro F1 0.9886357 
new best score!!!!
Validation loss decreased (0.176457 --> 0.110051).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.683368682861328
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1118315  Vali Loss: 0.0846847 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924819  Vali macro F1 0.9926577 
new best score!!!!
Validation loss decreased (0.110051 --> 0.084685).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.69873309135437
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0854119  Vali Loss: 0.0639318 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925446  Vali macro F1 0.9926961 
new best score!!!!
Validation loss decreased (0.084685 --> 0.063932).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.687172174453735
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0752902  Vali Loss: 0.0534836 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937412  Vali macro F1 0.9939712 
new best score!!!!
Validation loss decreased (0.063932 --> 0.053484).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.679574489593506
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0670941  Vali Loss: 0.0420302 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
new best score!!!!
Validation loss decreased (0.053484 --> 0.042030).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.6989569664001465
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0486451  Vali Loss: 0.0375630 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911907  Vali macro F1 0.9916339 
new best score!!!!
Validation loss decreased (0.042030 --> 0.037563).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.679956912994385
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0447690  Vali Loss: 0.0511358 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937317  Vali macro F1 0.9937334 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.6978466510772705
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0503988  Vali Loss: 0.0327688 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9951399 
new best score!!!!
Validation loss decreased (0.037563 --> 0.032769).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.683189153671265
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0332696  Vali Loss: 0.0273485 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
new best score!!!!
Validation loss decreased (0.032769 --> 0.027349).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.703511476516724
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0282743  Vali Loss: 0.0246473 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9927128 
new best score!!!!
Validation loss decreased (0.027349 --> 0.024647).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.68938136100769
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0251567  Vali Loss: 0.0215348 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
new best score!!!!
Validation loss decreased (0.024647 --> 0.021535).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.687077522277832
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0218916  Vali Loss: 0.0168323 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.021535 --> 0.016832).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.699301481246948
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0208562  Vali Loss: 0.0155381 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.016832 --> 0.015538).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.680243015289307
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0186779  Vali Loss: 0.0150875 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
new best score!!!!
Validation loss decreased (0.015538 --> 0.015087).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.697049856185913
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0182713  Vali Loss: 0.0149950 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.015087 --> 0.014995).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.6799328327178955
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0172353  Vali Loss: 0.0146275 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9951399 
new best score!!!!
Validation loss decreased (0.014995 --> 0.014627).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.699207782745361
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0143775  Vali Loss: 0.0196947 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937307  Vali macro F1 0.9938289 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.688958168029785
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0177401  Vali Loss: 0.0130410 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
new best score!!!!
Validation loss decreased (0.014627 --> 0.013041).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.680115461349487
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0244436  Vali Loss: 0.0189137 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949786  Vali macro F1 0.9950906 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 4.699086904525757
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0159544  Vali Loss: 0.0160372 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949784  Vali macro F1 0.9950764 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 4.683647394180298
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0173389  Vali Loss: 0.0250391 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937407  Vali macro F1 0.9938024 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 4.702603101730347
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0212013  Vali Loss: 0.0141003 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 4.685080051422119
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0146710  Vali Loss: 0.0213444 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887914  Vali macro F1 0.9885851 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 4.702647924423218
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0151101  Vali Loss: 0.0114275 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
new best score!!!!
Validation loss decreased (0.013041 --> 0.011427).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.692907810211182
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0108040  Vali Loss: 0.0097328 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
new best score!!!!
Validation loss decreased (0.011427 --> 0.009733).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.686771869659424
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0097135  Vali Loss: 0.0085536 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
new best score!!!!
Validation loss decreased (0.009733 --> 0.008554).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.6998631954193115
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0094422  Vali Loss: 0.0092309 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 4.684503793716431
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0094497  Vali Loss: 0.0081675 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.008554 --> 0.008168).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.7010719776153564
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0093340  Vali Loss: 0.0091964 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.683745384216309
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0089410  Vali Loss: 0.0091720 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 4.701373100280762
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0087484  Vali Loss: 0.0089605 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 4.691436529159546
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0084199  Vali Loss: 0.0087464 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 4.6839516162872314
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0093928  Vali Loss: 0.0084776 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 4.705565452575684
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0084517  Vali Loss: 0.0084678 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 4.683966159820557
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0084175  Vali Loss: 0.0084574 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 4.702591896057129
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0080557  Vali Loss: 0.0084176 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 4.68889045715332
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0082526  Vali Loss: 0.0084061 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 4.705536842346191
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0082717  Vali Loss: 0.0084111 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 43 cost time: 4.6969239711761475
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0080402  Vali Loss: 0.0084077 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.681807518005371
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0087181  Vali Loss: 0.0084107 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 4.7054243087768555
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0083098  Vali Loss: 0.0084143 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 4.6813554763793945
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0085617  Vali Loss: 0.0084135 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 4.705261707305908
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0081961  Vali Loss: 0.0084117 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8096491  Test weighted F1: 0.7652600  Test macro F1 0.7652600 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.2999725341796875
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0094089  Vali Loss: 0.0093687 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
Validation loss decreased (inf --> 0.009369).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.312839031219482
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0087658  Vali Loss: 0.0076926 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
new best score!!!!
Validation loss decreased (0.009369 --> 0.007693).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.293314218521118
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0071903  Vali Loss: 0.0072282 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974951  Vali macro F1 0.9975009 
new best score!!!!
Validation loss decreased (0.007693 --> 0.007228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.321041822433472
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0071166  Vali Loss: 0.0079906 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.303901195526123
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0066607  Vali Loss: 0.0076401 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.312264919281006
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0069903  Vali Loss: 0.0052065 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007228 --> 0.005207).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.30830979347229
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0067672  Vali Loss: 0.0068415 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9962619 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.296297073364258
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0060138  Vali Loss: 0.0079712 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949750  Vali macro F1 0.9950563 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.309856414794922
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0055887  Vali Loss: 0.0062404 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974951  Vali macro F1 0.9975009 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.290127754211426
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0067388  Vali Loss: 0.0054032 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974951  Vali macro F1 0.9975009 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.307679176330566
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0063945  Vali Loss: 0.0080118 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.290361404418945
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0056394  Vali Loss: 0.0074569 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.308323860168457
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0061316  Vali Loss: 0.0055086 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975097  Vali macro F1 0.9975851 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.294314622879028
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0065809  Vali Loss: 0.0067828 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9962619 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.291589021682739
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0054019  Vali Loss: 0.0055210 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.314912796020508
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0054683  Vali Loss: 0.0041315 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005207 --> 0.004131).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.29337215423584
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0047073  Vali Loss: 0.0037205 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004131 --> 0.003720).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.311242341995239
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0048739  Vali Loss: 0.0035676 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003720 --> 0.003568).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.292114734649658
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0048896  Vali Loss: 0.0046492 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974949  Vali macro F1 0.9975191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.307353496551514
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0047352  Vali Loss: 0.0039277 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.300318241119385
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0046651  Vali Loss: 0.0032139 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003568 --> 0.003214).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.291468381881714
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0045274  Vali Loss: 0.0034982 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.311032056808472
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0034578  Vali Loss: 0.0036077 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.28970742225647
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0038516  Vali Loss: 0.0033301 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.297245979309082
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0039404  Vali Loss: 0.0035914 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9987557 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.292626142501831
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0040195  Vali Loss: 0.0062166 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.296496868133545
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0039898  Vali Loss: 0.0060066 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.2970147132873535
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0035961  Vali Loss: 0.0059451 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.28827428817749
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0042949  Vali Loss: 0.0056154 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.306969165802002
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0034336  Vali Loss: 0.0052386 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.291468381881714
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0032524  Vali Loss: 0.0051888 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 6.30081844329834
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0047049  Vali Loss: 0.0051812 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.2955896854400635
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0035335  Vali Loss: 0.0051492 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.3028564453125
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0033944  Vali Loss: 0.0051352 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.298539638519287
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0036346  Vali Loss: 0.0051354 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.293278932571411
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0036025  Vali Loss: 0.0051305 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9975206 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8535088  Test weighted F1: 0.8203607  Test macro F1 0.8203607 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.777825832366943
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3359196  Vali Loss: 1.2368647 Vali Accuracy: 0.7819549  Vali weighted F1: 0.7699134  Vali macro F1 0.7709908 
Validation loss decreased (inf --> 1.236865).  Saving model ...
Epoch: 2 cost time: 4.684473037719727
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8122963  Vali Loss: 0.5021880 Vali Accuracy: 0.8897243  Vali weighted F1: 0.8859481  Vali macro F1 0.8888841 
new best score!!!!
Validation loss decreased (1.236865 --> 0.502188).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.675693511962891
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4040866  Vali Loss: 0.2820020 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9643612  Vali macro F1 0.9638773 
new best score!!!!
Validation loss decreased (0.502188 --> 0.282002).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.665730953216553
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2429522  Vali Loss: 0.1800751 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9764500  Vali macro F1 0.9766045 
new best score!!!!
Validation loss decreased (0.282002 --> 0.180075).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.685688018798828
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1671958  Vali Loss: 0.1249303 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859054  Vali macro F1 0.9859385 
new best score!!!!
Validation loss decreased (0.180075 --> 0.124930).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.666301012039185
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1172310  Vali Loss: 0.0916841 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859054  Vali macro F1 0.9859385 
new best score!!!!
Validation loss decreased (0.124930 --> 0.091684).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.685138463973999
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0881221  Vali Loss: 0.0724447 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898265  Vali macro F1 0.9898796 
new best score!!!!
Validation loss decreased (0.091684 --> 0.072445).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.668763875961304
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0733397  Vali Loss: 0.0612062 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836363  Vali macro F1 0.9837167 
new best score!!!!
Validation loss decreased (0.072445 --> 0.061206).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.686325788497925
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0569300  Vali Loss: 0.0755347 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9782113  Vali macro F1 0.9783542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 4.6780195236206055
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0480511  Vali Loss: 0.0409046 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924507  Vali macro F1 0.9925213 
new best score!!!!
Validation loss decreased (0.061206 --> 0.040905).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.667804956436157
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0398612  Vali Loss: 0.0676956 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822213  Vali macro F1 0.9823364 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.685791254043579
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0468282  Vali Loss: 0.0403750 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9883818  Vali macro F1 0.9884970 
new best score!!!!
Validation loss decreased (0.040905 --> 0.040375).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.6627678871154785
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0367076  Vali Loss: 0.0262994 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
new best score!!!!
Validation loss decreased (0.040375 --> 0.026299).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.682577610015869
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0332000  Vali Loss: 0.0339895 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898976  Vali macro F1 0.9898819 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.665693759918213
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0319586  Vali Loss: 0.0464616 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822213  Vali macro F1 0.9823364 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.99364972114563
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0364228  Vali Loss: 0.0254513 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
new best score!!!!
Validation loss decreased (0.026299 --> 0.025451).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.672396659851074
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0243655  Vali Loss: 0.0230075 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911488  Vali macro F1 0.9911262 
new best score!!!!
Validation loss decreased (0.025451 --> 0.023007).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.663710832595825
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0222587  Vali Loss: 0.0167473 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.023007 --> 0.016747).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.683892488479614
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0201904  Vali Loss: 0.0197805 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924727  Vali macro F1 0.9924769 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 4.664261817932129
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0252736  Vali Loss: 0.0233095 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937147  Vali macro F1 0.9937298 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 4.688107252120972
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0205525  Vali Loss: 0.0135531 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
new best score!!!!
Validation loss decreased (0.016747 --> 0.013553).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.673053741455078
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0155373  Vali Loss: 0.0191494 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924476  Vali macro F1 0.9922504 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.6872947216033936
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0162828  Vali Loss: 0.0157105 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.680234909057617
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0153744  Vali Loss: 0.0091985 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.013553 --> 0.009199).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.667873382568359
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0188804  Vali Loss: 0.0161131 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962237  Vali macro F1 0.9962951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.689931154251099
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0185870  Vali Loss: 0.0157863 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962237  Vali macro F1 0.9962951 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.668980836868286
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0148190  Vali Loss: 0.0084682 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.009199 --> 0.008468).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.688223361968994
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0130571  Vali Loss: 0.0077384 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008468 --> 0.007738).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.673177003860474
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0109674  Vali Loss: 0.0121360 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 4.692489385604858
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0102631  Vali Loss: 0.0096608 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 4.683315277099609
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0209839  Vali Loss: 0.0335871 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898596  Vali macro F1 0.9898308 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 4.675134897232056
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0230918  Vali Loss: 0.0113690 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 4.695104360580444
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0134901  Vali Loss: 0.0091115 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 4.675220251083374
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0096790  Vali Loss: 0.0081076 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 4.691233158111572
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0089873  Vali Loss: 0.0078792 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 4.678123950958252
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0085225  Vali Loss: 0.0078876 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 4.6890435218811035
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0087024  Vali Loss: 0.0082105 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 4.6815900802612305
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0082855  Vali Loss: 0.0084936 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 4.671312570571899
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0082865  Vali Loss: 0.0084783 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 4.69037127494812
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0080752  Vali Loss: 0.0085063 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 4.669440984725952
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0084827  Vali Loss: 0.0085595 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 4.689540147781372
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0079866  Vali Loss: 0.0084198 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 4.673247337341309
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0081069  Vali Loss: 0.0084572 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9000000  Test weighted F1: 0.8896017  Test macro F1 0.8896017 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.31697154045105
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0107542  Vali Loss: 0.0076576 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
Validation loss decreased (inf --> 0.007658).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.296072959899902
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0099296  Vali Loss: 0.0080127 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.320125102996826
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0094517  Vali Loss: 0.0096429 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.296928405761719
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0087028  Vali Loss: 0.0082743 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.309723615646362
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0089539  Vali Loss: 0.0102866 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.306749582290649
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0081302  Vali Loss: 0.0070811 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.007658 --> 0.007081).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.294753074645996
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0075823  Vali Loss: 0.0078717 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.348424673080444
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0077168  Vali Loss: 0.0072679 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.279552936553955
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0070688  Vali Loss: 0.0061658 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.007081 --> 0.006166).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.297182321548462
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0069024  Vali Loss: 0.0060297 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.006166 --> 0.006030).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.282248020172119
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0065531  Vali Loss: 0.0104850 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.296857118606567
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0071463  Vali Loss: 0.0123846 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.287584066390991
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0059464  Vali Loss: 0.0073414 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.277454137802124
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0108037  Vali Loss: 0.0081644 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.293114423751831
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0063307  Vali Loss: 0.0075033 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.275716304779053
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0056653  Vali Loss: 0.0076277 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.302652359008789
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0058464  Vali Loss: 0.0071307 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.276503562927246
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0054759  Vali Loss: 0.0066660 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.296347379684448
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0057567  Vali Loss: 0.0066417 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.283435344696045
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0056768  Vali Loss: 0.0082693 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 21 cost time: 6.2761290073394775
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0055843  Vali Loss: 0.0082576 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.298290729522705
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0056252  Vali Loss: 0.0082216 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.2779741287231445
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0057740  Vali Loss: 0.0082259 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.295314073562622
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0060293  Vali Loss: 0.0082344 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.276562929153442
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0056086  Vali Loss: 0.0081311 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9184211  Test weighted F1: 0.9153857  Test macro F1 0.9153857 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.775904655456543
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3282417  Vali Loss: 1.1528254 Vali Accuracy: 0.8007519  Vali weighted F1: 0.7871720  Vali macro F1 0.7892371 
Validation loss decreased (inf --> 1.152825).  Saving model ...
Epoch: 2 cost time: 4.662645578384399
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.7915456  Vali Loss: 0.4846644 Vali Accuracy: 0.8984962  Vali weighted F1: 0.8944377  Vali macro F1 0.8931075 
new best score!!!!
Validation loss decreased (1.152825 --> 0.484664).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.680833339691162
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4015370  Vali Loss: 0.2876313 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9529258  Vali macro F1 0.9514915 
new best score!!!!
Validation loss decreased (0.484664 --> 0.287631).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.666882753372192
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2454406  Vali Loss: 0.1817150 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9733928  Vali macro F1 0.9734229 
new best score!!!!
Validation loss decreased (0.287631 --> 0.181715).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.683420658111572
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1752508  Vali Loss: 0.1297342 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9824308  Vali macro F1 0.9831464 
new best score!!!!
Validation loss decreased (0.181715 --> 0.129734).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.6718385219573975
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1259282  Vali Loss: 0.0956512 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837011  Vali macro F1 0.9841441 
new best score!!!!
Validation loss decreased (0.129734 --> 0.095651).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.514230489730835
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0940602  Vali Loss: 0.0901710 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9747604  Vali macro F1 0.9748276 
new best score!!!!
Validation loss decreased (0.095651 --> 0.090171).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.683696508407593
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0785067  Vali Loss: 0.0621674 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874698  Vali macro F1 0.9878400 
new best score!!!!
Validation loss decreased (0.090171 --> 0.062167).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.663823127746582
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0664889  Vali Loss: 0.0576573 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875412  Vali macro F1 0.9880715 
new best score!!!!
Validation loss decreased (0.062167 --> 0.057657).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.681926965713501
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0531878  Vali Loss: 0.0417055 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924725  Vali macro F1 0.9926170 
new best score!!!!
Validation loss decreased (0.057657 --> 0.041706).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.670099496841431
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0459325  Vali Loss: 0.1113128 Vali Accuracy: 0.9523810  Vali weighted F1: 0.9459580  Vali macro F1 0.9466660 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.685284376144409
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0828172  Vali Loss: 0.0561153 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899658  Vali macro F1 0.9903476 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.672950267791748
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0481926  Vali Loss: 0.0378764 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911873  Vali macro F1 0.9914618 
new best score!!!!
Validation loss decreased (0.041706 --> 0.037876).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.663492202758789
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0391844  Vali Loss: 0.0330180 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
new best score!!!!
Validation loss decreased (0.037876 --> 0.033018).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.684595346450806
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0377289  Vali Loss: 0.0509181 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9814861  Vali macro F1 0.9819675 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.662857294082642
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0447955  Vali Loss: 0.0326360 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924831  Vali macro F1 0.9925392 
new best score!!!!
Validation loss decreased (0.033018 --> 0.032636).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.6882288455963135
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0301214  Vali Loss: 0.0299152 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937317  Vali macro F1 0.9937334 
new best score!!!!
Validation loss decreased (0.032636 --> 0.029915).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.667924880981445
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0253063  Vali Loss: 0.0211761 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
new best score!!!!
Validation loss decreased (0.029915 --> 0.021176).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.686134338378906
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0213957  Vali Loss: 0.0196354 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
new best score!!!!
Validation loss decreased (0.021176 --> 0.019635).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.678020238876343
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0227200  Vali Loss: 0.0224767 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9949761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.665589809417725
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0179936  Vali Loss: 0.0207292 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937319  Vali macro F1 0.9937104 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 4.68420934677124
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0177703  Vali Loss: 0.0189995 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912035  Vali macro F1 0.9912950 
new best score!!!!
Validation loss decreased (0.019635 --> 0.018999).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.669204473495483
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0173606  Vali Loss: 0.0176167 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937162  Vali macro F1 0.9938109 
new best score!!!!
Validation loss decreased (0.018999 --> 0.017617).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.688260316848755
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0161029  Vali Loss: 0.0193788 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937352  Vali macro F1 0.9937334 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 4.674470901489258
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0154272  Vali Loss: 0.0153397 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.017617 --> 0.015340).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.6928839683532715
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0133379  Vali Loss: 0.0151942 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.015340 --> 0.015194).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.680107831954956
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0148130  Vali Loss: 0.0144996 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
new best score!!!!
Validation loss decreased (0.015194 --> 0.014500).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.67648720741272
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0212656  Vali Loss: 0.0204298 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936787  Vali macro F1 0.9937449 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.69169020652771
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0165391  Vali Loss: 0.0212478 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924506  Vali macro F1 0.9922242 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.670207500457764
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0145921  Vali Loss: 0.0145440 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 4.691103458404541
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0109754  Vali Loss: 0.0113988 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.014500 --> 0.011399).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.673506259918213
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0093436  Vali Loss: 0.0150749 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.69169020652771
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0098512  Vali Loss: 0.0135113 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937426  Vali macro F1 0.9935990 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.6821675300598145
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0079831  Vali Loss: 0.0125725 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.676783084869385
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0104339  Vali Loss: 0.0111018 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937241  Vali macro F1 0.9936081 
new best score!!!!
Validation loss decreased (0.011399 --> 0.011102).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.694928169250488
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0089808  Vali Loss: 0.0128301 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949995  Vali macro F1 0.9948584 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 4.676614046096802
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0075926  Vali Loss: 0.0116050 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 4.696583271026611
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0124333  Vali Loss: 0.0185301 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925232  Vali macro F1 0.9924967 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 4.682246923446655
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0109702  Vali Loss: 0.0067043 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.011102 --> 0.006704).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.694382667541504
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0074677  Vali Loss: 0.0056417 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006704 --> 0.005642).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 4.686432600021362
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0058087  Vali Loss: 0.0144672 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937162  Vali macro F1 0.9938109 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 4.675492763519287
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0065665  Vali Loss: 0.0112207 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 4.6941423416137695
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0093787  Vali Loss: 0.0121214 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937301  Vali macro F1 0.9935845 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 4.673229455947876
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0728858  Vali Loss: 0.0402683 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875017  Vali macro F1 0.9873695 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 4.694047212600708
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0229055  Vali Loss: 0.0215574 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924541  Vali macro F1 0.9925170 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 4.681672811508179
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0148181  Vali Loss: 0.0179058 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937426  Vali macro F1 0.9935990 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 4.692817211151123
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0124748  Vali Loss: 0.0174563 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937426  Vali macro F1 0.9935990 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 4.681694269180298
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0118285  Vali Loss: 0.0163033 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 4.673998117446899
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0112783  Vali Loss: 0.0156133 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 4.696368455886841
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0111080  Vali Loss: 0.0136664 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 4.675158739089966
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0105673  Vali Loss: 0.0136826 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 4.694989204406738
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0103042  Vali Loss: 0.0139483 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 4.67544412612915
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0096848  Vali Loss: 0.0141755 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 4.693861246109009
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0102202  Vali Loss: 0.0143284 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 4.6836159229278564
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0107060  Vali Loss: 0.0143214 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9061404  Test weighted F1: 0.8915876  Test macro F1 0.8915876 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.325504779815674
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0049678  Vali Loss: 0.0043747 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
Validation loss decreased (inf --> 0.004375).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.309692859649658
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0050850  Vali Loss: 0.0041364 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004375 --> 0.004136).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.327487468719482
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0045711  Vali Loss: 0.0040132 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004136 --> 0.004013).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.316014051437378
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0039319  Vali Loss: 0.0042166 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.306248426437378
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0039696  Vali Loss: 0.0038935 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004013 --> 0.003894).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.32550835609436
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0040730  Vali Loss: 0.0035397 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003894 --> 0.003540).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.301534175872803
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0034600  Vali Loss: 0.0042898 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.326626300811768
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0034471  Vali Loss: 0.0026332 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003540 --> 0.002633).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.307376861572266
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031188  Vali Loss: 0.0027257 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.322720766067505
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0037434  Vali Loss: 0.0044967 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.317091226577759
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0038271  Vali Loss: 0.0030158 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.307858467102051
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0038585  Vali Loss: 0.0020677 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002633 --> 0.002068).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.320807218551636
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0034761  Vali Loss: 0.0048716 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.298076152801514
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0031723  Vali Loss: 0.0072697 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.323242664337158
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0029963  Vali Loss: 0.0067053 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.300996541976929
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0031318  Vali Loss: 0.0044064 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.314527750015259
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0025427  Vali Loss: 0.0025558 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 6.310839653015137
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0027875  Vali Loss: 0.0025569 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.2937071323394775
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0030688  Vali Loss: 0.0057307 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.316817998886108
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0024425  Vali Loss: 0.0034423 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.301653623580933
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0023415  Vali Loss: 0.0029651 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.318831443786621
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0028159  Vali Loss: 0.0036369 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.299953460693359
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0023370  Vali Loss: 0.0036661 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.307859659194946
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0033975  Vali Loss: 0.0044011 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.315381050109863
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0026985  Vali Loss: 0.0041310 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.2989044189453125
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0027261  Vali Loss: 0.0038532 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.316753387451172
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0028718  Vali Loss: 0.0030232 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9210526  Test weighted F1: 0.9050279  Test macro F1 0.9050279 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.790328502655029
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3012780  Vali Loss: 1.1475598 Vali Accuracy: 0.7794486  Vali weighted F1: 0.7700660  Vali macro F1 0.7711100 
Validation loss decreased (inf --> 1.147560).  Saving model ...
Epoch: 2 cost time: 4.678971529006958
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.7553840  Vali Loss: 0.4781975 Vali Accuracy: 0.9135338  Vali weighted F1: 0.9063303  Vali macro F1 0.9056335 
new best score!!!!
Validation loss decreased (1.147560 --> 0.478198).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.671895503997803
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3708318  Vali Loss: 0.2567705 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9615743  Vali macro F1 0.9615015 
new best score!!!!
Validation loss decreased (0.478198 --> 0.256770).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.689624547958374
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2274463  Vali Loss: 0.1785917 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9747417  Vali macro F1 0.9747189 
new best score!!!!
Validation loss decreased (0.256770 --> 0.178592).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.6690473556518555
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1653367  Vali Loss: 0.1252523 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9791090  Vali macro F1 0.9791414 
new best score!!!!
Validation loss decreased (0.178592 --> 0.125252).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.6842498779296875
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1130146  Vali Loss: 0.0921366 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9833563  Vali macro F1 0.9831034 
new best score!!!!
Validation loss decreased (0.125252 --> 0.092137).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.666579484939575
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0936264  Vali Loss: 0.0699603 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887056  Vali macro F1 0.9890022 
new best score!!!!
Validation loss decreased (0.092137 --> 0.069960).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.682851791381836
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0698648  Vali Loss: 0.0538013 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897703  Vali macro F1 0.9899731 
new best score!!!!
Validation loss decreased (0.069960 --> 0.053801).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.741151332855225
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0548462  Vali Loss: 0.0736273 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9743779  Vali macro F1 0.9746968 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 4.666531085968018
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0457009  Vali Loss: 0.0385048 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910736  Vali macro F1 0.9912812 
new best score!!!!
Validation loss decreased (0.053801 --> 0.038505).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.683675765991211
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0369944  Vali Loss: 0.0374592 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923998  Vali macro F1 0.9925381 
new best score!!!!
Validation loss decreased (0.038505 --> 0.037459).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.669253587722778
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0360422  Vali Loss: 0.0366064 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885256  Vali macro F1 0.9886486 
new best score!!!!
Validation loss decreased (0.037459 --> 0.036606).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.686478137969971
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0290169  Vali Loss: 0.0318260 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900347  Vali macro F1 0.9901938 
new best score!!!!
Validation loss decreased (0.036606 --> 0.031826).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.669732332229614
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0271748  Vali Loss: 0.0220912 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
new best score!!!!
Validation loss decreased (0.031826 --> 0.022091).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.690345525741577
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0278753  Vali Loss: 0.0514749 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836618  Vali macro F1 0.9838495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.676928520202637
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0506140  Vali Loss: 0.0471802 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9800153  Vali macro F1 0.9803799 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 4.6667563915252686
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0288821  Vali Loss: 0.0283490 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912221  Vali macro F1 0.9912851 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 4.684685945510864
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0232795  Vali Loss: 0.0189585 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
new best score!!!!
Validation loss decreased (0.022091 --> 0.018958).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.665795564651489
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0190537  Vali Loss: 0.0180772 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937173  Vali macro F1 0.9938621 
new best score!!!!
Validation loss decreased (0.018958 --> 0.018077).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.685633182525635
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0162238  Vali Loss: 0.0180599 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.018077 --> 0.018060).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.667658805847168
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0154878  Vali Loss: 0.0162530 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
new best score!!!!
Validation loss decreased (0.018060 --> 0.016253).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.681729793548584
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0136511  Vali Loss: 0.0214088 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924541  Vali macro F1 0.9925170 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.6795220375061035
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0129207  Vali Loss: 0.0128573 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962246  Vali macro F1 0.9963716 
new best score!!!!
Validation loss decreased (0.016253 --> 0.012857).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.664382219314575
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0103034  Vali Loss: 0.0120207 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962559  Vali macro F1 0.9964043 
new best score!!!!
Validation loss decreased (0.012857 --> 0.012021).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.6859495639801025
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0099702  Vali Loss: 0.0169294 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925110  Vali macro F1 0.9926602 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.6669886112213135
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0077731  Vali Loss: 0.0077309 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.012021 --> 0.007731).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.686140775680542
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0075298  Vali Loss: 0.0074481 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.007731 --> 0.007448).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.668776035308838
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0092147  Vali Loss: 0.0152957 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949510  Vali macro F1 0.9951686 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.686681747436523
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0091708  Vali Loss: 0.0133039 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949607  Vali macro F1 0.9948087 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.674912691116333
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0080389  Vali Loss: 0.0079528 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 4.6633079051971436
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0064587  Vali Loss: 0.0086582 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 4.683898687362671
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0056423  Vali Loss: 0.0141767 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925218  Vali macro F1 0.9927434 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 4.666282892227173
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0087040  Vali Loss: 0.0077617 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962364  Vali macro F1 0.9964558 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.691239595413208
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0053514  Vali Loss: 0.0072635 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
new best score!!!!
Validation loss decreased (0.007448 --> 0.007264).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.670320987701416
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0046291  Vali Loss: 0.0069358 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
new best score!!!!
Validation loss decreased (0.007264 --> 0.006936).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.682823896408081
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0046449  Vali Loss: 0.0062062 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.006936 --> 0.006206).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 4.673568487167358
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0044302  Vali Loss: 0.0061209 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.006206 --> 0.006121).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 4.666410446166992
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0047804  Vali Loss: 0.0061515 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 4.68329119682312
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0048476  Vali Loss: 0.0058187 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.006121 --> 0.005819).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.667201042175293
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0041395  Vali Loss: 0.0056042 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.005819 --> 0.005604).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 4.684283971786499
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0042569  Vali Loss: 0.0054557 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.005604 --> 0.005456).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 4.67140007019043
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0039992  Vali Loss: 0.0053433 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.005456 --> 0.005343).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.685783863067627
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0050527  Vali Loss: 0.0052898 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.005343 --> 0.005290).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 4.678644895553589
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0043299  Vali Loss: 0.0054388 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 4.667689800262451
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0040754  Vali Loss: 0.0062178 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 4.684887647628784
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0038015  Vali Loss: 0.0059247 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 4.665584087371826
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0037936  Vali Loss: 0.0062142 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 4.683377265930176
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0037996  Vali Loss: 0.0061450 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 4.669309139251709
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0039838  Vali Loss: 0.0060748 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 4.6835668087005615
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0038258  Vali Loss: 0.0060169 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 4.678393125534058
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0036257  Vali Loss: 0.0059554 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 4.670459985733032
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0038190  Vali Loss: 0.0058971 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 4.689189195632935
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0066676  Vali Loss: 0.0058359 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 4.674518585205078
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0035842  Vali Loss: 0.0057976 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 4.689392328262329
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0036365  Vali Loss: 0.0057899 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 4.674848794937134
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0036324  Vali Loss: 0.0057853 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 4.693163633346558
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0036689  Vali Loss: 0.0057786 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 4.677953243255615
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0036894  Vali Loss: 0.0057722 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8298246  Test weighted F1: 0.8151701  Test macro F1 0.8151701 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.250192880630493
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0043010  Vali Loss: 0.0050024 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
Validation loss decreased (inf --> 0.005002).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.233279705047607
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0033173  Vali Loss: 0.0051648 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.243457078933716
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0038736  Vali Loss: 0.0063935 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.242892265319824
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0036090  Vali Loss: 0.0043781 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.005002 --> 0.004378).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.225744724273682
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0027053  Vali Loss: 0.0048303 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.2453813552856445
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0034023  Vali Loss: 0.0047913 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.230183124542236
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0026369  Vali Loss: 0.0039772 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.004378 --> 0.003977).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.246022701263428
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0023233  Vali Loss: 0.0034169 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.003977 --> 0.003417).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.23178243637085
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0021959  Vali Loss: 0.0026355 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003417 --> 0.002635).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.24808144569397
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0028486  Vali Loss: 0.0035650 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.238960266113281
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0023170  Vali Loss: 0.0030121 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.226912260055542
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0020193  Vali Loss: 0.0028712 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.248654842376709
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0018127  Vali Loss: 0.0024799 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.002635 --> 0.002480).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.228384017944336
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0018903  Vali Loss: 0.0038311 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.250251054763794
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0016796  Vali Loss: 0.0038111 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.230068922042847
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0016197  Vali Loss: 0.0028220 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.255589008331299
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0018979  Vali Loss: 0.0021745 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.002480 --> 0.002174).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.240037202835083
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0016192  Vali Loss: 0.0028470 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.236510276794434
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0015664  Vali Loss: 0.0030447 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.251826524734497
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0014455  Vali Loss: 0.0031762 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.2341766357421875
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0028934  Vali Loss: 0.0037018 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.2510905265808105
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0043655  Vali Loss: 0.0038323 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975037  Vali macro F1 0.9976784 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 23 cost time: 6.235795021057129
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0021074  Vali Loss: 0.0029871 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.253445148468018
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0016356  Vali Loss: 0.0026953 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.242659091949463
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0013869  Vali Loss: 0.0033359 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.229201316833496
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0013471  Vali Loss: 0.0026869 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.253138065338135
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0013354  Vali Loss: 0.0024517 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 6.231957912445068
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0011963  Vali Loss: 0.0023693 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.2536585330963135
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0016172  Vali Loss: 0.0021776 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.236660718917847
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0011636  Vali Loss: 0.0021762 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.251773118972778
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0012144  Vali Loss: 0.0020606 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002174 --> 0.002061).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 6.242832660675049
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0012474  Vali Loss: 0.0020245 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002061 --> 0.002024).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.232395648956299
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0011413  Vali Loss: 0.0019758 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002024 --> 0.001976).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 6.251075744628906
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0015987  Vali Loss: 0.0017401 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001976 --> 0.001740).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 6.228832721710205
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0011139  Vali Loss: 0.0016786 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001740 --> 0.001679).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 36 cost time: 6.245386362075806
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0011544  Vali Loss: 0.0017067 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.231016635894775
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0012619  Vali Loss: 0.0016742 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001679 --> 0.001674).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 38 cost time: 6.244990587234497
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0011311  Vali Loss: 0.0016865 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 6.233532190322876
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0011539  Vali Loss: 0.0016984 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 6.229618310928345
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0013177  Vali Loss: 0.0018254 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 6.242903232574463
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0011819  Vali Loss: 0.0019157 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 6.227926969528198
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0010966  Vali Loss: 0.0019164 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 43 cost time: 6.244097948074341
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0011815  Vali Loss: 0.0019165 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 6.229130983352661
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0012378  Vali Loss: 0.0019134 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 6.243541955947876
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0010929  Vali Loss: 0.0019105 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 46 cost time: 6.234503269195557
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0011630  Vali Loss: 0.0019021 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 47 cost time: 6.2262372970581055
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0010689  Vali Loss: 0.0019040 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 48 cost time: 6.246293067932129
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0011275  Vali Loss: 0.0019035 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 49 cost time: 6.229334592819214
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0010881  Vali Loss: 0.0019027 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 50 cost time: 6.2452168464660645
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0011864  Vali Loss: 0.0019024 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 51 cost time: 6.228522539138794
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0012927  Vali Loss: 0.0018971 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 52 cost time: 6.245695114135742
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0011305  Vali Loss: 0.0018966 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8464912  Test weighted F1: 0.8286482  Test macro F1 0.8286482 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 408860
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.7570555210113525
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5218302  Vali Loss: 1.2701471 Vali Accuracy: 0.8370927  Vali weighted F1: 0.8272481  Vali macro F1 0.8233374 
Validation loss decreased (inf --> 1.270147).  Saving model ...
Epoch: 2 cost time: 4.68008017539978
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8421074  Vali Loss: 0.4676174 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9480975  Vali macro F1 0.9475075 
new best score!!!!
Validation loss decreased (1.270147 --> 0.467617).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.664254426956177
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3765122  Vali Loss: 0.2452820 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9606039  Vali macro F1 0.9591462 
new best score!!!!
Validation loss decreased (0.467617 --> 0.245282).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.682567358016968
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2272253  Vali Loss: 0.1707593 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9667705  Vali macro F1 0.9657854 
new best score!!!!
Validation loss decreased (0.245282 --> 0.170759).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.672921895980835
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1707583  Vali Loss: 0.1196989 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9796816  Vali macro F1 0.9785746 
new best score!!!!
Validation loss decreased (0.170759 --> 0.119699).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.663427114486694
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1187385  Vali Loss: 0.0916382 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9783525  Vali macro F1 0.9780469 
new best score!!!!
Validation loss decreased (0.119699 --> 0.091638).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.685484409332275
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0901230  Vali Loss: 0.0717979 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872614  Vali macro F1 0.9865915 
new best score!!!!
Validation loss decreased (0.091638 --> 0.071798).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.66955041885376
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0733485  Vali Loss: 0.0583753 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886266  Vali macro F1 0.9881274 
new best score!!!!
Validation loss decreased (0.071798 --> 0.058375).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.686212778091431
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0561865  Vali Loss: 0.0528016 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886995  Vali macro F1 0.9877383 
new best score!!!!
Validation loss decreased (0.058375 --> 0.052802).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.668807744979858
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0500932  Vali Loss: 0.0472983 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911271  Vali macro F1 0.9907243 
new best score!!!!
Validation loss decreased (0.052802 --> 0.047298).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.686984062194824
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0577139  Vali Loss: 0.0472966 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911271  Vali macro F1 0.9907243 
new best score!!!!
Validation loss decreased (0.047298 --> 0.047297).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.678806781768799
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0426162  Vali Loss: 0.0442367 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887859  Vali macro F1 0.9886031 
new best score!!!!
Validation loss decreased (0.047297 --> 0.044237).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.671346187591553
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0372698  Vali Loss: 0.0387045 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911307  Vali macro F1 0.9904256 
new best score!!!!
Validation loss decreased (0.044237 --> 0.038705).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.693403959274292
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0335004  Vali Loss: 0.0306186 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9918530 
new best score!!!!
Validation loss decreased (0.038705 --> 0.030619).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.674628019332886
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0274131  Vali Loss: 0.0347503 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911470  Vali macro F1 0.9907272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.694673538208008
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0382257  Vali Loss: 0.0386487 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912697  Vali macro F1 0.9906380 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 4.676239728927612
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0636821  Vali Loss: 0.0341541 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924416  Vali macro F1 0.9920443 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 4.691754579544067
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0300255  Vali Loss: 0.0288509 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937411  Vali macro F1 0.9934991 
new best score!!!!
Validation loss decreased (0.030619 --> 0.028851).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.682162761688232
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0289528  Vali Loss: 0.0313409 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912166  Vali macro F1 0.9908085 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 4.6751508712768555
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0359608  Vali Loss: 0.0354679 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874522  Vali macro F1 0.9867922 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 4.695003271102905
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0220508  Vali Loss: 0.0240688 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937595  Vali macro F1 0.9932944 
new best score!!!!
Validation loss decreased (0.028851 --> 0.024069).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.6745381355285645
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0195915  Vali Loss: 0.0273418 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924845  Vali macro F1 0.9920468 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.696007966995239
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0250634  Vali Loss: 0.0254188 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.677321434020996
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0167867  Vali Loss: 0.0217733 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
new best score!!!!
Validation loss decreased (0.024069 --> 0.021773).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.696760892868042
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0140184  Vali Loss: 0.0220277 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.682602643966675
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0134023  Vali Loss: 0.0219304 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949810  Vali macro F1 0.9946150 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.676328897476196
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0118419  Vali Loss: 0.0235493 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924504  Vali macro F1 0.9920071 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 4.695817708969116
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0113192  Vali Loss: 0.0219802 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937316  Vali macro F1 0.9933758 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 4.677804708480835
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0106398  Vali Loss: 0.0206388 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.021773 --> 0.020639).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.694219350814819
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0160161  Vali Loss: 0.0289929 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885046  Vali macro F1 0.9876164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.685958385467529
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0231164  Vali Loss: 0.0206839 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937169  Vali macro F1 0.9933479 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 4.693711519241333
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0133555  Vali Loss: 0.0218524 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937037  Vali macro F1 0.9932293 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 4.6860032081604
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0120308  Vali Loss: 0.0193935 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924530  Vali macro F1 0.9918865 
new best score!!!!
Validation loss decreased (0.020639 --> 0.019393).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 4.675363779067993
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0091491  Vali Loss: 0.0169296 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.019393 --> 0.016930).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.697135925292969
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0080462  Vali Loss: 0.0190759 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949884  Vali macro F1 0.9947272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.677023887634277
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0093605  Vali Loss: 0.0182395 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949664  Vali macro F1 0.9946853 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.6957786083221436
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0123855  Vali Loss: 0.0190395 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.68328070640564
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0091725  Vali Loss: 0.0185953 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924490  Vali macro F1 0.9918830 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.698976993560791
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0082500  Vali Loss: 0.0225815 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924312  Vali macro F1 0.9921022 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 4.687171459197998
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0077441  Vali Loss: 0.0219219 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911697  Vali macro F1 0.9907426 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.681172847747803
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0060329  Vali Loss: 0.0214764 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924528  Vali macro F1 0.9919007 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.697234630584717
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0061898  Vali Loss: 0.0211092 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924528  Vali macro F1 0.9919007 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.683238744735718
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0057608  Vali Loss: 0.0206265 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924528  Vali macro F1 0.9919007 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 4.697387456893921
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0060199  Vali Loss: 0.0201033 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9932612 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 4.679653882980347
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0055984  Vali Loss: 0.0200968 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9932612 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.696555137634277
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0055428  Vali Loss: 0.0201039 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9932612 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.688835620880127
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0056531  Vali Loss: 0.0201100 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924528  Vali macro F1 0.9919007 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.678807258605957
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0058750  Vali Loss: 0.0201458 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9932612 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.69776177406311
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0058315  Vali Loss: 0.0201591 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9932612 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8894737  Test weighted F1: 0.8745938  Test macro F1 0.8745938 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.293075323104858
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0080071  Vali Loss: 0.0209005 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
Validation loss decreased (inf --> 0.020901).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.284329414367676
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0075658  Vali Loss: 0.0208214 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911900  Vali macro F1 0.9906486 
new best score!!!!
Validation loss decreased (0.020901 --> 0.020821).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.2759175300598145
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0069313  Vali Loss: 0.0211888 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911900  Vali macro F1 0.9906486 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.294857740402222
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0062570  Vali Loss: 0.0199033 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949884  Vali macro F1 0.9947272 
new best score!!!!
Validation loss decreased (0.020821 --> 0.019903).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.265697479248047
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0069781  Vali Loss: 0.0186726 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.019903 --> 0.018673).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.288880348205566
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0065714  Vali Loss: 0.0196113 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.264258861541748
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0058300  Vali Loss: 0.0207416 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912034  Vali macro F1 0.9906479 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.284554481506348
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0056242  Vali Loss: 0.0197901 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.278006315231323
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0052704  Vali Loss: 0.0196404 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937169  Vali macro F1 0.9933479 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.2664878368377686
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0052875  Vali Loss: 0.0186614 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
new best score!!!!
Validation loss decreased (0.018673 --> 0.018661).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.279919624328613
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0047860  Vali Loss: 0.0184706 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.018661 --> 0.018471).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.2714104652404785
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0047493  Vali Loss: 0.0197561 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924592  Vali macro F1 0.9919002 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.280815601348877
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0047825  Vali Loss: 0.0193852 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.262293338775635
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0043587  Vali Loss: 0.0188926 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.2768635749816895
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0050184  Vali Loss: 0.0185930 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924479  Vali macro F1 0.9919770 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.274333953857422
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0040877  Vali Loss: 0.0181071 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.018471 --> 0.018107).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.26040244102478
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0045853  Vali Loss: 0.0205861 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.28563666343689
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0043747  Vali Loss: 0.0191931 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937037  Vali macro F1 0.9932293 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.262999534606934
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0035685  Vali Loss: 0.0198740 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937037  Vali macro F1 0.9932293 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.27867865562439
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0058658  Vali Loss: 0.0193789 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937037  Vali macro F1 0.9932293 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.268523216247559
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0043755  Vali Loss: 0.0185532 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924592  Vali macro F1 0.9919002 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 22 cost time: 6.280079364776611
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0047663  Vali Loss: 0.0168658 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949514  Vali macro F1 0.9945648 
new best score!!!!
Validation loss decreased (0.018107 --> 0.016866).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.275413274765015
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0056335  Vali Loss: 0.0201474 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911772  Vali macro F1 0.9907430 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.263885021209717
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0037316  Vali Loss: 0.0195052 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912034  Vali macro F1 0.9906479 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 7.295842885971069
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0034142  Vali Loss: 0.0196792 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912034  Vali macro F1 0.9906479 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.262932777404785
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0034420  Vali Loss: 0.0202656 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937316  Vali macro F1 0.9933758 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.283526182174683
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0030686  Vali Loss: 0.0200027 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937316  Vali macro F1 0.9933758 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 6.265054941177368
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0026594  Vali Loss: 0.0198445 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.281102657318115
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0031687  Vali Loss: 0.0197743 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.269222736358643
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0026827  Vali Loss: 0.0196989 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.262819051742554
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0033237  Vali Loss: 0.0196661 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.280255079269409
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0027796  Vali Loss: 0.0197659 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 6.262568712234497
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0029405  Vali Loss: 0.0197717 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.282074689865112
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0028941  Vali Loss: 0.0197637 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.263964891433716
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0029715  Vali Loss: 0.0197827 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.280162334442139
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0029525  Vali Loss: 0.0197772 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.268350124359131
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0044451  Vali Loss: 0.0197839 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8403509  Test weighted F1: 0.8207618  Test macro F1 0.8207618 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.773541450500488
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.4994504  Vali Loss: 1.2298587 Vali Accuracy: 0.8370927  Vali weighted F1: 0.8246833  Vali macro F1 0.8213675 
Validation loss decreased (inf --> 1.229859).  Saving model ...
Epoch: 2 cost time: 4.675903558731079
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8109736  Vali Loss: 0.4325288 Vali Accuracy: 0.9385965  Vali weighted F1: 0.9348956  Vali macro F1 0.9343066 
new best score!!!!
Validation loss decreased (1.229859 --> 0.432529).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.691109657287598
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3507046  Vali Loss: 0.2334729 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9601237  Vali macro F1 0.9585522 
new best score!!!!
Validation loss decreased (0.432529 --> 0.233473).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.680795907974243
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2056668  Vali Loss: 0.1534944 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9674034  Vali macro F1 0.9665685 
new best score!!!!
Validation loss decreased (0.233473 --> 0.153494).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.67414665222168
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1434425  Vali Loss: 0.1057226 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808929  Vali macro F1 0.9797750 
new best score!!!!
Validation loss decreased (0.153494 --> 0.105723).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.694436311721802
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1031257  Vali Loss: 0.0759308 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873093  Vali macro F1 0.9866618 
new best score!!!!
Validation loss decreased (0.105723 --> 0.075931).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.672230958938599
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0769254  Vali Loss: 0.0658163 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860312  Vali macro F1 0.9852404 
new best score!!!!
Validation loss decreased (0.075931 --> 0.065816).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.694498777389526
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0609983  Vali Loss: 0.0609381 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847471  Vali macro F1 0.9837726 
new best score!!!!
Validation loss decreased (0.065816 --> 0.060938).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.678667068481445
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0507684  Vali Loss: 0.0475536 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873669  Vali macro F1 0.9867418 
new best score!!!!
Validation loss decreased (0.060938 --> 0.047554).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.69316291809082
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0418320  Vali Loss: 0.0374387 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9921106 
new best score!!!!
Validation loss decreased (0.047554 --> 0.037439).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.68328332901001
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0490625  Vali Loss: 0.0427416 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898963  Vali macro F1 0.9896860 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.679369211196899
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0347130  Vali Loss: 0.0379813 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899119  Vali macro F1 0.9894419 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.693350076675415
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0327867  Vali Loss: 0.0302597 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
new best score!!!!
Validation loss decreased (0.037439 --> 0.030260).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.679108142852783
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0287157  Vali Loss: 0.0325999 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.694042444229126
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0273926  Vali Loss: 0.0369748 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898822  Vali macro F1 0.9893608 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 4.676144599914551
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0298166  Vali Loss: 0.0279499 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898467  Vali macro F1 0.9893658 
new best score!!!!
Validation loss decreased (0.030260 --> 0.027950).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.69389271736145
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0215191  Vali Loss: 0.0278076 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911256  Vali macro F1 0.9908539 
new best score!!!!
Validation loss decreased (0.027950 --> 0.027808).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.685814380645752
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0293308  Vali Loss: 0.0281506 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923869  Vali macro F1 0.9921934 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.676922798156738
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0208776  Vali Loss: 0.0313163 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9919421 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 4.694549322128296
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0232944  Vali Loss: 0.0319262 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846946  Vali macro F1 0.9839857 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 4.675811529159546
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0175178  Vali Loss: 0.0260497 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924592  Vali macro F1 0.9919002 
new best score!!!!
Validation loss decreased (0.027808 --> 0.026050).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.696521520614624
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0157757  Vali Loss: 0.0285830 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.6786863803863525
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0188642  Vali Loss: 0.0196721 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
new best score!!!!
Validation loss decreased (0.026050 --> 0.019672).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.694178104400635
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0179169  Vali Loss: 0.0177502 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911518  Vali macro F1 0.9907387 
new best score!!!!
Validation loss decreased (0.019672 --> 0.017750).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.68609881401062
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0126189  Vali Loss: 0.0219577 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.675287961959839
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0169865  Vali Loss: 0.0244334 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911282  Vali macro F1 0.9906303 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.6938087940216064
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0125961  Vali Loss: 0.0234241 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937464  Vali macro F1 0.9933207 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 4.674127817153931
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0158989  Vali Loss: 0.0227129 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911620  Vali macro F1 0.9906115 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 4.696328639984131
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0193407  Vali Loss: 0.0260280 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949955  Vali macro F1 0.9946488 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 4.677434682846069
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0151766  Vali Loss: 0.0211246 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.694787502288818
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0100093  Vali Loss: 0.0196249 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 4.686038970947266
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0091433  Vali Loss: 0.0188161 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 4.675430059432983
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0080438  Vali Loss: 0.0186252 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 4.692995548248291
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0077285  Vali Loss: 0.0186201 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 4.674968481063843
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0075559  Vali Loss: 0.0186299 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.6933534145355225
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0073025  Vali Loss: 0.0186022 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.680750370025635
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0074994  Vali Loss: 0.0185568 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.695984363555908
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0071992  Vali Loss: 0.0185557 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.6836302280426025
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0074166  Vali Loss: 0.0185349 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9403509  Test weighted F1: 0.9237925  Test macro F1 0.9237925 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.293560028076172
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0123577  Vali Loss: 0.0156781 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
Validation loss decreased (inf --> 0.015678).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.269596576690674
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0098320  Vali Loss: 0.0161340 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937464  Vali macro F1 0.9933207 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.289363861083984
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0092184  Vali Loss: 0.0188079 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911797  Vali macro F1 0.9905728 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.279204845428467
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0078800  Vali Loss: 0.0201624 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911271  Vali macro F1 0.9907243 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.271925926208496
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0104333  Vali Loss: 0.0213141 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.289420127868652
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0086881  Vali Loss: 0.0170130 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.270026445388794
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0066430  Vali Loss: 0.0172329 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.285887241363525
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0078773  Vali Loss: 0.0186879 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.272198915481567
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0060653  Vali Loss: 0.0167657 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.291489601135254
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0056604  Vali Loss: 0.0172398 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.274035692214966
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0058731  Vali Loss: 0.0179123 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.267091274261475
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0054791  Vali Loss: 0.0181353 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.287888526916504
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0061713  Vali Loss: 0.0186578 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.270747661590576
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0056297  Vali Loss: 0.0187378 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.29659104347229
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0058687  Vali Loss: 0.0188212 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.275075435638428
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0055585  Vali Loss: 0.0188134 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9254386  Test weighted F1: 0.9082641  Test macro F1 0.9082641 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.805929899215698
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5261606  Vali Loss: 1.2604039 Vali Accuracy: 0.8270677  Vali weighted F1: 0.8164097  Vali macro F1 0.8087290 
Validation loss decreased (inf --> 1.260404).  Saving model ...
Epoch: 2 cost time: 4.675944566726685
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8241804  Vali Loss: 0.4426848 Vali Accuracy: 0.9436090  Vali weighted F1: 0.9371631  Vali macro F1 0.9352874 
new best score!!!!
Validation loss decreased (1.260404 --> 0.442685).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.695770025253296
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3427549  Vali Loss: 0.2180760 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9793795  Vali macro F1 0.9784248 
new best score!!!!
Validation loss decreased (0.442685 --> 0.218076).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.682717323303223
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1957053  Vali Loss: 0.1360918 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9832497  Vali macro F1 0.9824667 
new best score!!!!
Validation loss decreased (0.218076 --> 0.136092).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.694237947463989
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1248659  Vali Loss: 0.0903192 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911166  Vali macro F1 0.9907479 
new best score!!!!
Validation loss decreased (0.136092 --> 0.090319).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.686672210693359
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0910969  Vali Loss: 0.0703755 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923850  Vali macro F1 0.9919918 
new best score!!!!
Validation loss decreased (0.090319 --> 0.070376).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.677497625350952
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0701169  Vali Loss: 0.0532236 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911885  Vali macro F1 0.9906899 
new best score!!!!
Validation loss decreased (0.070376 --> 0.053224).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.695577383041382
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0577012  Vali Loss: 0.0431343 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949450  Vali macro F1 0.9950198 
new best score!!!!
Validation loss decreased (0.053224 --> 0.043134).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.68159031867981
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0515318  Vali Loss: 0.0427453 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923816  Vali macro F1 0.9922907 
new best score!!!!
Validation loss decreased (0.043134 --> 0.042745).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.700689792633057
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0420113  Vali Loss: 0.0409653 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910978  Vali macro F1 0.9909285 
new best score!!!!
Validation loss decreased (0.042745 --> 0.040965).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.690160512924194
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0401033  Vali Loss: 0.0404485 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898841  Vali macro F1 0.9895349 
new best score!!!!
Validation loss decreased (0.040965 --> 0.040448).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.703166246414185
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0404511  Vali Loss: 0.0369950 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925570  Vali macro F1 0.9925034 
new best score!!!!
Validation loss decreased (0.040448 --> 0.036995).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.694459915161133
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0298164  Vali Loss: 0.0229202 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949617  Vali macro F1 0.9950393 
new best score!!!!
Validation loss decreased (0.036995 --> 0.022920).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.687443971633911
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0255350  Vali Loss: 0.0334986 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910978  Vali macro F1 0.9909285 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.70698356628418
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0231804  Vali Loss: 0.0211388 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950118  Vali macro F1 0.9948627 
new best score!!!!
Validation loss decreased (0.022920 --> 0.021139).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.688982963562012
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0218232  Vali Loss: 0.0216596 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.88533091545105
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0230713  Vali Loss: 0.0281238 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898121  Vali macro F1 0.9894775 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.696765184402466
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0433311  Vali Loss: 0.0271793 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912194  Vali macro F1 0.9910287 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 4.709584951400757
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0277262  Vali Loss: 0.0189220 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924260  Vali macro F1 0.9923247 
new best score!!!!
Validation loss decreased (0.021139 --> 0.018922).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.7025465965271
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0528448  Vali Loss: 0.0293958 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924643  Vali macro F1 0.9922571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.694578409194946
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0243367  Vali Loss: 0.0250183 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924297  Vali macro F1 0.9923468 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 4.7129552364349365
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0202073  Vali Loss: 0.0174710 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949450  Vali macro F1 0.9950198 
new best score!!!!
Validation loss decreased (0.018922 --> 0.017471).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.693204879760742
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0140463  Vali Loss: 0.0174490 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936636  Vali macro F1 0.9936540 
new best score!!!!
Validation loss decreased (0.017471 --> 0.017449).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.7108314037323
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0125329  Vali Loss: 0.0201577 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923816  Vali macro F1 0.9922907 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 4.692573308944702
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0143499  Vali Loss: 0.0175618 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 4.705584287643433
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0109179  Vali Loss: 0.0120177 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
new best score!!!!
Validation loss decreased (0.017449 --> 0.012018).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.693741083145142
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0093378  Vali Loss: 0.0180364 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937256  Vali macro F1 0.9934990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.683045864105225
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0081664  Vali Loss: 0.0148164 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949329  Vali macro F1 0.9945877 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 4.701628923416138
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0087757  Vali Loss: 0.0139673 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 4.68493390083313
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0150711  Vali Loss: 0.0138612 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937242  Vali macro F1 0.9936150 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 4.700859785079956
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0104676  Vali Loss: 0.0171334 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924270  Vali macro F1 0.9922306 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 4.68594765663147
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0096086  Vali Loss: 0.0191231 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936636  Vali macro F1 0.9936540 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.701665639877319
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0082637  Vali Loss: 0.0177182 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936646  Vali macro F1 0.9935599 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.687425374984741
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0077953  Vali Loss: 0.0184957 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936646  Vali macro F1 0.9935599 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.677529811859131
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0072518  Vali Loss: 0.0185303 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936646  Vali macro F1 0.9935599 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 4.696063280105591
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0074290  Vali Loss: 0.0177708 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 4.678440093994141
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0069662  Vali Loss: 0.0177928 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 4.6938793659210205
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0069904  Vali Loss: 0.0175981 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 4.677897214889526
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0062521  Vali Loss: 0.0174444 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 4.6960930824279785
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0068340  Vali Loss: 0.0175336 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 4.685129642486572
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0066086  Vali Loss: 0.0176321 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9263158  Test weighted F1: 0.9203280  Test macro F1 0.9203280 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.272970676422119
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0092170  Vali Loss: 0.0167499 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
Validation loss decreased (inf --> 0.016750).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.261969327926636
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0083219  Vali Loss: 0.0166269 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
new best score!!!!
Validation loss decreased (0.016750 --> 0.016627).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.270457983016968
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0095878  Vali Loss: 0.0173037 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937256  Vali macro F1 0.9934990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.261674165725708
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0079772  Vali Loss: 0.0131935 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
new best score!!!!
Validation loss decreased (0.016627 --> 0.013194).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.254694223403931
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0066910  Vali Loss: 0.0136950 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.269551038742065
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0066159  Vali Loss: 0.0125597 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
new best score!!!!
Validation loss decreased (0.013194 --> 0.012560).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.254581689834595
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0057487  Vali Loss: 0.0129199 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.269004583358765
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0054175  Vali Loss: 0.0126797 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.257368087768555
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0052867  Vali Loss: 0.0133436 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.274364471435547
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0056042  Vali Loss: 0.0130318 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.263797760009766
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0058134  Vali Loss: 0.0161433 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936159  Vali macro F1 0.9933012 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.251155614852905
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0051210  Vali Loss: 0.0135175 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.27214503288269
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0049751  Vali Loss: 0.0143748 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937256  Vali macro F1 0.9934990 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.255017518997192
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0061853  Vali Loss: 0.0118606 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
new best score!!!!
Validation loss decreased (0.012560 --> 0.011861).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.269257307052612
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0048371  Vali Loss: 0.0125549 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.258971929550171
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0044070  Vali Loss: 0.0131740 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.270170450210571
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0043266  Vali Loss: 0.0131174 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.265372037887573
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0045800  Vali Loss: 0.0122886 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.254645109176636
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0039828  Vali Loss: 0.0118349 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
new best score!!!!
Validation loss decreased (0.011861 --> 0.011835).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.273898124694824
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0040294  Vali Loss: 0.0131209 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.255873680114746
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0039920  Vali Loss: 0.0123747 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.275743722915649
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0059625  Vali Loss: 0.0122227 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.259437799453735
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0038508  Vali Loss: 0.0128226 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.273382186889648
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0033007  Vali Loss: 0.0125232 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.2623748779296875
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0031680  Vali Loss: 0.0125813 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.254788875579834
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0031556  Vali Loss: 0.0125962 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.27315616607666
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0036181  Vali Loss: 0.0124888 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.255285263061523
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0034293  Vali Loss: 0.0125421 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.273798942565918
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0032366  Vali Loss: 0.0125698 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 6.261141300201416
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0037212  Vali Loss: 0.0125605 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.27812385559082
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0034968  Vali Loss: 0.0125270 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.263146877288818
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0032956  Vali Loss: 0.0125148 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.258744478225708
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0034442  Vali Loss: 0.0125213 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.273116588592529
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0034931  Vali Loss: 0.0125194 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9359649  Test weighted F1: 0.9326401  Test macro F1 0.9326401 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.819637298583984
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5190795  Vali Loss: 1.2278654 Vali Accuracy: 0.8320802  Vali weighted F1: 0.8202922  Vali macro F1 0.8183802 
Validation loss decreased (inf --> 1.227865).  Saving model ...
Epoch: 2 cost time: 4.69036340713501
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8274246  Vali Loss: 0.4534593 Vali Accuracy: 0.9172932  Vali weighted F1: 0.9169394  Vali macro F1 0.9146173 
new best score!!!!
Validation loss decreased (1.227865 --> 0.453459).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.683419704437256
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3680429  Vali Loss: 0.2360716 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9704741  Vali macro F1 0.9689336 
new best score!!!!
Validation loss decreased (0.453459 --> 0.236072).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.701623201370239
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2211475  Vali Loss: 0.1442896 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809321  Vali macro F1 0.9797671 
new best score!!!!
Validation loss decreased (0.236072 --> 0.144290).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.683268785476685
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1446016  Vali Loss: 0.0962502 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859648  Vali macro F1 0.9849484 
new best score!!!!
Validation loss decreased (0.144290 --> 0.096250).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.700212001800537
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1033527  Vali Loss: 0.0770909 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911702  Vali macro F1 0.9908001 
new best score!!!!
Validation loss decreased (0.096250 --> 0.077091).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.682065486907959
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0814272  Vali Loss: 0.0582980 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898734  Vali macro F1 0.9892893 
new best score!!!!
Validation loss decreased (0.077091 --> 0.058298).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.698286056518555
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0601502  Vali Loss: 0.0498114 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911797  Vali macro F1 0.9905330 
new best score!!!!
Validation loss decreased (0.058298 --> 0.049811).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.691437005996704
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0516371  Vali Loss: 0.0460395 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899491  Vali macro F1 0.9891737 
new best score!!!!
Validation loss decreased (0.049811 --> 0.046040).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.6794962882995605
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0401306  Vali Loss: 0.0364518 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
new best score!!!!
Validation loss decreased (0.046040 --> 0.036452).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.6961376667022705
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0386706  Vali Loss: 0.0377198 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911271  Vali macro F1 0.9907243 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.681270599365234
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0338083  Vali Loss: 0.0320770 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.036452 --> 0.032077).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.697821140289307
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0280560  Vali Loss: 0.0306828 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911887  Vali macro F1 0.9905687 
new best score!!!!
Validation loss decreased (0.032077 --> 0.030683).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.68148398399353
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0237947  Vali Loss: 0.0278271 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937033  Vali macro F1 0.9934549 
new best score!!!!
Validation loss decreased (0.030683 --> 0.027827).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.700463056564331
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0338408  Vali Loss: 0.0286393 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.691406488418579
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0267347  Vali Loss: 0.0269535 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
new best score!!!!
Validation loss decreased (0.027827 --> 0.026953).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.680838346481323
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0233967  Vali Loss: 0.0315852 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898467  Vali macro F1 0.9893658 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.695008039474487
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0330127  Vali Loss: 0.0303738 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 4.680166959762573
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0175471  Vali Loss: 0.0271206 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924515  Vali macro F1 0.9919131 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 4.698780536651611
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0209826  Vali Loss: 0.0232835 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.026953 --> 0.023284).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.681445837020874
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0141896  Vali Loss: 0.0278071 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898927  Vali macro F1 0.9893670 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.699286460876465
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0158359  Vali Loss: 0.0244711 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911888  Vali macro F1 0.9905545 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.686991214752197
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0117815  Vali Loss: 0.0258570 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911888  Vali macro F1 0.9905545 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 4.677404403686523
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0131172  Vali Loss: 0.0238694 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924856  Vali macro F1 0.9919529 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 4.697142124176025
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0102621  Vali Loss: 0.0224595 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937182  Vali macro F1 0.9932397 
new best score!!!!
Validation loss decreased (0.023284 --> 0.022459).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.678725957870483
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0099633  Vali Loss: 0.0252900 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924231  Vali macro F1 0.9918425 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 4.701713800430298
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0113006  Vali Loss: 0.0287837 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937562  Vali macro F1 0.9935051 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 4.681217432022095
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0134162  Vali Loss: 0.0245246 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911876  Vali macro F1 0.9906627 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 4.6987409591674805
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0113669  Vali Loss: 0.0220911 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924490  Vali macro F1 0.9918830 
new best score!!!!
Validation loss decreased (0.022459 --> 0.022091).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.689568042755127
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0162603  Vali Loss: 0.0286278 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911556  Vali macro F1 0.9904257 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.679850339889526
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0110871  Vali Loss: 0.0212016 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.022091 --> 0.021202).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.69752836227417
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0123043  Vali Loss: 0.0225047 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.6832115650177
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0088964  Vali Loss: 0.0232600 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.699944019317627
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0077875  Vali Loss: 0.0223163 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.684870958328247
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0084432  Vali Loss: 0.0183502 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.021202 --> 0.018350).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.6981894969940186
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0076248  Vali Loss: 0.0193371 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949810  Vali macro F1 0.9946150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 4.69191837310791
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0061323  Vali Loss: 0.0223369 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937073  Vali macro F1 0.9932467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 4.6773223876953125
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0069078  Vali Loss: 0.0199894 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 4.699237823486328
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0069089  Vali Loss: 0.0192147 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 4.677103042602539
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0059181  Vali Loss: 0.0214084 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 4.698287010192871
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0059850  Vali Loss: 0.0197418 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 4.678604602813721
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0062129  Vali Loss: 0.0184137 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 4.698558807373047
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0046841  Vali Loss: 0.0159022 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
new best score!!!!
Validation loss decreased (0.018350 --> 0.015902).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 4.687340974807739
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0043319  Vali Loss: 0.0171427 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 4.6791603565216064
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0040904  Vali Loss: 0.0178209 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 4.698121547698975
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0042441  Vali Loss: 0.0161224 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 4.678354978561401
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0042022  Vali Loss: 0.0183931 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 4.698934555053711
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0038945  Vali Loss: 0.0193543 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 4.682411432266235
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0042219  Vali Loss: 0.0193423 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 4.696672677993774
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0038858  Vali Loss: 0.0191780 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 4.686229705810547
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0035307  Vali Loss: 0.0192127 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 4.675853729248047
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0040452  Vali Loss: 0.0193265 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 4.698292016983032
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0037286  Vali Loss: 0.0194797 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 4.679558992385864
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0037710  Vali Loss: 0.0194786 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 4.700610876083374
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0035949  Vali Loss: 0.0194847 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 4.682635068893433
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0037803  Vali Loss: 0.0194866 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 4.701521873474121
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0037422  Vali Loss: 0.0194887 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 4.690949440002441
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0038752  Vali Loss: 0.0194925 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8570175  Test weighted F1: 0.8372939  Test macro F1 0.8372939 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.422901630401611
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0047113  Vali Loss: 0.0175452 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9959538 
Validation loss decreased (inf --> 0.017545).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3370912075042725
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0049692  Vali Loss: 0.0202846 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.350305795669556
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0037635  Vali Loss: 0.0195352 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.343461990356445
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0038382  Vali Loss: 0.0205386 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.330214500427246
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0038168  Vali Loss: 0.0236005 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.349973917007446
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0034904  Vali Loss: 0.0222812 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9932612 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.330866098403931
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0037635  Vali Loss: 0.0208318 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9932612 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.353361129760742
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0035302  Vali Loss: 0.0177475 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949777  Vali macro F1 0.9948241 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.3364012241363525
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031135  Vali Loss: 0.0196046 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.352871417999268
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0025453  Vali Loss: 0.0204787 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.338573217391968
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0053535  Vali Loss: 0.0203752 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.333517789840698
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0028670  Vali Loss: 0.0205710 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.350428104400635
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0029355  Vali Loss: 0.0201602 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.328430891036987
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0026148  Vali Loss: 0.0199865 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.351145505905151
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0024795  Vali Loss: 0.0206447 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.339151620864868
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0025882  Vali Loss: 0.0206481 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8412281  Test weighted F1: 0.8153177  Test macro F1 0.8153177 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.807102203369141
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5399175  Vali Loss: 1.3471252 Vali Accuracy: 0.7819549  Vali weighted F1: 0.7628269  Vali macro F1 0.7630858 
Validation loss decreased (inf --> 1.347125).  Saving model ...
Epoch: 2 cost time: 4.675126552581787
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.9052610  Vali Loss: 0.4955791 Vali Accuracy: 0.9348371  Vali weighted F1: 0.9332553  Vali macro F1 0.9322711 
new best score!!!!
Validation loss decreased (1.347125 --> 0.495579).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.689224004745483
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3901132  Vali Loss: 0.2450184 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9650457  Vali macro F1 0.9643962 
new best score!!!!
Validation loss decreased (0.495579 --> 0.245018).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.676703214645386
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2150482  Vali Loss: 0.1476551 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9705213  Vali macro F1 0.9692487 
new best score!!!!
Validation loss decreased (0.245018 --> 0.147655).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.690941572189331
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1421833  Vali Loss: 0.1059504 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846933  Vali macro F1 0.9839808 
new best score!!!!
Validation loss decreased (0.147655 --> 0.105950).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.681128978729248
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0985621  Vali Loss: 0.0831358 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862116  Vali macro F1 0.9859213 
new best score!!!!
Validation loss decreased (0.105950 --> 0.083136).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.672199010848999
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0750688  Vali Loss: 0.0577795 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886182  Vali macro F1 0.9878188 
new best score!!!!
Validation loss decreased (0.083136 --> 0.057779).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.689656019210815
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0581106  Vali Loss: 0.0474591 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912253  Vali macro F1 0.9906898 
new best score!!!!
Validation loss decreased (0.057779 --> 0.047459).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.672221660614014
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0475304  Vali Loss: 0.0395012 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
new best score!!!!
Validation loss decreased (0.047459 --> 0.039501).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.691120147705078
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0430192  Vali Loss: 0.0497701 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860795  Vali macro F1 0.9851944 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.675318002700806
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0448367  Vali Loss: 0.0573538 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887677  Vali macro F1 0.9879996 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 4.6904919147491455
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0429003  Vali Loss: 0.0358988 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924715  Vali macro F1 0.9919225 
new best score!!!!
Validation loss decreased (0.039501 --> 0.035899).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.686577558517456
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0270159  Vali Loss: 0.0283715 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925021  Vali macro F1 0.9922018 
new best score!!!!
Validation loss decreased (0.035899 --> 0.028371).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.673001766204834
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0282745  Vali Loss: 0.0260701 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962610  Vali macro F1 0.9961172 
new best score!!!!
Validation loss decreased (0.028371 --> 0.026070).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.69025182723999
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0276680  Vali Loss: 0.0257974 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925621  Vali macro F1 0.9922596 
new best score!!!!
Validation loss decreased (0.026070 --> 0.025797).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.674294948577881
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0219823  Vali Loss: 0.0226317 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962379  Vali macro F1 0.9960617 
new best score!!!!
Validation loss decreased (0.025797 --> 0.022632).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.690263748168945
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0208082  Vali Loss: 0.0276955 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937269  Vali macro F1 0.9935126 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.681026935577393
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0190243  Vali Loss: 0.0295583 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911834  Vali macro F1 0.9910716 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 4.692373752593994
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0219808  Vali Loss: 0.0249431 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949698  Vali macro F1 0.9948232 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 4.68381142616272
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0148938  Vali Loss: 0.0208599 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.022632 --> 0.020860).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.673507213592529
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0125473  Vali Loss: 0.0184933 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937580  Vali macro F1 0.9935099 
new best score!!!!
Validation loss decreased (0.020860 --> 0.018493).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.692440986633301
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0121219  Vali Loss: 0.0180341 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949916  Vali macro F1 0.9947247 
new best score!!!!
Validation loss decreased (0.018493 --> 0.018034).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.672010660171509
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0152127  Vali Loss: 0.0192959 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949713  Vali macro F1 0.9945983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 4.693156003952026
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0170126  Vali Loss: 0.0169591 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962550  Vali macro F1 0.9961182 
new best score!!!!
Validation loss decreased (0.018034 --> 0.016959).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.6796875
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0119575  Vali Loss: 0.0209145 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.697372198104858
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0136129  Vali Loss: 0.0173597 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949955  Vali macro F1 0.9946488 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.686187982559204
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0152623  Vali Loss: 0.0175195 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948784 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 4.676945924758911
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0104520  Vali Loss: 0.0199526 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924905  Vali macro F1 0.9920684 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 4.69724178314209
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0113443  Vali Loss: 0.0149931 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
new best score!!!!
Validation loss decreased (0.016959 --> 0.014993).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.673694372177124
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0110654  Vali Loss: 0.0193616 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923802  Vali macro F1 0.9920720 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.691875696182251
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0096181  Vali Loss: 0.0107038 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.014993 --> 0.010704).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.67475152015686
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0071993  Vali Loss: 0.0128282 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.690860033035278
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0077041  Vali Loss: 0.0126302 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962305  Vali macro F1 0.9960478 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 7.435833215713501
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0059978  Vali Loss: 0.0110135 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.66770601272583
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0058928  Vali Loss: 0.0153861 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 4.685179948806763
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0077442  Vali Loss: 0.0160305 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962379  Vali macro F1 0.9960617 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 4.665493726730347
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0058185  Vali Loss: 0.0134165 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950049  Vali macro F1 0.9948507 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 4.686370372772217
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0055917  Vali Loss: 0.0118638 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974894  Vali macro F1 0.9974015 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 4.668733358383179
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0053602  Vali Loss: 0.0116272 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974894  Vali macro F1 0.9974015 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 4.682356595993042
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0049825  Vali Loss: 0.0118719 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 4.676957607269287
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0047353  Vali Loss: 0.0118883 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 4.665825605392456
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0059318  Vali Loss: 0.0117718 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 4.687029838562012
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0047256  Vali Loss: 0.0117583 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 4.668448448181152
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0045177  Vali Loss: 0.0117137 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 4.6892595291137695
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0052240  Vali Loss: 0.0115911 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 4.673003196716309
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0045673  Vali Loss: 0.0116084 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8938596  Test weighted F1: 0.8572907  Test macro F1 0.8572907 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.399476528167725
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0072818  Vali Loss: 0.0116463 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
Validation loss decreased (inf --> 0.011646).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.292418003082275
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0062629  Vali Loss: 0.0117534 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974894  Vali macro F1 0.9974015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.303566932678223
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0056966  Vali Loss: 0.0118011 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962305  Vali macro F1 0.9960478 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.293829441070557
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0058229  Vali Loss: 0.0119412 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962305  Vali macro F1 0.9960478 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.303779125213623
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0054202  Vali Loss: 0.0112569 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974894  Vali macro F1 0.9974015 
new best score!!!!
Validation loss decreased (0.011646 --> 0.011257).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.296227693557739
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0058387  Vali Loss: 0.0106156 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.011257 --> 0.010616).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.288954973220825
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0046345  Vali Loss: 0.0108258 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974926  Vali macro F1 0.9973990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.320322036743164
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0052984  Vali Loss: 0.0099828 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.010616 --> 0.009983).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.294213533401489
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0044449  Vali Loss: 0.0097484 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.009983 --> 0.009748).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.316171884536743
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0043968  Vali Loss: 0.0095443 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.009748 --> 0.009544).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.291728734970093
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0044225  Vali Loss: 0.0095554 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.300065517425537
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0036405  Vali Loss: 0.0096135 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.297616243362427
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0040363  Vali Loss: 0.0094720 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.009544 --> 0.009472).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.2921366691589355
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0039203  Vali Loss: 0.0088510 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.009472 --> 0.008851).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.316951036453247
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0037992  Vali Loss: 0.0094519 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.293664455413818
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0038056  Vali Loss: 0.0087126 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.008851 --> 0.008713).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.309804677963257
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0036277  Vali Loss: 0.0101848 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.292104959487915
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0033183  Vali Loss: 0.0101811 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.314770221710205
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0031834  Vali Loss: 0.0103090 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.294477701187134
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0032276  Vali Loss: 0.0102980 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.291874408721924
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0033608  Vali Loss: 0.0100695 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 22 cost time: 6.313310861587524
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0034261  Vali Loss: 0.0106887 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962608  Vali macro F1 0.9961029 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.289525747299194
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0068092  Vali Loss: 0.0092162 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.300772190093994
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0047797  Vali Loss: 0.0110644 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.291946649551392
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0040093  Vali Loss: 0.0099186 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.307514190673828
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0043087  Vali Loss: 0.0107918 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.30008602142334
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0032629  Vali Loss: 0.0109065 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.29115891456604
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0031600  Vali Loss: 0.0109391 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.295949220657349
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0037127  Vali Loss: 0.0106919 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.293073892593384
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0031206  Vali Loss: 0.0103609 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.3147242069244385
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0028872  Vali Loss: 0.0104141 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8508772  Test weighted F1: 0.8143469  Test macro F1 0.8143469 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.751215696334839
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5169093  Vali Loss: 1.2624388 Vali Accuracy: 0.8182957  Vali weighted F1: 0.8119775  Vali macro F1 0.8115504 
Validation loss decreased (inf --> 1.262439).  Saving model ...
Epoch: 2 cost time: 4.688558101654053
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8087159  Vali Loss: 0.4637982 Vali Accuracy: 0.9448622  Vali weighted F1: 0.9418866  Vali macro F1 0.9424480 
new best score!!!!
Validation loss decreased (1.262439 --> 0.463798).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.669320344924927
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3453305  Vali Loss: 0.2273184 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9744520  Vali macro F1 0.9733472 
new best score!!!!
Validation loss decreased (0.463798 --> 0.227318).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.690937280654907
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1986628  Vali Loss: 0.1433924 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875742  Vali macro F1 0.9869616 
new best score!!!!
Validation loss decreased (0.227318 --> 0.143392).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.6754491329193115
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1298601  Vali Loss: 0.0909226 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912389  Vali macro F1 0.9908519 
new best score!!!!
Validation loss decreased (0.143392 --> 0.090923).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.691180944442749
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0921069  Vali Loss: 0.0698499 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899683  Vali macro F1 0.9894034 
new best score!!!!
Validation loss decreased (0.090923 --> 0.069850).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.681518793106079
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0728100  Vali Loss: 0.0508860 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925179  Vali macro F1 0.9922020 
new best score!!!!
Validation loss decreased (0.069850 --> 0.050886).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.672335147857666
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0592277  Vali Loss: 0.0492204 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924905  Vali macro F1 0.9920623 
new best score!!!!
Validation loss decreased (0.050886 --> 0.049220).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.690226078033447
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0637581  Vali Loss: 0.0414639 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885928  Vali macro F1 0.9880946 
new best score!!!!
Validation loss decreased (0.049220 --> 0.041464).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.6699559688568115
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0488888  Vali Loss: 0.0368538 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936963  Vali macro F1 0.9936922 
new best score!!!!
Validation loss decreased (0.041464 --> 0.036854).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.690352201461792
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0362142  Vali Loss: 0.0314211 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923650  Vali macro F1 0.9918601 
new best score!!!!
Validation loss decreased (0.036854 --> 0.031421).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.671812295913696
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0369716  Vali Loss: 0.0313267 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950155  Vali macro F1 0.9949845 
new best score!!!!
Validation loss decreased (0.031421 --> 0.031327).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.690940856933594
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0275979  Vali Loss: 0.0214710 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.031327 --> 0.021471).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.683082818984985
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0239161  Vali Loss: 0.0162777 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.021471 --> 0.016278).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.6723291873931885
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0214401  Vali Loss: 0.0170907 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9973886 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.689834833145142
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0212397  Vali Loss: 0.0161746 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
new best score!!!!
Validation loss decreased (0.016278 --> 0.016175).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.674734830856323
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0220438  Vali Loss: 0.0455069 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910251  Vali macro F1 0.9910626 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.691803693771362
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0633744  Vali Loss: 0.0321099 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 4.672192811965942
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0344431  Vali Loss: 0.0223015 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949971  Vali macro F1 0.9946625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 4.690701246261597
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0245368  Vali Loss: 0.0173889 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 4.680628299713135
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0184756  Vali Loss: 0.0158950 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
new best score!!!!
Validation loss decreased (0.016175 --> 0.015895).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.6728880405426025
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0166226  Vali Loss: 0.0148266 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
new best score!!!!
Validation loss decreased (0.015895 --> 0.014827).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.691232204437256
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0145256  Vali Loss: 0.0153225 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 4.671221494674683
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0102673  Vali Loss: 0.0159562 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 4.690383434295654
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0118355  Vali Loss: 0.0145115 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.014827 --> 0.014511).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.671229839324951
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0105254  Vali Loss: 0.0177903 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 4.688371181488037
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0146354  Vali Loss: 0.0175873 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 4.677920341491699
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0122887  Vali Loss: 0.0100787 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.014511 --> 0.010079).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.669877290725708
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0108118  Vali Loss: 0.0169151 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937621  Vali macro F1 0.9935145 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 4.68684196472168
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0167836  Vali Loss: 0.0106841 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 4.669377088546753
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0103059  Vali Loss: 0.0108803 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 4.691775560379028
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0148619  Vali Loss: 0.0192338 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949971  Vali macro F1 0.9946625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 4.674040794372559
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0099623  Vali Loss: 0.0121280 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 4.689467191696167
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0066616  Vali Loss: 0.0127623 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 4.6774561405181885
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0064561  Vali Loss: 0.0132404 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 4.670684099197388
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0059799  Vali Loss: 0.0160451 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 4.690461874008179
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0057136  Vali Loss: 0.0141459 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 4.670503854751587
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0055997  Vali Loss: 0.0134453 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 4.6888344287872314
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0060781  Vali Loss: 0.0135921 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 4.67293643951416
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0058256  Vali Loss: 0.0146414 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 4.688058853149414
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0054536  Vali Loss: 0.0149509 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 4.682931184768677
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0060149  Vali Loss: 0.0151480 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 4.67244029045105
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0057904  Vali Loss: 0.0153391 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9324561  Test weighted F1: 0.9301190  Test macro F1 0.9301190 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.304596900939941
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0085763  Vali Loss: 0.0119973 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
Validation loss decreased (inf --> 0.011997).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.315192699432373
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0069271  Vali Loss: 0.0126852 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.3021559715271
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0062783  Vali Loss: 0.0127071 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.296616077423096
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0056503  Vali Loss: 0.0144039 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.303870677947998
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0056265  Vali Loss: 0.0128303 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.2954559326171875
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0057839  Vali Loss: 0.0132840 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.315282344818115
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0052018  Vali Loss: 0.0110883 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.011997 --> 0.011088).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.297791481018066
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0053981  Vali Loss: 0.0168778 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.302872896194458
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0059404  Vali Loss: 0.0142726 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.300554037094116
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0046735  Vali Loss: 0.0133362 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.294262647628784
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0045701  Vali Loss: 0.0125073 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.30986762046814
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0045101  Vali Loss: 0.0139681 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.2926154136657715
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0039695  Vali Loss: 0.0138823 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.318629026412964
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0037919  Vali Loss: 0.0140926 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.29569411277771
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0039974  Vali Loss: 0.0140954 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.296429634094238
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0037718  Vali Loss: 0.0139433 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.300395727157593
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0039905  Vali Loss: 0.0138175 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 18 cost time: 6.291162490844727
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0039833  Vali Loss: 0.0138236 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.316963195800781
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0041020  Vali Loss: 0.0138388 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.296945095062256
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0104762  Vali Loss: 0.0138293 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.306561231613159
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0036496  Vali Loss: 0.0138196 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.2984678745269775
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0035867  Vali Loss: 0.0138327 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9333333  Test weighted F1: 0.9308188  Test macro F1 0.9308188 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.776850938796997
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5113652  Vali Loss: 1.2606110 Vali Accuracy: 0.8621554  Vali weighted F1: 0.8533062  Vali macro F1 0.8511587 
Validation loss decreased (inf --> 1.260611).  Saving model ...
Epoch: 2 cost time: 4.6702656745910645
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8391197  Vali Loss: 0.4668612 Vali Accuracy: 0.9461153  Vali weighted F1: 0.9446454  Vali macro F1 0.9429337 
new best score!!!!
Validation loss decreased (1.260611 --> 0.466861).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.689817905426025
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3645327  Vali Loss: 0.2327821 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9706973  Vali macro F1 0.9695402 
new best score!!!!
Validation loss decreased (0.466861 --> 0.232782).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.670473575592041
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2016002  Vali Loss: 0.1422555 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9766477  Vali macro F1 0.9754991 
new best score!!!!
Validation loss decreased (0.232782 --> 0.142255).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.687142610549927
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1478295  Vali Loss: 0.0956130 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847758  Vali macro F1 0.9839588 
new best score!!!!
Validation loss decreased (0.142255 --> 0.095613).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.675826549530029
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0935196  Vali Loss: 0.0724401 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847347  Vali macro F1 0.9836431 
new best score!!!!
Validation loss decreased (0.095613 --> 0.072440).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.66737961769104
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0702049  Vali Loss: 0.0607419 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886119  Vali macro F1 0.9877075 
new best score!!!!
Validation loss decreased (0.072440 --> 0.060742).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.688525915145874
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0535022  Vali Loss: 0.0461754 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898503  Vali macro F1 0.9890671 
new best score!!!!
Validation loss decreased (0.060742 --> 0.046175).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.670494318008423
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0445959  Vali Loss: 0.0462066 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873978  Vali macro F1 0.9864875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 4.6897876262664795
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0387784  Vali Loss: 0.0442100 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9890510 
new best score!!!!
Validation loss decreased (0.046175 --> 0.044210).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.672105073928833
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0394563  Vali Loss: 0.0410622 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898924  Vali macro F1 0.9892312 
new best score!!!!
Validation loss decreased (0.044210 --> 0.041062).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.690211057662964
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0336464  Vali Loss: 0.0287668 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.041062 --> 0.028767).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.680222034454346
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0312479  Vali Loss: 0.0281819 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.028767 --> 0.028182).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.670156002044678
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0217820  Vali Loss: 0.0296643 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911470  Vali macro F1 0.9907272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.760076284408569
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0268682  Vali Loss: 0.0421354 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822946  Vali macro F1 0.9813310 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 4.668932199478149
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0306589  Vali Loss: 0.0297655 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911307  Vali macro F1 0.9904256 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 4.6862452030181885
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0260896  Vali Loss: 0.0270433 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937085  Vali macro F1 0.9933064 
new best score!!!!
Validation loss decreased (0.028182 --> 0.027043).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.668290138244629
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0327772  Vali Loss: 0.0314780 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911483  Vali macro F1 0.9905806 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.685937404632568
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0195134  Vali Loss: 0.0226140 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949674  Vali macro F1 0.9947276 
new best score!!!!
Validation loss decreased (0.027043 --> 0.022614).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.675008535385132
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0209014  Vali Loss: 0.0317611 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846143  Vali macro F1 0.9838788 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.6680591106414795
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0141430  Vali Loss: 0.0171872 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937011  Vali macro F1 0.9932262 
new best score!!!!
Validation loss decreased (0.022614 --> 0.017187).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.687670707702637
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0160439  Vali Loss: 0.0241274 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886599  Vali macro F1 0.9880414 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.666870832443237
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0128121  Vali Loss: 0.0164470 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.017187 --> 0.016447).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.685760259628296
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0087355  Vali Loss: 0.0149684 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
new best score!!!!
Validation loss decreased (0.016447 --> 0.014968).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.670530319213867
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0091653  Vali Loss: 0.0187623 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936857  Vali macro F1 0.9934482 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.686415433883667
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0149085  Vali Loss: 0.0181401 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.677942276000977
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0220353  Vali Loss: 0.0185678 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924317  Vali macro F1 0.9919192 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 4.669419288635254
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0125643  Vali Loss: 0.0178935 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 4.685424566268921
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0100980  Vali Loss: 0.0171050 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 4.666232585906982
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0083493  Vali Loss: 0.0166742 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.686272859573364
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0082168  Vali Loss: 0.0170068 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 4.671368837356567
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0073661  Vali Loss: 0.0172803 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 4.685017347335815
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0066700  Vali Loss: 0.0164413 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 4.676698684692383
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0067495  Vali Loss: 0.0159934 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 4.666751861572266
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0059779  Vali Loss: 0.0159028 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.686037302017212
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0063589  Vali Loss: 0.0157845 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.665278673171997
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0061378  Vali Loss: 0.0157979 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.68789267539978
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0066724  Vali Loss: 0.0157852 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.670027017593384
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0073236  Vali Loss: 0.0157925 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9157895  Test weighted F1: 0.8955222  Test macro F1 0.8955222 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.27181339263916
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0084419  Vali Loss: 0.0139394 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
Validation loss decreased (inf --> 0.013939).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.249922275543213
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0069272  Vali Loss: 0.0143686 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.270227432250977
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0074390  Vali Loss: 0.0140541 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.253697872161865
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0064642  Vali Loss: 0.0142079 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.269119024276733
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0056182  Vali Loss: 0.0123111 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.013939 --> 0.012311).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.25851845741272
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0054103  Vali Loss: 0.0153093 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.250088214874268
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0053251  Vali Loss: 0.0145705 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.264967203140259
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0049701  Vali Loss: 0.0114568 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.012311 --> 0.011457).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.250443935394287
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0053912  Vali Loss: 0.0119853 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.262294769287109
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0045568  Vali Loss: 0.0165032 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.248842239379883
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0042857  Vali Loss: 0.0142840 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.264450311660767
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0041530  Vali Loss: 0.0148563 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.256933927536011
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0045543  Vali Loss: 0.0143956 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 6.2495222091674805
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0037430  Vali Loss: 0.0146456 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.268549919128418
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0054931  Vali Loss: 0.0171141 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937596  Vali macro F1 0.9934289 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.247032165527344
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0047034  Vali Loss: 0.0128136 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.267283916473389
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0036772  Vali Loss: 0.0122699 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950100  Vali macro F1 0.9947780 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.251857042312622
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0051370  Vali Loss: 0.0143268 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.265228986740112
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0037443  Vali Loss: 0.0130582 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.2581541538238525
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0039316  Vali Loss: 0.0122106 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.2514331340789795
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0034347  Vali Loss: 0.0120572 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.270896673202515
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0039516  Vali Loss: 0.0121119 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.247864723205566
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0044018  Vali Loss: 0.0114538 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.011457 --> 0.011454).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.269310235977173
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0034318  Vali Loss: 0.0121584 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 8.23961091041565
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0038133  Vali Loss: 0.0126402 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.267829895019531
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0040972  Vali Loss: 0.0125543 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.2675864696502686
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0034052  Vali Loss: 0.0123958 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.249734878540039
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0035254  Vali Loss: 0.0124146 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 6.267270088195801
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0032127  Vali Loss: 0.0124309 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.247925519943237
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0074840  Vali Loss: 0.0123626 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.2708985805511475
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0034768  Vali Loss: 0.0124467 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.254578351974487
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0037385  Vali Loss: 0.0124422 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.270591497421265
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0033535  Vali Loss: 0.0124262 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 34 cost time: 6.260253667831421
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0032897  Vali Loss: 0.0124253 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 6.2489094734191895
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0033488  Vali Loss: 0.0124268 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 6.274087190628052
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0041653  Vali Loss: 0.0124251 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 6.25380802154541
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0034730  Vali Loss: 0.0124250 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 6.269289970397949
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0031408  Vali Loss: 0.0124259 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9254386  Test weighted F1: 0.9061937  Test macro F1 0.9061937 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.782972097396851
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5186539  Vali Loss: 1.2540782 Vali Accuracy: 0.8446115  Vali weighted F1: 0.8347861  Vali macro F1 0.8331512 
Validation loss decreased (inf --> 1.254078).  Saving model ...
Epoch: 2 cost time: 4.700692892074585
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8213316  Vali Loss: 0.4463172 Vali Accuracy: 0.9385965  Vali weighted F1: 0.9345214  Vali macro F1 0.9344395 
new best score!!!!
Validation loss decreased (1.254078 --> 0.446317).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.68412971496582
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3448272  Vali Loss: 0.2261866 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9655336  Vali macro F1 0.9650442 
new best score!!!!
Validation loss decreased (0.446317 --> 0.226187).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.701794624328613
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2000792  Vali Loss: 0.1361275 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9770141  Vali macro F1 0.9763151 
new best score!!!!
Validation loss decreased (0.226187 --> 0.136128).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.686485528945923
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1259235  Vali Loss: 0.0923415 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9871508  Vali macro F1 0.9865342 
new best score!!!!
Validation loss decreased (0.136128 --> 0.092341).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.69975209236145
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0875449  Vali Loss: 0.0718374 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848599  Vali macro F1 0.9839597 
new best score!!!!
Validation loss decreased (0.092341 --> 0.071837).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.689890146255493
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0665384  Vali Loss: 0.0530012 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949435  Vali macro F1 0.9947110 
new best score!!!!
Validation loss decreased (0.071837 --> 0.053001).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.685281991958618
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0589291  Vali Loss: 0.0539436 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898824  Vali macro F1 0.9893394 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 4.699464797973633
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0522132  Vali Loss: 0.0387630 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
new best score!!!!
Validation loss decreased (0.053001 --> 0.038763).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.679823160171509
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0371555  Vali Loss: 0.0350925 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910984  Vali macro F1 0.9906221 
new best score!!!!
Validation loss decreased (0.038763 --> 0.035092).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.6984944343566895
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0357026  Vali Loss: 0.0341168 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911271  Vali macro F1 0.9907243 
new best score!!!!
Validation loss decreased (0.035092 --> 0.034117).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.683912992477417
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0296876  Vali Loss: 0.0269931 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923802  Vali macro F1 0.9920720 
new best score!!!!
Validation loss decreased (0.034117 --> 0.026993).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.699206829071045
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0280178  Vali Loss: 0.0226943 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936615  Vali macro F1 0.9934345 
new best score!!!!
Validation loss decreased (0.026993 --> 0.022694).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.691614866256714
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0217486  Vali Loss: 0.0249059 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.682260990142822
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0191472  Vali Loss: 0.0194309 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962243  Vali macro F1 0.9961692 
new best score!!!!
Validation loss decreased (0.022694 --> 0.019431).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.700057029724121
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0164287  Vali Loss: 0.0169474 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.019431 --> 0.016947).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.681964159011841
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0162068  Vali Loss: 0.0257763 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936949  Vali macro F1 0.9934735 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.699838638305664
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0217527  Vali Loss: 0.0175240 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 4.686187505722046
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0255683  Vali Loss: 0.0174262 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 4.700774908065796
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0138053  Vali Loss: 0.0210460 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949465  Vali macro F1 0.9948164 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 4.687859535217285
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0189639  Vali Loss: 0.0268878 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897290  Vali macro F1 0.9896672 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 4.678131580352783
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0196472  Vali Loss: 0.0155766 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962246  Vali macro F1 0.9961694 
new best score!!!!
Validation loss decreased (0.016947 --> 0.015577).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.696376800537109
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0145831  Vali Loss: 0.0115246 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.015577 --> 0.011525).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.682422637939453
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0127822  Vali Loss: 0.0103056 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.011525 --> 0.010306).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.6988465785980225
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0110124  Vali Loss: 0.0095694 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.010306 --> 0.009569).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.682134628295898
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0099836  Vali Loss: 0.0089951 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.009569 --> 0.008995).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.70011830329895
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0089873  Vali Loss: 0.0085668 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.008995 --> 0.008567).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.690906763076782
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0088338  Vali Loss: 0.0095161 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.68257737159729
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0085624  Vali Loss: 0.0080178 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.008567 --> 0.008018).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.702684640884399
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0085221  Vali Loss: 0.0085344 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.6813225746154785
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0084724  Vali Loss: 0.0075109 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.008018 --> 0.007511).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.699751377105713
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0084410  Vali Loss: 0.0080696 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.684749126434326
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0074886  Vali Loss: 0.0071057 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.007511 --> 0.007106).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 4.698288202285767
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0071168  Vali Loss: 0.0068671 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.007106 --> 0.006867).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.688840389251709
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0073406  Vali Loss: 0.0081388 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.679077386856079
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0071402  Vali Loss: 0.0079948 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.695188999176025
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0067463  Vali Loss: 0.0076839 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.6745805740356445
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0069491  Vali Loss: 0.0075355 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.695096731185913
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0070735  Vali Loss: 0.0070178 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 4.681218147277832
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0066733  Vali Loss: 0.0069581 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.700646162033081
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0066321  Vali Loss: 0.0073523 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.68884801864624
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0064826  Vali Loss: 0.0074369 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.677016496658325
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0065325  Vali Loss: 0.0072641 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 4.696133136749268
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0064650  Vali Loss: 0.0074241 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 4.675839185714722
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0064527  Vali Loss: 0.0074317 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.696835517883301
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0065498  Vali Loss: 0.0074418 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.680233001708984
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0069163  Vali Loss: 0.0074230 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.6964335441589355
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0063658  Vali Loss: 0.0074171 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.685786724090576
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0068001  Vali Loss: 0.0074070 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7798246  Test weighted F1: 0.7490203  Test macro F1 0.7490203 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.271517515182495
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0076088  Vali Loss: 0.0079640 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
Validation loss decreased (inf --> 0.007964).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.253017425537109
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0067916  Vali Loss: 0.0065951 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.007964 --> 0.006595).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.270291090011597
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0056161  Vali Loss: 0.0081892 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.302075624465942
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0055100  Vali Loss: 0.0092853 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.255329847335815
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0052309  Vali Loss: 0.0073300 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.27205753326416
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0044448  Vali Loss: 0.0079638 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.251486301422119
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0045313  Vali Loss: 0.0056413 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
new best score!!!!
Validation loss decreased (0.006595 --> 0.005641).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.269739866256714
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0044878  Vali Loss: 0.0097469 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.253922939300537
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0039155  Vali Loss: 0.0062019 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.269119024276733
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0040663  Vali Loss: 0.0051010 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.005641 --> 0.005101).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.263168811798096
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0032748  Vali Loss: 0.0068257 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.25366473197937
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0030901  Vali Loss: 0.0076317 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.268524408340454
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0034754  Vali Loss: 0.0072888 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.255271673202515
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0026682  Vali Loss: 0.0056108 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.266568660736084
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0026402  Vali Loss: 0.0052844 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 6.254742622375488
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0021907  Vali Loss: 0.0048134 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
new best score!!!!
Validation loss decreased (0.005101 --> 0.004813).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.27005672454834
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022065  Vali Loss: 0.0080809 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.257404804229736
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0020868  Vali Loss: 0.0046709 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.004813 --> 0.004671).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.254132986068726
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0020012  Vali Loss: 0.0063976 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.272653579711914
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0022803  Vali Loss: 0.0113797 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949137  Vali macro F1 0.9947782 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.251075744628906
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0026917  Vali Loss: 0.0050034 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.271749258041382
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024292  Vali Loss: 0.0081388 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9961959  Vali macro F1 0.9961447 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.251932144165039
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0048925  Vali Loss: 0.0059750 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.266934394836426
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0024250  Vali Loss: 0.0057165 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.258798122406006
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0023370  Vali Loss: 0.0059990 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.247685432434082
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0022762  Vali Loss: 0.0062088 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.268716812133789
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0018423  Vali Loss: 0.0064391 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.251260757446289
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0019248  Vali Loss: 0.0065013 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 6.2704548835754395
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0018887  Vali Loss: 0.0065251 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.2494957447052
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0018382  Vali Loss: 0.0065536 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.270254373550415
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0018855  Vali Loss: 0.0065594 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.258960247039795
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0018163  Vali Loss: 0.0065503 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.2526185512542725
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0018232  Vali Loss: 0.0065355 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7842105  Test weighted F1: 0.7546737  Test macro F1 0.7546737 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 408860
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.728622198104858
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5413094  Vali Loss: 1.3231544 Vali Accuracy: 0.8082707  Vali weighted F1: 0.8023193  Vali macro F1 0.8003952 
Validation loss decreased (inf --> 1.323154).  Saving model ...
Epoch: 2 cost time: 4.677498817443848
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8777980  Vali Loss: 0.5060929 Vali Accuracy: 0.9260652  Vali weighted F1: 0.9251442  Vali macro F1 0.9232577 
new best score!!!!
Validation loss decreased (1.323154 --> 0.506093).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.669403076171875
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3773197  Vali Loss: 0.2445127 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9659904  Vali macro F1 0.9649720 
new best score!!!!
Validation loss decreased (0.506093 --> 0.244513).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.660700798034668
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2142653  Vali Loss: 0.1580956 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837165  Vali macro F1 0.9841226 
new best score!!!!
Validation loss decreased (0.244513 --> 0.158096).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.68204402923584
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1412662  Vali Loss: 0.1082122 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874802  Vali macro F1 0.9874064 
new best score!!!!
Validation loss decreased (0.158096 --> 0.108212).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.6585304737091064
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0970077  Vali Loss: 0.0770349 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911976  Vali macro F1 0.9918323 
new best score!!!!
Validation loss decreased (0.108212 --> 0.077035).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.682187795639038
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0809847  Vali Loss: 0.0618872 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937334  Vali macro F1 0.9944068 
new best score!!!!
Validation loss decreased (0.077035 --> 0.061887).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.665935277938843
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0597497  Vali Loss: 0.0582506 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849493  Vali macro F1 0.9858124 
new best score!!!!
Validation loss decreased (0.061887 --> 0.058251).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.682007551193237
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0556089  Vali Loss: 0.0412511 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937019  Vali macro F1 0.9942239 
new best score!!!!
Validation loss decreased (0.058251 --> 0.041251).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.673138380050659
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0440876  Vali Loss: 0.0405536 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937140  Vali macro F1 0.9941699 
new best score!!!!
Validation loss decreased (0.041251 --> 0.040554).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.666325092315674
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0392033  Vali Loss: 0.0417265 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887484  Vali macro F1 0.9892601 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.686885833740234
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0551820  Vali Loss: 0.0496088 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9834439  Vali macro F1 0.9843039 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.6656999588012695
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0348590  Vali Loss: 0.0279818 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949691  Vali macro F1 0.9954930 
new best score!!!!
Validation loss decreased (0.040554 --> 0.027982).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.687042474746704
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0274711  Vali Loss: 0.0267442 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949695  Vali macro F1 0.9955574 
new best score!!!!
Validation loss decreased (0.027982 --> 0.026744).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.668933868408203
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0261536  Vali Loss: 0.0537119 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847724  Vali macro F1 0.9851363 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.684640884399414
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0383619  Vali Loss: 0.0273810 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 4.6772847175598145
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0294007  Vali Loss: 0.0213933 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
new best score!!!!
Validation loss decreased (0.026744 --> 0.021393).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.667030096054077
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0276552  Vali Loss: 0.0256609 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924581  Vali macro F1 0.9930574 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.684088706970215
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0239132  Vali Loss: 0.0220948 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949745  Vali macro F1 0.9953950 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 4.668451309204102
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0223004  Vali Loss: 0.0243454 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949771  Vali macro F1 0.9955581 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 4.688916444778442
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0166877  Vali Loss: 0.0154096 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
new best score!!!!
Validation loss decreased (0.021393 --> 0.015410).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.678306341171265
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0191751  Vali Loss: 0.0240233 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912213  Vali macro F1 0.9919335 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.691183567047119
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0198843  Vali Loss: 0.0200027 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.68640923500061
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0135715  Vali Loss: 0.0133688 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.015410 --> 0.013369).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.669920921325684
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0126120  Vali Loss: 0.0165194 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949873  Vali macro F1 0.9954633 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.687963485717773
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0138365  Vali Loss: 0.0132107 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.013369 --> 0.013211).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.670612335205078
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0121529  Vali Loss: 0.0126757 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.013211 --> 0.012676).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.690333366394043
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0158985  Vali Loss: 0.0154250 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.673697233200073
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0121539  Vali Loss: 0.0160436 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949689  Vali macro F1 0.9956132 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.691918849945068
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0131856  Vali Loss: 0.0118294 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974847  Vali macro F1 0.9978863 
new best score!!!!
Validation loss decreased (0.012676 --> 0.011829).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.681175231933594
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0142600  Vali Loss: 0.0096188 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.011829 --> 0.009619).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.672179698944092
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0094576  Vali Loss: 0.0101478 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.691851854324341
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0082431  Vali Loss: 0.0148189 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.675588369369507
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0092586  Vali Loss: 0.0091814 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.009619 --> 0.009181).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.692486524581909
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0089524  Vali Loss: 0.0146849 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.682998180389404
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0101911  Vali Loss: 0.0096083 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.694737434387207
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0089724  Vali Loss: 0.0099126 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.684617042541504
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0087409  Vali Loss: 0.0124866 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974972  Vali macro F1 0.9974623 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.673852443695068
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0087112  Vali Loss: 0.0062151 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.009181 --> 0.006215).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.69372296333313
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0132025  Vali Loss: 0.1504821 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9498975  Vali macro F1 0.9526680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.672643184661865
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0495766  Vali Loss: 0.0263530 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962441  Vali macro F1 0.9966832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.691887140274048
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0200004  Vali Loss: 0.0171285 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.674499750137329
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0138253  Vali Loss: 0.0138631 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 4.6896278858184814
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0110711  Vali Loss: 0.0178978 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 45 cost time: 4.681656122207642
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0091729  Vali Loss: 0.0145100 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.674265146255493
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0076615  Vali Loss: 0.0130933 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.69635796546936
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0076500  Vali Loss: 0.0123785 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.6740899085998535
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0066175  Vali Loss: 0.0123237 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.692954778671265
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0062762  Vali Loss: 0.0119370 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 4.677231073379517
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0060630  Vali Loss: 0.0118993 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 4.6928369998931885
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0063831  Vali Loss: 0.0118785 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 4.6805031299591064
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0060074  Vali Loss: 0.0118413 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 4.6739585399627686
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0065362  Vali Loss: 0.0118050 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 4.692861080169678
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0061841  Vali Loss: 0.0117653 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8833333  Test weighted F1: 0.8687370  Test macro F1 0.8687370 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.326213836669922
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0065297  Vali Loss: 0.0076380 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
Validation loss decreased (inf --> 0.007638).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.312951326370239
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0044388  Vali Loss: 0.0071315 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.007638 --> 0.007131).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.300187826156616
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0041061  Vali Loss: 0.0065182 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.007131 --> 0.006518).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.310279607772827
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0039692  Vali Loss: 0.0069069 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.297828197479248
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0052578  Vali Loss: 0.0065547 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.3199076652526855
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0053333  Vali Loss: 0.0062270 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.006518 --> 0.006227).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.298297882080078
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0041825  Vali Loss: 0.0063511 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.309664726257324
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0034959  Vali Loss: 0.0060877 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.006227 --> 0.006088).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.30837082862854
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0035694  Vali Loss: 0.0060686 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.006088 --> 0.006069).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.297113418579102
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0031641  Vali Loss: 0.0062961 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.314896821975708
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0029096  Vali Loss: 0.0055132 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.006069 --> 0.005513).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.306474924087524
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0028684  Vali Loss: 0.0052976 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.005513 --> 0.005298).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.324331760406494
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0025573  Vali Loss: 0.0053529 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.301874876022339
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0026325  Vali Loss: 0.0053589 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.311730623245239
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0026053  Vali Loss: 0.0052285 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.005298 --> 0.005228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.308912515640259
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0026440  Vali Loss: 0.0057023 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.297089099884033
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0025313  Vali Loss: 0.0052754 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.318583011627197
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0024064  Vali Loss: 0.0053903 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.301119089126587
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0027158  Vali Loss: 0.0046832 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.005228 --> 0.004683).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.3202338218688965
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0037033  Vali Loss: 0.0057619 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.311391592025757
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0036540  Vali Loss: 0.0051240 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.325295925140381
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0030791  Vali Loss: 0.0053529 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.312132120132446
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0045882  Vali Loss: 0.0063933 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.28992223739624
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0027627  Vali Loss: 0.0058811 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 25 cost time: 6.312915325164795
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0021288  Vali Loss: 0.0055439 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.286312818527222
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0022035  Vali Loss: 0.0054631 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.312640190124512
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0021779  Vali Loss: 0.0054958 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.290080547332764
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0021037  Vali Loss: 0.0055951 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.3109495639801025
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0023551  Vali Loss: 0.0053004 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 30 cost time: 6.29560661315918
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0020353  Vali Loss: 0.0052699 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.289355754852295
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0020578  Vali Loss: 0.0053229 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.316317558288574
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0021282  Vali Loss: 0.0053274 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.292127847671509
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0017908  Vali Loss: 0.0053547 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.321367025375366
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0024608  Vali Loss: 0.0054385 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8710526  Test weighted F1: 0.8567401  Test macro F1 0.8567401 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.7850182056427
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5618618  Vali Loss: 1.3765710 Vali Accuracy: 0.7932331  Vali weighted F1: 0.7818726  Vali macro F1 0.7872749 
Validation loss decreased (inf --> 1.376571).  Saving model ...
Epoch: 2 cost time: 4.683945417404175
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8757508  Vali Loss: 0.5068956 Vali Accuracy: 0.9348371  Vali weighted F1: 0.9347653  Vali macro F1 0.9326959 
new best score!!!!
Validation loss decreased (1.376571 --> 0.506896).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.683460712432861
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3655123  Vali Loss: 0.2441490 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9629070  Vali macro F1 0.9615846 
new best score!!!!
Validation loss decreased (0.506896 --> 0.244149).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.702802896499634
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2024085  Vali Loss: 0.1552430 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9773551  Vali macro F1 0.9770490 
new best score!!!!
Validation loss decreased (0.244149 --> 0.155243).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.688728332519531
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1299147  Vali Loss: 0.1011633 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863823  Vali macro F1 0.9868197 
new best score!!!!
Validation loss decreased (0.155243 --> 0.101163).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.706981182098389
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0939893  Vali Loss: 0.0747548 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924858  Vali macro F1 0.9928851 
new best score!!!!
Validation loss decreased (0.101163 --> 0.074755).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.692509889602661
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0713313  Vali Loss: 0.0700605 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9852041  Vali macro F1 0.9856367 
new best score!!!!
Validation loss decreased (0.074755 --> 0.070060).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.684425115585327
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0614943  Vali Loss: 0.0420043 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949745  Vali macro F1 0.9953950 
new best score!!!!
Validation loss decreased (0.070060 --> 0.042004).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.70520806312561
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0495857  Vali Loss: 0.0358914 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962398  Vali macro F1 0.9960922 
new best score!!!!
Validation loss decreased (0.042004 --> 0.035891).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.686800479888916
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0388490  Vali Loss: 0.0370589 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962409  Vali macro F1 0.9959935 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.704324960708618
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0488921  Vali Loss: 0.0284619 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.035891 --> 0.028462).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.688276767730713
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0441809  Vali Loss: 0.0295604 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 4.706394195556641
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0344610  Vali Loss: 0.0251705 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962378  Vali macro F1 0.9964561 
new best score!!!!
Validation loss decreased (0.028462 --> 0.025170).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.697022438049316
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0260980  Vali Loss: 0.0212094 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
new best score!!!!
Validation loss decreased (0.025170 --> 0.021209).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.68435263633728
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0250782  Vali Loss: 0.0411296 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9871078  Vali macro F1 0.9874217 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.705249071121216
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0256392  Vali Loss: 0.0198542 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9972037 
new best score!!!!
Validation loss decreased (0.021209 --> 0.019854).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.688899993896484
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0188746  Vali Loss: 0.0146139 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.019854 --> 0.014614).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.708704710006714
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0208561  Vali Loss: 0.0255117 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898382  Vali macro F1 0.9903841 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.6928627490997314
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0191449  Vali Loss: 0.0140553 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014614 --> 0.014055).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.705474853515625
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0151073  Vali Loss: 0.0132781 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974854  Vali macro F1 0.9978306 
new best score!!!!
Validation loss decreased (0.014055 --> 0.013278).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.696169376373291
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0141334  Vali Loss: 0.0161838 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950120  Vali macro F1 0.9946992 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.686915159225464
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0384068  Vali Loss: 0.0193898 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.707338809967041
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0193210  Vali Loss: 0.0191932 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 4.689680576324463
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0204331  Vali Loss: 0.0119244 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987474  Vali macro F1 0.9987745 
new best score!!!!
Validation loss decreased (0.013278 --> 0.011924).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.707612037658691
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0187007  Vali Loss: 0.0189184 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.69401741027832
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0182564  Vali Loss: 0.0094575 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.011924 --> 0.009457).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.707471132278442
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0159867  Vali Loss: 0.0131027 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.699268102645874
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0117146  Vali Loss: 0.0117211 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.556839942932129
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0141444  Vali Loss: 0.0106065 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 4.709679126739502
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0099914  Vali Loss: 0.0077583 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.009457 --> 0.007758).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.6904473304748535
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0137632  Vali Loss: 0.0124125 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 4.709162950515747
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0195786  Vali Loss: 0.0187185 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937389  Vali macro F1 0.9940514 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 4.69137167930603
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0144019  Vali Loss: 0.0111718 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 4.71071982383728
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0101223  Vali Loss: 0.0069414 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007758 --> 0.006941).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.70009446144104
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0109572  Vali Loss: 0.0077367 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.6926188468933105
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0088319  Vali Loss: 0.0076536 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.710585594177246
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0062850  Vali Loss: 0.0096685 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.696645498275757
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0064889  Vali Loss: 0.0080503 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975773 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.712221384048462
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0137974  Vali Loss: 0.0239134 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962411  Vali macro F1 0.9965201 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 4.6944804191589355
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0125547  Vali Loss: 0.0119092 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.7086181640625
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0089484  Vali Loss: 0.0091836 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.7020275592803955
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0076140  Vali Loss: 0.0096248 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.690975189208984
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0075540  Vali Loss: 0.0075212 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 4.709479808807373
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0067184  Vali Loss: 0.0073916 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 4.692067384719849
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0074135  Vali Loss: 0.0072976 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.7103986740112305
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0063010  Vali Loss: 0.0072014 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.692033767700195
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0064614  Vali Loss: 0.0071796 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.7104010581970215
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0062015  Vali Loss: 0.0071415 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.700274467468262
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0058004  Vali Loss: 0.0071128 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8535088  Test weighted F1: 0.8268382  Test macro F1 0.8268382 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.328293085098267
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0072916  Vali Loss: 0.0065541 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.006554).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.237228631973267
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0073896  Vali Loss: 0.0050451 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006554 --> 0.005045).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.254262208938599
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0068068  Vali Loss: 0.0050351 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005045 --> 0.005035).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.247007608413696
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0056353  Vali Loss: 0.0050488 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.234987020492554
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0060094  Vali Loss: 0.0041130 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005035 --> 0.004113).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.257322549819946
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0052414  Vali Loss: 0.0040072 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004113 --> 0.004007).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.236371994018555
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0044150  Vali Loss: 0.0040810 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.255722522735596
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0050546  Vali Loss: 0.0039198 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004007 --> 0.003920).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.245831251144409
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0045296  Vali Loss: 0.0042103 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.253856897354126
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0044345  Vali Loss: 0.0042223 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.246572494506836
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0040803  Vali Loss: 0.0040768 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.23707914352417
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0041291  Vali Loss: 0.0074619 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975096  Vali macro F1 0.9975771 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.252540826797485
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0040437  Vali Loss: 0.0032663 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003920 --> 0.003266).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.236699342727661
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0036070  Vali Loss: 0.0040605 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.251666784286499
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0032557  Vali Loss: 0.0029731 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003266 --> 0.002973).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.239743709564209
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0034247  Vali Loss: 0.0025699 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002973 --> 0.002570).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.25652551651001
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0030379  Vali Loss: 0.0025774 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.248546600341797
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0035459  Vali Loss: 0.0047454 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987474  Vali macro F1 0.9987745 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.239006280899048
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0032476  Vali Loss: 0.0049146 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987474  Vali macro F1 0.9987745 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.254488945007324
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0030305  Vali Loss: 0.0040740 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987474  Vali macro F1 0.9987745 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.238934516906738
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0027342  Vali Loss: 0.0030379 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 22 cost time: 6.257445573806763
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0028020  Vali Loss: 0.0028168 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.238664865493774
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0032499  Vali Loss: 0.0042895 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.260345697402954
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0032696  Vali Loss: 0.0069129 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974934  Vali macro F1 0.9975590 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.253366231918335
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0034259  Vali Loss: 0.0053618 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.25054931640625
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0024235  Vali Loss: 0.0049258 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.262243270874023
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0024883  Vali Loss: 0.0047929 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.241300582885742
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0028346  Vali Loss: 0.0048388 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.263272047042847
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0028635  Vali Loss: 0.0050149 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.246793508529663
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0024963  Vali Loss: 0.0049423 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.262565851211548
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0025099  Vali Loss: 0.0047634 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8359649  Test weighted F1: 0.8094617  Test macro F1 0.8094617 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.755894422531128
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5457932  Vali Loss: 1.3563650 Vali Accuracy: 0.7869674  Vali weighted F1: 0.7828530  Vali macro F1 0.7839048 
Validation loss decreased (inf --> 1.356365).  Saving model ...
Epoch: 2 cost time: 4.704455614089966
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8938895  Vali Loss: 0.5004552 Vali Accuracy: 0.9448622  Vali weighted F1: 0.9437637  Vali macro F1 0.9424246 
new best score!!!!
Validation loss decreased (1.356365 --> 0.500455).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.701864719390869
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3824756  Vali Loss: 0.2569752 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9719146  Vali macro F1 0.9723313 
new best score!!!!
Validation loss decreased (0.500455 --> 0.256975).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.707414150238037
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2148680  Vali Loss: 0.1502925 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9773040  Vali macro F1 0.9776927 
new best score!!!!
Validation loss decreased (0.256975 --> 0.150292).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.699084997177124
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1333193  Vali Loss: 0.0986999 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836515  Vali macro F1 0.9841653 
new best score!!!!
Validation loss decreased (0.150292 --> 0.098700).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.689702272415161
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1048560  Vali Loss: 0.0805697 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821254  Vali macro F1 0.9829647 
new best score!!!!
Validation loss decreased (0.098700 --> 0.080570).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.71076512336731
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0866045  Vali Loss: 0.0669959 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9799572  Vali macro F1 0.9806350 
new best score!!!!
Validation loss decreased (0.080570 --> 0.066996).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.693514823913574
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0641734  Vali Loss: 0.0547343 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886563  Vali macro F1 0.9889364 
new best score!!!!
Validation loss decreased (0.066996 --> 0.054734).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.710028886795044
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0555271  Vali Loss: 0.0518698 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898769  Vali macro F1 0.9903138 
new best score!!!!
Validation loss decreased (0.054734 --> 0.051870).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.694318771362305
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0471031  Vali Loss: 0.0467691 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874016  Vali macro F1 0.9882703 
new best score!!!!
Validation loss decreased (0.051870 --> 0.046769).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.712202310562134
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0452277  Vali Loss: 0.0358524 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911861  Vali macro F1 0.9917600 
new best score!!!!
Validation loss decreased (0.046769 --> 0.035852).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.697904586791992
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0342158  Vali Loss: 0.0411047 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860228  Vali macro F1 0.9867118 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 4.690962553024292
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0297430  Vali Loss: 0.0333693 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899605  Vali macro F1 0.9900568 
new best score!!!!
Validation loss decreased (0.035852 --> 0.033369).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.7133471965789795
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0255169  Vali Loss: 0.0278146 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911861  Vali macro F1 0.9917600 
new best score!!!!
Validation loss decreased (0.033369 --> 0.027815).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.69192099571228
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0324592  Vali Loss: 0.0283733 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924405  Vali macro F1 0.9928169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.712464094161987
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0235704  Vali Loss: 0.0277388 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924571  Vali macro F1 0.9929985 
new best score!!!!
Validation loss decreased (0.027815 --> 0.027739).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.6921772956848145
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0180061  Vali Loss: 0.0251147 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924571  Vali macro F1 0.9929985 
new best score!!!!
Validation loss decreased (0.027739 --> 0.025115).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.707164764404297
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0172706  Vali Loss: 0.0239808 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924571  Vali macro F1 0.9929985 
new best score!!!!
Validation loss decreased (0.025115 --> 0.023981).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.696408748626709
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0167950  Vali Loss: 0.0205238 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924571  Vali macro F1 0.9929985 
new best score!!!!
Validation loss decreased (0.023981 --> 0.020524).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.684307336807251
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0171954  Vali Loss: 0.0246708 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899665  Vali macro F1 0.9904329 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.7026917934417725
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0154474  Vali Loss: 0.0219498 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 4.681959867477417
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0191379  Vali Loss: 0.0220418 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899506  Vali macro F1 0.9902782 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 4.700636386871338
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0158441  Vali Loss: 0.0187196 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924571  Vali macro F1 0.9929985 
new best score!!!!
Validation loss decreased (0.020524 --> 0.018720).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.686107158660889
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0133887  Vali Loss: 0.0221427 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912060  Vali macro F1 0.9912482 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 4.70060920715332
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0136247  Vali Loss: 0.0195946 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 4.692723274230957
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0147101  Vali Loss: 0.0192798 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 4.684085130691528
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0136468  Vali Loss: 0.0324408 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847065  Vali macro F1 0.9854207 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 4.7043328285217285
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0142846  Vali Loss: 0.0185779 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912065  Vali macro F1 0.9917751 
new best score!!!!
Validation loss decreased (0.018720 --> 0.018578).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.6859941482543945
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0125412  Vali Loss: 0.0183206 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924405  Vali macro F1 0.9928169 
new best score!!!!
Validation loss decreased (0.018578 --> 0.018321).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.702295303344727
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0095666  Vali Loss: 0.0183129 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924571  Vali macro F1 0.9929985 
new best score!!!!
Validation loss decreased (0.018321 --> 0.018313).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.686672687530518
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0077058  Vali Loss: 0.0161089 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924609  Vali macro F1 0.9928320 
new best score!!!!
Validation loss decreased (0.018313 --> 0.016109).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.701167106628418
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0072789  Vali Loss: 0.0188381 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924581  Vali macro F1 0.9928274 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.691959381103516
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0107866  Vali Loss: 0.0163287 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.68041467666626
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0088434  Vali Loss: 0.0161804 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.697697162628174
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0071095  Vali Loss: 0.0151877 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
new best score!!!!
Validation loss decreased (0.016109 --> 0.015188).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.679222106933594
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0062965  Vali Loss: 0.0176480 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 4.696676015853882
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0093745  Vali Loss: 0.0181706 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 4.681409120559692
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0072215  Vali Loss: 0.0149746 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.015188 --> 0.014975).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 4.702188968658447
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0057112  Vali Loss: 0.0110516 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.014975 --> 0.011052).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.6888251304626465
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0060726  Vali Loss: 0.0140633 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.680232286453247
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0066728  Vali Loss: 0.0196581 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924571  Vali macro F1 0.9929985 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.699936628341675
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0078539  Vali Loss: 0.0168170 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949828  Vali macro F1 0.9954549 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.681384563446045
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0067615  Vali Loss: 0.0141492 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937115  Vali macro F1 0.9940554 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 4.700565338134766
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0057171  Vali Loss: 0.0069529 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.011052 --> 0.006953).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 4.685275554656982
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0047494  Vali Loss: 0.0117210 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.700076580047607
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0059507  Vali Loss: 0.0168586 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924146  Vali macro F1 0.9926225 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.689022779464722
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0085824  Vali Loss: 0.0159380 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949771  Vali macro F1 0.9951150 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.679018020629883
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0053393  Vali Loss: 0.0099781 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962411  Vali macro F1 0.9965201 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.699886322021484
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0075786  Vali Loss: 0.0143554 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937115  Vali macro F1 0.9940554 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 50 cost time: 4.681745767593384
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0051749  Vali Loss: 0.0136589 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937115  Vali macro F1 0.9940554 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 4.6972386837005615
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0045538  Vali Loss: 0.0117524 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 4.681341648101807
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0044065  Vali Loss: 0.0105281 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 4.698987245559692
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0037154  Vali Loss: 0.0119573 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 4.703350782394409
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0038103  Vali Loss: 0.0119276 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 55 cost time: 4.6815345287323
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0034322  Vali Loss: 0.0118116 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 4.699244260787964
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0036216  Vali Loss: 0.0116729 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 4.680135726928711
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0037517  Vali Loss: 0.0115574 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 4.699854373931885
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0035355  Vali Loss: 0.0115486 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 4.684003829956055
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0033334  Vali Loss: 0.0114839 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9184211  Test weighted F1: 0.9108391  Test macro F1 0.9108391 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.370623826980591
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0045599  Vali Loss: 0.0129415 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
Validation loss decreased (inf --> 0.012941).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2798683643341064
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0042158  Vali Loss: 0.0124905 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.012941 --> 0.012490).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.299932241439819
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0036580  Vali Loss: 0.0106098 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.012490 --> 0.010610).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.280757427215576
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0034158  Vali Loss: 0.0107416 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962344  Vali macro F1 0.9965073 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.299729824066162
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0029051  Vali Loss: 0.0130089 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.285403490066528
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0029584  Vali Loss: 0.0056534 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962388  Vali macro F1 0.9965019 
new best score!!!!
Validation loss decreased (0.010610 --> 0.005653).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.278348684310913
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0026162  Vali Loss: 0.0094143 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.294046401977539
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0027034  Vali Loss: 0.0096322 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.280872583389282
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0022281  Vali Loss: 0.0092032 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.294800519943237
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0024775  Vali Loss: 0.0089240 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.279897212982178
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0023923  Vali Loss: 0.0087627 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.293128728866577
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0021491  Vali Loss: 0.0092728 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.283686876296997
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0025034  Vali Loss: 0.0127710 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949771  Vali macro F1 0.9951150 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.27135157585144
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0054323  Vali Loss: 0.0104022 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962370  Vali macro F1 0.9963395 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.290477991104126
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0074291  Vali Loss: 0.0103246 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.272543668746948
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0032113  Vali Loss: 0.0105245 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.294214487075806
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0024729  Vali Loss: 0.0104932 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.279347896575928
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0024983  Vali Loss: 0.0102807 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.29475998878479
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0023483  Vali Loss: 0.0101020 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.288580417633057
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0021366  Vali Loss: 0.0099668 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.269813776016235
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0021591  Vali Loss: 0.0099047 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8991228  Test weighted F1: 0.8922591  Test macro F1 0.8922591 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.7488298416137695
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5450270  Vali Loss: 1.3391235 Vali Accuracy: 0.8020050  Vali weighted F1: 0.7952414  Vali macro F1 0.7944059 
Validation loss decreased (inf --> 1.339123).  Saving model ...
Epoch: 2 cost time: 4.68820595741272
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8838544  Vali Loss: 0.5137050 Vali Accuracy: 0.9298246  Vali weighted F1: 0.9302268  Vali macro F1 0.9294382 
new best score!!!!
Validation loss decreased (1.339123 --> 0.513705).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.675197124481201
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3739643  Vali Loss: 0.2531500 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9682565  Vali macro F1 0.9683934 
new best score!!!!
Validation loss decreased (0.513705 --> 0.253150).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.6663007736206055
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2026921  Vali Loss: 0.1491635 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9761079  Vali macro F1 0.9768672 
new best score!!!!
Validation loss decreased (0.253150 --> 0.149164).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.687359571456909
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1341226  Vali Loss: 0.1254051 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836338  Vali macro F1 0.9828375 
new best score!!!!
Validation loss decreased (0.149164 --> 0.125405).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.668486833572388
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1005407  Vali Loss: 0.0933213 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837822  Vali macro F1 0.9847384 
new best score!!!!
Validation loss decreased (0.125405 --> 0.093321).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.692354679107666
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0747689  Vali Loss: 0.0740986 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810520  Vali macro F1 0.9824844 
new best score!!!!
Validation loss decreased (0.093321 --> 0.074099).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.673207759857178
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0565597  Vali Loss: 0.0509031 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899862  Vali macro F1 0.9909509 
new best score!!!!
Validation loss decreased (0.074099 --> 0.050903).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.6910200119018555
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0586196  Vali Loss: 0.0569081 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861272  Vali macro F1 0.9870201 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 4.679373502731323
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0445585  Vali Loss: 0.0525401 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862315  Vali macro F1 0.9872616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 4.6701977252960205
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0382489  Vali Loss: 0.0521785 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874337  Vali macro F1 0.9882675 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 12 cost time: 4.691898822784424
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0341774  Vali Loss: 0.0523480 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809674  Vali macro F1 0.9821615 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 13 cost time: 4.672064542770386
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0310044  Vali Loss: 0.0307029 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912022  Vali macro F1 0.9919034 
new best score!!!!
Validation loss decreased (0.050903 --> 0.030703).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.693840026855469
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0271181  Vali Loss: 0.0364188 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886678  Vali macro F1 0.9891929 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.677070140838623
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0250705  Vali Loss: 0.0366645 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899776  Vali macro F1 0.9911377 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 4.6954076290130615
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0240431  Vali Loss: 0.0296710 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912176  Vali macro F1 0.9921691 
new best score!!!!
Validation loss decreased (0.030703 --> 0.029671).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.687126874923706
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0208499  Vali Loss: 0.0376086 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912017  Vali macro F1 0.9918824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.676822900772095
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0564710  Vali Loss: 0.0363621 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949839  Vali macro F1 0.9953996 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 4.695947885513306
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0246634  Vali Loss: 0.0230370 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.029671 --> 0.023037).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.677793502807617
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0170762  Vali Loss: 0.0234862 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962341  Vali macro F1 0.9965166 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.699740886688232
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0152535  Vali Loss: 0.0313169 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9931203 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 4.682276964187622
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0169419  Vali Loss: 0.0221992 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986641 
new best score!!!!
Validation loss decreased (0.023037 --> 0.022199).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.699205636978149
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0180152  Vali Loss: 0.0138800 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.022199 --> 0.013880).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.689775466918945
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0120620  Vali Loss: 0.0115706 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013880 --> 0.011571).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.67798638343811
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0114660  Vali Loss: 0.0174433 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.6989452838897705
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0142111  Vali Loss: 0.0113742 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011571 --> 0.011374).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.6799845695495605
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0121624  Vali Loss: 0.0124805 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.698756694793701
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0111666  Vali Loss: 0.0140098 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 4.6843180656433105
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0096490  Vali Loss: 0.0102320 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
new best score!!!!
Validation loss decreased (0.011374 --> 0.010232).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.695766448974609
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0117497  Vali Loss: 0.0088383 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010232 --> 0.008838).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.690430641174316
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0092998  Vali Loss: 0.0156891 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 4.682632207870483
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0102662  Vali Loss: 0.0074328 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008838 --> 0.007433).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.7010979652404785
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0093803  Vali Loss: 0.0110323 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.6818883419036865
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0073534  Vali Loss: 0.0052825 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007433 --> 0.005283).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.7029054164886475
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0150272  Vali Loss: 0.0135539 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.687190294265747
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0106071  Vali Loss: 0.0217781 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924568  Vali macro F1 0.9932341 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.699851751327515
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0159895  Vali Loss: 0.0205533 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9967811 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.688159465789795
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0147962  Vali Loss: 0.0115072 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.678936243057251
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0082697  Vali Loss: 0.0100250 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 4.696805477142334
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0089264  Vali Loss: 0.0084495 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.680500030517578
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0078867  Vali Loss: 0.0071347 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.702124357223511
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0073518  Vali Loss: 0.0067558 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.688539743423462
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0077500  Vali Loss: 0.0066348 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 4.70179557800293
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0063377  Vali Loss: 0.0064094 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 4.688800096511841
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0062307  Vali Loss: 0.0063641 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.679610967636108
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0061388  Vali Loss: 0.0063542 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.698832273483276
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0071935  Vali Loss: 0.0063343 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.680986404418945
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0059321  Vali Loss: 0.0063451 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.702997922897339
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0060664  Vali Loss: 0.0063439 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8929825  Test weighted F1: 0.8755979  Test macro F1 0.8755979 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.344571352005005
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0064910  Vali Loss: 0.0056525 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
Validation loss decreased (inf --> 0.005653).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.276111841201782
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0152779  Vali Loss: 0.0097718 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974908  Vali macro F1 0.9976627 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.252511024475098
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0060345  Vali Loss: 0.0065756 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.272485971450806
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0050885  Vali Loss: 0.0074742 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.259375810623169
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0049987  Vali Loss: 0.0059809 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.274776220321655
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0044635  Vali Loss: 0.0064425 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.261243104934692
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0044290  Vali Loss: 0.0054198 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
new best score!!!!
Validation loss decreased (0.005653 --> 0.005420).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.253292798995972
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0042549  Vali Loss: 0.0061111 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974908  Vali macro F1 0.9976627 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.270091772079468
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0040950  Vali Loss: 0.0055176 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.255219221115112
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0037665  Vali Loss: 0.0057260 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.26739764213562
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0037898  Vali Loss: 0.0047422 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005420 --> 0.004742).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.258551120758057
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0039258  Vali Loss: 0.0053928 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.273839473724365
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0040245  Vali Loss: 0.0052308 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.26177191734314
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0035472  Vali Loss: 0.0042404 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
new best score!!!!
Validation loss decreased (0.004742 --> 0.004240).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.2506444454193115
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0034496  Vali Loss: 0.0043059 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.266908168792725
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0034174  Vali Loss: 0.0060040 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974872  Vali macro F1 0.9978805 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.252101182937622
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0032572  Vali Loss: 0.0062110 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.270372152328491
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0031210  Vali Loss: 0.0049070 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.258575677871704
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0032306  Vali Loss: 0.0043646 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.269867420196533
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0028107  Vali Loss: 0.0043370 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.259527683258057
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0033454  Vali Loss: 0.0042858 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.248762369155884
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0033638  Vali Loss: 0.0042378 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004240 --> 0.004238).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.269071340560913
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0029713  Vali Loss: 0.0042974 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.249182224273682
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0041142  Vali Loss: 0.0042195 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004238 --> 0.004219).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.271574020385742
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0030203  Vali Loss: 0.0042343 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.252174139022827
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0030424  Vali Loss: 0.0042672 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.264634132385254
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0030008  Vali Loss: 0.0042963 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.25569486618042
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0027946  Vali Loss: 0.0042797 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.254872560501099
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0034177  Vali Loss: 0.0042671 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 6.2678382396698
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0029143  Vali Loss: 0.0042695 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.2512242794036865
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0027137  Vali Loss: 0.0042744 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.268087148666382
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0030498  Vali Loss: 0.0042761 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.254005670547485
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0028588  Vali Loss: 0.0042724 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.268752813339233
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0029405  Vali Loss: 0.0042645 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 35 cost time: 6.256381273269653
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0030595  Vali Loss: 0.0042634 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 6.248267412185669
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0032027  Vali Loss: 0.0042628 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 6.263497591018677
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0028594  Vali Loss: 0.0042628 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 6.249408483505249
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0031343  Vali Loss: 0.0042624 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 6.273948431015015
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0032896  Vali Loss: 0.0042628 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8754386  Test weighted F1: 0.8505776  Test macro F1 0.8505776 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.734840154647827
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5577564  Vali Loss: 1.3815402 Vali Accuracy: 0.7807018  Vali weighted F1: 0.7751468  Vali macro F1 0.7748650 
Validation loss decreased (inf --> 1.381540).  Saving model ...
Epoch: 2 cost time: 4.677579641342163
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8973280  Vali Loss: 0.5064822 Vali Accuracy: 0.9411028  Vali weighted F1: 0.9407420  Vali macro F1 0.9383780 
new best score!!!!
Validation loss decreased (1.381540 --> 0.506482).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.656477689743042
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3745112  Vali Loss: 0.2573652 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9669151  Vali macro F1 0.9657981 
new best score!!!!
Validation loss decreased (0.506482 --> 0.257365).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.674416780471802
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2057914  Vali Loss: 0.1528731 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9800284  Vali macro F1 0.9801029 
new best score!!!!
Validation loss decreased (0.257365 --> 0.152873).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.657052278518677
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1299457  Vali Loss: 0.1094607 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848151  Vali macro F1 0.9854195 
new best score!!!!
Validation loss decreased (0.152873 --> 0.109461).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 8.095443964004517
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0973263  Vali Loss: 0.0802316 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924625  Vali macro F1 0.9931878 
new best score!!!!
Validation loss decreased (0.109461 --> 0.080232).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.664330720901489
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0718898  Vali Loss: 0.0657020 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887396  Vali macro F1 0.9890281 
new best score!!!!
Validation loss decreased (0.080232 --> 0.065702).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.655698776245117
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0605560  Vali Loss: 0.0570515 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912069  Vali macro F1 0.9917250 
new best score!!!!
Validation loss decreased (0.065702 --> 0.057051).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.68082857131958
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0557603  Vali Loss: 0.0487953 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874041  Vali macro F1 0.9875494 
new best score!!!!
Validation loss decreased (0.057051 --> 0.048795).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.658168077468872
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0426669  Vali Loss: 0.0554279 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9889369  Vali macro F1 0.9895298 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.678717851638794
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0396175  Vali Loss: 0.0397309 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949796  Vali macro F1 0.9950259 
new best score!!!!
Validation loss decreased (0.048795 --> 0.039731).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.663967609405518
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0336719  Vali Loss: 0.0285361 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975008  Vali macro F1 0.9977899 
new best score!!!!
Validation loss decreased (0.039731 --> 0.028536).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.682044744491577
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0299636  Vali Loss: 0.0332093 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924689  Vali macro F1 0.9929027 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 4.670757532119751
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0297515  Vali Loss: 0.0374228 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924352  Vali macro F1 0.9930782 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 4.662823915481567
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0233240  Vali Loss: 0.0339065 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937240  Vali macro F1 0.9942745 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 4.683112859725952
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0223895  Vali Loss: 0.0335362 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899751  Vali macro F1 0.9905043 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 17 cost time: 4.664484977722168
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0242532  Vali Loss: 0.0302560 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912133  Vali macro F1 0.9912517 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 18 cost time: 4.683432579040527
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0173435  Vali Loss: 0.0280268 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912001  Vali macro F1 0.9914624 
new best score!!!!
Validation loss decreased (0.028536 --> 0.028027).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.6687963008880615
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0163257  Vali Loss: 0.0264970 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949708  Vali macro F1 0.9953752 
new best score!!!!
Validation loss decreased (0.028027 --> 0.026497).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.683659553527832
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0154348  Vali Loss: 0.0241045 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962254  Vali macro F1 0.9964322 
new best score!!!!
Validation loss decreased (0.026497 --> 0.024105).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.674485921859741
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0143443  Vali Loss: 0.0217609 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.024105 --> 0.021761).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.6668901443481445
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0148869  Vali Loss: 0.0234447 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949839  Vali macro F1 0.9953996 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.685931921005249
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0135964  Vali Loss: 0.0224515 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.664489984512329
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0141216  Vali Loss: 0.0239665 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 4.6866326332092285
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0139066  Vali Loss: 0.0210304 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.021761 --> 0.021030).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.670622825622559
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0139916  Vali Loss: 0.0203538 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.021030 --> 0.020354).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.68649697303772
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0132321  Vali Loss: 0.0202288 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.020354 --> 0.020229).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.676109790802002
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0135522  Vali Loss: 0.0230661 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.666009426116943
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0123628  Vali Loss: 0.0204413 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.684907913208008
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0129577  Vali Loss: 0.0199137 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
new best score!!!!
Validation loss decreased (0.020229 --> 0.019914).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.667407274246216
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0126389  Vali Loss: 0.0175142 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.019914 --> 0.017514).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.684490442276001
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0125569  Vali Loss: 0.0204169 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.674762010574341
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0127414  Vali Loss: 0.0186922 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.685009717941284
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0117487  Vali Loss: 0.0189984 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.6752824783325195
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0111143  Vali Loss: 0.0194289 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 4.666408538818359
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0122753  Vali Loss: 0.0171587 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.017514 --> 0.017159).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 4.684577703475952
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0113158  Vali Loss: 0.0165402 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.017159 --> 0.016540).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 4.6658854484558105
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0110107  Vali Loss: 0.0158681 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.016540 --> 0.015868).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 4.687031507492065
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0106160  Vali Loss: 0.0168208 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 4.669231414794922
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0193683  Vali Loss: 0.0187804 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 4.685680866241455
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0137047  Vali Loss: 0.0239242 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949839  Vali macro F1 0.9953996 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 4.679974317550659
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0116181  Vali Loss: 0.0174232 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 4.66569185256958
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0116393  Vali Loss: 0.0167383 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 4.688707113265991
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0101606  Vali Loss: 0.0166730 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 4.666944742202759
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0100231  Vali Loss: 0.0167289 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 4.685302257537842
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0105250  Vali Loss: 0.0167851 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 4.66773533821106
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0105605  Vali Loss: 0.0165931 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 4.685340166091919
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0099065  Vali Loss: 0.0162832 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 4.674797296524048
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0099297  Vali Loss: 0.0162683 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 4.6661152839660645
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0098985  Vali Loss: 0.0162648 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 4.685487747192383
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0105965  Vali Loss: 0.0162692 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 4.704990863800049
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0097698  Vali Loss: 0.0162584 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 4.686045169830322
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0108317  Vali Loss: 0.0162446 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8412281  Test weighted F1: 0.7981590  Test macro F1 0.7981590 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.269589900970459
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0109733  Vali Loss: 0.0227287 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
Validation loss decreased (inf --> 0.022729).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.274960994720459
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0104630  Vali Loss: 0.0202876 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
new best score!!!!
Validation loss decreased (0.022729 --> 0.020288).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.2640111446380615
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0086085  Vali Loss: 0.0277474 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.274196147918701
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0096823  Vali Loss: 0.0237883 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.2693023681640625
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0077569  Vali Loss: 0.0196373 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.020288 --> 0.019637).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.273247003555298
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0083273  Vali Loss: 0.0139625 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.019637 --> 0.013963).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.27791428565979
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0075849  Vali Loss: 0.0224001 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.257037162780762
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0086809  Vali Loss: 0.0185248 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.287125110626221
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0083664  Vali Loss: 0.0179573 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.2590155601501465
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0074795  Vali Loss: 0.0221844 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.286672353744507
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0063008  Vali Loss: 0.0211268 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.257969856262207
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0062363  Vali Loss: 0.0197311 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.284862041473389
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0062004  Vali Loss: 0.0115488 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.013963 --> 0.011549).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.266355991363525
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0059526  Vali Loss: 0.0142608 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962488  Vali macro F1 0.9962132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.266296863555908
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0057714  Vali Loss: 0.0183862 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.276300430297852
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0062114  Vali Loss: 0.0216253 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949825  Vali macro F1 0.9955445 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.267633438110352
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0089432  Vali Loss: 0.0109816 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.011549 --> 0.010982).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.2731709480285645
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0065041  Vali Loss: 0.0190698 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.269964694976807
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0058445  Vali Loss: 0.0229149 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962565  Vali macro F1 0.9966373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.275241851806641
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0059994  Vali Loss: 0.0163318 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.277364492416382
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0051084  Vali Loss: 0.0147946 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.2571399211883545
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0047569  Vali Loss: 0.0132290 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.282594680786133
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0051010  Vali Loss: 0.0125203 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.25954270362854
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0054317  Vali Loss: 0.0121946 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.287997007369995
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0051978  Vali Loss: 0.0125423 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.25758695602417
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0044664  Vali Loss: 0.0117285 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.28944993019104
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0046182  Vali Loss: 0.0120494 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 6.267801761627197
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0045744  Vali Loss: 0.0119549 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.266789436340332
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0043245  Vali Loss: 0.0119009 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.269158601760864
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0045605  Vali Loss: 0.0118806 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.26583194732666
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0046562  Vali Loss: 0.0118110 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.271941661834717
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0044333  Vali Loss: 0.0117544 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8473684  Test weighted F1: 0.8089559  Test macro F1 0.8089559 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.786156415939331
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5376682  Vali Loss: 1.3908703 Vali Accuracy: 0.7857143  Vali weighted F1: 0.7770259  Vali macro F1 0.7775653 
Validation loss decreased (inf --> 1.390870).  Saving model ...
Epoch: 2 cost time: 4.692697763442993
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8926460  Vali Loss: 0.5277346 Vali Accuracy: 0.9235589  Vali weighted F1: 0.9209064  Vali macro F1 0.9171713 
new best score!!!!
Validation loss decreased (1.390870 --> 0.527735).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.672619104385376
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3881931  Vali Loss: 0.2679638 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9593619  Vali macro F1 0.9595941 
new best score!!!!
Validation loss decreased (0.527735 --> 0.267964).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.693626165390015
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2036398  Vali Loss: 0.1626017 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9740477  Vali macro F1 0.9744987 
new best score!!!!
Validation loss decreased (0.267964 --> 0.162602).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.671327829360962
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1313854  Vali Loss: 0.0992677 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848607  Vali macro F1 0.9850343 
new best score!!!!
Validation loss decreased (0.162602 --> 0.099268).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.688818693161011
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0978523  Vali Loss: 0.1093061 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9778989  Vali macro F1 0.9788520 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 4.6767518520355225
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0808011  Vali Loss: 0.0661152 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912108  Vali macro F1 0.9911242 
new best score!!!!
Validation loss decreased (0.099268 --> 0.066115).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.664611577987671
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0579349  Vali Loss: 0.0525513 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911007  Vali macro F1 0.9914027 
new best score!!!!
Validation loss decreased (0.066115 --> 0.052551).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.686396837234497
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0454297  Vali Loss: 0.0464892 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898773  Vali macro F1 0.9901684 
new best score!!!!
Validation loss decreased (0.052551 --> 0.046489).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.66694450378418
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0403579  Vali Loss: 0.0372258 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912211  Vali macro F1 0.9914901 
new best score!!!!
Validation loss decreased (0.046489 --> 0.037226).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.686723947525024
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0406209  Vali Loss: 0.0512748 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9871796  Vali macro F1 0.9871385 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.671793460845947
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0355906  Vali Loss: 0.0502681 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9844259  Vali macro F1 0.9848138 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.688650131225586
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0273607  Vali Loss: 0.0267594 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
new best score!!!!
Validation loss decreased (0.037226 --> 0.026759).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.678265810012817
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0285820  Vali Loss: 0.0292325 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924409  Vali macro F1 0.9926715 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.669194459915161
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0259842  Vali Loss: 0.0324244 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898773  Vali macro F1 0.9901684 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 4.690597772598267
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0235846  Vali Loss: 0.0252484 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911630  Vali macro F1 0.9914247 
new best score!!!!
Validation loss decreased (0.026759 --> 0.025248).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.671389102935791
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0196841  Vali Loss: 0.0296896 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911630  Vali macro F1 0.9914247 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.688372373580933
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0154649  Vali Loss: 0.0300539 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923907  Vali macro F1 0.9926132 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 4.674215078353882
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0170940  Vali Loss: 0.0252748 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 4.690040349960327
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0141967  Vali Loss: 0.0195891 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
new best score!!!!
Validation loss decreased (0.025248 --> 0.019589).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.681145429611206
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0126999  Vali Loss: 0.0227218 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.670860767364502
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0196952  Vali Loss: 0.0189931 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9926283 
new best score!!!!
Validation loss decreased (0.019589 --> 0.018993).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.721218109130859
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0205383  Vali Loss: 0.0274854 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950006  Vali macro F1 0.9951434 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 4.6702961921691895
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0244867  Vali Loss: 0.0455811 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911012  Vali macro F1 0.9913557 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 4.693434476852417
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0134521  Vali Loss: 0.0284429 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936737  Vali macro F1 0.9938627 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 4.6735594272613525
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0138004  Vali Loss: 0.0405385 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9870976  Vali macro F1 0.9875478 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 4.692364692687988
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0147099  Vali Loss: 0.0195407 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 4.680737018585205
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0101136  Vali Loss: 0.0194265 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.671161890029907
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0095550  Vali Loss: 0.0190661 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.6915202140808105
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0084994  Vali Loss: 0.0185430 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
new best score!!!!
Validation loss decreased (0.018993 --> 0.018543).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.670515537261963
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0085683  Vali Loss: 0.0184022 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
new best score!!!!
Validation loss decreased (0.018543 --> 0.018402).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.691753387451172
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0082254  Vali Loss: 0.0186883 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.674718618392944
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0126390  Vali Loss: 0.0186696 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.693065166473389
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0087722  Vali Loss: 0.0157522 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
new best score!!!!
Validation loss decreased (0.018402 --> 0.015752).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.683778762817383
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0083412  Vali Loss: 0.0175056 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 4.673690319061279
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0080130  Vali Loss: 0.0175059 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 4.691908121109009
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0073987  Vali Loss: 0.0173701 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 4.672583818435669
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0077259  Vali Loss: 0.0180212 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 4.693851470947266
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0076730  Vali Loss: 0.0191817 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 4.676014423370361
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0072009  Vali Loss: 0.0189939 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.692297458648682
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0073553  Vali Loss: 0.0188136 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.679260492324829
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0081020  Vali Loss: 0.0186412 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.669754981994629
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0073124  Vali Loss: 0.0185487 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 4.691460371017456
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0074869  Vali Loss: 0.0184509 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 4.669724702835083
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0082529  Vali Loss: 0.0184141 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.69175910949707
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0080916  Vali Loss: 0.0183976 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.676321983337402
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0072114  Vali Loss: 0.0183623 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.689501047134399
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0072296  Vali Loss: 0.0183506 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.680278301239014
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0072759  Vali Loss: 0.0183342 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9403509  Test weighted F1: 0.9384237  Test macro F1 0.9384237 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.349036455154419
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0087634  Vali Loss: 0.0152197 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
Validation loss decreased (inf --> 0.015220).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.338629245758057
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0075674  Vali Loss: 0.0190267 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.352989912033081
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0067805  Vali Loss: 0.0196279 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.342614412307739
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0066555  Vali Loss: 0.0212338 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.335515737533569
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0057097  Vali Loss: 0.0180697 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.3522820472717285
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0058537  Vali Loss: 0.0182468 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.332990884780884
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0062620  Vali Loss: 0.0275229 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911012  Vali macro F1 0.9913557 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.355730295181274
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0051512  Vali Loss: 0.0159828 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.33937406539917
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0051748  Vali Loss: 0.0119785 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
new best score!!!!
Validation loss decreased (0.015220 --> 0.011978).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.355529546737671
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0054570  Vali Loss: 0.0190971 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.3423638343811035
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0045076  Vali Loss: 0.0147188 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.332427978515625
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0049899  Vali Loss: 0.0313033 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936422  Vali macro F1 0.9938110 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.351224184036255
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0046564  Vali Loss: 0.0166782 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.331466197967529
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0056488  Vali Loss: 0.0249929 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923907  Vali macro F1 0.9926132 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.354048252105713
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0048169  Vali Loss: 0.0208232 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.335762023925781
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0042707  Vali Loss: 0.0187502 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.351932525634766
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0042591  Vali Loss: 0.0170271 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.345534086227417
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0046049  Vali Loss: 0.0163235 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937118  Vali macro F1 0.9939101 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.334824085235596
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0040008  Vali Loss: 0.0154861 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 6.350265979766846
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0041140  Vali Loss: 0.0154409 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.3342907428741455
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0043340  Vali Loss: 0.0154701 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.34730339050293
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0039684  Vali Loss: 0.0154919 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.333747148513794
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0040095  Vali Loss: 0.0155192 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.353757858276367
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0043093  Vali Loss: 0.0156141 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949770  Vali macro F1 0.9951414 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9394737  Test weighted F1: 0.9377790  Test macro F1 0.9377790 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.783179998397827
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5526266  Vali Loss: 1.3638455 Vali Accuracy: 0.8020050  Vali weighted F1: 0.7941859  Vali macro F1 0.7932941 
Validation loss decreased (inf --> 1.363845).  Saving model ...
Epoch: 2 cost time: 4.696150064468384
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8702900  Vali Loss: 0.5069594 Vali Accuracy: 0.9160401  Vali weighted F1: 0.9167812  Vali macro F1 0.9154302 
new best score!!!!
Validation loss decreased (1.363845 --> 0.506959).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.678197860717773
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3655752  Vali Loss: 0.2530492 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9696692  Vali macro F1 0.9694816 
new best score!!!!
Validation loss decreased (0.506959 --> 0.253049).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.691604375839233
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1942621  Vali Loss: 0.1500512 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9850005  Vali macro F1 0.9852761 
new best score!!!!
Validation loss decreased (0.253049 --> 0.150051).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.683732271194458
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1261421  Vali Loss: 0.1084057 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836869  Vali macro F1 0.9835850 
new best score!!!!
Validation loss decreased (0.150051 --> 0.108406).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.673157691955566
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0951334  Vali Loss: 0.0882187 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862338  Vali macro F1 0.9865659 
new best score!!!!
Validation loss decreased (0.108406 --> 0.088219).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.694597005844116
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0843827  Vali Loss: 0.0746886 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863173  Vali macro F1 0.9866564 
new best score!!!!
Validation loss decreased (0.088219 --> 0.074689).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.67501974105835
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0697446  Vali Loss: 0.0711272 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851707  Vali macro F1 0.9860492 
new best score!!!!
Validation loss decreased (0.074689 --> 0.071127).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.694965124130249
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0580076  Vali Loss: 0.0599006 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836671  Vali macro F1 0.9839198 
new best score!!!!
Validation loss decreased (0.071127 --> 0.059901).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.676709890365601
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0418728  Vali Loss: 0.0517313 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862839  Vali macro F1 0.9872801 
new best score!!!!
Validation loss decreased (0.059901 --> 0.051731).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.693089723587036
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0358725  Vali Loss: 0.0423100 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886830  Vali macro F1 0.9891616 
new best score!!!!
Validation loss decreased (0.051731 --> 0.042310).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.686347961425781
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0305245  Vali Loss: 0.0391558 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912524  Vali macro F1 0.9916814 
new best score!!!!
Validation loss decreased (0.042310 --> 0.039156).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.682223081588745
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0283870  Vali Loss: 0.0337351 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949935  Vali macro F1 0.9955764 
new best score!!!!
Validation loss decreased (0.039156 --> 0.033735).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.693788766860962
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0265136  Vali Loss: 0.0366401 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899516  Vali macro F1 0.9904759 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.673459768295288
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0219201  Vali Loss: 0.0308634 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912345  Vali macro F1 0.9915961 
new best score!!!!
Validation loss decreased (0.033735 --> 0.030863).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.693286418914795
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0194881  Vali Loss: 0.0358804 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887041  Vali macro F1 0.9894407 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.678297281265259
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0232925  Vali Loss: 0.0274004 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912142  Vali macro F1 0.9914820 
new best score!!!!
Validation loss decreased (0.030863 --> 0.027400).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.696317434310913
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0210407  Vali Loss: 0.0280695 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924769  Vali macro F1 0.9932318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.685648202896118
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0200029  Vali Loss: 0.0239172 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924769  Vali macro F1 0.9932318 
new best score!!!!
Validation loss decreased (0.027400 --> 0.023917).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.675001859664917
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0156830  Vali Loss: 0.0229764 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924466  Vali macro F1 0.9932133 
new best score!!!!
Validation loss decreased (0.023917 --> 0.022976).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.694777727127075
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0152422  Vali Loss: 0.0244297 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912415  Vali macro F1 0.9913572 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.678138017654419
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0146148  Vali Loss: 0.0310915 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899826  Vali macro F1 0.9900229 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.693727493286133
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0154292  Vali Loss: 0.0240314 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924739  Vali macro F1 0.9927607 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 4.676546096801758
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0136483  Vali Loss: 0.0269980 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937300  Vali macro F1 0.9940362 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 4.6936118602752686
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0129287  Vali Loss: 0.0194984 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9966749 
new best score!!!!
Validation loss decreased (0.022976 --> 0.019498).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.680282354354858
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0158664  Vali Loss: 0.0437541 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822933  Vali macro F1 0.9819169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 4.6724700927734375
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0232780  Vali Loss: 0.0221847 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937506  Vali macro F1 0.9941527 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 4.693302869796753
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0140156  Vali Loss: 0.0189647 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962361  Vali macro F1 0.9968286 
new best score!!!!
Validation loss decreased (0.019498 --> 0.018965).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.6735405921936035
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0105728  Vali Loss: 0.0174424 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924781  Vali macro F1 0.9931226 
new best score!!!!
Validation loss decreased (0.018965 --> 0.017442).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.691173791885376
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0095966  Vali Loss: 0.0226438 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899419  Vali macro F1 0.9906527 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.6773340702056885
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0086781  Vali Loss: 0.0133541 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9966749 
new best score!!!!
Validation loss decreased (0.017442 --> 0.013354).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.6954193115234375
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0096549  Vali Loss: 0.0201086 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924875  Vali macro F1 0.9925253 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.685917615890503
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0129221  Vali Loss: 0.0375041 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937927  Vali macro F1 0.9935863 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 4.677818536758423
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0248089  Vali Loss: 0.0356533 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848603  Vali macro F1 0.9856781 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 4.694793462753296
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0157788  Vali Loss: 0.0142219 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9966151 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 4.677104949951172
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0108647  Vali Loss: 0.0136006 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 4.693218231201172
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0081949  Vali Loss: 0.0131689 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.013354 --> 0.013169).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 4.672514200210571
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0074033  Vali Loss: 0.0113803 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.013169 --> 0.011380).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 4.692797660827637
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0072194  Vali Loss: 0.0112100 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.011380 --> 0.011210).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.682576417922974
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0148111  Vali Loss: 0.0117100 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.6727399826049805
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0076156  Vali Loss: 0.0111319 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.011210 --> 0.011132).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 4.691783905029297
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0075419  Vali Loss: 0.0107221 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.011132 --> 0.010722).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.673376083374023
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0072557  Vali Loss: 0.0108672 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.69499945640564
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0061956  Vali Loss: 0.0104846 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.010722 --> 0.010485).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 4.677351713180542
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0056547  Vali Loss: 0.0108913 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.692718505859375
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0057967  Vali Loss: 0.0112659 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.683704614639282
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0058777  Vali Loss: 0.0116123 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.673727035522461
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0061781  Vali Loss: 0.0118923 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.6941237449646
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0062755  Vali Loss: 0.0127833 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 4.674664258956909
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0053602  Vali Loss: 0.0128049 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 4.692692279815674
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0062986  Vali Loss: 0.0128377 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 4.675132513046265
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0053867  Vali Loss: 0.0127988 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 4.690117835998535
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0063971  Vali Loss: 0.0128717 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 4.6807122230529785
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0054994  Vali Loss: 0.0129443 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 4.6731743812561035
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0052243  Vali Loss: 0.0129498 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 4.691434144973755
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0057897  Vali Loss: 0.0129672 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 4.674229145050049
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0055652  Vali Loss: 0.0129720 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 4.6933135986328125
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0053304  Vali Loss: 0.0129694 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 4.678554534912109
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0062589  Vali Loss: 0.0129734 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8877193  Test weighted F1: 0.8699108  Test macro F1 0.8699108 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.26259708404541
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0072814  Vali Loss: 0.0162113 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9964054 
Validation loss decreased (inf --> 0.016211).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.242374420166016
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0060821  Vali Loss: 0.0111783 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.016211 --> 0.011178).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.257952690124512
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0055496  Vali Loss: 0.0122081 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.245147466659546
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0050799  Vali Loss: 0.0155401 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9964054 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.262372732162476
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0045608  Vali Loss: 0.0169853 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949803  Vali macro F1 0.9952886 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.2558581829071045
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0050371  Vali Loss: 0.0155088 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949873  Vali macro F1 0.9956668 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.24122953414917
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0041541  Vali Loss: 0.0199694 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9964054 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.261178255081177
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0045927  Vali Loss: 0.0218744 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9964054 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.241336107254028
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0046552  Vali Loss: 0.0232507 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962312  Vali macro F1 0.9967738 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.263692140579224
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0044944  Vali Loss: 0.0194675 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949873  Vali macro F1 0.9956668 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.244997978210449
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0038970  Vali Loss: 0.0183978 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949903  Vali macro F1 0.9951929 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.261590480804443
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0039355  Vali Loss: 0.0149278 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962413  Vali macro F1 0.9966781 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.249400615692139
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0038597  Vali Loss: 0.0151067 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962413  Vali macro F1 0.9966781 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.242098331451416
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0036170  Vali Loss: 0.0154411 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.261148691177368
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0033983  Vali Loss: 0.0154357 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.242136716842651
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0035939  Vali Loss: 0.0169123 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.263927459716797
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0035628  Vali Loss: 0.0166230 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9070175  Test weighted F1: 0.8923051  Test macro F1 0.8923051 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.7351555824279785
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.5597850  Vali Loss: 1.3557938 Vali Accuracy: 0.8057644  Vali weighted F1: 0.7955886  Vali macro F1 0.7964226 
Validation loss decreased (inf --> 1.355794).  Saving model ...
Epoch: 2 cost time: 4.680899143218994
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8927060  Vali Loss: 0.4846171 Vali Accuracy: 0.9411028  Vali weighted F1: 0.9387042  Vali macro F1 0.9369312 
new best score!!!!
Validation loss decreased (1.355794 --> 0.484617).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.66497015953064
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3569551  Vali Loss: 0.2281845 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9582141  Vali macro F1 0.9566974 
new best score!!!!
Validation loss decreased (0.484617 --> 0.228184).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.681858539581299
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1928710  Vali Loss: 0.1356997 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837576  Vali macro F1 0.9844287 
new best score!!!!
Validation loss decreased (0.228184 --> 0.135700).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.666459083557129
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1262798  Vali Loss: 0.0974658 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835603  Vali macro F1 0.9838124 
new best score!!!!
Validation loss decreased (0.135700 --> 0.097466).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.684020757675171
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0859304  Vali Loss: 0.0750399 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837015  Vali macro F1 0.9843046 
new best score!!!!
Validation loss decreased (0.097466 --> 0.075040).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.67236852645874
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0654953  Vali Loss: 0.0591508 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887317  Vali macro F1 0.9886071 
new best score!!!!
Validation loss decreased (0.075040 --> 0.059151).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.663977146148682
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0550317  Vali Loss: 0.0440631 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911896  Vali macro F1 0.9913317 
new best score!!!!
Validation loss decreased (0.059151 --> 0.044063).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.682374477386475
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0422561  Vali Loss: 0.0410499 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860138  Vali macro F1 0.9867076 
new best score!!!!
Validation loss decreased (0.044063 --> 0.041050).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.665499448776245
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0369578  Vali Loss: 0.0289192 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949852  Vali macro F1 0.9949352 
new best score!!!!
Validation loss decreased (0.041050 --> 0.028919).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.685953617095947
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0322764  Vali Loss: 0.0299542 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924753  Vali macro F1 0.9925911 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.666633129119873
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0333612  Vali Loss: 0.0323006 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899921  Vali macro F1 0.9907434 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.681837558746338
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0365695  Vali Loss: 0.0308544 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899499  Vali macro F1 0.9903224 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 4.675023317337036
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0204764  Vali Loss: 0.0230451 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937115  Vali macro F1 0.9940554 
new best score!!!!
Validation loss decreased (0.028919 --> 0.023045).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.665533781051636
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0189852  Vali Loss: 0.0211510 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9941711 
new best score!!!!
Validation loss decreased (0.023045 --> 0.021151).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.683419227600098
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0159387  Vali Loss: 0.0180784 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949766  Vali macro F1 0.9950313 
new best score!!!!
Validation loss decreased (0.021151 --> 0.018078).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.665581464767456
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0210399  Vali Loss: 0.0194424 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 4.688852071762085
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0140990  Vali Loss: 0.0194319 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 4.6701507568359375
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0131420  Vali Loss: 0.0213212 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949738  Vali macro F1 0.9954507 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 4.685775518417358
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0141131  Vali Loss: 0.0145635 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.018078 --> 0.014563).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.679489850997925
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0115938  Vali Loss: 0.0137208 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
new best score!!!!
Validation loss decreased (0.014563 --> 0.013721).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.672373056411743
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0100979  Vali Loss: 0.0155693 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.689720392227173
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0095440  Vali Loss: 0.0127903 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.013721 --> 0.012790).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.668403625488281
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0084745  Vali Loss: 0.0131129 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 4.6882898807525635
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0070922  Vali Loss: 0.0220286 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937115  Vali macro F1 0.9940554 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 4.67290997505188
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0086237  Vali Loss: 0.0143459 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 4.682577610015869
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0090737  Vali Loss: 0.0204005 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924405  Vali macro F1 0.9928169 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 4.67740797996521
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0133683  Vali Loss: 0.0142410 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949824  Vali macro F1 0.9949281 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 4.669609785079956
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0077335  Vali Loss: 0.0128638 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 4.688454866409302
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0066454  Vali Loss: 0.0139944 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 4.668442964553833
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0059218  Vali Loss: 0.0134039 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 4.686915636062622
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0057344  Vali Loss: 0.0132929 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 4.6726179122924805
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0051646  Vali Loss: 0.0129277 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 4.6845948696136475
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0050723  Vali Loss: 0.0129213 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 4.671332836151123
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0050477  Vali Loss: 0.0129238 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 4.663446426391602
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0049267  Vali Loss: 0.0129750 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 4.684693336486816
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0049816  Vali Loss: 0.0129450 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 4.664216756820679
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0051527  Vali Loss: 0.0129630 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8508772  Test weighted F1: 0.8257142  Test macro F1 0.8257142 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.274356365203857
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0076866  Vali Loss: 0.0115789 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
Validation loss decreased (inf --> 0.011579).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.261532306671143
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0061632  Vali Loss: 0.0116727 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.27795934677124
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0056768  Vali Loss: 0.0122116 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.258846759796143
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0049472  Vali Loss: 0.0111659 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.011579 --> 0.011166).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.283016204833984
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0049723  Vali Loss: 0.0107568 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.011166 --> 0.010757).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.264344692230225
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0049652  Vali Loss: 0.0111425 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.27735710144043
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0045471  Vali Loss: 0.0103628 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.010757 --> 0.010363).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.2696449756622314
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0038106  Vali Loss: 0.0102777 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.010363 --> 0.010278).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.2595765590667725
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0033996  Vali Loss: 0.0106799 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.274968385696411
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0034882  Vali Loss: 0.0097784 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.010278 --> 0.009778).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.257641315460205
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0031706  Vali Loss: 0.0143117 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.275000333786011
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0037246  Vali Loss: 0.0097967 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.258436441421509
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0029674  Vali Loss: 0.0097020 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.009778 --> 0.009702).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.280795097351074
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0033744  Vali Loss: 0.0087242 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.009702 --> 0.008724).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.2725653648376465
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0023263  Vali Loss: 0.0096782 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.258917808532715
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0029657  Vali Loss: 0.0083589 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.008724 --> 0.008359).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.2792909145355225
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0027358  Vali Loss: 0.0134114 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949867  Vali macro F1 0.9949227 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.257556438446045
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0023055  Vali Loss: 0.0091727 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.27443265914917
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0026302  Vali Loss: 0.0099713 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962415  Vali macro F1 0.9965065 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.257969856262207
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0026332  Vali Loss: 0.0087783 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962415  Vali macro F1 0.9965065 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.27316689491272
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0023627  Vali Loss: 0.0094348 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 22 cost time: 6.264042854309082
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0023657  Vali Loss: 0.0092514 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.2556374073028564
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0019776  Vali Loss: 0.0089227 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.2745678424835205
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0018833  Vali Loss: 0.0092994 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.261219263076782
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0019921  Vali Loss: 0.0086131 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.276249647140503
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0017684  Vali Loss: 0.0086611 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.259695529937744
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0016881  Vali Loss: 0.0085854 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.271696329116821
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0015337  Vali Loss: 0.0082970 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.008359 --> 0.008297).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.264213562011719
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0015215  Vali Loss: 0.0083613 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.256051540374756
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0015243  Vali Loss: 0.0083267 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.286547660827637
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0015189  Vali Loss: 0.0083577 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.256481170654297
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0014913  Vali Loss: 0.0083036 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.273823976516724
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0013345  Vali Loss: 0.0083246 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 34 cost time: 6.263606071472168
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0015293  Vali Loss: 0.0083196 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 6.2798590660095215
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0016123  Vali Loss: 0.0083269 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 6.27135705947876
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0015331  Vali Loss: 0.0082894 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.008297 --> 0.008289).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 6.261902570724487
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0015432  Vali Loss: 0.0082769 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.008289 --> 0.008277).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 38 cost time: 6.279701232910156
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0015239  Vali Loss: 0.0082857 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 6.261250019073486
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0013144  Vali Loss: 0.0083052 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 6.27725625038147
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0019520  Vali Loss: 0.0083262 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 6.263099193572998
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0013321  Vali Loss: 0.0083309 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 6.275323390960693
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0014539  Vali Loss: 0.0083428 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 43 cost time: 6.2694714069366455
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0023547  Vali Loss: 0.0083370 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 6.256818532943726
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0013104  Vali Loss: 0.0083357 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 6.276199102401733
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0014727  Vali Loss: 0.0083397 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 46 cost time: 6.258905649185181
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0015518  Vali Loss: 0.0083378 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 47 cost time: 6.2755818367004395
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0014609  Vali Loss: 0.0083375 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000004e-08
Fine Tuning Epoch: 48 cost time: 6.266088247299194
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0014861  Vali Loss: 0.0083376 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 49 cost time: 6.277813673019409
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0016519  Vali Loss: 0.0083377 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 50 cost time: 6.268300294876099
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0021116  Vali Loss: 0.0083372 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 51 cost time: 6.264793634414673
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0014718  Vali Loss: 0.0083372 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 52 cost time: 6.277880907058716
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0015890  Vali Loss: 0.0083374 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8508772  Test weighted F1: 0.8252276  Test macro F1 0.8252276 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 408860
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.746006488800049
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3754573  Vali Loss: 1.1768008 Vali Accuracy: 0.7969925  Vali weighted F1: 0.7869359  Vali macro F1 0.7883970 
Validation loss decreased (inf --> 1.176801).  Saving model ...
Epoch: 2 cost time: 4.672588348388672
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8313772  Vali Loss: 0.5092698 Vali Accuracy: 0.8984962  Vali weighted F1: 0.8902081  Vali macro F1 0.8910788 
new best score!!!!
Validation loss decreased (1.176801 --> 0.509270).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.663825750350952
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4073307  Vali Loss: 0.2766125 Vali Accuracy: 0.9448622  Vali weighted F1: 0.9442642  Vali macro F1 0.9433954 
new best score!!!!
Validation loss decreased (0.509270 --> 0.276612).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.68333101272583
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2436669  Vali Loss: 0.1734568 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9749791  Vali macro F1 0.9737203 
new best score!!!!
Validation loss decreased (0.276612 --> 0.173457).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.662733554840088
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1626875  Vali Loss: 0.1324044 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9768757  Vali macro F1 0.9757057 
new best score!!!!
Validation loss decreased (0.173457 --> 0.132404).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.68522310256958
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1230188  Vali Loss: 0.0992698 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9824407  Vali macro F1 0.9811690 
new best score!!!!
Validation loss decreased (0.132404 --> 0.099270).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.667181015014648
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0829896  Vali Loss: 0.0740558 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888565  Vali macro F1 0.9879004 
new best score!!!!
Validation loss decreased (0.099270 --> 0.074056).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.6849987506866455
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0652212  Vali Loss: 0.0600876 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
new best score!!!!
Validation loss decreased (0.074056 --> 0.060088).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.673441648483276
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0530691  Vali Loss: 0.0540092 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900889  Vali macro F1 0.9892386 
new best score!!!!
Validation loss decreased (0.060088 --> 0.054009).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.668292760848999
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0701667  Vali Loss: 0.0682126 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811640  Vali macro F1 0.9798992 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.689727067947388
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0460225  Vali Loss: 0.0438579 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913199  Vali macro F1 0.9905835 
new best score!!!!
Validation loss decreased (0.054009 --> 0.043858).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.667434453964233
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0370207  Vali Loss: 0.0468127 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 4.689173221588135
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0301692  Vali Loss: 0.0359450 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.043858 --> 0.035945).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.671356439590454
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0329689  Vali Loss: 0.0425388 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9931019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 4.682798624038696
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0337279  Vali Loss: 0.0309851 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
new best score!!!!
Validation loss decreased (0.035945 --> 0.030985).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.675622224807739
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0245010  Vali Loss: 0.0324046 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.667123556137085
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0203088  Vali Loss: 0.0353552 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.689823150634766
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0191146  Vali Loss: 0.0330427 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 4.670085668563843
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0169610  Vali Loss: 0.0343384 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925225  Vali macro F1 0.9915472 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 4.690166711807251
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0199009  Vali Loss: 0.0370427 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888740  Vali macro F1 0.9876904 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 4.670922756195068
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0168263  Vali Loss: 0.0177548 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.030985 --> 0.017755).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.687154531478882
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0139166  Vali Loss: 0.0238539 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.679104804992676
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0129398  Vali Loss: 0.0257296 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.667824745178223
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0127423  Vali Loss: 0.0244177 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 4.684232711791992
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0128467  Vali Loss: 0.0183005 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 4.666642189025879
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0127862  Vali Loss: 0.0183563 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 27 cost time: 4.688369035720825
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0127384  Vali Loss: 0.0177643 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.668103933334351
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0128713  Vali Loss: 0.0174526 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.017755 --> 0.017453).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.685009002685547
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0120642  Vali Loss: 0.0177608 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 4.673799991607666
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0118374  Vali Loss: 0.0182193 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 4.669140100479126
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0116394  Vali Loss: 0.0176521 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 4.689415216445923
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0115070  Vali Loss: 0.0172149 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.017453 --> 0.017215).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.666785717010498
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0115921  Vali Loss: 0.0171316 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.017215 --> 0.017132).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 4.686894416809082
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0121565  Vali Loss: 0.0178341 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 4.6718761920928955
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0157132  Vali Loss: 0.0180403 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 4.687596797943115
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0123141  Vali Loss: 0.0176388 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 4.679486274719238
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0111039  Vali Loss: 0.0168845 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.017132 --> 0.016885).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 4.669188022613525
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0117136  Vali Loss: 0.0162308 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.016885 --> 0.016231).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 4.692180156707764
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0124107  Vali Loss: 0.0165208 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 4.67399001121521
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0110448  Vali Loss: 0.0213638 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 4.690699815750122
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0117993  Vali Loss: 0.0218136 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 4.676858901977539
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0117491  Vali Loss: 0.0221205 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 4.697875022888184
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0155553  Vali Loss: 0.0220237 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 4.689590930938721
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0112511  Vali Loss: 0.0218333 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 4.679628372192383
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0116981  Vali Loss: 0.0216667 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 4.698574066162109
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0113257  Vali Loss: 0.0215141 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 4.67856764793396
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0110410  Vali Loss: 0.0213543 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 4.694652795791626
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0117181  Vali Loss: 0.0212231 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 49 cost time: 4.681184530258179
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0115044  Vali Loss: 0.0212187 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 4.697922706604004
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0115063  Vali Loss: 0.0212138 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 4.689541339874268
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0111103  Vali Loss: 0.0212044 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 4.679635763168335
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0113931  Vali Loss: 0.0211868 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 4.696786403656006
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0112699  Vali Loss: 0.0211859 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8587719  Test weighted F1: 0.8306494  Test macro F1 0.8306494 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.312650203704834
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0117160  Vali Loss: 0.0241067 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
Validation loss decreased (inf --> 0.024107).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.305434465408325
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0111135  Vali Loss: 0.0214285 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.024107 --> 0.021428).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.292401075363159
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0099006  Vali Loss: 0.0150561 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.021428 --> 0.015056).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.303773641586304
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0096068  Vali Loss: 0.0124449 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.015056 --> 0.012445).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.29292106628418
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0094422  Vali Loss: 0.0108196 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.012445 --> 0.010820).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.316709518432617
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0090604  Vali Loss: 0.0128483 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.2967658042907715
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0086776  Vali Loss: 0.0117862 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.318636417388916
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0087857  Vali Loss: 0.0115052 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.301337718963623
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0100696  Vali Loss: 0.0139783 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.296546220779419
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0077530  Vali Loss: 0.0098322 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.010820 --> 0.009832).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.319842100143433
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0075600  Vali Loss: 0.0111691 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.290899753570557
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0068492  Vali Loss: 0.0098610 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.315572261810303
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0072516  Vali Loss: 0.0104824 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.294454574584961
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0063460  Vali Loss: 0.0084441 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.009832 --> 0.008444).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.3086583614349365
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0076650  Vali Loss: 0.0075391 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.008444 --> 0.007539).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.3000757694244385
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0061307  Vali Loss: 0.0088923 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.295101642608643
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0061756  Vali Loss: 0.0100333 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.313060760498047
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0061058  Vali Loss: 0.0073218 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.007539 --> 0.007322).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.293853998184204
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0052585  Vali Loss: 0.0104113 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.31377387046814
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0054495  Vali Loss: 0.0056009 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007322 --> 0.005601).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.293004274368286
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0053473  Vali Loss: 0.0082494 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.319648027420044
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0054897  Vali Loss: 0.0080311 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.2990124225616455
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0059301  Vali Loss: 0.0080240 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.291452646255493
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0054388  Vali Loss: 0.0079453 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.306565761566162
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0058325  Vali Loss: 0.0118606 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 26 cost time: 6.296313047409058
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0045238  Vali Loss: 0.0054183 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005601 --> 0.005418).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.316409587860107
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0048500  Vali Loss: 0.0056948 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.29643988609314
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0047669  Vali Loss: 0.0099011 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.311697006225586
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0043776  Vali Loss: 0.0063118 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.295153617858887
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0057539  Vali Loss: 0.0078534 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.292317867279053
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0046822  Vali Loss: 0.0077777 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 32 cost time: 6.3002400398254395
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0044140  Vali Loss: 0.0072428 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.28886604309082
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0043136  Vali Loss: 0.0072742 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.297340631484985
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0041321  Vali Loss: 0.0073024 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.286533355712891
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0039809  Vali Loss: 0.0067735 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.291979551315308
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0039353  Vali Loss: 0.0065147 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 37 cost time: 6.295875310897827
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0041982  Vali Loss: 0.0064529 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.283079147338867
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0040741  Vali Loss: 0.0063832 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.292099237442017
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0039474  Vali Loss: 0.0063396 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.284111976623535
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0036656  Vali Loss: 0.0063175 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.313054800033569
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0037362  Vali Loss: 0.0061787 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8894737  Test weighted F1: 0.8758061  Test macro F1 0.8758061 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.76973819732666
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.4308417  Vali Loss: 1.3076139 Vali Accuracy: 0.7907268  Vali weighted F1: 0.7746183  Vali macro F1 0.7761517 
Validation loss decreased (inf --> 1.307614).  Saving model ...
Epoch: 2 cost time: 4.686572313308716
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8676828  Vali Loss: 0.5324778 Vali Accuracy: 0.9185464  Vali weighted F1: 0.9178596  Vali macro F1 0.9149059 
new best score!!!!
Validation loss decreased (1.307614 --> 0.532478).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.664900302886963
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4150136  Vali Loss: 0.2767793 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9579378  Vali macro F1 0.9565720 
new best score!!!!
Validation loss decreased (0.532478 --> 0.276779).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.684038162231445
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2504014  Vali Loss: 0.1804858 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9712982  Vali macro F1 0.9693552 
new best score!!!!
Validation loss decreased (0.276779 --> 0.180486).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.667809724807739
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1606033  Vali Loss: 0.1290339 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9782510  Vali macro F1 0.9769051 
new best score!!!!
Validation loss decreased (0.180486 --> 0.129034).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.685178995132446
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1182446  Vali Loss: 0.1019543 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9794602  Vali macro F1 0.9782861 
new best score!!!!
Validation loss decreased (0.129034 --> 0.101954).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.676265716552734
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0856922  Vali Loss: 0.0802883 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9834357  Vali macro F1 0.9823786 
new best score!!!!
Validation loss decreased (0.101954 --> 0.080288).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.665550947189331
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0676633  Vali Loss: 0.0708087 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822408  Vali macro F1 0.9810182 
new best score!!!!
Validation loss decreased (0.080288 --> 0.070809).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.685016870498657
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0540400  Vali Loss: 0.0638322 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899732  Vali macro F1 0.9889562 
new best score!!!!
Validation loss decreased (0.070809 --> 0.063832).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.669977426528931
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0467938  Vali Loss: 0.0537375 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848125  Vali macro F1 0.9837384 
new best score!!!!
Validation loss decreased (0.063832 --> 0.053738).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.6852264404296875
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0411863  Vali Loss: 0.0425963 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
new best score!!!!
Validation loss decreased (0.053738 --> 0.042596).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.668625593185425
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0372030  Vali Loss: 0.0430479 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888740  Vali macro F1 0.9876904 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 4.685859680175781
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0332501  Vali Loss: 0.0428020 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887355  Vali macro F1 0.9877442 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 4.6782166957855225
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0310703  Vali Loss: 0.0374516 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912322  Vali macro F1 0.9904566 
new best score!!!!
Validation loss decreased (0.042596 --> 0.037452).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.666826486587524
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0317055  Vali Loss: 0.0386989 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 4.686203718185425
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0262030  Vali Loss: 0.0378660 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912271  Vali macro F1 0.9906682 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.596673965454102
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0255401  Vali Loss: 0.0372217 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900886  Vali macro F1 0.9891225 
new best score!!!!
Validation loss decreased (0.037452 --> 0.037222).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.684854507446289
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0235814  Vali Loss: 0.0439120 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876352  Vali macro F1 0.9863613 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 4.668760538101196
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0228464  Vali Loss: 0.0302363 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.037222 --> 0.030236).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.685980796813965
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0175581  Vali Loss: 0.0240268 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
new best score!!!!
Validation loss decreased (0.030236 --> 0.024027).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.677187204360962
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0150813  Vali Loss: 0.0242188 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.665297508239746
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0151876  Vali Loss: 0.0622474 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9820244  Vali macro F1 0.9828591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.6834094524383545
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0372803  Vali Loss: 0.0241376 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 4.665951251983643
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0149168  Vali Loss: 0.0214709 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.024027 --> 0.021471).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.684688091278076
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0161451  Vali Loss: 0.0193653 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.021471 --> 0.019365).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.669278144836426
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0124492  Vali Loss: 0.0339740 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888740  Vali macro F1 0.9876904 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 4.685328483581543
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0133423  Vali Loss: 0.0150586 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.019365 --> 0.015059).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.676950216293335
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0109605  Vali Loss: 0.0265186 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 4.6692140102386475
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0159876  Vali Loss: 0.0186977 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 4.68750786781311
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0087162  Vali Loss: 0.0135488 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.015059 --> 0.013549).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.6705710887908936
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0103000  Vali Loss: 0.0694566 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899044  Vali macro F1 0.9884440 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 4.691411018371582
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0166874  Vali Loss: 0.0209374 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 4.672482013702393
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0080415  Vali Loss: 0.0164099 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 4.691152572631836
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0080036  Vali Loss: 0.0153523 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 4.6878626346588135
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0070112  Vali Loss: 0.0058815 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.013549 --> 0.005882).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.670348167419434
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0067157  Vali Loss: 0.0076199 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 4.687078237533569
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0052681  Vali Loss: 0.0095739 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 4.669241189956665
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0050428  Vali Loss: 0.0078222 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 4.6897337436676025
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0100133  Vali Loss: 0.0192765 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 4.672429084777832
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0075812  Vali Loss: 0.0125523 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 4.689955949783325
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0053973  Vali Loss: 0.0122699 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 4.679604530334473
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0051298  Vali Loss: 0.0058401 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005882 --> 0.005840).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.671133995056152
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0080517  Vali Loss: 0.0055321 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005840 --> 0.005532).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 4.68936824798584
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0051318  Vali Loss: 0.0057032 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 4.669960975646973
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0046876  Vali Loss: 0.0051490 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.005532 --> 0.005149).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 4.69318151473999
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0046443  Vali Loss: 0.0049014 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
new best score!!!!
Validation loss decreased (0.005149 --> 0.004901).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 4.67213773727417
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0041528  Vali Loss: 0.0047891 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
new best score!!!!
Validation loss decreased (0.004901 --> 0.004789).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 4.687741041183472
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0042190  Vali Loss: 0.0052135 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 4.679832220077515
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0042097  Vali Loss: 0.0050934 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 4.668782949447632
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0040881  Vali Loss: 0.0046455 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
new best score!!!!
Validation loss decreased (0.004789 --> 0.004646).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 4.689698219299316
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0035708  Vali Loss: 0.0045392 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004646 --> 0.004539).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 4.670043706893921
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0037849  Vali Loss: 0.0044981 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004539 --> 0.004498).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 4.690504789352417
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0037856  Vali Loss: 0.0044784 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004498 --> 0.004478).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 4.6749725341796875
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0038146  Vali Loss: 0.0044054 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004478 --> 0.004405).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 4.690583229064941
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0038319  Vali Loss: 0.0049929 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 4.685100317001343
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0036762  Vali Loss: 0.0044680 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 4.674515724182129
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0036602  Vali Loss: 0.0043099 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004405 --> 0.004310).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 4.693531513214111
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0038463  Vali Loss: 0.0043649 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 4.674098014831543
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0034702  Vali Loss: 0.0047382 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 4.693233966827393
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0037244  Vali Loss: 0.0042936 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004310 --> 0.004294).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 4.677595138549805
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0036463  Vali Loss: 0.0041407 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004294 --> 0.004141).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 4.693897724151611
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0033794  Vali Loss: 0.0042866 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 4.6844823360443115
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0038096  Vali Loss: 0.0040459 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004141 --> 0.004046).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 4.680958271026611
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0036201  Vali Loss: 0.0039935 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004046 --> 0.003994).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 4.6980462074279785
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0035161  Vali Loss: 0.0039827 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003994 --> 0.003983).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 4.679139137268066
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0033535  Vali Loss: 0.0039627 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003983 --> 0.003963).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 4.697368860244751
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0033204  Vali Loss: 0.0038884 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003963 --> 0.003888).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 4.681846857070923
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0032275  Vali Loss: 0.0039839 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 4.6962926387786865
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0035092  Vali Loss: 0.0038503 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003888 --> 0.003850).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 4.686692714691162
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0031222  Vali Loss: 0.0037505 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003850 --> 0.003750).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 4.672883987426758
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0032906  Vali Loss: 0.0037591 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 4.693181753158569
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0032307  Vali Loss: 0.0037419 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003750 --> 0.003742).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 4.670721054077148
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0034162  Vali Loss: 0.0037411 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.003742 --> 0.003741).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 4.693119764328003
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0030736  Vali Loss: 0.0044082 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 4.674845457077026
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0032746  Vali Loss: 0.0037289 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003741 --> 0.003729).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 4.693548917770386
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0030049  Vali Loss: 0.0037599 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 4.685957193374634
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0043245  Vali Loss: 0.0041089 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 4.673924684524536
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0028881  Vali Loss: 0.0046136 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 4.695284843444824
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0033836  Vali Loss: 0.0051130 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 4.6737658977508545
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0041965  Vali Loss: 0.0041561 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 81 cost time: 4.694806814193726
VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0030482  Vali Loss: 0.0041358 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 82 cost time: 4.673823356628418
VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0033146  Vali Loss: 0.0041081 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 83 cost time: 4.692344903945923
VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0033428  Vali Loss: 0.0040568 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 84 cost time: 4.678220748901367
VALI: Epoch: 84, Steps: 29 | Train Loss: 0.0033163  Vali Loss: 0.0040283 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 85 cost time: 4.6693947315216064
VALI: Epoch: 85, Steps: 29 | Train Loss: 0.0030383  Vali Loss: 0.0039962 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 86 cost time: 4.692583084106445
VALI: Epoch: 86, Steps: 29 | Train Loss: 0.0030044  Vali Loss: 0.0039931 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 87 cost time: 4.670530557632446
VALI: Epoch: 87, Steps: 29 | Train Loss: 0.0032234  Vali Loss: 0.0039914 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 88 cost time: 4.692171573638916
VALI: Epoch: 88, Steps: 29 | Train Loss: 0.0032041  Vali Loss: 0.0039889 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 89 cost time: 4.674396514892578
VALI: Epoch: 89, Steps: 29 | Train Loss: 0.0036016  Vali Loss: 0.0039869 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 90 cost time: 4.690147876739502
VALI: Epoch: 90, Steps: 29 | Train Loss: 0.0032777  Vali Loss: 0.0039855 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9271930  Test weighted F1: 0.9114905  Test macro F1 0.9114905 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.31980037689209
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0033960  Vali Loss: 0.0036605 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
Validation loss decreased (inf --> 0.003661).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.339842319488525
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0039830  Vali Loss: 0.0053342 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.3212432861328125
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0028887  Vali Loss: 0.0043264 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.3369951248168945
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0028215  Vali Loss: 0.0034291 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003661 --> 0.003429).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.329479694366455
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0028008  Vali Loss: 0.0040342 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.319830417633057
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0025226  Vali Loss: 0.0043918 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.344007253646851
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0021511  Vali Loss: 0.0034054 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003429 --> 0.003405).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.321005344390869
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0023213  Vali Loss: 0.0034346 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.337420701980591
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0021342  Vali Loss: 0.0038549 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.317814111709595
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0020855  Vali Loss: 0.0027672 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003405 --> 0.002767).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.338398218154907
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0035177  Vali Loss: 0.0062187 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.326177597045898
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0046505  Vali Loss: 0.0068579 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.3198065757751465
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0030015  Vali Loss: 0.0024876 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.002767 --> 0.002488).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.337528228759766
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0023516  Vali Loss: 0.0019708 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002488 --> 0.001971).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.308194160461426
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0020523  Vali Loss: 0.0018443 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001971 --> 0.001844).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.337479114532471
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0017830  Vali Loss: 0.0017569 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001844 --> 0.001757).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.313142776489258
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0017770  Vali Loss: 0.0017642 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.336580991744995
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0026370  Vali Loss: 0.0023373 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.324448108673096
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0019318  Vali Loss: 0.0020859 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.3216023445129395
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0017437  Vali Loss: 0.0016744 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001757 --> 0.001674).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.332350015640259
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0019151  Vali Loss: 0.0020149 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.320723056793213
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0020730  Vali Loss: 0.0024340 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.332575082778931
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0015781  Vali Loss: 0.0021421 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.309958457946777
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0015010  Vali Loss: 0.0015786 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001674 --> 0.001579).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.343470573425293
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0018337  Vali Loss: 0.0013523 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001579 --> 0.001352).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.33017897605896
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018575  Vali Loss: 0.0012802 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001352 --> 0.001280).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.31866192817688
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0020118  Vali Loss: 0.0016110 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.337127923965454
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0014876  Vali Loss: 0.0012984 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.315878868103027
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0013234  Vali Loss: 0.0014800 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.3337976932525635
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0020113  Vali Loss: 0.0017926 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.308669567108154
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0018412  Vali Loss: 0.0016731 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 32 cost time: 6.34269642829895
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0013277  Vali Loss: 0.0020125 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.325813293457031
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0017421  Vali Loss: 0.0018947 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.311253070831299
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0017070  Vali Loss: 0.0013695 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.339630365371704
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0020869  Vali Loss: 0.0015079 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.317684888839722
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0014413  Vali Loss: 0.0016985 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 37 cost time: 6.337655305862427
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0011141  Vali Loss: 0.0016582 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.316542387008667
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0017011  Vali Loss: 0.0015687 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.334325551986694
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0015169  Vali Loss: 0.0015464 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.324993133544922
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0012226  Vali Loss: 0.0015420 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.314802408218384
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0017264  Vali Loss: 0.0015328 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9149123  Test weighted F1: 0.8975788  Test macro F1 0.8975788 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.734473705291748
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3648478  Vali Loss: 1.2062871 Vali Accuracy: 0.8082707  Vali weighted F1: 0.7897395  Vali macro F1 0.7891959 
Validation loss decreased (inf --> 1.206287).  Saving model ...
Epoch: 2 cost time: 4.688719987869263
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8135082  Vali Loss: 0.5144991 Vali Accuracy: 0.8959900  Vali weighted F1: 0.8907169  Vali macro F1 0.8893639 
new best score!!!!
Validation loss decreased (1.206287 --> 0.514499).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.676836729049683
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4004590  Vali Loss: 0.2792093 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9617928  Vali macro F1 0.9604070 
new best score!!!!
Validation loss decreased (0.514499 --> 0.279209).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.6686437129974365
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2514515  Vali Loss: 0.1876818 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9728495  Vali macro F1 0.9708838 
new best score!!!!
Validation loss decreased (0.279209 --> 0.187682).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.688246488571167
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1714413  Vali Loss: 0.1318338 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808363  Vali macro F1 0.9798843 
new best score!!!!
Validation loss decreased (0.187682 --> 0.131834).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.668481111526489
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1196014  Vali Loss: 0.0926095 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848125  Vali macro F1 0.9837384 
new best score!!!!
Validation loss decreased (0.131834 --> 0.092609).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.6887102127075195
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0923094  Vali Loss: 0.0756390 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848366  Vali macro F1 0.9841656 
new best score!!!!
Validation loss decreased (0.092609 --> 0.075639).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.716283321380615
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0714401  Vali Loss: 0.0574572 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898902  Vali macro F1 0.9892066 
new best score!!!!
Validation loss decreased (0.075639 --> 0.057457).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.689746379852295
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0584468  Vali Loss: 0.0488775 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885450  Vali macro F1 0.9879558 
new best score!!!!
Validation loss decreased (0.057457 --> 0.048878).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.679652452468872
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0482220  Vali Loss: 0.0439612 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872632  Vali macro F1 0.9865663 
new best score!!!!
Validation loss decreased (0.048878 --> 0.043961).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.668274641036987
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0406398  Vali Loss: 0.0375965 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924164  Vali macro F1 0.9919778 
new best score!!!!
Validation loss decreased (0.043961 --> 0.037596).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.688232421875
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0390868  Vali Loss: 0.0300084 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936809  Vali macro F1 0.9933779 
new best score!!!!
Validation loss decreased (0.037596 --> 0.030008).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.669953107833862
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0400772  Vali Loss: 0.0465317 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861575  Vali macro F1 0.9859755 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 4.689018726348877
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0348140  Vali Loss: 0.0329984 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886258  Vali macro F1 0.9878325 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 4.672044277191162
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0357137  Vali Loss: 0.0238399 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911742  Vali macro F1 0.9907140 
new best score!!!!
Validation loss decreased (0.030008 --> 0.023840).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.689970254898071
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0288839  Vali Loss: 0.0359555 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9877402  Vali macro F1 0.9865687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.683032512664795
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0574931  Vali Loss: 0.0304691 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.67357611656189
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0303483  Vali Loss: 0.0258244 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 4.691835403442383
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0285689  Vali Loss: 0.0219764 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949940  Vali macro F1 0.9948545 
new best score!!!!
Validation loss decreased (0.023840 --> 0.021976).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.681482791900635
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0233518  Vali Loss: 0.0164922 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.021976 --> 0.016492).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.696702241897583
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0193186  Vali Loss: 0.0144500 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
new best score!!!!
Validation loss decreased (0.016492 --> 0.014450).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.680402517318726
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0161106  Vali Loss: 0.0117798 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.014450 --> 0.011780).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 4.694353818893433
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0155511  Vali Loss: 0.0310620 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874830  Vali macro F1 0.9863959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 4.685610055923462
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0268895  Vali Loss: 0.0179422 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949754  Vali macro F1 0.9945862 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 4.682499885559082
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0167054  Vali Loss: 0.0135546 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 4.701182126998901
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0138565  Vali Loss: 0.0098596 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011780 --> 0.009860).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.682765245437622
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0139760  Vali Loss: 0.0149484 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949471  Vali macro F1 0.9944625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.700366497039795
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0187398  Vali Loss: 0.0509571 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9798858  Vali macro F1 0.9808595 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 4.686343193054199
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0615819  Vali Loss: 0.0320208 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937215  Vali macro F1 0.9931556 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 4.702807188034058
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0193670  Vali Loss: 0.0106843 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 4.696127653121948
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0117115  Vali Loss: 0.0089752 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.009860 --> 0.008975).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 4.685166835784912
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0154100  Vali Loss: 0.0088492 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.008975 --> 0.008849).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.7051897048950195
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0108955  Vali Loss: 0.0132189 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949754  Vali macro F1 0.9945862 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.685342788696289
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0175023  Vali Loss: 0.0186957 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924789  Vali macro F1 0.9918235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 4.704990386962891
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0565077  Vali Loss: 0.0285562 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 4.692867040634155
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0258593  Vali Loss: 0.0230075 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962389  Vali macro F1 0.9959884 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 4.70634126663208
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0221073  Vali Loss: 0.0151945 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 4.695041179656982
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0158952  Vali Loss: 0.0126757 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 4.687833547592163
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0139821  Vali Loss: 0.0120700 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 4.709235191345215
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0163480  Vali Loss: 0.0116708 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 4.690021276473999
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0137558  Vali Loss: 0.0106085 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 4.709874629974365
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0128878  Vali Loss: 0.0104203 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 4.690937280654907
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0133559  Vali Loss: 0.0103372 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.705240488052368
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0124247  Vali Loss: 0.0102589 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 4.700497150421143
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0130274  Vali Loss: 0.0102441 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 4.688556671142578
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0127954  Vali Loss: 0.0101620 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 4.707311153411865
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0129748  Vali Loss: 0.0101165 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9052632  Test weighted F1: 0.9015835  Test macro F1 0.9015835 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.273780584335327
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0101458  Vali Loss: 0.0073830 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
Validation loss decreased (inf --> 0.007383).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.260504722595215
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0074507  Vali Loss: 0.0071865 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.007383 --> 0.007187).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.256019115447998
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0074850  Vali Loss: 0.0068512 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.007187 --> 0.006851).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.2779316902160645
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0069261  Vali Loss: 0.0064613 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006851 --> 0.006461).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.257619619369507
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0082938  Vali Loss: 0.0061502 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006461 --> 0.006150).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.271782398223877
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0063161  Vali Loss: 0.0051881 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006150 --> 0.005188).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.253690958023071
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0088064  Vali Loss: 0.0047731 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005188 --> 0.004773).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.270265102386475
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0079034  Vali Loss: 0.0042284 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004773 --> 0.004228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.2589991092681885
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0052149  Vali Loss: 0.0041297 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004228 --> 0.004130).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.246328115463257
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0062912  Vali Loss: 0.0037507 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004130 --> 0.003751).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.258863925933838
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0055729  Vali Loss: 0.0039496 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.236691236495972
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0052942  Vali Loss: 0.0040154 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.263482332229614
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0043529  Vali Loss: 0.0042706 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.246194362640381
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0041896  Vali Loss: 0.0037540 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.259222030639648
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0052857  Vali Loss: 0.0042531 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 6.250513553619385
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0046236  Vali Loss: 0.0044572 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.2389585971832275
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0042857  Vali Loss: 0.0043429 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.259946584701538
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0041937  Vali Loss: 0.0037323 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003751 --> 0.003732).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.241223096847534
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0040959  Vali Loss: 0.0035773 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003732 --> 0.003577).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.257153034210205
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0033369  Vali Loss: 0.0033024 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003577 --> 0.003302).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.245337247848511
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0046871  Vali Loss: 0.0029777 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003302 --> 0.002978).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.256650447845459
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0037736  Vali Loss: 0.0029604 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002978 --> 0.002960).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.249417781829834
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0030224  Vali Loss: 0.0024460 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002960 --> 0.002446).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.239168643951416
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0046863  Vali Loss: 0.0038675 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974988  Vali macro F1 0.9974280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.254735231399536
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0039646  Vali Loss: 0.0027071 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.23900294303894
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0034698  Vali Loss: 0.0026664 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.256618022918701
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0031577  Vali Loss: 0.0025798 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.240297794342041
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0029464  Vali Loss: 0.0024315 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002446 --> 0.002432).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 9.14671516418457
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0045777  Vali Loss: 0.0024160 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002432 --> 0.002416).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 6.247378826141357
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0031629  Vali Loss: 0.0021910 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002416 --> 0.002191).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.235766172409058
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0028294  Vali Loss: 0.0019995 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002191 --> 0.002000).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 6.254258155822754
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0029929  Vali Loss: 0.0018812 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002000 --> 0.001881).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.237978935241699
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0027015  Vali Loss: 0.0023121 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.252667427062988
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0029789  Vali Loss: 0.0021785 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.239949703216553
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0028064  Vali Loss: 0.0018282 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001881 --> 0.001828).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 36 cost time: 6.254745244979858
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0027589  Vali Loss: 0.0018214 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001828 --> 0.001821).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 6.2478954792022705
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0028616  Vali Loss: 0.0019186 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.242211580276489
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0036808  Vali Loss: 0.0021267 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.2573769092559814
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0028785  Vali Loss: 0.0023083 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.236214637756348
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0029216  Vali Loss: 0.0021558 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.258247137069702
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0031092  Vali Loss: 0.0020203 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 42 cost time: 6.244151830673218
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0036871  Vali Loss: 0.0020558 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 43 cost time: 6.259487867355347
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0028887  Vali Loss: 0.0020724 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 44 cost time: 6.251333951950073
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0031037  Vali Loss: 0.0019905 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 45 cost time: 6.246798992156982
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0027626  Vali Loss: 0.0019774 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 46 cost time: 6.255680322647095
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0024932  Vali Loss: 0.0019501 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 47 cost time: 6.241811990737915
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0024654  Vali Loss: 0.0019524 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 48 cost time: 6.2587666511535645
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0027436  Vali Loss: 0.0019553 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 49 cost time: 6.241074085235596
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0027788  Vali Loss: 0.0019377 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 50 cost time: 6.260631799697876
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0027232  Vali Loss: 0.0019260 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 51 cost time: 6.247100830078125
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0026565  Vali Loss: 0.0019316 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9333333  Test weighted F1: 0.9307080  Test macro F1 0.9307080 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.7892632484436035
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3850829  Vali Loss: 1.1968518 Vali Accuracy: 0.8208020  Vali weighted F1: 0.8048840  Vali macro F1 0.8056917 
Validation loss decreased (inf --> 1.196852).  Saving model ...
Epoch: 2 cost time: 4.674484491348267
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8478776  Vali Loss: 0.5018479 Vali Accuracy: 0.9110276  Vali weighted F1: 0.9089290  Vali macro F1 0.9077367 
new best score!!!!
Validation loss decreased (1.196852 --> 0.501848).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.684830904006958
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4184640  Vali Loss: 0.2855818 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9640977  Vali macro F1 0.9620472 
new best score!!!!
Validation loss decreased (0.501848 --> 0.285582).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.677538633346558
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2506737  Vali Loss: 0.1817939 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9734699  Vali macro F1 0.9722496 
new best score!!!!
Validation loss decreased (0.285582 --> 0.181794).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.666449546813965
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1650835  Vali Loss: 0.1322034 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9745083  Vali macro F1 0.9731757 
new best score!!!!
Validation loss decreased (0.181794 --> 0.132203).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.686338186264038
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1106752  Vali Loss: 0.0971916 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9772032  Vali macro F1 0.9761830 
new best score!!!!
Validation loss decreased (0.132203 --> 0.097192).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.666480302810669
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0825991  Vali Loss: 0.0805168 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823029  Vali macro F1 0.9813211 
new best score!!!!
Validation loss decreased (0.097192 --> 0.080517).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.687501668930054
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0713058  Vali Loss: 0.0665937 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899008  Vali macro F1 0.9894649 
new best score!!!!
Validation loss decreased (0.080517 --> 0.066594).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.673058748245239
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0544014  Vali Loss: 0.0578240 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
new best score!!!!
Validation loss decreased (0.066594 --> 0.057824).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.688239097595215
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0469267  Vali Loss: 0.0551881 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887291  Vali macro F1 0.9880930 
new best score!!!!
Validation loss decreased (0.057824 --> 0.055188).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.676485776901245
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0387424  Vali Loss: 0.0468402 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.055188 --> 0.046840).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.669281244277954
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0327542  Vali Loss: 0.0470361 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912241  Vali macro F1 0.9906627 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 4.688854455947876
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0313099  Vali Loss: 0.0453274 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912241  Vali macro F1 0.9906627 
new best score!!!!
Validation loss decreased (0.046840 --> 0.045327).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.66880202293396
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0351215  Vali Loss: 0.0389380 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924714  Vali macro F1 0.9920387 
new best score!!!!
Validation loss decreased (0.045327 --> 0.038938).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.683921813964844
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0287787  Vali Loss: 0.0294435 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.038938 --> 0.029444).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.667912244796753
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0253803  Vali Loss: 0.0344744 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.684074878692627
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0219029  Vali Loss: 0.0347141 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.6761085987091064
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0173960  Vali Loss: 0.0285227 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.029444 --> 0.028523).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.667954921722412
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0192163  Vali Loss: 0.0549385 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836940  Vali macro F1 0.9823654 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 4.689496040344238
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0201154  Vali Loss: 0.0268556 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
new best score!!!!
Validation loss decreased (0.028523 --> 0.026856).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.670841693878174
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0126499  Vali Loss: 0.0224253 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
new best score!!!!
Validation loss decreased (0.026856 --> 0.022425).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 4.68832802772522
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0168091  Vali Loss: 0.0351453 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 4.674875020980835
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0154036  Vali Loss: 0.0267766 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 4.690090894699097
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0268636  Vali Loss: 0.0418880 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887339  Vali macro F1 0.9878471 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 4.68049955368042
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0254697  Vali Loss: 0.0229167 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 4.673075914382935
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0156751  Vali Loss: 0.0312406 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949497  Vali macro F1 0.9947033 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 4.692538022994995
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0140100  Vali Loss: 0.0202431 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.022425 --> 0.020243).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 4.670584440231323
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0112166  Vali Loss: 0.0168913 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.020243 --> 0.016891).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.688753604888916
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0108523  Vali Loss: 0.0173032 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 4.67259955406189
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0097703  Vali Loss: 0.0182041 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 4.690425157546997
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0098870  Vali Loss: 0.0186942 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 4.682425022125244
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0092799  Vali Loss: 0.0179394 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 4.671612501144409
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0090430  Vali Loss: 0.0188391 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 4.6963653564453125
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0096907  Vali Loss: 0.0183791 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 4.677152872085571
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0135251  Vali Loss: 0.0178853 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 4.694582939147949
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0094190  Vali Loss: 0.0170703 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 4.680446147918701
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0092337  Vali Loss: 0.0167899 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.016891 --> 0.016790).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 4.694795846939087
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0085718  Vali Loss: 0.0165336 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.016790 --> 0.016534).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 4.6879565715789795
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0085266  Vali Loss: 0.0163219 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.016534 --> 0.016322).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.6737306118011475
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0085154  Vali Loss: 0.0164990 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.691926717758179
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0081514  Vali Loss: 0.0164181 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.675325632095337
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0089773  Vali Loss: 0.0159936 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.016322 --> 0.015994).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.694314956665039
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0125715  Vali Loss: 0.0157389 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.015994 --> 0.015739).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 4.680088043212891
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0086368  Vali Loss: 0.0146746 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.015739 --> 0.014675).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 4.700444221496582
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0084297  Vali Loss: 0.0145961 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.014675 --> 0.014596).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 4.688886880874634
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0085481  Vali Loss: 0.0149280 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 4.6766676902771
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0084441  Vali Loss: 0.0152656 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 4.695037126541138
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0080936  Vali Loss: 0.0154079 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 4.676383972167969
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0080544  Vali Loss: 0.0155249 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 4.697551727294922
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0087067  Vali Loss: 0.0156353 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 4.681077241897583
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0082771  Vali Loss: 0.0156391 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 4.697894811630249
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0081717  Vali Loss: 0.0155967 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 4.685312509536743
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0077232  Vali Loss: 0.0156018 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 4.676161289215088
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0084382  Vali Loss: 0.0155819 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 4.695951461791992
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0086576  Vali Loss: 0.0155496 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 56 cost time: 4.681422472000122
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0081088  Vali Loss: 0.0155470 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 4.701205492019653
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0092720  Vali Loss: 0.0155439 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 4.681482791900635
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0082568  Vali Loss: 0.0155435 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 4.696303606033325
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0083185  Vali Loss: 0.0155443 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 4.685872793197632
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0084246  Vali Loss: 0.0155413 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8500000  Test weighted F1: 0.8279111  Test macro F1 0.8279111 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.266473770141602
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0082683  Vali Loss: 0.0134977 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
Validation loss decreased (inf --> 0.013498).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.25311803817749
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0088882  Vali Loss: 0.0123508 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
new best score!!!!
Validation loss decreased (0.013498 --> 0.012351).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.268625020980835
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0075209  Vali Loss: 0.0129612 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.25635838508606
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0057631  Vali Loss: 0.0099768 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
new best score!!!!
Validation loss decreased (0.012351 --> 0.009977).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.254365921020508
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0065343  Vali Loss: 0.0094381 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009977 --> 0.009438).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.264340162277222
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0064371  Vali Loss: 0.0140533 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.244061231613159
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0060430  Vali Loss: 0.0087133 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
new best score!!!!
Validation loss decreased (0.009438 --> 0.008713).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.269131898880005
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0058623  Vali Loss: 0.0072439 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.008713 --> 0.007244).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.252789258956909
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0063139  Vali Loss: 0.0119094 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.26363468170166
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0047276  Vali Loss: 0.0074633 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.255785703659058
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0053973  Vali Loss: 0.0072298 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.007244 --> 0.007230).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.245476007461548
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0043736  Vali Loss: 0.0156838 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.266135215759277
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0044118  Vali Loss: 0.0064074 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007230 --> 0.006407).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.246377468109131
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0043845  Vali Loss: 0.0071777 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.266510725021362
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0041088  Vali Loss: 0.0071974 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.247401237487793
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0042083  Vali Loss: 0.0069872 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.263189077377319
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0046413  Vali Loss: 0.0078737 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.252830266952515
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0047407  Vali Loss: 0.0066330 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 6.236950159072876
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0042937  Vali Loss: 0.0060359 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.006407 --> 0.006036).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.250156879425049
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0038148  Vali Loss: 0.0069472 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.235808610916138
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0030941  Vali Loss: 0.0056248 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006036 --> 0.005625).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.25424337387085
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0050047  Vali Loss: 0.0056647 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.23792576789856
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0040961  Vali Loss: 0.0065441 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974913  Vali macro F1 0.9973279 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.2508111000061035
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0040577  Vali Loss: 0.0079274 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974826  Vali macro F1 0.9975775 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.246339559555054
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0038469  Vali Loss: 0.0060132 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.235466480255127
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0037309  Vali Loss: 0.0064791 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.254591226577759
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0031380  Vali Loss: 0.0059262 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.234624862670898
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0032961  Vali Loss: 0.0055818 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.005625 --> 0.005582).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.256463527679443
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0032184  Vali Loss: 0.0055238 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.005582 --> 0.005524).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 6.244537115097046
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0033360  Vali Loss: 0.0054611 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.005524 --> 0.005461).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.260108470916748
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0035970  Vali Loss: 0.0053917 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.005461 --> 0.005392).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 6.244842767715454
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0035238  Vali Loss: 0.0055222 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.232992172241211
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0030246  Vali Loss: 0.0055632 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.256512880325317
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0026380  Vali Loss: 0.0055278 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.240074396133423
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0032028  Vali Loss: 0.0054821 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.262417316436768
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0033683  Vali Loss: 0.0052715 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.005392 --> 0.005271).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 6.245354890823364
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0032515  Vali Loss: 0.0055641 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.257121562957764
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0033905  Vali Loss: 0.0059847 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.249341011047363
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0036951  Vali Loss: 0.0054279 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.2347776889801025
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0026955  Vali Loss: 0.0053587 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.259665489196777
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0028745  Vali Loss: 0.0050464 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.005271 --> 0.005046).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 42 cost time: 6.242809534072876
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0028080  Vali Loss: 0.0049611 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.005046 --> 0.004961).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 43 cost time: 6.259760141372681
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0024692  Vali Loss: 0.0050431 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 6.240087270736694
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0026857  Vali Loss: 0.0051441 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 6.258658170700073
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0028679  Vali Loss: 0.0049162 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004961 --> 0.004916).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 6.249094009399414
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0026234  Vali Loss: 0.0050545 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 47 cost time: 6.241799592971802
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0031272  Vali Loss: 0.0050028 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 48 cost time: 6.255035638809204
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0026954  Vali Loss: 0.0049244 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 49 cost time: 6.234694957733154
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0031338  Vali Loss: 0.0048525 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004916 --> 0.004852).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 6.254977703094482
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0027613  Vali Loss: 0.0047891 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004852 --> 0.004789).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 6.239700555801392
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0033050  Vali Loss: 0.0048771 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 52 cost time: 6.253088712692261
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0026057  Vali Loss: 0.0048662 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 53 cost time: 6.240632772445679
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0029566  Vali Loss: 0.0047924 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 54 cost time: 6.23670768737793
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0023892  Vali Loss: 0.0047342 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004789 --> 0.004734).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 55 cost time: 6.259697675704956
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0028013  Vali Loss: 0.0046143 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004734 --> 0.004614).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 56 cost time: 6.241168022155762
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0030371  Vali Loss: 0.0046071 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004614 --> 0.004607).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 57 cost time: 6.257334232330322
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0035034  Vali Loss: 0.0046017 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004607 --> 0.004602).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 58 cost time: 6.239760160446167
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0026103  Vali Loss: 0.0046077 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 59 cost time: 6.257462978363037
Fine Tuning VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0029044  Vali Loss: 0.0046471 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 60 cost time: 6.243741750717163
Fine Tuning VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0027769  Vali Loss: 0.0046063 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 61 cost time: 6.236786127090454
Fine Tuning VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0031213  Vali Loss: 0.0046037 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 62 cost time: 6.251984119415283
Fine Tuning VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0026292  Vali Loss: 0.0045169 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004602 --> 0.004517).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 63 cost time: 7.454220771789551
Fine Tuning VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0031840  Vali Loss: 0.0045023 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004517 --> 0.004502).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 64 cost time: 6.259367227554321
Fine Tuning VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0028010  Vali Loss: 0.0043373 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.004502 --> 0.004337).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 65 cost time: 6.239585638046265
Fine Tuning VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0023334  Vali Loss: 0.0044001 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 66 cost time: 6.25272011756897
Fine Tuning VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0024152  Vali Loss: 0.0045683 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 67 cost time: 6.244859457015991
Fine Tuning VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0028000  Vali Loss: 0.0044754 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 68 cost time: 6.233330488204956
Fine Tuning VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0024972  Vali Loss: 0.0045352 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 69 cost time: 6.255324602127075
Fine Tuning VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0027549  Vali Loss: 0.0046097 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 70 cost time: 6.237401247024536
Fine Tuning VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0029936  Vali Loss: 0.0046117 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 71 cost time: 6.259975433349609
Fine Tuning VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0026391  Vali Loss: 0.0046096 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 72 cost time: 6.239865064620972
Fine Tuning VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0031692  Vali Loss: 0.0045834 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 73 cost time: 6.256713628768921
Fine Tuning VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0023422  Vali Loss: 0.0045627 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 74 cost time: 6.244885206222534
Fine Tuning VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0035394  Vali Loss: 0.0045787 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 75 cost time: 6.235393047332764
Fine Tuning VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0028092  Vali Loss: 0.0045815 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 76 cost time: 6.25253963470459
Fine Tuning VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0025132  Vali Loss: 0.0045821 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 77 cost time: 6.2359840869903564
Fine Tuning VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0022053  Vali Loss: 0.0045833 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 78 cost time: 6.256350994110107
Fine Tuning VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0023072  Vali Loss: 0.0045829 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 79 cost time: 6.242218732833862
Fine Tuning VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0030721  Vali Loss: 0.0045819 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8359649  Test weighted F1: 0.8092680  Test macro F1 0.8092680 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.797368049621582
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.4225063  Vali Loss: 1.2503774 Vali Accuracy: 0.7593985  Vali weighted F1: 0.7443452  Vali macro F1 0.7476226 
Validation loss decreased (inf --> 1.250377).  Saving model ...
Epoch: 2 cost time: 4.665872812271118
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8691911  Vali Loss: 0.5157446 Vali Accuracy: 0.9035088  Vali weighted F1: 0.9010369  Vali macro F1 0.8993916 
new best score!!!!
Validation loss decreased (1.250377 --> 0.515745).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.681132555007935
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4239154  Vali Loss: 0.2974928 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9623752  Vali macro F1 0.9611505 
new best score!!!!
Validation loss decreased (0.515745 --> 0.297493).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.669982433319092
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2557172  Vali Loss: 0.1750482 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9774414  Vali macro F1 0.9760219 
new best score!!!!
Validation loss decreased (0.297493 --> 0.175048).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.684061765670776
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1720122  Vali Loss: 0.1259326 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837382  Vali macro F1 0.9826669 
new best score!!!!
Validation loss decreased (0.175048 --> 0.125933).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.677526235580444
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1190624  Vali Loss: 0.0919035 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888342  Vali macro F1 0.9877405 
new best score!!!!
Validation loss decreased (0.125933 --> 0.091903).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.664674758911133
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0857598  Vali Loss: 0.0801352 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900906  Vali macro F1 0.9891211 
new best score!!!!
Validation loss decreased (0.091903 --> 0.080135).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.686037063598633
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0684997  Vali Loss: 0.0637598 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900634  Vali macro F1 0.9894197 
new best score!!!!
Validation loss decreased (0.080135 --> 0.063760).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.663211822509766
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0548736  Vali Loss: 0.0569570 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900866  Vali macro F1 0.9892009 
new best score!!!!
Validation loss decreased (0.063760 --> 0.056957).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.690406560897827
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0453548  Vali Loss: 0.0564412 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888542  Vali macro F1 0.9878626 
new best score!!!!
Validation loss decreased (0.056957 --> 0.056441).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.664901971817017
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0377896  Vali Loss: 0.0423776 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912907  Vali macro F1 0.9905408 
new best score!!!!
Validation loss decreased (0.056441 --> 0.042378).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.684680700302124
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0313848  Vali Loss: 0.0361460 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.042378 --> 0.036146).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.672099828720093
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0317816  Vali Loss: 0.0358687 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.036146 --> 0.035869).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 4.668382167816162
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0278370  Vali Loss: 0.0303568 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.035869 --> 0.030357).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.682774305343628
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0277808  Vali Loss: 0.0268310 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937827  Vali macro F1 0.9932992 
new best score!!!!
Validation loss decreased (0.030357 --> 0.026831).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.669877052307129
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0237482  Vali Loss: 0.0322432 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.68429970741272
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0234753  Vali Loss: 0.0411794 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.6726508140563965
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0190903  Vali Loss: 0.0313401 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912999  Vali macro F1 0.9906764 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 4.68560528755188
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0151772  Vali Loss: 0.0203530 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950171  Vali macro F1 0.9947001 
new best score!!!!
Validation loss decreased (0.026831 --> 0.020353).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.68181037902832
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0157076  Vali Loss: 0.0180884 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.020353 --> 0.018088).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.666029691696167
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0120295  Vali Loss: 0.0278346 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925521  Vali macro F1 0.9919649 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.694424152374268
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0131421  Vali Loss: 0.0183134 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950171  Vali macro F1 0.9946729 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.66616678237915
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0119605  Vali Loss: 0.0333711 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 4.689346790313721
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0125470  Vali Loss: 0.0162467 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.018088 --> 0.016247).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.671788454055786
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0111686  Vali Loss: 0.0227331 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.690872430801392
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0161205  Vali Loss: 0.1415298 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9492554  Vali macro F1 0.9540537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.674680471420288
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0330134  Vali Loss: 0.0224030 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 4.672552108764648
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0137181  Vali Loss: 0.0124816 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.016247 --> 0.012482).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 4.686846017837524
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0104706  Vali Loss: 0.0120595 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.012482 --> 0.012060).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 4.673253297805786
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0132676  Vali Loss: 0.0119308 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975015  Vali macro F1 0.9974289 
new best score!!!!
Validation loss decreased (0.012060 --> 0.011931).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 4.684858083724976
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0126121  Vali Loss: 0.0168572 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937829  Vali macro F1 0.9931337 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 4.674870252609253
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0091274  Vali Loss: 0.0062043 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011931 --> 0.006204).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 4.690418481826782
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0108303  Vali Loss: 0.0229591 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937810  Vali macro F1 0.9931012 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 4.679598569869995
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0102546  Vali Loss: 0.0085947 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 4.668519020080566
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0092548  Vali Loss: 0.0199521 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937481  Vali macro F1 0.9940077 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 4.690530776977539
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0152041  Vali Loss: 0.0146371 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 4.6713879108428955
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0080905  Vali Loss: 0.0129777 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 4.693484306335449
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0060928  Vali Loss: 0.0098581 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 4.6737799644470215
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0064824  Vali Loss: 0.0089335 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 4.693395614624023
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0059344  Vali Loss: 0.0093528 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 4.678524494171143
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0052457  Vali Loss: 0.0072864 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 4.676229476928711
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0050657  Vali Loss: 0.0063987 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 4.693093776702881
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0082363  Vali Loss: 0.0064254 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.679610013961792
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0049239  Vali Loss: 0.0060539 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006204 --> 0.006054).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 4.69303297996521
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0046976  Vali Loss: 0.0060515 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006054 --> 0.006052).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 4.679095506668091
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0050894  Vali Loss: 0.0060409 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006052 --> 0.006041).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 4.689523935317993
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0050130  Vali Loss: 0.0060676 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 4.685347557067871
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0051127  Vali Loss: 0.0060627 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 4.670161247253418
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0043935  Vali Loss: 0.0060649 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 4.6943583488464355
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0049904  Vali Loss: 0.0060828 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 4.669328689575195
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0045462  Vali Loss: 0.0061279 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 4.699987411499023
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0050834  Vali Loss: 0.0061232 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 4.672401666641235
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0049749  Vali Loss: 0.0061373 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 4.693300724029541
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0048504  Vali Loss: 0.0061370 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 4.676760911941528
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0050580  Vali Loss: 0.0061335 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 4.6728675365448
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0046828  Vali Loss: 0.0061370 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 57 cost time: 4.68693208694458
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0050271  Vali Loss: 0.0061369 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 4.669858694076538
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0046179  Vali Loss: 0.0061368 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 4.682251214981079
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0046617  Vali Loss: 0.0061371 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 4.670674085617065
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0047606  Vali Loss: 0.0061375 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 4.682491302490234
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0047416  Vali Loss: 0.0061375 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8315789  Test weighted F1: 0.7876950  Test macro F1 0.7876950 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.258470058441162
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0053317  Vali Loss: 0.0075385 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
Validation loss decreased (inf --> 0.007539).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.273531436920166
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0042118  Vali Loss: 0.0049357 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007539 --> 0.004936).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.263155698776245
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0037819  Vali Loss: 0.0049512 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.276516914367676
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0034776  Vali Loss: 0.0045092 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004936 --> 0.004509).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.2644736766815186
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0042144  Vali Loss: 0.0042162 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004509 --> 0.004216).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.256298542022705
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0032139  Vali Loss: 0.0038500 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004216 --> 0.003850).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.2745137214660645
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0036143  Vali Loss: 0.0036955 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003850 --> 0.003696).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.256364107131958
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0034533  Vali Loss: 0.0035947 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003696 --> 0.003595).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.271871089935303
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031503  Vali Loss: 0.0038568 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.256681442260742
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0032705  Vali Loss: 0.0039375 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.273825645446777
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0025006  Vali Loss: 0.0039609 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.268898010253906
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0026237  Vali Loss: 0.0029394 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003595 --> 0.002939).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.253023386001587
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0025479  Vali Loss: 0.0040591 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.275378942489624
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0027175  Vali Loss: 0.0031543 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.254596948623657
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0024981  Vali Loss: 0.0052969 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.274643421173096
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0028459  Vali Loss: 0.0030803 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.2592902183532715
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0027853  Vali Loss: 0.0027673 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002939 --> 0.002767).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.274871110916138
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0026317  Vali Loss: 0.0036628 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.261364936828613
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0024529  Vali Loss: 0.0027850 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.253193378448486
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0019975  Vali Loss: 0.0021678 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002767 --> 0.002168).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.271812200546265
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0026852  Vali Loss: 0.0022152 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.251427888870239
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0023045  Vali Loss: 0.0022966 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.268904447555542
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0023988  Vali Loss: 0.0029375 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.255455732345581
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0022241  Vali Loss: 0.0026037 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.267876863479614
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0021803  Vali Loss: 0.0035183 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974761  Vali macro F1 0.9971110 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 26 cost time: 6.26361608505249
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0024109  Vali Loss: 0.0027785 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.253894090652466
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0019596  Vali Loss: 0.0029335 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.278292417526245
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0019119  Vali Loss: 0.0029296 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.2531960010528564
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0021873  Vali Loss: 0.0024477 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.275197505950928
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0020705  Vali Loss: 0.0027306 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 6.255428791046143
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0022066  Vali Loss: 0.0024676 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.27494215965271
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0017822  Vali Loss: 0.0024454 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.265270471572876
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0017190  Vali Loss: 0.0024175 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.25603723526001
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0016297  Vali Loss: 0.0024939 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.272570371627808
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0016487  Vali Loss: 0.0023874 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8929825  Test weighted F1: 0.8677576  Test macro F1 0.8677576 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.800044536590576
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3857448  Vali Loss: 1.1835397 Vali Accuracy: 0.8007519  Vali weighted F1: 0.7914433  Vali macro F1 0.7926723 
Validation loss decreased (inf --> 1.183540).  Saving model ...
Epoch: 2 cost time: 4.695766925811768
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8376601  Vali Loss: 0.5087642 Vali Accuracy: 0.9135338  Vali weighted F1: 0.9104146  Vali macro F1 0.9097276 
new best score!!!!
Validation loss decreased (1.183540 --> 0.508764).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.6856749057769775
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4115371  Vali Loss: 0.2819324 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9638904  Vali macro F1 0.9618367 
new best score!!!!
Validation loss decreased (0.508764 --> 0.281932).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.701075315475464
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2473524  Vali Loss: 0.1813067 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9695082  Vali macro F1 0.9681257 
new best score!!!!
Validation loss decreased (0.281932 --> 0.181307).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.684766530990601
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1626272  Vali Loss: 0.1202528 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9819871  Vali macro F1 0.9810604 
new best score!!!!
Validation loss decreased (0.181307 --> 0.120253).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.702389717102051
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1113068  Vali Loss: 0.0863187 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849818  Vali macro F1 0.9839587 
new best score!!!!
Validation loss decreased (0.120253 --> 0.086319).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.685986757278442
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0871707  Vali Loss: 0.0768611 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9820915  Vali macro F1 0.9810028 
new best score!!!!
Validation loss decreased (0.086319 --> 0.076861).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.701875448226929
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0680189  Vali Loss: 0.0557384 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874817  Vali macro F1 0.9863194 
new best score!!!!
Validation loss decreased (0.076861 --> 0.055738).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.692812919616699
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0543961  Vali Loss: 0.0462275 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
new best score!!!!
Validation loss decreased (0.055738 --> 0.046228).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.686236143112183
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0478741  Vali Loss: 0.0522423 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810244  Vali macro F1 0.9797654 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 4.704571723937988
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0441592  Vali Loss: 0.0330694 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
new best score!!!!
Validation loss decreased (0.046228 --> 0.033069).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.687115907669067
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0385630  Vali Loss: 0.0336800 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898754  Vali macro F1 0.9892201 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 4.706177473068237
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0389555  Vali Loss: 0.0382732 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872345  Vali macro F1 0.9865659 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 4.691067218780518
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0328175  Vali Loss: 0.0362905 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886440  Vali macro F1 0.9884011 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 4.7022624015808105
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0355224  Vali Loss: 0.0180799 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.033069 --> 0.018080).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.69568657875061
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0243917  Vali Loss: 0.0190495 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 4.684563159942627
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0262637  Vali Loss: 0.0223769 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949754  Vali macro F1 0.9945862 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 4.7051496505737305
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0241128  Vali Loss: 0.0174520 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.018080 --> 0.017452).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.685320854187012
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0233284  Vali Loss: 0.0255909 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912322  Vali macro F1 0.9904566 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 4.706209659576416
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0287055  Vali Loss: 0.0229138 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 4.69111704826355
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0239776  Vali Loss: 0.0199326 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 4.7075653076171875
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0196092  Vali Loss: 0.0193888 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950060  Vali macro F1 0.9948766 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 4.698026657104492
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0162316  Vali Loss: 0.0101666 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.017452 --> 0.010167).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 4.691946268081665
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0140414  Vali Loss: 0.0103256 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 4.710391521453857
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0121481  Vali Loss: 0.0081641 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010167 --> 0.008164).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 4.6917266845703125
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0112092  Vali Loss: 0.0075584 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.008164 --> 0.007558).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 4.711814880371094
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0106168  Vali Loss: 0.0097505 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962046  Vali macro F1 0.9962288 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 4.695260524749756
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0131520  Vali Loss: 0.0126390 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949333  Vali macro F1 0.9948033 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 4.710794448852539
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0120135  Vali Loss: 0.0088808 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974847  Vali macro F1 0.9973982 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 4.69849157333374
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0101740  Vali Loss: 0.0111779 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 4.688992738723755
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0170284  Vali Loss: 0.0169014 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924746  Vali macro F1 0.9920539 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 4.70982813835144
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0137975  Vali Loss: 0.0087385 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974847  Vali macro F1 0.9973982 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 4.691437721252441
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0099784  Vali Loss: 0.0073788 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974847  Vali macro F1 0.9973982 
new best score!!!!
Validation loss decreased (0.007558 --> 0.007379).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 4.71469259262085
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0088535  Vali Loss: 0.0074811 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974847  Vali macro F1 0.9973982 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 4.692765712738037
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0076151  Vali Loss: 0.0060681 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974847  Vali macro F1 0.9973982 
new best score!!!!
Validation loss decreased (0.007379 --> 0.006068).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.70916748046875
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0079896  Vali Loss: 0.0049969 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006068 --> 0.004997).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 4.700101613998413
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0075129  Vali Loss: 0.0049274 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004997 --> 0.004927).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 4.691447734832764
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0070898  Vali Loss: 0.0047390 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004927 --> 0.004739).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 4.711341381072998
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0063771  Vali Loss: 0.0045965 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004739 --> 0.004596).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 4.6923558712005615
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0068485  Vali Loss: 0.0049165 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.713813066482544
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0064706  Vali Loss: 0.0055435 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 4.694479942321777
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0057855  Vali Loss: 0.0058134 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 4.710008859634399
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0063149  Vali Loss: 0.0043184 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004596 --> 0.004318).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 4.701426982879639
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0058587  Vali Loss: 0.0066591 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 4.692217588424683
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0068170  Vali Loss: 0.0041629 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004318 --> 0.004163).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 4.708690404891968
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0058740  Vali Loss: 0.0043584 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 4.689411401748657
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0064075  Vali Loss: 0.0040333 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004163 --> 0.004033).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 4.707194566726685
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0051517  Vali Loss: 0.0038901 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004033 --> 0.003890).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 4.695066928863525
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0055562  Vali Loss: 0.0039191 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 4.70812201499939
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0057228  Vali Loss: 0.0040524 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 4.701814651489258
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0054149  Vali Loss: 0.0039501 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 4.690987825393677
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0053697  Vali Loss: 0.0038459 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003890 --> 0.003846).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 4.710982799530029
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0054416  Vali Loss: 0.0039553 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 4.692626237869263
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0054918  Vali Loss: 0.0041796 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 4.710702657699585
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0057107  Vali Loss: 0.0040060 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 4.694869041442871
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0056970  Vali Loss: 0.0064079 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 4.712322950363159
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0055417  Vali Loss: 0.0065710 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 58 cost time: 4.70204758644104
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0048353  Vali Loss: 0.0062888 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 4.693463325500488
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0050038  Vali Loss: 0.0060290 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 4.706693172454834
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0045165  Vali Loss: 0.0057390 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 4.69049596786499
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0046836  Vali Loss: 0.0055427 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 4.712791919708252
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0047319  Vali Loss: 0.0051973 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 63 cost time: 4.696346998214722
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0050067  Vali Loss: 0.0051807 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 4.713740348815918
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0049715  Vali Loss: 0.0051757 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 4.701368808746338
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0046462  Vali Loss: 0.0052096 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 4.691269159317017
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0045966  Vali Loss: 0.0052176 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 4.711139917373657
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0048252  Vali Loss: 0.0052182 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9342105  Test weighted F1: 0.9311510  Test macro F1 0.9311510 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.305734395980835
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0057851  Vali Loss: 0.0034519 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
Validation loss decreased (inf --> 0.003452).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3012168407440186
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0063002  Vali Loss: 0.0063855 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974958  Vali macro F1 0.9974224 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.2935662269592285
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0046175  Vali Loss: 0.0033225 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003452 --> 0.003323).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.311912298202515
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0060258  Vali Loss: 0.0030739 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003323 --> 0.003074).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.291947841644287
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0045618  Vali Loss: 0.0030257 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003074 --> 0.003026).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.305131196975708
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0045625  Vali Loss: 0.0029098 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003026 --> 0.002910).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.289006233215332
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0039176  Vali Loss: 0.0029324 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.3215906620025635
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0040431  Vali Loss: 0.0024965 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002910 --> 0.002496).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.309301853179932
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0036554  Vali Loss: 0.0023197 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002496 --> 0.002320).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.295876502990723
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0037760  Vali Loss: 0.0035712 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974968  Vali macro F1 0.9974357 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.308006286621094
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0029936  Vali Loss: 0.0032711 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974968  Vali macro F1 0.9974357 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.292858123779297
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0026469  Vali Loss: 0.0032170 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.31315016746521
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0037803  Vali Loss: 0.0068729 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974844  Vali macro F1 0.9974260 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.302979946136475
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0033495  Vali Loss: 0.0030960 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 6.326071739196777
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0036401  Vali Loss: 0.0026844 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.314594507217407
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0034673  Vali Loss: 0.0020165 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002320 --> 0.002017).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.296934127807617
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0034884  Vali Loss: 0.0029570 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.301350831985474
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0042590  Vali Loss: 0.0028019 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.292297601699829
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0035998  Vali Loss: 0.0024605 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.299615859985352
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0034156  Vali Loss: 0.0020107 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002017 --> 0.002011).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.294776916503906
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0031557  Vali Loss: 0.0017903 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002011 --> 0.001790).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.314626693725586
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0026579  Vali Loss: 0.0017416 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001790 --> 0.001742).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.303629159927368
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0023921  Vali Loss: 0.0017470 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.292160511016846
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0027236  Vali Loss: 0.0014041 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001742 --> 0.001404).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.309175252914429
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0026981  Vali Loss: 0.0030067 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.289637327194214
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0030142  Vali Loss: 0.0018951 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.297787189483643
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0023214  Vali Loss: 0.0019376 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.2939293384552
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0023948  Vali Loss: 0.0016162 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.3005759716033936
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0024663  Vali Loss: 0.0026470 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 30 cost time: 6.297255754470825
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0032511  Vali Loss: 0.0018296 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.292462348937988
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0025145  Vali Loss: 0.0016860 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.316356420516968
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0026872  Vali Loss: 0.0016384 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.299336671829224
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0021912  Vali Loss: 0.0016403 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.310904264450073
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0017895  Vali Loss: 0.0016188 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 35 cost time: 6.290385723114014
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0021417  Vali Loss: 0.0016197 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 6.301641941070557
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0017008  Vali Loss: 0.0016231 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 6.294639825820923
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0024536  Vali Loss: 0.0016379 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 6.290935754776001
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0020849  Vali Loss: 0.0016300 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 6.3008973598480225
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0023201  Vali Loss: 0.0016402 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9131579  Test weighted F1: 0.8965045  Test macro F1 0.8965045 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.764924764633179
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3745609  Vali Loss: 1.1690752 Vali Accuracy: 0.8145363  Vali weighted F1: 0.8006612  Vali macro F1 0.7994153 
Validation loss decreased (inf --> 1.169075).  Saving model ...
Epoch: 2 cost time: 4.673327684402466
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8403544  Vali Loss: 0.5066828 Vali Accuracy: 0.9122807  Vali weighted F1: 0.9124720  Vali macro F1 0.9101441 
new best score!!!!
Validation loss decreased (1.169075 --> 0.506683).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.660917282104492
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.4274232  Vali Loss: 0.2929348 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9593162  Vali macro F1 0.9557517 
new best score!!!!
Validation loss decreased (0.506683 --> 0.292935).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.6805219650268555
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2699439  Vali Loss: 0.1988258 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9589965  Vali macro F1 0.9559642 
new best score!!!!
Validation loss decreased (0.292935 --> 0.198826).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.660345554351807
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1798033  Vali Loss: 0.1455933 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9682003  Vali macro F1 0.9658303 
new best score!!!!
Validation loss decreased (0.198826 --> 0.145593).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.679736614227295
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1298123  Vali Loss: 0.1132076 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9814678  Vali macro F1 0.9799066 
new best score!!!!
Validation loss decreased (0.145593 --> 0.113208).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.659911394119263
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0998810  Vali Loss: 0.0898768 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9824914  Vali macro F1 0.9812200 
new best score!!!!
Validation loss decreased (0.113208 --> 0.089877).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.67535924911499
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0735251  Vali Loss: 0.0687491 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900661  Vali macro F1 0.9891587 
new best score!!!!
Validation loss decreased (0.089877 --> 0.068749).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.667826175689697
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0609868  Vali Loss: 0.0671076 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875120  Vali macro F1 0.9864017 
new best score!!!!
Validation loss decreased (0.068749 --> 0.067108).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.662297964096069
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0622772  Vali Loss: 0.0590210 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888551  Vali macro F1 0.9875985 
new best score!!!!
Validation loss decreased (0.067108 --> 0.059021).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.679182291030884
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0535548  Vali Loss: 0.0544973 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899778  Vali macro F1 0.9892107 
new best score!!!!
Validation loss decreased (0.059021 --> 0.054497).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 4.662911653518677
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0415530  Vali Loss: 0.0537431 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912273  Vali macro F1 0.9906361 
new best score!!!!
Validation loss decreased (0.054497 --> 0.053743).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 4.684230089187622
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0363941  Vali Loss: 0.0554432 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862268  Vali macro F1 0.9849865 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 4.666777849197388
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0335561  Vali Loss: 0.0417907 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9891114 
new best score!!!!
Validation loss decreased (0.053743 --> 0.041791).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.683556318283081
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0298029  Vali Loss: 0.0383829 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913199  Vali macro F1 0.9905835 
new best score!!!!
Validation loss decreased (0.041791 --> 0.038383).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.672466516494751
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0251736  Vali Loss: 0.0328839 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925300  Vali macro F1 0.9918702 
new best score!!!!
Validation loss decreased (0.038383 --> 0.032884).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.666308164596558
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0219024  Vali Loss: 0.0327534 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.032884 --> 0.032753).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.685432434082031
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0194377  Vali Loss: 0.0296601 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925527  Vali macro F1 0.9916333 
new best score!!!!
Validation loss decreased (0.032753 --> 0.029660).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.670234203338623
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0209499  Vali Loss: 0.0464671 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912954  Vali macro F1 0.9901905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 4.687283992767334
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0205253  Vali Loss: 0.0179972 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9956960 
new best score!!!!
Validation loss decreased (0.029660 --> 0.017997).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 4.669768810272217
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0157450  Vali Loss: 0.0275027 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 4.694683313369751
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0169291  Vali Loss: 0.0267672 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925527  Vali macro F1 0.9916333 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 4.680341005325317
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0135404  Vali Loss: 0.0215499 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937825  Vali macro F1 0.9929932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 4.670536518096924
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0119275  Vali Loss: 0.0198756 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 4.690389633178711
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0183880  Vali Loss: 0.0362961 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861153  Vali macro F1 0.9848457 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 4.670614004135132
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0166825  Vali Loss: 0.0268551 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900433  Vali macro F1 0.9890024 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 4.690274000167847
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0145148  Vali Loss: 0.0252107 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913005  Vali macro F1 0.9904452 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 4.669626235961914
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0133020  Vali Loss: 0.0236561 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937825  Vali macro F1 0.9929932 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 4.6879167556762695
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0128180  Vali Loss: 0.0245853 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937825  Vali macro F1 0.9929932 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 4.680488109588623
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0123875  Vali Loss: 0.0238943 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 4.67210054397583
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0120816  Vali Loss: 0.0236635 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 4.689395904541016
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0110928  Vali Loss: 0.0234348 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 4.671763181686401
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0113195  Vali Loss: 0.0233770 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 4.69060754776001
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0114231  Vali Loss: 0.0231620 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 4.6727728843688965
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0194585  Vali Loss: 0.0229976 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9078947  Test weighted F1: 0.8879270  Test macro F1 0.8879270 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.286248683929443
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0160787  Vali Loss: 0.0180694 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
Validation loss decreased (inf --> 0.018069).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.26657772064209
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0131742  Vali Loss: 0.0210075 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.284479856491089
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0133236  Vali Loss: 0.0224610 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.269355297088623
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0119931  Vali Loss: 0.0211705 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.284093856811523
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0119849  Vali Loss: 0.0187035 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.277567386627197
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0107775  Vali Loss: 0.0232379 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937825  Vali macro F1 0.9929932 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.264561653137207
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0104501  Vali Loss: 0.0142720 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
new best score!!!!
Validation loss decreased (0.018069 --> 0.014272).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.287113189697266
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0114463  Vali Loss: 0.0183073 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.265806436538696
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0098710  Vali Loss: 0.0208170 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.284605503082275
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0093757  Vali Loss: 0.0203976 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.2725958824157715
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0087597  Vali Loss: 0.0187418 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937825  Vali macro F1 0.9929932 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.282848119735718
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0091387  Vali Loss: 0.0183908 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.277354001998901
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0080982  Vali Loss: 0.0179454 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.261871337890625
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0082027  Vali Loss: 0.0181137 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.290143728256226
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0086910  Vali Loss: 0.0181221 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.267943620681763
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0084758  Vali Loss: 0.0180028 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.284298896789551
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0080386  Vali Loss: 0.0185174 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 18 cost time: 6.268249750137329
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0078815  Vali Loss: 0.0183980 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.281898260116577
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0090930  Vali Loss: 0.0182938 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.276675462722778
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0089375  Vali Loss: 0.0183429 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.269834041595459
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0079598  Vali Loss: 0.0183011 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.289196729660034
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0085390  Vali Loss: 0.0182070 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9122807  Test weighted F1: 0.8926150  Test macro F1 0.8926150 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 4.8201682567596436
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.3781051  Vali Loss: 1.2284966 Vali Accuracy: 0.8020050  Vali weighted F1: 0.7940935  Vali macro F1 0.7945235 
Validation loss decreased (inf --> 1.228497).  Saving model ...
Epoch: 2 cost time: 4.6950225830078125
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.8247910  Vali Loss: 0.5026876 Vali Accuracy: 0.9323308  Vali weighted F1: 0.9283709  Vali macro F1 0.9279082 
new best score!!!!
Validation loss decreased (1.228497 --> 0.502688).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 4.672460556030273
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.3919048  Vali Loss: 0.2762498 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9694756  Vali macro F1 0.9688181 
new best score!!!!
Validation loss decreased (0.502688 --> 0.276250).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 4.7063679695129395
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.2298998  Vali Loss: 0.1757824 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9757608  Vali macro F1 0.9748685 
new best score!!!!
Validation loss decreased (0.276250 --> 0.175782).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 4.670385122299194
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.1522309  Vali Loss: 0.1187177 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846888  Vali macro F1 0.9842538 
new best score!!!!
Validation loss decreased (0.175782 --> 0.118718).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 4.704946756362915
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.1074692  Vali Loss: 0.0812402 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872928  Vali macro F1 0.9866673 
new best score!!!!
Validation loss decreased (0.118718 --> 0.081240).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 4.67382287979126
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0851973  Vali Loss: 0.0640307 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847259  Vali macro F1 0.9838935 
new best score!!!!
Validation loss decreased (0.081240 --> 0.064031).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 4.705467939376831
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0624928  Vali Loss: 0.0630218 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821797  Vali macro F1 0.9815145 
new best score!!!!
Validation loss decreased (0.064031 --> 0.063022).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 4.676942348480225
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0521306  Vali Loss: 0.0472901 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898504  Vali macro F1 0.9896300 
new best score!!!!
Validation loss decreased (0.063022 --> 0.047290).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 4.686453342437744
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0420580  Vali Loss: 0.0363209 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899037  Vali macro F1 0.9894441 
new best score!!!!
Validation loss decreased (0.047290 --> 0.036321).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 4.687225103378296
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0375664  Vali Loss: 0.0369787 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937440  Vali macro F1 0.9939252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 4.682622194290161
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0340004  Vali Loss: 0.0460711 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861201  Vali macro F1 0.9852205 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 4.688262224197388
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0418983  Vali Loss: 0.0385208 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924553  Vali macro F1 0.9922311 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 4.684782028198242
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0267765  Vali Loss: 0.0264803 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924401  Vali macro F1 0.9922390 
new best score!!!!
Validation loss decreased (0.036321 --> 0.026480).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 4.687496662139893
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0291905  Vali Loss: 0.0186634 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949652  Vali macro F1 0.9950893 
new best score!!!!
Validation loss decreased (0.026480 --> 0.018663).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 4.691858291625977
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0192413  Vali Loss: 0.0170258 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962397  Vali macro F1 0.9962759 
new best score!!!!
Validation loss decreased (0.018663 --> 0.017026).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 4.669236421585083
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0200919  Vali Loss: 0.0167952 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
new best score!!!!
Validation loss decreased (0.017026 --> 0.016795).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 4.702942132949829
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0173475  Vali Loss: 0.0151440 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
new best score!!!!
Validation loss decreased (0.016795 --> 0.015144).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 4.666266202926636
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0142324  Vali Loss: 0.0120728 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.015144 --> 0.012073).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 4.704832553863525
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0122247  Vali Loss: 0.0126118 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974920  Vali macro F1 0.9974491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 4.669964790344238
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0137202  Vali Loss: 0.0156935 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962421  Vali macro F1 0.9965301 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 4.70255708694458
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0177989  Vali Loss: 0.0178691 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987478  Vali macro F1 0.9987115 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 4.674622297286987
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0182268  Vali Loss: 0.0137355 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 4.683044672012329
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0110744  Vali Loss: 0.0097518 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9976150 
new best score!!!!
Validation loss decreased (0.012073 --> 0.009752).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 4.685729503631592
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0102797  Vali Loss: 0.0285902 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949978  Vali macro F1 0.9943247 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 4.68134069442749
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0108302  Vali Loss: 0.0128761 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 4.688705682754517
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0076183  Vali Loss: 0.0099385 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974920  Vali macro F1 0.9974491 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 4.686788558959961
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0077149  Vali Loss: 0.0157098 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937193  Vali macro F1 0.9936421 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 4.689619064331055
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0100305  Vali Loss: 0.0889243 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9693147  Vali macro F1 0.9721504 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 4.6973350048065186
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0202166  Vali Loss: 0.0144610 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962563  Vali macro F1 0.9962291 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.671542644500732
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0069619  Vali Loss: 0.0119440 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962563  Vali macro F1 0.9962291 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 4.706156969070435
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0056604  Vali Loss: 0.0110639 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962563  Vali macro F1 0.9962291 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 4.672654628753662
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0055874  Vali Loss: 0.0105440 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950138  Vali macro F1 0.9950172 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 4.705094814300537
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0054251  Vali Loss: 0.0093007 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.009752 --> 0.009301).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 4.676236629486084
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0054494  Vali Loss: 0.0090984 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.009301 --> 0.009098).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 4.706518888473511
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0049921  Vali Loss: 0.0089324 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.009098 --> 0.008932).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 4.680253982543945
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0045777  Vali Loss: 0.0087617 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.008932 --> 0.008762).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 4.6866114139556885
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0045396  Vali Loss: 0.0088666 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962284  Vali macro F1 0.9964514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 4.690065860748291
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0041011  Vali Loss: 0.0087838 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962284  Vali macro F1 0.9964514 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 4.684277057647705
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0046004  Vali Loss: 0.0083967 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962284  Vali macro F1 0.9964514 
new best score!!!!
Validation loss decreased (0.008762 --> 0.008397).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 4.692274808883667
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0041962  Vali Loss: 0.0085476 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962284  Vali macro F1 0.9964514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 4.689971446990967
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0042903  Vali Loss: 0.0080818 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.008397 --> 0.008082).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 4.695721387863159
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0042253  Vali Loss: 0.0081465 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 4.696532726287842
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0043012  Vali Loss: 0.0080628 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
new best score!!!!
Validation loss decreased (0.008082 --> 0.008063).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 4.6809141635894775
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0041219  Vali Loss: 0.0081259 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 4.709209203720093
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0052997  Vali Loss: 0.0091474 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962284  Vali macro F1 0.9964514 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 4.67439341545105
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0046663  Vali Loss: 0.0084166 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 4.710141897201538
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0040504  Vali Loss: 0.0081823 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 4.677076816558838
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0039383  Vali Loss: 0.0082717 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 4.707083463668823
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0037750  Vali Loss: 0.0082763 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 4.682241201400757
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0036799  Vali Loss: 0.0082710 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 4.689122915267944
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0036169  Vali Loss: 0.0082618 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 4.696375608444214
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0037433  Vali Loss: 0.0082485 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 4.689792156219482
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0040075  Vali Loss: 0.0082472 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 4.695515155792236
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0037468  Vali Loss: 0.0082479 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 4.695010662078857
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0035485  Vali Loss: 0.0082447 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 4.696152925491333
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0039355  Vali Loss: 0.0082438 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 4.7001025676727295
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0037345  Vali Loss: 0.0082405 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 4.674098014831543
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0038727  Vali Loss: 0.0082379 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8333333  Test weighted F1: 0.8084294  Test macro F1 0.8084294 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 408860
pruned model Parameter : 413699
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3114094734191895
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0036436  Vali Loss: 0.0073926 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
Validation loss decreased (inf --> 0.007393).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.319495439529419
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0051942  Vali Loss: 0.0072354 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
new best score!!!!
Validation loss decreased (0.007393 --> 0.007235).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.311141014099121
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0042947  Vali Loss: 0.0076914 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.305554389953613
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0028203  Vali Loss: 0.0057616 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.007235 --> 0.005762).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.329650402069092
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0030603  Vali Loss: 0.0063428 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.311704635620117
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0029266  Vali Loss: 0.0066542 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.327439785003662
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0023313  Vali Loss: 0.0053652 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.005762 --> 0.005365).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.312402009963989
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0021256  Vali Loss: 0.0060136 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9977007 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.322384834289551
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0030050  Vali Loss: 0.0054072 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.318861484527588
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0024119  Vali Loss: 0.0053970 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.300182342529297
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0021948  Vali Loss: 0.0052065 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.005365 --> 0.005206).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.3264851570129395
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0027489  Vali Loss: 0.0047834 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.005206 --> 0.004783).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.302426338195801
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0017292  Vali Loss: 0.0044684 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.004783 --> 0.004468).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.323278903961182
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0018297  Vali Loss: 0.0045559 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.31300163269043
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0014873  Vali Loss: 0.0044104 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.004468 --> 0.004410).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.317603588104248
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0013245  Vali Loss: 0.0042720 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.004410 --> 0.004272).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.307196617126465
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0025055  Vali Loss: 0.0045238 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.306497097015381
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0017953  Vali Loss: 0.0042619 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.004272 --> 0.004262).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.326457738876343
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0014044  Vali Loss: 0.0043522 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.299846649169922
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0011712  Vali Loss: 0.0040295 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.004262 --> 0.004030).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.315372467041016
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0021096  Vali Loss: 0.0068665 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962284  Vali macro F1 0.9964514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.308990001678467
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0013096  Vali Loss: 0.0056572 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.322994709014893
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0014233  Vali Loss: 0.0054144 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.317279100418091
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0010881  Vali Loss: 0.0051200 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.301229238510132
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0013899  Vali Loss: 0.0062207 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 26 cost time: 6.321380853652954
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018828  Vali Loss: 0.0046771 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.29895806312561
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0010199  Vali Loss: 0.0046688 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.326447010040283
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0009552  Vali Loss: 0.0051250 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.307478427886963
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0009161  Vali Loss: 0.0048253 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.329611301422119
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0012643  Vali Loss: 0.0040013 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.004030 --> 0.004001).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.316118955612183
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0032243  Vali Loss: 0.0046708 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.309303522109985
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0016019  Vali Loss: 0.0049303 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975015  Vali macro F1 0.9974289 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.3249266147613525
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0013334  Vali Loss: 0.0046149 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.303386926651001
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0008742  Vali Loss: 0.0041373 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.321469783782959
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0007619  Vali Loss: 0.0040330 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 36 cost time: 6.306426525115967
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0007127  Vali Loss: 0.0040198 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.305562496185303
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0007232  Vali Loss: 0.0040060 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.316269397735596
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0007503  Vali Loss: 0.0039895 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
new best score!!!!
Validation loss decreased (0.004001 --> 0.003989).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 6.30978536605835
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0008299  Vali Loss: 0.0040214 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 6.328402280807495
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0011913  Vali Loss: 0.0040612 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 6.305991888046265
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0007704  Vali Loss: 0.0040710 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 6.306097984313965
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0006738  Vali Loss: 0.0040915 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 6.3020830154418945
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0007293  Vali Loss: 0.0040631 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 44 cost time: 6.328018665313721
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0008808  Vali Loss: 0.0040447 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 45 cost time: 6.313876628875732
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0006795  Vali Loss: 0.0040324 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 46 cost time: 6.302572727203369
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0006117  Vali Loss: 0.0040333 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 47 cost time: 6.316108703613281
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0007975  Vali Loss: 0.0040299 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 48 cost time: 6.301661252975464
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0006801  Vali Loss: 0.0040281 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 49 cost time: 6.321861982345581
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0007376  Vali Loss: 0.0040281 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 50 cost time: 6.313486337661743
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0007434  Vali Loss: 0.0040280 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 51 cost time: 6.327496767044067
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0007617  Vali Loss: 0.0040278 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 52 cost time: 6.313835382461548
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0008106  Vali Loss: 0.0040277 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 53 cost time: 6.3055853843688965
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0007041  Vali Loss: 0.0040271 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974943  Vali macro F1 0.9976364 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8175439  Test weighted F1: 0.7984860  Test macro F1 0.7984860 

============================= JOB FEEDBACK =============================

NodeName=uc2n565
Job ID: 20948455
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 05:28:15
CPU Efficiency: 4.92% of 4-15:13:00 core-walltime
Job Wall-clock time: 05:33:39
Memory Utilized: 7.24 GB
Memory Efficiency: 0.00% of 0.00 MB
