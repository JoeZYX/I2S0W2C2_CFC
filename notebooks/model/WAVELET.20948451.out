Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 285395
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0027933  0.00240964 0.00243309 0.00330033 0.00526316 0.00581395
 0.00303951 0.00290698 0.00234742 0.00421941]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 2.370971441268921
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2561306  Vali Loss: 2.1638609 Vali Accuracy: 0.1271186  Vali weighted F1: 0.0563005  Vali macro F1 0.0458065 
Validation loss decreased (inf --> 2.163861).  Saving model ...
Epoch: 2 cost time: 1.2911045551300049
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8477742  Vali Loss: 1.2840376 Vali Accuracy: 0.6214689  Vali weighted F1: 0.5932656  Vali macro F1 0.5591483 
new best score!!!!
Validation loss decreased (2.163861 --> 1.284038).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2833709716796875
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.1627794  Vali Loss: 0.8206112 Vali Accuracy: 0.7401130  Vali weighted F1: 0.7136260  Vali macro F1 0.6795238 
new best score!!!!
Validation loss decreased (1.284038 --> 0.820611).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2880635261535645
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8208384  Vali Loss: 0.6041851 Vali Accuracy: 0.7514124  Vali weighted F1: 0.7287977  Vali macro F1 0.6990674 
new best score!!!!
Validation loss decreased (0.820611 --> 0.604185).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2882611751556396
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.5953902  Vali Loss: 0.4552510 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8137070  Vali macro F1 0.7929049 
new best score!!!!
Validation loss decreased (0.604185 --> 0.455251).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2844882011413574
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.4646545  Vali Loss: 0.3834717 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8300274  Vali macro F1 0.8028516 
new best score!!!!
Validation loss decreased (0.455251 --> 0.383472).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2868847846984863
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.3896464  Vali Loss: 0.3096065 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8723215  Vali macro F1 0.8392139 
new best score!!!!
Validation loss decreased (0.383472 --> 0.309606).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2889842987060547
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3304383  Vali Loss: 0.2729963 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8907199  Vali macro F1 0.8651970 
new best score!!!!
Validation loss decreased (0.309606 --> 0.272996).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2884783744812012
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2804131  Vali Loss: 0.2375765 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8967865  Vali macro F1 0.8541836 
new best score!!!!
Validation loss decreased (0.272996 --> 0.237576).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2840280532836914
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2528069  Vali Loss: 0.2158420 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9092063  Vali macro F1 0.8772671 
new best score!!!!
Validation loss decreased (0.237576 --> 0.215842).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2819278240203857
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2294245  Vali Loss: 0.2027176 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8985648  Vali macro F1 0.8457186 
new best score!!!!
Validation loss decreased (0.215842 --> 0.202718).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2866621017456055
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2060395  Vali Loss: 0.1794452 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9319665  Vali macro F1 0.9057635 
new best score!!!!
Validation loss decreased (0.202718 --> 0.179445).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2864155769348145
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1808733  Vali Loss: 0.1681536 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9225882  Vali macro F1 0.8906589 
new best score!!!!
Validation loss decreased (0.179445 --> 0.168154).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2802751064300537
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1552265  Vali Loss: 0.1605713 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9180492  Vali macro F1 0.8849112 
new best score!!!!
Validation loss decreased (0.168154 --> 0.160571).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.285094976425171
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1564343  Vali Loss: 0.1388967 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9223144  Vali macro F1 0.8813680 
new best score!!!!
Validation loss decreased (0.160571 --> 0.138897).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2857205867767334
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1427049  Vali Loss: 0.1404364 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9338351  Vali macro F1 0.9032103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.2821860313415527
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1274583  Vali Loss: 0.1269471 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9361490  Vali macro F1 0.9066737 
new best score!!!!
Validation loss decreased (0.138897 --> 0.126947).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2826788425445557
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1187035  Vali Loss: 0.1166697 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9452754  Vali macro F1 0.9221390 
new best score!!!!
Validation loss decreased (0.126947 --> 0.116670).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.284364938735962
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1068646  Vali Loss: 0.1260691 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9334938  Vali macro F1 0.9040058 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.2809264659881592
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1094685  Vali Loss: 0.1237232 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9303464  Vali macro F1 0.8963489 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.2798917293548584
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1053242  Vali Loss: 0.1317710 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9491186  Vali macro F1 0.9299185 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 1.2840237617492676
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0935497  Vali Loss: 0.1011206 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9570366  Vali macro F1 0.9398997 
new best score!!!!
Validation loss decreased (0.116670 --> 0.101121).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.284865379333496
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0921007  Vali Loss: 0.0780167 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684790  Vali macro F1 0.9544236 
new best score!!!!
Validation loss decreased (0.101121 --> 0.078017).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2834324836730957
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0820147  Vali Loss: 0.0900735 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9559020  Vali macro F1 0.9372605 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.280522346496582
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0821396  Vali Loss: 0.1381234 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9346310  Vali macro F1 0.9083168 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.2861957550048828
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0907178  Vali Loss: 0.0668227 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9658715  Vali macro F1 0.9523410 
new best score!!!!
Validation loss decreased (0.078017 --> 0.066823).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2799437046051025
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0705438  Vali Loss: 0.0694396 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772241  Vali macro F1 0.9690041 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.283421516418457
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0683362  Vali Loss: 0.0854736 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687794  Vali macro F1 0.9605947 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.284956693649292
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0664176  Vali Loss: 0.0941867 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689585  Vali macro F1 0.9613496 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.2855894565582275
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0553711  Vali Loss: 0.0625641 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715956  Vali macro F1 0.9637686 
new best score!!!!
Validation loss decreased (0.066823 --> 0.062564).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.28536057472229
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0552966  Vali Loss: 0.0884374 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9657077  Vali macro F1 0.9564430 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.2831315994262695
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0492674  Vali Loss: 0.0719416 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773117  Vali macro F1 0.9783504 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.2844457626342773
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0582017  Vali Loss: 0.0824833 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687599  Vali macro F1 0.9642593 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.282716989517212
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0488057  Vali Loss: 0.0691149 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715547  Vali macro F1 0.9638481 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 1.2835075855255127
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0363626  Vali Loss: 0.0642560 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801904  Vali macro F1 0.9803373 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 36 cost time: 1.2869794368743896
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0345463  Vali Loss: 0.0622345 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801904  Vali macro F1 0.9803373 
new best score!!!!
Validation loss decreased (0.062564 --> 0.062235).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2842187881469727
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0311458  Vali Loss: 0.0633641 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801904  Vali macro F1 0.9803373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.2811174392700195
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0304533  Vali Loss: 0.0624977 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801904  Vali macro F1 0.9803373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.2826640605926514
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0272948  Vali Loss: 0.0642111 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773736  Vali macro F1 0.9751047 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.286278247833252
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0288573  Vali Loss: 0.0642902 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773736  Vali macro F1 0.9751047 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 1.2871971130371094
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0278128  Vali Loss: 0.0603740 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
new best score!!!!
Validation loss decreased (0.062235 --> 0.060374).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2848320007324219
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0256185  Vali Loss: 0.0578230 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
new best score!!!!
Validation loss decreased (0.060374 --> 0.057823).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2857584953308105
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0261321  Vali Loss: 0.0595997 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9827041 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.2859916687011719
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0254127  Vali Loss: 0.0577300 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
new best score!!!!
Validation loss decreased (0.057823 --> 0.057730).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2817678451538086
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0278982  Vali Loss: 0.0595309 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773736  Vali macro F1 0.9751047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2835304737091064
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0260974  Vali Loss: 0.0598057 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801904  Vali macro F1 0.9803373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.2861690521240234
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0285441  Vali Loss: 0.0587488 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773736  Vali macro F1 0.9751047 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.2812447547912598
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0250667  Vali Loss: 0.0568351 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9827041 
new best score!!!!
Validation loss decreased (0.057730 --> 0.056835).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2810721397399902
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0264354  Vali Loss: 0.0600335 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773736  Vali macro F1 0.9751047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.2833428382873535
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0235236  Vali Loss: 0.0620578 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802399  Vali macro F1 0.9779232 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.285515546798706
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0261015  Vali Loss: 0.0585041 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9827041 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.2814674377441406
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0263355  Vali Loss: 0.0557810 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
new best score!!!!
Validation loss decreased (0.056835 --> 0.055781).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2846531867980957
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0252151  Vali Loss: 0.0561268 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2871849536895752
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0234675  Vali Loss: 0.0561449 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.281620740890503
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0236674  Vali Loss: 0.0535339 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
new best score!!!!
Validation loss decreased (0.055781 --> 0.053534).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2812483310699463
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0236702  Vali Loss: 0.0511246 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858810  Vali macro F1 0.9860136 
new best score!!!!
Validation loss decreased (0.053534 --> 0.051125).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2859463691711426
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0246446  Vali Loss: 0.0519471 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858810  Vali macro F1 0.9860136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2845699787139893
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0221725  Vali Loss: 0.0549299 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9827041 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.284438133239746
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0234594  Vali Loss: 0.0590185 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 1.2853093147277832
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0233724  Vali Loss: 0.0565615 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 1.28495192527771
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0242415  Vali Loss: 0.0522832 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 62 cost time: 1.281299114227295
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0208709  Vali Loss: 0.0517815 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.2808682918548584
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0231373  Vali Loss: 0.0516930 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.2863545417785645
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0223489  Vali Loss: 0.0520685 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.2854423522949219
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0207301  Vali Loss: 0.0519102 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.2813053131103516
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0199818  Vali Loss: 0.0515677 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 67 cost time: 1.281445026397705
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0233175  Vali Loss: 0.0515529 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.284322738647461
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0217214  Vali Loss: 0.0516073 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.283470869064331
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0202802  Vali Loss: 0.0515827 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.2832889556884766
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0212703  Vali Loss: 0.0515718 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 1.285933017730713
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0207409  Vali Loss: 0.0514940 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898360  Test macro F1 0.9905588 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.400686264038086
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0239217  Vali Loss: 0.0433694 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887300  Vali macro F1 0.9879434 
Validation loss decreased (inf --> 0.043369).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4007713794708252
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0256905  Vali Loss: 0.0457757 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.3960509300231934
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0245911  Vali Loss: 0.0447597 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858810  Vali macro F1 0.9860136 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.3975629806518555
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0199273  Vali Loss: 0.0486746 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802206  Vali macro F1 0.9783750 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.399245023727417
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0225082  Vali Loss: 0.0542955 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859057  Vali macro F1 0.9850857 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.4006831645965576
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0208412  Vali Loss: 0.0515308 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802033  Vali macro F1 0.9774863 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.3967630863189697
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0209903  Vali Loss: 0.0462313 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9827041 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.3975822925567627
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0203208  Vali Loss: 0.0472302 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830567  Vali macro F1 0.9831558 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.399306297302246
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0190822  Vali Loss: 0.0444783 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858939  Vali macro F1 0.9831626 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.3971993923187256
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0195829  Vali Loss: 0.0442570 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859057  Vali macro F1 0.9850857 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.3973016738891602
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0193721  Vali Loss: 0.0442406 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859057  Vali macro F1 0.9850857 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4029898643493652
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0182841  Vali Loss: 0.0445306 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859057  Vali macro F1 0.9850857 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.3984746932983398
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0182513  Vali Loss: 0.0455207 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859057  Vali macro F1 0.9850857 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.399332046508789
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0190743  Vali Loss: 0.0447408 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859057  Vali macro F1 0.9850857 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.3978643417358398
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0188456  Vali Loss: 0.0441427 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859057  Vali macro F1 0.9850857 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.399674415588379
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0183740  Vali Loss: 0.0441780 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859057  Vali macro F1 0.9850857 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898453  Test macro F1 0.9905800 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00280112 0.00243902 0.00238095 0.00328947 0.00561798 0.00568182
 0.00304878 0.00282486 0.00238095 0.00420168]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2899048328399658
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2568694  Vali Loss: 2.1682699 Vali Accuracy: 0.1949153  Vali weighted F1: 0.1253694  Vali macro F1 0.1042272 
Validation loss decreased (inf --> 2.168270).  Saving model ...
Epoch: 2 cost time: 1.2882113456726074
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8530216  Vali Loss: 1.2811655 Vali Accuracy: 0.6299435  Vali weighted F1: 0.6141489  Vali macro F1 0.5848248 
new best score!!!!
Validation loss decreased (2.168270 --> 1.281165).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2852296829223633
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.1647072  Vali Loss: 0.8351044 Vali Accuracy: 0.7429379  Vali weighted F1: 0.7396097  Vali macro F1 0.7138420 
new best score!!!!
Validation loss decreased (1.281165 --> 0.835104).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2847349643707275
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8160992  Vali Loss: 0.5736053 Vali Accuracy: 0.7740113  Vali weighted F1: 0.7637875  Vali macro F1 0.7310192 
new best score!!!!
Validation loss decreased (0.835104 --> 0.573605).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2917675971984863
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.5895393  Vali Loss: 0.4561706 Vali Accuracy: 0.8135593  Vali weighted F1: 0.7907853  Vali macro F1 0.7515551 
new best score!!!!
Validation loss decreased (0.573605 --> 0.456171).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.284968614578247
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.4572049  Vali Loss: 0.3813929 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8256927  Vali macro F1 0.7815454 
new best score!!!!
Validation loss decreased (0.456171 --> 0.381393).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.287292242050171
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.3819073  Vali Loss: 0.3060961 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8401901  Vali macro F1 0.7945505 
new best score!!!!
Validation loss decreased (0.381393 --> 0.306096).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.290942907333374
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3314374  Vali Loss: 0.2922657 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8595835  Vali macro F1 0.8244494 
new best score!!!!
Validation loss decreased (0.306096 --> 0.292266).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2908298969268799
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2943311  Vali Loss: 0.2365671 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8852891  Vali macro F1 0.8438059 
new best score!!!!
Validation loss decreased (0.292266 --> 0.236567).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2875182628631592
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2487053  Vali Loss: 0.2007194 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9182648  Vali macro F1 0.8885644 
new best score!!!!
Validation loss decreased (0.236567 --> 0.200719).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2868945598602295
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2229559  Vali Loss: 0.1901306 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9229211  Vali macro F1 0.8966009 
new best score!!!!
Validation loss decreased (0.200719 --> 0.190131).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2906773090362549
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1962977  Vali Loss: 0.1719673 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9014369  Vali macro F1 0.8594272 
new best score!!!!
Validation loss decreased (0.190131 --> 0.171967).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2859265804290771
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1773576  Vali Loss: 0.1563705 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9301938  Vali macro F1 0.8963633 
new best score!!!!
Validation loss decreased (0.171967 --> 0.156371).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2869696617126465
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1544743  Vali Loss: 0.1471290 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9376181  Vali macro F1 0.9113109 
new best score!!!!
Validation loss decreased (0.156371 --> 0.147129).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2902741432189941
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1523422  Vali Loss: 0.1246399 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9504641  Vali macro F1 0.9236839 
new best score!!!!
Validation loss decreased (0.147129 --> 0.124640).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2905027866363525
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1409536  Vali Loss: 0.1185840 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9441867  Vali macro F1 0.9155767 
new best score!!!!
Validation loss decreased (0.124640 --> 0.118584).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2890236377716064
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1338442  Vali Loss: 0.1266599 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9259255  Vali macro F1 0.8890408 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.287992000579834
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1346137  Vali Loss: 0.1169997 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9322997  Vali macro F1 0.8992918 
new best score!!!!
Validation loss decreased (0.118584 --> 0.117000).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2900094985961914
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1285491  Vali Loss: 0.1006899 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9565668  Vali macro F1 0.9292138 
new best score!!!!
Validation loss decreased (0.117000 --> 0.100690).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2869775295257568
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1178692  Vali Loss: 0.0937592 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9492676  Vali macro F1 0.9168699 
new best score!!!!
Validation loss decreased (0.100690 --> 0.093759).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2891781330108643
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1114391  Vali Loss: 0.0905188 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9486138  Vali macro F1 0.9157678 
new best score!!!!
Validation loss decreased (0.093759 --> 0.090519).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2919743061065674
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1064668  Vali Loss: 0.0995641 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9479274  Vali macro F1 0.9189715 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.294203281402588
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1092997  Vali Loss: 0.1019087 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9401072  Vali macro F1 0.9081272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.2964060306549072
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0992214  Vali Loss: 0.1046565 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9414360  Vali macro F1 0.9128749 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 1.2895395755767822
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0940254  Vali Loss: 0.0952037 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9432415  Vali macro F1 0.9109899 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 1.309025764465332
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0882968  Vali Loss: 0.0889692 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9568964  Vali macro F1 0.9345270 
new best score!!!!
Validation loss decreased (0.090519 --> 0.088969).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2912979125976562
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0835185  Vali Loss: 0.0773112 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687822  Vali macro F1 0.9521423 
new best score!!!!
Validation loss decreased (0.088969 --> 0.077311).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.292572021484375
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0902919  Vali Loss: 0.0920717 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9446384  Vali macro F1 0.9138635 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.2932875156402588
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0801557  Vali Loss: 0.0890846 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9464595  Vali macro F1 0.9207935 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.29435133934021
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0814840  Vali Loss: 0.0775171 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9508867  Vali macro F1 0.9243964 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 1.290173053741455
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0791055  Vali Loss: 0.0715977 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9650243  Vali macro F1 0.9458074 
new best score!!!!
Validation loss decreased (0.077311 --> 0.071598).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2892389297485352
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0685414  Vali Loss: 0.0651352 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715306  Vali macro F1 0.9567753 
new best score!!!!
Validation loss decreased (0.071598 --> 0.065135).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2925198078155518
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0660536  Vali Loss: 0.0612730 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716355  Vali macro F1 0.9589366 
new best score!!!!
Validation loss decreased (0.065135 --> 0.061273).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2884738445281982
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0621733  Vali Loss: 0.0560700 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773427  Vali macro F1 0.9670012 
new best score!!!!
Validation loss decreased (0.061273 --> 0.056070).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2884762287139893
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0625047  Vali Loss: 0.0543845 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715687  Vali macro F1 0.9568552 
new best score!!!!
Validation loss decreased (0.056070 --> 0.054384).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.292677402496338
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0559238  Vali Loss: 0.0647765 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9676890  Vali macro F1 0.9502994 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.2911503314971924
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0499045  Vali Loss: 0.0445921 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858569  Vali macro F1 0.9809254 
new best score!!!!
Validation loss decreased (0.054384 --> 0.044592).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2885494232177734
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0517863  Vali Loss: 0.0436123 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887022  Vali macro F1 0.9833454 
new best score!!!!
Validation loss decreased (0.044592 --> 0.043612).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2902398109436035
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0526373  Vali Loss: 0.0354628 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915206  Vali macro F1 0.9857062 
new best score!!!!
Validation loss decreased (0.043612 --> 0.035463).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2922368049621582
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0438512  Vali Loss: 0.0523039 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9768432  Vali macro F1 0.9633126 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.2864060401916504
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0513345  Vali Loss: 0.0391121 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887119  Vali macro F1 0.9857537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.287015438079834
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0381551  Vali Loss: 0.0371227 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858861  Vali macro F1 0.9837670 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.2916524410247803
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0302411  Vali Loss: 0.0421126 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857787  Vali macro F1 0.9784172 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 1.2917611598968506
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0304417  Vali Loss: 0.0336811 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
new best score!!!!
Validation loss decreased (0.035463 --> 0.033681).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.288435459136963
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0284087  Vali Loss: 0.0326587 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887022  Vali macro F1 0.9833454 
new best score!!!!
Validation loss decreased (0.033681 --> 0.032659).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2897932529449463
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0255224  Vali Loss: 0.0275163 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887022  Vali macro F1 0.9833454 
new best score!!!!
Validation loss decreased (0.032659 --> 0.027516).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.293163537979126
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0250771  Vali Loss: 0.0601637 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772217  Vali macro F1 0.9683690 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.288390874862671
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0227861  Vali Loss: 0.0328565 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.287703037261963
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0300846  Vali Loss: 0.0315106 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859264  Vali macro F1 0.9834540 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.290616750717163
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0233040  Vali Loss: 0.0394920 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800471  Vali macro F1 0.9711473 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.2900402545928955
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0258163  Vali Loss: 0.0390135 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829716  Vali macro F1 0.9760772 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 52 cost time: 1.2868247032165527
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0220276  Vali Loss: 0.0281205 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.286567211151123
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0200031  Vali Loss: 0.0256729 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
new best score!!!!
Validation loss decreased (0.027516 --> 0.025673).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2891185283660889
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0179708  Vali Loss: 0.0286347 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857787  Vali macro F1 0.9784172 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.2903494834899902
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0148292  Vali Loss: 0.0310552 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829716  Vali macro F1 0.9760772 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.286412239074707
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0154669  Vali Loss: 0.0267549 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.289367437362671
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0151899  Vali Loss: 0.0302009 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.2951748371124268
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0143844  Vali Loss: 0.0287583 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 59 cost time: 1.2866284847259521
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0134605  Vali Loss: 0.0286064 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.2879106998443604
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0129045  Vali Loss: 0.0283729 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.2886199951171875
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0124423  Vali Loss: 0.0283513 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.2865278720855713
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0159525  Vali Loss: 0.0283287 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.2870783805847168
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0128278  Vali Loss: 0.0280798 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 64 cost time: 1.2894883155822754
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0119834  Vali Loss: 0.0280800 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.2911758422851562
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0135669  Vali Loss: 0.0280895 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.2864675521850586
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0127383  Vali Loss: 0.0280589 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 1.285426378250122
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0136601  Vali Loss: 0.0280160 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 1.2876498699188232
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0149772  Vali Loss: 0.0280572 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9852745  Test macro F1 0.9834140 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3837206363677979
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0162951  Vali Loss: 0.0238394 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
Validation loss decreased (inf --> 0.023839).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3804962635040283
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0151685  Vali Loss: 0.0295371 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829716  Vali macro F1 0.9760772 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.3774051666259766
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0157340  Vali Loss: 0.0254297 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.377387523651123
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0123536  Vali Loss: 0.0296397 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.381500482559204
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0110892  Vali Loss: 0.0233831 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
new best score!!!!
Validation loss decreased (0.023839 --> 0.023383).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.3774657249450684
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0120184  Vali Loss: 0.0255501 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.3805665969848633
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0122957  Vali Loss: 0.0257263 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.3811509609222412
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0111678  Vali Loss: 0.0268228 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.3820126056671143
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0115957  Vali Loss: 0.0276092 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.3781042098999023
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0107485  Vali Loss: 0.0232938 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913411  Vali macro F1 0.9868277 
new best score!!!!
Validation loss decreased (0.023383 --> 0.023294).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.3790011405944824
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0100199  Vali Loss: 0.0318632 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.3823678493499756
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0093218  Vali Loss: 0.0336154 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.378530740737915
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0113351  Vali Loss: 0.0348694 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.3782341480255127
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0109074  Vali Loss: 0.0330990 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.3820712566375732
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0098464  Vali Loss: 0.0367283 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 1.3828210830688477
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0087969  Vali Loss: 0.0233156 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.3800289630889893
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0106196  Vali Loss: 0.0335093 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.3800311088562012
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0100445  Vali Loss: 0.0252121 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.3859591484069824
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0089713  Vali Loss: 0.0281438 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.379173994064331
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0089675  Vali Loss: 0.0259293 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 1.3795702457427979
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0076911  Vali Loss: 0.0252626 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.3814458847045898
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0092708  Vali Loss: 0.0248903 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.3841743469238281
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0075341  Vali Loss: 0.0236178 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.3790433406829834
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0091728  Vali Loss: 0.0247121 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.3794636726379395
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0090540  Vali Loss: 0.0298517 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9897946  Test macro F1 0.9890166 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00276243 0.00239234 0.00246305 0.00330033 0.00595238 0.00574713
 0.00308642 0.00291545 0.00232019 0.00390625]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3012504577636719
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2555257  Vali Loss: 2.1605535 Vali Accuracy: 0.2655367  Vali weighted F1: 0.1929725  Vali macro F1 0.1462483 
Validation loss decreased (inf --> 2.160554).  Saving model ...
Epoch: 2 cost time: 1.3023855686187744
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8424511  Vali Loss: 1.2958892 Vali Accuracy: 0.5819209  Vali weighted F1: 0.5566929  Vali macro F1 0.5285395 
new best score!!!!
Validation loss decreased (2.160554 --> 1.295889).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3016293048858643
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.1616045  Vali Loss: 0.8486561 Vali Accuracy: 0.7062147  Vali weighted F1: 0.6759955  Vali macro F1 0.6415239 
new best score!!!!
Validation loss decreased (1.295889 --> 0.848656).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2990520000457764
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8053331  Vali Loss: 0.5949265 Vali Accuracy: 0.7824859  Vali weighted F1: 0.7727463  Vali macro F1 0.7590718 
new best score!!!!
Validation loss decreased (0.848656 --> 0.594927).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.296933650970459
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.5897002  Vali Loss: 0.4586613 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8032239  Vali macro F1 0.7754837 
new best score!!!!
Validation loss decreased (0.594927 --> 0.458661).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.299137830734253
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.4518412  Vali Loss: 0.3825319 Vali Accuracy: 0.8446328  Vali weighted F1: 0.8424016  Vali macro F1 0.8191458 
new best score!!!!
Validation loss decreased (0.458661 --> 0.382532).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2969768047332764
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.3681254  Vali Loss: 0.2954139 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8910692  Vali macro F1 0.8699324 
new best score!!!!
Validation loss decreased (0.382532 --> 0.295414).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2958807945251465
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3076477  Vali Loss: 0.2659434 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8842837  Vali macro F1 0.8440992 
new best score!!!!
Validation loss decreased (0.295414 --> 0.265943).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2972121238708496
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2799301  Vali Loss: 0.2360156 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8866514  Vali macro F1 0.8371318 
new best score!!!!
Validation loss decreased (0.265943 --> 0.236016).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.297912836074829
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2491069  Vali Loss: 0.2149828 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8967502  Vali macro F1 0.8571469 
new best score!!!!
Validation loss decreased (0.236016 --> 0.214983).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2969958782196045
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2267284  Vali Loss: 0.1884612 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9010421  Vali macro F1 0.8497805 
new best score!!!!
Validation loss decreased (0.214983 --> 0.188461).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2938907146453857
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1890683  Vali Loss: 0.1695529 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9170033  Vali macro F1 0.8812225 
new best score!!!!
Validation loss decreased (0.188461 --> 0.169553).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2981746196746826
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1719732  Vali Loss: 0.1548002 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9015385  Vali macro F1 0.8539410 
new best score!!!!
Validation loss decreased (0.169553 --> 0.154800).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2959973812103271
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1613755  Vali Loss: 0.1397728 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9339058  Vali macro F1 0.9003819 
new best score!!!!
Validation loss decreased (0.154800 --> 0.139773).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2956714630126953
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1484459  Vali Loss: 0.1412265 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9153600  Vali macro F1 0.8714382 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.2970373630523682
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1367728  Vali Loss: 0.1176771 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9358054  Vali macro F1 0.9017495 
new best score!!!!
Validation loss decreased (0.139773 --> 0.117677).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2983241081237793
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1267786  Vali Loss: 0.1149516 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9429428  Vali macro F1 0.9113612 
new best score!!!!
Validation loss decreased (0.117677 --> 0.114952).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2969958782196045
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1232707  Vali Loss: 0.1147388 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9262968  Vali macro F1 0.8914629 
new best score!!!!
Validation loss decreased (0.114952 --> 0.114739).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2963473796844482
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1113608  Vali Loss: 0.1436531 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9349338  Vali macro F1 0.9017204 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.2980577945709229
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1111917  Vali Loss: 0.1385704 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9265955  Vali macro F1 0.8939984 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.2956774234771729
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1138102  Vali Loss: 0.0941651 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9474933  Vali macro F1 0.9166144 
new best score!!!!
Validation loss decreased (0.114739 --> 0.094165).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.299487829208374
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1041019  Vali Loss: 0.0988496 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9365075  Vali macro F1 0.9004456 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3007488250732422
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0977657  Vali Loss: 0.1092214 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9429841  Vali macro F1 0.9104879 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.300713062286377
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0942426  Vali Loss: 0.0870405 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9685874  Vali macro F1 0.9517465 
new best score!!!!
Validation loss decreased (0.094165 --> 0.087041).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3126394748687744
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0902991  Vali Loss: 0.1083393 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9603722  Vali macro F1 0.9416093 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.29697585105896
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0912394  Vali Loss: 0.0903902 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9508964  Vali macro F1 0.9247685 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 1.3057808876037598
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0884187  Vali Loss: 0.0850734 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9537417  Vali macro F1 0.9271474 
new best score!!!!
Validation loss decreased (0.087041 --> 0.085073).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2963058948516846
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0764934  Vali Loss: 0.0744863 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9593639  Vali macro F1 0.9414624 
new best score!!!!
Validation loss decreased (0.085073 --> 0.074486).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3012330532073975
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0655793  Vali Loss: 0.0649027 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744063  Vali macro F1 0.9643995 
new best score!!!!
Validation loss decreased (0.074486 --> 0.064903).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2999083995819092
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0677265  Vali Loss: 0.0674683 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9656063  Vali macro F1 0.9519853 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3003292083740234
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0845971  Vali Loss: 0.0816930 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9436515  Vali macro F1 0.9152919 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.2960748672485352
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0729837  Vali Loss: 0.0703139 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9683465  Vali macro F1 0.9552986 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.2951605319976807
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0556921  Vali Loss: 0.0595755 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9682052  Vali macro F1 0.9515705 
new best score!!!!
Validation loss decreased (0.064903 --> 0.059576).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3023498058319092
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0532050  Vali Loss: 0.0362121 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
new best score!!!!
Validation loss decreased (0.059576 --> 0.036212).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.297816514968872
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0489002  Vali Loss: 0.0360804 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915324  Vali macro F1 0.9880745 
new best score!!!!
Validation loss decreased (0.036212 --> 0.036080).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2961711883544922
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0422889  Vali Loss: 0.0462924 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858183  Vali macro F1 0.9808602 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3010828495025635
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0381635  Vali Loss: 0.0340163 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
new best score!!!!
Validation loss decreased (0.036080 --> 0.034016).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3006649017333984
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0365048  Vali Loss: 0.0392158 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886947  Vali macro F1 0.9852360 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.296797513961792
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0385904  Vali Loss: 0.0351930 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915324  Vali macro F1 0.9880745 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.2978649139404297
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0372305  Vali Loss: 0.0275084 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
new best score!!!!
Validation loss decreased (0.034016 --> 0.027508).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2990117073059082
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0306237  Vali Loss: 0.0267564 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
new best score!!!!
Validation loss decreased (0.027508 --> 0.026756).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2980072498321533
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0247570  Vali Loss: 0.0219989 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
new best score!!!!
Validation loss decreased (0.026756 --> 0.021999).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2969582080841064
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0293732  Vali Loss: 0.0660060 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801447  Vali macro F1 0.9764984 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3004724979400635
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0335632  Vali Loss: 0.0289755 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.302079677581787
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0260391  Vali Loss: 0.0211243 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
new best score!!!!
Validation loss decreased (0.021999 --> 0.021124).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2988736629486084
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0216732  Vali Loss: 0.0312450 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887028  Vali macro F1 0.9833045 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2983057498931885
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0359961  Vali Loss: 0.0402489 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800207  Vali macro F1 0.9710827 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.30010986328125
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0270715  Vali Loss: 0.0344796 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858495  Vali macro F1 0.9781308 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.2979521751403809
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0299995  Vali Loss: 0.0440236 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744821  Vali macro F1 0.9669529 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.295710802078247
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0225122  Vali Loss: 0.0267540 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 51 cost time: 1.3000962734222412
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0174585  Vali Loss: 0.0262931 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.3008077144622803
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0174151  Vali Loss: 0.0266229 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886641  Vali macro F1 0.9832394 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.2958910465240479
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0162841  Vali Loss: 0.0244443 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.2994046211242676
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0141401  Vali Loss: 0.0225175 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.3023202419281006
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0148765  Vali Loss: 0.0241971 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 1.313835859298706
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0132528  Vali Loss: 0.0236093 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.296699047088623
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0137993  Vali Loss: 0.0234649 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.303513765335083
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0130535  Vali Loss: 0.0232935 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 1.3014800548553467
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0140852  Vali Loss: 0.0230026 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 1.2966163158416748
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0153434  Vali Loss: 0.0231359 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909368  Test macro F1 0.9904341 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3903934955596924
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0212352  Vali Loss: 0.0267321 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9903905 
Validation loss decreased (inf --> 0.026732).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3882691860198975
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0158958  Vali Loss: 0.0290023 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9903905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.392045021057129
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0154738  Vali Loss: 0.0202113 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
new best score!!!!
Validation loss decreased (0.026732 --> 0.020211).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3911609649658203
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0152335  Vali Loss: 0.0244490 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.3883392810821533
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0141156  Vali Loss: 0.0205917 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.388660192489624
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0133232  Vali Loss: 0.0212331 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.3917055130004883
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0128396  Vali Loss: 0.0226784 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.3881070613861084
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0131334  Vali Loss: 0.0181960 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
new best score!!!!
Validation loss decreased (0.020211 --> 0.018196).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.3892314434051514
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0131384  Vali Loss: 0.0263261 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.3923401832580566
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0135838  Vali Loss: 0.0271016 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.3916692733764648
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0132368  Vali Loss: 0.0262409 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.388157606124878
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0101189  Vali Loss: 0.0252449 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.3903038501739502
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0107627  Vali Loss: 0.0298067 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886554  Vali macro F1 0.9836538 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 1.3919484615325928
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0114106  Vali Loss: 0.0281156 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.388939380645752
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0109339  Vali Loss: 0.0234240 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.388916015625
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0100086  Vali Loss: 0.0279096 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.3923406600952148
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0101965  Vali Loss: 0.0258056 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.391650915145874
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0102191  Vali Loss: 0.0225651 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9903905 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 1.3898723125457764
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0091605  Vali Loss: 0.0218439 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.388988733291626
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0095912  Vali Loss: 0.0227891 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.3932714462280273
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0104754  Vali Loss: 0.0236943 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.3889739513397217
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0093114  Vali Loss: 0.0239300 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.3884294033050537
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0096246  Vali Loss: 0.0243670 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920775  Test macro F1 0.9921817 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00280899 0.00242718 0.00236967 0.00330033 0.00574713 0.00581395
 0.00315457 0.00280112 0.002331   0.00411523]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.299438714981079
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2590229  Vali Loss: 2.1722767 Vali Accuracy: 0.1440678  Vali weighted F1: 0.0503153  Vali macro F1 0.0484921 
Validation loss decreased (inf --> 2.172277).  Saving model ...
Epoch: 2 cost time: 1.3093442916870117
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8710521  Vali Loss: 1.3398261 Vali Accuracy: 0.5593220  Vali weighted F1: 0.5449206  Vali macro F1 0.5156843 
new best score!!!!
Validation loss decreased (2.172277 --> 1.339826).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.302428960800171
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2142829  Vali Loss: 0.8646851 Vali Accuracy: 0.7118644  Vali weighted F1: 0.6973588  Vali macro F1 0.6759504 
new best score!!!!
Validation loss decreased (1.339826 --> 0.864685).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3001599311828613
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8489901  Vali Loss: 0.6138416 Vali Accuracy: 0.7683616  Vali weighted F1: 0.7461545  Vali macro F1 0.7099969 
new best score!!!!
Validation loss decreased (0.864685 --> 0.613842).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2994239330291748
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6258290  Vali Loss: 0.4883003 Vali Accuracy: 0.8163842  Vali weighted F1: 0.7936531  Vali macro F1 0.7545054 
new best score!!!!
Validation loss decreased (0.613842 --> 0.488300).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3038218021392822
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.4833728  Vali Loss: 0.4020377 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8210322  Vali macro F1 0.7801466 
new best score!!!!
Validation loss decreased (0.488300 --> 0.402038).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3020806312561035
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4023295  Vali Loss: 0.3286569 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8527920  Vali macro F1 0.8188085 
new best score!!!!
Validation loss decreased (0.402038 --> 0.328657).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3005154132843018
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3311951  Vali Loss: 0.2869164 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9021094  Vali macro F1 0.8751436 
new best score!!!!
Validation loss decreased (0.328657 --> 0.286916).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2988510131835938
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2968868  Vali Loss: 0.2507961 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8935989  Vali macro F1 0.8569844 
new best score!!!!
Validation loss decreased (0.286916 --> 0.250796).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.302776575088501
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2598697  Vali Loss: 0.2177456 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8871642  Vali macro F1 0.8371630 
new best score!!!!
Validation loss decreased (0.250796 --> 0.217746).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2987446784973145
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2292619  Vali Loss: 0.1849406 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9187558  Vali macro F1 0.8770258 
new best score!!!!
Validation loss decreased (0.217746 --> 0.184941).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.300403356552124
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2082874  Vali Loss: 0.1903612 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9153792  Vali macro F1 0.8848344 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3046200275421143
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1979738  Vali Loss: 0.1525189 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9377125  Vali macro F1 0.9041729 
new best score!!!!
Validation loss decreased (0.184941 --> 0.152519).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.306838035583496
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1727878  Vali Loss: 0.1408952 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9156153  Vali macro F1 0.8672707 
new best score!!!!
Validation loss decreased (0.152519 --> 0.140895).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3044443130493164
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1626602  Vali Loss: 0.1407352 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9343055  Vali macro F1 0.9022869 
new best score!!!!
Validation loss decreased (0.140895 --> 0.140735).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3036324977874756
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1420151  Vali Loss: 0.1224867 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9328575  Vali macro F1 0.8915161 
new best score!!!!
Validation loss decreased (0.140735 --> 0.122487).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.301421880722046
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1441601  Vali Loss: 0.1374015 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9068802  Vali macro F1 0.8540215 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3022921085357666
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1358911  Vali Loss: 0.1446932 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9204979  Vali macro F1 0.8841137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 1.297961711883545
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1261196  Vali Loss: 0.1141301 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9375951  Vali macro F1 0.9021108 
new best score!!!!
Validation loss decreased (0.122487 --> 0.114130).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3015663623809814
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1201301  Vali Loss: 0.1226114 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9355155  Vali macro F1 0.9021057 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3021059036254883
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1124010  Vali Loss: 0.0951566 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9596281  Vali macro F1 0.9319444 
new best score!!!!
Validation loss decreased (0.114130 --> 0.095157).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.304990530014038
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1014347  Vali Loss: 0.0960949 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9534991  Vali macro F1 0.9312254 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3045988082885742
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1033871  Vali Loss: 0.0914650 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9443110  Vali macro F1 0.9085145 
new best score!!!!
Validation loss decreased (0.095157 --> 0.091465).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.306180477142334
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1001489  Vali Loss: 0.0863774 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9502823  Vali macro F1 0.9185803 
new best score!!!!
Validation loss decreased (0.091465 --> 0.086377).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3019087314605713
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1028295  Vali Loss: 0.0878881 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9405206  Vali macro F1 0.8997347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.2998998165130615
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0916923  Vali Loss: 0.0818882 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716872  Vali macro F1 0.9522727 
new best score!!!!
Validation loss decreased (0.086377 --> 0.081888).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.305729866027832
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0879608  Vali Loss: 0.0812418 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689773  Vali macro F1 0.9548826 
new best score!!!!
Validation loss decreased (0.081888 --> 0.081242).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.307194471359253
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0811277  Vali Loss: 0.0845503 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9626006  Vali macro F1 0.9461178 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3015096187591553
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0736688  Vali Loss: 0.0755138 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714904  Vali macro F1 0.9594999 
new best score!!!!
Validation loss decreased (0.081242 --> 0.075514).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3064119815826416
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0775912  Vali Loss: 0.0892238 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9625908  Vali macro F1 0.9459668 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3045313358306885
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0779664  Vali Loss: 0.0742010 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9712784  Vali macro F1 0.9563456 
new best score!!!!
Validation loss decreased (0.075514 --> 0.074201).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3034613132476807
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0702646  Vali Loss: 0.0719641 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716527  Vali macro F1 0.9585342 
new best score!!!!
Validation loss decreased (0.074201 --> 0.071964).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3190438747406006
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0624984  Vali Loss: 0.0532195 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829767  Vali macro F1 0.9740812 
new best score!!!!
Validation loss decreased (0.071964 --> 0.053219).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3053476810455322
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0501649  Vali Loss: 0.0503886 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887065  Vali macro F1 0.9853370 
new best score!!!!
Validation loss decreased (0.053219 --> 0.050389).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3070580959320068
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0492666  Vali Loss: 0.0539925 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771152  Vali macro F1 0.9642003 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3028285503387451
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0510922  Vali Loss: 0.0711264 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745537  Vali macro F1 0.9694983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.305384874343872
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0470549  Vali Loss: 0.0638532 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772014  Vali macro F1 0.9686379 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3090744018554688
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0488515  Vali Loss: 0.0543325 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801869  Vali macro F1 0.9685853 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 1.305102825164795
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0534584  Vali Loss: 0.0421150 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886749  Vali macro F1 0.9809091 
new best score!!!!
Validation loss decreased (0.050389 --> 0.042115).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3054907321929932
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0410626  Vali Loss: 0.0437003 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886855  Vali macro F1 0.9856890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3078725337982178
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0321945  Vali Loss: 0.0346768 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886922  Vali macro F1 0.9852151 
new best score!!!!
Validation loss decreased (0.042115 --> 0.034677).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3062009811401367
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0268487  Vali Loss: 0.0247476 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
new best score!!!!
Validation loss decreased (0.034677 --> 0.024748).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3050568103790283
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0313221  Vali Loss: 0.0365224 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858768  Vali macro F1 0.9806062 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3037769794464111
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0321095  Vali Loss: 0.0321447 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.3047709465026855
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0281345  Vali Loss: 0.0352655 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857787  Vali macro F1 0.9784172 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 1.299642562866211
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0312065  Vali Loss: 0.0263528 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886933  Vali macro F1 0.9860658 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 1.3016912937164307
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0285692  Vali Loss: 0.0312180 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 48 cost time: 1.3042945861816406
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0202280  Vali Loss: 0.0301611 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.3062944412231445
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0208427  Vali Loss: 0.0283128 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.3050906658172607
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0168854  Vali Loss: 0.0270385 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.30051851272583
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0164994  Vali Loss: 0.0288981 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.3034322261810303
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0166813  Vali Loss: 0.0269525 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 1.2973155975341797
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0167566  Vali Loss: 0.0266204 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.29801607131958
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0172899  Vali Loss: 0.0265850 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3020520210266113
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0146259  Vali Loss: 0.0268642 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.3015387058258057
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0152805  Vali Loss: 0.0268978 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.2992937564849854
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0158257  Vali Loss: 0.0273863 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886562  Test macro F1 0.9860185 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4025444984436035
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0231889  Vali Loss: 0.0259864 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915120  Vali macro F1 0.9876762 
Validation loss decreased (inf --> 0.025986).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4038629531860352
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0198935  Vali Loss: 0.0315320 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915109  Vali macro F1 0.9884673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4075071811676025
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0221996  Vali Loss: 0.0225617 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943470  Vali macro F1 0.9932482 
new best score!!!!
Validation loss decreased (0.025986 --> 0.022562).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4077873229980469
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0226187  Vali Loss: 0.0283750 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915120  Vali macro F1 0.9876762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.4038128852844238
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0188254  Vali Loss: 0.0269138 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915120  Vali macro F1 0.9876762 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.4043807983398438
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0180277  Vali Loss: 0.0245834 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.4058270454406738
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0187673  Vali Loss: 0.0291268 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915190  Vali macro F1 0.9880937 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.4033100605010986
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0182910  Vali Loss: 0.0295265 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915120  Vali macro F1 0.9876762 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.402277946472168
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0200257  Vali Loss: 0.0416574 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858649  Vali macro F1 0.9825339 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.4067418575286865
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0177869  Vali Loss: 0.0369197 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858649  Vali macro F1 0.9825339 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.4068760871887207
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0169718  Vali Loss: 0.0245110 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915120  Vali macro F1 0.9876762 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.4035718441009521
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0154736  Vali Loss: 0.0294954 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915120  Vali macro F1 0.9876762 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.4049203395843506
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0177094  Vali Loss: 0.0331242 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886936  Vali macro F1 0.9853154 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.4084069728851318
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0178543  Vali Loss: 0.0321470 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886936  Vali macro F1 0.9853154 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.404444694519043
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0164919  Vali Loss: 0.0285948 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915120  Vali macro F1 0.9876762 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.403630256652832
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0149567  Vali Loss: 0.0271188 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915120  Vali macro F1 0.9876762 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.4066245555877686
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0157617  Vali Loss: 0.0264715 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.407801628112793
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0155261  Vali Loss: 0.0264411 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943374  Vali macro F1 0.9904545 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886500  Test macro F1 0.9838194 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00275482 0.00243902 0.00239808 0.00322581 0.00564972 0.00588235
 0.00319489 0.00285714 0.00235294 0.00404858]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3083817958831787
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2587614  Vali Loss: 2.1182296 Vali Accuracy: 0.2768362  Vali weighted F1: 0.2120633  Vali macro F1 0.1523162 
Validation loss decreased (inf --> 2.118230).  Saving model ...
Epoch: 2 cost time: 1.3040053844451904
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8453955  Vali Loss: 1.3346000 Vali Accuracy: 0.6384181  Vali weighted F1: 0.6311348  Vali macro F1 0.5839593 
new best score!!!!
Validation loss decreased (2.118230 --> 1.334600).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.303750991821289
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2048189  Vali Loss: 0.8976675 Vali Accuracy: 0.7909605  Vali weighted F1: 0.7835495  Vali macro F1 0.7256495 
new best score!!!!
Validation loss decreased (1.334600 --> 0.897668).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3052916526794434
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8580307  Vali Loss: 0.5996968 Vali Accuracy: 0.8502825  Vali weighted F1: 0.8461011  Vali macro F1 0.8048626 
new best score!!!!
Validation loss decreased (0.897668 --> 0.599697).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3048052787780762
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6397308  Vali Loss: 0.4635964 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8642558  Vali macro F1 0.8116376 
new best score!!!!
Validation loss decreased (0.599697 --> 0.463596).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3025283813476562
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.4918043  Vali Loss: 0.3729520 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8822303  Vali macro F1 0.8181276 
new best score!!!!
Validation loss decreased (0.463596 --> 0.372952).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3074862957000732
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4044322  Vali Loss: 0.3196686 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8683716  Vali macro F1 0.8024782 
new best score!!!!
Validation loss decreased (0.372952 --> 0.319669).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.307103157043457
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3539240  Vali Loss: 0.2794451 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8773957  Vali macro F1 0.8138549 
new best score!!!!
Validation loss decreased (0.319669 --> 0.279445).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3019959926605225
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3156278  Vali Loss: 0.2318165 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9198613  Vali macro F1 0.8526638 
new best score!!!!
Validation loss decreased (0.279445 --> 0.231817).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3028573989868164
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2710782  Vali Loss: 0.2009496 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9215243  Vali macro F1 0.8728236 
new best score!!!!
Validation loss decreased (0.231817 --> 0.200950).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.306178092956543
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2406541  Vali Loss: 0.1857877 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9220895  Vali macro F1 0.8687501 
new best score!!!!
Validation loss decreased (0.200950 --> 0.185788).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3068616390228271
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2193498  Vali Loss: 0.1604251 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9312470  Vali macro F1 0.8715479 
new best score!!!!
Validation loss decreased (0.185788 --> 0.160425).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3047263622283936
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2035383  Vali Loss: 0.1533088 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9409525  Vali macro F1 0.8870805 
new best score!!!!
Validation loss decreased (0.160425 --> 0.153309).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3103840351104736
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1796494  Vali Loss: 0.1282044 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9218598  Vali macro F1 0.8608764 
new best score!!!!
Validation loss decreased (0.153309 --> 0.128204).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.316781759262085
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1630268  Vali Loss: 0.1299986 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9317037  Vali macro F1 0.8763126 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.309431552886963
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1526642  Vali Loss: 0.1245444 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9232664  Vali macro F1 0.8614639 
new best score!!!!
Validation loss decreased (0.128204 --> 0.124544).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3090271949768066
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1388584  Vali Loss: 0.1044724 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9459603  Vali macro F1 0.8822620 
new best score!!!!
Validation loss decreased (0.124544 --> 0.104472).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.322608232498169
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1374055  Vali Loss: 0.1140878 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9310937  Vali macro F1 0.8720856 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3161640167236328
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1306743  Vali Loss: 0.0991521 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9439966  Vali macro F1 0.8907905 
new best score!!!!
Validation loss decreased (0.104472 --> 0.099152).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3127095699310303
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1211993  Vali Loss: 0.1063010 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9345190  Vali macro F1 0.8784591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3133299350738525
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1130039  Vali Loss: 0.0847913 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9425374  Vali macro F1 0.8898081 
new best score!!!!
Validation loss decreased (0.099152 --> 0.084791).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3155217170715332
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1112110  Vali Loss: 0.0967094 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9351807  Vali macro F1 0.8787001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3118586540222168
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1066380  Vali Loss: 0.0813643 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9494173  Vali macro F1 0.8820931 
new best score!!!!
Validation loss decreased (0.084791 --> 0.081364).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3138210773468018
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1013627  Vali Loss: 0.0757044 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9547940  Vali macro F1 0.9066001 
new best score!!!!
Validation loss decreased (0.081364 --> 0.075704).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.319047451019287
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0985915  Vali Loss: 0.0776128 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9515665  Vali macro F1 0.9007892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3169443607330322
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0937313  Vali Loss: 0.0753826 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9609966  Vali macro F1 0.9215205 
new best score!!!!
Validation loss decreased (0.075704 --> 0.075383).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3169620037078857
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0884445  Vali Loss: 0.0741796 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9582223  Vali macro F1 0.9224284 
new best score!!!!
Validation loss decreased (0.075383 --> 0.074180).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3149092197418213
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0855470  Vali Loss: 0.0810798 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9693113  Vali macro F1 0.9343865 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3182260990142822
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0778135  Vali Loss: 0.0657363 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9638463  Vali macro F1 0.9245147 
new best score!!!!
Validation loss decreased (0.074180 --> 0.065736).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3138103485107422
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0751915  Vali Loss: 0.0651235 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9654559  Vali macro F1 0.9271753 
new best score!!!!
Validation loss decreased (0.065736 --> 0.065123).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3138039112091064
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0718924  Vali Loss: 0.0582316 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9721777  Vali macro F1 0.9410989 
new best score!!!!
Validation loss decreased (0.065123 --> 0.058232).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3176639080047607
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0640589  Vali Loss: 0.0605881 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660979  Vali macro F1 0.9298810 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.319345474243164
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0595570  Vali Loss: 0.0535635 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9721777  Vali macro F1 0.9410989 
new best score!!!!
Validation loss decreased (0.058232 --> 0.053563).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3159306049346924
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0553450  Vali Loss: 0.0585644 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9665687  Vali macro F1 0.9342460 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.3152120113372803
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0503443  Vali Loss: 0.0482037 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719543  Vali macro F1 0.9398968 
new best score!!!!
Validation loss decreased (0.053563 --> 0.048204).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.318302869796753
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0443470  Vali Loss: 0.0498600 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9777614  Vali macro F1 0.9544523 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3159124851226807
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0450502  Vali Loss: 0.0526959 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9651372  Vali macro F1 0.9297213 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3132579326629639
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0434542  Vali Loss: 0.0413133 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804897  Vali macro F1 0.9643450 
new best score!!!!
Validation loss decreased (0.048204 --> 0.041313).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3201234340667725
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0421146  Vali Loss: 0.0440568 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775472  Vali macro F1 0.9524360 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3197617530822754
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0351360  Vali Loss: 0.0449461 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804701  Vali macro F1 0.9631268 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.3156068325042725
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0326375  Vali Loss: 0.0382659 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9853376  Vali macro F1 0.9650794 
new best score!!!!
Validation loss decreased (0.041313 --> 0.038266).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3135795593261719
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0407471  Vali Loss: 0.0265231 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
new best score!!!!
Validation loss decreased (0.038266 --> 0.026523).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3187856674194336
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0362932  Vali Loss: 0.0370161 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776261  Vali macro F1 0.9607572 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3138813972473145
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0305009  Vali Loss: 0.0256205 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886968  Vali macro F1 0.9822619 
new best score!!!!
Validation loss decreased (0.026523 --> 0.025621).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3140788078308105
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0266127  Vali Loss: 0.0255564 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859381  Vali macro F1 0.9760401 
new best score!!!!
Validation loss decreased (0.025621 --> 0.025556).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3211743831634521
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0295269  Vali Loss: 0.0266278 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914397  Vali macro F1 0.9799798 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3164362907409668
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0253867  Vali Loss: 0.0600394 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9833058  Vali macro F1 0.9667543 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3250846862792969
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0289281  Vali Loss: 0.0154460 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.025556 --> 0.015446).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3159644603729248
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0241676  Vali Loss: 0.0215473 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9912026  Vali macro F1 0.9790476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3150031566619873
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0421546  Vali Loss: 0.0234242 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915203  Vali macro F1 0.9847380 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3127665519714355
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0330011  Vali Loss: 0.0231943 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915180  Vali macro F1 0.9843562 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3127946853637695
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0235378  Vali Loss: 0.0234677 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9855491  Vali macro F1 0.9744048 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.3152804374694824
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0227667  Vali Loss: 0.0243793 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9855491  Vali macro F1 0.9744048 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 1.3144769668579102
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0212225  Vali Loss: 0.0168061 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943134  Vali macro F1 0.9908358 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3144631385803223
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0139741  Vali Loss: 0.0185658 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.3138797283172607
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0126693  Vali Loss: 0.0177550 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.3152544498443604
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0145835  Vali Loss: 0.0162447 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943134  Vali macro F1 0.9908358 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.3124847412109375
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0116532  Vali Loss: 0.0174009 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 59 cost time: 1.3135006427764893
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0124174  Vali Loss: 0.0173815 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.3153033256530762
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0120922  Vali Loss: 0.0173566 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.3174331188201904
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0129031  Vali Loss: 0.0174254 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.3137829303741455
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0119356  Vali Loss: 0.0174379 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.3158905506134033
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0100885  Vali Loss: 0.0174276 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9921082  Test weighted F1: 0.9920876  Test macro F1 0.9907449 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3884446620941162
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0201100  Vali Loss: 0.0173167 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
Validation loss decreased (inf --> 0.017317).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3914508819580078
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0173010  Vali Loss: 0.0167762 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
new best score!!!!
Validation loss decreased (0.017317 --> 0.016776).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3884754180908203
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0154536  Vali Loss: 0.0153671 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
new best score!!!!
Validation loss decreased (0.016776 --> 0.015367).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.385723352432251
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0141633  Vali Loss: 0.0175102 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.3857955932617188
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0139310  Vali Loss: 0.0174721 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.389596939086914
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0126318  Vali Loss: 0.0140965 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
new best score!!!!
Validation loss decreased (0.015367 --> 0.014097).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.3871181011199951
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0110569  Vali Loss: 0.0153564 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.3856534957885742
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0137660  Vali Loss: 0.0154342 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.3890368938446045
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0140732  Vali Loss: 0.0148068 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.388871192932129
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0135806  Vali Loss: 0.0148054 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 1.3852424621582031
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0126188  Vali Loss: 0.0120270 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.014097 --> 0.012027).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.3861370086669922
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0121192  Vali Loss: 0.0125887 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.3896052837371826
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0119473  Vali Loss: 0.0163154 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.3850159645080566
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0112148  Vali Loss: 0.0123462 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942219  Vali macro F1 0.9863636 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.3884849548339844
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0127521  Vali Loss: 0.0128167 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.3892817497253418
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0109744  Vali Loss: 0.0118066 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.012027 --> 0.011807).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.3901495933532715
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0115913  Vali Loss: 0.0119457 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.386080265045166
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0111232  Vali Loss: 0.0149281 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.385805368423462
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0119263  Vali Loss: 0.0137555 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.389331340789795
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0092706  Vali Loss: 0.0132012 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942219  Vali macro F1 0.9863636 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.3846352100372314
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0118297  Vali Loss: 0.0109690 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943134  Vali macro F1 0.9908358 
new best score!!!!
Validation loss decreased (0.011807 --> 0.010969).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 1.3857131004333496
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0093100  Vali Loss: 0.0106052 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.010969 --> 0.010605).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.38993501663208
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0089910  Vali Loss: 0.0108494 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.3892583847045898
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0101748  Vali Loss: 0.0120091 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.385983943939209
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0100288  Vali Loss: 0.0121285 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.3878917694091797
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0085199  Vali Loss: 0.0150667 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.3909432888031006
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0084353  Vali Loss: 0.0102447 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.010605 --> 0.010245).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 1.3866894245147705
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0110352  Vali Loss: 0.0139210 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.3858351707458496
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0098078  Vali Loss: 0.0100003 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.010245 --> 0.010000).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 1.388765573501587
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0070448  Vali Loss: 0.0108435 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 1.3903486728668213
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0089775  Vali Loss: 0.0092967 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.010000 --> 0.009297).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 1.3866117000579834
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0100150  Vali Loss: 0.0113589 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 1.387138843536377
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0077928  Vali Loss: 0.0113768 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942219  Vali macro F1 0.9863636 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 1.3893177509307861
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0086299  Vali Loss: 0.0121854 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 1.385420560836792
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0083615  Vali Loss: 0.0096649 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 1.3861782550811768
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0072869  Vali Loss: 0.0178587 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 37 cost time: 1.3892779350280762
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0086109  Vali Loss: 0.0138131 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9844139 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 1.3912067413330078
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0072391  Vali Loss: 0.0098649 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 1.386190414428711
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0062775  Vali Loss: 0.0098801 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 1.3876190185546875
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0076428  Vali Loss: 0.0096546 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 1.3890166282653809
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0059309  Vali Loss: 0.0108773 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 42 cost time: 1.386125087738037
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0068298  Vali Loss: 0.0098180 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 43 cost time: 1.3858757019042969
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0077515  Vali Loss: 0.0095448 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9869048 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 44 cost time: 1.3903696537017822
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0077060  Vali Loss: 0.0094418 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 45 cost time: 1.393571138381958
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0069815  Vali Loss: 0.0091369 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.009297 --> 0.009137).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 1.3858485221862793
Fine Tuning VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0067445  Vali Loss: 0.0092833 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 47 cost time: 1.3875482082366943
Fine Tuning VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0059459  Vali Loss: 0.0093413 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 48 cost time: 1.3887419700622559
Fine Tuning VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0074808  Vali Loss: 0.0091866 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 49 cost time: 1.3862228393554688
Fine Tuning VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0071496  Vali Loss: 0.0090927 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.009137 --> 0.009093).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 1.3874156475067139
Fine Tuning VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0075667  Vali Loss: 0.0089933 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.009093 --> 0.008993).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 1.3891139030456543
Fine Tuning VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0061938  Vali Loss: 0.0089398 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
new best score!!!!
Validation loss decreased (0.008993 --> 0.008940).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 52 cost time: 1.3903460502624512
Fine Tuning VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0072443  Vali Loss: 0.0089939 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 53 cost time: 1.3860244750976562
Fine Tuning VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0080887  Vali Loss: 0.0090726 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 54 cost time: 1.3865232467651367
Fine Tuning VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0067513  Vali Loss: 0.0090718 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 55 cost time: 1.3891003131866455
Fine Tuning VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0057763  Vali Loss: 0.0090751 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 56 cost time: 1.3867905139923096
Fine Tuning VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0062659  Vali Loss: 0.0091577 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 57 cost time: 1.3852481842041016
Fine Tuning VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0065506  Vali Loss: 0.0091657 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 58 cost time: 1.389765739440918
Fine Tuning VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0065640  Vali Loss: 0.0091721 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 59 cost time: 1.3904850482940674
Fine Tuning VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0083014  Vali Loss: 0.0091749 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 60 cost time: 1.3863697052001953
Fine Tuning VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0075593  Vali Loss: 0.0091537 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 61 cost time: 1.3879740238189697
Fine Tuning VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0055753  Vali Loss: 0.0091364 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 62 cost time: 1.3899378776550293
Fine Tuning VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0062140  Vali Loss: 0.0091354 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 63 cost time: 1.387099027633667
Fine Tuning VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0071623  Vali Loss: 0.0091339 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 64 cost time: 1.3859879970550537
Fine Tuning VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0058362  Vali Loss: 0.0091341 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 65 cost time: 1.3885183334350586
Fine Tuning VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0072402  Vali Loss: 0.0091352 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 66 cost time: 1.3889613151550293
Fine Tuning VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0058480  Vali Loss: 0.0091350 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971466  Vali macro F1 0.9933266 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943630  Test weighted F1: 0.9943496  Test macro F1 0.9945050 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 285395
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.002849   0.00238663 0.00242718 0.00324675 0.00552486 0.00552486
 0.00308642 0.00288184 0.00236407 0.0041841 ]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.360236406326294
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2561633  Vali Loss: 2.1555029 Vali Accuracy: 0.2344633  Vali weighted F1: 0.1083449  Vali macro F1 0.0875193 
Validation loss decreased (inf --> 2.155503).  Saving model ...
Epoch: 2 cost time: 1.3076939582824707
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8641752  Vali Loss: 1.3993994 Vali Accuracy: 0.4971751  Vali weighted F1: 0.4643275  Vali macro F1 0.4415131 
new best score!!!!
Validation loss decreased (2.155503 --> 1.399399).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3101720809936523
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2743076  Vali Loss: 0.9039520 Vali Accuracy: 0.7372881  Vali weighted F1: 0.7324970  Vali macro F1 0.6903981 
new best score!!!!
Validation loss decreased (1.399399 --> 0.903952).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3114421367645264
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9238165  Vali Loss: 0.6516980 Vali Accuracy: 0.7542373  Vali weighted F1: 0.7353058  Vali macro F1 0.6868465 
new best score!!!!
Validation loss decreased (0.903952 --> 0.651698).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3165559768676758
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7078167  Vali Loss: 0.5126458 Vali Accuracy: 0.7994350  Vali weighted F1: 0.7899248  Vali macro F1 0.7501835 
new best score!!!!
Validation loss decreased (0.651698 --> 0.512646).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3083021640777588
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5652600  Vali Loss: 0.4032326 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8645314  Vali macro F1 0.8341418 
new best score!!!!
Validation loss decreased (0.512646 --> 0.403233).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3268005847930908
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4748124  Vali Loss: 0.3443679 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8683512  Vali macro F1 0.8105243 
new best score!!!!
Validation loss decreased (0.403233 --> 0.344368).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3107476234436035
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.4105452  Vali Loss: 0.3008849 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9091280  Vali macro F1 0.8778332 
new best score!!!!
Validation loss decreased (0.344368 --> 0.300885).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3088583946228027
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3598719  Vali Loss: 0.2626934 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9030469  Vali macro F1 0.8571536 
new best score!!!!
Validation loss decreased (0.300885 --> 0.262693).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.307856559753418
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.3276189  Vali Loss: 0.2804050 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9142995  Vali macro F1 0.8875204 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 1.3111646175384521
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2969239  Vali Loss: 0.1959335 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9255742  Vali macro F1 0.8950458 
new best score!!!!
Validation loss decreased (0.262693 --> 0.195933).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.308640718460083
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2600753  Vali Loss: 0.1763860 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9429268  Vali macro F1 0.9142316 
new best score!!!!
Validation loss decreased (0.195933 --> 0.176386).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3066449165344238
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2316935  Vali Loss: 0.1607475 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9320612  Vali macro F1 0.8937456 
new best score!!!!
Validation loss decreased (0.176386 --> 0.160747).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3079161643981934
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.2082634  Vali Loss: 0.1369109 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9513384  Vali macro F1 0.9285167 
new best score!!!!
Validation loss decreased (0.160747 --> 0.136911).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3091537952423096
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1823159  Vali Loss: 0.1187122 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630717  Vali macro F1 0.9372377 
new best score!!!!
Validation loss decreased (0.136911 --> 0.118712).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3012940883636475
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1655782  Vali Loss: 0.1056386 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9686445  Vali macro F1 0.9454509 
new best score!!!!
Validation loss decreased (0.118712 --> 0.105639).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3133649826049805
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1497734  Vali Loss: 0.0983847 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9683837  Vali macro F1 0.9496164 
new best score!!!!
Validation loss decreased (0.105639 --> 0.098385).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3156781196594238
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1337540  Vali Loss: 0.0976340 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9560325  Vali macro F1 0.9232300 
new best score!!!!
Validation loss decreased (0.098385 --> 0.097634).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3078193664550781
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1309164  Vali Loss: 0.0998052 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9579263  Vali macro F1 0.9344607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3033809661865234
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1231485  Vali Loss: 0.0821907 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9686490  Vali macro F1 0.9451365 
new best score!!!!
Validation loss decreased (0.097634 --> 0.082191).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3058412075042725
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1148909  Vali Loss: 0.0809263 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773267  Vali macro F1 0.9719263 
new best score!!!!
Validation loss decreased (0.082191 --> 0.080926).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3104760646820068
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1043759  Vali Loss: 0.0923491 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9532631  Vali macro F1 0.9214744 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3059654235839844
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0979519  Vali Loss: 0.0617441 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829382  Vali macro F1 0.9775113 
new best score!!!!
Validation loss decreased (0.080926 --> 0.061744).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.307035207748413
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0927235  Vali Loss: 0.0567015 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773958  Vali macro F1 0.9596813 
new best score!!!!
Validation loss decreased (0.061744 --> 0.056702).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.310791015625
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0762499  Vali Loss: 0.0397109 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886105  Vali macro F1 0.9851888 
new best score!!!!
Validation loss decreased (0.056702 --> 0.039711).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3102529048919678
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0690665  Vali Loss: 0.0378106 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885761  Vali macro F1 0.9828075 
new best score!!!!
Validation loss decreased (0.039711 --> 0.037811).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3069376945495605
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0683204  Vali Loss: 0.0338807 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914969  Vali macro F1 0.9910078 
new best score!!!!
Validation loss decreased (0.037811 --> 0.033881).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3072700500488281
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0673996  Vali Loss: 0.0406756 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832488  Vali macro F1 0.9760684 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3094367980957031
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0634254  Vali Loss: 0.0448801 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802611  Vali macro F1 0.9728425 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.3064780235290527
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0630445  Vali Loss: 0.0594240 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684290  Vali macro F1 0.9542526 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 1.302553415298462
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0678249  Vali Loss: 0.0384168 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858306  Vali macro F1 0.9808143 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 1.3091716766357422
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0469162  Vali Loss: 0.0247835 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913971  Vali macro F1 0.9862942 
new best score!!!!
Validation loss decreased (0.033881 --> 0.024784).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3084616661071777
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0543510  Vali Loss: 0.0285346 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886071  Vali macro F1 0.9853634 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3047873973846436
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0460930  Vali Loss: 0.0232943 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943380  Vali macro F1 0.9953082 
new best score!!!!
Validation loss decreased (0.024784 --> 0.023294).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3083770275115967
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0436126  Vali Loss: 0.0298172 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914691  Vali macro F1 0.9905280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3138253688812256
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0416241  Vali Loss: 0.0302390 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915681  Vali macro F1 0.9899897 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3017659187316895
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0401397  Vali Loss: 0.0171013 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943669  Vali macro F1 0.9891523 
new best score!!!!
Validation loss decreased (0.023294 --> 0.017101).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.319352388381958
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0376486  Vali Loss: 0.0161419 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
new best score!!!!
Validation loss decreased (0.017101 --> 0.016142).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3099780082702637
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0325337  Vali Loss: 0.0158288 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943154  Vali macro F1 0.9900617 
new best score!!!!
Validation loss decreased (0.016142 --> 0.015829).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3103864192962646
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0327897  Vali Loss: 0.0175289 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943669  Vali macro F1 0.9891523 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3075227737426758
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0319835  Vali Loss: 0.0258549 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887938  Vali macro F1 0.9844472 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.3070306777954102
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0286149  Vali Loss: 0.0326947 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830167  Vali macro F1 0.9825989 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.3109216690063477
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0259883  Vali Loss: 0.0111826 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
new best score!!!!
Validation loss decreased (0.015829 --> 0.011183).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.307443380355835
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0323470  Vali Loss: 0.0166029 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943359  Vali macro F1 0.9912032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3080406188964844
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0283416  Vali Loss: 0.0180085 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943785  Vali macro F1 0.9926024 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.3112781047821045
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0254660  Vali Loss: 0.0136240 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.3106577396392822
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0202999  Vali Loss: 0.0131523 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.3082785606384277
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0187558  Vali Loss: 0.0197639 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9944845  Vali macro F1 0.9895034 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 1.3088908195495605
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0183863  Vali Loss: 0.0134633 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3075027465820312
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0153962  Vali Loss: 0.0098745 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943669  Vali macro F1 0.9891523 
new best score!!!!
Validation loss decreased (0.011183 --> 0.009875).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.307037353515625
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0139847  Vali Loss: 0.0104521 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.3062114715576172
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0138818  Vali Loss: 0.0100814 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.3114516735076904
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0141337  Vali Loss: 0.0093391 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
new best score!!!!
Validation loss decreased (0.009875 --> 0.009339).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.3107507228851318
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0155622  Vali Loss: 0.0087226 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.009339 --> 0.008723).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.3075242042541504
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0135693  Vali Loss: 0.0081674 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008723 --> 0.008167).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.3103678226470947
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0133771  Vali Loss: 0.0078485 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
new best score!!!!
Validation loss decreased (0.008167 --> 0.007849).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.3142802715301514
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0128160  Vali Loss: 0.0146480 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9944845  Vali macro F1 0.9895034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.3110253810882568
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0131162  Vali Loss: 0.0085735 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.310227632522583
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0135632  Vali Loss: 0.0076471 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007849 --> 0.007647).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.3152613639831543
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0135024  Vali Loss: 0.0089533 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.3150794506072998
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0142855  Vali Loss: 0.0107158 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 1.3095636367797852
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0129465  Vali Loss: 0.0116440 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 1.3102381229400635
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0122304  Vali Loss: 0.0125476 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 1.3131310939788818
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0135037  Vali Loss: 0.0126858 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 65 cost time: 1.3066976070404053
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0126269  Vali Loss: 0.0127031 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.3073241710662842
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0119956  Vali Loss: 0.0129506 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 1.3156073093414307
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0125951  Vali Loss: 0.0128571 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 1.309509038925171
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0124662  Vali Loss: 0.0127901 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 1.3250789642333984
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0126953  Vali Loss: 0.0126737 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 70 cost time: 1.3086283206939697
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0126659  Vali Loss: 0.0126696 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.3131489753723145
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0125370  Vali Loss: 0.0126493 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.3078980445861816
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0110492  Vali Loss: 0.0126218 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.3092257976531982
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0134901  Vali Loss: 0.0126177 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 1.3104033470153809
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0119418  Vali Loss: 0.0126120 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886581  Test macro F1 0.9873604 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3982353210449219
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0145052  Vali Loss: 0.0135451 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
Validation loss decreased (inf --> 0.013545).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3977243900299072
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0130970  Vali Loss: 0.0134732 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
new best score!!!!
Validation loss decreased (0.013545 --> 0.013473).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3946318626403809
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0138293  Vali Loss: 0.0110213 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
new best score!!!!
Validation loss decreased (0.013473 --> 0.011021).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3943634033203125
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0121651  Vali Loss: 0.0153940 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.3988757133483887
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0128576  Vali Loss: 0.0131746 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.3961591720581055
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0134452  Vali Loss: 0.0075817 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
new best score!!!!
Validation loss decreased (0.011021 --> 0.007582).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.3918533325195312
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0135846  Vali Loss: 0.0105091 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.3938758373260498
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0117230  Vali Loss: 0.0126167 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.3958475589752197
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0105084  Vali Loss: 0.0119721 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.3914313316345215
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0100349  Vali Loss: 0.0141424 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 1.392413854598999
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0135055  Vali Loss: 0.0119170 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 1.395068883895874
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0087964  Vali Loss: 0.0124908 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.3974192142486572
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0099720  Vali Loss: 0.0121603 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.392975091934204
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0125345  Vali Loss: 0.0112328 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.3924875259399414
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0093155  Vali Loss: 0.0132350 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.3952281475067139
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0113371  Vali Loss: 0.0121390 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 1.3926544189453125
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0086881  Vali Loss: 0.0116547 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.3919918537139893
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0097363  Vali Loss: 0.0112498 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.3966443538665771
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0099689  Vali Loss: 0.0113255 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.3950409889221191
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0089225  Vali Loss: 0.0110874 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.392876148223877
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0097448  Vali Loss: 0.0109338 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9897932  Test macro F1 0.9895454 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00271739 0.002331   0.00242131 0.00326797 0.00595238 0.00578035
 0.00303951 0.00301205 0.00238095 0.00404858]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3072421550750732
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2549230  Vali Loss: 2.1515814 Vali Accuracy: 0.2344633  Vali weighted F1: 0.1155176  Vali macro F1 0.0931216 
Validation loss decreased (inf --> 2.151581).  Saving model ...
Epoch: 2 cost time: 1.3064460754394531
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8610572  Vali Loss: 1.3981734 Vali Accuracy: 0.4915254  Vali weighted F1: 0.4580519  Vali macro F1 0.4374178 
new best score!!!!
Validation loss decreased (2.151581 --> 1.398173).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3281903266906738
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2858122  Vali Loss: 0.9229187 Vali Accuracy: 0.7033898  Vali weighted F1: 0.6904267  Vali macro F1 0.6520739 
new best score!!!!
Validation loss decreased (1.398173 --> 0.922919).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.306361198425293
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9542740  Vali Loss: 0.7091809 Vali Accuracy: 0.7372881  Vali weighted F1: 0.7166251  Vali macro F1 0.6676448 
new best score!!!!
Validation loss decreased (0.922919 --> 0.709181).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3027310371398926
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7389973  Vali Loss: 0.5174975 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8463042  Vali macro F1 0.8184577 
new best score!!!!
Validation loss decreased (0.709181 --> 0.517498).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.305039882659912
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.6012112  Vali Loss: 0.4316357 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8632903  Vali macro F1 0.8287343 
new best score!!!!
Validation loss decreased (0.517498 --> 0.431636).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.302478313446045
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.5016694  Vali Loss: 0.3610060 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8762466  Vali macro F1 0.8332005 
new best score!!!!
Validation loss decreased (0.431636 --> 0.361006).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3009421825408936
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.4205585  Vali Loss: 0.2961723 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8877828  Vali macro F1 0.8279560 
new best score!!!!
Validation loss decreased (0.361006 --> 0.296172).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3115370273590088
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3660061  Vali Loss: 0.2807642 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9054124  Vali macro F1 0.8669114 
new best score!!!!
Validation loss decreased (0.296172 --> 0.280764).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.321455717086792
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.3365608  Vali Loss: 0.2380568 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9239803  Vali macro F1 0.8907445 
new best score!!!!
Validation loss decreased (0.280764 --> 0.238057).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3026847839355469
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2933654  Vali Loss: 0.2154450 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9248302  Vali macro F1 0.8903278 
new best score!!!!
Validation loss decreased (0.238057 --> 0.215445).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2973082065582275
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2599436  Vali Loss: 0.1768639 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9507035  Vali macro F1 0.9209373 
new best score!!!!
Validation loss decreased (0.215445 --> 0.176864).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2948603630065918
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2255902  Vali Loss: 0.1560710 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9349266  Vali macro F1 0.8914243 
new best score!!!!
Validation loss decreased (0.176864 --> 0.156071).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3029594421386719
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.2020454  Vali Loss: 0.1490438 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9487390  Vali macro F1 0.9256057 
new best score!!!!
Validation loss decreased (0.156071 --> 0.149044).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2980799674987793
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1823184  Vali Loss: 0.1195884 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659728  Vali macro F1 0.9373886 
new best score!!!!
Validation loss decreased (0.149044 --> 0.119588).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2992699146270752
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1688476  Vali Loss: 0.1156739 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9490241  Vali macro F1 0.9101896 
new best score!!!!
Validation loss decreased (0.119588 --> 0.115674).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3016138076782227
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1501193  Vali Loss: 0.1117349 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9548627  Vali macro F1 0.9204365 
new best score!!!!
Validation loss decreased (0.115674 --> 0.111735).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3049383163452148
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1364342  Vali Loss: 0.1314444 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9415257  Vali macro F1 0.8923874 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3060293197631836
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1345525  Vali Loss: 0.0937250 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9626902  Vali macro F1 0.9366733 
new best score!!!!
Validation loss decreased (0.111735 --> 0.093725).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2997562885284424
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1224239  Vali Loss: 0.0759244 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746921  Vali macro F1 0.9569047 
new best score!!!!
Validation loss decreased (0.093725 --> 0.075924).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3057126998901367
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1074104  Vali Loss: 0.0864093 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9594859  Vali macro F1 0.9306758 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.3013184070587158
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1128620  Vali Loss: 0.0682679 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746415  Vali macro F1 0.9607021 
new best score!!!!
Validation loss decreased (0.075924 --> 0.068268).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3059229850769043
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1038944  Vali Loss: 0.0621627 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831090  Vali macro F1 0.9678789 
new best score!!!!
Validation loss decreased (0.068268 --> 0.062163).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.304689645767212
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0888506  Vali Loss: 0.0516437 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803337  Vali macro F1 0.9684841 
new best score!!!!
Validation loss decreased (0.062163 --> 0.051644).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3034038543701172
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0829302  Vali Loss: 0.0584859 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828124  Vali macro F1 0.9720207 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3029708862304688
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0740704  Vali Loss: 0.0396413 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887399  Vali macro F1 0.9796294 
new best score!!!!
Validation loss decreased (0.051644 --> 0.039641).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3011932373046875
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0837421  Vali Loss: 0.0467854 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859369  Vali macro F1 0.9771899 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3056583404541016
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0754563  Vali Loss: 0.0397468 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859515  Vali macro F1 0.9740478 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.30039644241333
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0687968  Vali Loss: 0.0355197 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914396  Vali macro F1 0.9848619 
new best score!!!!
Validation loss decreased (0.039641 --> 0.035520).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3016293048858643
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0595097  Vali Loss: 0.0290836 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915624  Vali macro F1 0.9857291 
new best score!!!!
Validation loss decreased (0.035520 --> 0.029084).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3072078227996826
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0546517  Vali Loss: 0.0311131 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915624  Vali macro F1 0.9857291 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3095388412475586
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0573158  Vali Loss: 0.0462908 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886400  Vali macro F1 0.9814527 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.302464246749878
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0464738  Vali Loss: 0.0201853 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943294  Vali macro F1 0.9911734 
new best score!!!!
Validation loss decreased (0.029084 --> 0.020185).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.322235345840454
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0378293  Vali Loss: 0.0235276 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.3020930290222168
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0409525  Vali Loss: 0.0313527 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858472  Vali macro F1 0.9775650 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.3010423183441162
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0440191  Vali Loss: 0.0182335 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971780  Vali macro F1 0.9973867 
new best score!!!!
Validation loss decreased (0.020185 --> 0.018233).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3046035766601562
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0395102  Vali Loss: 0.0216005 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915076  Vali macro F1 0.9891834 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3047142028808594
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0341105  Vali Loss: 0.0340914 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887327  Vali macro F1 0.9827173 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.304201602935791
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0394819  Vali Loss: 0.0142928 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.018233 --> 0.014293).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3072397708892822
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0340747  Vali Loss: 0.0150649 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971724  Vali macro F1 0.9976589 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3045408725738525
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0287580  Vali Loss: 0.0156155 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.3080105781555176
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0284379  Vali Loss: 0.0166270 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943656  Vali macro F1 0.9913744 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.304635763168335
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0302081  Vali Loss: 0.0149336 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943846  Vali macro F1 0.9926318 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 1.3056423664093018
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0368871  Vali Loss: 0.0100555 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014293 --> 0.010056).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3093247413635254
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0252218  Vali Loss: 0.0200352 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915345  Vali macro F1 0.9923627 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.305860996246338
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0233097  Vali Loss: 0.0123662 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.2990977764129639
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0216432  Vali Loss: 0.0100829 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.3020100593566895
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0200240  Vali Loss: 0.0143238 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 1.3061952590942383
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0195521  Vali Loss: 0.0118957 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 50 cost time: 1.300562858581543
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0162576  Vali Loss: 0.0113451 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.300142526626587
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0144470  Vali Loss: 0.0112494 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.3067915439605713
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0142792  Vali Loss: 0.0109981 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.3055572509765625
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0133715  Vali Loss: 0.0107604 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 1.30224609375
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0148864  Vali Loss: 0.0111352 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 55 cost time: 1.300241470336914
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0140790  Vali Loss: 0.0108735 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.3025388717651367
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0123996  Vali Loss: 0.0106800 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.3043529987335205
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0129459  Vali Loss: 0.0105730 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.3020281791687012
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0124440  Vali Loss: 0.0105208 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.304046869277954
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0125254  Vali Loss: 0.0103790 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932096  Test macro F1 0.9917999 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3961200714111328
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0206219  Vali Loss: 0.0089218 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.008922).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.396838665008545
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0219502  Vali Loss: 0.0076079 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008922 --> 0.007608).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.394848108291626
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0173692  Vali Loss: 0.0075103 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007608 --> 0.007510).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3936553001403809
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0179641  Vali Loss: 0.0071798 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007510 --> 0.007180).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.3984246253967285
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0158683  Vali Loss: 0.0072795 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.3972606658935547
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0162713  Vali Loss: 0.0080807 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.3941941261291504
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0159298  Vali Loss: 0.0070824 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007180 --> 0.007082).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.3947951793670654
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0156017  Vali Loss: 0.0081087 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.3981595039367676
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0155233  Vali Loss: 0.0068318 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007082 --> 0.006832).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.3938348293304443
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0169529  Vali Loss: 0.0060752 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006832 --> 0.006075).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.3946659564971924
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0156754  Vali Loss: 0.0067642 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.3978967666625977
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0138943  Vali Loss: 0.0051008 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006075 --> 0.005101).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.397228479385376
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0147395  Vali Loss: 0.0053846 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.3940002918243408
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0149786  Vali Loss: 0.0064833 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.3951528072357178
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0152709  Vali Loss: 0.0068910 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.3969943523406982
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0148775  Vali Loss: 0.0052763 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.393005132675171
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0146547  Vali Loss: 0.0055188 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 1.3938853740692139
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0164659  Vali Loss: 0.0046382 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005101 --> 0.004638).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.3975234031677246
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0124278  Vali Loss: 0.0127982 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943359  Vali macro F1 0.9912032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.3971683979034424
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0141198  Vali Loss: 0.0043456 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004638 --> 0.004346).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 1.3959016799926758
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0141965  Vali Loss: 0.0050194 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.3947136402130127
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0115177  Vali Loss: 0.0054056 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.4022328853607178
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0124560  Vali Loss: 0.0044027 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.395164966583252
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0102437  Vali Loss: 0.0049369 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.393317699432373
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0108499  Vali Loss: 0.0038997 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004346 --> 0.003900).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 1.397852897644043
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0095356  Vali Loss: 0.0053684 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.3974134922027588
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0098187  Vali Loss: 0.0045095 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.393967628479004
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0101277  Vali Loss: 0.0041037 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.394014596939087
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0120617  Vali Loss: 0.0042612 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.3960566520690918
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0088949  Vali Loss: 0.0041184 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 1.3949670791625977
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0098213  Vali Loss: 0.0038459 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003900 --> 0.003846).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 1.3942725658416748
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0104379  Vali Loss: 0.0035410 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003846 --> 0.003541).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 1.3976609706878662
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0107119  Vali Loss: 0.0035202 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003541 --> 0.003520).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 1.3976402282714844
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0086591  Vali Loss: 0.0035183 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003520 --> 0.003518).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 1.393524169921875
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0101877  Vali Loss: 0.0036256 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 1.4015321731567383
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0102858  Vali Loss: 0.0037553 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 1.3982465267181396
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0101624  Vali Loss: 0.0036638 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 1.3951902389526367
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0105660  Vali Loss: 0.0037076 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 1.395259141921997
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0085130  Vali Loss: 0.0037064 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 40 cost time: 1.4131312370300293
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0092075  Vali Loss: 0.0037038 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 1.3990461826324463
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0092236  Vali Loss: 0.0036955 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 1.395219326019287
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0088720  Vali Loss: 0.0036979 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 1.3940460681915283
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0112563  Vali Loss: 0.0037147 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 1.3986732959747314
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0088794  Vali Loss: 0.0037357 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 45 cost time: 1.3948554992675781
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0107436  Vali Loss: 0.0037368 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 46 cost time: 1.3938593864440918
Fine Tuning VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0089095  Vali Loss: 0.0037388 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 47 cost time: 1.3961796760559082
Fine Tuning VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0094896  Vali Loss: 0.0037413 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 48 cost time: 1.3963737487792969
Fine Tuning VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0092307  Vali Loss: 0.0037422 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 49 cost time: 1.3944101333618164
Fine Tuning VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0088314  Vali Loss: 0.0037415 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9977376  Test weighted F1: 0.9977374  Test macro F1 0.9978738 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00280112 0.00239808 0.00241546 0.00322581 0.00549451 0.00552486
 0.00324675 0.00292398 0.00236967 0.00396825]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.303236484527588
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2595433  Vali Loss: 2.1557892 Vali Accuracy: 0.2344633  Vali weighted F1: 0.1085171  Vali macro F1 0.0875124 
Validation loss decreased (inf --> 2.155789).  Saving model ...
Epoch: 2 cost time: 1.3058216571807861
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8669916  Vali Loss: 1.4071859 Vali Accuracy: 0.4887006  Vali weighted F1: 0.4465545  Vali macro F1 0.4341355 
new best score!!!!
Validation loss decreased (2.155789 --> 1.407186).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3069067001342773
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2988838  Vali Loss: 0.9508335 Vali Accuracy: 0.6977401  Vali weighted F1: 0.6860592  Vali macro F1 0.6562489 
new best score!!!!
Validation loss decreased (1.407186 --> 0.950833).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3037362098693848
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9555421  Vali Loss: 0.7006474 Vali Accuracy: 0.7683616  Vali weighted F1: 0.7499297  Vali macro F1 0.6999549 
new best score!!!!
Validation loss decreased (0.950833 --> 0.700647).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.303649663925171
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7536997  Vali Loss: 0.5362040 Vali Accuracy: 0.8050847  Vali weighted F1: 0.7976018  Vali macro F1 0.7662536 
new best score!!!!
Validation loss decreased (0.700647 --> 0.536204).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3021514415740967
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.6070200  Vali Loss: 0.4238437 Vali Accuracy: 0.8446328  Vali weighted F1: 0.8297634  Vali macro F1 0.7740476 
new best score!!!!
Validation loss decreased (0.536204 --> 0.423844).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3057730197906494
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.5018279  Vali Loss: 0.3646890 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8633638  Vali macro F1 0.8215775 
new best score!!!!
Validation loss decreased (0.423844 --> 0.364689).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3020524978637695
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.4245821  Vali Loss: 0.3041978 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9059504  Vali macro F1 0.8688684 
new best score!!!!
Validation loss decreased (0.364689 --> 0.304198).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.303147554397583
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3694622  Vali Loss: 0.2809980 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8797150  Vali macro F1 0.8281608 
new best score!!!!
Validation loss decreased (0.304198 --> 0.280998).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3095901012420654
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.3368762  Vali Loss: 0.2453932 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8916005  Vali macro F1 0.8321417 
new best score!!!!
Validation loss decreased (0.280998 --> 0.245393).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3120543956756592
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.3021506  Vali Loss: 0.2113739 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8989179  Vali macro F1 0.8456019 
new best score!!!!
Validation loss decreased (0.245393 --> 0.211374).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3130316734313965
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2608905  Vali Loss: 0.1916938 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9016791  Vali macro F1 0.8477651 
new best score!!!!
Validation loss decreased (0.211374 --> 0.191694).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3043532371520996
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2408058  Vali Loss: 0.1693077 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9380875  Vali macro F1 0.9059898 
new best score!!!!
Validation loss decreased (0.191694 --> 0.169308).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3285155296325684
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.2145640  Vali Loss: 0.1600380 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9157104  Vali macro F1 0.8601444 
new best score!!!!
Validation loss decreased (0.169308 --> 0.160038).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.306394338607788
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1995565  Vali Loss: 0.1500358 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9433222  Vali macro F1 0.9058767 
new best score!!!!
Validation loss decreased (0.160038 --> 0.150036).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3083763122558594
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1826515  Vali Loss: 0.1287228 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9319909  Vali macro F1 0.8782807 
new best score!!!!
Validation loss decreased (0.150036 --> 0.128723).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3056156635284424
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1619940  Vali Loss: 0.1151184 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9388773  Vali macro F1 0.8983803 
new best score!!!!
Validation loss decreased (0.128723 --> 0.115118).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3086369037628174
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1505285  Vali Loss: 0.0932647 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9651125  Vali macro F1 0.9355027 
new best score!!!!
Validation loss decreased (0.115118 --> 0.093265).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3033125400543213
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1360757  Vali Loss: 0.1112907 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9451262  Vali macro F1 0.8942859 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3019931316375732
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1258803  Vali Loss: 0.0950179 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9658827  Vali macro F1 0.9478030 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.305516004562378
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1229713  Vali Loss: 0.0837633 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744893  Vali macro F1 0.9538007 
new best score!!!!
Validation loss decreased (0.093265 --> 0.083763).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3039357662200928
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1114665  Vali Loss: 0.1114331 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9338584  Vali macro F1 0.8846405 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3008794784545898
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1042342  Vali Loss: 0.0652622 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744389  Vali macro F1 0.9523091 
new best score!!!!
Validation loss decreased (0.083763 --> 0.065262).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.305570125579834
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0981345  Vali Loss: 0.0834679 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9623157  Vali macro F1 0.9329178 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.304002285003662
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0968310  Vali Loss: 0.0598657 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775211  Vali macro F1 0.9627202 
new best score!!!!
Validation loss decreased (0.065262 --> 0.059866).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.302433729171753
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0891130  Vali Loss: 0.1026586 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9567027  Vali macro F1 0.9283809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.3032145500183105
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1002136  Vali Loss: 0.0599924 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774773  Vali macro F1 0.9623085 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.3073029518127441
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0842084  Vali Loss: 0.0485517 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915919  Vali macro F1 0.9822145 
new best score!!!!
Validation loss decreased (0.059866 --> 0.048552).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3045916557312012
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0678074  Vali Loss: 0.0384266 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.048552 --> 0.038427).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3036401271820068
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0573386  Vali Loss: 0.0340585 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914718  Vali macro F1 0.9815718 
new best score!!!!
Validation loss decreased (0.038427 --> 0.034058).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.307999849319458
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0596944  Vali Loss: 0.0499121 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831090  Vali macro F1 0.9678789 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3067588806152344
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0593155  Vali Loss: 0.0291082 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.034058 --> 0.029108).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3081250190734863
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0552983  Vali Loss: 0.0362019 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887025  Vali macro F1 0.9826665 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3024406433105469
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0482633  Vali Loss: 0.0283949 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.029108 --> 0.028395).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3092775344848633
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0481741  Vali Loss: 0.0307023 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915454  Vali macro F1 0.9864982 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3037564754486084
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0463898  Vali Loss: 0.0219701 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.028395 --> 0.021970).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.302307367324829
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0394142  Vali Loss: 0.0201730 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.021970 --> 0.020173).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3077714443206787
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0389217  Vali Loss: 0.0200253 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.020173 --> 0.020025).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.306668758392334
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0370478  Vali Loss: 0.0162377 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.020025 --> 0.016238).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3029489517211914
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0332926  Vali Loss: 0.0143708 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016238 --> 0.014371).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3107872009277344
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0416777  Vali Loss: 0.0479334 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9747646  Vali macro F1 0.9433333 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3060617446899414
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0474191  Vali Loss: 0.0225581 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3068792819976807
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0319805  Vali Loss: 0.0252868 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915083  Vali macro F1 0.9888621 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3081998825073242
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0279957  Vali Loss: 0.0136429 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014371 --> 0.013643).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3120741844177246
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0217785  Vali Loss: 0.0162697 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.309586524963379
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0229749  Vali Loss: 0.0146331 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.3074848651885986
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0225580  Vali Loss: 0.0132964 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.013643 --> 0.013296).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.306014060974121
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0179634  Vali Loss: 0.0114633 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.013296 --> 0.011463).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3093340396881104
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0165274  Vali Loss: 0.0153021 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3055057525634766
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0162460  Vali Loss: 0.0150392 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3101792335510254
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0183917  Vali Loss: 0.0134904 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943328  Vali macro F1 0.9914179 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3085172176361084
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0161634  Vali Loss: 0.0120275 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.3099627494812012
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0168961  Vali Loss: 0.0112683 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.011463 --> 0.011268).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.3085153102874756
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0196320  Vali Loss: 0.0086911 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.011268 --> 0.008691).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.3076319694519043
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0193451  Vali Loss: 0.0208285 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914952  Vali macro F1 0.9891655 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.3072288036346436
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0244549  Vali Loss: 0.0082254 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008691 --> 0.008225).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.3010094165802002
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0153001  Vali Loss: 0.0133918 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2988085746765137
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0320587  Vali Loss: 0.0276986 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915080  Vali macro F1 0.9885193 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.3020379543304443
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0240130  Vali Loss: 0.0102895 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 1.3027896881103516
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0159364  Vali Loss: 0.0100853 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 1.298471212387085
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0142615  Vali Loss: 0.0098783 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 62 cost time: 1.3015122413635254
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0120778  Vali Loss: 0.0094093 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.301867961883545
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0108997  Vali Loss: 0.0094473 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.2983348369598389
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0107746  Vali Loss: 0.0093739 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.2990491390228271
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0100280  Vali Loss: 0.0094350 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.3040428161621094
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0096636  Vali Loss: 0.0093076 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 67 cost time: 1.2988688945770264
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0090741  Vali Loss: 0.0093440 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.2986226081848145
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0097407  Vali Loss: 0.0094007 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.300668716430664
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0078543  Vali Loss: 0.0094410 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.3022572994232178
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0104972  Vali Loss: 0.0094621 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 1.3060121536254883
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0091831  Vali Loss: 0.0094525 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920929  Test macro F1 0.9909762 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3950228691101074
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0169470  Vali Loss: 0.0097639 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
Validation loss decreased (inf --> 0.009764).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3915801048278809
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0114545  Vali Loss: 0.0106127 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.3902766704559326
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0118685  Vali Loss: 0.0104021 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.3933143615722656
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0113327  Vali Loss: 0.0099438 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.3880300521850586
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0106426  Vali Loss: 0.0105175 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.3892731666564941
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0102506  Vali Loss: 0.0103533 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.392077922821045
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0113983  Vali Loss: 0.0104929 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.3939568996429443
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0101487  Vali Loss: 0.0104946 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.389014482498169
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0086111  Vali Loss: 0.0109281 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.389094591140747
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0090541  Vali Loss: 0.0100251 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.3936982154846191
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0091378  Vali Loss: 0.0101657 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.3910775184631348
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0085493  Vali Loss: 0.0103943 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.3889968395233154
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0087112  Vali Loss: 0.0105121 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.3927035331726074
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0093198  Vali Loss: 0.0104004 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.3927526473999023
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0079712  Vali Loss: 0.0104149 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.389054536819458
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0071397  Vali Loss: 0.0104204 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943494  Test macro F1 0.9940397 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00271003 0.00234742 0.00247525 0.00337838 0.00540541 0.00584795
 0.00310559 0.00282486 0.00240964 0.00411523]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.295377492904663
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2664187  Vali Loss: 2.1985588 Vali Accuracy: 0.2316384  Vali weighted F1: 0.1162584  Vali macro F1 0.0936474 
Validation loss decreased (inf --> 2.198559).  Saving model ...
Epoch: 2 cost time: 1.2964210510253906
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.9343424  Vali Loss: 1.4837122 Vali Accuracy: 0.5000000  Vali weighted F1: 0.4528156  Vali macro F1 0.4607787 
new best score!!!!
Validation loss decreased (2.198559 --> 1.483712).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3014380931854248
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3287144  Vali Loss: 0.9484672 Vali Accuracy: 0.6440678  Vali weighted F1: 0.6169187  Vali macro F1 0.6013821 
new best score!!!!
Validation loss decreased (1.483712 --> 0.948467).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3068912029266357
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9692763  Vali Loss: 0.7036951 Vali Accuracy: 0.7344633  Vali weighted F1: 0.7176330  Vali macro F1 0.6766868 
new best score!!!!
Validation loss decreased (0.948467 --> 0.703695).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.303046464920044
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7448049  Vali Loss: 0.5218093 Vali Accuracy: 0.8220339  Vali weighted F1: 0.8149240  Vali macro F1 0.7823641 
new best score!!!!
Validation loss decreased (0.703695 --> 0.521809).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3021178245544434
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5802611  Vali Loss: 0.3998497 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8381443  Vali macro F1 0.7795339 
new best score!!!!
Validation loss decreased (0.521809 --> 0.399850).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3047981262207031
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4868581  Vali Loss: 0.3370103 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8694534  Vali macro F1 0.8412464 
new best score!!!!
Validation loss decreased (0.399850 --> 0.337010).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2998046875
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.4001747  Vali Loss: 0.2806745 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9036550  Vali macro F1 0.8729034 
new best score!!!!
Validation loss decreased (0.337010 --> 0.280674).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3019464015960693
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3487613  Vali Loss: 0.2621438 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8735375  Vali macro F1 0.8111542 
new best score!!!!
Validation loss decreased (0.280674 --> 0.262144).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3042113780975342
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.3127335  Vali Loss: 0.2186477 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9042243  Vali macro F1 0.8539859 
new best score!!!!
Validation loss decreased (0.262144 --> 0.218648).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3048851490020752
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2822153  Vali Loss: 0.1933312 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9039868  Vali macro F1 0.8548417 
new best score!!!!
Validation loss decreased (0.218648 --> 0.193331).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3008863925933838
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2496134  Vali Loss: 0.1751517 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9349542  Vali macro F1 0.9032034 
new best score!!!!
Validation loss decreased (0.193331 --> 0.175152).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.298168659210205
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2247711  Vali Loss: 0.1508770 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9522689  Vali macro F1 0.9343868 
new best score!!!!
Validation loss decreased (0.175152 --> 0.150877).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3166775703430176
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.2047424  Vali Loss: 0.1373738 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9493883  Vali macro F1 0.9345140 
new best score!!!!
Validation loss decreased (0.150877 --> 0.137374).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.299086093902588
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1882123  Vali Loss: 0.1341412 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9491214  Vali macro F1 0.9111281 
new best score!!!!
Validation loss decreased (0.137374 --> 0.134141).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2980504035949707
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1675893  Vali Loss: 0.1068779 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659073  Vali macro F1 0.9473814 
new best score!!!!
Validation loss decreased (0.134141 --> 0.106878).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.300389289855957
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1560996  Vali Loss: 0.1019337 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742013  Vali macro F1 0.9583191 
new best score!!!!
Validation loss decreased (0.106878 --> 0.101934).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.30299973487854
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1408841  Vali Loss: 0.0807682 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9806904  Vali macro F1 0.9638017 
new best score!!!!
Validation loss decreased (0.101934 --> 0.080768).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3057255744934082
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1264242  Vali Loss: 0.0743590 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9721792  Vali macro F1 0.9560923 
new best score!!!!
Validation loss decreased (0.080768 --> 0.074359).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.298614501953125
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1045762  Vali Loss: 0.0667539 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831301  Vali macro F1 0.9713937 
new best score!!!!
Validation loss decreased (0.074359 --> 0.066754).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3038067817687988
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1045550  Vali Loss: 0.0662907 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9778258  Vali macro F1 0.9587136 
new best score!!!!
Validation loss decreased (0.066754 --> 0.066291).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3013732433319092
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0918443  Vali Loss: 0.0512971 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9888262  Vali macro F1 0.9807059 
new best score!!!!
Validation loss decreased (0.066291 --> 0.051297).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2992682456970215
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0847671  Vali Loss: 0.0534315 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802819  Vali macro F1 0.9655382 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.2987043857574463
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0765676  Vali Loss: 0.0384357 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943132  Vali macro F1 0.9902210 
new best score!!!!
Validation loss decreased (0.051297 --> 0.038436).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3017022609710693
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0709241  Vali Loss: 0.0516494 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773073  Vali macro F1 0.9678302 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.2963438034057617
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0694834  Vali Loss: 0.0574691 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802947  Vali macro F1 0.9686953 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 1.2962579727172852
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0666727  Vali Loss: 0.0444636 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9833886  Vali macro F1 0.9727736 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 1.3004300594329834
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0689521  Vali Loss: 0.0462098 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857220  Vali macro F1 0.9775259 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 1.298478126525879
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0533773  Vali Loss: 0.0275115 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9917689  Vali macro F1 0.9837936 
new best score!!!!
Validation loss decreased (0.038436 --> 0.027511).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2983694076538086
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0453082  Vali Loss: 0.0330237 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9889396  Vali macro F1 0.9811246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3018896579742432
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0404477  Vali Loss: 0.0252830 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.027511 --> 0.025283).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.299384593963623
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0448586  Vali Loss: 0.0215601 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886648  Vali macro F1 0.9848900 
new best score!!!!
Validation loss decreased (0.025283 --> 0.021560).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3040175437927246
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0347790  Vali Loss: 0.0164773 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.021560 --> 0.016477).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2946183681488037
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0326106  Vali Loss: 0.0221708 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9916537  Vali macro F1 0.9833893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2998874187469482
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0341955  Vali Loss: 0.0207581 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943669  Vali macro F1 0.9891523 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.293949842453003
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0271716  Vali Loss: 0.0186615 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943132  Vali macro F1 0.9902210 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 1.2943034172058105
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0272110  Vali Loss: 0.0216433 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 1.2984557151794434
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0255240  Vali Loss: 0.0118596 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016477 --> 0.011860).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3024952411651611
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0253898  Vali Loss: 0.0167334 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915083  Vali macro F1 0.9888621 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.2970974445343018
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0260245  Vali Loss: 0.0135010 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.3012828826904297
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0333692  Vali Loss: 0.0187361 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914851  Vali macro F1 0.9828612 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 1.3019893169403076
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0333450  Vali Loss: 0.0196450 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 1.3094568252563477
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0301114  Vali Loss: 0.0255614 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914941  Vali macro F1 0.9929460 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 1.2971255779266357
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0252780  Vali Loss: 0.0149094 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914691  Vali macro F1 0.9905280 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3017323017120361
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0175025  Vali Loss: 0.0116439 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943417  Vali macro F1 0.9929124 
new best score!!!!
Validation loss decreased (0.011860 --> 0.011644).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3003685474395752
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0173023  Vali Loss: 0.0099725 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.011644 --> 0.009973).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.2968637943267822
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0163901  Vali Loss: 0.0091958 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971724  Vali macro F1 0.9976589 
new best score!!!!
Validation loss decreased (0.009973 --> 0.009196).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2999145984649658
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0163505  Vali Loss: 0.0094067 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.3020830154418945
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0162070  Vali Loss: 0.0099542 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.299666404724121
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0156848  Vali Loss: 0.0093792 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.29762601852417
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0154139  Vali Loss: 0.0097667 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.3033087253570557
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0164368  Vali Loss: 0.0101858 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 1.300053596496582
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0162904  Vali Loss: 0.0101942 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2984809875488281
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0162660  Vali Loss: 0.0102389 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.2973506450653076
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0155824  Vali Loss: 0.0102525 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.3024625778198242
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0143501  Vali Loss: 0.0103719 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.2977924346923828
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0133804  Vali Loss: 0.0105093 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 1.2973687648773193
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0137577  Vali Loss: 0.0105048 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3010623455047607
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0135301  Vali Loss: 0.0105066 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.3004019260406494
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0147323  Vali Loss: 0.0104997 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.2986149787902832
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0150385  Vali Loss: 0.0105156 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.2985148429870605
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0154246  Vali Loss: 0.0105410 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886912  Test macro F1 0.9857865 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4008240699768066
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0170417  Vali Loss: 0.0105220 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
Validation loss decreased (inf --> 0.010522).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4036166667938232
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0147951  Vali Loss: 0.0116831 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.405893325805664
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0168776  Vali Loss: 0.0101108 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.010522 --> 0.010111).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4027903079986572
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0147107  Vali Loss: 0.0094772 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.010111 --> 0.009477).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.402327060699463
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0164244  Vali Loss: 0.0097876 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.4071671962738037
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0123682  Vali Loss: 0.0097966 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.4025697708129883
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0127679  Vali Loss: 0.0078964 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.009477 --> 0.007896).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.405714750289917
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0111022  Vali Loss: 0.0093400 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.4069948196411133
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0122786  Vali Loss: 0.0107883 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.4100561141967773
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0137564  Vali Loss: 0.0104933 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.4044032096862793
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0124252  Vali Loss: 0.0085186 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.4049177169799805
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0099781  Vali Loss: 0.0083006 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 1.4074695110321045
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0094930  Vali Loss: 0.0105612 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.4045891761779785
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0138648  Vali Loss: 0.0101419 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.4046745300292969
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0112826  Vali Loss: 0.0099779 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.406771183013916
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0120475  Vali Loss: 0.0085704 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.4073631763458252
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0115088  Vali Loss: 0.0100283 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 1.4034810066223145
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0089350  Vali Loss: 0.0100067 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.404878854751587
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0102558  Vali Loss: 0.0097849 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.407027006149292
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0116469  Vali Loss: 0.0095127 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.4037811756134033
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0097211  Vali Loss: 0.0094115 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.4040265083312988
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0100280  Vali Loss: 0.0093109 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886912  Test macro F1 0.9857865 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265252 0.00243309 0.00246305 0.00332226 0.00571429 0.00568182
 0.00314465 0.0028169  0.00238663 0.00409836]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.300516128540039
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2616723  Vali Loss: 2.1433298 Vali Accuracy: 0.2146893  Vali weighted F1: 0.0921391  Vali macro F1 0.0804612 
Validation loss decreased (inf --> 2.143330).  Saving model ...
Epoch: 2 cost time: 1.302912950515747
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8618566  Vali Loss: 1.4687831 Vali Accuracy: 0.4915254  Vali weighted F1: 0.4632311  Vali macro F1 0.4587909 
new best score!!!!
Validation loss decreased (2.143330 --> 1.468783).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3044862747192383
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2922699  Vali Loss: 1.0067148 Vali Accuracy: 0.6610169  Vali weighted F1: 0.6368324  Vali macro F1 0.6140413 
new best score!!!!
Validation loss decreased (1.468783 --> 1.006715).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3001644611358643
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9244592  Vali Loss: 0.7113180 Vali Accuracy: 0.7655367  Vali weighted F1: 0.7449625  Vali macro F1 0.7168236 
new best score!!!!
Validation loss decreased (1.006715 --> 0.711318).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3013179302215576
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7040882  Vali Loss: 0.5572743 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8177830  Vali macro F1 0.7914832 
new best score!!!!
Validation loss decreased (0.711318 --> 0.557274).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3029308319091797
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5655047  Vali Loss: 0.4681030 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8296326  Vali macro F1 0.7879511 
new best score!!!!
Validation loss decreased (0.557274 --> 0.468103).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3044853210449219
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4717849  Vali Loss: 0.4115994 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8481956  Vali macro F1 0.8149793 
new best score!!!!
Validation loss decreased (0.468103 --> 0.411599).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3010098934173584
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3965804  Vali Loss: 0.3449508 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8760443  Vali macro F1 0.8423770 
new best score!!!!
Validation loss decreased (0.411599 --> 0.344951).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3008677959442139
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3438234  Vali Loss: 0.2927426 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8998480  Vali macro F1 0.8669889 
new best score!!!!
Validation loss decreased (0.344951 --> 0.292743).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3008813858032227
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.3014703  Vali Loss: 0.2563956 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8837484  Vali macro F1 0.8365257 
new best score!!!!
Validation loss decreased (0.292743 --> 0.256396).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2974209785461426
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2705075  Vali Loss: 0.2301369 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9405753  Vali macro F1 0.9290772 
new best score!!!!
Validation loss decreased (0.256396 --> 0.230137).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2967126369476318
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2411705  Vali Loss: 0.2062171 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9208407  Vali macro F1 0.8916207 
new best score!!!!
Validation loss decreased (0.230137 --> 0.206217).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.298398494720459
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2146046  Vali Loss: 0.1874433 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9307586  Vali macro F1 0.9002951 
new best score!!!!
Validation loss decreased (0.206217 --> 0.187443).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3035476207733154
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1941921  Vali Loss: 0.1708897 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9517858  Vali macro F1 0.9332173 
new best score!!!!
Validation loss decreased (0.187443 --> 0.170890).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2950191497802734
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1757196  Vali Loss: 0.1452458 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9344402  Vali macro F1 0.9018374 
new best score!!!!
Validation loss decreased (0.170890 --> 0.145246).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3156235218048096
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1547279  Vali Loss: 0.1312494 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9548018  Vali macro F1 0.9326688 
new best score!!!!
Validation loss decreased (0.145246 --> 0.131249).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3001017570495605
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1433082  Vali Loss: 0.1203007 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9571007  Vali macro F1 0.9387932 
new best score!!!!
Validation loss decreased (0.131249 --> 0.120301).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2995948791503906
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1293452  Vali Loss: 0.1191232 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9651809  Vali macro F1 0.9520698 
new best score!!!!
Validation loss decreased (0.120301 --> 0.119123).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2968509197235107
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1164639  Vali Loss: 0.1138919 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9556972  Vali macro F1 0.9361128 
new best score!!!!
Validation loss decreased (0.119123 --> 0.113892).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2998442649841309
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1117935  Vali Loss: 0.1072385 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9680018  Vali macro F1 0.9542159 
new best score!!!!
Validation loss decreased (0.113892 --> 0.107239).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3044350147247314
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1080507  Vali Loss: 0.1093955 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9595475  Vali macro F1 0.9462108 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.297576665878296
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1018342  Vali Loss: 0.1077050 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9451356  Vali macro F1 0.9204172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 1.2995941638946533
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1098759  Vali Loss: 0.0911157 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9586513  Vali macro F1 0.9412124 
new best score!!!!
Validation loss decreased (0.107239 --> 0.091116).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2986671924591064
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1052191  Vali Loss: 0.0915270 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9708300  Vali macro F1 0.9563699 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.2978086471557617
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0903554  Vali Loss: 0.0816092 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688991  Vali macro F1 0.9579589 
new best score!!!!
Validation loss decreased (0.091116 --> 0.081609).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.298513412475586
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0762222  Vali Loss: 0.0784382 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9683988  Vali macro F1 0.9549117 
new best score!!!!
Validation loss decreased (0.081609 --> 0.078438).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3008320331573486
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0710741  Vali Loss: 0.0711896 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745121  Vali macro F1 0.9667460 
new best score!!!!
Validation loss decreased (0.078438 --> 0.071190).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.302440881729126
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0679038  Vali Loss: 0.0552073 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801324  Vali macro F1 0.9718251 
new best score!!!!
Validation loss decreased (0.071190 --> 0.055207).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.296255111694336
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0707336  Vali Loss: 0.0604337 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801296  Vali macro F1 0.9722356 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.2971274852752686
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0564351  Vali Loss: 0.0568350 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773082  Vali macro F1 0.9696751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.2989463806152344
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0500252  Vali Loss: 0.0504833 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
new best score!!!!
Validation loss decreased (0.055207 --> 0.050483).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2979283332824707
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0490767  Vali Loss: 0.0447058 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744833  Vali macro F1 0.9675251 
new best score!!!!
Validation loss decreased (0.050483 --> 0.044706).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2984871864318848
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0430089  Vali Loss: 0.0431044 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801518  Vali macro F1 0.9744383 
new best score!!!!
Validation loss decreased (0.044706 --> 0.043104).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3016846179962158
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0490121  Vali Loss: 0.1238362 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9426731  Vali macro F1 0.9156111 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.3023905754089355
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0529342  Vali Loss: 0.0463810 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802194  Vali macro F1 0.9795250 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.2978901863098145
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0384639  Vali Loss: 0.0336341 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9888972 
new best score!!!!
Validation loss decreased (0.043104 --> 0.033634).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2985024452209473
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0348231  Vali Loss: 0.0303227 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
new best score!!!!
Validation loss decreased (0.033634 --> 0.030323).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3013668060302734
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0309374  Vali Loss: 0.0310132 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.2974653244018555
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0260644  Vali Loss: 0.0538445 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801324  Vali macro F1 0.9718251 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.2975959777832031
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0248830  Vali Loss: 0.0389091 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830412  Vali macro F1 0.9791502 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 1.3005850315093994
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0262500  Vali Loss: 0.0315005 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830412  Vali macro F1 0.9791502 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 1.302100419998169
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0237863  Vali Loss: 0.0308229 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858676  Vali macro F1 0.9842380 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 43 cost time: 1.2971787452697754
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0210371  Vali Loss: 0.0327091 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.2944509983062744
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0191607  Vali Loss: 0.0291402 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
new best score!!!!
Validation loss decreased (0.030323 --> 0.029140).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3001039028167725
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0183520  Vali Loss: 0.0281267 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
new best score!!!!
Validation loss decreased (0.029140 --> 0.028127).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3123643398284912
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0178424  Vali Loss: 0.0298266 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9863327 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2898895740509033
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0182347  Vali Loss: 0.0275731 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
new best score!!!!
Validation loss decreased (0.028127 --> 0.027573).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.293879508972168
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0179047  Vali Loss: 0.0263568 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9863327 
new best score!!!!
Validation loss decreased (0.027573 --> 0.026357).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2947239875793457
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0154523  Vali Loss: 0.0254625 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
new best score!!!!
Validation loss decreased (0.026357 --> 0.025462).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.294588565826416
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0151338  Vali Loss: 0.0257446 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.2916779518127441
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0164686  Vali Loss: 0.0261826 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.292921781539917
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0156068  Vali Loss: 0.0266945 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.290588140487671
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0136915  Vali Loss: 0.0271479 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9838265 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 1.2915985584259033
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0152571  Vali Loss: 0.0254999 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 55 cost time: 1.294224500656128
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0151120  Vali Loss: 0.0252534 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
new best score!!!!
Validation loss decreased (0.025462 --> 0.025253).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2954747676849365
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0153235  Vali Loss: 0.0252279 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
new best score!!!!
Validation loss decreased (0.025253 --> 0.025228).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2898585796356201
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0153013  Vali Loss: 0.0252576 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.290252923965454
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0165211  Vali Loss: 0.0252203 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
new best score!!!!
Validation loss decreased (0.025228 --> 0.025220).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.293973684310913
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0144476  Vali Loss: 0.0251156 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
new best score!!!!
Validation loss decreased (0.025220 --> 0.025116).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2899010181427002
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0135755  Vali Loss: 0.0251491 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.2915103435516357
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0154026  Vali Loss: 0.0252772 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 1.2944934368133545
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0167497  Vali Loss: 0.0251915 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 1.294872522354126
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0175499  Vali Loss: 0.0253358 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 1.2895002365112305
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0164201  Vali Loss: 0.0253251 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 65 cost time: 1.2900748252868652
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0146095  Vali Loss: 0.0253368 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.2949268817901611
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0157986  Vali Loss: 0.0253260 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 1.291682481765747
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0154947  Vali Loss: 0.0253251 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 1.2907030582427979
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0149016  Vali Loss: 0.0252830 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 1.2948477268218994
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0161231  Vali Loss: 0.0253057 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 70 cost time: 1.2942943572998047
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0129312  Vali Loss: 0.0253098 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.2908318042755127
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0137293  Vali Loss: 0.0253107 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.2982206344604492
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0163519  Vali Loss: 0.0253113 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.3030788898468018
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0152033  Vali Loss: 0.0253042 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 1.2959816455841064
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0160991  Vali Loss: 0.0252982 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9884827 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909808  Test weighted F1: 0.9909782  Test macro F1 0.9888865 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4015018939971924
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0169940  Vali Loss: 0.0232939 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
Validation loss decreased (inf --> 0.023294).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3980133533477783
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0138097  Vali Loss: 0.0225448 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
new best score!!!!
Validation loss decreased (0.023294 --> 0.022545).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3980984687805176
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0142141  Vali Loss: 0.0231407 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.4006519317626953
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0134173  Vali Loss: 0.0223973 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9931973 
new best score!!!!
Validation loss decreased (0.022545 --> 0.022397).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.3979864120483398
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0142450  Vali Loss: 0.0240794 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.3975141048431396
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0142996  Vali Loss: 0.0330799 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830412  Vali macro F1 0.9791502 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.3999378681182861
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0136962  Vali Loss: 0.0263328 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 1.400625228881836
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0136894  Vali Loss: 0.0271065 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830412  Vali macro F1 0.9791502 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 1.3993096351623535
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0131128  Vali Loss: 0.0202223 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9931973 
new best score!!!!
Validation loss decreased (0.022397 --> 0.020222).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.3999133110046387
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0121615  Vali Loss: 0.0218673 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9931973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.4012539386749268
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0132971  Vali Loss: 0.0257472 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9888972 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.3981542587280273
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0118459  Vali Loss: 0.0270227 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9888972 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 1.3981342315673828
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0116877  Vali Loss: 0.0222696 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9910473 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 1.401033639907837
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0134535  Vali Loss: 0.0297286 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9838647 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 1.4013311862945557
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0113493  Vali Loss: 0.0186363 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9931973 
new best score!!!!
Validation loss decreased (0.020222 --> 0.018636).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.3983888626098633
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0143337  Vali Loss: 0.0232241 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858654  Vali macro F1 0.9813002 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.3980457782745361
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0132453  Vali Loss: 0.0218443 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.4017908573150635
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0115605  Vali Loss: 0.0227123 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.397036075592041
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0114958  Vali Loss: 0.0218501 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.3970704078674316
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0127899  Vali Loss: 0.0275087 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858654  Vali macro F1 0.9813002 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 1.4004487991333008
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0096833  Vali Loss: 0.0233944 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886994  Vali macro F1 0.9859766 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.4012506008148193
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0103361  Vali Loss: 0.0222913 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.3972201347351074
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0096653  Vali Loss: 0.0230042 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.3991057872772217
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0086033  Vali Loss: 0.0232156 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.4004032611846924
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0090940  Vali Loss: 0.0229072 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 1.398127794265747
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0095872  Vali Loss: 0.0228488 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.3977744579315186
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0098417  Vali Loss: 0.0228480 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.4028241634368896
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0108140  Vali Loss: 0.0229068 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.4018349647521973
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0115393  Vali Loss: 0.0229544 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.3988633155822754
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0098136  Vali Loss: 0.0229732 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9906328 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898534  Test weighted F1: 0.9898371  Test macro F1 0.9874645 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 285395
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00269542 0.00226757 0.00255102 0.0031348  0.00578035 0.00578035
 0.00319489 0.00290698 0.0023753  0.00420168]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3454489707946777
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2531846  Vali Loss: 2.1452339 Vali Accuracy: 0.1949153  Vali weighted F1: 0.1074088  Vali macro F1 0.0912429 
Validation loss decreased (inf --> 2.145234).  Saving model ...
Epoch: 2 cost time: 1.3004770278930664
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8849840  Vali Loss: 1.4207207 Vali Accuracy: 0.5903955  Vali weighted F1: 0.5615535  Vali macro F1 0.5202809 
new best score!!!!
Validation loss decreased (2.145234 --> 1.420721).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3034965991973877
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2044744  Vali Loss: 0.8863905 Vali Accuracy: 0.7118644  Vali weighted F1: 0.7079643  Vali macro F1 0.6678534 
new best score!!!!
Validation loss decreased (1.420721 --> 0.886391).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3041126728057861
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8387389  Vali Loss: 0.6462721 Vali Accuracy: 0.8135593  Vali weighted F1: 0.7962080  Vali macro F1 0.7543049 
new best score!!!!
Validation loss decreased (0.886391 --> 0.646272).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2985765933990479
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6554680  Vali Loss: 0.4909829 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8186600  Vali macro F1 0.7758187 
new best score!!!!
Validation loss decreased (0.646272 --> 0.490983).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3001751899719238
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5128050  Vali Loss: 0.4044855 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8906514  Vali macro F1 0.8699556 
new best score!!!!
Validation loss decreased (0.490983 --> 0.404485).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.304823875427246
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4237816  Vali Loss: 0.3417691 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8911879  Vali macro F1 0.8587807 
new best score!!!!
Validation loss decreased (0.404485 --> 0.341769).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.298205852508545
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3566194  Vali Loss: 0.2914266 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9006904  Vali macro F1 0.8513069 
new best score!!!!
Validation loss decreased (0.341769 --> 0.291427).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2956595420837402
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3064921  Vali Loss: 0.2605042 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9236906  Vali macro F1 0.9002705 
new best score!!!!
Validation loss decreased (0.291427 --> 0.260504).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3010804653167725
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2691544  Vali Loss: 0.2238813 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9356237  Vali macro F1 0.9037022 
new best score!!!!
Validation loss decreased (0.260504 --> 0.223881).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3026723861694336
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2428007  Vali Loss: 0.2234570 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9064725  Vali macro F1 0.8788157 
new best score!!!!
Validation loss decreased (0.223881 --> 0.223457).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2988202571868896
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2168304  Vali Loss: 0.1957015 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8901718  Vali macro F1 0.8460002 
new best score!!!!
Validation loss decreased (0.223457 --> 0.195701).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2995238304138184
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1918711  Vali Loss: 0.1862536 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9288373  Vali macro F1 0.9033367 
new best score!!!!
Validation loss decreased (0.195701 --> 0.186254).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.301910400390625
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1734422  Vali Loss: 0.1715756 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9239937  Vali macro F1 0.8895383 
new best score!!!!
Validation loss decreased (0.186254 --> 0.171576).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2993555068969727
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1602274  Vali Loss: 0.1632251 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8933529  Vali macro F1 0.8516459 
new best score!!!!
Validation loss decreased (0.171576 --> 0.163225).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.299222707748413
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1573330  Vali Loss: 0.1475253 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9440238  Vali macro F1 0.9222106 
new best score!!!!
Validation loss decreased (0.163225 --> 0.147525).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2999014854431152
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1430080  Vali Loss: 0.1421952 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9426790  Vali macro F1 0.9175860 
new best score!!!!
Validation loss decreased (0.147525 --> 0.142195).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3049538135528564
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1307188  Vali Loss: 0.1392489 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9398840  Vali macro F1 0.9154361 
new best score!!!!
Validation loss decreased (0.142195 --> 0.139249).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2976670265197754
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1223631  Vali Loss: 0.1475443 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9419232  Vali macro F1 0.9235048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.2948856353759766
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1133994  Vali Loss: 0.1467368 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9073846  Vali macro F1 0.8683170 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.3003730773925781
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1104960  Vali Loss: 0.1251825 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9543994  Vali macro F1 0.9350869 
new best score!!!!
Validation loss decreased (0.139249 --> 0.125182).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.299558401107788
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1008949  Vali Loss: 0.1274560 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9476451  Vali macro F1 0.9275134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.299755334854126
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0906583  Vali Loss: 0.1132136 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9567852  Vali macro F1 0.9397618 
new best score!!!!
Validation loss decreased (0.125182 --> 0.113214).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3037714958190918
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0876396  Vali Loss: 0.1122808 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9536027  Vali macro F1 0.9350800 
new best score!!!!
Validation loss decreased (0.113214 --> 0.112281).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3099231719970703
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0807051  Vali Loss: 0.1147403 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9541586  Vali macro F1 0.9370729 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3007380962371826
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0887594  Vali Loss: 0.1160004 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9592032  Vali macro F1 0.9407227 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 1.3225767612457275
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0956875  Vali Loss: 0.1068808 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660216  Vali macro F1 0.9554562 
new best score!!!!
Validation loss decreased (0.112281 --> 0.106881).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3045060634613037
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0709273  Vali Loss: 0.1064526 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659618  Vali macro F1 0.9543259 
new best score!!!!
Validation loss decreased (0.106881 --> 0.106453).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3032538890838623
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0654661  Vali Loss: 0.1052567 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9599412  Vali macro F1 0.9460538 
new best score!!!!
Validation loss decreased (0.106453 --> 0.105257).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2985591888427734
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0684525  Vali Loss: 0.0770990 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802631  Vali macro F1 0.9759019 
new best score!!!!
Validation loss decreased (0.105257 --> 0.077099).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.30426025390625
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0580484  Vali Loss: 0.0882478 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774722  Vali macro F1 0.9732607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3023290634155273
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0537535  Vali Loss: 0.0675093 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773819  Vali macro F1 0.9708517 
new best score!!!!
Validation loss decreased (0.077099 --> 0.067509).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3017768859863281
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0407732  Vali Loss: 0.0927306 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661633  Vali macro F1 0.9579532 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.2993788719177246
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0455070  Vali Loss: 0.0789166 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773545  Vali macro F1 0.9751227 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 1.3023872375488281
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0481530  Vali Loss: 0.0790556 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829960  Vali macro F1 0.9814962 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 1.2993009090423584
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0313805  Vali Loss: 0.0794982 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801842  Vali macro F1 0.9750765 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 1.2965888977050781
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0309841  Vali Loss: 0.0740664 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802728  Vali macro F1 0.9785524 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 1.300978422164917
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0279371  Vali Loss: 0.0746055 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802728  Vali macro F1 0.9785524 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.301424503326416
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0276637  Vali Loss: 0.0680884 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802728  Vali macro F1 0.9785524 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.2991697788238525
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0263328  Vali Loss: 0.0688068 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774201  Vali macro F1 0.9753277 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 1.2999005317687988
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0262184  Vali Loss: 0.0685433 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774201  Vali macro F1 0.9753277 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 1.3018298149108887
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0230994  Vali Loss: 0.0665123 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802823  Vali macro F1 0.9775980 
new best score!!!!
Validation loss decreased (0.067509 --> 0.066512).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3009817600250244
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0242239  Vali Loss: 0.0669996 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802823  Vali macro F1 0.9775980 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.2987561225891113
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0247447  Vali Loss: 0.0651635 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830924  Vali macro F1 0.9819601 
new best score!!!!
Validation loss decreased (0.066512 --> 0.065163).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3022449016571045
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0223539  Vali Loss: 0.0659680 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802823  Vali macro F1 0.9775980 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3014333248138428
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0244356  Vali Loss: 0.0665530 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.2977094650268555
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0237960  Vali Loss: 0.0699299 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802539  Vali macro F1 0.9765704 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.2993857860565186
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0246938  Vali Loss: 0.0608157 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830924  Vali macro F1 0.9819601 
new best score!!!!
Validation loss decreased (0.065163 --> 0.060816).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3028535842895508
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0225173  Vali Loss: 0.0649098 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.300110101699829
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0226585  Vali Loss: 0.0679323 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.301832914352417
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0223262  Vali Loss: 0.0652711 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830924  Vali macro F1 0.9819601 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3059844970703125
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0206258  Vali Loss: 0.0694473 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.311326503753662
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0217075  Vali Loss: 0.0655376 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 1.3049614429473877
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0235682  Vali Loss: 0.0658808 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3208320140838623
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0233682  Vali Loss: 0.0667262 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.3084681034088135
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0215945  Vali Loss: 0.0675735 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.3072326183319092
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0206936  Vali Loss: 0.0678398 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.3056833744049072
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0217442  Vali Loss: 0.0684443 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 59 cost time: 1.3092358112335205
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0204235  Vali Loss: 0.0684513 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.308048963546753
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0220801  Vali Loss: 0.0684119 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.3050563335418701
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0231955  Vali Loss: 0.0683435 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.3063957691192627
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0217810  Vali Loss: 0.0682971 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.3100569248199463
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0207185  Vali Loss: 0.0682922 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932112  Test macro F1 0.9929042 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3996503353118896
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0235304  Vali Loss: 0.0686711 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859105  Vali macro F1 0.9863599 
Validation loss decreased (inf --> 0.068671).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3999676704406738
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0230028  Vali Loss: 0.0640111 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830787  Vali macro F1 0.9789534 
new best score!!!!
Validation loss decreased (0.068671 --> 0.064011).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3976447582244873
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0240621  Vali Loss: 0.0664213 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.3953502178192139
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0216781  Vali Loss: 0.0663868 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830924  Vali macro F1 0.9819601 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.3998816013336182
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0217482  Vali Loss: 0.0694664 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.3968689441680908
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0203093  Vali Loss: 0.0680129 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830924  Vali macro F1 0.9819601 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.3950879573822021
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0183758  Vali Loss: 0.0682866 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802823  Vali macro F1 0.9775980 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.3988227844238281
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0179236  Vali Loss: 0.0660173 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802823  Vali macro F1 0.9775980 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.399765968322754
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0194108  Vali Loss: 0.0693347 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.3950366973876953
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0189166  Vali Loss: 0.0604127 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830924  Vali macro F1 0.9819601 
new best score!!!!
Validation loss decreased (0.064011 --> 0.060413).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.395369529724121
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0185423  Vali Loss: 0.0571329 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830924  Vali macro F1 0.9819601 
new best score!!!!
Validation loss decreased (0.060413 --> 0.057133).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.399301528930664
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0174897  Vali Loss: 0.0628371 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802823  Vali macro F1 0.9775980 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.3953888416290283
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0185222  Vali Loss: 0.0608366 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830924  Vali macro F1 0.9819601 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.3956596851348877
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0170002  Vali Loss: 0.0746432 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.398615837097168
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0183498  Vali Loss: 0.0722999 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.4001786708831787
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0153777  Vali Loss: 0.0669397 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776829 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 1.3973479270935059
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0169733  Vali Loss: 0.0679743 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.396266222000122
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0168471  Vali Loss: 0.0700506 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.3996038436889648
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0157336  Vali Loss: 0.0697164 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.3998243808746338
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0185295  Vali Loss: 0.0700784 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.39687180519104
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0155546  Vali Loss: 0.0697009 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 1.399280309677124
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0162707  Vali Loss: 0.0696325 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.3987836837768555
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0150569  Vali Loss: 0.0695811 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 1.3959424495697021
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0132134  Vali Loss: 0.0696552 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 1.3955554962158203
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0159550  Vali Loss: 0.0696972 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 1.4012291431427002
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0167726  Vali Loss: 0.0697015 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830214  Vali macro F1 0.9820450 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909552  Test macro F1 0.9899407 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00289855 0.0023753  0.00243309 0.00328947 0.00584795 0.00581395
 0.00306748 0.00289855 0.002331   0.00383142]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2978675365447998
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2525648  Vali Loss: 2.1457911 Vali Accuracy: 0.1949153  Vali weighted F1: 0.1077452  Vali macro F1 0.0923930 
Validation loss decreased (inf --> 2.145791).  Saving model ...
Epoch: 2 cost time: 1.3017892837524414
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8796508  Vali Loss: 1.4392889 Vali Accuracy: 0.5762712  Vali weighted F1: 0.5591134  Vali macro F1 0.5218162 
new best score!!!!
Validation loss decreased (2.145791 --> 1.439289).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2932524681091309
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2293338  Vali Loss: 0.8922543 Vali Accuracy: 0.7344633  Vali weighted F1: 0.7213398  Vali macro F1 0.6853796 
new best score!!!!
Validation loss decreased (1.439289 --> 0.892254).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2928073406219482
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8705547  Vali Loss: 0.6949522 Vali Accuracy: 0.7824859  Vali weighted F1: 0.7641395  Vali macro F1 0.7221528 
new best score!!!!
Validation loss decreased (0.892254 --> 0.694952).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2963075637817383
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6777353  Vali Loss: 0.5343208 Vali Accuracy: 0.8022599  Vali weighted F1: 0.7791208  Vali macro F1 0.7318725 
new best score!!!!
Validation loss decreased (0.694952 --> 0.534321).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2929530143737793
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5343175  Vali Loss: 0.4095571 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8533576  Vali macro F1 0.8188457 
new best score!!!!
Validation loss decreased (0.534321 --> 0.409557).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2943224906921387
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4403225  Vali Loss: 0.3465772 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8604882  Vali macro F1 0.8194584 
new best score!!!!
Validation loss decreased (0.409557 --> 0.346577).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.299926996231079
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3656554  Vali Loss: 0.3009060 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9150588  Vali macro F1 0.8919760 
new best score!!!!
Validation loss decreased (0.346577 --> 0.300906).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2998578548431396
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3136005  Vali Loss: 0.2537527 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8985601  Vali macro F1 0.8607998 
new best score!!!!
Validation loss decreased (0.300906 --> 0.253753).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2959918975830078
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2668808  Vali Loss: 0.2287042 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8874375  Vali macro F1 0.8442573 
new best score!!!!
Validation loss decreased (0.253753 --> 0.228704).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2938017845153809
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2357880  Vali Loss: 0.1996996 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9320090  Vali macro F1 0.9077489 
new best score!!!!
Validation loss decreased (0.228704 --> 0.199700).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.298069953918457
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2168702  Vali Loss: 0.1974335 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8763856  Vali macro F1 0.8355559 
new best score!!!!
Validation loss decreased (0.199700 --> 0.197434).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2955832481384277
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2077317  Vali Loss: 0.1867857 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8959189  Vali macro F1 0.8610139 
new best score!!!!
Validation loss decreased (0.197434 --> 0.186786).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2961580753326416
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1790587  Vali Loss: 0.1668239 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9277531  Vali macro F1 0.8978518 
new best score!!!!
Validation loss decreased (0.186786 --> 0.166824).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.297654151916504
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1633548  Vali Loss: 0.1563006 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8930314  Vali macro F1 0.8497277 
new best score!!!!
Validation loss decreased (0.166824 --> 0.156301).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.29902982711792
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1513512  Vali Loss: 0.1585543 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8874375  Vali macro F1 0.8442573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.2963693141937256
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1434755  Vali Loss: 0.1490988 Vali Accuracy: 0.9180791  Vali weighted F1: 0.8989986  Vali macro F1 0.8580676 
new best score!!!!
Validation loss decreased (0.156301 --> 0.149099).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2929039001464844
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1428781  Vali Loss: 0.1564064 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9307465  Vali macro F1 0.8977638 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.2977769374847412
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1468744  Vali Loss: 0.1574130 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9100289  Vali macro F1 0.8742197 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.3000338077545166
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1283644  Vali Loss: 0.1460113 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9436989  Vali macro F1 0.9200673 
new best score!!!!
Validation loss decreased (0.149099 --> 0.146011).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.296250343322754
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1167786  Vali Loss: 0.1345758 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9393864  Vali macro F1 0.9134522 
new best score!!!!
Validation loss decreased (0.146011 --> 0.134576).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3157918453216553
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1067821  Vali Loss: 0.1289388 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9399416  Vali macro F1 0.9160505 
new best score!!!!
Validation loss decreased (0.134576 --> 0.128939).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3010303974151611
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0996149  Vali Loss: 0.1315408 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9323705  Vali macro F1 0.9051461 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.2938005924224854
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0944040  Vali Loss: 0.1313395 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9294308  Vali macro F1 0.9018907 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.292815923690796
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0936109  Vali Loss: 0.1263938 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9442062  Vali macro F1 0.9232495 
new best score!!!!
Validation loss decreased (0.128939 --> 0.126394).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2973766326904297
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0874656  Vali Loss: 0.1055692 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9513688  Vali macro F1 0.9334461 
new best score!!!!
Validation loss decreased (0.126394 --> 0.105569).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2942821979522705
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0803338  Vali Loss: 0.1012696 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689662  Vali macro F1 0.9594906 
new best score!!!!
Validation loss decreased (0.105569 --> 0.101270).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2937498092651367
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0805408  Vali Loss: 0.1034734 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9599788  Vali macro F1 0.9453418 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.2962977886199951
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0720748  Vali Loss: 0.1031828 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9540831  Vali macro F1 0.9376750 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.2976086139678955
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0678782  Vali Loss: 0.0791826 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774532  Vali macro F1 0.9702179 
new best score!!!!
Validation loss decreased (0.101270 --> 0.079183).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2937912940979004
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0588700  Vali Loss: 0.0829524 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688110  Vali macro F1 0.9573544 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.2937376499176025
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0553113  Vali Loss: 0.0973875 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803138  Vali macro F1 0.9777423 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.2964541912078857
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0640545  Vali Loss: 0.0930035 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716451  Vali macro F1 0.9621658 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.298201560974121
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0631812  Vali Loss: 0.0925952 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773343  Vali macro F1 0.9743573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 1.2937908172607422
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0548662  Vali Loss: 0.0751893 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776232  Vali macro F1 0.9750892 
new best score!!!!
Validation loss decreased (0.079183 --> 0.075189).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2966175079345703
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0499192  Vali Loss: 0.0721392 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858265  Vali macro F1 0.9844078 
new best score!!!!
Validation loss decreased (0.075189 --> 0.072139).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.296813726425171
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0387185  Vali Loss: 0.0573102 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859227  Vali macro F1 0.9852187 
new best score!!!!
Validation loss decreased (0.072139 --> 0.057310).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2929308414459229
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0418213  Vali Loss: 0.0632040 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887630  Vali macro F1 0.9878030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.2948062419891357
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0343898  Vali Loss: 0.0685596 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830642  Vali macro F1 0.9828027 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.296560287475586
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0312785  Vali Loss: 0.0876334 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 1.2946374416351318
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0331413  Vali Loss: 0.0878789 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745577  Vali macro F1 0.9683162 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 1.293208360671997
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0273076  Vali Loss: 0.0854103 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776269 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 43 cost time: 1.2960243225097656
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0258947  Vali Loss: 0.0825235 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776269 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.300133228302002
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0224961  Vali Loss: 0.0768571 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776269 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.2985877990722656
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0202919  Vali Loss: 0.0739833 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776269 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 1.3010475635528564
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0196361  Vali Loss: 0.0735187 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9776269 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 1.3047761917114258
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0189484  Vali Loss: 0.0799416 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774293  Vali macro F1 0.9734066 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 48 cost time: 1.308924674987793
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0195587  Vali Loss: 0.0791333 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774293  Vali macro F1 0.9734066 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.300384759902954
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0214736  Vali Loss: 0.0779088 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774293  Vali macro F1 0.9734066 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.3214848041534424
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0183446  Vali Loss: 0.0773061 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774293  Vali macro F1 0.9734066 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.3052620887756348
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0191813  Vali Loss: 0.0762292 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802395  Vali macro F1 0.9777439 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.3019073009490967
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0188100  Vali Loss: 0.0752468 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802395  Vali macro F1 0.9777439 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920582  Test macro F1 0.9880994 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3946621417999268
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0331816  Vali Loss: 0.0658412 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831289  Vali macro F1 0.9809077 
Validation loss decreased (inf --> 0.065841).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3967273235321045
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0302642  Vali Loss: 0.0692059 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803270  Vali macro F1 0.9760522 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4000205993652344
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0267818  Vali Loss: 0.0689932 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803270  Vali macro F1 0.9760522 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.400381088256836
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0279484  Vali Loss: 0.0669518 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831289  Vali macro F1 0.9809077 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.3955354690551758
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0257928  Vali Loss: 0.0746942 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.3945634365081787
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0272112  Vali Loss: 0.0800018 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.398564338684082
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0260170  Vali Loss: 0.0806191 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.395284652709961
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0254004  Vali Loss: 0.0656677 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859390  Vali macro F1 0.9852698 
new best score!!!!
Validation loss decreased (0.065841 --> 0.065668).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.3966548442840576
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0278196  Vali Loss: 0.0719583 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831289  Vali macro F1 0.9809077 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.3981103897094727
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0248005  Vali Loss: 0.0818383 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803270  Vali macro F1 0.9760522 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.3985991477966309
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0254720  Vali Loss: 0.0656740 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831074  Vali macro F1 0.9808234 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.3956522941589355
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0224460  Vali Loss: 0.0794072 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.396299123764038
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0223757  Vali Loss: 0.0760042 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831289  Vali macro F1 0.9809077 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.3977272510528564
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0237500  Vali Loss: 0.0755444 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831289  Vali macro F1 0.9809077 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.3950824737548828
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0233080  Vali Loss: 0.0759740 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.3947198390960693
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0217225  Vali Loss: 0.0764483 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.3994905948638916
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0220451  Vali Loss: 0.0760868 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.3981268405914307
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0221738  Vali Loss: 0.0766199 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 19 cost time: 1.3955795764923096
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0201888  Vali Loss: 0.0766210 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.3962759971618652
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0200517  Vali Loss: 0.0765659 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.3987736701965332
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0210880  Vali Loss: 0.0765469 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.3948595523834229
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0208474  Vali Loss: 0.0765288 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.3944265842437744
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0225781  Vali Loss: 0.0766040 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803187  Vali macro F1 0.9765704 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932068  Test macro F1 0.9913179 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00274725 0.00243309 0.00232558 0.00318471 0.00578035 0.00609756
 0.00320513 0.00299401 0.002331   0.00393701]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2942852973937988
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2475460  Vali Loss: 2.1303577 Vali Accuracy: 0.2118644  Vali weighted F1: 0.1224770  Vali macro F1 0.1049156 
Validation loss decreased (inf --> 2.130358).  Saving model ...
Epoch: 2 cost time: 1.3096494674682617
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8504649  Vali Loss: 1.3955337 Vali Accuracy: 0.5875706  Vali weighted F1: 0.5616026  Vali macro F1 0.5224924 
new best score!!!!
Validation loss decreased (2.130358 --> 1.395534).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2913925647735596
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.1966786  Vali Loss: 0.8838258 Vali Accuracy: 0.7457627  Vali weighted F1: 0.7312717  Vali macro F1 0.6951784 
new best score!!!!
Validation loss decreased (1.395534 --> 0.883826).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2900967597961426
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8395202  Vali Loss: 0.6544015 Vali Accuracy: 0.7768362  Vali weighted F1: 0.7608430  Vali macro F1 0.7211596 
new best score!!!!
Validation loss decreased (0.883826 --> 0.654401).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2885587215423584
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6468317  Vali Loss: 0.4967554 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8012818  Vali macro F1 0.7602592 
new best score!!!!
Validation loss decreased (0.654401 --> 0.496755).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2934975624084473
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5021782  Vali Loss: 0.4137325 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8271627  Vali macro F1 0.7985569 
new best score!!!!
Validation loss decreased (0.496755 --> 0.413732).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2926523685455322
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4252053  Vali Loss: 0.3469317 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8867013  Vali macro F1 0.8619828 
new best score!!!!
Validation loss decreased (0.413732 --> 0.346932).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2894554138183594
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3537325  Vali Loss: 0.2793954 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9123661  Vali macro F1 0.8665818 
new best score!!!!
Validation loss decreased (0.346932 --> 0.279395).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2901287078857422
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3069279  Vali Loss: 0.2553474 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8866935  Vali macro F1 0.8387306 
new best score!!!!
Validation loss decreased (0.279395 --> 0.255347).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2931549549102783
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2613974  Vali Loss: 0.2109952 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9235988  Vali macro F1 0.8822709 
new best score!!!!
Validation loss decreased (0.255347 --> 0.210995).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2895066738128662
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2253233  Vali Loss: 0.2074354 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9114436  Vali macro F1 0.8823681 
new best score!!!!
Validation loss decreased (0.210995 --> 0.207435).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2922394275665283
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2028962  Vali Loss: 0.1752651 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9323816  Vali macro F1 0.8949725 
new best score!!!!
Validation loss decreased (0.207435 --> 0.175265).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2955234050750732
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1803611  Vali Loss: 0.1736684 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9464008  Vali macro F1 0.9270152 
new best score!!!!
Validation loss decreased (0.175265 --> 0.173668).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2952353954315186
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1585907  Vali Loss: 0.1473950 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9503210  Vali macro F1 0.9268702 
new best score!!!!
Validation loss decreased (0.173668 --> 0.147395).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.290964126586914
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1416971  Vali Loss: 0.1400972 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9465371  Vali macro F1 0.9249299 
new best score!!!!
Validation loss decreased (0.147395 --> 0.140097).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2912228107452393
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1408028  Vali Loss: 0.1542918 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9541119  Vali macro F1 0.9347425 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.2957534790039062
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1411549  Vali Loss: 0.1590398 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8929562  Vali macro F1 0.8495739 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 1.2912213802337646
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1343189  Vali Loss: 0.1304480 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9622458  Vali macro F1 0.9448228 
new best score!!!!
Validation loss decreased (0.140097 --> 0.130448).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.296860694885254
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1242382  Vali Loss: 0.1432043 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9391671  Vali macro F1 0.9113040 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.2948956489562988
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1100110  Vali Loss: 0.1341646 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9374930  Vali macro F1 0.9122410 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.2962126731872559
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1076643  Vali Loss: 0.1574973 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8989827  Vali macro F1 0.8614677 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 1.29426908493042
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1085346  Vali Loss: 0.1335793 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9456406  Vali macro F1 0.9255043 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 1.2923533916473389
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0993770  Vali Loss: 0.1021121 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9521648  Vali macro F1 0.9337392 
new best score!!!!
Validation loss decreased (0.130448 --> 0.102112).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.296194314956665
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0913022  Vali Loss: 0.0964442 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633501  Vali macro F1 0.9497646 
new best score!!!!
Validation loss decreased (0.102112 --> 0.096444).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2934424877166748
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0815836  Vali Loss: 0.0878616 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662075  Vali macro F1 0.9555627 
new best score!!!!
Validation loss decreased (0.096444 --> 0.087862).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2931811809539795
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0738516  Vali Loss: 0.0939473 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718117  Vali macro F1 0.9646291 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.296858549118042
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0648301  Vali Loss: 0.0832961 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715521  Vali macro F1 0.9646191 
new best score!!!!
Validation loss decreased (0.087862 --> 0.083296).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2966034412384033
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0670415  Vali Loss: 0.0712161 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773993  Vali macro F1 0.9713039 
new best score!!!!
Validation loss decreased (0.083296 --> 0.071216).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.294431209564209
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0541980  Vali Loss: 0.0744682 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687539  Vali macro F1 0.9565284 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.2967610359191895
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0472341  Vali Loss: 0.0813129 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773363  Vali macro F1 0.9753139 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.296889066696167
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0459397  Vali Loss: 0.0633776 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774073  Vali macro F1 0.9730072 
new best score!!!!
Validation loss decreased (0.071216 --> 0.063378).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.311258316040039
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0480929  Vali Loss: 0.0644308 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803137  Vali macro F1 0.9780758 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.2924420833587646
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0387148  Vali Loss: 0.0790229 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773892  Vali macro F1 0.9719783 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.2960357666015625
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0401660  Vali Loss: 0.0843352 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660658  Vali macro F1 0.9567215 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 1.2943825721740723
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0333493  Vali Loss: 0.0401401 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858976  Vali macro F1 0.9825215 
new best score!!!!
Validation loss decreased (0.063378 --> 0.040140).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2921855449676514
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0333503  Vali Loss: 0.0406482 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915175  Vali macro F1 0.9919942 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.2917582988739014
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0334926  Vali Loss: 0.0622796 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801052  Vali macro F1 0.9760509 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.294341802597046
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0377062  Vali Loss: 0.0559378 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830050  Vali macro F1 0.9800294 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.2917075157165527
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0281011  Vali Loss: 0.0447787 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.2932407855987549
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0247517  Vali Loss: 0.0534867 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830706  Vali macro F1 0.9802343 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 1.2949490547180176
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0228930  Vali Loss: 0.0502768 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886987  Vali macro F1 0.9889962 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.2946410179138184
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0190204  Vali Loss: 0.0563562 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915158  Vali macro F1 0.9921465 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.295241117477417
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0204143  Vali Loss: 0.0591274 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858742  Vali macro F1 0.9852138 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.2907485961914062
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0191037  Vali Loss: 0.0556842 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886977  Vali macro F1 0.9877467 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.294464349746704
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0175220  Vali Loss: 0.0568627 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 1.2919652462005615
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0176092  Vali Loss: 0.0572093 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2911567687988281
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0162745  Vali Loss: 0.0573742 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.2942397594451904
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0194563  Vali Loss: 0.0574426 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.2950565814971924
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0195805  Vali Loss: 0.0568920 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.2933473587036133
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0171237  Vali Loss: 0.0568576 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915158  Vali macro F1 0.9921465 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9841629  Test weighted F1: 0.9841857  Test macro F1 0.9817766 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3831140995025635
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0295538  Vali Loss: 0.0408669 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859108  Vali macro F1 0.9851528 
Validation loss decreased (inf --> 0.040867).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3816566467285156
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0247771  Vali Loss: 0.0386542 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887289  Vali macro F1 0.9895526 
new best score!!!!
Validation loss decreased (0.040867 --> 0.038654).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3859302997589111
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0244192  Vali Loss: 0.0379424 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859108  Vali macro F1 0.9851528 
new best score!!!!
Validation loss decreased (0.038654 --> 0.037942).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3850181102752686
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0244005  Vali Loss: 0.0381825 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858945  Vali macro F1 0.9851017 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.3838534355163574
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0235561  Vali Loss: 0.0420796 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886977  Vali macro F1 0.9877467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.3833580017089844
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0234822  Vali Loss: 0.0402954 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886987  Vali macro F1 0.9889962 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.387122392654419
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0224264  Vali Loss: 0.0402799 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858742  Vali macro F1 0.9852138 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.3821337223052979
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0212418  Vali Loss: 0.0413051 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858742  Vali macro F1 0.9852138 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.3817238807678223
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0220522  Vali Loss: 0.0430413 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.3868398666381836
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0190801  Vali Loss: 0.0487132 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858742  Vali macro F1 0.9852138 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.3853986263275146
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0200624  Vali Loss: 0.0523749 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858578  Vali macro F1 0.9851627 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.3814854621887207
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0207358  Vali Loss: 0.0460387 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858806  Vali macro F1 0.9845964 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.3830318450927734
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0202875  Vali Loss: 0.0444436 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.3851659297943115
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0194241  Vali Loss: 0.0434880 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.3814284801483154
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0168553  Vali Loss: 0.0433814 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.3817672729492188
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0180700  Vali Loss: 0.0432695 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.3851172924041748
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0164379  Vali Loss: 0.0434683 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886923  Vali macro F1 0.9896136 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.388383388519287
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0189739  Vali Loss: 0.0436571 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858757  Vali macro F1 0.9864638 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9819005  Test weighted F1: 0.9819077  Test macro F1 0.9805981 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00280899 0.0023753  0.00248139 0.00325733 0.00568182 0.00568182
 0.00302115 0.00291545 0.00233645 0.00409836]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3009233474731445
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2593274  Vali Loss: 2.1455729 Vali Accuracy: 0.2231638  Vali weighted F1: 0.1408553  Vali macro F1 0.1202535 
Validation loss decreased (inf --> 2.145573).  Saving model ...
Epoch: 2 cost time: 1.297154188156128
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8776385  Vali Loss: 1.4056374 Vali Accuracy: 0.5706215  Vali weighted F1: 0.5411520  Vali macro F1 0.5011033 
new best score!!!!
Validation loss decreased (2.145573 --> 1.405637).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2927346229553223
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2186098  Vali Loss: 0.9475215 Vali Accuracy: 0.7090395  Vali weighted F1: 0.6898052  Vali macro F1 0.6560953 
new best score!!!!
Validation loss decreased (1.405637 --> 0.947522).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.29630708694458
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8886068  Vali Loss: 0.6869028 Vali Accuracy: 0.7711864  Vali weighted F1: 0.7721223  Vali macro F1 0.7452823 
new best score!!!!
Validation loss decreased (0.947522 --> 0.686903).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3000166416168213
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6727024  Vali Loss: 0.5279926 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8211728  Vali macro F1 0.8032667 
new best score!!!!
Validation loss decreased (0.686903 --> 0.527993).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2964322566986084
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5410496  Vali Loss: 0.4356232 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8369474  Vali macro F1 0.8111005 
new best score!!!!
Validation loss decreased (0.527993 --> 0.435623).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2962722778320312
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4530200  Vali Loss: 0.3781873 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8264520  Vali macro F1 0.7883059 
new best score!!!!
Validation loss decreased (0.435623 --> 0.378187).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3002874851226807
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3867898  Vali Loss: 0.3064265 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8904110  Vali macro F1 0.8567657 
new best score!!!!
Validation loss decreased (0.378187 --> 0.306426).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2950568199157715
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3351076  Vali Loss: 0.2800831 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8643198  Vali macro F1 0.8263105 
new best score!!!!
Validation loss decreased (0.306426 --> 0.280083).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2966322898864746
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2865540  Vali Loss: 0.2499980 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8646287  Vali macro F1 0.8264482 
new best score!!!!
Validation loss decreased (0.280083 --> 0.249998).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.300152063369751
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2501357  Vali Loss: 0.2092267 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9129331  Vali macro F1 0.8802909 
new best score!!!!
Validation loss decreased (0.249998 --> 0.209227).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3049054145812988
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2184106  Vali Loss: 0.1876145 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8890179  Vali macro F1 0.8449102 
new best score!!!!
Validation loss decreased (0.209227 --> 0.187614).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.299633502960205
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1965732  Vali Loss: 0.1896866 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9170301  Vali macro F1 0.8846124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.2942113876342773
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1803910  Vali Loss: 0.1796950 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9360914  Vali macro F1 0.9093248 
new best score!!!!
Validation loss decreased (0.187614 --> 0.179695).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2988879680633545
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1649125  Vali Loss: 0.1589494 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9323448  Vali macro F1 0.9053358 
new best score!!!!
Validation loss decreased (0.179695 --> 0.158949).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2996201515197754
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1567323  Vali Loss: 0.1477605 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9381900  Vali macro F1 0.9107257 
new best score!!!!
Validation loss decreased (0.158949 --> 0.147760).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2966103553771973
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1356872  Vali Loss: 0.1599463 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9043060  Vali macro F1 0.8675554 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3003997802734375
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1297415  Vali Loss: 0.1396438 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9441221  Vali macro F1 0.9197820 
new best score!!!!
Validation loss decreased (0.147760 --> 0.139644).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.30385422706604
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1203892  Vali Loss: 0.1357957 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9424224  Vali macro F1 0.9174155 
new best score!!!!
Validation loss decreased (0.139644 --> 0.135796).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2962543964385986
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1149352  Vali Loss: 0.1163869 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9506328  Vali macro F1 0.9302501 
new best score!!!!
Validation loss decreased (0.135796 --> 0.116387).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3143103122711182
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1034069  Vali Loss: 0.1401173 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9399499  Vali macro F1 0.9161731 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.2984099388122559
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0916941  Vali Loss: 0.1126012 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605456  Vali macro F1 0.9465374 
new best score!!!!
Validation loss decreased (0.116387 --> 0.112601).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2986254692077637
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0950935  Vali Loss: 0.1149763 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661257  Vali macro F1 0.9503250 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.2971580028533936
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0928880  Vali Loss: 0.1283265 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9516004  Vali macro F1 0.9332524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.3009741306304932
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0857957  Vali Loss: 0.1103355 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9691463  Vali macro F1 0.9614014 
new best score!!!!
Validation loss decreased (0.112601 --> 0.110335).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2993595600128174
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0723923  Vali Loss: 0.0961908 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662913  Vali macro F1 0.9575499 
new best score!!!!
Validation loss decreased (0.110335 --> 0.096191).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.298567533493042
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0786329  Vali Loss: 0.0861013 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802838  Vali macro F1 0.9725567 
new best score!!!!
Validation loss decreased (0.096191 --> 0.086101).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.295612096786499
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0908455  Vali Loss: 0.1180727 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9544461  Vali macro F1 0.9399910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.2957890033721924
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0813481  Vali Loss: 0.1168480 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9596842  Vali macro F1 0.9467726 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.2930936813354492
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0672598  Vali Loss: 0.0791672 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718725  Vali macro F1 0.9633839 
new best score!!!!
Validation loss decreased (0.086101 --> 0.079167).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2937006950378418
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0605965  Vali Loss: 0.0882952 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746215  Vali macro F1 0.9715220 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.304029941558838
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0503556  Vali Loss: 0.0791260 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746081  Vali macro F1 0.9653186 
new best score!!!!
Validation loss decreased (0.079167 --> 0.079126).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.304962158203125
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0450371  Vali Loss: 0.0643065 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802934  Vali macro F1 0.9746494 
new best score!!!!
Validation loss decreased (0.079126 --> 0.064306).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3041000366210938
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0436329  Vali Loss: 0.0795183 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688985  Vali macro F1 0.9625537 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2958080768585205
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0383468  Vali Loss: 0.0531247 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775457  Vali macro F1 0.9754199 
new best score!!!!
Validation loss decreased (0.064306 --> 0.053125).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.299098014831543
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0329432  Vali Loss: 0.0664129 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775337  Vali macro F1 0.9769025 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.294675588607788
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0328044  Vali Loss: 0.0668026 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744777  Vali macro F1 0.9677685 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.296705722808838
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0284071  Vali Loss: 0.0547161 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831590  Vali macro F1 0.9824656 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3004796504974365
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0260420  Vali Loss: 0.0809828 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719605  Vali macro F1 0.9671169 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.3013088703155518
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0241247  Vali Loss: 0.0733827 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802729  Vali macro F1 0.9796393 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 1.2963895797729492
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0250263  Vali Loss: 0.0632379 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831415  Vali macro F1 0.9809466 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.295729160308838
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0208116  Vali Loss: 0.0528133 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858825  Vali macro F1 0.9845030 
new best score!!!!
Validation loss decreased (0.053125 --> 0.052813).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3004035949707031
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0204095  Vali Loss: 0.0473178 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915258  Vali macro F1 0.9912834 
new best score!!!!
Validation loss decreased (0.052813 --> 0.047318).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2953543663024902
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0182320  Vali Loss: 0.0482420 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887077  Vali macro F1 0.9868836 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.2950572967529297
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0165468  Vali Loss: 0.0466557 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
new best score!!!!
Validation loss decreased (0.047318 --> 0.046656).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3031551837921143
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0174465  Vali Loss: 0.0499373 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858825  Vali macro F1 0.9845030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3001060485839844
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0172924  Vali Loss: 0.0453330 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
new best score!!!!
Validation loss decreased (0.046656 --> 0.045333).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2971422672271729
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0169225  Vali Loss: 0.0515333 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858825  Vali macro F1 0.9845030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.313593864440918
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0174483  Vali Loss: 0.0439702 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
new best score!!!!
Validation loss decreased (0.045333 --> 0.043970).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.3019981384277344
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0154499  Vali Loss: 0.0426251 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
new best score!!!!
Validation loss decreased (0.043970 --> 0.042625).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2944765090942383
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0155035  Vali Loss: 0.0483491 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858825  Vali macro F1 0.9845030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.2928426265716553
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0175613  Vali Loss: 0.0483583 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831415  Vali macro F1 0.9809466 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.2994754314422607
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0154121  Vali Loss: 0.0502474 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830724  Vali macro F1 0.9801409 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.2961170673370361
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0148138  Vali Loss: 0.0476254 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9889028 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.2930223941802979
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0155080  Vali Loss: 0.0464657 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 1.295323133468628
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0142756  Vali Loss: 0.0464917 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2989716529846191
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0140531  Vali Loss: 0.0464582 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.2954025268554688
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0146876  Vali Loss: 0.0460719 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 1.2949697971343994
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0173633  Vali Loss: 0.0461576 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 1.2975313663482666
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0155670  Vali Loss: 0.0457517 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 1.3000726699829102
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0139122  Vali Loss: 0.0456948 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 1.294708490371704
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0144314  Vali Loss: 0.0456157 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 1.2949421405792236
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0152871  Vali Loss: 0.0456403 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 1.2978143692016602
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0163019  Vali Loss: 0.0456402 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 1.2943360805511475
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0147619  Vali Loss: 0.0455996 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909376  Test macro F1 0.9872593 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4102754592895508
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0176478  Vali Loss: 0.0435690 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
Validation loss decreased (inf --> 0.043569).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4070219993591309
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0158308  Vali Loss: 0.0456942 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858825  Vali macro F1 0.9845030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4059638977050781
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0168227  Vali Loss: 0.0404924 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
new best score!!!!
Validation loss decreased (0.043569 --> 0.040492).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4104008674621582
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0146760  Vali Loss: 0.0400890 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9889028 
new best score!!!!
Validation loss decreased (0.040492 --> 0.040089).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4051833152770996
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0132338  Vali Loss: 0.0400231 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
new best score!!!!
Validation loss decreased (0.040089 --> 0.040023).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.4069201946258545
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0138873  Vali Loss: 0.0389754 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
new best score!!!!
Validation loss decreased (0.040023 --> 0.038975).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.4091637134552002
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0139619  Vali Loss: 0.0474182 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886990  Vali macro F1 0.9876528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.4117166996002197
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0137359  Vali Loss: 0.0386575 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
new best score!!!!
Validation loss decreased (0.038975 --> 0.038658).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.4077041149139404
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0140994  Vali Loss: 0.0361001 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9920526 
new best score!!!!
Validation loss decreased (0.038658 --> 0.036100).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.4073741436004639
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0150306  Vali Loss: 0.0391335 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887077  Vali macro F1 0.9868836 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.410207986831665
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0138192  Vali Loss: 0.0405241 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.4091603755950928
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0145122  Vali Loss: 0.0524697 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858976  Vali macro F1 0.9825215 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 1.4058222770690918
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0129436  Vali Loss: 0.0412284 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9889001 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 1.4101905822753906
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0125731  Vali Loss: 0.0372266 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9889001 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 1.4089727401733398
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0114207  Vali Loss: 0.0417105 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830588  Vali macro F1 0.9821210 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.4077823162078857
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0130419  Vali Loss: 0.0364178 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858769  Vali macro F1 0.9865208 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.40682053565979
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0119655  Vali Loss: 0.0347583 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886935  Vali macro F1 0.9896706 
new best score!!!!
Validation loss decreased (0.036100 --> 0.034758).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 1.4116325378417969
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0117873  Vali Loss: 0.0387733 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858976  Vali macro F1 0.9825215 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.4067261219024658
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0117704  Vali Loss: 0.0454353 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.407853126525879
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0106966  Vali Loss: 0.0417884 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887361  Vali macro F1 0.9875334 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.408829927444458
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0116010  Vali Loss: 0.0396878 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915542  Vali macro F1 0.9919332 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.4088969230651855
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0101024  Vali Loss: 0.0391673 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 1.4070615768432617
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0098855  Vali Loss: 0.0394513 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.4064860343933105
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0114369  Vali Loss: 0.0402534 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9900334 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.408381462097168
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0087731  Vali Loss: 0.0395652 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915243  Vali macro F1 0.9900334 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.4062902927398682
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0107016  Vali Loss: 0.0385525 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.407179594039917
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0113971  Vali Loss: 0.0381776 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 1.4113459587097168
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0101227  Vali Loss: 0.0381698 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.4110863208770752
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0092427  Vali Loss: 0.0381107 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.4075837135314941
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0100488  Vali Loss: 0.0380780 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 1.408090591430664
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0105491  Vali Loss: 0.0380386 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 1.4103269577026367
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0105706  Vali Loss: 0.0380083 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943424  Vali macro F1 0.9944332 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920760  Test macro F1 0.9895006 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00282486 0.00235294 0.00242718 0.00328947 0.00549451 0.00552486
 0.00319489 0.00276243 0.00244499 0.00416667]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2988460063934326
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2474824  Vali Loss: 2.0956248 Vali Accuracy: 0.1864407  Vali weighted F1: 0.0970966  Vali macro F1 0.0852622 
Validation loss decreased (inf --> 2.095625).  Saving model ...
Epoch: 2 cost time: 1.2954440116882324
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.8480720  Vali Loss: 1.3577134 Vali Accuracy: 0.5819209  Vali weighted F1: 0.5610831  Vali macro F1 0.5124688 
new best score!!!!
Validation loss decreased (2.095625 --> 1.357713).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2929532527923584
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.2323186  Vali Loss: 0.8999680 Vali Accuracy: 0.7033898  Vali weighted F1: 0.6984587  Vali macro F1 0.6519519 
new best score!!!!
Validation loss decreased (1.357713 --> 0.899968).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.291764497756958
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8699183  Vali Loss: 0.6704097 Vali Accuracy: 0.7514124  Vali weighted F1: 0.7349811  Vali macro F1 0.6879614 
new best score!!!!
Validation loss decreased (0.899968 --> 0.670410).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2979507446289062
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6879921  Vali Loss: 0.5340002 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8227320  Vali macro F1 0.7558602 
new best score!!!!
Validation loss decreased (0.670410 --> 0.534000).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2952282428741455
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5475782  Vali Loss: 0.4354094 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8602694  Vali macro F1 0.7869283 
new best score!!!!
Validation loss decreased (0.534000 --> 0.435409).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2937729358673096
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4565703  Vali Loss: 0.3489511 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8827581  Vali macro F1 0.8080503 
new best score!!!!
Validation loss decreased (0.435409 --> 0.348951).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3041229248046875
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3899062  Vali Loss: 0.2903341 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8993484  Vali macro F1 0.8174451 
new best score!!!!
Validation loss decreased (0.348951 --> 0.290334).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.294614315032959
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3433389  Vali Loss: 0.2430323 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9266085  Vali macro F1 0.8731526 
new best score!!!!
Validation loss decreased (0.290334 --> 0.243032).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2912366390228271
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.3007096  Vali Loss: 0.2225977 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9316289  Vali macro F1 0.8910600 
new best score!!!!
Validation loss decreased (0.243032 --> 0.222598).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2916476726531982
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2651734  Vali Loss: 0.1685282 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9545320  Vali macro F1 0.8997882 
new best score!!!!
Validation loss decreased (0.222598 --> 0.168528).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2935357093811035
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2252791  Vali Loss: 0.1563256 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9319539  Vali macro F1 0.8584873 
new best score!!!!
Validation loss decreased (0.168528 --> 0.156326).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2909111976623535
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2100758  Vali Loss: 0.1296373 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9649750  Vali macro F1 0.9222115 
new best score!!!!
Validation loss decreased (0.156326 --> 0.129637).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2912366390228271
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1881666  Vali Loss: 0.1149380 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9736164  Vali macro F1 0.9361171 
new best score!!!!
Validation loss decreased (0.129637 --> 0.114938).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2956089973449707
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1663978  Vali Loss: 0.1026118 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713243  Vali macro F1 0.9294831 
new best score!!!!
Validation loss decreased (0.114938 --> 0.102612).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.295811653137207
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1631024  Vali Loss: 0.0983047 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9634924  Vali macro F1 0.9055644 
new best score!!!!
Validation loss decreased (0.102612 --> 0.098305).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2902944087982178
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1534167  Vali Loss: 0.0874726 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9734757  Vali macro F1 0.9298701 
new best score!!!!
Validation loss decreased (0.098305 --> 0.087473).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2929401397705078
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1462626  Vali Loss: 0.0827947 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774011  Vali macro F1 0.9406593 
new best score!!!!
Validation loss decreased (0.087473 --> 0.082795).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2948496341705322
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1400862  Vali Loss: 0.0807449 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802260  Vali macro F1 0.9481481 
new best score!!!!
Validation loss decreased (0.082795 --> 0.080745).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2915318012237549
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1230105  Vali Loss: 0.0744188 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772128  Vali macro F1 0.9400000 
new best score!!!!
Validation loss decreased (0.080745 --> 0.074419).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2934296131134033
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1174742  Vali Loss: 0.0703508 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772128  Vali macro F1 0.9400000 
new best score!!!!
Validation loss decreased (0.074419 --> 0.070351).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2993738651275635
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1101849  Vali Loss: 0.0605024 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9741484  Vali macro F1 0.9318373 
new best score!!!!
Validation loss decreased (0.070351 --> 0.060502).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.297743320465088
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0957525  Vali Loss: 0.0580785 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772128  Vali macro F1 0.9400000 
new best score!!!!
Validation loss decreased (0.060502 --> 0.058078).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2947242259979248
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0900298  Vali Loss: 0.0630017 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743659  Vali macro F1 0.9329655 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.293076753616333
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0887265  Vali Loss: 0.0644832 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745866  Vali macro F1 0.9482275 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.2960257530212402
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0871749  Vali Loss: 0.0519009 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830508  Vali macro F1 0.9554945 
new best score!!!!
Validation loss decreased (0.058078 --> 0.051901).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.29347562789917
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0915080  Vali Loss: 0.0593569 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9796209  Vali macro F1 0.9557613 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.2919690608978271
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0855636  Vali Loss: 0.0562611 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743659  Vali macro F1 0.9329655 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.2954421043395996
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0796895  Vali Loss: 0.0491681 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9785608  Vali macro F1 0.9431579 
new best score!!!!
Validation loss decreased (0.051901 --> 0.049168).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2987313270568848
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0740370  Vali Loss: 0.0454398 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802260  Vali macro F1 0.9481481 
new best score!!!!
Validation loss decreased (0.049168 --> 0.045440).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2953135967254639
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0705161  Vali Loss: 0.0416645 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9852643  Vali macro F1 0.9610390 
new best score!!!!
Validation loss decreased (0.045440 --> 0.041665).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2924935817718506
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0616138  Vali Loss: 0.0327593 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885611  Vali macro F1 0.9745207 
new best score!!!!
Validation loss decreased (0.041665 --> 0.032759).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.296309232711792
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0603393  Vali Loss: 0.0282313 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913828  Vali macro F1 0.9772791 
new best score!!!!
Validation loss decreased (0.032759 --> 0.028231).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2929024696350098
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0499746  Vali Loss: 0.0329212 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9888379  Vali macro F1 0.9733071 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2986257076263428
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0509481  Vali Loss: 0.0288988 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913828  Vali macro F1 0.9772791 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.300034999847412
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0477136  Vali Loss: 0.0384953 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886695  Vali macro F1 0.9703297 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 1.3125090599060059
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0398552  Vali Loss: 0.0315933 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943457  Vali macro F1 0.9897934 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 1.2950611114501953
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0396759  Vali Loss: 0.0259998 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886064  Vali macro F1 0.9700000 
new best score!!!!
Validation loss decreased (0.028231 --> 0.026000).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2969605922698975
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0393507  Vali Loss: 0.0357088 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9888379  Vali macro F1 0.9733071 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.2973122596740723
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0408291  Vali Loss: 0.0212461 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.026000 --> 0.021246).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2961101531982422
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0520136  Vali Loss: 0.0404351 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886695  Vali macro F1 0.9703297 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.2934458255767822
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0484042  Vali Loss: 0.0274270 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.299598217010498
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0409277  Vali Loss: 0.0316334 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885508  Vali macro F1 0.9747097 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.2974507808685303
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0379017  Vali Loss: 0.0247628 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885594  Vali macro F1 0.9746434 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.2954037189483643
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0287119  Vali Loss: 0.0354336 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857744  Vali macro F1 0.9674306 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 1.297905445098877
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0291875  Vali Loss: 0.0246388 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914712  Vali macro F1 0.9824306 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2979090213775635
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0237653  Vali Loss: 0.0192359 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.021246 --> 0.019236).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.296386480331421
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0221986  Vali Loss: 0.0187179 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
new best score!!!!
Validation loss decreased (0.019236 --> 0.018718).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.29557466506958
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0228726  Vali Loss: 0.0178682 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.018718 --> 0.017868).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2995033264160156
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0214128  Vali Loss: 0.0179119 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.2976608276367188
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0207024  Vali Loss: 0.0175411 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.017868 --> 0.017541).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2956349849700928
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0201853  Vali Loss: 0.0175631 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.294445514678955
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0237490  Vali Loss: 0.0182763 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.2989425659179688
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0208117  Vali Loss: 0.0188735 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 1.294044017791748
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0208189  Vali Loss: 0.0181168 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 1.2943329811096191
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0211560  Vali Loss: 0.0172667 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.017541 --> 0.017267).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.3002338409423828
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0190527  Vali Loss: 0.0173112 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2987043857574463
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0196146  Vali Loss: 0.0169516 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.017267 --> 0.016952).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.295215129852295
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0189711  Vali Loss: 0.0165561 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.016952 --> 0.016556).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2977697849273682
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0180267  Vali Loss: 0.0170324 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.3003106117248535
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0185990  Vali Loss: 0.0168991 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 1.296119213104248
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0196405  Vali Loss: 0.0168851 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 1.3130428791046143
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0167880  Vali Loss: 0.0164169 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.016556 --> 0.016417).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.3081862926483154
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0175843  Vali Loss: 0.0170968 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.3186609745025635
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0170060  Vali Loss: 0.0171711 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.2985479831695557
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0181083  Vali Loss: 0.0174469 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 1.2999286651611328
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0190650  Vali Loss: 0.0172516 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 1.3003885746002197
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0173344  Vali Loss: 0.0177194 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 69 cost time: 1.2961292266845703
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0171936  Vali Loss: 0.0176643 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 1.2953567504882812
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0183359  Vali Loss: 0.0176205 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 1.3000085353851318
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0171393  Vali Loss: 0.0175253 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 1.3006055355072021
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0173692  Vali Loss: 0.0174700 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 1.2962095737457275
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0164638  Vali Loss: 0.0174204 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 74 cost time: 1.2961535453796387
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0148651  Vali Loss: 0.0174189 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.298830270767212
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0161096  Vali Loss: 0.0174225 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 1.295698642730713
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0166689  Vali Loss: 0.0174151 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 1.2956533432006836
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0161678  Vali Loss: 0.0174065 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 1.299325704574585
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0170935  Vali Loss: 0.0174049 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9932356  Test weighted F1: 0.9932215  Test macro F1 0.9931235 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3838293552398682
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0203995  Vali Loss: 0.0220016 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913828  Vali macro F1 0.9772791 
Validation loss decreased (inf --> 0.022002).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3856620788574219
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0185740  Vali Loss: 0.0164809 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.022002 --> 0.016481).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3814713954925537
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0177474  Vali Loss: 0.0156079 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.016481 --> 0.015608).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.382340431213379
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0174266  Vali Loss: 0.0158398 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.3845925331115723
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0154703  Vali Loss: 0.0156538 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.3849360942840576
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0184969  Vali Loss: 0.0155872 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.015608 --> 0.015587).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.3819580078125
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0155146  Vali Loss: 0.0166375 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.3822870254516602
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0148348  Vali Loss: 0.0167862 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.3857972621917725
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0171204  Vali Loss: 0.0141973 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.015587 --> 0.014197).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.3816306591033936
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0139353  Vali Loss: 0.0136911 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.014197 --> 0.013691).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.3810842037200928
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0149932  Vali Loss: 0.0149431 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.3863320350646973
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0149148  Vali Loss: 0.0142553 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.3852708339691162
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0140838  Vali Loss: 0.0138730 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.3821723461151123
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0122617  Vali Loss: 0.0134867 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.013691 --> 0.013487).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.3834590911865234
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0136430  Vali Loss: 0.0146554 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.3865036964416504
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0136205  Vali Loss: 0.0137844 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.382422924041748
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0154220  Vali Loss: 0.0200116 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9777778 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.3819520473480225
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0140525  Vali Loss: 0.0129713 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.013487 --> 0.012971).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.385843276977539
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0147890  Vali Loss: 0.0116045 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
new best score!!!!
Validation loss decreased (0.012971 --> 0.011604).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 1.385462999343872
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0138127  Vali Loss: 0.0134703 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.3821673393249512
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0138260  Vali Loss: 0.0123123 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 1.382796049118042
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0132220  Vali Loss: 0.0143260 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 1.3858401775360107
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0132624  Vali Loss: 0.0142889 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 1.381695032119751
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0103854  Vali Loss: 0.0137307 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 25 cost time: 1.3828136920928955
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0121363  Vali Loss: 0.0160224 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9777778 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 1.3868145942687988
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0129370  Vali Loss: 0.0134426 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 1.3851144313812256
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0109280  Vali Loss: 0.0130178 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 1.3821723461151123
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0097654  Vali Loss: 0.0130314 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 1.3822288513183594
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0107753  Vali Loss: 0.0135985 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 30 cost time: 1.3853838443756104
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0094695  Vali Loss: 0.0133676 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 1.3817200660705566
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0112248  Vali Loss: 0.0136744 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 1.381814956665039
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0098594  Vali Loss: 0.0141822 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971673  Vali macro F1 0.9925517 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 1.3866848945617676
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0089446  Vali Loss: 0.0143296 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 1.38551664352417
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0115053  Vali Loss: 0.0143862 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943630  Test weighted F1: 0.9943632  Test macro F1 0.9942393 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 285395
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00278552 0.00240385 0.00239808 0.00333333 0.00561798 0.00591716
 0.003125   0.00287356 0.00234192 0.00398406]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3586738109588623
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2815821  Vali Loss: 2.2650733 Vali Accuracy: 0.1666667  Vali weighted F1: 0.0720736  Vali macro F1 0.0556168 
Validation loss decreased (inf --> 2.265073).  Saving model ...
Epoch: 2 cost time: 1.3068063259124756
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.0501662  Vali Loss: 1.6854702 Vali Accuracy: 0.4237288  Vali weighted F1: 0.3829287  Vali macro F1 0.3856995 
new best score!!!!
Validation loss decreased (2.265073 --> 1.685470).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3052725791931152
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3687219  Vali Loss: 1.1118958 Vali Accuracy: 0.6129944  Vali weighted F1: 0.5747534  Vali macro F1 0.5750290 
new best score!!!!
Validation loss decreased (1.685470 --> 1.111896).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3113038539886475
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9694887  Vali Loss: 0.8184953 Vali Accuracy: 0.7372881  Vali weighted F1: 0.7207210  Vali macro F1 0.7042715 
new best score!!!!
Validation loss decreased (1.111896 --> 0.818495).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3071365356445312
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6985023  Vali Loss: 0.6055526 Vali Accuracy: 0.8220339  Vali weighted F1: 0.8046668  Vali macro F1 0.7803447 
new best score!!!!
Validation loss decreased (0.818495 --> 0.605553).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.304340124130249
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5430906  Vali Loss: 0.4857221 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8152986  Vali macro F1 0.7929783 
new best score!!!!
Validation loss decreased (0.605553 --> 0.485722).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3078434467315674
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4340801  Vali Loss: 0.3970443 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8807675  Vali macro F1 0.8582810 
new best score!!!!
Validation loss decreased (0.485722 --> 0.397044).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3095297813415527
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3588891  Vali Loss: 0.3501274 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8676077  Vali macro F1 0.8379062 
new best score!!!!
Validation loss decreased (0.397044 --> 0.350127).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3046438694000244
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.2945554  Vali Loss: 0.2792345 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9038797  Vali macro F1 0.8822558 
new best score!!!!
Validation loss decreased (0.350127 --> 0.279235).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3049933910369873
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2587304  Vali Loss: 0.2475956 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9093030  Vali macro F1 0.8844905 
new best score!!!!
Validation loss decreased (0.279235 --> 0.247596).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3268711566925049
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2203821  Vali Loss: 0.2261921 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9261959  Vali macro F1 0.9081308 
new best score!!!!
Validation loss decreased (0.247596 --> 0.226192).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3075480461120605
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1994182  Vali Loss: 0.2038268 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9233082  Vali macro F1 0.9026187 
new best score!!!!
Validation loss decreased (0.226192 --> 0.203827).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3056626319885254
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1711432  Vali Loss: 0.1876198 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9101725  Vali macro F1 0.8851116 
new best score!!!!
Validation loss decreased (0.203827 --> 0.187620).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3050761222839355
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1566153  Vali Loss: 0.1886568 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9051181  Vali macro F1 0.8779160 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3076708316802979
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1452163  Vali Loss: 0.1684373 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9286036  Vali macro F1 0.9083156 
new best score!!!!
Validation loss decreased (0.187620 --> 0.168437).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.304366111755371
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1375145  Vali Loss: 0.1862044 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9050173  Vali macro F1 0.8776290 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.3034207820892334
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1267098  Vali Loss: 0.1689108 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9257687  Vali macro F1 0.9065534 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 1.308518409729004
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1181681  Vali Loss: 0.1507822 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9511964  Vali macro F1 0.9363735 
new best score!!!!
Validation loss decreased (0.168437 --> 0.150782).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3089158535003662
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1138694  Vali Loss: 0.1532088 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9186553  Vali macro F1 0.8920675 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.305985927581787
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1086937  Vali Loss: 0.1398294 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9601651  Vali macro F1 0.9500386 
new best score!!!!
Validation loss decreased (0.150782 --> 0.139829).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3071248531341553
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1033162  Vali Loss: 0.1348649 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9365874  Vali macro F1 0.9164714 
new best score!!!!
Validation loss decreased (0.139829 --> 0.134865).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3130080699920654
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0984261  Vali Loss: 0.1305329 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9504617  Vali macro F1 0.9368272 
new best score!!!!
Validation loss decreased (0.134865 --> 0.130533).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3060641288757324
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0989086  Vali Loss: 0.1476661 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9135773  Vali macro F1 0.8851535 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3086581230163574
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0997796  Vali Loss: 0.1318250 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9427986  Vali macro F1 0.9263935 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.3099777698516846
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0894911  Vali Loss: 0.1233190 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9337589  Vali macro F1 0.9140857 
new best score!!!!
Validation loss decreased (0.130533 --> 0.123319).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3106133937835693
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0895964  Vali Loss: 0.1242193 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9532846  Vali macro F1 0.9392166 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.306239366531372
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0934900  Vali Loss: 0.1119441 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688640  Vali macro F1 0.9636152 
new best score!!!!
Validation loss decreased (0.123319 --> 0.111944).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3063316345214844
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0839096  Vali Loss: 0.1123118 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681425  Vali macro F1 0.9594462 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3071181774139404
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0821472  Vali Loss: 0.0986743 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9733309 
new best score!!!!
Validation loss decreased (0.111944 --> 0.098674).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.306570053100586
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0748030  Vali Loss: 0.0765904 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858132  Vali macro F1 0.9820401 
new best score!!!!
Validation loss decreased (0.098674 --> 0.076590).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3053689002990723
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0708839  Vali Loss: 0.0832976 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684641  Vali macro F1 0.9598726 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3103652000427246
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0658724  Vali Loss: 0.0611227 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858485  Vali macro F1 0.9835536 
new best score!!!!
Validation loss decreased (0.076590 --> 0.061123).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3104472160339355
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0569185  Vali Loss: 0.0621843 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745542  Vali macro F1 0.9696300 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3057856559753418
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0482069  Vali Loss: 0.0415287 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858793  Vali macro F1 0.9835841 
new best score!!!!
Validation loss decreased (0.061123 --> 0.041529).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3057575225830078
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0433484  Vali Loss: 0.0352471 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915218  Vali macro F1 0.9898126 
new best score!!!!
Validation loss decreased (0.041529 --> 0.035247).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3163223266601562
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0403158  Vali Loss: 0.0376649 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887021  Vali macro F1 0.9859736 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3051812648773193
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0405820  Vali Loss: 0.0369917 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858737  Vali macro F1 0.9851751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3080716133117676
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0336830  Vali Loss: 0.0346914 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886933  Vali macro F1 0.9874269 
new best score!!!!
Validation loss decreased (0.035247 --> 0.034691).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3080523014068604
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0294116  Vali Loss: 0.0255480 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887073  Vali macro F1 0.9874346 
new best score!!!!
Validation loss decreased (0.034691 --> 0.025548).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3306920528411865
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0257460  Vali Loss: 0.0233730 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887073  Vali macro F1 0.9874346 
new best score!!!!
Validation loss decreased (0.025548 --> 0.023373).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3079214096069336
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0259084  Vali Loss: 0.0211303 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915311  Vali macro F1 0.9912793 
new best score!!!!
Validation loss decreased (0.023373 --> 0.021130).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3094420433044434
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0278111  Vali Loss: 0.0388596 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886742  Vali macro F1 0.9889737 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3082959651947021
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0255851  Vali Loss: 0.0193557 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
new best score!!!!
Validation loss decreased (0.021130 --> 0.019356).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.309722661972046
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0231528  Vali Loss: 0.0195729 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915211  Vali macro F1 0.9897643 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3135006427764893
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0246943  Vali Loss: 0.0215297 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915316  Vali macro F1 0.9912464 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.3115208148956299
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0164692  Vali Loss: 0.0240605 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887002  Vali macro F1 0.9891339 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.3096415996551514
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0185333  Vali Loss: 0.0203299 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858506  Vali macro F1 0.9838268 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.305419683456421
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0153584  Vali Loss: 0.0124546 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.019356 --> 0.012455).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.305577039718628
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0172110  Vali Loss: 0.0195287 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887073  Vali macro F1 0.9874346 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3084120750427246
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0156747  Vali Loss: 0.0365815 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887018  Vali macro F1 0.9890242 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3036375045776367
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0241038  Vali Loss: 0.0360353 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886983  Vali macro F1 0.9892643 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.3045859336853027
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0243614  Vali Loss: 0.0298534 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886691  Vali macro F1 0.9888195 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.307375192642212
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0189191  Vali Loss: 0.0208452 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915271  Vali macro F1 0.9915891 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 1.3084509372711182
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0145513  Vali Loss: 0.0187577 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915271  Vali macro F1 0.9915891 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3029041290283203
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0146682  Vali Loss: 0.0172934 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.3055357933044434
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0111233  Vali Loss: 0.0147118 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.3089330196380615
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0125095  Vali Loss: 0.0133931 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.3041341304779053
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0110743  Vali Loss: 0.0140966 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 59 cost time: 1.3027763366699219
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0109882  Vali Loss: 0.0139786 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.3074758052825928
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0112920  Vali Loss: 0.0136603 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.3062424659729004
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0125274  Vali Loss: 0.0134241 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.3048081398010254
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0101869  Vali Loss: 0.0131500 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.303987979888916
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0094420  Vali Loss: 0.0129522 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943496  Vali macro F1 0.9939783 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9875566  Test weighted F1: 0.9875709  Test macro F1 0.9817477 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.402848482131958
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0110207  Vali Loss: 0.0128746 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943539  Vali macro F1 0.9936687 
Validation loss decreased (inf --> 0.012875).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.407304286956787
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0112390  Vali Loss: 0.0124788 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943539  Vali macro F1 0.9936687 
new best score!!!!
Validation loss decreased (0.012875 --> 0.012479).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.40464186668396
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0139495  Vali Loss: 0.0126967 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.4027409553527832
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0144091  Vali Loss: 0.0115520 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943539  Vali macro F1 0.9936687 
new best score!!!!
Validation loss decreased (0.012479 --> 0.011552).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4032161235809326
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0112854  Vali Loss: 0.0104713 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971798  Vali macro F1 0.9975163 
new best score!!!!
Validation loss decreased (0.011552 --> 0.010471).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.405125379562378
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0105395  Vali Loss: 0.0099959 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010471 --> 0.009996).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.4036109447479248
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0086927  Vali Loss: 0.0096568 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009996 --> 0.009657).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.4043574333190918
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0110482  Vali Loss: 0.0109237 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.40598726272583
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0099440  Vali Loss: 0.0096725 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.4061744213104248
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0088689  Vali Loss: 0.0090900 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009657 --> 0.009090).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.403014898300171
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0088862  Vali Loss: 0.0083776 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009090 --> 0.008378).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.4033222198486328
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0082575  Vali Loss: 0.0079558 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008378 --> 0.007956).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.4072093963623047
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0083545  Vali Loss: 0.0097857 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.4036133289337158
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0081241  Vali Loss: 0.0095224 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.402649164199829
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0073002  Vali Loss: 0.0072922 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007956 --> 0.007292).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.4061477184295654
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0090265  Vali Loss: 0.0078031 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.4051427841186523
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0071935  Vali Loss: 0.0133935 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943419  Vali macro F1 0.9922963 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.4017970561981201
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0089653  Vali Loss: 0.0075450 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.402660608291626
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0087359  Vali Loss: 0.0077882 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.4045228958129883
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0082337  Vali Loss: 0.0090770 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971776  Vali macro F1 0.9975777 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 21 cost time: 1.4018311500549316
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0058219  Vali Loss: 0.0073370 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.4021704196929932
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0070547  Vali Loss: 0.0070899 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007292 --> 0.007090).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.4031760692596436
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0067990  Vali Loss: 0.0073868 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.405480146408081
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0067804  Vali Loss: 0.0083730 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.4019923210144043
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0063211  Vali Loss: 0.0088372 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.4033429622650146
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0087354  Vali Loss: 0.0061338 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007090 --> 0.006134).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 1.405325174331665
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0056957  Vali Loss: 0.0058206 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006134 --> 0.005821).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 1.4040298461914062
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0055057  Vali Loss: 0.0053936 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005821 --> 0.005394).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 1.4019253253936768
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0055623  Vali Loss: 0.0053248 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005394 --> 0.005325).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 1.4077856540679932
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0062772  Vali Loss: 0.0051084 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005325 --> 0.005108).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 1.4067678451538086
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0071684  Vali Loss: 0.0064799 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 1.4029231071472168
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0073917  Vali Loss: 0.0048449 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005108 --> 0.004845).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 1.4019970893859863
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0050863  Vali Loss: 0.0055003 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 1.4074084758758545
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0060853  Vali Loss: 0.0061000 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 1.401655673980713
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0076326  Vali Loss: 0.0062970 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 1.4029483795166016
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0058712  Vali Loss: 0.0063731 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 1.406571388244629
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0064905  Vali Loss: 0.0058802 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 38 cost time: 1.405632734298706
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0046712  Vali Loss: 0.0057491 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 1.4005622863769531
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0049301  Vali Loss: 0.0056248 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 1.4040658473968506
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0047842  Vali Loss: 0.0055065 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 1.4055309295654297
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0052538  Vali Loss: 0.0051926 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 1.4026682376861572
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0045772  Vali Loss: 0.0049973 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 43 cost time: 1.402125597000122
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0056366  Vali Loss: 0.0050022 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 1.4053676128387451
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0062299  Vali Loss: 0.0050104 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 1.4039461612701416
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0045003  Vali Loss: 0.0050252 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 46 cost time: 1.401885986328125
Fine Tuning VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0051074  Vali Loss: 0.0050371 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 47 cost time: 1.4031040668487549
Fine Tuning VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0047091  Vali Loss: 0.0050475 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9864603  Test macro F1 0.9806911 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00275482 0.00232558 0.00247525 0.00333333 0.00561798 0.00617284
 0.0031348  0.00288184 0.00239234 0.00378788]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3005688190460205
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2809100  Vali Loss: 2.2643496 Vali Accuracy: 0.1723164  Vali weighted F1: 0.0717622  Vali macro F1 0.0551444 
Validation loss decreased (inf --> 2.264350).  Saving model ...
Epoch: 2 cost time: 1.3034188747406006
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.0369363  Vali Loss: 1.6694208 Vali Accuracy: 0.3954802  Vali weighted F1: 0.3704344  Vali macro F1 0.3673606 
new best score!!!!
Validation loss decreased (2.264350 --> 1.669421).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3001863956451416
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3583146  Vali Loss: 1.0610809 Vali Accuracy: 0.6525424  Vali weighted F1: 0.6323551  Vali macro F1 0.6302226 
new best score!!!!
Validation loss decreased (1.669421 --> 1.061081).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2980289459228516
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9663967  Vali Loss: 0.7938835 Vali Accuracy: 0.6977401  Vali weighted F1: 0.6632168  Vali macro F1 0.6554443 
new best score!!!!
Validation loss decreased (1.061081 --> 0.793884).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2996222972869873
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7145623  Vali Loss: 0.6059555 Vali Accuracy: 0.8220339  Vali weighted F1: 0.8223816  Vali macro F1 0.8111316 
new best score!!!!
Validation loss decreased (0.793884 --> 0.605955).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3033607006072998
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5540316  Vali Loss: 0.4940478 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8593507  Vali macro F1 0.8417731 
new best score!!!!
Validation loss decreased (0.605955 --> 0.494048).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2995543479919434
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4433159  Vali Loss: 0.4079188 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8651743  Vali macro F1 0.8340209 
new best score!!!!
Validation loss decreased (0.494048 --> 0.407919).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2971644401550293
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3707548  Vali Loss: 0.3398055 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8782203  Vali macro F1 0.8501413 
new best score!!!!
Validation loss decreased (0.407919 --> 0.339806).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2977705001831055
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3158595  Vali Loss: 0.3170176 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8800013  Vali macro F1 0.8540158 
new best score!!!!
Validation loss decreased (0.339806 --> 0.317018).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3036434650421143
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2743243  Vali Loss: 0.2564853 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8822061  Vali macro F1 0.8500145 
new best score!!!!
Validation loss decreased (0.317018 --> 0.256485).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2986178398132324
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2465909  Vali Loss: 0.2385463 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9171151  Vali macro F1 0.8974291 
new best score!!!!
Validation loss decreased (0.256485 --> 0.238546).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2974293231964111
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2135680  Vali Loss: 0.2121518 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9292541  Vali macro F1 0.9125636 
new best score!!!!
Validation loss decreased (0.238546 --> 0.212152).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3031997680664062
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1846878  Vali Loss: 0.1942974 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9348559  Vali macro F1 0.9153007 
new best score!!!!
Validation loss decreased (0.212152 --> 0.194297).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2970609664916992
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1651493  Vali Loss: 0.1854429 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9350017  Vali macro F1 0.9173034 
new best score!!!!
Validation loss decreased (0.194297 --> 0.185443).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.311223030090332
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1569631  Vali Loss: 0.1816264 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9320604  Vali macro F1 0.9145635 
new best score!!!!
Validation loss decreased (0.185443 --> 0.181626).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3041019439697266
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1450083  Vali Loss: 0.1754493 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9170837  Vali macro F1 0.8929074 
new best score!!!!
Validation loss decreased (0.181626 --> 0.175449).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3030803203582764
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1314530  Vali Loss: 0.1708980 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9262928  Vali macro F1 0.9054446 
new best score!!!!
Validation loss decreased (0.175449 --> 0.170898).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.292285680770874
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1298910  Vali Loss: 0.1879648 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9261853  Vali macro F1 0.9069017 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.2984843254089355
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1191858  Vali Loss: 0.1567268 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9454422  Vali macro F1 0.9284532 
new best score!!!!
Validation loss decreased (0.170898 --> 0.156727).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.302682876586914
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1258897  Vali Loss: 0.1582991 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9273003  Vali macro F1 0.9082884 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.297003984451294
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1110927  Vali Loss: 0.1516718 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9082043  Vali macro F1 0.8777524 
new best score!!!!
Validation loss decreased (0.156727 --> 0.151672).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2966063022613525
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0977846  Vali Loss: 0.1500650 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9452289  Vali macro F1 0.9296283 
new best score!!!!
Validation loss decreased (0.151672 --> 0.150065).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3005917072296143
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0955915  Vali Loss: 0.1552707 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9177821  Vali macro F1 0.8936573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3001618385314941
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0952321  Vali Loss: 0.1206782 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9557179  Vali macro F1 0.9439097 
new best score!!!!
Validation loss decreased (0.150065 --> 0.120678).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.298961877822876
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0856583  Vali Loss: 0.1043747 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661044  Vali macro F1 0.9593010 
new best score!!!!
Validation loss decreased (0.120678 --> 0.104375).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.296534776687622
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0854816  Vali Loss: 0.1095276 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9580053  Vali macro F1 0.9439595 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2987847328186035
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0783004  Vali Loss: 0.1032285 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681423  Vali macro F1 0.9593602 
new best score!!!!
Validation loss decreased (0.104375 --> 0.103228).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2954013347625732
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0651250  Vali Loss: 0.0783535 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802183  Vali macro F1 0.9756690 
new best score!!!!
Validation loss decreased (0.103228 --> 0.078353).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2950403690338135
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0628745  Vali Loss: 0.0685414 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830052  Vali macro F1 0.9779979 
new best score!!!!
Validation loss decreased (0.078353 --> 0.068541).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2994723320007324
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0621391  Vali Loss: 0.0919063 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774376  Vali macro F1 0.9759108 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.300344705581665
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0771250  Vali Loss: 0.0784201 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802024  Vali macro F1 0.9741817 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.2981159687042236
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0599505  Vali Loss: 0.0581295 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830061  Vali macro F1 0.9807294 
new best score!!!!
Validation loss decreased (0.068541 --> 0.058130).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.299217939376831
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0432276  Vali Loss: 0.0805923 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773272  Vali macro F1 0.9749312 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3021337985992432
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0397320  Vali Loss: 0.0478636 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858766  Vali macro F1 0.9833611 
new best score!!!!
Validation loss decreased (0.058130 --> 0.047864).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.297701120376587
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0349870  Vali Loss: 0.0603352 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886738  Vali macro F1 0.9857159 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2948963642120361
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0439364  Vali Loss: 0.0596859 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858514  Vali macro F1 0.9833269 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3025615215301514
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0394591  Vali Loss: 0.0595421 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829206  Vali macro F1 0.9778826 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.301290512084961
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0379213  Vali Loss: 0.0472233 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858736  Vali macro F1 0.9831514 
new best score!!!!
Validation loss decreased (0.047864 --> 0.047223).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.297072172164917
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0365584  Vali Loss: 0.0450218 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.047223 --> 0.045022).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3012738227844238
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0273557  Vali Loss: 0.0407240 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
new best score!!!!
Validation loss decreased (0.045022 --> 0.040724).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2993113994598389
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0244805  Vali Loss: 0.0420275 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886962  Vali macro F1 0.9872001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.298936128616333
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0216389  Vali Loss: 0.0341923 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.040724 --> 0.034192).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2992932796478271
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0201934  Vali Loss: 0.0348286 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3177776336669922
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0189383  Vali Loss: 0.0346703 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.3045110702514648
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0209929  Vali Loss: 0.0351145 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915186  Vali macro F1 0.9895891 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 1.3053576946258545
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0155583  Vali Loss: 0.0303618 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.034192 --> 0.030362).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.2993898391723633
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0156250  Vali Loss: 0.0307381 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.2993569374084473
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0144726  Vali Loss: 0.0338246 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915186  Vali macro F1 0.9895891 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.2976531982421875
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0250334  Vali Loss: 0.0439951 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.297074317932129
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0250308  Vali Loss: 0.0345306 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.300811767578125
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0285810  Vali Loss: 0.0609433 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886964  Vali macro F1 0.9888110 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 52 cost time: 1.2972195148468018
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0210977  Vali Loss: 0.0443009 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915220  Vali macro F1 0.9910593 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.2957782745361328
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0138923  Vali Loss: 0.0345732 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.2962229251861572
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0123427  Vali Loss: 0.0343103 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 1.3028132915496826
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0128837  Vali Loss: 0.0336153 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 1.2973718643188477
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0123136  Vali Loss: 0.0302361 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.030362 --> 0.030236).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2967870235443115
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0118712  Vali Loss: 0.0299037 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.030236 --> 0.029904).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.29833984375
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0115819  Vali Loss: 0.0300916 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.2990975379943848
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0114897  Vali Loss: 0.0298450 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.029904 --> 0.029845).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.3015007972717285
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0105910  Vali Loss: 0.0312716 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.2993063926696777
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0117407  Vali Loss: 0.0327937 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 1.3024756908416748
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0112269  Vali Loss: 0.0319059 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 1.3042521476745605
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0103477  Vali Loss: 0.0330725 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 1.3023955821990967
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0097981  Vali Loss: 0.0328619 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 65 cost time: 1.302304983139038
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0098770  Vali Loss: 0.0329215 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.2999074459075928
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0112139  Vali Loss: 0.0330435 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 1.3003244400024414
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0102001  Vali Loss: 0.0328107 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 1.307682752609253
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0097315  Vali Loss: 0.0328133 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 1.3083648681640625
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0112739  Vali Loss: 0.0330793 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 70 cost time: 1.306852102279663
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0110439  Vali Loss: 0.0330959 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.2994942665100098
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0101157  Vali Loss: 0.0331014 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.322882890701294
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0100264  Vali Loss: 0.0330827 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.3022851943969727
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0106602  Vali Loss: 0.0330752 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 1.3010585308074951
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0119603  Vali Loss: 0.0330759 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9977376  Test weighted F1: 0.9977382  Test macro F1 0.9967674 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3850584030151367
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0118424  Vali Loss: 0.0302702 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
Validation loss decreased (inf --> 0.030270).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3814513683319092
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0101672  Vali Loss: 0.0293351 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.030270 --> 0.029335).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3895716667175293
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0100619  Vali Loss: 0.0290636 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.029335 --> 0.029064).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3889122009277344
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0102225  Vali Loss: 0.0293422 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.3853285312652588
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0118266  Vali Loss: 0.0281380 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
new best score!!!!
Validation loss decreased (0.029064 --> 0.028138).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.3851535320281982
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0092034  Vali Loss: 0.0290507 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.3884670734405518
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0090354  Vali Loss: 0.0316063 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.385584831237793
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0098562  Vali Loss: 0.0296345 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.385157823562622
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0094953  Vali Loss: 0.0325545 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.3879337310791016
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0093107  Vali Loss: 0.0331323 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.387582540512085
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0091580  Vali Loss: 0.0365809 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.384749412536621
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0087515  Vali Loss: 0.0305458 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.3868253231048584
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0098354  Vali Loss: 0.0356174 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.3890140056610107
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0081679  Vali Loss: 0.0354382 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.3857872486114502
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0076435  Vali Loss: 0.0328314 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 1.3843994140625
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0071804  Vali Loss: 0.0333591 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.3886291980743408
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0072136  Vali Loss: 0.0337217 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.387169599533081
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0079191  Vali Loss: 0.0338280 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.3847320079803467
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0070229  Vali Loss: 0.0342869 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915284  Vali macro F1 0.9910563 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.3858191967010498
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0078889  Vali Loss: 0.0346985 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943508  Vali macro F1 0.9934453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9966063  Test weighted F1: 0.9966071  Test macro F1 0.9958736 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00268097 0.00233645 0.0025     0.00338983 0.00584795 0.00595238
 0.0030581  0.00294118 0.00234742 0.00389105]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.296050786972046
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2789845  Vali Loss: 2.2724662 Vali Accuracy: 0.1553672  Vali weighted F1: 0.0719214  Vali macro F1 0.0555507 
Validation loss decreased (inf --> 2.272466).  Saving model ...
Epoch: 2 cost time: 1.2969036102294922
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.0545312  Vali Loss: 1.6836797 Vali Accuracy: 0.3672316  Vali weighted F1: 0.3264420  Vali macro F1 0.3095506 
new best score!!!!
Validation loss decreased (2.272466 --> 1.683680).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3072614669799805
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3736110  Vali Loss: 1.0993039 Vali Accuracy: 0.6412429  Vali weighted F1: 0.6340906  Vali macro F1 0.6362103 
new best score!!!!
Validation loss decreased (1.683680 --> 1.099304).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2939772605895996
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9619266  Vali Loss: 0.7838551 Vali Accuracy: 0.7033898  Vali weighted F1: 0.6845733  Vali macro F1 0.6866027 
new best score!!!!
Validation loss decreased (1.099304 --> 0.783855).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3098957538604736
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7066235  Vali Loss: 0.6412201 Vali Accuracy: 0.7627119  Vali weighted F1: 0.7625078  Vali macro F1 0.7485010 
new best score!!!!
Validation loss decreased (0.783855 --> 0.641220).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.297203779220581
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5536869  Vali Loss: 0.4808407 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8288456  Vali macro F1 0.8014051 
new best score!!!!
Validation loss decreased (0.641220 --> 0.480841).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2933712005615234
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4413944  Vali Loss: 0.4095998 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8890958  Vali macro F1 0.8717997 
new best score!!!!
Validation loss decreased (0.480841 --> 0.409600).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.293903112411499
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3649342  Vali Loss: 0.3348789 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8780622  Vali macro F1 0.8532466 
new best score!!!!
Validation loss decreased (0.409600 --> 0.334879).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2996103763580322
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3136955  Vali Loss: 0.2888880 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8747048  Vali macro F1 0.8470938 
new best score!!!!
Validation loss decreased (0.334879 --> 0.288888).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2945923805236816
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2569254  Vali Loss: 0.2408779 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9164988  Vali macro F1 0.8906392 
new best score!!!!
Validation loss decreased (0.288888 --> 0.240878).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.294318437576294
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2249552  Vali Loss: 0.2255457 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9216252  Vali macro F1 0.9012691 
new best score!!!!
Validation loss decreased (0.240878 --> 0.225546).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2957463264465332
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1969518  Vali Loss: 0.2077646 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9157950  Vali macro F1 0.8898888 
new best score!!!!
Validation loss decreased (0.225546 --> 0.207765).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2979295253753662
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1797025  Vali Loss: 0.2203007 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8987264  Vali macro F1 0.8745265 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.290787935256958
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1673358  Vali Loss: 0.1826541 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9327496  Vali macro F1 0.9122500 
new best score!!!!
Validation loss decreased (0.207765 --> 0.182654).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2926816940307617
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1588448  Vali Loss: 0.1783499 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9219686  Vali macro F1 0.9022531 
new best score!!!!
Validation loss decreased (0.182654 --> 0.178350).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2946319580078125
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1542392  Vali Loss: 0.1718253 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8940136  Vali macro F1 0.8630623 
new best score!!!!
Validation loss decreased (0.178350 --> 0.171825).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2972378730773926
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1389352  Vali Loss: 0.1520298 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604018  Vali macro F1 0.9492828 
new best score!!!!
Validation loss decreased (0.171825 --> 0.152030).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2926554679870605
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1335455  Vali Loss: 0.1571343 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9024999  Vali macro F1 0.8703024 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.2934374809265137
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1249931  Vali Loss: 0.1411298 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9609518  Vali macro F1 0.9491939 
new best score!!!!
Validation loss decreased (0.152030 --> 0.141130).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.295219898223877
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1151328  Vali Loss: 0.1429085 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9657162  Vali macro F1 0.9565200 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.29433012008667
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1069633  Vali Loss: 0.1388798 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9352332  Vali macro F1 0.9134165 
new best score!!!!
Validation loss decreased (0.141130 --> 0.138880).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.294825553894043
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1093680  Vali Loss: 0.1357123 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9186238  Vali macro F1 0.8922748 
new best score!!!!
Validation loss decreased (0.138880 --> 0.135712).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3000929355621338
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1098627  Vali Loss: 0.1331794 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9596302  Vali macro F1 0.9478827 
new best score!!!!
Validation loss decreased (0.135712 --> 0.133179).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2987027168273926
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1139326  Vali Loss: 0.1365924 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9499620  Vali macro F1 0.9349430 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.295074701309204
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1015673  Vali Loss: 0.1500856 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9541222  Vali macro F1 0.9420538 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.293041467666626
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1029548  Vali Loss: 0.1364200 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9600647  Vali macro F1 0.9518885 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 1.297680377960205
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0959806  Vali Loss: 0.1380130 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630344  Vali macro F1 0.9557875 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 1.2931509017944336
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0890679  Vali Loss: 0.1125795 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684534  Vali macro F1 0.9601126 
new best score!!!!
Validation loss decreased (0.133179 --> 0.112579).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2939159870147705
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0891920  Vali Loss: 0.1262122 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9324064  Vali macro F1 0.9108883 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.2981147766113281
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0805754  Vali Loss: 0.1113971 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9452723  Vali macro F1 0.9300233 
new best score!!!!
Validation loss decreased (0.112579 --> 0.111397).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2976527214050293
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0854435  Vali Loss: 0.1039178 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9545364  Vali macro F1 0.9396986 
new best score!!!!
Validation loss decreased (0.111397 --> 0.103918).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2939910888671875
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0763930  Vali Loss: 0.0896191 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770362  Vali macro F1 0.9703328 
new best score!!!!
Validation loss decreased (0.103918 --> 0.089619).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3012378215789795
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0820233  Vali Loss: 0.1089716 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9657213  Vali macro F1 0.9571954 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3002803325653076
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0773226  Vali Loss: 0.0903457 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9706666  Vali macro F1 0.9600614 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 1.2997751235961914
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0698962  Vali Loss: 0.0811499 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771690  Vali macro F1 0.9716288 
new best score!!!!
Validation loss decreased (0.089619 --> 0.081150).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3002243041992188
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0678674  Vali Loss: 0.0801027 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773311  Vali macro F1 0.9706010 
new best score!!!!
Validation loss decreased (0.081150 --> 0.080103).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3221909999847412
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0725818  Vali Loss: 0.1007165 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9652882  Vali macro F1 0.9569135 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3032691478729248
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0686809  Vali Loss: 0.0696727 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858750  Vali macro F1 0.9823671 
new best score!!!!
Validation loss decreased (0.080103 --> 0.069673).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3004066944122314
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0603152  Vali Loss: 0.0655319 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858045  Vali macro F1 0.9821378 
new best score!!!!
Validation loss decreased (0.069673 --> 0.065532).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.29974365234375
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0569046  Vali Loss: 0.0598136 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886683  Vali macro F1 0.9860370 
new best score!!!!
Validation loss decreased (0.065532 --> 0.059814).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3028895854949951
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0472384  Vali Loss: 0.0546390 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859817  Vali macro F1 0.9831748 
new best score!!!!
Validation loss decreased (0.059814 --> 0.054639).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2992360591888428
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0443456  Vali Loss: 0.0316588 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.054639 --> 0.031659).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3000845909118652
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0392248  Vali Loss: 0.0295706 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.031659 --> 0.029571).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3011786937713623
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0332508  Vali Loss: 0.0404856 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915269  Vali macro F1 0.9911660 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3013334274291992
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0322408  Vali Loss: 0.0217985 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.029571 --> 0.021799).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2936382293701172
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0442970  Vali Loss: 0.0336950 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887015  Vali macro F1 0.9859252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2955858707427979
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0489934  Vali Loss: 0.0445430 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915280  Vali macro F1 0.9913723 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.2963488101959229
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0317733  Vali Loss: 0.0296479 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.294217586517334
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0357818  Vali Loss: 0.0224936 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.2937352657318115
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0287330  Vali Loss: 0.0335714 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943447  Vali macro F1 0.9952509 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 51 cost time: 1.2973992824554443
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0229267  Vali Loss: 0.0180563 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.021799 --> 0.018056).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.3004240989685059
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0202626  Vali Loss: 0.0155388 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.018056 --> 0.015539).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.295306921005249
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0206235  Vali Loss: 0.0152508 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.015539 --> 0.015251).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2940127849578857
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0188462  Vali Loss: 0.0150604 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.015251 --> 0.015060).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2990033626556396
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0200386  Vali Loss: 0.0145058 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.015060 --> 0.014506).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2947909832000732
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0162653  Vali Loss: 0.0140280 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014506 --> 0.014028).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2970292568206787
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0176320  Vali Loss: 0.0136596 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014028 --> 0.013660).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.2987902164459229
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0169108  Vali Loss: 0.0133772 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013660 --> 0.013377).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.29964280128479
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0155476  Vali Loss: 0.0127469 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013377 --> 0.012747).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.293623447418213
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0176883  Vali Loss: 0.0125215 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012747 --> 0.012521).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2955398559570312
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0160368  Vali Loss: 0.0123678 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012521 --> 0.012368).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.299454927444458
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0160031  Vali Loss: 0.0125705 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.302361011505127
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0145262  Vali Loss: 0.0126036 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.2965357303619385
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0163861  Vali Loss: 0.0123340 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012368 --> 0.012334).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.3228161334991455
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0148023  Vali Loss: 0.0124640 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.3008687496185303
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0155723  Vali Loss: 0.0123482 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 1.298799991607666
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0141907  Vali Loss: 0.0123861 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 1.2988572120666504
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0138166  Vali Loss: 0.0117517 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012334 --> 0.011752).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 1.307452917098999
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0156188  Vali Loss: 0.0113205 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011752 --> 0.011321).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.300567626953125
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0155588  Vali Loss: 0.0114197 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.2956199645996094
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0130930  Vali Loss: 0.0110336 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011321 --> 0.011034).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 1.3004872798919678
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0131963  Vali Loss: 0.0109707 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011034 --> 0.010971).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 1.3007421493530273
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0149472  Vali Loss: 0.0108096 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010971 --> 0.010810).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 1.3016467094421387
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0154563  Vali Loss: 0.0108110 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.2972209453582764
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0141356  Vali Loss: 0.0105293 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010810 --> 0.010529).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 1.3001537322998047
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0147188  Vali Loss: 0.0104696 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010529 --> 0.010470).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 1.2997770309448242
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0139155  Vali Loss: 0.0102530 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010470 --> 0.010253).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 1.2997708320617676
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0122814  Vali Loss: 0.0104282 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 1.2993800640106201
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0124010  Vali Loss: 0.0108182 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 1.29984712600708
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0116895  Vali Loss: 0.0103210 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 1.2952048778533936
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0127868  Vali Loss: 0.0101288 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010253 --> 0.010129).  Saving model ...
new best score!!!!
Epoch: 82 cost time: 1.297469139099121
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0132346  Vali Loss: 0.0098121 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010129 --> 0.009812).  Saving model ...
new best score!!!!
Epoch: 83 cost time: 1.296748399734497
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0150713  Vali Loss: 0.0095482 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009812 --> 0.009548).  Saving model ...
new best score!!!!
Epoch: 84 cost time: 1.2992308139801025
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0107343  Vali Loss: 0.0095716 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 1.3003742694854736
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0151100  Vali Loss: 0.0098895 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 1.3019328117370605
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0129401  Vali Loss: 0.0096193 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 1.3006031513214111
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0114495  Vali Loss: 0.0090875 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009548 --> 0.009088).  Saving model ...
new best score!!!!
Epoch: 88 cost time: 1.2954986095428467
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0132429  Vali Loss: 0.0089641 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009088 --> 0.008964).  Saving model ...
new best score!!!!
Epoch: 89 cost time: 1.2982509136199951
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0124900  Vali Loss: 0.0095807 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 1.3101513385772705
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0122847  Vali Loss: 0.0099635 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 91 cost time: 1.2982077598571777
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0123820  Vali Loss: 0.0120262 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 92 cost time: 1.3129940032958984
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0111065  Vali Loss: 0.0112659 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 93 cost time: 1.3016858100891113
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0111374  Vali Loss: 0.0107574 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 94 cost time: 1.299964427947998
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0107958  Vali Loss: 0.0107113 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 95 cost time: 1.296433687210083
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0106963  Vali Loss: 0.0105912 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 96 cost time: 1.2973229885101318
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0118695  Vali Loss: 0.0104509 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 97 cost time: 1.2992684841156006
VALI: Epoch: 97, Steps: 13 | Train Loss: 0.0121326  Vali Loss: 0.0103347 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 98 cost time: 1.2973194122314453
VALI: Epoch: 98, Steps: 13 | Train Loss: 0.0106098  Vali Loss: 0.0102476 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 99 cost time: 1.2983217239379883
VALI: Epoch: 99, Steps: 13 | Train Loss: 0.0109624  Vali Loss: 0.0102376 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 100 cost time: 1.3006737232208252
VALI: Epoch: 100, Steps: 13 | Train Loss: 0.0113702  Vali Loss: 0.0102306 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 101 cost time: 1.3004953861236572
VALI: Epoch: 101, Steps: 13 | Train Loss: 0.0110565  Vali Loss: 0.0102223 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 102 cost time: 1.2955257892608643
VALI: Epoch: 102, Steps: 13 | Train Loss: 0.0106771  Vali Loss: 0.0102122 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 103 cost time: 1.2982511520385742
VALI: Epoch: 103, Steps: 13 | Train Loss: 0.0112497  Vali Loss: 0.0102111 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909428  Test macro F1 0.9909414 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3857858180999756
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0146745  Vali Loss: 0.0102330 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.010233).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3860743045806885
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0136321  Vali Loss: 0.0097540 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010233 --> 0.009754).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.386145830154419
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0121933  Vali Loss: 0.0086461 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009754 --> 0.008646).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3830251693725586
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0140787  Vali Loss: 0.0086500 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.3833394050598145
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0120522  Vali Loss: 0.0087242 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.3846395015716553
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0105973  Vali Loss: 0.0083714 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008646 --> 0.008371).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.3836326599121094
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0119624  Vali Loss: 0.0087903 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.383470058441162
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0122949  Vali Loss: 0.0089888 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.3854560852050781
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0109616  Vali Loss: 0.0080176 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008371 --> 0.008018).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.3857824802398682
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0110725  Vali Loss: 0.0081079 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.3820858001708984
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0100408  Vali Loss: 0.0089975 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.3849475383758545
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0103029  Vali Loss: 0.0078294 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008018 --> 0.007829).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.3863532543182373
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0096476  Vali Loss: 0.0073639 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007829 --> 0.007364).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.3830232620239258
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0091658  Vali Loss: 0.0069031 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007364 --> 0.006903).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.3826346397399902
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0125829  Vali Loss: 0.0071939 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.3850939273834229
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0092297  Vali Loss: 0.0079744 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.3926570415496826
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0102142  Vali Loss: 0.0093968 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.384293556213379
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0102443  Vali Loss: 0.0086396 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 1.38295578956604
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0090079  Vali Loss: 0.0079495 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 20 cost time: 1.3877859115600586
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0077732  Vali Loss: 0.0074495 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.3847370147705078
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0101323  Vali Loss: 0.0071569 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 1.3833484649658203
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0087977  Vali Loss: 0.0066787 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006903 --> 0.006679).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.3867547512054443
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0084285  Vali Loss: 0.0084677 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.3867197036743164
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0072516  Vali Loss: 0.0095816 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.3827338218688965
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0070430  Vali Loss: 0.0083863 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.383333444595337
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0078487  Vali Loss: 0.0069578 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.3876147270202637
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0088922  Vali Loss: 0.0067733 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 1.3838837146759033
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0063179  Vali Loss: 0.0067640 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.3822054862976074
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0069898  Vali Loss: 0.0067332 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.386178731918335
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0083386  Vali Loss: 0.0066672 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006679 --> 0.006667).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 1.386298418045044
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0071018  Vali Loss: 0.0066278 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006667 --> 0.006628).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 1.384495735168457
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0077882  Vali Loss: 0.0066641 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 1.3841683864593506
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0070462  Vali Loss: 0.0068101 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 1.3871865272521973
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0070634  Vali Loss: 0.0068373 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 1.3834049701690674
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0059519  Vali Loss: 0.0068658 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 1.38250732421875
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0080529  Vali Loss: 0.0069091 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 37 cost time: 1.38651704788208
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0063774  Vali Loss: 0.0069119 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 1.3862178325653076
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0075764  Vali Loss: 0.0069292 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 1.383474588394165
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0070341  Vali Loss: 0.0069391 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 1.3834898471832275
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0075235  Vali Loss: 0.0069526 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 1.386908769607544
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0072446  Vali Loss: 0.0069408 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 42 cost time: 1.3828308582305908
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0082690  Vali Loss: 0.0069409 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 43 cost time: 1.382991075515747
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0077967  Vali Loss: 0.0069415 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 44 cost time: 1.385502576828003
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0093328  Vali Loss: 0.0069420 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 45 cost time: 1.3862457275390625
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0075938  Vali Loss: 0.0069440 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 46 cost time: 1.3825938701629639
Fine Tuning VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0075825  Vali Loss: 0.0069462 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932200  Test macro F1 0.9930363 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263158 0.00242718 0.002457   0.003367   0.00598802 0.00571429
 0.00310559 0.002849   0.00240964 0.003861  ]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3189358711242676
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2790055  Vali Loss: 2.2697934 Vali Accuracy: 0.1327684  Vali weighted F1: 0.0311228  Vali macro F1 0.0234414 
Validation loss decreased (inf --> 2.269793).  Saving model ...
Epoch: 2 cost time: 1.2974867820739746
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.0379533  Vali Loss: 1.6851433 Vali Accuracy: 0.3587571  Vali weighted F1: 0.3119268  Vali macro F1 0.2956789 
new best score!!!!
Validation loss decreased (2.269793 --> 1.685143).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3016600608825684
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3539700  Vali Loss: 1.0322884 Vali Accuracy: 0.6327684  Vali weighted F1: 0.5997530  Vali macro F1 0.5948416 
new best score!!!!
Validation loss decreased (1.685143 --> 1.032288).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3039021492004395
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9406538  Vali Loss: 0.7782131 Vali Accuracy: 0.6949153  Vali weighted F1: 0.6429709  Vali macro F1 0.6361581 
new best score!!!!
Validation loss decreased (1.032288 --> 0.778213).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2982110977172852
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7108835  Vali Loss: 0.6353680 Vali Accuracy: 0.7627119  Vali weighted F1: 0.7398964  Vali macro F1 0.7209571 
new best score!!!!
Validation loss decreased (0.778213 --> 0.635368).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.296537160873413
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5638384  Vali Loss: 0.4941232 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8336685  Vali macro F1 0.8235577 
new best score!!!!
Validation loss decreased (0.635368 --> 0.494123).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3030219078063965
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4551777  Vali Loss: 0.4095741 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8638988  Vali macro F1 0.8486982 
new best score!!!!
Validation loss decreased (0.494123 --> 0.409574).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.29795241355896
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3711150  Vali Loss: 0.3318101 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9024727  Vali macro F1 0.8837355 
new best score!!!!
Validation loss decreased (0.409574 --> 0.331810).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3019788265228271
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3267869  Vali Loss: 0.2943811 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8809287  Vali macro F1 0.8538655 
new best score!!!!
Validation loss decreased (0.331810 --> 0.294381).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.301478624343872
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2727418  Vali Loss: 0.2734547 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8920405  Vali macro F1 0.8730534 
new best score!!!!
Validation loss decreased (0.294381 --> 0.273455).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3022665977478027
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2429741  Vali Loss: 0.2275749 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9300422  Vali macro F1 0.9130990 
new best score!!!!
Validation loss decreased (0.273455 --> 0.227575).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2989578247070312
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2177509  Vali Loss: 0.2033851 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9258763  Vali macro F1 0.9031740 
new best score!!!!
Validation loss decreased (0.227575 --> 0.203385).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2986302375793457
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1850805  Vali Loss: 0.1857486 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9381201  Vali macro F1 0.9184786 
new best score!!!!
Validation loss decreased (0.203385 --> 0.185749).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3028175830841064
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1662565  Vali Loss: 0.1668748 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9237414  Vali macro F1 0.8990181 
new best score!!!!
Validation loss decreased (0.185749 --> 0.166875).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3010084629058838
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1538444  Vali Loss: 0.1664566 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9462171  Vali macro F1 0.9311020 
new best score!!!!
Validation loss decreased (0.166875 --> 0.166457).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3024311065673828
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1476427  Vali Loss: 0.1497672 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9519596  Vali macro F1 0.9345912 
new best score!!!!
Validation loss decreased (0.166457 --> 0.149767).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3020036220550537
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1421846  Vali Loss: 0.1491462 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9081479  Vali macro F1 0.8749399 
new best score!!!!
Validation loss decreased (0.149767 --> 0.149146).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.303304672241211
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1411238  Vali Loss: 0.1618530 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9230550  Vali macro F1 0.8999007 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.2982275485992432
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1262004  Vali Loss: 0.1492510 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9239395  Vali macro F1 0.9036054 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.2980945110321045
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1197200  Vali Loss: 0.1426877 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9504552  Vali macro F1 0.9368559 
new best score!!!!
Validation loss decreased (0.149146 --> 0.142688).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.304145336151123
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1102032  Vali Loss: 0.1351480 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9480549  Vali macro F1 0.9321943 
new best score!!!!
Validation loss decreased (0.142688 --> 0.135148).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3030576705932617
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1106445  Vali Loss: 0.1342356 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9599926  Vali macro F1 0.9484480 
new best score!!!!
Validation loss decreased (0.135148 --> 0.134236).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.301335334777832
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1074699  Vali Loss: 0.1413850 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9214100  Vali macro F1 0.8960613 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3036797046661377
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1068324  Vali Loss: 0.1285594 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9444260  Vali macro F1 0.9271816 
new best score!!!!
Validation loss decreased (0.134236 --> 0.128559).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3030200004577637
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0977286  Vali Loss: 0.1241770 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9558632  Vali macro F1 0.9426366 
new best score!!!!
Validation loss decreased (0.128559 --> 0.124177).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3002018928527832
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0964203  Vali Loss: 0.1221025 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9481296  Vali macro F1 0.9322960 
new best score!!!!
Validation loss decreased (0.124177 --> 0.122102).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3026189804077148
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0869702  Vali Loss: 0.1035488 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716625  Vali macro F1 0.9628831 
new best score!!!!
Validation loss decreased (0.122102 --> 0.103549).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3108558654785156
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0863812  Vali Loss: 0.1078831 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745388  Vali macro F1 0.9667992 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.2990071773529053
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0860131  Vali Loss: 0.0913920 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9651382  Vali macro F1 0.9539999 
new best score!!!!
Validation loss decreased (0.103549 --> 0.091392).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3074922561645508
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0723528  Vali Loss: 0.0894154 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743898  Vali macro F1 0.9680503 
new best score!!!!
Validation loss decreased (0.091392 --> 0.089415).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3055646419525146
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0757358  Vali Loss: 0.0990917 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631087  Vali macro F1 0.9538274 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.303807258605957
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0677751  Vali Loss: 0.0794346 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802188  Vali macro F1 0.9759867 
new best score!!!!
Validation loss decreased (0.089415 --> 0.079435).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3126263618469238
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0638699  Vali Loss: 0.0728167 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801969  Vali macro F1 0.9745029 
new best score!!!!
Validation loss decreased (0.079435 --> 0.072817).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3020355701446533
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0546304  Vali Loss: 0.0757697 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802193  Vali macro F1 0.9772365 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.3056466579437256
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0587856  Vali Loss: 0.0580627 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772983  Vali macro F1 0.9720103 
new best score!!!!
Validation loss decreased (0.072817 --> 0.058063).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.301555871963501
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0565721  Vali Loss: 0.0743421 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743864  Vali macro F1 0.9689488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3013513088226318
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0578229  Vali Loss: 0.0441885 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886838  Vali macro F1 0.9845926 
new best score!!!!
Validation loss decreased (0.058063 --> 0.044189).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3063898086547852
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0485214  Vali Loss: 0.0456841 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830684  Vali macro F1 0.9795197 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.3045141696929932
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0485505  Vali Loss: 0.0465732 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858105  Vali macro F1 0.9821344 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.302225112915039
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0463666  Vali Loss: 0.0377887 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943419  Vali macro F1 0.9922963 
new best score!!!!
Validation loss decreased (0.044189 --> 0.037789).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3038146495819092
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0386747  Vali Loss: 0.0413927 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886935  Vali macro F1 0.9860713 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3045222759246826
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0385896  Vali Loss: 0.0340012 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858329  Vali macro F1 0.9852482 
new best score!!!!
Validation loss decreased (0.037789 --> 0.034001).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3009448051452637
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0299733  Vali Loss: 0.0276378 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9872146 
new best score!!!!
Validation loss decreased (0.034001 --> 0.027638).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3008005619049072
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0346710  Vali Loss: 0.0272057 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915274  Vali macro F1 0.9899183 
new best score!!!!
Validation loss decreased (0.027638 --> 0.027206).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3056690692901611
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0272528  Vali Loss: 0.0352850 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858706  Vali macro F1 0.9836819 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3037424087524414
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0344743  Vali Loss: 0.0239715 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915274  Vali macro F1 0.9899183 
new best score!!!!
Validation loss decreased (0.027206 --> 0.023971).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3007571697235107
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0239320  Vali Loss: 0.0394191 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886743  Vali macro F1 0.9860336 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3014750480651855
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0224451  Vali Loss: 0.0277962 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886986  Vali macro F1 0.9875236 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.3030962944030762
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0250708  Vali Loss: 0.0223566 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914939  Vali macro F1 0.9914903 
new best score!!!!
Validation loss decreased (0.023971 --> 0.022357).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.3014209270477295
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0244293  Vali Loss: 0.0168103 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915191  Vali macro F1 0.9899069 
new best score!!!!
Validation loss decreased (0.022357 --> 0.016810).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.300666093826294
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0222284  Vali Loss: 0.0171351 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.3045880794525146
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0207454  Vali Loss: 0.0099639 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016810 --> 0.009964).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.3062303066253662
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0225831  Vali Loss: 0.0150612 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3023674488067627
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0231097  Vali Loss: 0.0337978 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887642  Vali macro F1 0.9886224 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3021371364593506
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0474424  Vali Loss: 0.0223247 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.3062307834625244
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0293663  Vali Loss: 0.0220096 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943519  Vali macro F1 0.9953625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.2993988990783691
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0217522  Vali Loss: 0.0186479 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 58 cost time: 1.3062283992767334
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0183015  Vali Loss: 0.0174940 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3044850826263428
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0150531  Vali Loss: 0.0161923 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.3231513500213623
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0162369  Vali Loss: 0.0157380 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.3019607067108154
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0129878  Vali Loss: 0.0150168 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.3016467094421387
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0134495  Vali Loss: 0.0140987 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 63 cost time: 1.3038949966430664
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0129358  Vali Loss: 0.0140783 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.3002738952636719
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0138444  Vali Loss: 0.0140568 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.300623893737793
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0128814  Vali Loss: 0.0140252 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.3030412197113037
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0117549  Vali Loss: 0.0139750 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.302771806716919
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0114446  Vali Loss: 0.0139591 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920954  Test macro F1 0.9883732 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3858580589294434
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0146373  Vali Loss: 0.0105307 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
Validation loss decreased (inf --> 0.010531).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3776092529296875
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0148163  Vali Loss: 0.0118665 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.3775901794433594
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0128019  Vali Loss: 0.0093483 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.010531 --> 0.009348).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3806023597717285
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0132459  Vali Loss: 0.0081968 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009348 --> 0.008197).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.3798866271972656
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0135426  Vali Loss: 0.0083762 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.3771018981933594
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0132238  Vali Loss: 0.0111784 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.3770813941955566
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0107925  Vali Loss: 0.0096986 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 1.3810720443725586
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0114183  Vali Loss: 0.0082135 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 1.3771469593048096
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0106815  Vali Loss: 0.0071010 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008197 --> 0.007101).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.3768506050109863
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0130314  Vali Loss: 0.0072248 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.3808093070983887
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0125420  Vali Loss: 0.0069456 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007101 --> 0.006946).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.380875825881958
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0117821  Vali Loss: 0.0064585 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006946 --> 0.006458).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.3768179416656494
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0101437  Vali Loss: 0.0069232 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.377899169921875
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0130862  Vali Loss: 0.0065620 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.3811323642730713
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0128932  Vali Loss: 0.0123546 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.3768839836120605
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0115920  Vali Loss: 0.0093410 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.3767116069793701
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0102768  Vali Loss: 0.0072016 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 1.3802781105041504
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0097204  Vali Loss: 0.0065128 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.3808653354644775
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0114278  Vali Loss: 0.0065858 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.3770973682403564
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0088061  Vali Loss: 0.0083773 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.3813512325286865
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0089576  Vali Loss: 0.0080673 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971772  Vali macro F1 0.9976106 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.380937099456787
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0086277  Vali Loss: 0.0073800 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 1.377941608428955
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0084133  Vali Loss: 0.0073649 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.377143383026123
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0100331  Vali Loss: 0.0073246 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.3811538219451904
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0101325  Vali Loss: 0.0073972 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.380072832107544
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0083380  Vali Loss: 0.0073474 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.376152515411377
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0092803  Vali Loss: 0.0074667 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9954751  Test weighted F1: 0.9954639  Test macro F1 0.9945307 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.0027027  0.00240385 0.00242131 0.00319489 0.00574713 0.00617284
 0.00315457 0.0028169  0.00246305 0.00390625]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.297349452972412
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2769294  Vali Loss: 2.2255882 Vali Accuracy: 0.2090395  Vali weighted F1: 0.1137640  Vali macro F1 0.0844593 
Validation loss decreased (inf --> 2.225588).  Saving model ...
Epoch: 2 cost time: 1.2956430912017822
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.0143706  Vali Loss: 1.6555513 Vali Accuracy: 0.4491525  Vali weighted F1: 0.4141339  Vali macro F1 0.4015487 
new best score!!!!
Validation loss decreased (2.225588 --> 1.655551).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2965185642242432
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3697351  Vali Loss: 1.0239490 Vali Accuracy: 0.5960452  Vali weighted F1: 0.5846143  Vali macro F1 0.5503696 
new best score!!!!
Validation loss decreased (1.655551 --> 1.023949).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2965683937072754
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9767201  Vali Loss: 0.7424946 Vali Accuracy: 0.7485876  Vali weighted F1: 0.7335005  Vali macro F1 0.6980612 
new best score!!!!
Validation loss decreased (1.023949 --> 0.742495).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2921562194824219
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7354812  Vali Loss: 0.5933125 Vali Accuracy: 0.7909605  Vali weighted F1: 0.7913561  Vali macro F1 0.7664385 
new best score!!!!
Validation loss decreased (0.742495 --> 0.593312).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2924680709838867
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5725987  Vali Loss: 0.4759229 Vali Accuracy: 0.8220339  Vali weighted F1: 0.8046206  Vali macro F1 0.7610527 
new best score!!!!
Validation loss decreased (0.593312 --> 0.475923).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.299149990081787
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4593811  Vali Loss: 0.4010987 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8611370  Vali macro F1 0.8254080 
new best score!!!!
Validation loss decreased (0.475923 --> 0.401099).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2923083305358887
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3872152  Vali Loss: 0.3312365 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8929274  Vali macro F1 0.8463058 
new best score!!!!
Validation loss decreased (0.401099 --> 0.331237).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2929034233093262
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3300793  Vali Loss: 0.2764353 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8927986  Vali macro F1 0.8423518 
new best score!!!!
Validation loss decreased (0.331237 --> 0.276435).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2961246967315674
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2832783  Vali Loss: 0.2475179 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9209230  Vali macro F1 0.8977620 
new best score!!!!
Validation loss decreased (0.276435 --> 0.247518).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.296349048614502
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2396994  Vali Loss: 0.1984266 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9166124  Vali macro F1 0.8749890 
new best score!!!!
Validation loss decreased (0.247518 --> 0.198427).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2937672138214111
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2092133  Vali Loss: 0.1997179 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9153355  Vali macro F1 0.8754381 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.294675350189209
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1797793  Vali Loss: 0.1718275 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9406299  Vali macro F1 0.9127323 
new best score!!!!
Validation loss decreased (0.198427 --> 0.171827).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2980918884277344
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1692040  Vali Loss: 0.1636052 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9215526  Vali macro F1 0.8735305 
new best score!!!!
Validation loss decreased (0.171827 --> 0.163605).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2943556308746338
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1576433  Vali Loss: 0.1648858 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9272503  Vali macro F1 0.8868591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.294689655303955
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1439807  Vali Loss: 0.1576675 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9428152  Vali macro F1 0.9112270 
new best score!!!!
Validation loss decreased (0.163605 --> 0.157668).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2995753288269043
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1382846  Vali Loss: 0.1455033 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9287197  Vali macro F1 0.8840799 
new best score!!!!
Validation loss decreased (0.157668 --> 0.145503).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2995645999908447
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1294100  Vali Loss: 0.1204610 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9356476  Vali macro F1 0.8931001 
new best score!!!!
Validation loss decreased (0.145503 --> 0.120461).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.294607400894165
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1237394  Vali Loss: 0.1182987 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9428459  Vali macro F1 0.9036983 
new best score!!!!
Validation loss decreased (0.120461 --> 0.118299).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2942137718200684
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1228587  Vali Loss: 0.1510634 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9186530  Vali macro F1 0.8689774 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.305079460144043
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1122720  Vali Loss: 0.1148487 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9517372  Vali macro F1 0.9200112 
new best score!!!!
Validation loss decreased (0.118299 --> 0.114849).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2979686260223389
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0992274  Vali Loss: 0.1100398 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9469762  Vali macro F1 0.9110089 
new best score!!!!
Validation loss decreased (0.114849 --> 0.110040).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2979404926300049
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0984662  Vali Loss: 0.1262696 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9440848  Vali macro F1 0.9117659 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.299581527709961
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0926834  Vali Loss: 0.1210967 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9528676  Vali macro F1 0.9247008 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.3189175128936768
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0884979  Vali Loss: 0.0962046 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660304  Vali macro F1 0.9453102 
new best score!!!!
Validation loss decreased (0.110040 --> 0.096205).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2999508380889893
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0797328  Vali Loss: 0.0964518 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744831  Vali macro F1 0.9602438 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2957253456115723
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0767091  Vali Loss: 0.0977068 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9621012  Vali macro F1 0.9398109 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.3018505573272705
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0732836  Vali Loss: 0.0787801 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773844  Vali macro F1 0.9626893 
new best score!!!!
Validation loss decreased (0.096205 --> 0.078780).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2996671199798584
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0660137  Vali Loss: 0.0698369 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858465  Vali macro F1 0.9803570 
new best score!!!!
Validation loss decreased (0.078780 --> 0.069837).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2947564125061035
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0598317  Vali Loss: 0.0647876 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858164  Vali macro F1 0.9802247 
new best score!!!!
Validation loss decreased (0.069837 --> 0.064788).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2993645668029785
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0714973  Vali Loss: 0.1082726 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9683822  Vali macro F1 0.9539933 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.2985234260559082
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0685294  Vali Loss: 0.0839831 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829795  Vali macro F1 0.9779119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.2957196235656738
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0554045  Vali Loss: 0.0747025 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887224  Vali macro F1 0.9881638 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.2956249713897705
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0461429  Vali Loss: 0.0632787 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858710  Vali macro F1 0.9831459 
new best score!!!!
Validation loss decreased (0.064788 --> 0.063279).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3002128601074219
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0442189  Vali Loss: 0.0621219 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943690  Vali macro F1 0.9954418 
new best score!!!!
Validation loss decreased (0.063279 --> 0.062122).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2997255325317383
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0391718  Vali Loss: 0.0529907 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
new best score!!!!
Validation loss decreased (0.062122 --> 0.052991).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.296255111694336
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0434935  Vali Loss: 0.0602766 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915506  Vali macro F1 0.9930238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.2992291450500488
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0338342  Vali Loss: 0.0736057 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802068  Vali macro F1 0.9782559 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.2976524829864502
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0280468  Vali Loss: 0.0354996 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
new best score!!!!
Validation loss decreased (0.052991 --> 0.035500).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.298107385635376
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0229492  Vali Loss: 0.0488581 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887224  Vali macro F1 0.9881638 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.2979176044464111
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0236722  Vali Loss: 0.0544530 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859014  Vali macro F1 0.9854932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.299328088760376
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0242110  Vali Loss: 0.0380290 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.2954883575439453
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0298052  Vali Loss: 0.0488541 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887362  Vali macro F1 0.9873303 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 1.2956571578979492
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0248951  Vali Loss: 0.0380792 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971708  Vali macro F1 0.9977112 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 45 cost time: 1.299337387084961
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0182909  Vali Loss: 0.0395516 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2988486289978027
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0155360  Vali Loss: 0.0427771 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.2956101894378662
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0135566  Vali Loss: 0.0431578 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.2954001426696777
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0125257  Vali Loss: 0.0430553 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 1.3013203144073486
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0128644  Vali Loss: 0.0427853 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 1.2982094287872314
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0127751  Vali Loss: 0.0427793 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.2960915565490723
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0116051  Vali Loss: 0.0427829 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.3003995418548584
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0119535  Vali Loss: 0.0428198 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.2972486019134521
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0128088  Vali Loss: 0.0428778 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 1.2934012413024902
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0139243  Vali Loss: 0.0429289 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9875986  Test weighted F1: 0.9875949  Test macro F1 0.9857561 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4074578285217285
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0238466  Vali Loss: 0.0495934 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887224  Vali macro F1 0.9881638 
Validation loss decreased (inf --> 0.049593).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4051551818847656
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0203979  Vali Loss: 0.0491056 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
new best score!!!!
Validation loss decreased (0.049593 --> 0.049106).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.4081239700317383
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0179295  Vali Loss: 0.0493792 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.40877366065979
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0183001  Vali Loss: 0.0460164 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
new best score!!!!
Validation loss decreased (0.049106 --> 0.046016).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.4053685665130615
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0206717  Vali Loss: 0.0463443 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.404534101486206
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0166955  Vali Loss: 0.0444619 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
new best score!!!!
Validation loss decreased (0.046016 --> 0.044462).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.4081149101257324
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0200904  Vali Loss: 0.0422329 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
new best score!!!!
Validation loss decreased (0.044462 --> 0.042233).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.405820369720459
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0186987  Vali Loss: 0.0448140 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.4063210487365723
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0154921  Vali Loss: 0.0441456 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.4083890914916992
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0136976  Vali Loss: 0.0437476 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.4082810878753662
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0156344  Vali Loss: 0.0406367 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
new best score!!!!
Validation loss decreased (0.042233 --> 0.040637).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.4066965579986572
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0152948  Vali Loss: 0.0392517 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
new best score!!!!
Validation loss decreased (0.040637 --> 0.039252).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.4059333801269531
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0163393  Vali Loss: 0.0384792 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
new best score!!!!
Validation loss decreased (0.039252 --> 0.038479).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.4075872898101807
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0145353  Vali Loss: 0.0396888 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.4061875343322754
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0137176  Vali Loss: 0.0411256 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.406874179840088
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0127097  Vali Loss: 0.0436395 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.408703327178955
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0128090  Vali Loss: 0.0429059 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.4077630043029785
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0129641  Vali Loss: 0.0431820 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 1.4060580730438232
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0115731  Vali Loss: 0.0435343 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.4056992530822754
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0116954  Vali Loss: 0.0432326 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.407970905303955
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0118760  Vali Loss: 0.0426260 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.4054648876190186
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0131428  Vali Loss: 0.0439519 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915232  Vali macro F1 0.9904323 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.4040858745574951
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0139623  Vali Loss: 0.0470751 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 1.4085583686828613
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0121512  Vali Loss: 0.0464709 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 1.4083678722381592
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0117934  Vali Loss: 0.0454843 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 1.4050161838531494
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0105518  Vali Loss: 0.0449345 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 1.4051554203033447
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0112234  Vali Loss: 0.0445356 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 1.4086251258850098
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0111648  Vali Loss: 0.0443130 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915617  Vali macro F1 0.9901881 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9875986  Test weighted F1: 0.9876096  Test macro F1 0.9857887 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 285395
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0025974  0.00241546 0.00248756 0.00307692 0.00561798 0.00621118
 0.0031746  0.00286533 0.00241546 0.00413223]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3602173328399658
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2689484  Vali Loss: 2.2103406 Vali Accuracy: 0.1440678  Vali weighted F1: 0.0445339  Vali macro F1 0.0325000 
Validation loss decreased (inf --> 2.210341).  Saving model ...
Epoch: 2 cost time: 1.3055479526519775
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.0075908  Vali Loss: 1.6378656 Vali Accuracy: 0.4265537  Vali weighted F1: 0.4040487  Vali macro F1 0.3832569 
new best score!!!!
Validation loss decreased (2.210341 --> 1.637866).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.301866054534912
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.4060482  Vali Loss: 0.9732718 Vali Accuracy: 0.7655367  Vali weighted F1: 0.7629975  Vali macro F1 0.7434547 
new best score!!!!
Validation loss decreased (1.637866 --> 0.973272).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3014938831329346
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9548678  Vali Loss: 0.7147450 Vali Accuracy: 0.7824859  Vali weighted F1: 0.7572944  Vali macro F1 0.7031674 
new best score!!!!
Validation loss decreased (0.973272 --> 0.714745).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.305316686630249
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6913977  Vali Loss: 0.4948052 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8225644  Vali macro F1 0.7733890 
new best score!!!!
Validation loss decreased (0.714745 --> 0.494805).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3008143901824951
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5326795  Vali Loss: 0.4031486 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8725411  Vali macro F1 0.8409959 
new best score!!!!
Validation loss decreased (0.494805 --> 0.403149).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3007853031158447
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4269501  Vali Loss: 0.3360568 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8695331  Vali macro F1 0.8226156 
new best score!!!!
Validation loss decreased (0.403149 --> 0.336057).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3061861991882324
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3817188  Vali Loss: 0.3014970 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8948854  Vali macro F1 0.8550205 
new best score!!!!
Validation loss decreased (0.336057 --> 0.301497).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.30527925491333
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3241415  Vali Loss: 0.2634423 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9125568  Vali macro F1 0.8691790 
new best score!!!!
Validation loss decreased (0.301497 --> 0.263442).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3016583919525146
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2859705  Vali Loss: 0.2204856 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9093095  Vali macro F1 0.8575010 
new best score!!!!
Validation loss decreased (0.263442 --> 0.220486).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3005924224853516
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2470487  Vali Loss: 0.1890645 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9233813  Vali macro F1 0.8810944 
new best score!!!!
Validation loss decreased (0.220486 --> 0.189065).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.303682565689087
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2237958  Vali Loss: 0.1842661 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9243720  Vali macro F1 0.8853922 
new best score!!!!
Validation loss decreased (0.189065 --> 0.184266).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3006837368011475
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2066882  Vali Loss: 0.1860526 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9183246  Vali macro F1 0.8734879 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.3001575469970703
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1896939  Vali Loss: 0.1497198 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9208075  Vali macro F1 0.8731725 
new best score!!!!
Validation loss decreased (0.184266 --> 0.149720).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3024780750274658
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1781763  Vali Loss: 0.1442963 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9426767  Vali macro F1 0.9143247 
new best score!!!!
Validation loss decreased (0.149720 --> 0.144296).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3033981323242188
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1622637  Vali Loss: 0.1465692 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9249455  Vali macro F1 0.8862732 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.300764799118042
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1475533  Vali Loss: 0.1344297 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9339298  Vali macro F1 0.8976094 
new best score!!!!
Validation loss decreased (0.144296 --> 0.134430).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3008840084075928
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1444857  Vali Loss: 0.1188110 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9356507  Vali macro F1 0.8985230 
new best score!!!!
Validation loss decreased (0.134430 --> 0.118811).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.306260585784912
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1275638  Vali Loss: 0.1104211 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9407186  Vali macro F1 0.9046598 
new best score!!!!
Validation loss decreased (0.118811 --> 0.110421).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3026652336120605
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1164161  Vali Loss: 0.1123199 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9407202  Vali macro F1 0.9024071 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3028154373168945
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1077158  Vali Loss: 0.1085910 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9433316  Vali macro F1 0.9149627 
new best score!!!!
Validation loss decreased (0.110421 --> 0.108591).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3077728748321533
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1122052  Vali Loss: 0.1105563 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9335743  Vali macro F1 0.8857773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3063926696777344
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1066242  Vali Loss: 0.1120178 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9261211  Vali macro F1 0.8857193 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.3028910160064697
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0975910  Vali Loss: 0.1010749 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9441743  Vali macro F1 0.9038479 
new best score!!!!
Validation loss decreased (0.108591 --> 0.101075).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3045244216918945
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1018789  Vali Loss: 0.1091591 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9545997  Vali macro F1 0.9303624 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3110666275024414
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0929396  Vali Loss: 0.1062539 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9385907  Vali macro F1 0.8980591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 1.302584171295166
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0869509  Vali Loss: 0.0926968 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9480951  Vali macro F1 0.9162452 
new best score!!!!
Validation loss decreased (0.101075 --> 0.092697).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3057186603546143
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0887856  Vali Loss: 0.0989161 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9422746  Vali macro F1 0.9063029 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.305021047592163
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0820358  Vali Loss: 0.0851189 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9626971  Vali macro F1 0.9374258 
new best score!!!!
Validation loss decreased (0.092697 --> 0.085119).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3088903427124023
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0755924  Vali Loss: 0.0959000 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9529280  Vali macro F1 0.9199211 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3016464710235596
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0665328  Vali Loss: 0.0982102 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9625536  Vali macro F1 0.9450045 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3120861053466797
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0667512  Vali Loss: 0.0865908 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9551022  Vali macro F1 0.9222995 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.3097121715545654
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0613873  Vali Loss: 0.0677431 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9734506  Vali macro F1 0.9533207 
new best score!!!!
Validation loss decreased (0.085119 --> 0.067743).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3040571212768555
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0523887  Vali Loss: 0.0693311 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684437  Vali macro F1 0.9474748 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.300734519958496
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0510716  Vali Loss: 0.0764026 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9631872  Vali macro F1 0.9349206 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.3053433895111084
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0438682  Vali Loss: 0.0658385 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714706  Vali macro F1 0.9528496 
new best score!!!!
Validation loss decreased (0.067743 --> 0.065839).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3075237274169922
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0487265  Vali Loss: 0.0599523 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742981  Vali macro F1 0.9551368 
new best score!!!!
Validation loss decreased (0.065839 --> 0.059952).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3031413555145264
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0421384  Vali Loss: 0.0599084 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745760  Vali macro F1 0.9586376 
new best score!!!!
Validation loss decreased (0.059952 --> 0.059908).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3028111457824707
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0438514  Vali Loss: 0.0742423 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9734506  Vali macro F1 0.9533207 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3058602809906006
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0355661  Vali Loss: 0.0631328 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9793505  Vali macro F1 0.9636939 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.302488088607788
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0372844  Vali Loss: 0.0460332 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829485  Vali macro F1 0.9702899 
new best score!!!!
Validation loss decreased (0.059908 --> 0.046033).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.301896095275879
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0298719  Vali Loss: 0.0476981 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830143  Vali macro F1 0.9730882 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.3048341274261475
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0345465  Vali Loss: 0.0588819 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801523  Vali macro F1 0.9690902 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3048803806304932
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0369140  Vali Loss: 0.0511843 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802278  Vali macro F1 0.9682941 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.3016993999481201
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0413423  Vali Loss: 0.0477652 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830508  Vali macro F1 0.9705742 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 1.3011949062347412
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0334412  Vali Loss: 0.0571854 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829485  Vali macro F1 0.9702899 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 1.3037383556365967
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0279767  Vali Loss: 0.0498489 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829485  Vali macro F1 0.9702899 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3018412590026855
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0252828  Vali Loss: 0.0427883 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
new best score!!!!
Validation loss decreased (0.046033 --> 0.042788).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3091843128204346
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0231398  Vali Loss: 0.0420154 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
new best score!!!!
Validation loss decreased (0.042788 --> 0.042015).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.310981035232544
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0214751  Vali Loss: 0.0444494 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858418  Vali macro F1 0.9753754 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.3100612163543701
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0217236  Vali Loss: 0.0419634 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858418  Vali macro F1 0.9753754 
new best score!!!!
Validation loss decreased (0.042015 --> 0.041963).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.3008229732513428
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0196631  Vali Loss: 0.0396794 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
new best score!!!!
Validation loss decreased (0.041963 --> 0.039679).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.302156686782837
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0190219  Vali Loss: 0.0398541 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3048059940338135
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0179319  Vali Loss: 0.0401277 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3025360107421875
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0221937  Vali Loss: 0.0403763 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.302274465560913
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0193979  Vali Loss: 0.0418544 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.307354211807251
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0177380  Vali Loss: 0.0363613 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.039679 --> 0.036361).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.31201171875
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0191504  Vali Loss: 0.0394286 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.303356409072876
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0199350  Vali Loss: 0.0416228 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.3024890422821045
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0188635  Vali Loss: 0.0381522 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.3101584911346436
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0180546  Vali Loss: 0.0350160 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.036361 --> 0.035016).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.3237462043762207
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0170795  Vali Loss: 0.0375597 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.3033373355865479
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0172360  Vali Loss: 0.0371297 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.3097476959228516
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0163331  Vali Loss: 0.0394135 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.3041951656341553
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0161943  Vali Loss: 0.0363377 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.3003928661346436
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0164919  Vali Loss: 0.0391618 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 67 cost time: 1.3003666400909424
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0195666  Vali Loss: 0.0385152 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.3036465644836426
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0160518  Vali Loss: 0.0372678 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.3058242797851562
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0163164  Vali Loss: 0.0366308 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.3006179332733154
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0170255  Vali Loss: 0.0364050 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 1.308610200881958
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0152482  Vali Loss: 0.0365465 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 72 cost time: 1.3052070140838623
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0145635  Vali Loss: 0.0365323 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 1.3041839599609375
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0163429  Vali Loss: 0.0365220 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 1.3008031845092773
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0175371  Vali Loss: 0.0365106 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 1.3039629459381104
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0161920  Vali Loss: 0.0364823 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 1.2989706993103027
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0164517  Vali Loss: 0.0364961 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9852992  Test macro F1 0.9826510 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.397007703781128
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0197492  Vali Loss: 0.0352525 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
Validation loss decreased (inf --> 0.035252).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.391857385635376
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0165043  Vali Loss: 0.0373750 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.392256736755371
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0173980  Vali Loss: 0.0337626 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.035252 --> 0.033763).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3968689441680908
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0180085  Vali Loss: 0.0411489 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.3943097591400146
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0162500  Vali Loss: 0.0359619 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.3933777809143066
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0156442  Vali Loss: 0.0350588 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.3965959548950195
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0170428  Vali Loss: 0.0345755 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.3963570594787598
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0162989  Vali Loss: 0.0313388 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.033763 --> 0.031339).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.3916473388671875
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0130320  Vali Loss: 0.0350452 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.3923492431640625
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0132574  Vali Loss: 0.0354538 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.3964815139770508
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0128088  Vali Loss: 0.0339184 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.3935859203338623
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0143602  Vali Loss: 0.0368454 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.393291711807251
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0136503  Vali Loss: 0.0318065 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 1.394577980041504
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0129924  Vali Loss: 0.0316520 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.396416187286377
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0143706  Vali Loss: 0.0336629 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.3911268711090088
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0154268  Vali Loss: 0.0303152 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.031339 --> 0.030315).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.3938193321228027
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0109867  Vali Loss: 0.0334627 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.3953168392181396
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0112074  Vali Loss: 0.0352602 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.391331434249878
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0133848  Vali Loss: 0.0286865 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.030315 --> 0.028687).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 1.3928823471069336
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0130732  Vali Loss: 0.0298013 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.394515037536621
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0109332  Vali Loss: 0.0334638 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 1.3966188430786133
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0132171  Vali Loss: 0.0258394 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.028687 --> 0.025839).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.3923704624176025
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0123696  Vali Loss: 0.0349546 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.3929386138916016
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0134853  Vali Loss: 0.0315309 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858180  Vali macro F1 0.9772998 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.3940412998199463
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0129909  Vali Loss: 0.0299305 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.3943653106689453
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0115603  Vali Loss: 0.0290186 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.3918178081512451
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0092859  Vali Loss: 0.0291512 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 1.3957529067993164
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0117984  Vali Loss: 0.0285265 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.3946621417999268
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0100541  Vali Loss: 0.0269896 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.3929109573364258
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0104610  Vali Loss: 0.0265301 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 1.3943073749542236
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0101077  Vali Loss: 0.0272792 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 1.3956961631774902
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0103495  Vali Loss: 0.0276737 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 1.3929002285003662
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0116382  Vali Loss: 0.0277767 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 1.392674207687378
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0113913  Vali Loss: 0.0278142 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 1.3959267139434814
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0090073  Vali Loss: 0.0278697 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 1.3943960666656494
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0084181  Vali Loss: 0.0279171 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 1.3922216892242432
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0093164  Vali Loss: 0.0279409 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9864074  Test macro F1 0.9838886 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00266667 0.00239234 0.0023753  0.00332226 0.00595238 0.00568182
 0.00320513 0.00302115 0.00234192 0.00390625]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2897214889526367
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2651538  Vali Loss: 2.2082795 Vali Accuracy: 0.1440678  Vali weighted F1: 0.0448751  Vali macro F1 0.0333675 
Validation loss decreased (inf --> 2.208279).  Saving model ...
Epoch: 2 cost time: 1.2891006469726562
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.9868155  Vali Loss: 1.5909347 Vali Accuracy: 0.4802260  Vali weighted F1: 0.4287666  Vali macro F1 0.4130004 
new best score!!!!
Validation loss decreased (2.208279 --> 1.590935).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.291689395904541
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3871444  Vali Loss: 1.0178233 Vali Accuracy: 0.7344633  Vali weighted F1: 0.7170194  Vali macro F1 0.6760856 
new best score!!!!
Validation loss decreased (1.590935 --> 1.017823).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2924740314483643
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9893403  Vali Loss: 0.7262560 Vali Accuracy: 0.7853107  Vali weighted F1: 0.7701018  Vali macro F1 0.7261560 
new best score!!!!
Validation loss decreased (1.017823 --> 0.726256).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.291086196899414
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7288862  Vali Loss: 0.5279499 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8588017  Vali macro F1 0.8151303 
new best score!!!!
Validation loss decreased (0.726256 --> 0.527950).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2903079986572266
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5635990  Vali Loss: 0.4351130 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8405752  Vali macro F1 0.7923779 
new best score!!!!
Validation loss decreased (0.527950 --> 0.435113).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.297534704208374
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4538372  Vali Loss: 0.3413446 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8796552  Vali macro F1 0.8305955 
new best score!!!!
Validation loss decreased (0.435113 --> 0.341345).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.289811372756958
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3886470  Vali Loss: 0.3121592 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8800653  Vali macro F1 0.8407970 
new best score!!!!
Validation loss decreased (0.341345 --> 0.312159).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.290203332901001
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3410238  Vali Loss: 0.2503194 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9173620  Vali macro F1 0.8746478 
new best score!!!!
Validation loss decreased (0.312159 --> 0.250319).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2926485538482666
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2878774  Vali Loss: 0.2333928 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9065156  Vali macro F1 0.8622643 
new best score!!!!
Validation loss decreased (0.250319 --> 0.233393).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2933225631713867
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2520568  Vali Loss: 0.1947924 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9283417  Vali macro F1 0.8826077 
new best score!!!!
Validation loss decreased (0.233393 --> 0.194792).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.28987455368042
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2244767  Vali Loss: 0.1849394 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9419039  Vali macro F1 0.9065366 
new best score!!!!
Validation loss decreased (0.194792 --> 0.184939).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3022937774658203
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2032381  Vali Loss: 0.1570652 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9236010  Vali macro F1 0.8697859 
new best score!!!!
Validation loss decreased (0.184939 --> 0.157065).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2953486442565918
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1846071  Vali Loss: 0.1695707 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9133764  Vali macro F1 0.8583477 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.289402723312378
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1777842  Vali Loss: 0.1668994 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9280653  Vali macro F1 0.8935882 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 1.2890057563781738
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1655300  Vali Loss: 0.1259321 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9460684  Vali macro F1 0.9131341 
new best score!!!!
Validation loss decreased (0.157065 --> 0.125932).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2931814193725586
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1443285  Vali Loss: 0.1365638 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9328529  Vali macro F1 0.8927317 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.2938659191131592
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1307915  Vali Loss: 0.1255057 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9403648  Vali macro F1 0.9086252 
new best score!!!!
Validation loss decreased (0.125932 --> 0.125506).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2929420471191406
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1150359  Vali Loss: 0.1072871 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9506563  Vali macro F1 0.9206111 
new best score!!!!
Validation loss decreased (0.125506 --> 0.107287).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2962372303009033
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1152075  Vali Loss: 0.1276283 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9258318  Vali macro F1 0.8859184 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3015148639678955
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1208266  Vali Loss: 0.1262482 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9339445  Vali macro F1 0.8895972 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.296677589416504
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1076512  Vali Loss: 0.1148757 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9452803  Vali macro F1 0.9131615 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 1.3026342391967773
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0963174  Vali Loss: 0.1127971 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9366806  Vali macro F1 0.9046270 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 1.2968568801879883
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0830086  Vali Loss: 0.0970969 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9516288  Vali macro F1 0.9284352 
new best score!!!!
Validation loss decreased (0.107287 --> 0.097097).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.294135332107544
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0759393  Vali Loss: 0.0844107 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9677866  Vali macro F1 0.9478143 
new best score!!!!
Validation loss decreased (0.097097 --> 0.084411).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2896902561187744
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0661941  Vali Loss: 0.1025192 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9470007  Vali macro F1 0.9144676 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2926068305969238
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0796271  Vali Loss: 0.0970825 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9547824  Vali macro F1 0.9279186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.2974166870117188
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0652327  Vali Loss: 0.0804087 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9738284  Vali macro F1 0.9557971 
new best score!!!!
Validation loss decreased (0.084411 --> 0.080409).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.294736623764038
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0607039  Vali Loss: 0.0612762 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772500  Vali macro F1 0.9664647 
new best score!!!!
Validation loss decreased (0.080409 --> 0.061276).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2907590866088867
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0606204  Vali Loss: 0.0627951 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745942  Vali macro F1 0.9596525 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.2943384647369385
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0621047  Vali Loss: 0.0731639 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681770  Vali macro F1 0.9513283 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.2964699268341064
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0617032  Vali Loss: 0.0952095 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9586312  Vali macro F1 0.9387776 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.2899749279022217
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0415567  Vali Loss: 0.0793809 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9654503  Vali macro F1 0.9515702 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 1.2924659252166748
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0417423  Vali Loss: 0.0597317 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714734  Vali macro F1 0.9598958 
new best score!!!!
Validation loss decreased (0.061276 --> 0.059732).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2937133312225342
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0371247  Vali Loss: 0.0644171 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9740753  Vali macro F1 0.9590936 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2895658016204834
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0319869  Vali Loss: 0.0659358 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9712696  Vali macro F1 0.9568186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.2927699089050293
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0333754  Vali Loss: 0.0510779 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
new best score!!!!
Validation loss decreased (0.059732 --> 0.051078).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2944724559783936
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0324442  Vali Loss: 0.0582681 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801318  Vali macro F1 0.9703321 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.298872470855713
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0365797  Vali Loss: 0.0517048 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830232  Vali macro F1 0.9768190 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.2901833057403564
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0257952  Vali Loss: 0.0426224 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858709  Vali macro F1 0.9842009 
new best score!!!!
Validation loss decreased (0.051078 --> 0.042622).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2949178218841553
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0218319  Vali Loss: 0.0504575 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744135  Vali macro F1 0.9641666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.2964718341827393
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0251130  Vali Loss: 0.0625930 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829511  Vali macro F1 0.9764223 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3093202114105225
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0202804  Vali Loss: 0.0546106 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802543  Vali macro F1 0.9770757 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.2950971126556396
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0199933  Vali Loss: 0.0427379 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801695  Vali macro F1 0.9722002 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.2995719909667969
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0212323  Vali Loss: 0.0372375 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886969  Vali macro F1 0.9864870 
new best score!!!!
Validation loss decreased (0.042622 --> 0.037237).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2986836433410645
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0200625  Vali Loss: 0.0754952 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770447  Vali macro F1 0.9660211 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2932331562042236
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0189984  Vali Loss: 0.0570413 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828705  Vali macro F1 0.9741955 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.2929284572601318
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0167778  Vali Loss: 0.0499897 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9856967  Vali macro F1 0.9766990 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.2944457530975342
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0203335  Vali Loss: 0.0649537 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829511  Vali macro F1 0.9764223 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.291151762008667
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0159373  Vali Loss: 0.0645869 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 51 cost time: 1.2907326221466064
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0151731  Vali Loss: 0.0572679 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.2946429252624512
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0118878  Vali Loss: 0.0461517 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858497  Vali macro F1 0.9791055 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.2936267852783203
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0110017  Vali Loss: 0.0465101 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.2904565334320068
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0113494  Vali Loss: 0.0510737 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.2922558784484863
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0112871  Vali Loss: 0.0496317 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 1.2935490608215332
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0105897  Vali Loss: 0.0494367 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2919955253601074
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0101341  Vali Loss: 0.0487096 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.2914555072784424
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0105098  Vali Loss: 0.0479475 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 1.2941887378692627
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0117600  Vali Loss: 0.0465195 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 1.2967534065246582
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0103341  Vali Loss: 0.0465792 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829769  Vali macro F1 0.9740735 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909554  Test macro F1 0.9898598 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3989214897155762
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0162240  Vali Loss: 0.0551919 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
Validation loss decreased (inf --> 0.055192).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3966047763824463
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0189180  Vali Loss: 0.0534564 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858687  Vali macro F1 0.9815681 
new best score!!!!
Validation loss decreased (0.055192 --> 0.053456).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3969039916992188
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0154677  Vali Loss: 0.0454914 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858687  Vali macro F1 0.9815681 
new best score!!!!
Validation loss decreased (0.053456 --> 0.045491).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.3990545272827148
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0128638  Vali Loss: 0.0562393 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.399677038192749
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0130633  Vali Loss: 0.0474826 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830235  Vali macro F1 0.9766020 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.3957493305206299
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0120954  Vali Loss: 0.0520245 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.3966064453125
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0132107  Vali Loss: 0.0453386 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830235  Vali macro F1 0.9766020 
new best score!!!!
Validation loss decreased (0.045491 --> 0.045339).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.3997576236724854
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0119084  Vali Loss: 0.0433843 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858687  Vali macro F1 0.9815681 
new best score!!!!
Validation loss decreased (0.045339 --> 0.043384).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.3962552547454834
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0119378  Vali Loss: 0.0384527 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858687  Vali macro F1 0.9815681 
new best score!!!!
Validation loss decreased (0.043384 --> 0.038453).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.3952109813690186
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0105533  Vali Loss: 0.0528132 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.3980624675750732
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0116574  Vali Loss: 0.0485350 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830235  Vali macro F1 0.9766020 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.3988568782806396
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0105228  Vali Loss: 0.0360481 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886949  Vali macro F1 0.9840716 
new best score!!!!
Validation loss decreased (0.038453 --> 0.036048).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.3953886032104492
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0099961  Vali Loss: 0.0457718 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.3964476585388184
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0120922  Vali Loss: 0.0454242 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829962  Vali macro F1 0.9744868 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.3983180522918701
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0098140  Vali Loss: 0.0446730 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858497  Vali macro F1 0.9791055 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.3965253829956055
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0085613  Vali Loss: 0.0312063 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886949  Vali macro F1 0.9840716 
new best score!!!!
Validation loss decreased (0.036048 --> 0.031206).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.396317720413208
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0099705  Vali Loss: 0.0462321 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829962  Vali macro F1 0.9744868 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.399367332458496
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0098286  Vali Loss: 0.0664146 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772396  Vali macro F1 0.9664527 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.3992598056793213
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0107195  Vali Loss: 0.0491031 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886949  Vali macro F1 0.9840716 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.3973429203033447
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0094983  Vali Loss: 0.0467158 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858687  Vali macro F1 0.9815681 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.3964827060699463
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0084233  Vali Loss: 0.0573065 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772396  Vali macro F1 0.9664527 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 22 cost time: 1.4001648426055908
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0112881  Vali Loss: 0.0270175 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915231  Vali macro F1 0.9889906 
new best score!!!!
Validation loss decreased (0.031206 --> 0.027018).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.3955497741699219
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0119228  Vali Loss: 0.0443680 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858497  Vali macro F1 0.9791055 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.395944356918335
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0087791  Vali Loss: 0.0422243 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886949  Vali macro F1 0.9840716 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.3997423648834229
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0084153  Vali Loss: 0.0534720 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.3981146812438965
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0071959  Vali Loss: 0.0326383 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858497  Vali macro F1 0.9791055 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.3948044776916504
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0080802  Vali Loss: 0.0539177 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801052  Vali macro F1 0.9703211 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 1.396559715270996
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0080005  Vali Loss: 0.0530688 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801052  Vali macro F1 0.9703211 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.3990886211395264
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0097670  Vali Loss: 0.0486714 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830163  Vali macro F1 0.9754383 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.3954322338104248
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0082710  Vali Loss: 0.0452747 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829962  Vali macro F1 0.9744868 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 1.3943150043487549
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0085801  Vali Loss: 0.0439362 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829962  Vali macro F1 0.9744868 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 1.398545503616333
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0076575  Vali Loss: 0.0452966 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 1.398754358291626
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0088201  Vali Loss: 0.0453193 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 1.3950514793395996
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0072249  Vali Loss: 0.0452997 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 1.3963236808776855
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0073848  Vali Loss: 0.0452709 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 1.3979918956756592
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0073327  Vali Loss: 0.0451695 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 1.39469313621521
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0071060  Vali Loss: 0.0452515 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801508  Vali macro F1 0.9715700 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909448  Test macro F1 0.9901321 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00277008 0.00236407 0.00247525 0.00325733 0.00543478 0.00574713
 0.00328947 0.00277008 0.00242131 0.00393701]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3448171615600586
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2641156  Vali Loss: 2.1913393 Vali Accuracy: 0.1553672  Vali weighted F1: 0.0628792  Vali macro F1 0.0463017 
Validation loss decreased (inf --> 2.191339).  Saving model ...
Epoch: 2 cost time: 1.3462305068969727
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.9505749  Vali Loss: 1.5117691 Vali Accuracy: 0.4971751  Vali weighted F1: 0.4611423  Vali macro F1 0.4321689 
new best score!!!!
Validation loss decreased (2.191339 --> 1.511769).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.343611478805542
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3429342  Vali Loss: 0.9737782 Vali Accuracy: 0.7429379  Vali weighted F1: 0.7266104  Vali macro F1 0.6867177 
new best score!!!!
Validation loss decreased (1.511769 --> 0.973778).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3499846458435059
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9358552  Vali Loss: 0.6930049 Vali Accuracy: 0.8022599  Vali weighted F1: 0.7868538  Vali macro F1 0.7433254 
new best score!!!!
Validation loss decreased (0.973778 --> 0.693005).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3439617156982422
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6871051  Vali Loss: 0.5086513 Vali Accuracy: 0.8389831  Vali weighted F1: 0.8176375  Vali macro F1 0.7714768 
new best score!!!!
Validation loss decreased (0.693005 --> 0.508651).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3605728149414062
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5373290  Vali Loss: 0.3935130 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8624227  Vali macro F1 0.8141706 
new best score!!!!
Validation loss decreased (0.508651 --> 0.393513).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3524940013885498
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4413376  Vali Loss: 0.3336179 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9094360  Vali macro F1 0.8824519 
new best score!!!!
Validation loss decreased (0.393513 --> 0.333618).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3500034809112549
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3743785  Vali Loss: 0.2957373 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8898169  Vali macro F1 0.8506979 
new best score!!!!
Validation loss decreased (0.333618 --> 0.295737).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.343360185623169
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3322330  Vali Loss: 0.2638947 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8914220  Vali macro F1 0.8452634 
new best score!!!!
Validation loss decreased (0.295737 --> 0.263895).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3053605556488037
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2986390  Vali Loss: 0.2279655 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9200221  Vali macro F1 0.8827234 
new best score!!!!
Validation loss decreased (0.263895 --> 0.227965).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3244612216949463
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2545953  Vali Loss: 0.2034720 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9078326  Vali macro F1 0.8542452 
new best score!!!!
Validation loss decreased (0.227965 --> 0.203472).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3095712661743164
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2305012  Vali Loss: 0.1914946 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9244080  Vali macro F1 0.8766441 
new best score!!!!
Validation loss decreased (0.203472 --> 0.191495).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2961573600769043
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2085421  Vali Loss: 0.1632155 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9407534  Vali macro F1 0.9027362 
new best score!!!!
Validation loss decreased (0.191495 --> 0.163216).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.300400733947754
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1905040  Vali Loss: 0.1494465 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9375296  Vali macro F1 0.8993117 
new best score!!!!
Validation loss decreased (0.163216 --> 0.149446).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2953338623046875
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1686747  Vali Loss: 0.1416438 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9348466  Vali macro F1 0.8992281 
new best score!!!!
Validation loss decreased (0.149446 --> 0.141644).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.293931007385254
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1567033  Vali Loss: 0.1324485 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9477578  Vali macro F1 0.9176209 
new best score!!!!
Validation loss decreased (0.141644 --> 0.132449).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2945804595947266
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1395447  Vali Loss: 0.1285812 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9330903  Vali macro F1 0.8908022 
new best score!!!!
Validation loss decreased (0.132449 --> 0.128581).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2961711883544922
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1384220  Vali Loss: 0.1087574 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9554111  Vali macro F1 0.9232073 
new best score!!!!
Validation loss decreased (0.128581 --> 0.108757).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2924871444702148
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1208597  Vali Loss: 0.1069575 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9504158  Vali macro F1 0.9140877 
new best score!!!!
Validation loss decreased (0.108757 --> 0.106957).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2916922569274902
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1167661  Vali Loss: 0.1199950 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9434157  Vali macro F1 0.9145359 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.2963452339172363
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1063546  Vali Loss: 0.1048473 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9506170  Vali macro F1 0.9197744 
new best score!!!!
Validation loss decreased (0.106957 --> 0.104847).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2956209182739258
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0994415  Vali Loss: 0.0949136 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660922  Vali macro F1 0.9457077 
new best score!!!!
Validation loss decreased (0.104847 --> 0.094914).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.291860818862915
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0900239  Vali Loss: 0.0981454 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9569483  Vali macro F1 0.9275290 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.2911899089813232
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0864808  Vali Loss: 0.0767985 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9711222  Vali macro F1 0.9522320 
new best score!!!!
Validation loss decreased (0.094914 --> 0.076799).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2941532135009766
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0822215  Vali Loss: 0.0789169 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661014  Vali macro F1 0.9442136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.2930419445037842
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0731395  Vali Loss: 0.0888534 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9652829  Vali macro F1 0.9405797 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 1.291881799697876
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0684607  Vali Loss: 0.0878301 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9610908  Vali macro F1 0.9368994 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 1.2940528392791748
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0602900  Vali Loss: 0.0739695 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689599  Vali macro F1 0.9490626 
new best score!!!!
Validation loss decreased (0.076799 --> 0.073970).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2945849895477295
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0578203  Vali Loss: 0.0632053 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771351  Vali macro F1 0.9642926 
new best score!!!!
Validation loss decreased (0.073970 --> 0.063205).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2981584072113037
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0534587  Vali Loss: 0.0575008 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828960  Vali macro F1 0.9729481 
new best score!!!!
Validation loss decreased (0.063205 --> 0.057501).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2972376346588135
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0566940  Vali Loss: 0.0553378 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828960  Vali macro F1 0.9729481 
new best score!!!!
Validation loss decreased (0.057501 --> 0.055338).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2970671653747559
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0513165  Vali Loss: 0.0605492 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830583  Vali macro F1 0.9751709 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.2931098937988281
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0547563  Vali Loss: 0.0669410 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9766384  Vali macro F1 0.9590000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.2961807250976562
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0433708  Vali Loss: 0.0473412 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9827601  Vali macro F1 0.9698529 
new best score!!!!
Validation loss decreased (0.055338 --> 0.047341).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2975695133209229
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0379239  Vali Loss: 0.0793967 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9709813  Vali macro F1 0.9535986 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2951560020446777
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0367171  Vali Loss: 0.0379901 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886880  Vali macro F1 0.9821412 
new best score!!!!
Validation loss decreased (0.047341 --> 0.037990).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.298025131225586
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0334476  Vali Loss: 0.0522100 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830434  Vali macro F1 0.9754315 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3150157928466797
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0340347  Vali Loss: 0.0653325 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9738241  Vali macro F1 0.9561065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.298705816268921
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0288623  Vali Loss: 0.0803055 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9769117  Vali macro F1 0.9623743 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.2931804656982422
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0296529  Vali Loss: 0.0353525 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887140  Vali macro F1 0.9804762 
new best score!!!!
Validation loss decreased (0.037990 --> 0.035352).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2941720485687256
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0217519  Vali Loss: 0.0474543 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829068  Vali macro F1 0.9721825 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.300809621810913
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0240819  Vali Loss: 0.0573508 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829068  Vali macro F1 0.9721825 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.2950096130371094
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0234417  Vali Loss: 0.0588064 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828960  Vali macro F1 0.9729481 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.2925610542297363
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0340108  Vali Loss: 0.0680802 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743698  Vali macro F1 0.9632848 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.2943198680877686
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0536290  Vali Loss: 0.0577085 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801831  Vali macro F1 0.9684271 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 1.298346757888794
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0285503  Vali Loss: 0.0316375 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.035352 --> 0.031637).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.2957422733306885
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0189848  Vali Loss: 0.0397856 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.2917094230651855
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0188989  Vali Loss: 0.0409264 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.2943305969238281
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0182470  Vali Loss: 0.0408166 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.2945873737335205
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0167780  Vali Loss: 0.0408083 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.2940502166748047
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0155060  Vali Loss: 0.0315502 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.031637 --> 0.031550).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2923133373260498
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0166074  Vali Loss: 0.0314458 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.031550 --> 0.031446).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2996349334716797
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0139372  Vali Loss: 0.0372866 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2926819324493408
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0163717  Vali Loss: 0.0342824 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.2934544086456299
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0179831  Vali Loss: 0.0376477 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.2951600551605225
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0139622  Vali Loss: 0.0411196 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.2942478656768799
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0141951  Vali Loss: 0.0399668 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 58 cost time: 1.2926671504974365
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0133096  Vali Loss: 0.0401074 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.2913508415222168
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0140367  Vali Loss: 0.0397848 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.2949492931365967
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0142490  Vali Loss: 0.0400052 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.291337251663208
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0131587  Vali Loss: 0.0398147 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.2912297248840332
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0146859  Vali Loss: 0.0403341 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 63 cost time: 1.29736328125
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0151014  Vali Loss: 0.0403701 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.295652151107788
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0134663  Vali Loss: 0.0404177 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.2912418842315674
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0136729  Vali Loss: 0.0404573 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.2880470752716064
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0143378  Vali Loss: 0.0404825 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.2926340103149414
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0141668  Vali Loss: 0.0404587 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9954751  Test weighted F1: 0.9954795  Test macro F1 0.9936473 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3903932571411133
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0169649  Vali Loss: 0.0520249 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858345  Vali macro F1 0.9801805 
Validation loss decreased (inf --> 0.052025).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3872966766357422
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0141120  Vali Loss: 0.0406931 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
new best score!!!!
Validation loss decreased (0.052025 --> 0.040693).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.3830523490905762
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0136325  Vali Loss: 0.0434865 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.3840017318725586
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0149637  Vali Loss: 0.0437513 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.3858420848846436
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0143024  Vali Loss: 0.0471633 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858345  Vali macro F1 0.9801805 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.3839068412780762
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0131570  Vali Loss: 0.0477314 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.3825979232788086
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0141116  Vali Loss: 0.0445692 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858345  Vali macro F1 0.9801805 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.386833667755127
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0122343  Vali Loss: 0.0466441 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858345  Vali macro F1 0.9801805 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.3859260082244873
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0131609  Vali Loss: 0.0654447 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858345  Vali macro F1 0.9801805 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.3829128742218018
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0130892  Vali Loss: 0.0461638 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858345  Vali macro F1 0.9801805 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.3826987743377686
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0128603  Vali Loss: 0.0470800 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.3861799240112305
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0111655  Vali Loss: 0.0388687 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.040693 --> 0.038869).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.3813858032226562
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0101901  Vali Loss: 0.0524473 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.3823885917663574
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0129152  Vali Loss: 0.0344117 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858345  Vali macro F1 0.9801805 
new best score!!!!
Validation loss decreased (0.038869 --> 0.034412).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.3853437900543213
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0110923  Vali Loss: 0.0391798 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858345  Vali macro F1 0.9801805 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.3846027851104736
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0105667  Vali Loss: 0.0433243 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.381904125213623
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0101706  Vali Loss: 0.0366561 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858650  Vali macro F1 0.9802862 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.3815627098083496
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0103121  Vali Loss: 0.0426664 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 1.3851773738861084
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0088933  Vali Loss: 0.0497341 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 1.3832082748413086
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0109229  Vali Loss: 0.0488757 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.3830153942108154
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0110058  Vali Loss: 0.0491493 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 1.3845651149749756
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0084191  Vali Loss: 0.0489195 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 1.385371208190918
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0086162  Vali Loss: 0.0493928 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 1.3815832138061523
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0093397  Vali Loss: 0.0498407 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 1.3835084438323975
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0091759  Vali Loss: 0.0496980 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 1.3863754272460938
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0091409  Vali Loss: 0.0494719 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 1.3822193145751953
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0083996  Vali Loss: 0.0493011 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 1.382258653640747
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0096229  Vali Loss: 0.0489500 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 1.3861160278320312
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0101339  Vali Loss: 0.0486747 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886799  Vali macro F1 0.9830973 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9966063  Test weighted F1: 0.9966104  Test macro F1 0.9958939 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00271003 0.0023753  0.00240964 0.00321543 0.00543478 0.00591716
 0.00318471 0.00295858 0.00248756 0.00381679]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.310582160949707
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2661574  Vali Loss: 2.1898889 Vali Accuracy: 0.1384181  Vali weighted F1: 0.0671510  Vali macro F1 0.0508138 
Validation loss decreased (inf --> 2.189889).  Saving model ...
Epoch: 2 cost time: 1.293738603591919
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.9661181  Vali Loss: 1.5508293 Vali Accuracy: 0.4830508  Vali weighted F1: 0.4693964  Vali macro F1 0.4518455 
new best score!!!!
Validation loss decreased (2.189889 --> 1.550829).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2925214767456055
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3682446  Vali Loss: 1.0047501 Vali Accuracy: 0.7259887  Vali weighted F1: 0.7118366  Vali macro F1 0.6720108 
new best score!!!!
Validation loss decreased (1.550829 --> 1.004750).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2879042625427246
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.9801309  Vali Loss: 0.7474581 Vali Accuracy: 0.7570621  Vali weighted F1: 0.7583742  Vali macro F1 0.7203218 
new best score!!!!
Validation loss decreased (1.004750 --> 0.747458).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2934579849243164
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.7210426  Vali Loss: 0.5093071 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8335290  Vali macro F1 0.7864866 
new best score!!!!
Validation loss decreased (0.747458 --> 0.509307).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.290928602218628
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5465343  Vali Loss: 0.4322248 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8526092  Vali macro F1 0.8069839 
new best score!!!!
Validation loss decreased (0.509307 --> 0.432225).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2873451709747314
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4579416  Vali Loss: 0.3547745 Vali Accuracy: 0.9011299  Vali weighted F1: 0.9019069  Vali macro F1 0.8759902 
new best score!!!!
Validation loss decreased (0.432225 --> 0.354774).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.287764072418213
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3817679  Vali Loss: 0.2999001 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8729125  Vali macro F1 0.8239299 
new best score!!!!
Validation loss decreased (0.354774 --> 0.299900).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.289867877960205
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3400338  Vali Loss: 0.2684154 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8881642  Vali macro F1 0.8389511 
new best score!!!!
Validation loss decreased (0.299900 --> 0.268415).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2869415283203125
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2891506  Vali Loss: 0.2280415 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9112223  Vali macro F1 0.8718231 
new best score!!!!
Validation loss decreased (0.268415 --> 0.228041).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.289273738861084
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2585006  Vali Loss: 0.2132722 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9077422  Vali macro F1 0.8511950 
new best score!!!!
Validation loss decreased (0.228041 --> 0.213272).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2916533946990967
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2249954  Vali Loss: 0.1859022 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9350350  Vali macro F1 0.9015619 
new best score!!!!
Validation loss decreased (0.213272 --> 0.185902).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2900011539459229
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.2109966  Vali Loss: 0.1898699 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9226448  Vali macro F1 0.8784861 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.2860276699066162
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1918411  Vali Loss: 0.1527981 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9491391  Vali macro F1 0.9218041 
new best score!!!!
Validation loss decreased (0.185902 --> 0.152798).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2880733013153076
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1699455  Vali Loss: 0.1570793 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9405013  Vali macro F1 0.9097421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.2905082702636719
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1605198  Vali Loss: 0.1354966 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9373375  Vali macro F1 0.9022285 
new best score!!!!
Validation loss decreased (0.152798 --> 0.135497).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.287278413772583
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1435358  Vali Loss: 0.1337383 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9465436  Vali macro F1 0.9181413 
new best score!!!!
Validation loss decreased (0.135497 --> 0.133738).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2853593826293945
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1383419  Vali Loss: 0.1250896 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9191070  Vali macro F1 0.8621650 
new best score!!!!
Validation loss decreased (0.133738 --> 0.125090).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2887423038482666
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1315106  Vali Loss: 0.1473328 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9222096  Vali macro F1 0.8765725 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.2897021770477295
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1408943  Vali Loss: 0.1255642 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9341600  Vali macro F1 0.8957360 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.2879505157470703
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1212537  Vali Loss: 0.1146659 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9385193  Vali macro F1 0.8984517 
new best score!!!!
Validation loss decreased (0.125090 --> 0.114666).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2906367778778076
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1088753  Vali Loss: 0.1022404 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9501072  Vali macro F1 0.9176463 
new best score!!!!
Validation loss decreased (0.114666 --> 0.102240).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.292090654373169
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1034387  Vali Loss: 0.1063699 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9346403  Vali macro F1 0.8934703 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.2896020412445068
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0974900  Vali Loss: 0.1019443 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9499189  Vali macro F1 0.9165990 
new best score!!!!
Validation loss decreased (0.102240 --> 0.101944).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2881784439086914
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1012411  Vali Loss: 0.1127943 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9335875  Vali macro F1 0.8866239 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.2932398319244385
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0967841  Vali Loss: 0.1000311 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9480463  Vali macro F1 0.9129739 
new best score!!!!
Validation loss decreased (0.101944 --> 0.100031).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2904558181762695
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0803707  Vali Loss: 0.0886242 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9613665  Vali macro F1 0.9346430 
new best score!!!!
Validation loss decreased (0.100031 --> 0.088624).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2905006408691406
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0705202  Vali Loss: 0.0834478 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9603771  Vali macro F1 0.9368737 
new best score!!!!
Validation loss decreased (0.088624 --> 0.083448).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2894415855407715
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0729810  Vali Loss: 0.0763741 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632787  Vali macro F1 0.9388682 
new best score!!!!
Validation loss decreased (0.083448 --> 0.076374).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2918920516967773
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0762673  Vali Loss: 0.1107541 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9508671  Vali macro F1 0.9152486 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.2894177436828613
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0697468  Vali Loss: 0.0798491 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9608617  Vali macro F1 0.9381283 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.2879419326782227
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0568709  Vali Loss: 0.0624129 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773046  Vali macro F1 0.9657350 
new best score!!!!
Validation loss decreased (0.076374 --> 0.062413).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2912535667419434
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0545292  Vali Loss: 0.0685619 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9664712  Vali macro F1 0.9483943 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.2912652492523193
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0677369  Vali Loss: 0.0623519 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744272  Vali macro F1 0.9627940 
new best score!!!!
Validation loss decreased (0.062413 --> 0.062352).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3073549270629883
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0496843  Vali Loss: 0.0720113 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9704825  Vali macro F1 0.9533939 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2908673286437988
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0451079  Vali Loss: 0.0715248 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9709700  Vali macro F1 0.9538031 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.2955071926116943
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0412373  Vali Loss: 0.0423805 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
new best score!!!!
Validation loss decreased (0.062352 --> 0.042381).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2917017936706543
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0345498  Vali Loss: 0.0481278 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9827601  Vali macro F1 0.9698529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.2907657623291016
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0364477  Vali Loss: 0.0406637 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
new best score!!!!
Validation loss decreased (0.042381 --> 0.040664).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.292717695236206
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0343125  Vali Loss: 0.0477622 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829485  Vali macro F1 0.9702899 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.292557716369629
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0297592  Vali Loss: 0.0460701 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829041  Vali macro F1 0.9719920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.2914409637451172
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0459474  Vali Loss: 0.1391664 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9498477  Vali macro F1 0.9168900 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.2902119159698486
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0573838  Vali Loss: 0.0513505 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773983  Vali macro F1 0.9662271 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 1.292992353439331
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0376114  Vali Loss: 0.0388533 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915355  Vali macro F1 0.9853309 
new best score!!!!
Validation loss decreased (0.040664 --> 0.038853).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2899038791656494
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0355560  Vali Loss: 0.0345673 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914991  Vali macro F1 0.9870126 
new best score!!!!
Validation loss decreased (0.038853 --> 0.034567).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2892160415649414
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0300610  Vali Loss: 0.0380647 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2918660640716553
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0282174  Vali Loss: 0.0312466 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.034567 --> 0.031247).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2939348220825195
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0246595  Vali Loss: 0.0249384 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943570  Vali macro F1 0.9902381 
new best score!!!!
Validation loss decreased (0.031247 --> 0.024938).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2888033390045166
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0267315  Vali Loss: 0.0348526 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887140  Vali macro F1 0.9804762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.288987398147583
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0386080  Vali Loss: 0.0517067 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802330  Vali macro F1 0.9744465 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.2915973663330078
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0315998  Vali Loss: 0.0296953 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.289931058883667
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0267681  Vali Loss: 0.0229597 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.024938 --> 0.022960).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2892673015594482
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0200091  Vali Loss: 0.0239221 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915279  Vali macro F1 0.9879556 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2918002605438232
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0186551  Vali Loss: 0.0383806 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.298743724822998
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0189299  Vali Loss: 0.0239870 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943540  Vali macro F1 0.9921816 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.2904269695281982
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0166792  Vali Loss: 0.0332592 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.291555404663086
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0174327  Vali Loss: 0.0222739 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
new best score!!!!
Validation loss decreased (0.022960 --> 0.022274).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.2948884963989258
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0152516  Vali Loss: 0.0370157 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.2917320728302002
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0227890  Vali Loss: 0.0472262 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830873  Vali macro F1 0.9773021 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.2950248718261719
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0230006  Vali Loss: 0.0469121 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801582  Vali macro F1 0.9730429 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.2953712940216064
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0233282  Vali Loss: 0.0326705 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831038  Vali macro F1 0.9747308 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.2939932346343994
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0168025  Vali Loss: 0.0420712 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858099  Vali macro F1 0.9779575 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 63 cost time: 1.291313648223877
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0127847  Vali Loss: 0.0299263 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886827  Vali macro F1 0.9829895 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.2924604415893555
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0114424  Vali Loss: 0.0224300 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.315561056137085
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0135921  Vali Loss: 0.0239738 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.2907018661499023
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0099805  Vali Loss: 0.0228651 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.2913517951965332
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0099515  Vali Loss: 0.0208871 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.022274 --> 0.020887).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.2945771217346191
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0100645  Vali Loss: 0.0203544 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.020887 --> 0.020354).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 1.294954776763916
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0078761  Vali Loss: 0.0210925 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 1.2906994819641113
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0092515  Vali Loss: 0.0221684 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 1.2904839515686035
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0099203  Vali Loss: 0.0246510 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 1.2931575775146484
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0092224  Vali Loss: 0.0180850 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.020354 --> 0.018085).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 1.2901415824890137
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0084440  Vali Loss: 0.0176249 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.018085 --> 0.017625).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 1.2908685207366943
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0087909  Vali Loss: 0.0171285 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.017625 --> 0.017128).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 1.2946577072143555
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0082752  Vali Loss: 0.0171116 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.017128 --> 0.017112).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 1.2943134307861328
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0081704  Vali Loss: 0.0211738 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 1.289003610610962
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0078485  Vali Loss: 0.0241224 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 1.2897398471832275
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0084961  Vali Loss: 0.0177037 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 1.296567440032959
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0068074  Vali Loss: 0.0190956 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 1.290125846862793
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0074703  Vali Loss: 0.0201173 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 81 cost time: 1.2889809608459473
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0077945  Vali Loss: 0.0206487 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 82 cost time: 1.2952947616577148
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0076607  Vali Loss: 0.0212244 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 83 cost time: 1.2938029766082764
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0074979  Vali Loss: 0.0205798 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 84 cost time: 1.2917087078094482
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0071972  Vali Loss: 0.0198223 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 85 cost time: 1.2901902198791504
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0088126  Vali Loss: 0.0189713 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 86 cost time: 1.293710470199585
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0067469  Vali Loss: 0.0189588 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 87 cost time: 1.2909972667694092
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0067899  Vali Loss: 0.0189347 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 88 cost time: 1.291240930557251
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0072238  Vali Loss: 0.0189469 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 89 cost time: 1.2941455841064453
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0061894  Vali Loss: 0.0189479 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 90 cost time: 1.2997701168060303
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0074170  Vali Loss: 0.0189467 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943460  Test macro F1 0.9930801 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.4069786071777344
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0069972  Vali Loss: 0.0277920 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
Validation loss decreased (inf --> 0.027792).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.4031898975372314
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0091083  Vali Loss: 0.0374758 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.4041328430175781
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0082327  Vali Loss: 0.0239419 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.027792 --> 0.023942).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.4078130722045898
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0114320  Vali Loss: 0.0379028 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.407026767730713
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0061459  Vali Loss: 0.0179692 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.023942 --> 0.017969).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.4095919132232666
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0071500  Vali Loss: 0.0350229 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.4037573337554932
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0068256  Vali Loss: 0.0305446 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.4080142974853516
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0078672  Vali Loss: 0.0274899 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.4035086631774902
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0062710  Vali Loss: 0.0287174 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.4029321670532227
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0071212  Vali Loss: 0.0311424 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.4079208374023438
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0071664  Vali Loss: 0.0309769 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.4070730209350586
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0053027  Vali Loss: 0.0170436 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.017969 --> 0.017044).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.4056997299194336
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0049623  Vali Loss: 0.0387840 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.4042019844055176
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0053783  Vali Loss: 0.0368535 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.4074969291687012
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0060171  Vali Loss: 0.0297303 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.4053573608398438
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0056737  Vali Loss: 0.0261080 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.404317855834961
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0043662  Vali Loss: 0.0379930 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 1.4081008434295654
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0053478  Vali Loss: 0.0356433 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.4074971675872803
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0047861  Vali Loss: 0.0328529 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.4056532382965088
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0042056  Vali Loss: 0.0309563 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.403904676437378
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0056239  Vali Loss: 0.0281901 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.4083967208862305
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0058401  Vali Loss: 0.0289028 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 1.4045770168304443
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0053863  Vali Loss: 0.0292263 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.4044039249420166
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0058227  Vali Loss: 0.0292148 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.4083313941955566
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0044929  Vali Loss: 0.0290725 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.409060001373291
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0057275  Vali Loss: 0.0288768 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.405048131942749
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0068548  Vali Loss: 0.0291605 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943460  Test macro F1 0.9930801 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00280112 0.00238095 0.00246914 0.00320513 0.00543478 0.00588235
 0.00315457 0.00289017 0.00235849 0.00404858]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2910332679748535
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2564024  Vali Loss: 2.1271748 Vali Accuracy: 0.1638418  Vali weighted F1: 0.0539347  Vali macro F1 0.0351334 
Validation loss decreased (inf --> 2.127175).  Saving model ...
Epoch: 2 cost time: 1.2934677600860596
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.9251971  Vali Loss: 1.5313473 Vali Accuracy: 0.5480226  Vali weighted F1: 0.5235557  Vali macro F1 0.5145924 
new best score!!!!
Validation loss decreased (2.127175 --> 1.531347).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2939891815185547
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.3201717  Vali Loss: 1.0307196 Vali Accuracy: 0.6694915  Vali weighted F1: 0.6630640  Vali macro F1 0.6395984 
new best score!!!!
Validation loss decreased (1.531347 --> 1.030720).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2924981117248535
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.8994111  Vali Loss: 0.7231336 Vali Accuracy: 0.7824859  Vali weighted F1: 0.7717457  Vali macro F1 0.7386153 
new best score!!!!
Validation loss decreased (1.030720 --> 0.723134).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2899093627929688
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.6535914  Vali Loss: 0.5297372 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8299612  Vali macro F1 0.8012400 
new best score!!!!
Validation loss decreased (0.723134 --> 0.529737).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3026864528656006
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.5122843  Vali Loss: 0.4539289 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8149632  Vali macro F1 0.7776625 
new best score!!!!
Validation loss decreased (0.529737 --> 0.453929).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2952337265014648
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.4253879  Vali Loss: 0.3781530 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8755768  Vali macro F1 0.8498899 
new best score!!!!
Validation loss decreased (0.453929 --> 0.378153).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.288560390472412
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.3631641  Vali Loss: 0.2984078 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9025570  Vali macro F1 0.8830827 
new best score!!!!
Validation loss decreased (0.378153 --> 0.298408).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2889196872711182
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.3169798  Vali Loss: 0.2680913 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8558126  Vali macro F1 0.8070377 
new best score!!!!
Validation loss decreased (0.298408 --> 0.268091).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2911262512207031
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.2698399  Vali Loss: 0.2445183 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9061394  Vali macro F1 0.8558651 
new best score!!!!
Validation loss decreased (0.268091 --> 0.244518).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2929580211639404
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.2428109  Vali Loss: 0.2084873 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9343686  Vali macro F1 0.9100828 
new best score!!!!
Validation loss decreased (0.244518 --> 0.208487).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2878270149230957
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.2173303  Vali Loss: 0.1763256 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9155336  Vali macro F1 0.8739389 
new best score!!!!
Validation loss decreased (0.208487 --> 0.176326).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.290292501449585
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1949463  Vali Loss: 0.1618154 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9577342  Vali macro F1 0.9355791 
new best score!!!!
Validation loss decreased (0.176326 --> 0.161815).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2950055599212646
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1677286  Vali Loss: 0.1352411 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9647753  Vali macro F1 0.9449555 
new best score!!!!
Validation loss decreased (0.161815 --> 0.135241).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2899324893951416
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1568164  Vali Loss: 0.1641575 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9462356  Vali macro F1 0.9203519 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.2861859798431396
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1607757  Vali Loss: 0.1479156 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9528503  Vali macro F1 0.9344422 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 1.289973258972168
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1446097  Vali Loss: 0.1193312 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9738640  Vali macro F1 0.9610411 
new best score!!!!
Validation loss decreased (0.135241 --> 0.119331).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.29178786277771
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1378004  Vali Loss: 0.1168549 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684609  Vali macro F1 0.9513128 
new best score!!!!
Validation loss decreased (0.119331 --> 0.116855).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2871692180633545
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.1340905  Vali Loss: 0.1045560 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9678640  Vali macro F1 0.9530267 
new best score!!!!
Validation loss decreased (0.116855 --> 0.104556).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2880401611328125
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1245350  Vali Loss: 0.1210970 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9486024  Vali macro F1 0.9137219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.2928071022033691
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.1196095  Vali Loss: 0.1011340 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9738959  Vali macro F1 0.9615146 
new best score!!!!
Validation loss decreased (0.104556 --> 0.101134).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2909140586853027
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.1152318  Vali Loss: 0.0853079 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830792  Vali macro F1 0.9756443 
new best score!!!!
Validation loss decreased (0.101134 --> 0.085308).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2918686866760254
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0983207  Vali Loss: 0.0769123 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830508  Vali macro F1 0.9756944 
new best score!!!!
Validation loss decreased (0.085308 --> 0.076912).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2908835411071777
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0978811  Vali Loss: 0.0899296 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9707178  Vali macro F1 0.9557696 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.2925620079040527
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0917350  Vali Loss: 0.1032134 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9710974  Vali macro F1 0.9588046 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.28932785987854
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0880570  Vali Loss: 0.0845138 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9741013  Vali macro F1 0.9562719 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 1.291142463684082
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0898220  Vali Loss: 0.0760492 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830087  Vali macro F1 0.9805913 
new best score!!!!
Validation loss decreased (0.076912 --> 0.076049).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.296691656112671
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0883959  Vali Loss: 0.0815648 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9710383  Vali macro F1 0.9593353 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.2911224365234375
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0721194  Vali Loss: 0.0775533 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9799813  Vali macro F1 0.9722173 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.2903025150299072
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0603593  Vali Loss: 0.0620032 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858695  Vali macro F1 0.9828567 
new best score!!!!
Validation loss decreased (0.076049 --> 0.062003).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2958807945251465
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0557994  Vali Loss: 0.0923029 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713009  Vali macro F1 0.9619512 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.295154094696045
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0564797  Vali Loss: 0.0626282 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858950  Vali macro F1 0.9829544 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.291100263595581
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0512420  Vali Loss: 0.0515055 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771387  Vali macro F1 0.9701867 
new best score!!!!
Validation loss decreased (0.062003 --> 0.051506).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2954258918762207
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0436605  Vali Loss: 0.0604022 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887018  Vali macro F1 0.9886047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2959682941436768
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0487752  Vali Loss: 0.0439580 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9900835 
new best score!!!!
Validation loss decreased (0.051506 --> 0.043958).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.294921636581421
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0548850  Vali Loss: 0.0336878 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971662  Vali macro F1 0.9949206 
new best score!!!!
Validation loss decreased (0.043958 --> 0.033688).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2908711433410645
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0429820  Vali Loss: 0.0340072 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3099720478057861
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0475427  Vali Loss: 0.0424520 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858527  Vali macro F1 0.9853172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.296586275100708
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0392965  Vali Loss: 0.0256473 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886687  Vali macro F1 0.9880021 
new best score!!!!
Validation loss decreased (0.033688 --> 0.025647).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.292675495147705
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0336526  Vali Loss: 0.0273180 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9855934 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.2913997173309326
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0314088  Vali Loss: 0.0304015 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.2959375381469727
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0438379  Vali Loss: 0.0466973 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858095  Vali macro F1 0.9828512 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.2906756401062012
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0330130  Vali Loss: 0.0372254 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914936  Vali macro F1 0.9901556 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 1.2891404628753662
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0266461  Vali Loss: 0.0325340 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 45 cost time: 1.2947559356689453
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0232236  Vali Loss: 0.0283675 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2930853366851807
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0225891  Vali Loss: 0.0271135 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.2935190200805664
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0199865  Vali Loss: 0.0280524 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.2905449867248535
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0182913  Vali Loss: 0.0281285 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 1.296311855316162
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0167835  Vali Loss: 0.0269529 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 1.2908339500427246
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0185572  Vali Loss: 0.0267903 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.2919847965240479
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0194058  Vali Loss: 0.0268620 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.2934892177581787
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0178102  Vali Loss: 0.0268568 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.2940618991851807
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0189554  Vali Loss: 0.0268881 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 1.2906410694122314
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0202977  Vali Loss: 0.0269799 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886830  Vali macro F1 0.9880531 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9853439  Test weighted F1: 0.9853287  Test macro F1 0.9795343 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 285395
pruned model Parameter : 288594
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.3879005908966064
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0319920  Vali Loss: 0.0256165 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858670  Vali macro F1 0.9830564 
Validation loss decreased (inf --> 0.025616).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.3860020637512207
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0291651  Vali Loss: 0.0268707 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915026  Vali macro F1 0.9930814 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.3892543315887451
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0245349  Vali Loss: 0.0266704 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.388779878616333
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0229349  Vali Loss: 0.0264249 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.3866918087005615
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0232925  Vali Loss: 0.0277104 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.3862276077270508
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0210778  Vali Loss: 0.0261607 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.3887686729431152
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0238280  Vali Loss: 0.0257229 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.386352300643921
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0210119  Vali Loss: 0.0262046 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.3863825798034668
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0221030  Vali Loss: 0.0256312 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.388155221939087
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0214396  Vali Loss: 0.0255159 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
new best score!!!!
Validation loss decreased (0.025616 --> 0.025516).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.388577938079834
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0230659  Vali Loss: 0.0226636 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
new best score!!!!
Validation loss decreased (0.025516 --> 0.022664).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.3852112293243408
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0206207  Vali Loss: 0.0223008 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
new best score!!!!
Validation loss decreased (0.022664 --> 0.022301).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.386540174484253
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0216815  Vali Loss: 0.0228654 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.3886377811431885
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0232830  Vali Loss: 0.0218895 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
new best score!!!!
Validation loss decreased (0.022301 --> 0.021889).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.3858118057250977
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0204383  Vali Loss: 0.0205753 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
new best score!!!!
Validation loss decreased (0.021889 --> 0.020575).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.3871502876281738
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0186499  Vali Loss: 0.0212230 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.3922441005706787
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0199691  Vali Loss: 0.0219267 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.38777756690979
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0195741  Vali Loss: 0.0218310 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.3860399723052979
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0170295  Vali Loss: 0.0236419 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915165  Vali macro F1 0.9906151 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.3860280513763428
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0236753  Vali Loss: 0.0224749 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 1.3901762962341309
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0173738  Vali Loss: 0.0223172 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.3877105712890625
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0180806  Vali Loss: 0.0222164 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.3877317905426025
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0167700  Vali Loss: 0.0221920 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.3913915157318115
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0177982  Vali Loss: 0.0219467 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.3904013633728027
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0147411  Vali Loss: 0.0216203 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 1.387890100479126
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0161889  Vali Loss: 0.0216204 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.3869106769561768
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0175227  Vali Loss: 0.0216285 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.3904860019683838
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0137199  Vali Loss: 0.0216194 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.3876001834869385
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0160747  Vali Loss: 0.0216167 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.3879327774047852
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0171335  Vali Loss: 0.0216239 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9956944 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9875986  Test weighted F1: 0.9875853  Test macro F1 0.9812822 

============================= JOB FEEDBACK =============================

NodeName=uc2n564
Job ID: 20948451
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 01:00:22
CPU Efficiency: 4.83% of 20:49:40 core-walltime
Job Wall-clock time: 01:02:29
Memory Utilized: 4.82 GB
Memory Efficiency: 0.00% of 0.00 MB
