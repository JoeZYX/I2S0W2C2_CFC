Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 138143
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0001465  0.000181   0.00097182 0.00123001 0.0004852  0.00060716]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 8.492532968521118
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1112683  Vali Loss: 0.6686949 Vali Accuracy: 0.7833082  Vali weighted F1: 0.7436427  Vali macro F1 0.6269598 
Validation loss decreased (inf --> 0.668695).  Saving model ...
Epoch: 2 cost time: 6.257575511932373
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5320709  Vali Loss: 0.4471287 Vali Accuracy: 0.8476621  Vali weighted F1: 0.8386927  Vali macro F1 0.8049327 
new best score!!!!
Validation loss decreased (0.668695 --> 0.447129).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.3064563274383545
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3817214  Vali Loss: 0.3614900 Vali Accuracy: 0.8838612  Vali weighted F1: 0.8783651  Vali macro F1 0.8493503 
new best score!!!!
Validation loss decreased (0.447129 --> 0.361490).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2948081493377686
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2843106  Vali Loss: 0.2469337 Vali Accuracy: 0.9230769  Vali weighted F1: 0.9229693  Vali macro F1 0.9068734 
new best score!!!!
Validation loss decreased (0.361490 --> 0.246934).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.284219026565552
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2283323  Vali Loss: 0.2088247 Vali Accuracy: 0.9301156  Vali weighted F1: 0.9299451  Vali macro F1 0.9114479 
new best score!!!!
Validation loss decreased (0.246934 --> 0.208825).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.2806336879730225
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1937828  Vali Loss: 0.1890662 Vali Accuracy: 0.9386626  Vali weighted F1: 0.9384985  Vali macro F1 0.9198295 
new best score!!!!
Validation loss decreased (0.208825 --> 0.189066).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.2652528285980225
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1687571  Vali Loss: 0.1544378 Vali Accuracy: 0.9457014  Vali weighted F1: 0.9462441  Vali macro F1 0.9255698 
new best score!!!!
Validation loss decreased (0.189066 --> 0.154438).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.255190134048462
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1472032  Vali Loss: 0.1365628 Vali Accuracy: 0.9512318  Vali weighted F1: 0.9511494  Vali macro F1 0.9311458 
new best score!!!!
Validation loss decreased (0.154438 --> 0.136563).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.2998948097229
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1382112  Vali Loss: 0.1479643 Vali Accuracy: 0.9502262  Vali weighted F1: 0.9507731  Vali macro F1 0.9310662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.291420221328735
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1278940  Vali Loss: 0.1354776 Vali Accuracy: 0.9552539  Vali weighted F1: 0.9553449  Vali macro F1 0.9379672 
new best score!!!!
Validation loss decreased (0.136563 --> 0.135478).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.300872802734375
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1189232  Vali Loss: 0.1233915 Vali Accuracy: 0.9552539  Vali weighted F1: 0.9558206  Vali macro F1 0.9396160 
new best score!!!!
Validation loss decreased (0.135478 --> 0.123391).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.311720609664917
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1132451  Vali Loss: 0.1054861 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9636095  Vali macro F1 0.9527670 
new best score!!!!
Validation loss decreased (0.123391 --> 0.105486).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.281299829483032
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0984441  Vali Loss: 0.1038178 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9635406  Vali macro F1 0.9517922 
new best score!!!!
Validation loss decreased (0.105486 --> 0.103818).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.287113189697266
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0971112  Vali Loss: 0.0927871 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9643637  Vali macro F1 0.9492343 
new best score!!!!
Validation loss decreased (0.103818 --> 0.092787).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.285260915756226
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0921150  Vali Loss: 0.0895700 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9645361  Vali macro F1 0.9460249 
new best score!!!!
Validation loss decreased (0.092787 --> 0.089570).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.235360383987427
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0873836  Vali Loss: 0.0902918 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9681357  Vali macro F1 0.9548877 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.220705986022949
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0789609  Vali Loss: 0.0983762 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9679343  Vali macro F1 0.9571616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.224557399749756
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0770480  Vali Loss: 0.0820080 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9682697  Vali macro F1 0.9562323 
new best score!!!!
Validation loss decreased (0.089570 --> 0.082008).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.215540885925293
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0722063  Vali Loss: 0.0901152 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9651477  Vali macro F1 0.9550052 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.229902267456055
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0671445  Vali Loss: 0.0796823 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9740942  Vali macro F1 0.9656672 
new best score!!!!
Validation loss decreased (0.082008 --> 0.079682).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.216209888458252
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0619178  Vali Loss: 0.0741029 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9707263  Vali macro F1 0.9586627 
new best score!!!!
Validation loss decreased (0.079682 --> 0.074103).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.210659980773926
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0712521  Vali Loss: 0.0837627 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9740478  Vali macro F1 0.9626406 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.211833715438843
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0591978  Vali Loss: 0.0685511 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9744850  Vali macro F1 0.9640937 
new best score!!!!
Validation loss decreased (0.074103 --> 0.068551).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.215043306350708
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0536344  Vali Loss: 0.0719857 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9731219  Vali macro F1 0.9606990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.22912859916687
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0567205  Vali Loss: 0.0795078 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9736784  Vali macro F1 0.9641442 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.260542869567871
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0539719  Vali Loss: 0.0717642 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9744108  Vali macro F1 0.9630461 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.236870050430298
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0458203  Vali Loss: 0.0589499 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769116  Vali macro F1 0.9664865 
new best score!!!!
Validation loss decreased (0.068551 --> 0.058950).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.232398986816406
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0437566  Vali Loss: 0.0818637 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9693718  Vali macro F1 0.9556712 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.227230548858643
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0460701  Vali Loss: 0.0616560 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9733103  Vali macro F1 0.9640324 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.2352683544158936
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0386644  Vali Loss: 0.0782338 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9747755  Vali macro F1 0.9664053 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.258102178573608
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0428941  Vali Loss: 0.0561558 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9784081  Vali macro F1 0.9698609 
new best score!!!!
Validation loss decreased (0.058950 --> 0.056156).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.258169651031494
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0566482  Vali Loss: 0.0561204 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809531  Vali macro F1 0.9744374 
new best score!!!!
Validation loss decreased (0.056156 --> 0.056120).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.268096685409546
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0379886  Vali Loss: 0.0620110 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9772634  Vali macro F1 0.9689320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.268277168273926
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0335301  Vali Loss: 0.0760586 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769527  Vali macro F1 0.9682996 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.254806041717529
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0291913  Vali Loss: 0.0575255 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789700  Vali macro F1 0.9716738 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.250635385513306
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0306728  Vali Loss: 0.0588129 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9770801  Vali macro F1 0.9695467 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.25482702255249
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0341857  Vali Loss: 0.0680278 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9783179  Vali macro F1 0.9696338 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 6.254245281219482
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0244994  Vali Loss: 0.0521228 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814071  Vali macro F1 0.9721042 
new best score!!!!
Validation loss decreased (0.056120 --> 0.052123).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.258325099945068
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0189615  Vali Loss: 0.0479310 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824777  Vali macro F1 0.9735713 
new best score!!!!
Validation loss decreased (0.052123 --> 0.047931).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.285641670227051
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0174122  Vali Loss: 0.0459013 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849399  Vali macro F1 0.9765633 
new best score!!!!
Validation loss decreased (0.047931 --> 0.045901).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.264537572860718
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0175527  Vali Loss: 0.0480730 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839774  Vali macro F1 0.9757480 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.25758171081543
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0170881  Vali Loss: 0.0449434 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849491  Vali macro F1 0.9766687 
new best score!!!!
Validation loss decreased (0.045901 --> 0.044943).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.2582337856292725
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0165575  Vali Loss: 0.0478740 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833896  Vali macro F1 0.9743087 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.262273073196411
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0151585  Vali Loss: 0.0431055 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844687  Vali macro F1 0.9775200 
new best score!!!!
Validation loss decreased (0.044943 --> 0.043106).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.258303642272949
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0160248  Vali Loss: 0.0457110 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839011  Vali macro F1 0.9755202 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.2642152309417725
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0144175  Vali Loss: 0.0445810 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848876  Vali macro F1 0.9779381 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.272785186767578
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0148869  Vali Loss: 0.0418225 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849344  Vali macro F1 0.9779501 
new best score!!!!
Validation loss decreased (0.043106 --> 0.041823).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.260431528091431
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0146839  Vali Loss: 0.0419258 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854582  Vali macro F1 0.9781851 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.246034145355225
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0151246  Vali Loss: 0.0441296 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849274  Vali macro F1 0.9766466 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.248880624771118
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0130824  Vali Loss: 0.0430861 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834402  Vali macro F1 0.9748116 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.248526334762573
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0137335  Vali Loss: 0.0454089 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854167  Vali macro F1 0.9770730 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.250535249710083
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0132498  Vali Loss: 0.0424719 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854301  Vali macro F1 0.9774568 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.264345407485962
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0127324  Vali Loss: 0.0430613 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.271245718002319
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0124395  Vali Loss: 0.0433705 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.246585369110107
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0125226  Vali Loss: 0.0434987 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.261776924133301
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0127723  Vali Loss: 0.0440231 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844092  Vali macro F1 0.9760145 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.256605625152588
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0121731  Vali Loss: 0.0433690 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 6.253715991973877
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0124559  Vali Loss: 0.0433230 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.252360820770264
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0121512  Vali Loss: 0.0431406 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.269454002380371
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0124756  Vali Loss: 0.0430787 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.251506567001343
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0128079  Vali Loss: 0.0431009 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.261201858520508
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0121595  Vali Loss: 0.0428905 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849280  Vali macro F1 0.9766376 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8741329  Test weighted F1: 0.8799965  Test macro F1 0.8405383 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.299360752105713
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0150884  Vali Loss: 0.0434548 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844660  Vali macro F1 0.9764644 
Validation loss decreased (inf --> 0.043455).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.287209749221802
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0145106  Vali Loss: 0.0444759 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859199  Vali macro F1 0.9789656 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.282963275909424
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0138632  Vali Loss: 0.0467918 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844005  Vali macro F1 0.9769902 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.298698663711548
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0137045  Vali Loss: 0.0424804 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849735  Vali macro F1 0.9777363 
new best score!!!!
Validation loss decreased (0.043455 --> 0.042480).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.318047285079956
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0141165  Vali Loss: 0.0498371 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838711  Vali macro F1 0.9766532 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.289824485778809
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0136280  Vali Loss: 0.0424266 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859865  Vali macro F1 0.9800051 
new best score!!!!
Validation loss decreased (0.042480 --> 0.042427).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.295523643493652
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0127903  Vali Loss: 0.0451812 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844135  Vali macro F1 0.9762635 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.293169260025024
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0121158  Vali Loss: 0.0498736 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818317  Vali macro F1 0.9732573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.2766618728637695
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0119964  Vali Loss: 0.0438958 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844411  Vali macro F1 0.9762038 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.288966655731201
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0106675  Vali Loss: 0.0475040 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834012  Vali macro F1 0.9749548 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.30852198600769
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0113998  Vali Loss: 0.0438670 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859648  Vali macro F1 0.9778391 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.296696901321411
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0122708  Vali Loss: 0.0424717 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864240  Vali macro F1 0.9787620 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.290425062179565
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0105464  Vali Loss: 0.0412472 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854693  Vali macro F1 0.9780439 
new best score!!!!
Validation loss decreased (0.042427 --> 0.041247).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.2850730419158936
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0114068  Vali Loss: 0.0479815 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839937  Vali macro F1 0.9752455 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.270765781402588
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0106892  Vali Loss: 0.0442377 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864020  Vali macro F1 0.9795200 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.292110443115234
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0102503  Vali Loss: 0.0571591 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818304  Vali macro F1 0.9746956 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.287299871444702
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0105851  Vali Loss: 0.0439740 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854774  Vali macro F1 0.9774061 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.304259538650513
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0122481  Vali Loss: 0.0398978 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874853  Vali macro F1 0.9816946 
new best score!!!!
Validation loss decreased (0.041247 --> 0.039898).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.28289794921875
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0105327  Vali Loss: 0.0434279 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854064  Vali macro F1 0.9789259 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.281991720199585
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0100153  Vali Loss: 0.0427976 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859397  Vali macro F1 0.9785091 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.264597415924072
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0107615  Vali Loss: 0.0489819 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863966  Vali macro F1 0.9782098 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.3055641651153564
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0095089  Vali Loss: 0.0401746 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864542  Vali macro F1 0.9797191 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.288209438323975
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0089903  Vali Loss: 0.0456515 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859305  Vali macro F1 0.9780601 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.292872667312622
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0081832  Vali Loss: 0.0447386 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869261  Vali macro F1 0.9793116 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.312008619308472
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0091280  Vali Loss: 0.0439317 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869515  Vali macro F1 0.9794915 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.26737904548645
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0090458  Vali Loss: 0.0433431 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864629  Vali macro F1 0.9790265 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.267054796218872
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0079486  Vali Loss: 0.0436935 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874413  Vali macro F1 0.9813322 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.285459995269775
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0084194  Vali Loss: 0.0447056 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869247  Vali macro F1 0.9807141 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 6.292139768600464
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0072504  Vali Loss: 0.0444912 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869247  Vali macro F1 0.9807141 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.300720930099487
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0086360  Vali Loss: 0.0443511 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869247  Vali macro F1 0.9807141 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.30582857131958
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0080459  Vali Loss: 0.0442096 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874308  Vali macro F1 0.9811763 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.27849268913269
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0086985  Vali Loss: 0.0438983 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879475  Vali macro F1 0.9817945 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.285269737243652
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0082627  Vali Loss: 0.0439775 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874308  Vali macro F1 0.9811763 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8674977  Test weighted F1: 0.8743730  Test macro F1 0.8370695 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014928 0.00018305 0.00110011 0.00139082 0.00051151 0.00062189]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.097920656204224
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.1390298  Vali Loss: 0.7605319 Vali Accuracy: 0.7205806  Vali weighted F1: 0.6514807  Vali macro F1 0.4354224 
Validation loss decreased (inf --> 0.760532).  Saving model ...
Epoch: 2 cost time: 6.096417665481567
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5741220  Vali Loss: 0.4867202 Vali Accuracy: 0.8356661  Vali weighted F1: 0.8109540  Vali macro F1 0.7579985 
new best score!!!!
Validation loss decreased (0.760532 --> 0.486720).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.098878383636475
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.3929174  Vali Loss: 0.3674932 Vali Accuracy: 0.8823224  Vali weighted F1: 0.8731386  Vali macro F1 0.8366767 
new best score!!!!
Validation loss decreased (0.486720 --> 0.367493).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.097564697265625
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.2869821  Vali Loss: 0.2809192 Vali Accuracy: 0.9129082  Vali weighted F1: 0.9099089  Vali macro F1 0.8787214 
new best score!!!!
Validation loss decreased (0.367493 --> 0.280919).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.107356309890747
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2274686  Vali Loss: 0.2562905 Vali Accuracy: 0.9139450  Vali weighted F1: 0.9105899  Vali macro F1 0.8791746 
new best score!!!!
Validation loss decreased (0.280919 --> 0.256290).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.098813533782959
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2081180  Vali Loss: 0.1798026 Vali Accuracy: 0.9372732  Vali weighted F1: 0.9374488  Vali macro F1 0.9095006 
new best score!!!!
Validation loss decreased (0.256290 --> 0.179803).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.1000261306762695
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1666029  Vali Loss: 0.1887850 Vali Accuracy: 0.9445308  Vali weighted F1: 0.9446110  Vali macro F1 0.9212342 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.1010050773620605
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1471474  Vali Loss: 0.1472140 Vali Accuracy: 0.9440124  Vali weighted F1: 0.9440410  Vali macro F1 0.9181892 
new best score!!!!
Validation loss decreased (0.179803 --> 0.147214).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.093997478485107
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1364334  Vali Loss: 0.1331211 Vali Accuracy: 0.9564541  Vali weighted F1: 0.9561909  Vali macro F1 0.9374733 
new best score!!!!
Validation loss decreased (0.147214 --> 0.133121).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.0710859298706055
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1268282  Vali Loss: 0.1273320 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9614106  Vali macro F1 0.9457174 
new best score!!!!
Validation loss decreased (0.133121 --> 0.127332).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.107397556304932
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1073048  Vali Loss: 0.1222407 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9616357  Vali macro F1 0.9468220 
new best score!!!!
Validation loss decreased (0.127332 --> 0.122241).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.1182966232299805
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1052028  Vali Loss: 0.1175148 Vali Accuracy: 0.9595645  Vali weighted F1: 0.9588713  Vali macro F1 0.9446297 
new best score!!!!
Validation loss decreased (0.122241 --> 0.117515).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.116039991378784
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1003428  Vali Loss: 0.0988831 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9699229  Vali macro F1 0.9563597 
new best score!!!!
Validation loss decreased (0.117515 --> 0.098883).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.103822469711304
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0904114  Vali Loss: 0.1042301 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9643794  Vali macro F1 0.9488342 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.090145111083984
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0869848  Vali Loss: 0.1203737 Vali Accuracy: 0.9595645  Vali weighted F1: 0.9596030  Vali macro F1 0.9428052 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.067179203033447
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0849736  Vali Loss: 0.0929997 Vali Accuracy: 0.9652670  Vali weighted F1: 0.9647894  Vali macro F1 0.9514018 
new best score!!!!
Validation loss decreased (0.098883 --> 0.093000).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.098605394363403
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0756899  Vali Loss: 0.1042380 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9668031  Vali macro F1 0.9508766 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.119608163833618
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0707466  Vali Loss: 0.0808456 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766313  Vali macro F1 0.9619982 
new best score!!!!
Validation loss decreased (0.093000 --> 0.080846).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.091721296310425
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0627964  Vali Loss: 0.0866634 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9694999  Vali macro F1 0.9547237 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.10038161277771
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0647852  Vali Loss: 0.0860213 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9678082  Vali macro F1 0.9519142 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.095641136169434
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0717090  Vali Loss: 0.0873641 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9712367  Vali macro F1 0.9543091 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.07939600944519
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0604420  Vali Loss: 0.0700905 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9748965  Vali macro F1 0.9648454 
new best score!!!!
Validation loss decreased (0.080846 --> 0.070090).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.103804588317871
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0542825  Vali Loss: 0.0810355 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9695654  Vali macro F1 0.9551917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.092803001403809
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0502412  Vali Loss: 0.0775530 Vali Accuracy: 0.9709694  Vali weighted F1: 0.9707201  Vali macro F1 0.9582808 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.0990869998931885
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0488784  Vali Loss: 0.0853818 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9736868  Vali macro F1 0.9626172 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.102043628692627
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0456071  Vali Loss: 0.0903564 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9701205  Vali macro F1 0.9563272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 6.097547769546509
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0547618  Vali Loss: 0.0795738 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9742609  Vali macro F1 0.9621385 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 6.082138299942017
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0346440  Vali Loss: 0.0636117 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9796101  Vali macro F1 0.9686311 
new best score!!!!
Validation loss decreased (0.070090 --> 0.063612).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.084314584732056
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0304269  Vali Loss: 0.0617534 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812303  Vali macro F1 0.9710314 
new best score!!!!
Validation loss decreased (0.063612 --> 0.061753).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.106940507888794
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0299149  Vali Loss: 0.0608602 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9801923  Vali macro F1 0.9702005 
new best score!!!!
Validation loss decreased (0.061753 --> 0.060860).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.1003453731536865
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0297482  Vali Loss: 0.0616843 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9801920  Vali macro F1 0.9705528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.121777296066284
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0276445  Vali Loss: 0.0618272 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9801715  Vali macro F1 0.9709773 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.105813264846802
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0269590  Vali Loss: 0.0610858 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802014  Vali macro F1 0.9710175 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.075469255447388
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0276212  Vali Loss: 0.0600290 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802116  Vali macro F1 0.9731270 
new best score!!!!
Validation loss decreased (0.060860 --> 0.060029).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.083505392074585
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0272295  Vali Loss: 0.0603539 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802211  Vali macro F1 0.9713741 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.076462030410767
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0247125  Vali Loss: 0.0591255 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812542  Vali macro F1 0.9721412 
new best score!!!!
Validation loss decreased (0.060029 --> 0.059125).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.070303678512573
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0249013  Vali Loss: 0.0601111 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817326  Vali macro F1 0.9732319 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.081445217132568
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0247517  Vali Loss: 0.0610783 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812378  Vali macro F1 0.9711241 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.101575136184692
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0232095  Vali Loss: 0.0642117 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817406  Vali macro F1 0.9730891 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.068014621734619
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0238466  Vali Loss: 0.0587380 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828104  Vali macro F1 0.9756344 
new best score!!!!
Validation loss decreased (0.059125 --> 0.058738).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.097863435745239
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0253796  Vali Loss: 0.0632545 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812187  Vali macro F1 0.9721839 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.0964226722717285
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0233950  Vali Loss: 0.0587667 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812717  Vali macro F1 0.9724797 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.090692043304443
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0232467  Vali Loss: 0.0596879 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812542  Vali macro F1 0.9742953 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.094273805618286
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0221984  Vali Loss: 0.0606600 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828016  Vali macro F1 0.9756079 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.105443954467773
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0220757  Vali Loss: 0.0573986 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828057  Vali macro F1 0.9745330 
new best score!!!!
Validation loss decreased (0.058738 --> 0.057399).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.102999448776245
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0208770  Vali Loss: 0.0638546 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9806292  Vali macro F1 0.9731418 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.086403131484985
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0222679  Vali Loss: 0.0559273 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828208  Vali macro F1 0.9739231 
new best score!!!!
Validation loss decreased (0.057399 --> 0.055927).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.09595513343811
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0219759  Vali Loss: 0.0585544 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9807568  Vali macro F1 0.9715737 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.089098930358887
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0214363  Vali Loss: 0.0633968 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9807180  Vali macro F1 0.9724778 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.09508752822876
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0200259  Vali Loss: 0.0619059 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9791174  Vali macro F1 0.9710542 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.082657814025879
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0193595  Vali Loss: 0.0604001 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823062  Vali macro F1 0.9737054 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.09538197517395
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0215177  Vali Loss: 0.0554636 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818124  Vali macro F1 0.9735592 
new best score!!!!
Validation loss decreased (0.055927 --> 0.055464).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.098711729049683
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0209558  Vali Loss: 0.0620223 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9806949  Vali macro F1 0.9729871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.092601776123047
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0197138  Vali Loss: 0.0611771 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812365  Vali macro F1 0.9726623 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.09715723991394
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0207138  Vali Loss: 0.0609954 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817587  Vali macro F1 0.9737446 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.097046375274658
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0206091  Vali Loss: 0.0628235 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9801877  Vali macro F1 0.9712626 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.085193395614624
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0182846  Vali Loss: 0.0603110 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817705  Vali macro F1 0.9734562 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 58 cost time: 6.089961528778076
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0174039  Vali Loss: 0.0606816 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9807162  Vali macro F1 0.9724860 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.100810289382935
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0171651  Vali Loss: 0.0617512 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817705  Vali macro F1 0.9734562 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.103280067443848
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0178819  Vali Loss: 0.0608831 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812439  Vali macro F1 0.9729818 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.103062868118286
VALI: Epoch: 61, Steps: 68 | Train Loss: 0.0167808  Vali Loss: 0.0612240 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812439  Vali macro F1 0.9729818 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.099307298660278
VALI: Epoch: 62, Steps: 68 | Train Loss: 0.0168309  Vali Loss: 0.0619548 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817705  Vali macro F1 0.9734562 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 63 cost time: 6.094329595565796
VALI: Epoch: 63, Steps: 68 | Train Loss: 0.0169713  Vali Loss: 0.0618645 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817705  Vali macro F1 0.9734562 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 6.095752000808716
VALI: Epoch: 64, Steps: 68 | Train Loss: 0.0184802  Vali Loss: 0.0615466 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817705  Vali macro F1 0.9734562 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 6.094218015670776
VALI: Epoch: 65, Steps: 68 | Train Loss: 0.0183400  Vali Loss: 0.0612941 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817705  Vali macro F1 0.9734562 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 6.096851348876953
VALI: Epoch: 66, Steps: 68 | Train Loss: 0.0178670  Vali Loss: 0.0611446 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817705  Vali macro F1 0.9734562 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 6.110209941864014
VALI: Epoch: 67, Steps: 68 | Train Loss: 0.0169064  Vali Loss: 0.0610241 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817705  Vali macro F1 0.9734562 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9083000  Test weighted F1: 0.9069313  Test macro F1 0.8174013 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.111053943634033
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0203138  Vali Loss: 0.0606121 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828063  Vali macro F1 0.9748916 
Validation loss decreased (inf --> 0.060612).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.087131500244141
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0211185  Vali Loss: 0.0630945 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817302  Vali macro F1 0.9741341 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.073798656463623
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0202025  Vali Loss: 0.0574941 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812252  Vali macro F1 0.9741378 
new best score!!!!
Validation loss decreased (0.060612 --> 0.057494).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.077176809310913
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0195487  Vali Loss: 0.0615885 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828057  Vali macro F1 0.9745130 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.087308883666992
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0198965  Vali Loss: 0.0652198 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9822420  Vali macro F1 0.9750465 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.1062657833099365
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0195633  Vali Loss: 0.0600975 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9807094  Vali macro F1 0.9735476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.113685131072998
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0188273  Vali Loss: 0.0563199 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9796827  Vali macro F1 0.9707184 
new best score!!!!
Validation loss decreased (0.057494 --> 0.056320).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.096814870834351
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0179526  Vali Loss: 0.0615157 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812201  Vali macro F1 0.9723368 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.102530002593994
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0186800  Vali Loss: 0.0591917 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817552  Vali macro F1 0.9741451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.104832649230957
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0174786  Vali Loss: 0.0579073 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833427  Vali macro F1 0.9753932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.099544048309326
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0161205  Vali Loss: 0.0619913 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9796558  Vali macro F1 0.9704427 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.10106897354126
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0173937  Vali Loss: 0.0597820 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9786658  Vali macro F1 0.9692763 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.109657049179077
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0156500  Vali Loss: 0.0596896 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812625  Vali macro F1 0.9711928 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.117944240570068
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0164376  Vali Loss: 0.0593108 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817552  Vali macro F1 0.9739934 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.102795600891113
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0155228  Vali Loss: 0.0583310 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802277  Vali macro F1 0.9709233 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.09600043296814
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0163543  Vali Loss: 0.0618919 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817899  Vali macro F1 0.9733598 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.082388877868652
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0169487  Vali Loss: 0.0610905 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817626  Vali macro F1 0.9741695 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.092687368392944
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0154733  Vali Loss: 0.0590505 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817797  Vali macro F1 0.9736770 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.109466314315796
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0137823  Vali Loss: 0.0592804 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817797  Vali macro F1 0.9736770 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.131741285324097
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0148339  Vali Loss: 0.0580689 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833480  Vali macro F1 0.9758341 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.120790481567383
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0137156  Vali Loss: 0.0586827 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9822964  Vali macro F1 0.9739293 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.100574731826782
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0157060  Vali Loss: 0.0576082 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823118  Vali macro F1 0.9739528 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9089929  Test weighted F1: 0.9071567  Test macro F1 0.8176142 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014773 0.00018282 0.00097561 0.00126743 0.0005005  0.00061237]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.196349620819092
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1201967  Vali Loss: 0.7275451 Vali Accuracy: 0.7307888  Vali weighted F1: 0.6917822  Vali macro F1 0.4852578 
Validation loss decreased (inf --> 0.727545).  Saving model ...
Epoch: 2 cost time: 6.1941375732421875
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5568182  Vali Loss: 0.4473249 Vali Accuracy: 0.8544529  Vali weighted F1: 0.8378480  Vali macro F1 0.7905105 
new best score!!!!
Validation loss decreased (0.727545 --> 0.447325).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.184839248657227
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4057288  Vali Loss: 0.3460776 Vali Accuracy: 0.8834606  Vali weighted F1: 0.8743953  Vali macro F1 0.8294187 
new best score!!!!
Validation loss decreased (0.447325 --> 0.346078).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.213253736495972
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3028222  Vali Loss: 0.2642133 Vali Accuracy: 0.9150127  Vali weighted F1: 0.9126346  Vali macro F1 0.8826500 
new best score!!!!
Validation loss decreased (0.346078 --> 0.264213).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.214707612991333
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2368340  Vali Loss: 0.2181588 Vali Accuracy: 0.9292621  Vali weighted F1: 0.9282559  Vali macro F1 0.8986099 
new best score!!!!
Validation loss decreased (0.264213 --> 0.218159).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.1924262046813965
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2128828  Vali Loss: 0.1980054 Vali Accuracy: 0.9374046  Vali weighted F1: 0.9372410  Vali macro F1 0.9087607 
new best score!!!!
Validation loss decreased (0.218159 --> 0.198005).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.2136616706848145
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1826538  Vali Loss: 0.1688252 Vali Accuracy: 0.9470738  Vali weighted F1: 0.9472828  Vali macro F1 0.9211592 
new best score!!!!
Validation loss decreased (0.198005 --> 0.168825).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.210078239440918
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1702282  Vali Loss: 0.1507786 Vali Accuracy: 0.9506361  Vali weighted F1: 0.9509684  Vali macro F1 0.9251136 
new best score!!!!
Validation loss decreased (0.168825 --> 0.150779).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.214787006378174
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1503491  Vali Loss: 0.1572345 Vali Accuracy: 0.9480916  Vali weighted F1: 0.9489554  Vali macro F1 0.9266702 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.213201999664307
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1379704  Vali Loss: 0.1315512 Vali Accuracy: 0.9531807  Vali weighted F1: 0.9535782  Vali macro F1 0.9318073 
new best score!!!!
Validation loss decreased (0.150779 --> 0.131551).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.22301983833313
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1255024  Vali Loss: 0.1122161 Vali Accuracy: 0.9603053  Vali weighted F1: 0.9602166  Vali macro F1 0.9418001 
new best score!!!!
Validation loss decreased (0.131551 --> 0.112216).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.207916975021362
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1153201  Vali Loss: 0.1256996 Vali Accuracy: 0.9567430  Vali weighted F1: 0.9572906  Vali macro F1 0.9360675 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.213301420211792
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1081988  Vali Loss: 0.1078847 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9638421  Vali macro F1 0.9442085 
new best score!!!!
Validation loss decreased (0.112216 --> 0.107885).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1938416957855225
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0946026  Vali Loss: 0.1689365 Vali Accuracy: 0.9399491  Vali weighted F1: 0.9407178  Vali macro F1 0.9184931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.198274612426758
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1062053  Vali Loss: 0.1006108 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9650289  Vali macro F1 0.9476526 
new best score!!!!
Validation loss decreased (0.107885 --> 0.100611).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.190130233764648
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0841276  Vali Loss: 0.0958004 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9638858  Vali macro F1 0.9485832 
new best score!!!!
Validation loss decreased (0.100611 --> 0.095800).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.214000225067139
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0777272  Vali Loss: 0.1440195 Vali Accuracy: 0.9516539  Vali weighted F1: 0.9502308  Vali macro F1 0.9315546 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.225932836532593
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0832387  Vali Loss: 0.0678382 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9787156  Vali macro F1 0.9689595 
new best score!!!!
Validation loss decreased (0.095800 --> 0.067838).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.218584775924683
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0702286  Vali Loss: 0.0951916 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9735330  Vali macro F1 0.9603097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.2131969928741455
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0723732  Vali Loss: 0.0734300 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9746919  Vali macro F1 0.9610571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.211926698684692
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0658420  Vali Loss: 0.0637646 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9811653  Vali macro F1 0.9710153 
new best score!!!!
Validation loss decreased (0.067838 --> 0.063765).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.178180456161499
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0556563  Vali Loss: 0.0767574 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9779217  Vali macro F1 0.9660022 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.2263572216033936
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0513592  Vali Loss: 0.0665300 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9777176  Vali macro F1 0.9652502 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.24212908744812
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0518227  Vali Loss: 0.0577951 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842579  Vali macro F1 0.9731193 
new best score!!!!
Validation loss decreased (0.063765 --> 0.057795).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.219390869140625
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0473204  Vali Loss: 0.0924244 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9737248  Vali macro F1 0.9620552 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.228196859359741
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0581552  Vali Loss: 0.0793424 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9761435  Vali macro F1 0.9623371 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.216820478439331
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0666147  Vali Loss: 0.0715178 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9760596  Vali macro F1 0.9630233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.194975852966309
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0421873  Vali Loss: 0.0759859 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9754365  Vali macro F1 0.9623072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.187302350997925
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0538546  Vali Loss: 0.0911445 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9720345  Vali macro F1 0.9573109 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.224611520767212
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0384829  Vali Loss: 0.0491377 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842503  Vali macro F1 0.9740643 
new best score!!!!
Validation loss decreased (0.057795 --> 0.049138).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.222292184829712
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0306108  Vali Loss: 0.0497488 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852714  Vali macro F1 0.9765092 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.233840703964233
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0267127  Vali Loss: 0.0479655 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857913  Vali macro F1 0.9770125 
new best score!!!!
Validation loss decreased (0.049138 --> 0.047966).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.221218109130859
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0258371  Vali Loss: 0.0471991 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857913  Vali macro F1 0.9770125 
new best score!!!!
Validation loss decreased (0.047966 --> 0.047199).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.209445953369141
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0260181  Vali Loss: 0.0466433 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857754  Vali macro F1 0.9771322 
new best score!!!!
Validation loss decreased (0.047199 --> 0.046643).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.191809177398682
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0247789  Vali Loss: 0.0468118 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847395  Vali macro F1 0.9748910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.205889701843262
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0250212  Vali Loss: 0.0469989 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862863  Vali macro F1 0.9768672 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.212708473205566
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0228129  Vali Loss: 0.0466558 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862671  Vali macro F1 0.9770515 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.2292890548706055
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0238948  Vali Loss: 0.0520270 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842132  Vali macro F1 0.9741522 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.215174436569214
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0235763  Vali Loss: 0.0477941 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857464  Vali macro F1 0.9763224 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 6.192157030105591
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0220716  Vali Loss: 0.0476463 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.195654630661011
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0222695  Vali Loss: 0.0479293 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.210059642791748
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0231616  Vali Loss: 0.0482132 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.202970266342163
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0222126  Vali Loss: 0.0472514 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.211023330688477
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0215700  Vali Loss: 0.0471934 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 6.229072570800781
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0212446  Vali Loss: 0.0471621 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.215123414993286
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0210079  Vali Loss: 0.0471447 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.184878349304199
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0211799  Vali Loss: 0.0471245 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.225507497787476
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0208940  Vali Loss: 0.0470813 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.215291500091553
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0219425  Vali Loss: 0.0471186 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852376  Vali macro F1 0.9754788 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8651605  Test weighted F1: 0.8712356  Test macro F1 0.8560720 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.244985103607178
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0278810  Vali Loss: 0.0473352 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852650  Vali macro F1 0.9755459 
Validation loss decreased (inf --> 0.047335).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.244320631027222
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0248546  Vali Loss: 0.0491408 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852346  Vali macro F1 0.9758564 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.20881199836731
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0227110  Vali Loss: 0.0493542 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857423  Vali macro F1 0.9758027 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.229525566101074
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0226344  Vali Loss: 0.0510408 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842317  Vali macro F1 0.9745615 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.235344171524048
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0212124  Vali Loss: 0.0480058 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842279  Vali macro F1 0.9740309 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.228408336639404
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0225588  Vali Loss: 0.0482017 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852598  Vali macro F1 0.9751291 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.235364198684692
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0225695  Vali Loss: 0.0528607 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9841923  Vali macro F1 0.9738403 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.2107203006744385
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0209723  Vali Loss: 0.0490642 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852598  Vali macro F1 0.9751291 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.217803478240967
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0204545  Vali Loss: 0.0501669 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852174  Vali macro F1 0.9750660 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.250519752502441
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0200321  Vali Loss: 0.0468529 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857524  Vali macro F1 0.9757627 
new best score!!!!
Validation loss decreased (0.047335 --> 0.046853).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.23673939704895
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0198563  Vali Loss: 0.0437515 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862745  Vali macro F1 0.9765011 
new best score!!!!
Validation loss decreased (0.046853 --> 0.043751).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.236613988876343
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0190641  Vali Loss: 0.0476770 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852390  Vali macro F1 0.9750979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.234889984130859
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0183187  Vali Loss: 0.0456639 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867886  Vali macro F1 0.9769826 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.213077068328857
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0184617  Vali Loss: 0.0506538 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857457  Vali macro F1 0.9761333 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.223773717880249
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0188265  Vali Loss: 0.0501777 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857554  Vali macro F1 0.9759794 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.227099657058716
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0170995  Vali Loss: 0.0476651 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.227743864059448
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0172377  Vali Loss: 0.0472461 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.2328102588653564
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0155199  Vali Loss: 0.0471077 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862863  Vali macro F1 0.9768672 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.227238178253174
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0172276  Vali Loss: 0.0475085 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857722  Vali macro F1 0.9763857 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.206572532653809
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0144254  Vali Loss: 0.0477491 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.224118947982788
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0151580  Vali Loss: 0.0479306 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 6.236905574798584
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0166873  Vali Loss: 0.0478713 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.26654839515686
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0162656  Vali Loss: 0.0477794 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.261288404464722
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0157517  Vali Loss: 0.0477459 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.238970994949341
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0158537  Vali Loss: 0.0477128 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.228514671325684
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0157511  Vali Loss: 0.0476264 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862666  Vali macro F1 0.9768380 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8581675  Test weighted F1: 0.8642822  Test macro F1 0.8524606 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014881 0.00018454 0.00100503 0.00125313 0.00051787 0.00062112]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.134003162384033
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.1325296  Vali Loss: 0.6658548 Vali Accuracy: 0.7456231  Vali weighted F1: 0.6629015  Vali macro F1 0.4144380 
Validation loss decreased (inf --> 0.665855).  Saving model ...
Epoch: 2 cost time: 6.1409265995025635
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.5802665  Vali Loss: 0.4589552 Vali Accuracy: 0.8424305  Vali weighted F1: 0.8248622  Vali macro F1 0.7651901 
new best score!!!!
Validation loss decreased (0.665855 --> 0.458955).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.149775266647339
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.4102385  Vali Loss: 0.4563808 Vali Accuracy: 0.8347065  Vali weighted F1: 0.8377945  Vali macro F1 0.8005180 
new best score!!!!
Validation loss decreased (0.458955 --> 0.456381).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.148939847946167
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.3005037  Vali Loss: 0.2687748 Vali Accuracy: 0.9124614  Vali weighted F1: 0.9094076  Vali macro F1 0.8698945 
new best score!!!!
Validation loss decreased (0.456381 --> 0.268775).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.13237190246582
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2378105  Vali Loss: 0.2068454 Vali Accuracy: 0.9335736  Vali weighted F1: 0.9340730  Vali macro F1 0.9031715 
new best score!!!!
Validation loss decreased (0.268775 --> 0.206845).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.141108989715576
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2012283  Vali Loss: 0.1701248 Vali Accuracy: 0.9418126  Vali weighted F1: 0.9410496  Vali macro F1 0.9099948 
new best score!!!!
Validation loss decreased (0.206845 --> 0.170125).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.148928642272949
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1667663  Vali Loss: 0.1476369 Vali Accuracy: 0.9531411  Vali weighted F1: 0.9526761  Vali macro F1 0.9271346 
new best score!!!!
Validation loss decreased (0.170125 --> 0.147637).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.14540958404541
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1604673  Vali Loss: 0.1310330 Vali Accuracy: 0.9536560  Vali weighted F1: 0.9529061  Vali macro F1 0.9296461 
new best score!!!!
Validation loss decreased (0.147637 --> 0.131033).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.1666419506073
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1383685  Vali Loss: 0.1224163 Vali Accuracy: 0.9613800  Vali weighted F1: 0.9617512  Vali macro F1 0.9406567 
new best score!!!!
Validation loss decreased (0.131033 --> 0.122416).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.158670663833618
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1315700  Vali Loss: 0.1171718 Vali Accuracy: 0.9552008  Vali weighted F1: 0.9548543  Vali macro F1 0.9285298 
new best score!!!!
Validation loss decreased (0.122416 --> 0.117172).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.166338682174683
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1194496  Vali Loss: 0.1012188 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9673776  Vali macro F1 0.9466712 
new best score!!!!
Validation loss decreased (0.117172 --> 0.101219).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.163539171218872
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1103018  Vali Loss: 0.1093021 Vali Accuracy: 0.9624099  Vali weighted F1: 0.9620709  Vali macro F1 0.9396094 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.174039125442505
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1039320  Vali Loss: 0.1086447 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9638370  Vali macro F1 0.9448570 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.17090106010437
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0948306  Vali Loss: 0.0960966 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9658237  Vali macro F1 0.9447556 
new best score!!!!
Validation loss decreased (0.101219 --> 0.096097).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.149716138839722
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0892004  Vali Loss: 0.0866217 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9730824  Vali macro F1 0.9589088 
new best score!!!!
Validation loss decreased (0.096097 --> 0.086622).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.1215972900390625
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0834857  Vali Loss: 0.0784237 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9728033  Vali macro F1 0.9555755 
new best score!!!!
Validation loss decreased (0.086622 --> 0.078424).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.15801477432251
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0767975  Vali Loss: 0.0837885 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9723856  Vali macro F1 0.9580842 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.124642848968506
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0739031  Vali Loss: 0.0992910 Vali Accuracy: 0.9618950  Vali weighted F1: 0.9615296  Vali macro F1 0.9459495 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.1346070766448975
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0749618  Vali Loss: 0.0803225 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9717226  Vali macro F1 0.9572059 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.140291929244995
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0686411  Vali Loss: 0.0836823 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9732488  Vali macro F1 0.9615612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 6.143407583236694
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0723107  Vali Loss: 0.0906866 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9694357  Vali macro F1 0.9509615 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 6.133094549179077
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0556688  Vali Loss: 0.0719962 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773407  Vali macro F1 0.9652622 
new best score!!!!
Validation loss decreased (0.078424 --> 0.071996).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.159934759140015
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0489417  Vali Loss: 0.0700858 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747080  Vali macro F1 0.9596317 
new best score!!!!
Validation loss decreased (0.071996 --> 0.070086).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.1805784702301025
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0469635  Vali Loss: 0.0692175 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9762191  Vali macro F1 0.9658056 
new best score!!!!
Validation loss decreased (0.070086 --> 0.069217).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.124624252319336
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0450081  Vali Loss: 0.0681536 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782776  Vali macro F1 0.9683872 
new best score!!!!
Validation loss decreased (0.069217 --> 0.068154).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.158480882644653
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0451785  Vali Loss: 0.0668753 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782776  Vali macro F1 0.9683872 
new best score!!!!
Validation loss decreased (0.068154 --> 0.066875).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.1609275341033936
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0449048  Vali Loss: 0.0698938 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9777369  Vali macro F1 0.9678000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.145602703094482
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0441239  Vali Loss: 0.0683508 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9776681  Vali macro F1 0.9680383 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.148345947265625
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0428801  Vali Loss: 0.0680510 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773183  Vali macro F1 0.9673755 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.166348695755005
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0418381  Vali Loss: 0.0639495 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783152  Vali macro F1 0.9684517 
new best score!!!!
Validation loss decreased (0.066875 --> 0.063950).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.140095472335815
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0414471  Vali Loss: 0.0664149 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9778716  Vali macro F1 0.9683344 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.1579978466033936
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0402778  Vali Loss: 0.0685586 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9767788  Vali macro F1 0.9667908 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.147595405578613
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0408966  Vali Loss: 0.0644495 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9787989  Vali macro F1 0.9692886 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.153256893157959
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0393938  Vali Loss: 0.0641074 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793533  Vali macro F1 0.9702495 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.150298118591309
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0384607  Vali Loss: 0.0640630 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793019  Vali macro F1 0.9698109 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 36 cost time: 6.1542439460754395
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0384285  Vali Loss: 0.0637448 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
new best score!!!!
Validation loss decreased (0.063950 --> 0.063745).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.159286022186279
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0383427  Vali Loss: 0.0645167 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9788336  Vali macro F1 0.9693503 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.149623870849609
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0380219  Vali Loss: 0.0644615 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.153036117553711
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0368996  Vali Loss: 0.0636952 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
new best score!!!!
Validation loss decreased (0.063745 --> 0.063695).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.151064157485962
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0366692  Vali Loss: 0.0639884 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.1496241092681885
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0384312  Vali Loss: 0.0637736 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.151017665863037
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0370652  Vali Loss: 0.0645007 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.1273698806762695
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0360010  Vali Loss: 0.0644699 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.173920631408691
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0376900  Vali Loss: 0.0640189 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9788336  Vali macro F1 0.9693503 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 6.175708770751953
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0363295  Vali Loss: 0.0641113 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9788336  Vali macro F1 0.9693503 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.15838098526001
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0374234  Vali Loss: 0.0641819 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.148004531860352
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0377641  Vali Loss: 0.0641825 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.1690733432769775
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0371199  Vali Loss: 0.0641443 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.122272253036499
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0375025  Vali Loss: 0.0642179 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 50 cost time: 6.134873390197754
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0374759  Vali Loss: 0.0642197 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.1272101402282715
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0348775  Vali Loss: 0.0642256 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.143266677856445
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0363235  Vali Loss: 0.0642316 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.127405643463135
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0362232  Vali Loss: 0.0642377 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.117123126983643
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0357100  Vali Loss: 0.0642433 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782952  Vali macro F1 0.9687837 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9583401  Test weighted F1: 0.9562154  Test macro F1 0.9375700 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.110295534133911
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0397782  Vali Loss: 0.0680682 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9777296  Vali macro F1 0.9688119 
Validation loss decreased (inf --> 0.068068).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.102158308029175
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0375059  Vali Loss: 0.0662222 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9797908  Vali macro F1 0.9706545 
new best score!!!!
Validation loss decreased (0.068068 --> 0.066222).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.106459379196167
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0370905  Vali Loss: 0.0676881 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9787830  Vali macro F1 0.9693210 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.108107805252075
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0362609  Vali Loss: 0.0668883 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782836  Vali macro F1 0.9690610 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.111496210098267
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0363909  Vali Loss: 0.0666516 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9768015  Vali macro F1 0.9665126 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.103460788726807
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0374999  Vali Loss: 0.0661001 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798798  Vali macro F1 0.9711682 
new best score!!!!
Validation loss decreased (0.066222 --> 0.066100).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.095025300979614
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0348654  Vali Loss: 0.0641076 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9787969  Vali macro F1 0.9693040 
new best score!!!!
Validation loss decreased (0.066100 --> 0.064108).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.097660064697266
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0354836  Vali Loss: 0.0632502 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9803867  Vali macro F1 0.9717751 
new best score!!!!
Validation loss decreased (0.064108 --> 0.063250).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.089865684509277
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0345751  Vali Loss: 0.0604921 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794190  Vali macro F1 0.9700837 
new best score!!!!
Validation loss decreased (0.063250 --> 0.060492).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.0998215675354
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0332086  Vali Loss: 0.0628811 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793079  Vali macro F1 0.9704851 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.149597406387329
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0323449  Vali Loss: 0.0631228 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793760  Vali macro F1 0.9703483 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.113706111907959
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0326562  Vali Loss: 0.0592431 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804237  Vali macro F1 0.9721030 
new best score!!!!
Validation loss decreased (0.060492 --> 0.059243).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.117140293121338
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0317498  Vali Loss: 0.0652399 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798499  Vali macro F1 0.9711946 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.106009244918823
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0307085  Vali Loss: 0.0646652 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798630  Vali macro F1 0.9714270 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.099569320678711
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0322674  Vali Loss: 0.0619310 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814576  Vali macro F1 0.9742367 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.096009969711304
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0290530  Vali Loss: 0.0626288 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798612  Vali macro F1 0.9704728 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.118774652481079
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0300937  Vali Loss: 0.0675283 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9803623  Vali macro F1 0.9723606 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 6.127477645874023
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0300152  Vali Loss: 0.0603666 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9788470  Vali macro F1 0.9690751 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.109920263290405
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0302156  Vali Loss: 0.0586605 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809195  Vali macro F1 0.9723819 
new best score!!!!
Validation loss decreased (0.059243 --> 0.058660).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.108042478561401
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0276255  Vali Loss: 0.0608628 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814118  Vali macro F1 0.9747077 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.087474584579468
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0266162  Vali Loss: 0.0623599 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793574  Vali macro F1 0.9699678 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.104093313217163
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0273683  Vali Loss: 0.0633021 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820085  Vali macro F1 0.9738162 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.1015284061431885
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0267542  Vali Loss: 0.0643933 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820202  Vali macro F1 0.9738796 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.109650135040283
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0271919  Vali Loss: 0.0633404 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819722  Vali macro F1 0.9746960 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.115483522415161
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0266834  Vali Loss: 0.0615270 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814381  Vali macro F1 0.9741066 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.107893228530884
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0239745  Vali Loss: 0.0620669 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9808916  Vali macro F1 0.9738237 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.11179518699646
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0239425  Vali Loss: 0.0615755 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814381  Vali macro F1 0.9741066 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.097033500671387
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0250865  Vali Loss: 0.0615107 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814226  Vali macro F1 0.9744283 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.096113204956055
Fine Tuning VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0249617  Vali Loss: 0.0626347 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793347  Vali macro F1 0.9705404 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 6.0938379764556885
Fine Tuning VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0236743  Vali Loss: 0.0624420 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793347  Vali macro F1 0.9705404 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.121062994003296
Fine Tuning VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0232891  Vali Loss: 0.0623645 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798716  Vali macro F1 0.9711049 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.123440742492676
Fine Tuning VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0238984  Vali Loss: 0.0622775 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798716  Vali macro F1 0.9711049 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.110435247421265
Fine Tuning VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0244180  Vali Loss: 0.0623304 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809120  Vali macro F1 0.9726169 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.115638732910156
Fine Tuning VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0245926  Vali Loss: 0.0622914 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809227  Vali macro F1 0.9723374 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9604515  Test weighted F1: 0.9587322  Test macro F1 0.9417136 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00015069 0.00018522 0.00137552 0.001443   0.00053476 0.00064267]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.896078586578369
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.1197107  Vali Loss: 0.7003206 Vali Accuracy: 0.7563966  Vali weighted F1: 0.6872465  Vali macro F1 0.4573532 
Validation loss decreased (inf --> 0.700321).  Saving model ...
Epoch: 2 cost time: 5.883813381195068
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5424154  Vali Loss: 0.4462758 Vali Accuracy: 0.8502132  Vali weighted F1: 0.8338807  Vali macro F1 0.7841600 
new best score!!!!
Validation loss decreased (0.700321 --> 0.446276).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.904687881469727
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.3603607  Vali Loss: 0.3250756 Vali Accuracy: 0.8875267  Vali weighted F1: 0.8809793  Vali macro F1 0.8532651 
new best score!!!!
Validation loss decreased (0.446276 --> 0.325076).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.908102989196777
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.2690593  Vali Loss: 0.2505825 Vali Accuracy: 0.9173774  Vali weighted F1: 0.9140216  Vali macro F1 0.8924695 
new best score!!!!
Validation loss decreased (0.325076 --> 0.250582).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.906991720199585
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2059321  Vali Loss: 0.1937666 Vali Accuracy: 0.9381663  Vali weighted F1: 0.9369802  Vali macro F1 0.9165775 
new best score!!!!
Validation loss decreased (0.250582 --> 0.193767).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.897415637969971
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.1709053  Vali Loss: 0.1552122 Vali Accuracy: 0.9488273  Vali weighted F1: 0.9480952  Vali macro F1 0.9274492 
new best score!!!!
Validation loss decreased (0.193767 --> 0.155212).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.8996593952178955
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1531317  Vali Loss: 0.1551265 Vali Accuracy: 0.9525586  Vali weighted F1: 0.9521155  Vali macro F1 0.9401814 
new best score!!!!
Validation loss decreased (0.155212 --> 0.155126).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.897771835327148
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1367020  Vali Loss: 0.1355870 Vali Accuracy: 0.9530917  Vali weighted F1: 0.9530049  Vali macro F1 0.9399685 
new best score!!!!
Validation loss decreased (0.155126 --> 0.135587).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.897834777832031
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1306895  Vali Loss: 0.1370875 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9469883  Vali macro F1 0.9036626 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.903716802597046
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1273448  Vali Loss: 0.1392585 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9549316  Vali macro F1 0.9437740 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.909395456314087
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1168014  Vali Loss: 0.1302836 Vali Accuracy: 0.9562900  Vali weighted F1: 0.9550017  Vali macro F1 0.9472597 
new best score!!!!
Validation loss decreased (0.135587 --> 0.130284).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.898683071136475
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1033497  Vali Loss: 0.1055395 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9659003  Vali macro F1 0.9557545 
new best score!!!!
Validation loss decreased (0.130284 --> 0.105539).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.896699905395508
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0919645  Vali Loss: 0.1106059 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9630083  Vali macro F1 0.9541662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.898951530456543
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0850588  Vali Loss: 0.1001095 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9654958  Vali macro F1 0.9560897 
new best score!!!!
Validation loss decreased (0.105539 --> 0.100109).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.8978681564331055
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0770287  Vali Loss: 0.0980095 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9691857  Vali macro F1 0.9608680 
new best score!!!!
Validation loss decreased (0.100109 --> 0.098009).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.897909879684448
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0780712  Vali Loss: 0.0893900 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9715663  Vali macro F1 0.9628426 
new best score!!!!
Validation loss decreased (0.098009 --> 0.089390).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.9097278118133545
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0736787  Vali Loss: 0.1409119 Vali Accuracy: 0.9600213  Vali weighted F1: 0.9587459  Vali macro F1 0.9537046 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.9089014530181885
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0739738  Vali Loss: 0.1016227 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9669459  Vali macro F1 0.9596005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.916178464889526
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0666319  Vali Loss: 0.0722093 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9756164  Vali macro F1 0.9681261 
new best score!!!!
Validation loss decreased (0.089390 --> 0.072209).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.900047540664673
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0600026  Vali Loss: 0.0701356 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781835  Vali macro F1 0.9712509 
new best score!!!!
Validation loss decreased (0.072209 --> 0.070136).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.901468515396118
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0538516  Vali Loss: 0.0783295 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9764534  Vali macro F1 0.9705475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.8999855518341064
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0541418  Vali Loss: 0.1089470 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9694177  Vali macro F1 0.9626966 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.9152703285217285
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0485527  Vali Loss: 0.0761432 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9736472  Vali macro F1 0.9667319 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.929559946060181
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0526562  Vali Loss: 0.0814630 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781441  Vali macro F1 0.9712364 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.917148113250732
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0470302  Vali Loss: 0.0807352 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9748702  Vali macro F1 0.9671324 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.917823553085327
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0363298  Vali Loss: 0.0690017 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9780953  Vali macro F1 0.9718428 
new best score!!!!
Validation loss decreased (0.070136 --> 0.069002).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.905557632446289
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0329215  Vali Loss: 0.0744173 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9790745  Vali macro F1 0.9737511 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.896036624908447
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0310882  Vali Loss: 0.0682863 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797131  Vali macro F1 0.9741564 
new best score!!!!
Validation loss decreased (0.069002 --> 0.068286).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.900998592376709
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0300438  Vali Loss: 0.0662437 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786537  Vali macro F1 0.9728663 
new best score!!!!
Validation loss decreased (0.068286 --> 0.066244).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.905594825744629
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0289359  Vali Loss: 0.0638499 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781038  Vali macro F1 0.9722303 
new best score!!!!
Validation loss decreased (0.066244 --> 0.063850).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.926143646240234
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0281197  Vali Loss: 0.0623465 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807838  Vali macro F1 0.9755133 
new best score!!!!
Validation loss decreased (0.063850 --> 0.062347).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.923295021057129
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0273236  Vali Loss: 0.0652346 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807992  Vali macro F1 0.9753653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.910171747207642
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0272634  Vali Loss: 0.0649246 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796857  Vali macro F1 0.9744733 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.905558109283447
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0263579  Vali Loss: 0.0629121 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797583  Vali macro F1 0.9745046 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.90854287147522
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0262066  Vali Loss: 0.0633917 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797221  Vali macro F1 0.9744316 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.9043495655059814
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0260417  Vali Loss: 0.0687392 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797014  Vali macro F1 0.9742793 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 5.898841381072998
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0248517  Vali Loss: 0.0676463 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797014  Vali macro F1 0.9742793 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.909679889678955
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0232312  Vali Loss: 0.0660922 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807838  Vali macro F1 0.9755133 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.918798208236694
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0240333  Vali Loss: 0.0672107 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801998  Vali macro F1 0.9750382 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.906246662139893
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0237353  Vali Loss: 0.0674912 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801998  Vali macro F1 0.9750382 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.900616407394409
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0244345  Vali Loss: 0.0675396 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797014  Vali macro F1 0.9742793 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 42 cost time: 5.9060869216918945
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0232436  Vali Loss: 0.0673480 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797014  Vali macro F1 0.9742793 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.899459600448608
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0229063  Vali Loss: 0.0673037 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791530  Vali macro F1 0.9736463 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.910096883773804
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0243118  Vali Loss: 0.0672468 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791530  Vali macro F1 0.9736463 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 5.9130871295928955
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0241652  Vali Loss: 0.0671148 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791530  Vali macro F1 0.9736463 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 5.90576434135437
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0256858  Vali Loss: 0.0670091 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796857  Vali macro F1 0.9744733 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9152466  Test weighted F1: 0.9187596  Test macro F1 0.8834511 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.924093723297119
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0281406  Vali Loss: 0.0625597 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797958  Vali macro F1 0.9740595 
Validation loss decreased (inf --> 0.062560).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.889375925064087
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0275556  Vali Loss: 0.0666431 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802229  Vali macro F1 0.9753285 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.8939454555511475
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0267896  Vali Loss: 0.0640358 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818355  Vali macro F1 0.9769337 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 5.892401218414307
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0257206  Vali Loss: 0.0666008 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807801  Vali macro F1 0.9750838 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 5.908227443695068
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0243759  Vali Loss: 0.0654290 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812956  Vali macro F1 0.9761212 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 5.918761968612671
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0239567  Vali Loss: 0.0670601 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812664  Vali macro F1 0.9762916 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.9072582721710205
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0245060  Vali Loss: 0.0682902 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791879  Vali macro F1 0.9735326 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.898905038833618
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0235444  Vali Loss: 0.0686440 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791530  Vali macro F1 0.9736463 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.904710292816162
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0226830  Vali Loss: 0.0660961 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808111  Vali macro F1 0.9752425 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.903266191482544
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0230270  Vali Loss: 0.0689894 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791021  Vali macro F1 0.9737200 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 5.9055845737457275
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0229171  Vali Loss: 0.0688263 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796786  Vali macro F1 0.9746532 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 5.907034397125244
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0207062  Vali Loss: 0.0679529 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807725  Vali macro F1 0.9758492 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 5.908715009689331
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0218605  Vali Loss: 0.0669238 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807838  Vali macro F1 0.9755133 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.916877031326294
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0205194  Vali Loss: 0.0663225 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813213  Vali macro F1 0.9763686 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 5.89934778213501
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0212375  Vali Loss: 0.0677540 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813213  Vali macro F1 0.9763686 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 5.890055418014526
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0199737  Vali Loss: 0.0675421 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813213  Vali macro F1 0.9763686 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9111467  Test weighted F1: 0.9155350  Test macro F1 0.8797249 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00014231 0.00018433 0.00095329 0.00125471 0.00053248 0.00064185]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.1987998485565186
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1046274  Vali Loss: 0.6571295 Vali Accuracy: 0.7529173  Vali weighted F1: 0.6885225  Vali macro F1 0.4594132 
Validation loss decreased (inf --> 0.657129).  Saving model ...
Epoch: 2 cost time: 6.187436580657959
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5096676  Vali Loss: 0.4499531 Vali Accuracy: 0.8498224  Vali weighted F1: 0.8373470  Vali macro F1 0.7961856 
new best score!!!!
Validation loss decreased (0.657129 --> 0.449953).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.220544815063477
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3598171  Vali Loss: 0.3609138 Vali Accuracy: 0.8817859  Vali weighted F1: 0.8762008  Vali macro F1 0.8499421 
new best score!!!!
Validation loss decreased (0.449953 --> 0.360914).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.207782506942749
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2810930  Vali Loss: 0.3091012 Vali Accuracy: 0.8944698  Vali weighted F1: 0.8923439  Vali macro F1 0.8635283 
new best score!!!!
Validation loss decreased (0.360914 --> 0.309101).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.214792251586914
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2406410  Vali Loss: 0.2472433 Vali Accuracy: 0.9183156  Vali weighted F1: 0.9171362  Vali macro F1 0.8968344 
new best score!!!!
Validation loss decreased (0.309101 --> 0.247243).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.1900012493133545
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1964684  Vali Loss: 0.2146894 Vali Accuracy: 0.9274480  Vali weighted F1: 0.9275638  Vali macro F1 0.9085678 
new best score!!!!
Validation loss decreased (0.247243 --> 0.214689).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.199753046035767
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1723288  Vali Loss: 0.1937588 Vali Accuracy: 0.9320142  Vali weighted F1: 0.9314851  Vali macro F1 0.9052837 
new best score!!!!
Validation loss decreased (0.214689 --> 0.193759).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.198317289352417
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1608564  Vali Loss: 0.2017686 Vali Accuracy: 0.9294774  Vali weighted F1: 0.9277484  Vali macro F1 0.9044333 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.231931686401367
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1480263  Vali Loss: 0.1469850 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9476554  Vali macro F1 0.9295269 
new best score!!!!
Validation loss decreased (0.193759 --> 0.146985).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.214895963668823
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1198998  Vali Loss: 0.1420806 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9494134  Vali macro F1 0.9298469 
new best score!!!!
Validation loss decreased (0.146985 --> 0.142081).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.222058296203613
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1094949  Vali Loss: 0.1280948 Vali Accuracy: 0.9538305  Vali weighted F1: 0.9540066  Vali macro F1 0.9330364 
new best score!!!!
Validation loss decreased (0.142081 --> 0.128095).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.2298266887664795
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1088442  Vali Loss: 0.1303671 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9500450  Vali macro F1 0.9258251 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.218656539916992
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0938858  Vali Loss: 0.1300148 Vali Accuracy: 0.9538305  Vali weighted F1: 0.9533332  Vali macro F1 0.9335572 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.212332487106323
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0941626  Vali Loss: 0.1098378 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9608840  Vali macro F1 0.9389198 
new best score!!!!
Validation loss decreased (0.128095 --> 0.109838).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.226420164108276
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0820552  Vali Loss: 0.1181162 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9615010  Vali macro F1 0.9433922 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.222375392913818
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0805689  Vali Loss: 0.0920189 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9673674  Vali macro F1 0.9493772 
new best score!!!!
Validation loss decreased (0.109838 --> 0.092019).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.214597940444946
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0737585  Vali Loss: 0.1155963 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9623598  Vali macro F1 0.9402075 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.210749864578247
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0780264  Vali Loss: 0.0989875 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9694383  Vali macro F1 0.9541256 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.223613739013672
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0727650  Vali Loss: 0.0940771 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9676563  Vali macro F1 0.9483592 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.206480264663696
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0621189  Vali Loss: 0.0869555 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9692630  Vali macro F1 0.9529917 
new best score!!!!
Validation loss decreased (0.092019 --> 0.086955).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.2225658893585205
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0563853  Vali Loss: 0.0989072 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9696454  Vali macro F1 0.9596889 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.211625814437866
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0497053  Vali Loss: 0.0910521 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9705058  Vali macro F1 0.9569800 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.219359874725342
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0452410  Vali Loss: 0.1008803 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9687613  Vali macro F1 0.9554795 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.229129076004028
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0447122  Vali Loss: 0.0795071 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9764354  Vali macro F1 0.9661163 
new best score!!!!
Validation loss decreased (0.086955 --> 0.079507).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.218521356582642
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0516745  Vali Loss: 0.1280173 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9610908  Vali macro F1 0.9452272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.227360010147095
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0468398  Vali Loss: 0.0664677 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807940  Vali macro F1 0.9689436 
new best score!!!!
Validation loss decreased (0.079507 --> 0.066468).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.210602283477783
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0410163  Vali Loss: 0.0679797 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766787  Vali macro F1 0.9593610 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.218861818313599
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0415490  Vali Loss: 0.0641322 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807269  Vali macro F1 0.9720129 
new best score!!!!
Validation loss decreased (0.066468 --> 0.064132).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.214134216308594
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0373572  Vali Loss: 0.0735194 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9756409  Vali macro F1 0.9687522 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.20728611946106
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0422749  Vali Loss: 0.0662267 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817978  Vali macro F1 0.9693954 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.213245391845703
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0320961  Vali Loss: 0.0835411 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9760031  Vali macro F1 0.9657087 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.22195291519165
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0293071  Vali Loss: 0.0783392 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9763880  Vali macro F1 0.9645651 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.214332103729248
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0320653  Vali Loss: 0.0617693 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9834171  Vali macro F1 0.9772462 
new best score!!!!
Validation loss decreased (0.064132 --> 0.061769).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.21269965171814
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0299351  Vali Loss: 0.0700544 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9799731  Vali macro F1 0.9703365 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.225595951080322
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0244425  Vali Loss: 0.0807062 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766553  Vali macro F1 0.9655178 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.220739841461182
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0305125  Vali Loss: 0.0961066 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9727536  Vali macro F1 0.9625771 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.208107948303223
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0301405  Vali Loss: 0.0782155 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797984  Vali macro F1 0.9706788 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.211707592010498
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0209389  Vali Loss: 0.0630706 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817423  Vali macro F1 0.9748377 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 6.205928802490234
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0155586  Vali Loss: 0.0610969 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9813025  Vali macro F1 0.9719148 
new best score!!!!
Validation loss decreased (0.061769 --> 0.061097).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.217066049575806
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0135183  Vali Loss: 0.0593780 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843699  Vali macro F1 0.9761047 
new best score!!!!
Validation loss decreased (0.061097 --> 0.059378).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.223358869552612
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0115482  Vali Loss: 0.0589171 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848406  Vali macro F1 0.9765717 
new best score!!!!
Validation loss decreased (0.059378 --> 0.058917).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.228529453277588
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0122245  Vali Loss: 0.0593326 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843361  Vali macro F1 0.9757344 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.209667682647705
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0112773  Vali Loss: 0.0579643 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848703  Vali macro F1 0.9769406 
new best score!!!!
Validation loss decreased (0.058917 --> 0.057964).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.2286036014556885
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0110774  Vali Loss: 0.0566786 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853584  Vali macro F1 0.9777341 
new best score!!!!
Validation loss decreased (0.057964 --> 0.056679).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.217357158660889
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0113269  Vali Loss: 0.0570865 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853588  Vali macro F1 0.9779889 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.210385084152222
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0099442  Vali Loss: 0.0580314 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848737  Vali macro F1 0.9771901 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.211686611175537
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0105669  Vali Loss: 0.0586438 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853588  Vali macro F1 0.9779889 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.235651731491089
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0100672  Vali Loss: 0.0572853 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853482  Vali macro F1 0.9776624 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.218193531036377
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0100850  Vali Loss: 0.0586976 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863541  Vali macro F1 0.9790726 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.22166109085083
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0099023  Vali Loss: 0.0579367 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858516  Vali macro F1 0.9784926 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.212115049362183
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0092919  Vali Loss: 0.0578698 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858516  Vali macro F1 0.9784926 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.230536699295044
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0099923  Vali Loss: 0.0582508 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858516  Vali macro F1 0.9784926 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.210801601409912
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0095497  Vali Loss: 0.0570652 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853469  Vali macro F1 0.9776976 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.216173410415649
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0095827  Vali Loss: 0.0574706 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848471  Vali macro F1 0.9771223 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.224413156509399
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0095838  Vali Loss: 0.0575223 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848471  Vali macro F1 0.9771223 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.219103574752808
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0093965  Vali Loss: 0.0575167 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848471  Vali macro F1 0.9771223 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.213548898696899
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0092801  Vali Loss: 0.0574856 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848471  Vali macro F1 0.9771223 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.210510969161987
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0088001  Vali Loss: 0.0574550 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848471  Vali macro F1 0.9771223 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.2196433544158936
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0097855  Vali Loss: 0.0574734 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848471  Vali macro F1 0.9771223 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9196543  Test weighted F1: 0.9181156  Test macro F1 0.9247594 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.2260918617248535
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0114436  Vali Loss: 0.0613881 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848471  Vali macro F1 0.9771223 
Validation loss decreased (inf --> 0.061388).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.207272291183472
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0112835  Vali Loss: 0.0632071 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853743  Vali macro F1 0.9777670 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.208760499954224
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0108362  Vali Loss: 0.0648166 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853537  Vali macro F1 0.9773227 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.18865442276001
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0103377  Vali Loss: 0.0598958 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843718  Vali macro F1 0.9766972 
new best score!!!!
Validation loss decreased (0.061388 --> 0.059896).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.199077606201172
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0103775  Vali Loss: 0.0600889 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858672  Vali macro F1 0.9782383 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.199869155883789
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0094573  Vali Loss: 0.0599150 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843438  Vali macro F1 0.9763298 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.191356897354126
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0101605  Vali Loss: 0.0603735 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843702  Vali macro F1 0.9763556 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.192889928817749
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0093852  Vali Loss: 0.0577320 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848306  Vali macro F1 0.9770933 
new best score!!!!
Validation loss decreased (0.059896 --> 0.057732).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.221128940582275
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0082603  Vali Loss: 0.0566022 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843183  Vali macro F1 0.9767818 
new best score!!!!
Validation loss decreased (0.057732 --> 0.056602).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.194523096084595
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0097663  Vali Loss: 0.0552343 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863541  Vali macro F1 0.9790726 
new best score!!!!
Validation loss decreased (0.056602 --> 0.055234).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.205173015594482
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0106061  Vali Loss: 0.0648040 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848611  Vali macro F1 0.9765636 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.190259695053101
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0098150  Vali Loss: 0.0612433 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853048  Vali macro F1 0.9772052 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.197331666946411
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0085337  Vali Loss: 0.0556759 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878712  Vali macro F1 0.9809533 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.194329023361206
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0076022  Vali Loss: 0.0622034 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858560  Vali macro F1 0.9779013 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.228329658508301
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0081415  Vali Loss: 0.0584315 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883777  Vali macro F1 0.9812329 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 6.189079284667969
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0075153  Vali Loss: 0.0632181 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853501  Vali macro F1 0.9767760 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.199691295623779
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0068036  Vali Loss: 0.0603780 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868687  Vali macro F1 0.9794304 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.202980995178223
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0081752  Vali Loss: 0.0694976 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838995  Vali macro F1 0.9756763 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.199584722518921
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0076043  Vali Loss: 0.0656279 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848237  Vali macro F1 0.9772663 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.203222036361694
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0088428  Vali Loss: 0.0616565 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848246  Vali macro F1 0.9771097 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.2096266746521
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0067721  Vali Loss: 0.0597140 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853084  Vali macro F1 0.9775712 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.2275543212890625
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0071094  Vali Loss: 0.0606916 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863451  Vali macro F1 0.9789976 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.203234434127808
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0064019  Vali Loss: 0.0603455 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868776  Vali macro F1 0.9793484 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.199450492858887
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0057585  Vali Loss: 0.0596489 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863607  Vali macro F1 0.9787433 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.211261987686157
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0061414  Vali Loss: 0.0598226 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868642  Vali macro F1 0.9795736 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9149660  Test weighted F1: 0.9133548  Test macro F1 0.9216238 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014215 0.00017848 0.00096525 0.00123916 0.0004771  0.00060096]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.404852390289307
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.0818581  Vali Loss: 0.6359761 Vali Accuracy: 0.7538234  Vali weighted F1: 0.6918662  Vali macro F1 0.4698970 
Validation loss decreased (inf --> 0.635976).  Saving model ...
Epoch: 2 cost time: 6.399675369262695
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.5186237  Vali Loss: 0.3934437 Vali Accuracy: 0.8667982  Vali weighted F1: 0.8546494  Vali macro F1 0.8141314 
new best score!!!!
Validation loss decreased (0.635976 --> 0.393444).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.380964517593384
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3725777  Vali Loss: 0.2779685 Vali Accuracy: 0.9082388  Vali weighted F1: 0.9056759  Vali macro F1 0.8798112 
new best score!!!!
Validation loss decreased (0.393444 --> 0.277969).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.383488655090332
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2726177  Vali Loss: 0.2120510 Vali Accuracy: 0.9309324  Vali weighted F1: 0.9298623  Vali macro F1 0.9049673 
new best score!!!!
Validation loss decreased (0.277969 --> 0.212051).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.407801151275635
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2195605  Vali Loss: 0.1712757 Vali Accuracy: 0.9432659  Vali weighted F1: 0.9442683  Vali macro F1 0.9221633 
new best score!!!!
Validation loss decreased (0.212051 --> 0.171276).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.389300346374512
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1838570  Vali Loss: 0.1595670 Vali Accuracy: 0.9447459  Vali weighted F1: 0.9457563  Vali macro F1 0.9267548 
new best score!!!!
Validation loss decreased (0.171276 --> 0.159567).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.398048639297485
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1656135  Vali Loss: 0.1258902 Vali Accuracy: 0.9570794  Vali weighted F1: 0.9574199  Vali macro F1 0.9380365 
new best score!!!!
Validation loss decreased (0.159567 --> 0.125890).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.421905755996704
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1353163  Vali Loss: 0.1126467 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9625776  Vali macro F1 0.9475629 
new best score!!!!
Validation loss decreased (0.125890 --> 0.112647).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.395325422286987
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1314474  Vali Loss: 0.1261882 Vali Accuracy: 0.9575728  Vali weighted F1: 0.9581479  Vali macro F1 0.9382717 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.399066209793091
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1149331  Vali Loss: 0.1118081 Vali Accuracy: 0.9674396  Vali weighted F1: 0.9671924  Vali macro F1 0.9567405 
new best score!!!!
Validation loss decreased (0.112647 --> 0.111808).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.393460512161255
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1013244  Vali Loss: 0.0986808 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9706415  Vali macro F1 0.9587407 
new best score!!!!
Validation loss decreased (0.111808 --> 0.098681).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.3926825523376465
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0951302  Vali Loss: 0.0925740 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9736310  Vali macro F1 0.9638728 
new best score!!!!
Validation loss decreased (0.098681 --> 0.092574).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.392046213150024
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0908353  Vali Loss: 0.0860974 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9704989  Vali macro F1 0.9607537 
new best score!!!!
Validation loss decreased (0.092574 --> 0.086097).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.424391746520996
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0860854  Vali Loss: 0.0953344 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9726881  Vali macro F1 0.9631633 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.411987066268921
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0875498  Vali Loss: 0.0988793 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9694679  Vali macro F1 0.9583644 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.409597635269165
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0772961  Vali Loss: 0.0788882 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9754322  Vali macro F1 0.9655027 
new best score!!!!
Validation loss decreased (0.086097 --> 0.078888).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.398484945297241
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0692782  Vali Loss: 0.0796079 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9754677  Vali macro F1 0.9648742 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.396768093109131
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0696696  Vali Loss: 0.0863194 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9694005  Vali macro F1 0.9549168 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.389176607131958
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0664229  Vali Loss: 0.0809151 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9756857  Vali macro F1 0.9654715 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.3970606327056885
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0625967  Vali Loss: 0.0925874 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9674896  Vali macro F1 0.9541899 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 6.423396110534668
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0634454  Vali Loss: 0.1039762 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9646092  Vali macro F1 0.9510903 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 6.4185051918029785
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0496177  Vali Loss: 0.0645066 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798444  Vali macro F1 0.9711974 
new best score!!!!
Validation loss decreased (0.078888 --> 0.064507).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.411320209503174
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0443258  Vali Loss: 0.0638139 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793780  Vali macro F1 0.9707793 
new best score!!!!
Validation loss decreased (0.064507 --> 0.063814).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.400939464569092
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0435277  Vali Loss: 0.0626322 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793737  Vali macro F1 0.9707568 
new best score!!!!
Validation loss decreased (0.063814 --> 0.062632).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.4100236892700195
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0427675  Vali Loss: 0.0632835 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798667  Vali macro F1 0.9715998 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.4035303592681885
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0394516  Vali Loss: 0.0618340 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798026  Vali macro F1 0.9716286 
new best score!!!!
Validation loss decreased (0.062632 --> 0.061834).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.397996187210083
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0402274  Vali Loss: 0.0637916 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788792  Vali macro F1 0.9704136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.426553249359131
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0388230  Vali Loss: 0.0627178 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793555  Vali macro F1 0.9709511 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.4177329540252686
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0384886  Vali Loss: 0.0622203 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803542  Vali macro F1 0.9723164 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.402048587799072
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0398884  Vali Loss: 0.0637123 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9784597  Vali macro F1 0.9703526 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.397932529449463
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0377089  Vali Loss: 0.0616624 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803333  Vali macro F1 0.9725931 
new best score!!!!
Validation loss decreased (0.061834 --> 0.061662).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.3922669887542725
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0388026  Vali Loss: 0.0623577 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798662  Vali macro F1 0.9721897 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.392449140548706
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0361804  Vali Loss: 0.0644016 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807714  Vali macro F1 0.9732985 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.394456624984741
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0352020  Vali Loss: 0.0618689 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798572  Vali macro F1 0.9714083 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.417127847671509
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0356601  Vali Loss: 0.0618794 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812879  Vali macro F1 0.9736648 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.410467624664307
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0356226  Vali Loss: 0.0622469 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793934  Vali macro F1 0.9711296 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 6.399190902709961
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0320495  Vali Loss: 0.0613783 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798773  Vali macro F1 0.9717219 
new best score!!!!
Validation loss decreased (0.061662 --> 0.061378).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.390583515167236
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0350277  Vali Loss: 0.0617252 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793720  Vali macro F1 0.9712276 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.3976240158081055
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0332044  Vali Loss: 0.0617597 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9789083  Vali macro F1 0.9703155 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.3995747566223145
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0325141  Vali Loss: 0.0615438 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9789083  Vali macro F1 0.9703155 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.400729656219482
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0334601  Vali Loss: 0.0611741 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798580  Vali macro F1 0.9713517 
new best score!!!!
Validation loss decreased (0.061378 --> 0.061174).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.416851758956909
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0331745  Vali Loss: 0.0616286 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793526  Vali macro F1 0.9708574 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.4094202518463135
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0335474  Vali Loss: 0.0612367 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798767  Vali macro F1 0.9716320 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.396150827407837
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0320467  Vali Loss: 0.0614490 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803522  Vali macro F1 0.9721958 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.3999433517456055
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0331339  Vali Loss: 0.0615552 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.401860952377319
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0318358  Vali Loss: 0.0614893 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 6.39691162109375
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0315728  Vali Loss: 0.0614200 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.400510787963867
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0325875  Vali Loss: 0.0613836 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.418314456939697
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0330971  Vali Loss: 0.0613734 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.403388023376465
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0321381  Vali Loss: 0.0614011 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.406661510467529
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0329890  Vali Loss: 0.0613210 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 52 cost time: 6.401952028274536
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0318485  Vali Loss: 0.0613201 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.400440692901611
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0324507  Vali Loss: 0.0613233 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.3963518142700195
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0336403  Vali Loss: 0.0613120 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.412185430526733
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0334286  Vali Loss: 0.0613029 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.40423583984375
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0312972  Vali Loss: 0.0613018 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8572137  Test weighted F1: 0.8470586  Test macro F1 0.6288325 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.419417858123779
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0351882  Vali Loss: 0.0614840 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798879  Vali macro F1 0.9714286 
Validation loss decreased (inf --> 0.061484).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.388842582702637
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0329027  Vali Loss: 0.0642084 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9794267  Vali macro F1 0.9714927 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.379881858825684
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0347437  Vali Loss: 0.0617903 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803607  Vali macro F1 0.9729567 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.381254196166992
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0331407  Vali Loss: 0.0612833 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808459  Vali macro F1 0.9730385 
new best score!!!!
Validation loss decreased (0.061484 --> 0.061283).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.3983986377716064
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0305197  Vali Loss: 0.0623800 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808402  Vali macro F1 0.9728084 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.417304039001465
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0302533  Vali Loss: 0.0646990 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9774965  Vali macro F1 0.9690450 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.4121294021606445
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0328030  Vali Loss: 0.0636533 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813302  Vali macro F1 0.9735127 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.397702217102051
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0326193  Vali Loss: 0.0648470 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818489  Vali macro F1 0.9741869 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.390136241912842
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0295171  Vali Loss: 0.0634452 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9774552  Vali macro F1 0.9688746 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.385493040084839
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0311388  Vali Loss: 0.0649212 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9784489  Vali macro F1 0.9705729 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.401324272155762
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0283619  Vali Loss: 0.0659256 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822859  Vali macro F1 0.9752902 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.517317771911621
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0299261  Vali Loss: 0.0624389 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9794402  Vali macro F1 0.9715727 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.434734106063843
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0292522  Vali Loss: 0.0655605 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808050  Vali macro F1 0.9733385 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.426577568054199
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0290275  Vali Loss: 0.0620358 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9784534  Vali macro F1 0.9702996 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.535019159317017
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0256264  Vali Loss: 0.0613605 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793885  Vali macro F1 0.9715332 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.357956409454346
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0267685  Vali Loss: 0.0615806 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798641  Vali macro F1 0.9720971 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.362763166427612
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0253231  Vali Loss: 0.0621937 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793579  Vali macro F1 0.9716012 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.355919361114502
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0251599  Vali Loss: 0.0617472 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793579  Vali macro F1 0.9716012 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.3798558712005615
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0250663  Vali Loss: 0.0613931 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798469  Vali macro F1 0.9724217 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8577100  Test weighted F1: 0.8464204  Test macro F1 0.6263492 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0001451  0.00016764 0.0010142  0.00132979 0.00050327 0.00062933]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.3197925090789795
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0906585  Vali Loss: 0.7069354 Vali Accuracy: 0.7875186  Vali weighted F1: 0.7461010  Vali macro F1 0.6601316 
Validation loss decreased (inf --> 0.706935).  Saving model ...
Epoch: 2 cost time: 6.695677042007446
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5278907  Vali Loss: 0.4586152 Vali Accuracy: 0.8365527  Vali weighted F1: 0.8157412  Vali macro F1 0.7612676 
new best score!!!!
Validation loss decreased (0.706935 --> 0.458615).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.329263925552368
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3772837  Vali Loss: 0.3224914 Vali Accuracy: 0.8880634  Vali weighted F1: 0.8844234  Vali macro F1 0.8427493 
new best score!!!!
Validation loss decreased (0.458615 --> 0.322491).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.326005697250366
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3070230  Vali Loss: 0.2605323 Vali Accuracy: 0.9068846  Vali weighted F1: 0.9065519  Vali macro F1 0.8714965 
new best score!!!!
Validation loss decreased (0.322491 --> 0.260532).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.332926988601685
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2437684  Vali Loss: 0.2003583 Vali Accuracy: 0.9326399  Vali weighted F1: 0.9312929  Vali macro F1 0.9033567 
new best score!!!!
Validation loss decreased (0.260532 --> 0.200358).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.349770545959473
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1876219  Vali Loss: 0.1868645 Vali Accuracy: 0.9336305  Vali weighted F1: 0.9332254  Vali macro F1 0.9064006 
new best score!!!!
Validation loss decreased (0.200358 --> 0.186865).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.358880996704102
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1657924  Vali Loss: 0.1515035 Vali Accuracy: 0.9455176  Vali weighted F1: 0.9455575  Vali macro F1 0.9230900 
new best score!!!!
Validation loss decreased (0.186865 --> 0.151504).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.326241731643677
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1604913  Vali Loss: 0.1687721 Vali Accuracy: 0.9405646  Vali weighted F1: 0.9413305  Vali macro F1 0.9162545 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.332098007202148
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1375599  Vali Loss: 0.1525269 Vali Accuracy: 0.9440317  Vali weighted F1: 0.9432431  Vali macro F1 0.9194714 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 10 cost time: 6.328420162200928
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1240619  Vali Loss: 0.1152028 Vali Accuracy: 0.9554235  Vali weighted F1: 0.9555305  Vali macro F1 0.9338485 
new best score!!!!
Validation loss decreased (0.151504 --> 0.115203).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.326232194900513
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1257604  Vali Loss: 0.1267566 Vali Accuracy: 0.9569094  Vali weighted F1: 0.9563486  Vali macro F1 0.9362372 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.332391262054443
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1069857  Vali Loss: 0.1065473 Vali Accuracy: 0.9608717  Vali weighted F1: 0.9612661  Vali macro F1 0.9401632 
new best score!!!!
Validation loss decreased (0.115203 --> 0.106547).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.334629535675049
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1052993  Vali Loss: 0.1004861 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9614571  Vali macro F1 0.9423700 
new best score!!!!
Validation loss decreased (0.106547 --> 0.100486).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.328575849533081
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0969029  Vali Loss: 0.1156895 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9590920  Vali macro F1 0.9379242 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.328791618347168
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0869853  Vali Loss: 0.1104090 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9648090  Vali macro F1 0.9440977 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.329026222229004
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0841185  Vali Loss: 0.0897642 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9716731  Vali macro F1 0.9550574 
new best score!!!!
Validation loss decreased (0.100486 --> 0.089764).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.332315683364868
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0771850  Vali Loss: 0.0997826 Vali Accuracy: 0.9638435  Vali weighted F1: 0.9646282  Vali macro F1 0.9467002 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.328272581100464
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0741297  Vali Loss: 0.0904070 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9661323  Vali macro F1 0.9476172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.340251207351685
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0719276  Vali Loss: 0.1051020 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9709627  Vali macro F1 0.9634759 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.339616298675537
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0692961  Vali Loss: 0.0796897 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9687316  Vali macro F1 0.9414858 
new best score!!!!
Validation loss decreased (0.089764 --> 0.079690).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.337371587753296
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0651818  Vali Loss: 0.0749930 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9780244  Vali macro F1 0.9679375 
new best score!!!!
Validation loss decreased (0.079690 --> 0.074993).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.333909511566162
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0650710  Vali Loss: 0.0850938 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9713991  Vali macro F1 0.9625698 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.334949731826782
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0610965  Vali Loss: 0.0712870 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9791392  Vali macro F1 0.9703997 
new best score!!!!
Validation loss decreased (0.074993 --> 0.071287).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.335148334503174
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0485830  Vali Loss: 0.0670528 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9776690  Vali macro F1 0.9693846 
new best score!!!!
Validation loss decreased (0.071287 --> 0.067053).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.338248014450073
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0497083  Vali Loss: 0.0529042 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9809409  Vali macro F1 0.9716671 
new best score!!!!
Validation loss decreased (0.067053 --> 0.052904).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.362046003341675
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0445003  Vali Loss: 0.0503900 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832287  Vali macro F1 0.9766337 
new best score!!!!
Validation loss decreased (0.052904 --> 0.050390).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.330760478973389
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0449761  Vali Loss: 0.0646954 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9785057  Vali macro F1 0.9667685 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.3278892040252686
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0580191  Vali Loss: 0.0659839 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789427  Vali macro F1 0.9711631 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.328423738479614
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0403923  Vali Loss: 0.0583955 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9806814  Vali macro F1 0.9720581 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.339771032333374
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0344760  Vali Loss: 0.0548815 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821950  Vali macro F1 0.9738005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.3361594676971436
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0306978  Vali Loss: 0.0813169 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9727850  Vali macro F1 0.9625885 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.34067702293396
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0253483  Vali Loss: 0.0500800 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817883  Vali macro F1 0.9746497 
new best score!!!!
Validation loss decreased (0.050390 --> 0.050080).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.337402582168579
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0205452  Vali Loss: 0.0487485 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817581  Vali macro F1 0.9748384 
new best score!!!!
Validation loss decreased (0.050080 --> 0.048749).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.333034992218018
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0210768  Vali Loss: 0.0478616 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837958  Vali macro F1 0.9773926 
new best score!!!!
Validation loss decreased (0.048749 --> 0.047862).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.335546016693115
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0200731  Vali Loss: 0.0458520 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9862200  Vali macro F1 0.9802502 
new best score!!!!
Validation loss decreased (0.047862 --> 0.045852).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.331026792526245
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0190947  Vali Loss: 0.0479358 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857878  Vali macro F1 0.9794314 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.33674168586731
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0184048  Vali Loss: 0.0456671 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832174  Vali macro F1 0.9766910 
new best score!!!!
Validation loss decreased (0.045852 --> 0.045667).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.337508201599121
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0196900  Vali Loss: 0.0442258 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867257  Vali macro F1 0.9804980 
new best score!!!!
Validation loss decreased (0.045667 --> 0.044226).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.3378424644470215
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0181043  Vali Loss: 0.0445194 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857230  Vali macro F1 0.9795534 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.353342533111572
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0174118  Vali Loss: 0.0430872 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876911  Vali macro F1 0.9824713 
new best score!!!!
Validation loss decreased (0.044226 --> 0.043087).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.3293609619140625
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0171614  Vali Loss: 0.0444613 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867198  Vali macro F1 0.9804919 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.324674844741821
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0167992  Vali Loss: 0.0445965 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857211  Vali macro F1 0.9796027 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.32609224319458
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0172617  Vali Loss: 0.0442215 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877142  Vali macro F1 0.9815819 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.3385233879089355
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0173031  Vali Loss: 0.0440250 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872095  Vali macro F1 0.9816633 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.328464508056641
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0168084  Vali Loss: 0.0450534 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9847223  Vali macro F1 0.9789463 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 6.348766803741455
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0173919  Vali Loss: 0.0449517 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9852175  Vali macro F1 0.9790459 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.3274688720703125
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0157936  Vali Loss: 0.0444878 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9862207  Vali macro F1 0.9797964 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.323170900344849
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0156915  Vali Loss: 0.0445614 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857229  Vali macro F1 0.9795210 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.322267770767212
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0154501  Vali Loss: 0.0442759 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9852175  Vali macro F1 0.9790459 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.327887773513794
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0164992  Vali Loss: 0.0441356 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872121  Vali macro F1 0.9811116 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 6.336986064910889
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0156049  Vali Loss: 0.0441356 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872121  Vali macro F1 0.9811116 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.331088066101074
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0159337  Vali Loss: 0.0441544 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872121  Vali macro F1 0.9811116 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.346614599227905
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0148003  Vali Loss: 0.0441245 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867259  Vali macro F1 0.9803027 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.321305274963379
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0144338  Vali Loss: 0.0441822 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867259  Vali macro F1 0.9803027 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.323418140411377
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0160836  Vali Loss: 0.0441477 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867259  Vali macro F1 0.9803027 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7543195  Test weighted F1: 0.7577791  Test macro F1 0.7412553 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.379135847091675
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0185997  Vali Loss: 0.0463900 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867381  Vali macro F1 0.9805833 
Validation loss decreased (inf --> 0.046390).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.36490273475647
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0173335  Vali Loss: 0.0464575 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857342  Vali macro F1 0.9797034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.358227968215942
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0182349  Vali Loss: 0.0437995 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877081  Vali macro F1 0.9819392 
new best score!!!!
Validation loss decreased (0.046390 --> 0.043799).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.388825178146362
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0173141  Vali Loss: 0.0412587 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872004  Vali macro F1 0.9816780 
new best score!!!!
Validation loss decreased (0.043799 --> 0.041259).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.373536825180054
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0164882  Vali Loss: 0.0429797 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851867  Vali macro F1 0.9793263 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.374804735183716
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0177030  Vali Loss: 0.0455987 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9852480  Vali macro F1 0.9781806 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.366678237915039
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0158196  Vali Loss: 0.0447612 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871982  Vali macro F1 0.9811642 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.368623733520508
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0158336  Vali Loss: 0.0437034 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9862061  Vali macro F1 0.9807241 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.3663341999053955
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0147460  Vali Loss: 0.0458505 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9852035  Vali macro F1 0.9789892 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.360142469406128
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0142172  Vali Loss: 0.0463425 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872061  Vali macro F1 0.9814376 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.402084827423096
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0131950  Vali Loss: 0.0465205 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857313  Vali macro F1 0.9795593 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.372907876968384
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0145117  Vali Loss: 0.0473597 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857411  Vali macro F1 0.9798372 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.375354766845703
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0149635  Vali Loss: 0.0461150 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867114  Vali macro F1 0.9814525 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.352311372756958
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0138553  Vali Loss: 0.0459469 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857013  Vali macro F1 0.9802404 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.354456663131714
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0124617  Vali Loss: 0.0442488 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857281  Vali macro F1 0.9799532 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.361107110977173
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0133372  Vali Loss: 0.0437007 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9852419  Vali macro F1 0.9791437 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.385080575942993
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0129291  Vali Loss: 0.0436132 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866937  Vali macro F1 0.9815363 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.377835035324097
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0133016  Vali Loss: 0.0434488 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9862223  Vali macro F1 0.9804174 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.368076801300049
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0123058  Vali Loss: 0.0428286 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9862259  Vali macro F1 0.9801639 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7668639  Test weighted F1: 0.7690525  Test macro F1 0.7491888 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014648 0.00017775 0.00108932 0.00131579 0.00049628 0.00062933]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.186664342880249
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0940605  Vali Loss: 0.7057108 Vali Accuracy: 0.7549467  Vali weighted F1: 0.6780943  Vali macro F1 0.4555910 
Validation loss decreased (inf --> 0.705711).  Saving model ...
Epoch: 2 cost time: 6.186461448669434
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5620542  Vali Loss: 0.4787113 Vali Accuracy: 0.8340944  Vali weighted F1: 0.8194279  Vali macro F1 0.7679190 
new best score!!!!
Validation loss decreased (0.705711 --> 0.478711).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.177867412567139
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4021480  Vali Loss: 0.3475910 Vali Accuracy: 0.8843227  Vali weighted F1: 0.8780423  Vali macro F1 0.8502410 
new best score!!!!
Validation loss decreased (0.478711 --> 0.347591).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.214086294174194
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3013930  Vali Loss: 0.2707583 Vali Accuracy: 0.9162861  Vali weighted F1: 0.9141310  Vali macro F1 0.8900653 
new best score!!!!
Validation loss decreased (0.347591 --> 0.270758).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.2100536823272705
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2328030  Vali Loss: 0.2366258 Vali Accuracy: 0.9208524  Vali weighted F1: 0.9222041  Vali macro F1 0.8942681 
new best score!!!!
Validation loss decreased (0.270758 --> 0.236626).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.2216973304748535
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2014960  Vali Loss: 0.1898465 Vali Accuracy: 0.9406393  Vali weighted F1: 0.9400842  Vali macro F1 0.9211658 
new best score!!!!
Validation loss decreased (0.236626 --> 0.189846).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.224486827850342
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1752263  Vali Loss: 0.2014639 Vali Accuracy: 0.9269406  Vali weighted F1: 0.9274628  Vali macro F1 0.9001604 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.233692646026611
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1576900  Vali Loss: 0.1552454 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9501750  Vali macro F1 0.9370550 
new best score!!!!
Validation loss decreased (0.189846 --> 0.155245).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.230162143707275
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1410600  Vali Loss: 0.1433148 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9567964  Vali macro F1 0.9401600 
new best score!!!!
Validation loss decreased (0.155245 --> 0.143315).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.241877555847168
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1244349  Vali Loss: 0.1138329 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9619962  Vali macro F1 0.9483223 
new best score!!!!
Validation loss decreased (0.143315 --> 0.113833).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.242257595062256
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1156637  Vali Loss: 0.1058159 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9650021  Vali macro F1 0.9522028 
new best score!!!!
Validation loss decreased (0.113833 --> 0.105816).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.22162389755249
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1094573  Vali Loss: 0.1136356 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9628058  Vali macro F1 0.9502138 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.225420951843262
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1011571  Vali Loss: 0.0958513 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9674370  Vali macro F1 0.9570464 
new best score!!!!
Validation loss decreased (0.105816 --> 0.095851).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.284747838973999
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0889366  Vali Loss: 0.0917225 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9688786  Vali macro F1 0.9526470 
new best score!!!!
Validation loss decreased (0.095851 --> 0.091722).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.272304534912109
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0847850  Vali Loss: 0.0947121 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9677619  Vali macro F1 0.9565942 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.2717976570129395
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0832018  Vali Loss: 0.1035267 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9650675  Vali macro F1 0.9539702 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.279095649719238
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0777691  Vali Loss: 0.0962415 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9677626  Vali macro F1 0.9577321 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.254112005233765
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0789789  Vali Loss: 0.0838286 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9748087  Vali macro F1 0.9622538 
new best score!!!!
Validation loss decreased (0.091722 --> 0.083829).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.259027719497681
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0681333  Vali Loss: 0.1020991 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9666358  Vali macro F1 0.9532774 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.248605728149414
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0703674  Vali Loss: 0.0755088 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772146  Vali macro F1 0.9612785 
new best score!!!!
Validation loss decreased (0.083829 --> 0.075509).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.244829177856445
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0637925  Vali Loss: 0.1117861 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9650466  Vali macro F1 0.9525064 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.26289701461792
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0627565  Vali Loss: 0.0779749 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9750291  Vali macro F1 0.9639329 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.282770872116089
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0524866  Vali Loss: 0.0681946 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796837  Vali macro F1 0.9694222 
new best score!!!!
Validation loss decreased (0.075509 --> 0.068195).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.25928807258606
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0593373  Vali Loss: 0.0747403 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778401  Vali macro F1 0.9680014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.255106687545776
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0556291  Vali Loss: 0.0770843 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766241  Vali macro F1 0.9646886 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.2607786655426025
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0482276  Vali Loss: 0.0745172 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776028  Vali macro F1 0.9662200 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.276473522186279
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0480482  Vali Loss: 0.0678562 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792134  Vali macro F1 0.9684066 
new best score!!!!
Validation loss decreased (0.068195 --> 0.067856).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.223501920700073
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0441131  Vali Loss: 0.0616240 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802084  Vali macro F1 0.9703353 
new best score!!!!
Validation loss decreased (0.067856 --> 0.061624).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.169113397598267
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0488505  Vali Loss: 0.0747514 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9773237  Vali macro F1 0.9680127 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.172263145446777
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0390324  Vali Loss: 0.0657222 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801301  Vali macro F1 0.9695418 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.179803371429443
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0496706  Vali Loss: 0.1050545 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9690609  Vali macro F1 0.9598234 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.185378789901733
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0385668  Vali Loss: 0.0626875 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797663  Vali macro F1 0.9693467 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.170027017593384
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0385043  Vali Loss: 0.0644828 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822440  Vali macro F1 0.9723504 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 6.174642324447632
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0271512  Vali Loss: 0.0593002 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832661  Vali macro F1 0.9737557 
new best score!!!!
Validation loss decreased (0.061624 --> 0.059300).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.184710741043091
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0232589  Vali Loss: 0.0578985 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837722  Vali macro F1 0.9745586 
new best score!!!!
Validation loss decreased (0.059300 --> 0.057898).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.190264940261841
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0237187  Vali Loss: 0.0585139 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837667  Vali macro F1 0.9746352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.212128639221191
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0218432  Vali Loss: 0.0590515 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822482  Vali macro F1 0.9727712 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.261083364486694
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0229040  Vali Loss: 0.0586531 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847608  Vali macro F1 0.9756524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.262063503265381
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0224024  Vali Loss: 0.0590498 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837515  Vali macro F1 0.9745178 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.252410650253296
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0205708  Vali Loss: 0.0599222 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827471  Vali macro F1 0.9736564 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 41 cost time: 6.236656188964844
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0206495  Vali Loss: 0.0581260 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837667  Vali macro F1 0.9746098 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.25313138961792
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0190457  Vali Loss: 0.0583988 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832456  Vali macro F1 0.9741152 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.259295225143433
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0207365  Vali Loss: 0.0573920 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832522  Vali macro F1 0.9740402 
new best score!!!!
Validation loss decreased (0.057898 --> 0.057392).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.319129467010498
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0200834  Vali Loss: 0.0571321 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837722  Vali macro F1 0.9745586 
new best score!!!!
Validation loss decreased (0.057392 --> 0.057132).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.285284996032715
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0205189  Vali Loss: 0.0575730 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832522  Vali macro F1 0.9740402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.241318225860596
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0214974  Vali Loss: 0.0573849 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832522  Vali macro F1 0.9740402 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.23260498046875
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0207377  Vali Loss: 0.0570131 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832736  Vali macro F1 0.9740739 
new best score!!!!
Validation loss decreased (0.057132 --> 0.057013).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.259364128112793
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0191587  Vali Loss: 0.0571419 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832736  Vali macro F1 0.9740739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.255208492279053
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0196639  Vali Loss: 0.0578587 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832522  Vali macro F1 0.9740402 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.254390478134155
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0203123  Vali Loss: 0.0570255 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832637  Vali macro F1 0.9755102 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.291874170303345
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0211414  Vali Loss: 0.0571648 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.25478196144104
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0202857  Vali Loss: 0.0578083 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 53 cost time: 6.24442720413208
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0191197  Vali Loss: 0.0577107 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.237031698226929
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0199911  Vali Loss: 0.0575975 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.233410596847534
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0204409  Vali Loss: 0.0575505 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.24415135383606
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0201418  Vali Loss: 0.0574882 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.240753889083862
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0195996  Vali Loss: 0.0574440 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 58 cost time: 6.2643141746521
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0193574  Vali Loss: 0.0574533 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.2481162548065186
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0200130  Vali Loss: 0.0574518 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.248724699020386
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0195287  Vali Loss: 0.0574546 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.252593278884888
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0200364  Vali Loss: 0.0574426 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.228182554244995
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0195521  Vali Loss: 0.0574455 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837622  Vali macro F1 0.9759948 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9248183  Test weighted F1: 0.9247550  Test macro F1 0.8637071 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.269471168518066
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0216103  Vali Loss: 0.0569064 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827486  Vali macro F1 0.9747789 
Validation loss decreased (inf --> 0.056906).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.270021915435791
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0226377  Vali Loss: 0.0586375 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853243  Vali macro F1 0.9773401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.263143062591553
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0198157  Vali Loss: 0.0554220 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843028  Vali macro F1 0.9765452 
new best score!!!!
Validation loss decreased (0.056906 --> 0.055422).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.252897024154663
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0204817  Vali Loss: 0.0564972 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853230  Vali macro F1 0.9779107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.259161472320557
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0194918  Vali Loss: 0.0619425 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827289  Vali macro F1 0.9741376 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.270005702972412
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0204605  Vali Loss: 0.0559420 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853047  Vali macro F1 0.9772953 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.278631687164307
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0188756  Vali Loss: 0.0595436 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837400  Vali macro F1 0.9753919 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.279013633728027
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0179114  Vali Loss: 0.0622198 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842397  Vali macro F1 0.9762782 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.302940607070923
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0178691  Vali Loss: 0.0587274 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838184  Vali macro F1 0.9753187 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.325253248214722
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0170326  Vali Loss: 0.0588303 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843086  Vali macro F1 0.9763599 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.3041887283325195
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0174795  Vali Loss: 0.0576150 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837623  Vali macro F1 0.9754015 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.279516935348511
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0174398  Vali Loss: 0.0578674 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832741  Vali macro F1 0.9752974 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.296979665756226
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0158407  Vali Loss: 0.0600723 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817261  Vali macro F1 0.9732356 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.271271467208862
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0163571  Vali Loss: 0.0595119 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827668  Vali macro F1 0.9744930 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.301179885864258
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0167761  Vali Loss: 0.0592184 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827668  Vali macro F1 0.9744930 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.319124698638916
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0160446  Vali Loss: 0.0588152 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827668  Vali macro F1 0.9744930 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.329246759414673
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0152642  Vali Loss: 0.0591461 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832741  Vali macro F1 0.9752974 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.345353126525879
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0151571  Vali Loss: 0.0594636 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822312  Vali macro F1 0.9742816 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9235300  Test weighted F1: 0.9236941  Test macro F1 0.8622536 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013931 0.00018355 0.00106724 0.00127551 0.00049116 0.00059347]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.4066972732543945
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0801375  Vali Loss: 0.6434479 Vali Accuracy: 0.7689243  Vali weighted F1: 0.7159497  Vali macro F1 0.4964213 
Validation loss decreased (inf --> 0.643448).  Saving model ...
Epoch: 2 cost time: 6.410799026489258
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5224520  Vali Loss: 0.4473383 Vali Accuracy: 0.8406375  Vali weighted F1: 0.8227637  Vali macro F1 0.7588080 
new best score!!!!
Validation loss decreased (0.643448 --> 0.447338).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.4203267097473145
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3850239  Vali Loss: 0.3422323 Vali Accuracy: 0.8759960  Vali weighted F1: 0.8673905  Vali macro F1 0.8170714 
new best score!!!!
Validation loss decreased (0.447338 --> 0.342232).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.431058883666992
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3148111  Vali Loss: 0.2718604 Vali Accuracy: 0.9073705  Vali weighted F1: 0.9035155  Vali macro F1 0.8652610 
new best score!!!!
Validation loss decreased (0.342232 --> 0.271860).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.436160087585449
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2423075  Vali Loss: 0.2299807 Vali Accuracy: 0.9213147  Vali weighted F1: 0.9190225  Vali macro F1 0.8865538 
new best score!!!!
Validation loss decreased (0.271860 --> 0.229981).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.422783851623535
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2086213  Vali Loss: 0.2013933 Vali Accuracy: 0.9297809  Vali weighted F1: 0.9277789  Vali macro F1 0.8975519 
new best score!!!!
Validation loss decreased (0.229981 --> 0.201393).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.405578136444092
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1807546  Vali Loss: 0.1955062 Vali Accuracy: 0.9312749  Vali weighted F1: 0.9297324  Vali macro F1 0.8974082 
new best score!!!!
Validation loss decreased (0.201393 --> 0.195506).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.410930156707764
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1636757  Vali Loss: 0.1683437 Vali Accuracy: 0.9432271  Vali weighted F1: 0.9437472  Vali macro F1 0.9109216 
new best score!!!!
Validation loss decreased (0.195506 --> 0.168344).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.455384254455566
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1506589  Vali Loss: 0.1513786 Vali Accuracy: 0.9467131  Vali weighted F1: 0.9471910  Vali macro F1 0.9189706 
new best score!!!!
Validation loss decreased (0.168344 --> 0.151379).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.425541639328003
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1331103  Vali Loss: 0.1477568 Vali Accuracy: 0.9477092  Vali weighted F1: 0.9462561  Vali macro F1 0.9258699 
new best score!!!!
Validation loss decreased (0.151379 --> 0.147757).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.465033531188965
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1186751  Vali Loss: 0.1422138 Vali Accuracy: 0.9511952  Vali weighted F1: 0.9517904  Vali macro F1 0.9385405 
new best score!!!!
Validation loss decreased (0.147757 --> 0.142214).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.439707279205322
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1127144  Vali Loss: 0.1191054 Vali Accuracy: 0.9591633  Vali weighted F1: 0.9595562  Vali macro F1 0.9451954 
new best score!!!!
Validation loss decreased (0.142214 --> 0.119105).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.414060831069946
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1015990  Vali Loss: 0.1052619 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9680964  Vali macro F1 0.9575135 
new best score!!!!
Validation loss decreased (0.119105 --> 0.105262).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.378582239151001
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0950029  Vali Loss: 0.0993807 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9651287  Vali macro F1 0.9506776 
new best score!!!!
Validation loss decreased (0.105262 --> 0.099381).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.3823933601379395
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0923926  Vali Loss: 0.0958620 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9686893  Vali macro F1 0.9574880 
new best score!!!!
Validation loss decreased (0.099381 --> 0.095862).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.350369215011597
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0846108  Vali Loss: 0.0899817 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9714128  Vali macro F1 0.9617712 
new best score!!!!
Validation loss decreased (0.095862 --> 0.089982).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.4111857414245605
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0808785  Vali Loss: 0.0859697 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9716888  Vali macro F1 0.9609641 
new best score!!!!
Validation loss decreased (0.089982 --> 0.085970).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.388616323471069
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0809978  Vali Loss: 0.1317631 Vali Accuracy: 0.9551793  Vali weighted F1: 0.9551088  Vali macro F1 0.9403830 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.364523410797119
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0744396  Vali Loss: 0.0867720 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702890  Vali macro F1 0.9589957 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.368889331817627
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0733919  Vali Loss: 0.0874343 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9709493  Vali macro F1 0.9594381 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.348731994628906
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0669406  Vali Loss: 0.0660342 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9766253  Vali macro F1 0.9684313 
new best score!!!!
Validation loss decreased (0.085970 --> 0.066034).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.355047225952148
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0583135  Vali Loss: 0.0670074 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9755549  Vali macro F1 0.9647025 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.3959245681762695
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0562007  Vali Loss: 0.1012900 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9655755  Vali macro F1 0.9464521 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.397603750228882
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0713074  Vali Loss: 0.0772032 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733050  Vali macro F1 0.9625157 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.373086214065552
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0523083  Vali Loss: 0.0719390 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9794950  Vali macro F1 0.9719546 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.361647367477417
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0461327  Vali Loss: 0.0763206 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9762126  Vali macro F1 0.9685691 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 6.363992214202881
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0379231  Vali Loss: 0.0577409 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9791788  Vali macro F1 0.9725113 
new best score!!!!
Validation loss decreased (0.066034 --> 0.057741).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.347435712814331
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0346835  Vali Loss: 0.0567506 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805971  Vali macro F1 0.9731588 
new best score!!!!
Validation loss decreased (0.057741 --> 0.056751).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.357313632965088
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0340578  Vali Loss: 0.0576064 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9791693  Vali macro F1 0.9723488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.364795207977295
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0323287  Vali Loss: 0.0575661 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805996  Vali macro F1 0.9739752 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.36996865272522
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0324601  Vali Loss: 0.0570172 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801331  Vali macro F1 0.9727638 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.3729376792907715
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0321870  Vali Loss: 0.0557007 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815186  Vali macro F1 0.9748878 
new best score!!!!
Validation loss decreased (0.056751 --> 0.055701).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.357602119445801
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0312258  Vali Loss: 0.0559111 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821309  Vali macro F1 0.9763629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.349183082580566
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0307517  Vali Loss: 0.0567299 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801222  Vali macro F1 0.9735038 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.351001024246216
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0303664  Vali Loss: 0.0563181 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810568  Vali macro F1 0.9742682 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.356108665466309
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0300445  Vali Loss: 0.0571329 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805668  Vali macro F1 0.9740879 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.362637281417847
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0293388  Vali Loss: 0.0555285 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815555  Vali macro F1 0.9750939 
new best score!!!!
Validation loss decreased (0.055701 --> 0.055528).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.364495277404785
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0293330  Vali Loss: 0.0551477 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9781891  Vali macro F1 0.9715522 
new best score!!!!
Validation loss decreased (0.055528 --> 0.055148).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.356621265411377
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0283257  Vali Loss: 0.0538987 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830836  Vali macro F1 0.9775081 
new best score!!!!
Validation loss decreased (0.055148 --> 0.053899).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.364360332489014
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0281100  Vali Loss: 0.0544615 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795986  Vali macro F1 0.9727503 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.361407995223999
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0284509  Vali Loss: 0.0534082 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820876  Vali macro F1 0.9752439 
new best score!!!!
Validation loss decreased (0.053899 --> 0.053408).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.360177278518677
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0294037  Vali Loss: 0.0553971 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820556  Vali macro F1 0.9755725 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.354062795639038
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0285751  Vali Loss: 0.0537823 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821238  Vali macro F1 0.9762112 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.378737449645996
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0276732  Vali Loss: 0.0535045 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800989  Vali macro F1 0.9742025 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.386081218719482
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0259708  Vali Loss: 0.0535354 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821001  Vali macro F1 0.9761554 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.370983123779297
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0258332  Vali Loss: 0.0536384 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816342  Vali macro F1 0.9748432 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.345589876174927
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0259102  Vali Loss: 0.0545826 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815922  Vali macro F1 0.9749811 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.3546223640441895
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0246514  Vali Loss: 0.0548042 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815922  Vali macro F1 0.9749811 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.3611085414886475
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0254511  Vali Loss: 0.0545136 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821213  Vali macro F1 0.9766731 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.36169171333313
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0243943  Vali Loss: 0.0537209 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830732  Vali macro F1 0.9775806 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.3811047077178955
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0247505  Vali Loss: 0.0532965 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830732  Vali macro F1 0.9775806 
new best score!!!!
Validation loss decreased (0.053408 --> 0.053296).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.372464895248413
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0240108  Vali Loss: 0.0537190 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830785  Vali macro F1 0.9771923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.367343187332153
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0243246  Vali Loss: 0.0539088 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825773  Vali macro F1 0.9763211 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.364195108413696
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0254361  Vali Loss: 0.0536542 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825727  Vali macro F1 0.9767113 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.346782207489014
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0237807  Vali Loss: 0.0531514 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840653  Vali macro F1 0.9786674 
new best score!!!!
Validation loss decreased (0.053296 --> 0.053151).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.34636664390564
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0250592  Vali Loss: 0.0541271 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825871  Vali macro F1 0.9771094 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.37260890007019
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0250371  Vali Loss: 0.0535402 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825575  Vali macro F1 0.9764456 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.3638756275177
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0269066  Vali Loss: 0.0546001 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820660  Vali macro F1 0.9762288 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.347588777542114
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0237725  Vali Loss: 0.0542915 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805801  Vali macro F1 0.9740182 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.360127687454224
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0243095  Vali Loss: 0.0538540 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820509  Vali macro F1 0.9759632 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.354538202285767
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0238025  Vali Loss: 0.0538361 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820509  Vali macro F1 0.9759632 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.356461048126221
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0238483  Vali Loss: 0.0539328 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820660  Vali macro F1 0.9762288 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.344818115234375
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0253199  Vali Loss: 0.0541423 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815809  Vali macro F1 0.9757591 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.3697190284729
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0239605  Vali Loss: 0.0540588 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825665  Vali macro F1 0.9770981 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.359398365020752
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0236254  Vali Loss: 0.0540540 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825665  Vali macro F1 0.9770981 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 66 cost time: 6.3515403270721436
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0244997  Vali Loss: 0.0540440 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825665  Vali macro F1 0.9770981 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.3526694774627686
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0244715  Vali Loss: 0.0540344 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825665  Vali macro F1 0.9770981 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.347621202468872
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0228764  Vali Loss: 0.0540226 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825665  Vali macro F1 0.9770981 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.344743967056274
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0234962  Vali Loss: 0.0540206 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825665  Vali macro F1 0.9770981 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.348913669586182
VALI: Epoch: 70, Steps: 71 | Train Loss: 0.0242897  Vali Loss: 0.0540200 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825665  Vali macro F1 0.9770981 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9127688  Test weighted F1: 0.9112986  Test macro F1 0.8488294 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.379479169845581
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0261919  Vali Loss: 0.0534625 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815920  Vali macro F1 0.9756956 
Validation loss decreased (inf --> 0.053463).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.351275444030762
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0239091  Vali Loss: 0.0587206 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9791734  Vali macro F1 0.9730739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.3461594581604
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0258514  Vali Loss: 0.0550314 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805131  Vali macro F1 0.9732690 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.347763538360596
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0252452  Vali Loss: 0.0540056 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810847  Vali macro F1 0.9748918 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.354599952697754
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0241185  Vali Loss: 0.0545293 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806135  Vali macro F1 0.9747323 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.3536152839660645
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0242665  Vali Loss: 0.0542386 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815819  Vali macro F1 0.9747414 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.385718822479248
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0248110  Vali Loss: 0.0547367 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810410  Vali macro F1 0.9731866 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.36845588684082
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0237056  Vali Loss: 0.0574036 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815879  Vali macro F1 0.9750820 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.357368230819702
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0237291  Vali Loss: 0.0536317 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810614  Vali macro F1 0.9734358 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.365052223205566
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0233064  Vali Loss: 0.0569990 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810587  Vali macro F1 0.9744132 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.35930609703064
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0220657  Vali Loss: 0.0531978 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820778  Vali macro F1 0.9758673 
new best score!!!!
Validation loss decreased (0.053463 --> 0.053198).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.361269474029541
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0206335  Vali Loss: 0.0529437 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820778  Vali macro F1 0.9758673 
new best score!!!!
Validation loss decreased (0.053198 --> 0.052944).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.375555753707886
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0212882  Vali Loss: 0.0528716 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
new best score!!!!
Validation loss decreased (0.052944 --> 0.052872).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.373410224914551
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0202050  Vali Loss: 0.0525735 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
new best score!!!!
Validation loss decreased (0.052872 --> 0.052574).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.3686323165893555
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0207602  Vali Loss: 0.0537465 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815865  Vali macro F1 0.9752375 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.368829727172852
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0200746  Vali Loss: 0.0533809 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820715  Vali macro F1 0.9758402 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.395572662353516
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0208441  Vali Loss: 0.0527623 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810910  Vali macro F1 0.9745495 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.371349096298218
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0202933  Vali Loss: 0.0534002 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.365149736404419
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0186418  Vali Loss: 0.0531213 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 6.386920928955078
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0201980  Vali Loss: 0.0529605 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.392752647399902
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0203798  Vali Loss: 0.0528157 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810910  Vali macro F1 0.9745495 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.384577989578247
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0212564  Vali Loss: 0.0529005 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.384691476821899
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0197551  Vali Loss: 0.0527702 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.382243633270264
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0201621  Vali Loss: 0.0527825 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 25 cost time: 6.374595403671265
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0220084  Vali Loss: 0.0527751 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.388854265213013
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0205690  Vali Loss: 0.0527783 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.396315097808838
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0196943  Vali Loss: 0.0527852 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810910  Vali macro F1 0.9745495 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.3805015087127686
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0204292  Vali Loss: 0.0527826 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.38055944442749
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0200515  Vali Loss: 0.0527865 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815768  Vali macro F1 0.9749965 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9134338  Test weighted F1: 0.9119813  Test macro F1 0.8495639 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 138143
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014674 0.00018002 0.00097466 0.00124224 0.00048757 0.00060643]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.284380674362183
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0640867  Vali Loss: 0.6366653 Vali Accuracy: 0.7395676  Vali weighted F1: 0.6833758  Vali macro F1 0.5109532 
Validation loss decreased (inf --> 0.636665).  Saving model ...
Epoch: 2 cost time: 6.264840364456177
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5471382  Vali Loss: 0.5167961 Vali Accuracy: 0.8019105  Vali weighted F1: 0.7875251  Vali macro F1 0.7374118 
new best score!!!!
Validation loss decreased (0.636665 --> 0.516796).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.274614095687866
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4402534  Vali Loss: 0.4045291 Vali Accuracy: 0.8386124  Vali weighted F1: 0.8254711  Vali macro F1 0.7743797 
new best score!!!!
Validation loss decreased (0.516796 --> 0.404529).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.28738808631897
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3284988  Vali Loss: 0.2914163 Vali Accuracy: 0.8883861  Vali weighted F1: 0.8889724  Vali macro F1 0.8486346 
new best score!!!!
Validation loss decreased (0.404529 --> 0.291416).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.296119689941406
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2377008  Vali Loss: 0.2120733 Vali Accuracy: 0.9276018  Vali weighted F1: 0.9268614  Vali macro F1 0.9001444 
new best score!!!!
Validation loss decreased (0.291416 --> 0.212073).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.287651062011719
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1956364  Vali Loss: 0.1728778 Vali Accuracy: 0.9401709  Vali weighted F1: 0.9396094  Vali macro F1 0.9224170 
new best score!!!!
Validation loss decreased (0.212073 --> 0.172878).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.277404308319092
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1696383  Vali Loss: 0.1562292 Vali Accuracy: 0.9457014  Vali weighted F1: 0.9455207  Vali macro F1 0.9274997 
new best score!!!!
Validation loss decreased (0.172878 --> 0.156229).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.293115139007568
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1515552  Vali Loss: 0.1483716 Vali Accuracy: 0.9527401  Vali weighted F1: 0.9530009  Vali macro F1 0.9357646 
new best score!!!!
Validation loss decreased (0.156229 --> 0.148372).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.271095514297485
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1371542  Vali Loss: 0.1485473 Vali Accuracy: 0.9497235  Vali weighted F1: 0.9497949  Vali macro F1 0.9298198 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.275707721710205
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1226915  Vali Loss: 0.1344714 Vali Accuracy: 0.9542484  Vali weighted F1: 0.9542756  Vali macro F1 0.9389990 
new best score!!!!
Validation loss decreased (0.148372 --> 0.134471).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.284639358520508
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1301708  Vali Loss: 0.1295200 Vali Accuracy: 0.9557567  Vali weighted F1: 0.9553090  Vali macro F1 0.9420868 
new best score!!!!
Validation loss decreased (0.134471 --> 0.129520).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.301541805267334
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1117297  Vali Loss: 0.1014595 Vali Accuracy: 0.9653092  Vali weighted F1: 0.9656861  Vali macro F1 0.9572822 
new best score!!!!
Validation loss decreased (0.129520 --> 0.101459).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.28539776802063
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0972802  Vali Loss: 0.0958462 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9691620  Vali macro F1 0.9603842 
new best score!!!!
Validation loss decreased (0.101459 --> 0.095846).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.293846368789673
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0875360  Vali Loss: 0.0913846 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9719654  Vali macro F1 0.9645124 
new best score!!!!
Validation loss decreased (0.095846 --> 0.091385).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.2869744300842285
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0803659  Vali Loss: 0.0903184 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9734357  Vali macro F1 0.9657201 
new best score!!!!
Validation loss decreased (0.091385 --> 0.090318).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.2980804443359375
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0858945  Vali Loss: 0.0876824 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9723875  Vali macro F1 0.9640999 
new best score!!!!
Validation loss decreased (0.090318 --> 0.087682).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.298016548156738
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0718351  Vali Loss: 0.0931335 Vali Accuracy: 0.9693313  Vali weighted F1: 0.9696260  Vali macro F1 0.9615044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.305374622344971
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0661501  Vali Loss: 0.0810390 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764743  Vali macro F1 0.9694318 
new best score!!!!
Validation loss decreased (0.087682 --> 0.081039).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.306841611862183
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0781647  Vali Loss: 0.0782688 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9728678  Vali macro F1 0.9658167 
new best score!!!!
Validation loss decreased (0.081039 --> 0.078269).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.296671152114868
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0598962  Vali Loss: 0.0677666 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794808  Vali macro F1 0.9724325 
new best score!!!!
Validation loss decreased (0.078269 --> 0.067767).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.294609785079956
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0565044  Vali Loss: 0.0833184 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9722035  Vali macro F1 0.9651411 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.286785840988159
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0587591  Vali Loss: 0.0838189 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9752196  Vali macro F1 0.9628743 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.29106330871582
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0577835  Vali Loss: 0.0622692 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9786644  Vali macro F1 0.9714050 
new best score!!!!
Validation loss decreased (0.067767 --> 0.062269).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.2968034744262695
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0545528  Vali Loss: 0.0642143 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9793157  Vali macro F1 0.9724872 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.319313049316406
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0497497  Vali Loss: 0.0674938 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750045  Vali macro F1 0.9649617 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.286882400512695
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0474874  Vali Loss: 0.0603012 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828878  Vali macro F1 0.9772806 
new best score!!!!
Validation loss decreased (0.062269 --> 0.060301).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.292683839797974
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0391555  Vali Loss: 0.0549879 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859878  Vali macro F1 0.9808410 
new best score!!!!
Validation loss decreased (0.060301 --> 0.054988).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.2925403118133545
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0429504  Vali Loss: 0.0608638 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787818  Vali macro F1 0.9703156 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.299142599105835
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0416064  Vali Loss: 0.0698997 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9827268  Vali macro F1 0.9765416 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.289594411849976
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0434871  Vali Loss: 0.0561316 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834490  Vali macro F1 0.9774565 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.30135440826416
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0316704  Vali Loss: 0.0597077 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818541  Vali macro F1 0.9758627 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.295448541641235
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0318881  Vali Loss: 0.0603772 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819235  Vali macro F1 0.9771848 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 6.288749933242798
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0226937  Vali Loss: 0.0512918 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874721  Vali macro F1 0.9840894 
new best score!!!!
Validation loss decreased (0.054988 --> 0.051292).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.296036005020142
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0206643  Vali Loss: 0.0528746 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864357  Vali macro F1 0.9828712 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.293639183044434
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0198654  Vali Loss: 0.0523050 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874356  Vali macro F1 0.9841063 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.289182901382446
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0182060  Vali Loss: 0.0528130 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874398  Vali macro F1 0.9846645 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.285905122756958
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0187614  Vali Loss: 0.0539665 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874219  Vali macro F1 0.9849756 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.305667877197266
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0179800  Vali Loss: 0.0537047 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854375  Vali macro F1 0.9820464 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.296149015426636
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0171245  Vali Loss: 0.0525638 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864265  Vali macro F1 0.9834089 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.297725200653076
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0168912  Vali Loss: 0.0522300 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864265  Vali macro F1 0.9834089 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.292598009109497
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0168336  Vali Loss: 0.0518579 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879463  Vali macro F1 0.9858294 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.29330587387085
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0168534  Vali Loss: 0.0522051 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869336  Vali macro F1 0.9842171 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.292912721633911
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0167575  Vali Loss: 0.0516387 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869452  Vali macro F1 0.9845949 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.2864179611206055
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0170031  Vali Loss: 0.0517350 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864396  Vali macro F1 0.9837893 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.3043341636657715
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0160653  Vali Loss: 0.0517832 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869336  Vali macro F1 0.9842171 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.30038595199585
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0161291  Vali Loss: 0.0517758 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874402  Vali macro F1 0.9850240 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.2897045612335205
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0168140  Vali Loss: 0.0518310 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874402  Vali macro F1 0.9850240 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.29201865196228
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0169395  Vali Loss: 0.0518596 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874402  Vali macro F1 0.9850240 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8049663  Test weighted F1: 0.8197740  Test macro F1 0.7703245 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.302945613861084
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0210737  Vali Loss: 0.0534068 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853993  Vali macro F1 0.9817950 
Validation loss decreased (inf --> 0.053407).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.27571964263916
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0199137  Vali Loss: 0.0533831 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869391  Vali macro F1 0.9847679 
new best score!!!!
Validation loss decreased (0.053407 --> 0.053383).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.283412218093872
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0192057  Vali Loss: 0.0547440 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869367  Vali macro F1 0.9844142 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.293617486953735
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0183128  Vali Loss: 0.0508643 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854264  Vali macro F1 0.9820538 
new best score!!!!
Validation loss decreased (0.053383 --> 0.050864).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.324270963668823
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0176378  Vali Loss: 0.0488778 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874574  Vali macro F1 0.9854195 
new best score!!!!
Validation loss decreased (0.050864 --> 0.048878).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.2914299964904785
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0172628  Vali Loss: 0.0510019 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864363  Vali macro F1 0.9834353 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.2896435260772705
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0173678  Vali Loss: 0.0517316 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869495  Vali macro F1 0.9849695 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.29125189781189
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0172136  Vali Loss: 0.0526085 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864429  Vali macro F1 0.9840240 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.293436765670776
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0145955  Vali Loss: 0.0556129 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853843  Vali macro F1 0.9825510 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.293777942657471
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0158468  Vali Loss: 0.0519602 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859145  Vali macro F1 0.9830595 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.319310665130615
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0148473  Vali Loss: 0.0517661 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869276  Vali macro F1 0.9847935 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.2978527545928955
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0157127  Vali Loss: 0.0527627 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864457  Vali macro F1 0.9834609 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.287010192871094
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0136075  Vali Loss: 0.0570355 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853748  Vali macro F1 0.9819475 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.285584211349487
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0133770  Vali Loss: 0.0512213 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869574  Vali macro F1 0.9845037 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.295072317123413
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0145266  Vali Loss: 0.0559736 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879177  Vali macro F1 0.9856356 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.306666135787964
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0119920  Vali Loss: 0.0531968 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859145  Vali macro F1 0.9830595 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.2991626262664795
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0132988  Vali Loss: 0.0544407 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864118  Vali macro F1 0.9838413 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.320044279098511
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0114957  Vali Loss: 0.0548409 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864118  Vali macro F1 0.9838413 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.29410195350647
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0123366  Vali Loss: 0.0534877 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859145  Vali macro F1 0.9830595 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.300265312194824
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0125924  Vali Loss: 0.0530424 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859145  Vali macro F1 0.9830595 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8125063  Test weighted F1: 0.8267608  Test macro F1 0.7779021 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014952 0.00018225 0.0010989  0.00140056 0.0005071  0.00063211]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.098138332366943
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.1137238  Vali Loss: 0.7583614 Vali Accuracy: 0.6842924  Vali weighted F1: 0.6030773  Vali macro F1 0.3366508 
Validation loss decreased (inf --> 0.758361).  Saving model ...
Epoch: 2 cost time: 6.089455604553223
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5828829  Vali Loss: 0.5311798 Vali Accuracy: 0.8030067  Vali weighted F1: 0.7731209  Vali macro F1 0.7115917 
new best score!!!!
Validation loss decreased (0.758361 --> 0.531180).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.124330043792725
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.4461176  Vali Loss: 0.4224998 Vali Accuracy: 0.8392950  Vali weighted F1: 0.8195632  Vali macro F1 0.7612883 
new best score!!!!
Validation loss decreased (0.531180 --> 0.422500).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.105769395828247
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.3437257  Vali Loss: 0.3253682 Vali Accuracy: 0.8818040  Vali weighted F1: 0.8749812  Vali macro F1 0.8347963 
new best score!!!!
Validation loss decreased (0.422500 --> 0.325368).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.112930774688721
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2759297  Vali Loss: 0.2692259 Vali Accuracy: 0.9092794  Vali weighted F1: 0.9088917  Vali macro F1 0.8783789 
new best score!!!!
Validation loss decreased (0.325368 --> 0.269226).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.115445852279663
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2220505  Vali Loss: 0.2308665 Vali Accuracy: 0.9201659  Vali weighted F1: 0.9187638  Vali macro F1 0.8967488 
new best score!!!!
Validation loss decreased (0.269226 --> 0.230866).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.125868082046509
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1880987  Vali Loss: 0.1928499 Vali Accuracy: 0.9377916  Vali weighted F1: 0.9376255  Vali macro F1 0.9185403 
new best score!!!!
Validation loss decreased (0.230866 --> 0.192850).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.120279788970947
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1619053  Vali Loss: 0.1718121 Vali Accuracy: 0.9414204  Vali weighted F1: 0.9408430  Vali macro F1 0.9258621 
new best score!!!!
Validation loss decreased (0.192850 --> 0.171812).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.110190153121948
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1543527  Vali Loss: 0.1629049 Vali Accuracy: 0.9393468  Vali weighted F1: 0.9391494  Vali macro F1 0.9168232 
new best score!!!!
Validation loss decreased (0.171812 --> 0.162905).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.1160173416137695
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1336635  Vali Loss: 0.1747981 Vali Accuracy: 0.9398652  Vali weighted F1: 0.9392422  Vali macro F1 0.9213479 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.119931221008301
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1270291  Vali Loss: 0.1383587 Vali Accuracy: 0.9507517  Vali weighted F1: 0.9506802  Vali macro F1 0.9360553 
new best score!!!!
Validation loss decreased (0.162905 --> 0.138359).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.102635383605957
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1107100  Vali Loss: 0.1285939 Vali Accuracy: 0.9569725  Vali weighted F1: 0.9572417  Vali macro F1 0.9492275 
new best score!!!!
Validation loss decreased (0.138359 --> 0.128594).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.107627630233765
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1013337  Vali Loss: 0.1340506 Vali Accuracy: 0.9569725  Vali weighted F1: 0.9570836  Vali macro F1 0.9460832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.0935094356536865
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0966445  Vali Loss: 0.1023744 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9642294  Vali macro F1 0.9562344 
new best score!!!!
Validation loss decreased (0.128594 --> 0.102374).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.090704441070557
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0864589  Vali Loss: 0.1264099 Vali Accuracy: 0.9606013  Vali weighted F1: 0.9611881  Vali macro F1 0.9541978 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.105823278427124
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0840046  Vali Loss: 0.0969088 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9716677  Vali macro F1 0.9657242 
new best score!!!!
Validation loss decreased (0.102374 --> 0.096909).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.126497983932495
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0724885  Vali Loss: 0.1068681 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9667931  Vali macro F1 0.9598051 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.106035470962524
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0746701  Vali Loss: 0.0983495 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9680819  Vali macro F1 0.9609348 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.096456289291382
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0591202  Vali Loss: 0.0907609 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726902  Vali macro F1 0.9660852 
new best score!!!!
Validation loss decreased (0.096909 --> 0.090761).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.10791540145874
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0585947  Vali Loss: 0.1139901 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9664554  Vali macro F1 0.9612345 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.114888668060303
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0576496  Vali Loss: 0.0929198 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9716006  Vali macro F1 0.9663490 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.108489751815796
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0547399  Vali Loss: 0.0851867 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9735881  Vali macro F1 0.9687337 
new best score!!!!
Validation loss decreased (0.090761 --> 0.085187).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.101274013519287
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0492846  Vali Loss: 0.0793769 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9749979  Vali macro F1 0.9699357 
new best score!!!!
Validation loss decreased (0.085187 --> 0.079377).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.131422519683838
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0440281  Vali Loss: 0.0752609 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9787836  Vali macro F1 0.9746622 
new best score!!!!
Validation loss decreased (0.079377 --> 0.075261).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.0973992347717285
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0407644  Vali Loss: 0.0788981 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9754862  Vali macro F1 0.9692989 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.10185980796814
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0418104  Vali Loss: 0.0788853 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9777872  Vali macro F1 0.9718973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.096724510192871
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0383364  Vali Loss: 0.0758544 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9750815  Vali macro F1 0.9700083 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.11456298828125
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0398305  Vali Loss: 0.0966691 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9737319  Vali macro F1 0.9683469 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.1181371212005615
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0302551  Vali Loss: 0.0904863 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756579  Vali macro F1 0.9704216 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.1081321239471436
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0216939  Vali Loss: 0.0765781 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9793087  Vali macro F1 0.9734024 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.108627796173096
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0200403  Vali Loss: 0.0755000 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9803409  Vali macro F1 0.9749712 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.125556945800781
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0194957  Vali Loss: 0.0719960 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819167  Vali macro F1 0.9772472 
new best score!!!!
Validation loss decreased (0.075261 --> 0.071996).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.092968702316284
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0194988  Vali Loss: 0.0740287 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797687  Vali macro F1 0.9744991 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.097014427185059
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0200736  Vali Loss: 0.0759972 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808119  Vali macro F1 0.9757768 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.092559099197388
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0174452  Vali Loss: 0.0791404 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9786856  Vali macro F1 0.9736083 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.094259977340698
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0182933  Vali Loss: 0.0750635 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808336  Vali macro F1 0.9761023 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.103138446807861
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0168883  Vali Loss: 0.0740711 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802816  Vali macro F1 0.9752315 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 6.118032693862915
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0173164  Vali Loss: 0.0738084 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813268  Vali macro F1 0.9765126 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.098507881164551
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0163450  Vali Loss: 0.0734906 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823938  Vali macro F1 0.9776509 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.089765548706055
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0165545  Vali Loss: 0.0739724 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823938  Vali macro F1 0.9776509 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.0867180824279785
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0165967  Vali Loss: 0.0744309 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823938  Vali macro F1 0.9776509 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.088693380355835
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0156756  Vali Loss: 0.0739665 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829262  Vali macro F1 0.9782035 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 43 cost time: 6.095543384552002
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0163750  Vali Loss: 0.0740605 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829262  Vali macro F1 0.9782035 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.094691514968872
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0160700  Vali Loss: 0.0740526 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823938  Vali macro F1 0.9776509 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.111339330673218
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0169067  Vali Loss: 0.0740093 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823938  Vali macro F1 0.9776509 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.1061623096466064
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0158806  Vali Loss: 0.0740541 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829262  Vali macro F1 0.9782035 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.086956977844238
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0176269  Vali Loss: 0.0740197 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829262  Vali macro F1 0.9782035 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9273945  Test weighted F1: 0.9278514  Test macro F1 0.8623204 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.134449243545532
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0197425  Vali Loss: 0.0775624 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9782660  Vali macro F1 0.9727044 
Validation loss decreased (inf --> 0.077562).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.106405258178711
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0187275  Vali Loss: 0.0749228 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9798023  Vali macro F1 0.9741554 
new best score!!!!
Validation loss decreased (0.077562 --> 0.074923).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.098637819290161
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0170471  Vali Loss: 0.0722226 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813985  Vali macro F1 0.9757949 
new best score!!!!
Validation loss decreased (0.074923 --> 0.072223).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.116239786148071
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0184508  Vali Loss: 0.0734802 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819104  Vali macro F1 0.9772232 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.134804964065552
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0173944  Vali Loss: 0.0708021 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818904  Vali macro F1 0.9770721 
new best score!!!!
Validation loss decreased (0.072223 --> 0.070802).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.131282567977905
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0168526  Vali Loss: 0.0804844 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9786939  Vali macro F1 0.9734167 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.1428916454315186
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0170633  Vali Loss: 0.0758095 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9803423  Vali macro F1 0.9737330 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.124732494354248
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0158544  Vali Loss: 0.0750694 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9793193  Vali macro F1 0.9737235 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.130676984786987
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0162049  Vali Loss: 0.0768767 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9798364  Vali macro F1 0.9742975 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.116759300231934
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0156325  Vali Loss: 0.0768878 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792559  Vali macro F1 0.9729391 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.126717567443848
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0159267  Vali Loss: 0.0789620 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9787702  Vali macro F1 0.9728801 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.139400959014893
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0163666  Vali Loss: 0.0762016 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813982  Vali macro F1 0.9754868 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.234140634536743
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0167627  Vali Loss: 0.0752444 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9803671  Vali macro F1 0.9739250 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.135573148727417
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0143953  Vali Loss: 0.0749441 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808404  Vali macro F1 0.9748088 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.121076345443726
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0140780  Vali Loss: 0.0714238 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802921  Vali macro F1 0.9741739 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.114047527313232
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0137792  Vali Loss: 0.0717228 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797837  Vali macro F1 0.9731854 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.110349416732788
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0128351  Vali Loss: 0.0720830 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797730  Vali macro F1 0.9733902 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.133852958679199
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0120005  Vali Loss: 0.0727339 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797837  Vali macro F1 0.9731854 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.1438024044036865
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0130879  Vali Loss: 0.0734470 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792399  Vali macro F1 0.9728357 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.118441820144653
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0121318  Vali Loss: 0.0728982 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797730  Vali macro F1 0.9733902 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9354019  Test weighted F1: 0.9358288  Test macro F1 0.8781610 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014912 0.00018139 0.00098425 0.00125471 0.00049529 0.00061237]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.235787391662598
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0800510  Vali Loss: 0.5973498 Vali Accuracy: 0.7801527  Vali weighted F1: 0.7314561  Vali macro F1 0.5332792 
Validation loss decreased (inf --> 0.597350).  Saving model ...
Epoch: 2 cost time: 6.232755422592163
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5298127  Vali Loss: 0.5038796 Vali Accuracy: 0.8218830  Vali weighted F1: 0.8033317  Vali macro F1 0.7393025 
new best score!!!!
Validation loss decreased (0.597350 --> 0.503880).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.2167439460754395
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4181899  Vali Loss: 0.3882459 Vali Accuracy: 0.8605598  Vali weighted F1: 0.8491621  Vali macro F1 0.7878834 
new best score!!!!
Validation loss decreased (0.503880 --> 0.388246).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.247936010360718
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3346207  Vali Loss: 0.2988804 Vali Accuracy: 0.8982188  Vali weighted F1: 0.8921426  Vali macro F1 0.8443997 
new best score!!!!
Validation loss decreased (0.388246 --> 0.298880).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.239332914352417
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2826482  Vali Loss: 0.2397863 Vali Accuracy: 0.9160305  Vali weighted F1: 0.9154692  Vali macro F1 0.8760638 
new best score!!!!
Validation loss decreased (0.298880 --> 0.239786).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.24247670173645
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2399879  Vali Loss: 0.2452164 Vali Accuracy: 0.9216285  Vali weighted F1: 0.9187633  Vali macro F1 0.8918625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.2346155643463135
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1942564  Vali Loss: 0.1799235 Vali Accuracy: 0.9424936  Vali weighted F1: 0.9428388  Vali macro F1 0.9179374 
new best score!!!!
Validation loss decreased (0.239786 --> 0.179924).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.24282693862915
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1651345  Vali Loss: 0.2468160 Vali Accuracy: 0.9150127  Vali weighted F1: 0.9188934  Vali macro F1 0.8999669 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.236558437347412
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1637946  Vali Loss: 0.1342615 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9557995  Vali macro F1 0.9364158 
new best score!!!!
Validation loss decreased (0.179924 --> 0.134261).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.239425897598267
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1308935  Vali Loss: 0.1372112 Vali Accuracy: 0.9562341  Vali weighted F1: 0.9568829  Vali macro F1 0.9368896 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.243494987487793
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1347811  Vali Loss: 0.1099863 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9650994  Vali macro F1 0.9474431 
new best score!!!!
Validation loss decreased (0.134261 --> 0.109986).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.258288145065308
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1128272  Vali Loss: 0.0931515 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9722447  Vali macro F1 0.9564324 
new best score!!!!
Validation loss decreased (0.109986 --> 0.093151).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.22915244102478
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1009630  Vali Loss: 0.1138302 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9645520  Vali macro F1 0.9469327 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.2471702098846436
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0986622  Vali Loss: 0.0931873 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9694381  Vali macro F1 0.9525242 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.24534273147583
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0845271  Vali Loss: 0.0826095 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9768905  Vali macro F1 0.9648269 
new best score!!!!
Validation loss decreased (0.093151 --> 0.082609).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.2312538623809814
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0814227  Vali Loss: 0.0842521 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9730098  Vali macro F1 0.9617241 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.228762865066528
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0760043  Vali Loss: 0.0892490 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9690120  Vali macro F1 0.9569878 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.251458406448364
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0741096  Vali Loss: 0.0724923 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9768939  Vali macro F1 0.9625359 
new best score!!!!
Validation loss decreased (0.082609 --> 0.072492).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.268177509307861
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0699137  Vali Loss: 0.0796475 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9740922  Vali macro F1 0.9612979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.238934516906738
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0568507  Vali Loss: 0.0727087 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9757388  Vali macro F1 0.9656701 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.249508380889893
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0583826  Vali Loss: 0.0684531 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9787442  Vali macro F1 0.9710310 
new best score!!!!
Validation loss decreased (0.072492 --> 0.068453).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.245177745819092
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0534584  Vali Loss: 0.0714443 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9750973  Vali macro F1 0.9643865 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.234765529632568
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0476206  Vali Loss: 0.0601762 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9798773  Vali macro F1 0.9712292 
new best score!!!!
Validation loss decreased (0.068453 --> 0.060176).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.235688209533691
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0474963  Vali Loss: 0.1549616 Vali Accuracy: 0.9506361  Vali weighted F1: 0.9525910  Vali macro F1 0.9384239 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.2597880363464355
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1065087  Vali Loss: 0.0656416 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9802289  Vali macro F1 0.9726878 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.229439973831177
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0466193  Vali Loss: 0.0571835 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823683  Vali macro F1 0.9737454 
new best score!!!!
Validation loss decreased (0.060176 --> 0.057184).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.246921062469482
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0519044  Vali Loss: 0.0545079 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9807300  Vali macro F1 0.9726863 
new best score!!!!
Validation loss decreased (0.057184 --> 0.054508).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.243687868118286
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0431797  Vali Loss: 0.0900991 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9727236  Vali macro F1 0.9565142 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.244201898574829
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0732086  Vali Loss: 0.0691439 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9772035  Vali macro F1 0.9653169 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.22563624382019
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0393298  Vali Loss: 0.0527025 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823324  Vali macro F1 0.9757340 
new best score!!!!
Validation loss decreased (0.054508 --> 0.052702).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.240272045135498
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0379957  Vali Loss: 0.0634351 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9796019  Vali macro F1 0.9722311 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.259982585906982
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0303582  Vali Loss: 0.0726617 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753828  Vali macro F1 0.9671270 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.267073392868042
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0412008  Vali Loss: 0.0576079 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817134  Vali macro F1 0.9725395 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.260972023010254
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0265243  Vali Loss: 0.0541157 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858461  Vali macro F1 0.9808893 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.26772928237915
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0282211  Vali Loss: 0.0492848 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847920  Vali macro F1 0.9787259 
new best score!!!!
Validation loss decreased (0.052702 --> 0.049285).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.270120143890381
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0287474  Vali Loss: 0.0662513 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753841  Vali macro F1 0.9609948 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.258269786834717
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0300395  Vali Loss: 0.0513096 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837737  Vali macro F1 0.9778506 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.241321563720703
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0254868  Vali Loss: 0.0488955 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858763  Vali macro F1 0.9801837 
new best score!!!!
Validation loss decreased (0.049285 --> 0.048896).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.268923997879028
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0204982  Vali Loss: 0.0495538 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852116  Vali macro F1 0.9804160 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.28647518157959
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0243627  Vali Loss: 0.0785926 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9794736  Vali macro F1 0.9730969 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.283868074417114
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0212455  Vali Loss: 0.0542094 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858037  Vali macro F1 0.9795401 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.255220413208008
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0208273  Vali Loss: 0.0523060 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848306  Vali macro F1 0.9781233 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.268266201019287
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0254660  Vali Loss: 0.0498148 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858362  Vali macro F1 0.9794229 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 6.258921384811401
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0142531  Vali Loss: 0.0466417 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863146  Vali macro F1 0.9810239 
new best score!!!!
Validation loss decreased (0.048896 --> 0.046642).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.245960712432861
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0132647  Vali Loss: 0.0461666 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862943  Vali macro F1 0.9806315 
new best score!!!!
Validation loss decreased (0.046642 --> 0.046167).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.267537832260132
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0109995  Vali Loss: 0.0464450 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873315  Vali macro F1 0.9816652 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.253232002258301
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0115910  Vali Loss: 0.0471141 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868271  Vali macro F1 0.9811757 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.2508544921875
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0116877  Vali Loss: 0.0470501 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868149  Vali macro F1 0.9824873 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.253446578979492
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0113797  Vali Loss: 0.0456617 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878158  Vali macro F1 0.9833094 
new best score!!!!
Validation loss decreased (0.046167 --> 0.045662).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.256744146347046
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0113649  Vali Loss: 0.0471602 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857719  Vali macro F1 0.9805926 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.2534637451171875
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0106848  Vali Loss: 0.0453716 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862813  Vali macro F1 0.9822044 
new best score!!!!
Validation loss decreased (0.045662 --> 0.045372).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.267348527908325
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0102515  Vali Loss: 0.0462737 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863080  Vali macro F1 0.9821250 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.2603302001953125
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0097929  Vali Loss: 0.0441535 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867770  Vali macro F1 0.9833972 
new best score!!!!
Validation loss decreased (0.045372 --> 0.044153).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.270407438278198
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0097395  Vali Loss: 0.0456900 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868351  Vali macro F1 0.9829803 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.254750728607178
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0101015  Vali Loss: 0.0467997 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867704  Vali macro F1 0.9830065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.258192300796509
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0099561  Vali Loss: 0.0446587 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878000  Vali macro F1 0.9844429 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.262685537338257
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0096357  Vali Loss: 0.0437409 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872972  Vali macro F1 0.9839556 
new best score!!!!
Validation loss decreased (0.044153 --> 0.043741).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.25515079498291
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0089197  Vali Loss: 0.0445212 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878057  Vali macro F1 0.9843644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.25874137878418
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0087965  Vali Loss: 0.0446099 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872854  Vali macro F1 0.9838447 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.281982421875
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0085040  Vali Loss: 0.0451107 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9856909  Vali macro F1 0.9822752 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.264606952667236
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0090707  Vali Loss: 0.0445475 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862662  Vali macro F1 0.9831857 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.250750780105591
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0078563  Vali Loss: 0.0428213 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888178  Vali macro F1 0.9857685 
new best score!!!!
Validation loss decreased (0.043741 --> 0.042821).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 6.247511863708496
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0081019  Vali Loss: 0.0436208 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872895  Vali macro F1 0.9842316 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 6.247798204421997
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0092108  Vali Loss: 0.0435772 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878021  Vali macro F1 0.9849883 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 6.247582197189331
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0089494  Vali Loss: 0.0418491 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878287  Vali macro F1 0.9846587 
new best score!!!!
Validation loss decreased (0.042821 --> 0.041849).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 6.269369602203369
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0078406  Vali Loss: 0.0444737 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878507  Vali macro F1 0.9840055 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.280131101608276
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0090595  Vali Loss: 0.0471553 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862412  Vali macro F1 0.9827606 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.2702178955078125
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0086017  Vali Loss: 0.0483288 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867643  Vali macro F1 0.9832456 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.260220766067505
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0084020  Vali Loss: 0.0459906 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867888  Vali macro F1 0.9819512 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.250162601470947
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0070181  Vali Loss: 0.0457193 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867575  Vali macro F1 0.9822801 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 71 cost time: 6.257328033447266
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0070859  Vali Loss: 0.0462602 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872798  Vali macro F1 0.9831901 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 6.249910831451416
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0069630  Vali Loss: 0.0463058 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867750  Vali macro F1 0.9823124 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 6.257858514785767
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0071567  Vali Loss: 0.0468433 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872798  Vali macro F1 0.9831901 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 6.253880262374878
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0068128  Vali Loss: 0.0461464 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872798  Vali macro F1 0.9831901 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 6.246440887451172
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0065100  Vali Loss: 0.0461519 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872841  Vali macro F1 0.9831089 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 76 cost time: 6.239826917648315
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0069523  Vali Loss: 0.0461765 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872841  Vali macro F1 0.9831089 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 6.233355283737183
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0070121  Vali Loss: 0.0462331 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872841  Vali macro F1 0.9831089 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 6.244663238525391
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0057876  Vali Loss: 0.0463714 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872841  Vali macro F1 0.9831089 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 6.246243238449097
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0063986  Vali Loss: 0.0463371 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872841  Vali macro F1 0.9831089 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 6.359880208969116
VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0065712  Vali Loss: 0.0463331 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872841  Vali macro F1 0.9831089 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8456159  Test weighted F1: 0.8522870  Test macro F1 0.8082858 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.290863275527954
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0087531  Vali Loss: 0.0420694 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877556  Vali macro F1 0.9847014 
Validation loss decreased (inf --> 0.042069).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.255994558334351
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0076358  Vali Loss: 0.0465214 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883322  Vali macro F1 0.9846047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.2553794384002686
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0090159  Vali Loss: 0.0470550 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857427  Vali macro F1 0.9817668 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.248179912567139
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0067847  Vali Loss: 0.0421180 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883701  Vali macro F1 0.9832500 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.256368398666382
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0075606  Vali Loss: 0.0438883 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868090  Vali macro F1 0.9823087 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.269101619720459
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0081134  Vali Loss: 0.0442005 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878140  Vali macro F1 0.9842903 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.257875919342041
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0073543  Vali Loss: 0.0471410 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883547  Vali macro F1 0.9842168 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.254958152770996
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0077838  Vali Loss: 0.0442963 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878139  Vali macro F1 0.9846633 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 10.266576766967773
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0083726  Vali Loss: 0.0454374 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883622  Vali macro F1 0.9845602 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 7.176955461502075
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0074412  Vali Loss: 0.0449193 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867990  Vali macro F1 0.9821796 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.2130279541015625
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0064656  Vali Loss: 0.0447252 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867905  Vali macro F1 0.9818733 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.201021194458008
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0065331  Vali Loss: 0.0451996 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868130  Vali macro F1 0.9818261 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.231913328170776
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0059663  Vali Loss: 0.0457368 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862937  Vali macro F1 0.9813083 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.231695652008057
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0057297  Vali Loss: 0.0459067 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868030  Vali macro F1 0.9829201 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.210001230239868
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0060050  Vali Loss: 0.0457527 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868030  Vali macro F1 0.9829201 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.208332538604736
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0066767  Vali Loss: 0.0456955 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862937  Vali macro F1 0.9813083 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8495607  Test weighted F1: 0.8556216  Test macro F1 0.8107334 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014914 0.00018464 0.000999   0.00124378 0.00051733 0.00061958]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.149466276168823
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.1160216  Vali Loss: 0.6286148 Vali Accuracy: 0.7595263  Vali weighted F1: 0.6907848  Vali macro F1 0.4885314 
Validation loss decreased (inf --> 0.628615).  Saving model ...
Epoch: 2 cost time: 6.114450216293335
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.5642155  Vali Loss: 0.4876052 Vali Accuracy: 0.8414006  Vali weighted F1: 0.8174473  Vali macro F1 0.7504371 
new best score!!!!
Validation loss decreased (0.628615 --> 0.487605).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.127105712890625
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.4727029  Vali Loss: 0.4042808 Vali Accuracy: 0.8589083  Vali weighted F1: 0.8445521  Vali macro F1 0.7809095 
new best score!!!!
Validation loss decreased (0.487605 --> 0.404281).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.150325536727905
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.3689799  Vali Loss: 0.2765866 Vali Accuracy: 0.9057673  Vali weighted F1: 0.9015874  Vali macro F1 0.8593593 
new best score!!!!
Validation loss decreased (0.404281 --> 0.276587).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.134454011917114
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2648948  Vali Loss: 0.2020498 Vali Accuracy: 0.9346035  Vali weighted F1: 0.9332419  Vali macro F1 0.9003071 
new best score!!!!
Validation loss decreased (0.276587 --> 0.202050).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.144510984420776
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2136709  Vali Loss: 0.1868082 Vali Accuracy: 0.9428424  Vali weighted F1: 0.9407993  Vali macro F1 0.9116407 
new best score!!!!
Validation loss decreased (0.202050 --> 0.186808).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.133149862289429
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1866321  Vali Loss: 0.1795533 Vali Accuracy: 0.9418126  Vali weighted F1: 0.9393827  Vali macro F1 0.9092715 
new best score!!!!
Validation loss decreased (0.186808 --> 0.179553).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.133429765701294
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1655432  Vali Loss: 0.1426053 Vali Accuracy: 0.9557158  Vali weighted F1: 0.9553689  Vali macro F1 0.9357701 
new best score!!!!
Validation loss decreased (0.179553 --> 0.142605).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.118494272232056
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1443795  Vali Loss: 0.1673615 Vali Accuracy: 0.9454171  Vali weighted F1: 0.9436184  Vali macro F1 0.9176059 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.113033771514893
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1277955  Vali Loss: 0.1323544 Vali Accuracy: 0.9618950  Vali weighted F1: 0.9619090  Vali macro F1 0.9460988 
new best score!!!!
Validation loss decreased (0.142605 --> 0.132354).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.144684076309204
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1307083  Vali Loss: 0.1105555 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9647991  Vali macro F1 0.9488893 
new best score!!!!
Validation loss decreased (0.132354 --> 0.110556).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.159989356994629
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1053709  Vali Loss: 0.1403510 Vali Accuracy: 0.9531411  Vali weighted F1: 0.9532860  Vali macro F1 0.9360332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.11624002456665
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1008368  Vali Loss: 0.0940426 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9668986  Vali macro F1 0.9501315 
new best score!!!!
Validation loss decreased (0.110556 --> 0.094043).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.120037078857422
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0904992  Vali Loss: 0.0865621 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9689173  Vali macro F1 0.9533950 
new best score!!!!
Validation loss decreased (0.094043 --> 0.086562).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.138217210769653
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1013128  Vali Loss: 0.1082876 Vali Accuracy: 0.9603502  Vali weighted F1: 0.9612355  Vali macro F1 0.9403427 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.13469934463501
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0824289  Vali Loss: 0.0852986 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9743432  Vali macro F1 0.9618293 
new best score!!!!
Validation loss decreased (0.086562 --> 0.085299).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.13685941696167
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0699246  Vali Loss: 0.0880898 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9743879  Vali macro F1 0.9613057 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.137768268585205
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0681819  Vali Loss: 0.1081401 Vali Accuracy: 0.9624099  Vali weighted F1: 0.9635695  Vali macro F1 0.9480457 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.16139030456543
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0678635  Vali Loss: 0.0906714 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9716455  Vali macro F1 0.9583066 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.131586313247681
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0643167  Vali Loss: 0.0824347 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782500  Vali macro F1 0.9664763 
new best score!!!!
Validation loss decreased (0.085299 --> 0.082435).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.132730007171631
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0568416  Vali Loss: 0.0833091 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9727229  Vali macro F1 0.9609740 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.121445894241333
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0607873  Vali Loss: 0.0698735 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9751745  Vali macro F1 0.9632226 
new best score!!!!
Validation loss decreased (0.082435 --> 0.069873).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.147420644760132
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0579551  Vali Loss: 0.0670045 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9791193  Vali macro F1 0.9683723 
new best score!!!!
Validation loss decreased (0.069873 --> 0.067004).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.152719974517822
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0526854  Vali Loss: 0.0779657 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9757440  Vali macro F1 0.9620745 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.138617992401123
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0467136  Vali Loss: 0.0722113 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9760044  Vali macro F1 0.9633613 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.168351888656616
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0503973  Vali Loss: 0.0640183 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805457  Vali macro F1 0.9696400 
new best score!!!!
Validation loss decreased (0.067004 --> 0.064018).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.166675329208374
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0417201  Vali Loss: 0.0651923 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9823912  Vali macro F1 0.9729048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.135572910308838
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0473042  Vali Loss: 0.0854185 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9727974  Vali macro F1 0.9576164 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.133711338043213
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0510121  Vali Loss: 0.0751365 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773775  Vali macro F1 0.9674720 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.144718885421753
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0454289  Vali Loss: 0.0583746 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815013  Vali macro F1 0.9726677 
new best score!!!!
Validation loss decreased (0.064018 --> 0.058375).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.1386871337890625
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0384039  Vali Loss: 0.0585304 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809726  Vali macro F1 0.9690370 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.145519971847534
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0362748  Vali Loss: 0.0542936 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835599  Vali macro F1 0.9748372 
new best score!!!!
Validation loss decreased (0.058375 --> 0.054294).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.15430212020874
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0317086  Vali Loss: 0.0573481 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809454  Vali macro F1 0.9700664 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.153850555419922
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0293283  Vali Loss: 0.0610135 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819303  Vali macro F1 0.9727687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.133889436721802
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0309926  Vali Loss: 0.0508432 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845039  Vali macro F1 0.9768834 
new best score!!!!
Validation loss decreased (0.054294 --> 0.050843).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.146974563598633
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0258727  Vali Loss: 0.0463835 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850873  Vali macro F1 0.9776696 
new best score!!!!
Validation loss decreased (0.050843 --> 0.046383).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.150252819061279
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0268166  Vali Loss: 0.0508104 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9865688  Vali macro F1 0.9789315 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.141193628311157
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0301904  Vali Loss: 0.0537047 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860720  Vali macro F1 0.9784614 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.141582012176514
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0331840  Vali Loss: 0.0545655 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850045  Vali macro F1 0.9764972 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.140604019165039
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0267360  Vali Loss: 0.0452719 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860948  Vali macro F1 0.9784212 
new best score!!!!
Validation loss decreased (0.046383 --> 0.045272).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.162412166595459
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0258752  Vali Loss: 0.0540459 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815785  Vali macro F1 0.9706284 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.157431602478027
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0207783  Vali Loss: 0.0537986 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861174  Vali macro F1 0.9774343 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.1371026039123535
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0225500  Vali Loss: 0.0685321 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809152  Vali macro F1 0.9698789 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.1445653438568115
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0245157  Vali Loss: 0.0574688 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845593  Vali macro F1 0.9748837 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.1458940505981445
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0203703  Vali Loss: 0.0818078 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9792495  Vali macro F1 0.9698674 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 6.145432710647583
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0161293  Vali Loss: 0.0491980 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845574  Vali macro F1 0.9759371 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.143291473388672
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0122011  Vali Loss: 0.0490010 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855648  Vali macro F1 0.9777537 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.153202056884766
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0117584  Vali Loss: 0.0452437 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861026  Vali macro F1 0.9780051 
new best score!!!!
Validation loss decreased (0.045272 --> 0.045244).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.164356470108032
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0111029  Vali Loss: 0.0451038 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855884  Vali macro F1 0.9765099 
new best score!!!!
Validation loss decreased (0.045244 --> 0.045104).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.147669792175293
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0100866  Vali Loss: 0.0458200 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845640  Vali macro F1 0.9750722 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.148977518081665
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0104765  Vali Loss: 0.0448441 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861027  Vali macro F1 0.9774252 
new best score!!!!
Validation loss decreased (0.045104 --> 0.044844).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.1682233810424805
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0093603  Vali Loss: 0.0455900 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845613  Vali macro F1 0.9757429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.144529342651367
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0100080  Vali Loss: 0.0467538 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850597  Vali macro F1 0.9765624 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.155871391296387
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0099932  Vali Loss: 0.0418014 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861131  Vali macro F1 0.9784831 
new best score!!!!
Validation loss decreased (0.044844 --> 0.041801).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.155986547470093
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0090002  Vali Loss: 0.0446646 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850784  Vali macro F1 0.9766556 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.1613171100616455
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0088274  Vali Loss: 0.0447230 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855843  Vali macro F1 0.9777719 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.143864631652832
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0089733  Vali Loss: 0.0431196 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856046  Vali macro F1 0.9772210 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.120166778564453
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0089064  Vali Loss: 0.0433615 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850951  Vali macro F1 0.9769769 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.129340887069702
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0093487  Vali Loss: 0.0424324 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850970  Vali macro F1 0.9769802 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 6.123516798019409
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0084032  Vali Loss: 0.0421978 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856001  Vali macro F1 0.9775041 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.127958059310913
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0082570  Vali Loss: 0.0427853 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861039  Vali macro F1 0.9780298 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.129310369491577
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0079961  Vali Loss: 0.0422788 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866184  Vali macro F1 0.9789453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.137040853500366
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0076892  Vali Loss: 0.0430547 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.126829624176025
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0081403  Vali Loss: 0.0424207 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 65 cost time: 6.12494683265686
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0076941  Vali Loss: 0.0424175 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 6.1072838306427
VALI: Epoch: 66, Steps: 69 | Train Loss: 0.0081108  Vali Loss: 0.0425076 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 6.116233587265015
VALI: Epoch: 67, Steps: 69 | Train Loss: 0.0080434  Vali Loss: 0.0425733 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.108031988143921
VALI: Epoch: 68, Steps: 69 | Train Loss: 0.0077263  Vali Loss: 0.0425977 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.108491659164429
VALI: Epoch: 69, Steps: 69 | Train Loss: 0.0068977  Vali Loss: 0.0426388 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9634562  Test weighted F1: 0.9631629  Test macro F1 0.9560439 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.157210350036621
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0096629  Vali Loss: 0.0430672 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835506  Vali macro F1 0.9756637 
Validation loss decreased (inf --> 0.043067).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.15903115272522
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0086172  Vali Loss: 0.0453055 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845677  Vali macro F1 0.9756803 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.155865430831909
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0081178  Vali Loss: 0.0453194 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845361  Vali macro F1 0.9759283 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.142737627029419
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0093597  Vali Loss: 0.0453652 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860954  Vali macro F1 0.9777101 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.150716781616211
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0088609  Vali Loss: 0.0456775 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855660  Vali macro F1 0.9776435 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.158701658248901
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0069560  Vali Loss: 0.0471975 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835505  Vali macro F1 0.9749323 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.160376310348511
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0077497  Vali Loss: 0.0418929 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861250  Vali macro F1 0.9781115 
new best score!!!!
Validation loss decreased (0.043067 --> 0.041893).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.163792848587036
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0074900  Vali Loss: 0.0481778 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850784  Vali macro F1 0.9766556 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.156871557235718
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0073600  Vali Loss: 0.0479570 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840396  Vali macro F1 0.9751946 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.142131328582764
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0086754  Vali Loss: 0.0426990 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845700  Vali macro F1 0.9758440 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.176353931427002
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0071555  Vali Loss: 0.0412945 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855874  Vali macro F1 0.9773836 
new best score!!!!
Validation loss decreased (0.041893 --> 0.041294).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.171809911727905
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0078140  Vali Loss: 0.0477524 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824599  Vali macro F1 0.9742538 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.157785654067993
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0070186  Vali Loss: 0.0433079 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861635  Vali macro F1 0.9792418 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.145473957061768
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0072699  Vali Loss: 0.0455964 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860707  Vali macro F1 0.9776263 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.1547205448150635
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0069967  Vali Loss: 0.0459224 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855930  Vali macro F1 0.9765945 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.1523401737213135
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0068255  Vali Loss: 0.0466303 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845717  Vali macro F1 0.9763639 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.153883934020996
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0067368  Vali Loss: 0.0443597 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856104  Vali macro F1 0.9772181 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.157902717590332
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0066730  Vali Loss: 0.0454980 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861142  Vali macro F1 0.9777437 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.153505802154541
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0063766  Vali Loss: 0.0447973 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856104  Vali macro F1 0.9772181 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.177011251449585
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0058120  Vali Loss: 0.0451389 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.1598219871521
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0051460  Vali Loss: 0.0452864 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 6.155955076217651
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0050236  Vali Loss: 0.0453310 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.153447389602661
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0061700  Vali Loss: 0.0453945 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.1562910079956055
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0060385  Vali Loss: 0.0453709 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.15731954574585
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0055947  Vali Loss: 0.0453645 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.164502859115601
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0054620  Vali Loss: 0.0454272 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866287  Vali macro F1 0.9786593 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9649180  Test weighted F1: 0.9644919  Test macro F1 0.9573839 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014993 0.00018664 0.00140056 0.0014556  0.0005277  0.00064226]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.942640066146851
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.0926379  Vali Loss: 0.6509607 Vali Accuracy: 0.7318763  Vali weighted F1: 0.6612720  Vali macro F1 0.3678441 
Validation loss decreased (inf --> 0.650961).  Saving model ...
Epoch: 2 cost time: 5.935647487640381
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5678170  Vali Loss: 0.4466945 Vali Accuracy: 0.8464819  Vali weighted F1: 0.8284386  Vali macro F1 0.7703418 
new best score!!!!
Validation loss decreased (0.650961 --> 0.446695).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.91355562210083
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.4258945  Vali Loss: 0.3566938 Vali Accuracy: 0.8715352  Vali weighted F1: 0.8635191  Vali macro F1 0.8289000 
new best score!!!!
Validation loss decreased (0.446695 --> 0.356694).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.907286643981934
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.3293133  Vali Loss: 0.3600488 Vali Accuracy: 0.8811301  Vali weighted F1: 0.8713852  Vali macro F1 0.8407721 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 5 cost time: 5.933568477630615
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2461051  Vali Loss: 0.2405064 Vali Accuracy: 0.9200426  Vali weighted F1: 0.9147344  Vali macro F1 0.8916424 
new best score!!!!
Validation loss decreased (0.356694 --> 0.240506).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.919428586959839
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.1954599  Vali Loss: 0.1837811 Vali Accuracy: 0.9381663  Vali weighted F1: 0.9370734  Vali macro F1 0.9208166 
new best score!!!!
Validation loss decreased (0.240506 --> 0.183781).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.934427499771118
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1718705  Vali Loss: 0.1710922 Vali Accuracy: 0.9413646  Vali weighted F1: 0.9403945  Vali macro F1 0.9243582 
new best score!!!!
Validation loss decreased (0.183781 --> 0.171092).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.9322192668914795
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1448893  Vali Loss: 0.1394820 Vali Accuracy: 0.9514925  Vali weighted F1: 0.9511053  Vali macro F1 0.9369923 
new best score!!!!
Validation loss decreased (0.171092 --> 0.139482).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.940865516662598
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1259169  Vali Loss: 0.1290318 Vali Accuracy: 0.9509595  Vali weighted F1: 0.9507957  Vali macro F1 0.9317921 
new best score!!!!
Validation loss decreased (0.139482 --> 0.129032).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.930009603500366
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1205052  Vali Loss: 0.1180341 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9573776  Vali macro F1 0.9435099 
new best score!!!!
Validation loss decreased (0.129032 --> 0.118034).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.922461271286011
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1039539  Vali Loss: 0.1004519 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9617588  Vali macro F1 0.9502068 
new best score!!!!
Validation loss decreased (0.118034 --> 0.100452).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.922641038894653
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0949315  Vali Loss: 0.0945389 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9609728  Vali macro F1 0.9470352 
new best score!!!!
Validation loss decreased (0.100452 --> 0.094539).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.932939767837524
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0924432  Vali Loss: 0.1048600 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9600835  Vali macro F1 0.9407692 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.929624080657959
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0923987  Vali Loss: 0.0920295 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9655088  Vali macro F1 0.9481019 
new best score!!!!
Validation loss decreased (0.094539 --> 0.092029).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.939446687698364
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0781856  Vali Loss: 0.0972243 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9663173  Vali macro F1 0.9545233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.940643072128296
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0698649  Vali Loss: 0.0869435 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9707262  Vali macro F1 0.9620263 
new best score!!!!
Validation loss decreased (0.092029 --> 0.086944).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.927095174789429
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0727979  Vali Loss: 0.0939277 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9688158  Vali macro F1 0.9595101 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.937307834625244
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0670150  Vali Loss: 0.0770711 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9702166  Vali macro F1 0.9599919 
new best score!!!!
Validation loss decreased (0.086944 --> 0.077071).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.937626838684082
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0562122  Vali Loss: 0.0755165 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9738160  Vali macro F1 0.9664320 
new best score!!!!
Validation loss decreased (0.077071 --> 0.075516).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.954413890838623
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0558119  Vali Loss: 0.0692979 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771133  Vali macro F1 0.9725613 
new best score!!!!
Validation loss decreased (0.075516 --> 0.069298).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.921519041061401
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0589772  Vali Loss: 0.0661332 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9766344  Vali macro F1 0.9719364 
new best score!!!!
Validation loss decreased (0.069298 --> 0.066133).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.915794849395752
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0482056  Vali Loss: 0.0660406 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9758024  Vali macro F1 0.9684411 
new best score!!!!
Validation loss decreased (0.066133 --> 0.066041).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.9282238483428955
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0445386  Vali Loss: 0.0718966 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9783062  Vali macro F1 0.9719789 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.911011457443237
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0471449  Vali Loss: 0.0726362 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9750630  Vali macro F1 0.9679120 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.91753077507019
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0447331  Vali Loss: 0.0607897 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9783097  Vali macro F1 0.9707652 
new best score!!!!
Validation loss decreased (0.066041 --> 0.060790).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.94971489906311
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0469801  Vali Loss: 0.0708469 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9767998  Vali macro F1 0.9679491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.925978422164917
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0403367  Vali Loss: 0.0727124 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9694801  Vali macro F1 0.9585713 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 7.947872161865234
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0397219  Vali Loss: 0.0716685 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9744157  Vali macro F1 0.9680616 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.922338962554932
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0331288  Vali Loss: 0.0545341 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9846728  Vali macro F1 0.9800350 
new best score!!!!
Validation loss decreased (0.060790 --> 0.054534).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.92838191986084
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0299172  Vali Loss: 0.0783464 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9730417  Vali macro F1 0.9626696 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.923914909362793
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0329143  Vali Loss: 0.0687315 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823810  Vali macro F1 0.9773322 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.91586446762085
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0286047  Vali Loss: 0.0579037 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814632  Vali macro F1 0.9758880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.917425870895386
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0265811  Vali Loss: 0.0525418 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9847038  Vali macro F1 0.9788534 
new best score!!!!
Validation loss decreased (0.054534 --> 0.052542).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.9283764362335205
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0251500  Vali Loss: 0.0553819 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840507  Vali macro F1 0.9811225 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.930819749832153
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0283386  Vali Loss: 0.0555232 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824132  Vali macro F1 0.9771428 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.925544500350952
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0252875  Vali Loss: 0.0494422 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9803721  Vali macro F1 0.9735588 
new best score!!!!
Validation loss decreased (0.052542 --> 0.049442).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.924827337265015
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0196311  Vali Loss: 0.0525357 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9841378  Vali macro F1 0.9801336 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.927894353866577
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0252184  Vali Loss: 0.0553973 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819350  Vali macro F1 0.9717856 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.906321048736572
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0202692  Vali Loss: 0.0522474 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9836376  Vali macro F1 0.9787471 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.91475510597229
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0178789  Vali Loss: 0.0432842 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877274  Vali macro F1 0.9840394 
new best score!!!!
Validation loss decreased (0.049442 --> 0.043284).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.925917387008667
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0173753  Vali Loss: 0.0443321 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872429  Vali macro F1 0.9842027 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.921703338623047
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0170486  Vali Loss: 0.0525605 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9846470  Vali macro F1 0.9810445 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.938015937805176
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0229469  Vali Loss: 0.0542715 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9820469  Vali macro F1 0.9759743 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.942227363586426
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0181454  Vali Loss: 0.0669019 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835398  Vali macro F1 0.9774444 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 5.916955947875977
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0166512  Vali Loss: 0.0612186 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814023  Vali macro F1 0.9749419 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 5.922650575637817
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0102804  Vali Loss: 0.0443619 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872450  Vali macro F1 0.9820028 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.9153008460998535
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0078354  Vali Loss: 0.0446787 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867258  Vali macro F1 0.9820552 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.906683921813965
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0073748  Vali Loss: 0.0423261 Vali Accuracy: 0.9893390  Vali weighted F1: 0.9893837  Vali macro F1 0.9854108 
new best score!!!!
Validation loss decreased (0.043284 --> 0.042326).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 5.918928861618042
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0063945  Vali Loss: 0.0423088 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878050  Vali macro F1 0.9830679 
new best score!!!!
Validation loss decreased (0.042326 --> 0.042309).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 5.9326698780059814
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0069366  Vali Loss: 0.0424670 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877887  Vali macro F1 0.9831500 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.949509382247925
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0063608  Vali Loss: 0.0416274 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877887  Vali macro F1 0.9831500 
new best score!!!!
Validation loss decreased (0.042309 --> 0.041627).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 5.937505483627319
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0060964  Vali Loss: 0.0445360 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883166  Vali macro F1 0.9840571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 5.918731689453125
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0055547  Vali Loss: 0.0435652 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883061  Vali macro F1 0.9850255 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 5.909498929977417
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0054404  Vali Loss: 0.0433084 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883169  Vali macro F1 0.9846528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 5.913307189941406
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0056201  Vali Loss: 0.0417896 Vali Accuracy: 0.9893390  Vali weighted F1: 0.9893934  Vali macro F1 0.9856909 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 5.914043664932251
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0053909  Vali Loss: 0.0449452 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872613  Vali macro F1 0.9823186 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 5.9205756187438965
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0054245  Vali Loss: 0.0433670 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888582  Vali macro F1 0.9851991 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 5.931967735290527
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0049671  Vali Loss: 0.0428748 Vali Accuracy: 0.9893390  Vali weighted F1: 0.9893795  Vali macro F1 0.9857774 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 5.936893939971924
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0051926  Vali Loss: 0.0424683 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883205  Vali macro F1 0.9849330 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 5.9387946128845215
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0048239  Vali Loss: 0.0427883 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888555  Vali macro F1 0.9851871 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 5.9345808029174805
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0046562  Vali Loss: 0.0429255 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888555  Vali macro F1 0.9851871 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 5.924600124359131
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0047950  Vali Loss: 0.0428797 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888555  Vali macro F1 0.9851871 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 5.928545236587524
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0050925  Vali Loss: 0.0428302 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888555  Vali macro F1 0.9851871 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 5.919208288192749
VALI: Epoch: 64, Steps: 66 | Train Loss: 0.0049766  Vali Loss: 0.0427704 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888555  Vali macro F1 0.9851871 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 5.925392150878906
VALI: Epoch: 65, Steps: 66 | Train Loss: 0.0050516  Vali Loss: 0.0428500 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888555  Vali macro F1 0.9851871 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 5.913775205612183
VALI: Epoch: 66, Steps: 66 | Train Loss: 0.0045230  Vali Loss: 0.0428081 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888555  Vali macro F1 0.9851871 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9303652  Test weighted F1: 0.9331541  Test macro F1 0.9067256 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.975585460662842
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0067260  Vali Loss: 0.0444949 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872602  Vali macro F1 0.9822704 
Validation loss decreased (inf --> 0.044495).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.922837972640991
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0067332  Vali Loss: 0.0437555 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9882995  Vali macro F1 0.9847414 
new best score!!!!
Validation loss decreased (0.044495 --> 0.043755).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.921381950378418
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0058683  Vali Loss: 0.0466427 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9882995  Vali macro F1 0.9847414 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.9071455001831055
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0047469  Vali Loss: 0.0465405 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872401  Vali macro F1 0.9829883 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.933716058731079
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0057060  Vali Loss: 0.0414978 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888588  Vali macro F1 0.9851704 
new best score!!!!
Validation loss decreased (0.043755 --> 0.041498).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 5.943294048309326
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0055344  Vali Loss: 0.0432061 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888409  Vali macro F1 0.9852505 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.936547517776489
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0052289  Vali Loss: 0.0440731 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9882997  Vali macro F1 0.9847705 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.932510137557983
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0044050  Vali Loss: 0.0401254 Vali Accuracy: 0.9898721  Vali weighted F1: 0.9899251  Vali macro F1 0.9879034 
new best score!!!!
Validation loss decreased (0.041498 --> 0.040125).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 5.94820761680603
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0045500  Vali Loss: 0.0415037 Vali Accuracy: 0.9893390  Vali weighted F1: 0.9893919  Vali macro F1 0.9857986 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 5.943497896194458
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0050041  Vali Loss: 0.0413489 Vali Accuracy: 0.9893390  Vali weighted F1: 0.9893704  Vali macro F1 0.9861166 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 5.939335584640503
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0052377  Vali Loss: 0.0490485 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861903  Vali macro F1 0.9828034 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 5.937761306762695
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0043446  Vali Loss: 0.0423904 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883454  Vali macro F1 0.9843552 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 5.946720123291016
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0045847  Vali Loss: 0.0533843 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867090  Vali macro F1 0.9821238 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 5.93674635887146
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0046258  Vali Loss: 0.0443665 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877866  Vali macro F1 0.9834271 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 5.94260311126709
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0041933  Vali Loss: 0.0467363 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877905  Vali macro F1 0.9842551 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 5.936910152435303
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0037168  Vali Loss: 0.0439512 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867064  Vali macro F1 0.9836826 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 5.935348033905029
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0038655  Vali Loss: 0.0423024 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888518  Vali macro F1 0.9857430 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 5.970587730407715
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0041860  Vali Loss: 0.0453923 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883199  Vali macro F1 0.9855318 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 5.955516338348389
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0034970  Vali Loss: 0.0430841 Vali Accuracy: 0.9888060  Vali weighted F1: 0.9888616  Vali macro F1 0.9860411 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 5.956351280212402
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0036671  Vali Loss: 0.0445582 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883199  Vali macro F1 0.9855318 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 5.944223880767822
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0032751  Vali Loss: 0.0433763 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883199  Vali macro F1 0.9855318 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 5.947511434555054
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0030179  Vali Loss: 0.0434859 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883199  Vali macro F1 0.9855318 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 5.946561813354492
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0037804  Vali Loss: 0.0442516 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883199  Vali macro F1 0.9855318 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9245356  Test weighted F1: 0.9280395  Test macro F1 0.8996527 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001428  0.00018382 0.00096525 0.00125628 0.00053135 0.00063412]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.241503715515137
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0798983  Vali Loss: 0.6432677 Vali Accuracy: 0.7574835  Vali weighted F1: 0.7097927  Vali macro F1 0.5225800 
Validation loss decreased (inf --> 0.643268).  Saving model ...
Epoch: 2 cost time: 6.223822116851807
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5437879  Vali Loss: 0.5054760 Vali Accuracy: 0.8163369  Vali weighted F1: 0.7937387  Vali macro F1 0.7210742 
new best score!!!!
Validation loss decreased (0.643268 --> 0.505476).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.224512577056885
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4407942  Vali Loss: 0.4157798 Vali Accuracy: 0.8554033  Vali weighted F1: 0.8514572  Vali macro F1 0.7930107 
new best score!!!!
Validation loss decreased (0.505476 --> 0.415780).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.244581937789917
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3318685  Vali Loss: 0.2864057 Vali Accuracy: 0.8924404  Vali weighted F1: 0.8933460  Vali macro F1 0.8455167 
new best score!!!!
Validation loss decreased (0.415780 --> 0.286406).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.227586507797241
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2658972  Vali Loss: 0.2315419 Vali Accuracy: 0.9173009  Vali weighted F1: 0.9164105  Vali macro F1 0.8741606 
new best score!!!!
Validation loss decreased (0.286406 --> 0.231542).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.229823112487793
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2170960  Vali Loss: 0.1937504 Vali Accuracy: 0.9360731  Vali weighted F1: 0.9364262  Vali macro F1 0.9075054 
new best score!!!!
Validation loss decreased (0.231542 --> 0.193750).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.2278361320495605
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1876644  Vali Loss: 0.1698863 Vali Accuracy: 0.9411466  Vali weighted F1: 0.9410399  Vali macro F1 0.9155060 
new best score!!!!
Validation loss decreased (0.193750 --> 0.169886).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.222173690795898
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1650209  Vali Loss: 0.1559344 Vali Accuracy: 0.9487570  Vali weighted F1: 0.9485271  Vali macro F1 0.9264278 
new best score!!!!
Validation loss decreased (0.169886 --> 0.155934).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.237014293670654
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1459491  Vali Loss: 0.1447014 Vali Accuracy: 0.9467275  Vali weighted F1: 0.9466160  Vali macro F1 0.9192299 
new best score!!!!
Validation loss decreased (0.155934 --> 0.144701).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2196290493011475
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1360219  Vali Loss: 0.1300373 Vali Accuracy: 0.9548453  Vali weighted F1: 0.9546275  Vali macro F1 0.9373344 
new best score!!!!
Validation loss decreased (0.144701 --> 0.130037).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.234830856323242
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1231077  Vali Loss: 0.1135914 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9615920  Vali macro F1 0.9465853 
new best score!!!!
Validation loss decreased (0.130037 --> 0.113591).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.232037782669067
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1079331  Vali Loss: 0.1024300 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9649897  Vali macro F1 0.9471685 
new best score!!!!
Validation loss decreased (0.113591 --> 0.102430).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.246165037155151
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0984772  Vali Loss: 0.1015496 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9609705  Vali macro F1 0.9430474 
new best score!!!!
Validation loss decreased (0.102430 --> 0.101550).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.224670648574829
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0997990  Vali Loss: 0.0969981 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9650996  Vali macro F1 0.9504505 
new best score!!!!
Validation loss decreased (0.101550 --> 0.096998).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.217075347900391
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0899237  Vali Loss: 0.1054980 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9570858  Vali macro F1 0.9330021 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.241075277328491
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1010726  Vali Loss: 0.0760131 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727302  Vali macro F1 0.9592984 
new best score!!!!
Validation loss decreased (0.096998 --> 0.076013).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.2405877113342285
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0759115  Vali Loss: 0.0815729 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9703365  Vali macro F1 0.9550743 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.211223840713501
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0690733  Vali Loss: 0.1459686 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9517626  Vali macro F1 0.9385585 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.234170198440552
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0774096  Vali Loss: 0.0724899 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9747687  Vali macro F1 0.9638937 
new best score!!!!
Validation loss decreased (0.076013 --> 0.072490).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.2537841796875
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0684629  Vali Loss: 0.0784225 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9713461  Vali macro F1 0.9567883 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.226372003555298
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0559239  Vali Loss: 0.0638190 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9756435  Vali macro F1 0.9638740 
new best score!!!!
Validation loss decreased (0.072490 --> 0.063819).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.222402334213257
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0558089  Vali Loss: 0.0647584 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797331  Vali macro F1 0.9694681 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.214197635650635
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0505459  Vali Loss: 0.0537698 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797024  Vali macro F1 0.9691066 
new best score!!!!
Validation loss decreased (0.063819 --> 0.053770).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.2178404331207275
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0477461  Vali Loss: 0.0614885 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777430  Vali macro F1 0.9667185 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.22873067855835
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0472281  Vali Loss: 0.0515164 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798118  Vali macro F1 0.9675492 
new best score!!!!
Validation loss decreased (0.053770 --> 0.051516).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.2331764698028564
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0482268  Vali Loss: 0.0858296 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9705164  Vali macro F1 0.9587157 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.232600450515747
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0397969  Vali Loss: 0.0483882 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822236  Vali macro F1 0.9738949 
new best score!!!!
Validation loss decreased (0.051516 --> 0.048388).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.239711284637451
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0431978  Vali Loss: 0.0640309 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9767531  Vali macro F1 0.9677164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.2432146072387695
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0348581  Vali Loss: 0.0682443 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9784203  Vali macro F1 0.9711514 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.221829891204834
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0383791  Vali Loss: 0.0533718 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811364  Vali macro F1 0.9742200 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.224786043167114
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0389403  Vali Loss: 0.0598040 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798213  Vali macro F1 0.9687579 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.220992803573608
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0324354  Vali Loss: 0.0473204 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848101  Vali macro F1 0.9756975 
new best score!!!!
Validation loss decreased (0.048388 --> 0.047320).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.2256269454956055
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0281756  Vali Loss: 0.0438339 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853277  Vali macro F1 0.9779617 
new best score!!!!
Validation loss decreased (0.047320 --> 0.043834).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.219797134399414
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0309683  Vali Loss: 0.0553342 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828729  Vali macro F1 0.9729068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.228867769241333
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0311806  Vali Loss: 0.0411417 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883990  Vali macro F1 0.9835464 
new best score!!!!
Validation loss decreased (0.043834 --> 0.041142).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.24648642539978
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0327085  Vali Loss: 0.0496062 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9813394  Vali macro F1 0.9716816 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.2277538776397705
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0353004  Vali Loss: 0.0438013 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837814  Vali macro F1 0.9743069 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.213464975357056
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0223444  Vali Loss: 0.0377956 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868332  Vali macro F1 0.9805269 
new best score!!!!
Validation loss decreased (0.041142 --> 0.037796).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.191618204116821
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0259803  Vali Loss: 0.0496085 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857964  Vali macro F1 0.9781007 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.198440074920654
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0184913  Vali Loss: 0.0493835 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853929  Vali macro F1 0.9779232 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.213560581207275
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0190825  Vali Loss: 0.0384203 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858028  Vali macro F1 0.9782621 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.217136859893799
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0227597  Vali Loss: 0.0552145 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812459  Vali macro F1 0.9736556 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.224591493606567
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0215964  Vali Loss: 0.0495314 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837003  Vali macro F1 0.9794141 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 6.220040559768677
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0122455  Vali Loss: 0.0417361 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842466  Vali macro F1 0.9768595 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.221754312515259
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0104568  Vali Loss: 0.0388642 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868177  Vali macro F1 0.9806986 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.211515188217163
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0094835  Vali Loss: 0.0400165 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872938  Vali macro F1 0.9827087 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.2043137550354
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0093084  Vali Loss: 0.0398110 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857881  Vali macro F1 0.9796660 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.206067800521851
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0090143  Vali Loss: 0.0399042 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857760  Vali macro F1 0.9785341 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 6.202647686004639
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0091440  Vali Loss: 0.0399297 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857760  Vali macro F1 0.9785341 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.22122049331665
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0086091  Vali Loss: 0.0393253 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862943  Vali macro F1 0.9791625 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.224039316177368
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0084321  Vali Loss: 0.0391347 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862943  Vali macro F1 0.9791625 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.233935356140137
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0077462  Vali Loss: 0.0392061 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862980  Vali macro F1 0.9791791 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.201892375946045
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0081902  Vali Loss: 0.0389950 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863070  Vali macro F1 0.9787898 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9230557  Test weighted F1: 0.9213687  Test macro F1 0.9298265 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.258126974105835
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0147776  Vali Loss: 0.0398007 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863304  Vali macro F1 0.9810596 
Validation loss decreased (inf --> 0.039801).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.221430063247681
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0135147  Vali Loss: 0.0374154 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843320  Vali macro F1 0.9760169 
new best score!!!!
Validation loss decreased (0.039801 --> 0.037415).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.225693702697754
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0115705  Vali Loss: 0.0355914 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888553  Vali macro F1 0.9825292 
new best score!!!!
Validation loss decreased (0.037415 --> 0.035591).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.219743251800537
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0123090  Vali Loss: 0.0376086 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873418  Vali macro F1 0.9814021 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.2271974086761475
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0116852  Vali Loss: 0.0375600 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883064  Vali macro F1 0.9829468 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.231628894805908
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0109041  Vali Loss: 0.0391676 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842944  Vali macro F1 0.9764679 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.242869138717651
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0106909  Vali Loss: 0.0361895 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873293  Vali macro F1 0.9808481 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.22825026512146
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0103567  Vali Loss: 0.0359095 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873639  Vali macro F1 0.9821127 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.227092266082764
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0104619  Vali Loss: 0.0399424 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873601  Vali macro F1 0.9820983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.2243287563323975
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0101878  Vali Loss: 0.0388588 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858728  Vali macro F1 0.9807025 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.215178489685059
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0098391  Vali Loss: 0.0385031 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858350  Vali macro F1 0.9803183 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.221832036972046
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0096345  Vali Loss: 0.0426700 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858608  Vali macro F1 0.9801318 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.2219557762146
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0094438  Vali Loss: 0.0373435 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853652  Vali macro F1 0.9779400 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.224304676055908
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0083619  Vali Loss: 0.0364277 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873604  Vali macro F1 0.9818780 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.234880447387695
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0083666  Vali Loss: 0.0358009 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868357  Vali macro F1 0.9806714 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.245673418045044
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0074756  Vali Loss: 0.0358023 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878456  Vali macro F1 0.9833047 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.233692646026611
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0084695  Vali Loss: 0.0358593 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883480  Vali macro F1 0.9841892 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.221866846084595
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0079444  Vali Loss: 0.0358732 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888382  Vali macro F1 0.9843514 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9222284  Test weighted F1: 0.9209708  Test macro F1 0.9307993 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014223 0.00017892 0.00098039 0.00120192 0.00047619 0.00059916]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.384366273880005
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.0728825  Vali Loss: 0.5892293 Vali Accuracy: 0.7883572  Vali weighted F1: 0.7455242  Vali macro F1 0.6137555 
Validation loss decreased (inf --> 0.589229).  Saving model ...
Epoch: 2 cost time: 6.389264345169067
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.5217083  Vali Loss: 0.4316929 Vali Accuracy: 0.8589048  Vali weighted F1: 0.8453277  Vali macro F1 0.7912253 
new best score!!!!
Validation loss decreased (0.589229 --> 0.431693).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.395966291427612
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.4328010  Vali Loss: 0.3449504 Vali Accuracy: 0.8820918  Vali weighted F1: 0.8707736  Vali macro F1 0.8249249 
new best score!!!!
Validation loss decreased (0.431693 --> 0.344950).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.423203945159912
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.3440160  Vali Loss: 0.2948337 Vali Accuracy: 0.8954119  Vali weighted F1: 0.8892606  Vali macro F1 0.8473072 
new best score!!!!
Validation loss decreased (0.344950 --> 0.294834).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.392636775970459
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2749891  Vali Loss: 0.2460713 Vali Accuracy: 0.9171189  Vali weighted F1: 0.9131620  Vali macro F1 0.8869921 
new best score!!!!
Validation loss decreased (0.294834 --> 0.246071).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.392354249954224
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.2250369  Vali Loss: 0.1715778 Vali Accuracy: 0.9427726  Vali weighted F1: 0.9429993  Vali macro F1 0.9265015 
new best score!!!!
Validation loss decreased (0.246071 --> 0.171578).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.390104532241821
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1825310  Vali Loss: 0.1406879 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9565137  Vali macro F1 0.9424022 
new best score!!!!
Validation loss decreased (0.171578 --> 0.140688).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.389551877975464
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1662308  Vali Loss: 0.1270825 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9566723  Vali macro F1 0.9416999 
new best score!!!!
Validation loss decreased (0.140688 --> 0.127082).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.386624336242676
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1474197  Vali Loss: 0.1228374 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9590923  Vali macro F1 0.9449800 
new best score!!!!
Validation loss decreased (0.127082 --> 0.122837).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.3928327560424805
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1325850  Vali Loss: 0.1059752 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9678423  Vali macro F1 0.9583445 
new best score!!!!
Validation loss decreased (0.122837 --> 0.105975).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.3989832401275635
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1204172  Vali Loss: 0.1191091 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9596440  Vali macro F1 0.9435103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.420456171035767
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1185502  Vali Loss: 0.1237451 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9593021  Vali macro F1 0.9464763 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.403999328613281
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1094976  Vali Loss: 0.1020617 Vali Accuracy: 0.9674396  Vali weighted F1: 0.9672873  Vali macro F1 0.9568971 
new best score!!!!
Validation loss decreased (0.105975 --> 0.102062).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.401889324188232
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0981540  Vali Loss: 0.0955730 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9644313  Vali macro F1 0.9517964 
new best score!!!!
Validation loss decreased (0.102062 --> 0.095573).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.389400482177734
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0928265  Vali Loss: 0.1029290 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9674409  Vali macro F1 0.9572177 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.398507118225098
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0813894  Vali Loss: 0.0724535 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9760728  Vali macro F1 0.9673827 
new best score!!!!
Validation loss decreased (0.095573 --> 0.072453).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.404197931289673
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0737822  Vali Loss: 0.0763848 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9756606  Vali macro F1 0.9682971 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.392685651779175
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0755424  Vali Loss: 0.0716476 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9769102  Vali macro F1 0.9714926 
new best score!!!!
Validation loss decreased (0.072453 --> 0.071648).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.407500267028809
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0676555  Vali Loss: 0.0636146 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9792146  Vali macro F1 0.9738455 
new best score!!!!
Validation loss decreased (0.071648 --> 0.063615).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.416621208190918
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0624751  Vali Loss: 0.0773840 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9759571  Vali macro F1 0.9709758 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.402737140655518
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0579241  Vali Loss: 0.0616142 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9821714  Vali macro F1 0.9779771 
new best score!!!!
Validation loss decreased (0.063615 --> 0.061614).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.412246465682983
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0671342  Vali Loss: 0.0718435 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9747720  Vali macro F1 0.9683488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.399834632873535
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0537597  Vali Loss: 0.0681455 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9804156  Vali macro F1 0.9758191 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.411722421646118
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0424712  Vali Loss: 0.0500189 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852328  Vali macro F1 0.9812826 
new best score!!!!
Validation loss decreased (0.061614 --> 0.050019).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.407242059707642
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0454391  Vali Loss: 0.0533251 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9838139  Vali macro F1 0.9789320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.415727615356445
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0447394  Vali Loss: 0.0558408 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9799157  Vali macro F1 0.9756795 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.4098358154296875
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0454389  Vali Loss: 0.0608465 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9795393  Vali macro F1 0.9754623 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.4164323806762695
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0434515  Vali Loss: 0.0576836 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807377  Vali macro F1 0.9773071 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.410158395767212
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0384426  Vali Loss: 0.0559111 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9829092  Vali macro F1 0.9794755 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.407435178756714
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0277623  Vali Loss: 0.0486022 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852228  Vali macro F1 0.9821462 
new best score!!!!
Validation loss decreased (0.050019 --> 0.048602).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.41279673576355
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0245793  Vali Loss: 0.0488436 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832434  Vali macro F1 0.9797007 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.406349420547485
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0233481  Vali Loss: 0.0478749 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852210  Vali macro F1 0.9818897 
new best score!!!!
Validation loss decreased (0.048602 --> 0.047875).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.42116379737854
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0225354  Vali Loss: 0.0559322 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818315  Vali macro F1 0.9775748 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.414249897003174
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0233871  Vali Loss: 0.0505722 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827251  Vali macro F1 0.9783687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.425528287887573
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0218400  Vali Loss: 0.0515838 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9833335  Vali macro F1 0.9796457 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.410640239715576
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0198265  Vali Loss: 0.0507870 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9843818  Vali macro F1 0.9811910 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.396867513656616
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0209348  Vali Loss: 0.0514480 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842938  Vali macro F1 0.9806353 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 6.405893087387085
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0206541  Vali Loss: 0.0504215 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9797068 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.403918504714966
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0194924  Vali Loss: 0.0508590 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842629  Vali macro F1 0.9805620 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.414962530136108
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0192953  Vali Loss: 0.0505345 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842680  Vali macro F1 0.9803113 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.413330554962158
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0214727  Vali Loss: 0.0507206 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9797068 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.413351774215698
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0190727  Vali Loss: 0.0504441 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9797068 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 43 cost time: 6.423648357391357
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0203301  Vali Loss: 0.0504139 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9797068 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.4075541496276855
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0196446  Vali Loss: 0.0504093 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9797068 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.406938552856445
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0186762  Vali Loss: 0.0504485 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9797068 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.408782482147217
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0208466  Vali Loss: 0.0504900 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9797068 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.414092302322388
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0203194  Vali Loss: 0.0505319 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9797068 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8666419  Test weighted F1: 0.8571437  Test macro F1 0.6462939 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.435421943664551
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0237401  Vali Loss: 0.0481140 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842582  Vali macro F1 0.9801243 
Validation loss decreased (inf --> 0.048114).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.421048164367676
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0241667  Vali Loss: 0.0535571 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822470  Vali macro F1 0.9779607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.451693296432495
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0220100  Vali Loss: 0.0511754 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847867  Vali macro F1 0.9816259 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.408747673034668
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0202464  Vali Loss: 0.0471983 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837626  Vali macro F1 0.9802393 
new best score!!!!
Validation loss decreased (0.048114 --> 0.047198).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.42078971862793
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0206469  Vali Loss: 0.0481686 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842566  Vali macro F1 0.9803678 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.421308994293213
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0199087  Vali Loss: 0.0498312 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842554  Vali macro F1 0.9805827 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.42225980758667
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0198752  Vali Loss: 0.0523632 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842773  Vali macro F1 0.9807615 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.424281597137451
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0192124  Vali Loss: 0.0544632 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832892  Vali macro F1 0.9785235 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.422498464584351
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0202111  Vali Loss: 0.0511186 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847318  Vali macro F1 0.9817336 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.438376188278198
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0182227  Vali Loss: 0.0528477 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842460  Vali macro F1 0.9807541 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.43414568901062
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0183081  Vali Loss: 0.0528078 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847833  Vali macro F1 0.9814589 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.428060054779053
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0168411  Vali Loss: 0.0530072 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842696  Vali macro F1 0.9810694 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.417457580566406
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0174219  Vali Loss: 0.0537159 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832971  Vali macro F1 0.9794864 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.420353174209595
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0172762  Vali Loss: 0.0516294 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852687  Vali macro F1 0.9824131 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.42238974571228
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0155868  Vali Loss: 0.0504976 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847729  Vali macro F1 0.9814262 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.415604114532471
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0154361  Vali Loss: 0.0507551 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847684  Vali macro F1 0.9818113 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.415272951126099
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0151727  Vali Loss: 0.0509063 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852687  Vali macro F1 0.9824131 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.430204629898071
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0159100  Vali Loss: 0.0517589 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847593  Vali macro F1 0.9815448 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.456474781036377
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0148338  Vali Loss: 0.0515078 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847718  Vali macro F1 0.9815568 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8606873  Test weighted F1: 0.8517594  Test macro F1 0.6412961 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014451 0.00016909 0.00099108 0.00134953 0.00049579 0.00063694]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.363082647323608
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0895922  Vali Loss: 0.6796793 Vali Accuracy: 0.7627538  Vali weighted F1: 0.6896922  Vali macro F1 0.4626021 
Validation loss decreased (inf --> 0.679679).  Saving model ...
Epoch: 2 cost time: 6.3686065673828125
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5536920  Vali Loss: 0.4695099 Vali Accuracy: 0.8345716  Vali weighted F1: 0.8111866  Vali macro F1 0.7564834 
new best score!!!!
Validation loss decreased (0.679679 --> 0.469510).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.3624351024627686
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4164330  Vali Loss: 0.3601274 Vali Accuracy: 0.8736999  Vali weighted F1: 0.8644398  Vali macro F1 0.8219946 
new best score!!!!
Validation loss decreased (0.469510 --> 0.360127).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.37196683883667
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3082688  Vali Loss: 0.2494558 Vali Accuracy: 0.9187717  Vali weighted F1: 0.9170283  Vali macro F1 0.8863779 
new best score!!!!
Validation loss decreased (0.360127 --> 0.249456).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.372836589813232
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2302130  Vali Loss: 0.2076526 Vali Accuracy: 0.9321446  Vali weighted F1: 0.9317813  Vali macro F1 0.9084520 
new best score!!!!
Validation loss decreased (0.249456 --> 0.207653).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.371762752532959
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1930339  Vali Loss: 0.2363821 Vali Accuracy: 0.9212481  Vali weighted F1: 0.9177819  Vali macro F1 0.8914298 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.385068416595459
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1686277  Vali Loss: 0.1790627 Vali Accuracy: 0.9366023  Vali weighted F1: 0.9364746  Vali macro F1 0.9133800 
new best score!!!!
Validation loss decreased (0.207653 --> 0.179063).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.393552303314209
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1481616  Vali Loss: 0.1633478 Vali Accuracy: 0.9450223  Vali weighted F1: 0.9436657  Vali macro F1 0.9253137 
new best score!!!!
Validation loss decreased (0.179063 --> 0.163348).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.383423328399658
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1421123  Vali Loss: 0.1608820 Vali Accuracy: 0.9445270  Vali weighted F1: 0.9430727  Vali macro F1 0.9218102 
new best score!!!!
Validation loss decreased (0.163348 --> 0.160882).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.373202800750732
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1324242  Vali Loss: 0.1374010 Vali Accuracy: 0.9499752  Vali weighted F1: 0.9496592  Vali macro F1 0.9311915 
new best score!!!!
Validation loss decreased (0.160882 --> 0.137401).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.356956243515015
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1179770  Vali Loss: 0.1262350 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9599035  Vali macro F1 0.9469633 
new best score!!!!
Validation loss decreased (0.137401 --> 0.126235).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.367140293121338
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1032653  Vali Loss: 0.1186968 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9598419  Vali macro F1 0.9435153 
new best score!!!!
Validation loss decreased (0.126235 --> 0.118697).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.380428791046143
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0981333  Vali Loss: 0.1152964 Vali Accuracy: 0.9608717  Vali weighted F1: 0.9610567  Vali macro F1 0.9473436 
new best score!!!!
Validation loss decreased (0.118697 --> 0.115296).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.383505821228027
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0970836  Vali Loss: 0.1104500 Vali Accuracy: 0.9638435  Vali weighted F1: 0.9643804  Vali macro F1 0.9535666 
new best score!!!!
Validation loss decreased (0.115296 --> 0.110450).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.398849248886108
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0944246  Vali Loss: 0.0999195 Vali Accuracy: 0.9673105  Vali weighted F1: 0.9676824  Vali macro F1 0.9572901 
new best score!!!!
Validation loss decreased (0.110450 --> 0.099919).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.389037609100342
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0806989  Vali Loss: 0.0965616 Vali Accuracy: 0.9697870  Vali weighted F1: 0.9701399  Vali macro F1 0.9606011 
new best score!!!!
Validation loss decreased (0.099919 --> 0.096562).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.382913112640381
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0825824  Vali Loss: 0.0910122 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9689464  Vali macro F1 0.9581806 
new best score!!!!
Validation loss decreased (0.096562 --> 0.091012).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.360768795013428
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0760986  Vali Loss: 0.1066401 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9626244  Vali macro F1 0.9521168 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.365034818649292
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0679572  Vali Loss: 0.0805386 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9726023  Vali macro F1 0.9643725 
new best score!!!!
Validation loss decreased (0.091012 --> 0.080539).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.375755071640015
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0645317  Vali Loss: 0.0942095 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9676720  Vali macro F1 0.9591897 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.3730669021606445
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0626138  Vali Loss: 0.0955455 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9664418  Vali macro F1 0.9532306 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.373629331588745
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0630540  Vali Loss: 0.0826271 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9710213  Vali macro F1 0.9624337 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.3906214237213135
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0668384  Vali Loss: 0.0846948 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9712536  Vali macro F1 0.9611519 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.360876798629761
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0585760  Vali Loss: 0.0879084 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9716686  Vali macro F1 0.9635368 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 6.372281074523926
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0434427  Vali Loss: 0.0703337 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9782506  Vali macro F1 0.9711393 
new best score!!!!
Validation loss decreased (0.080539 --> 0.070334).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.3613691329956055
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0385720  Vali Loss: 0.0696103 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787652  Vali macro F1 0.9714086 
new best score!!!!
Validation loss decreased (0.070334 --> 0.069610).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.354801893234253
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0382541  Vali Loss: 0.0688122 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9777681  Vali macro F1 0.9706520 
new best score!!!!
Validation loss decreased (0.069610 --> 0.068812).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.358762741088867
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0375545  Vali Loss: 0.0679708 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787812  Vali macro F1 0.9717611 
new best score!!!!
Validation loss decreased (0.068812 --> 0.067971).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.360665559768677
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0367365  Vali Loss: 0.0691184 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797676  Vali macro F1 0.9737227 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.365750789642334
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0330001  Vali Loss: 0.0676922 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793169  Vali macro F1 0.9736049 
new best score!!!!
Validation loss decreased (0.067971 --> 0.067692).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.35374903678894
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0337815  Vali Loss: 0.0662931 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802695  Vali macro F1 0.9745835 
new best score!!!!
Validation loss decreased (0.067692 --> 0.066293).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.348131418228149
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0330622  Vali Loss: 0.0675450 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788308  Vali macro F1 0.9721811 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.350593328475952
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0322739  Vali Loss: 0.0645130 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792068  Vali macro F1 0.9730813 
new best score!!!!
Validation loss decreased (0.066293 --> 0.064513).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.3594651222229
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0310616  Vali Loss: 0.0636507 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9781970  Vali macro F1 0.9716582 
new best score!!!!
Validation loss decreased (0.064513 --> 0.063651).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.350171327590942
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0314460  Vali Loss: 0.0640070 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9782720  Vali macro F1 0.9718113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.353872776031494
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0318908  Vali Loss: 0.0623203 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802609  Vali macro F1 0.9742488 
new best score!!!!
Validation loss decreased (0.063651 --> 0.062320).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.357259035110474
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0295542  Vali Loss: 0.0638435 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802207  Vali macro F1 0.9739637 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.3628480434417725
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0322767  Vali Loss: 0.0637759 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797458  Vali macro F1 0.9739728 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.362106084823608
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0300499  Vali Loss: 0.0625066 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812121  Vali macro F1 0.9755169 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.3409810066223145
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0294099  Vali Loss: 0.0618452 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9801906  Vali macro F1 0.9747124 
new best score!!!!
Validation loss decreased (0.062320 --> 0.061845).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.3472981452941895
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0286527  Vali Loss: 0.0660583 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787762  Vali macro F1 0.9721350 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.352004051208496
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0281752  Vali Loss: 0.0617357 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9811806  Vali macro F1 0.9754803 
new best score!!!!
Validation loss decreased (0.061845 --> 0.061736).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.359375238418579
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0280840  Vali Loss: 0.0626565 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9806948  Vali macro F1 0.9743589 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.3527140617370605
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0276066  Vali Loss: 0.0629768 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817091  Vali macro F1 0.9763740 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.354990005493164
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0277868  Vali Loss: 0.0639222 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807145  Vali macro F1 0.9746774 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.3738861083984375
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0269721  Vali Loss: 0.0612875 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9806744  Vali macro F1 0.9749439 
new best score!!!!
Validation loss decreased (0.061736 --> 0.061287).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.364678382873535
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0257161  Vali Loss: 0.0652365 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9778740  Vali macro F1 0.9711653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.357866287231445
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0262443  Vali Loss: 0.0624067 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797553  Vali macro F1 0.9739942 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.3506128787994385
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0251232  Vali Loss: 0.0613604 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812003  Vali macro F1 0.9758178 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.359489679336548
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0245607  Vali Loss: 0.0617428 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9806929  Vali macro F1 0.9746344 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.357540607452393
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0242740  Vali Loss: 0.0636977 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797394  Vali macro F1 0.9733562 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 6.348897457122803
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0228979  Vali Loss: 0.0625479 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792508  Vali macro F1 0.9728536 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.3564629554748535
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0234492  Vali Loss: 0.0624713 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792627  Vali macro F1 0.9728752 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.3703930377960205
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0235697  Vali Loss: 0.0619381 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802162  Vali macro F1 0.9738567 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.356767654418945
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0234912  Vali Loss: 0.0619145 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802359  Vali macro F1 0.9742128 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.358881235122681
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0231326  Vali Loss: 0.0616854 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792335  Vali macro F1 0.9728025 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 57 cost time: 6.350769519805908
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0235980  Vali Loss: 0.0617165 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797394  Vali macro F1 0.9733562 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.3519134521484375
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0218358  Vali Loss: 0.0616688 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797394  Vali macro F1 0.9733562 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.34993839263916
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0228848  Vali Loss: 0.0616469 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797394  Vali macro F1 0.9733562 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.360182762145996
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0224267  Vali Loss: 0.0616274 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797394  Vali macro F1 0.9733562 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.375555515289307
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0221431  Vali Loss: 0.0616500 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797394  Vali macro F1 0.9733562 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8190533  Test weighted F1: 0.8192659  Test macro F1 0.7933037 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.399142742156982
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0267449  Vali Loss: 0.0622927 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797458  Vali macro F1 0.9739728 
Validation loss decreased (inf --> 0.062293).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.386113405227661
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0251795  Vali Loss: 0.0627742 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802369  Vali macro F1 0.9741951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.376358985900879
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0275187  Vali Loss: 0.0637620 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792640  Vali macro F1 0.9731732 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.374512672424316
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0245841  Vali Loss: 0.0650552 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792763  Vali macro F1 0.9732054 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.378303289413452
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0257617  Vali Loss: 0.0624938 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787529  Vali macro F1 0.9729230 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.382372856140137
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0254841  Vali Loss: 0.0628032 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9776582  Vali macro F1 0.9713331 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.390079736709595
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0239163  Vali Loss: 0.0634858 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797553  Vali macro F1 0.9733746 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.409409523010254
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0231662  Vali Loss: 0.0640781 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9786413  Vali macro F1 0.9726864 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.410598516464233
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0238986  Vali Loss: 0.0615511 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802842  Vali macro F1 0.9740018 
new best score!!!!
Validation loss decreased (0.062293 --> 0.061551).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.405796527862549
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0233641  Vali Loss: 0.0626154 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792711  Vali macro F1 0.9734875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.415118932723999
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0220055  Vali Loss: 0.0623415 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793213  Vali macro F1 0.9729837 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.4084837436676025
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0218094  Vali Loss: 0.0613503 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797459  Vali macro F1 0.9736578 
new best score!!!!
Validation loss decreased (0.061551 --> 0.061350).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.393446922302246
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0230502  Vali Loss: 0.0621278 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803003  Vali macro F1 0.9746281 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.4012370109558105
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0215559  Vali Loss: 0.0607012 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9782710  Vali macro F1 0.9718286 
new best score!!!!
Validation loss decreased (0.061350 --> 0.060701).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.4080283641815186
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0218800  Vali Loss: 0.0666490 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798554  Vali macro F1 0.9738830 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.428660869598389
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0216587  Vali Loss: 0.0612328 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807083  Vali macro F1 0.9749666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.407481670379639
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0198674  Vali Loss: 0.0635208 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792134  Vali macro F1 0.9727151 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.387052774429321
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0186855  Vali Loss: 0.0604069 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792499  Vali macro F1 0.9731284 
new best score!!!!
Validation loss decreased (0.060701 --> 0.060407).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.390011548995972
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0191050  Vali Loss: 0.0639465 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9776493  Vali macro F1 0.9707083 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.395614862442017
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0183351  Vali Loss: 0.0606501 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797533  Vali macro F1 0.9736866 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.383825302124023
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0184123  Vali Loss: 0.0624239 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787677  Vali macro F1 0.9726221 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.383314609527588
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0195052  Vali Loss: 0.0597392 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9781903  Vali macro F1 0.9719533 
new best score!!!!
Validation loss decreased (0.060407 --> 0.059739).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.421810150146484
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0188757  Vali Loss: 0.0602490 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9801263  Vali macro F1 0.9746541 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.4048402309417725
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0185293  Vali Loss: 0.0625912 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787381  Vali macro F1 0.9722913 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.396573781967163
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0178261  Vali Loss: 0.0615793 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9781569  Vali macro F1 0.9719171 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.393129587173462
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0191499  Vali Loss: 0.0624431 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792941  Vali macro F1 0.9732187 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.4096293449401855
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0163167  Vali Loss: 0.0619509 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9791570  Vali macro F1 0.9729593 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 6.4039146900177
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0152428  Vali Loss: 0.0621343 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797933  Vali macro F1 0.9740845 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.401132822036743
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0153075  Vali Loss: 0.0616459 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807484  Vali macro F1 0.9750487 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.413415908813477
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0142166  Vali Loss: 0.0617011 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802429  Vali macro F1 0.9745144 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.424312353134155
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0161035  Vali Loss: 0.0620661 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797933  Vali macro F1 0.9740845 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.404519081115723
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0150915  Vali Loss: 0.0616063 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792880  Vali macro F1 0.9735505 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 6.400179147720337
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0147282  Vali Loss: 0.0616345 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792880  Vali macro F1 0.9735505 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.395456790924072
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0136753  Vali Loss: 0.0617018 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792880  Vali macro F1 0.9735505 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.3977625370025635
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0151487  Vali Loss: 0.0616215 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792880  Vali macro F1 0.9735505 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.40172266960144
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0150763  Vali Loss: 0.0616636 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792880  Vali macro F1 0.9735505 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.403886556625366
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0156955  Vali Loss: 0.0617795 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792880  Vali macro F1 0.9735505 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8281657  Test weighted F1: 0.8294538  Test macro F1 0.8030889 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014601 0.00017819 0.00109529 0.00133156 0.00049603 0.00062735]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.264084100723267
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0911925  Vali Loss: 0.6356260 Vali Accuracy: 0.7569762  Vali weighted F1: 0.7010145  Vali macro F1 0.5252558 
Validation loss decreased (inf --> 0.635626).  Saving model ...
Epoch: 2 cost time: 6.223408222198486
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5582201  Vali Loss: 0.4713732 Vali Accuracy: 0.8356164  Vali weighted F1: 0.8075971  Vali macro F1 0.7523822 
new best score!!!!
Validation loss decreased (0.635626 --> 0.471373).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.216452360153198
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4467361  Vali Loss: 0.3744739 Vali Accuracy: 0.8640284  Vali weighted F1: 0.8523298  Vali macro F1 0.8111455 
new best score!!!!
Validation loss decreased (0.471373 --> 0.374474).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2204413414001465
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3406922  Vali Loss: 0.3218274 Vali Accuracy: 0.8853374  Vali weighted F1: 0.8787672  Vali macro F1 0.8483778 
new best score!!!!
Validation loss decreased (0.374474 --> 0.321827).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.230509281158447
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2578709  Vali Loss: 0.2179476 Vali Accuracy: 0.9244039  Vali weighted F1: 0.9250152  Vali macro F1 0.9000392 
new best score!!!!
Validation loss decreased (0.321827 --> 0.217948).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.230069637298584
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2030195  Vali Loss: 0.1765819 Vali Accuracy: 0.9452055  Vali weighted F1: 0.9438156  Vali macro F1 0.9275036 
new best score!!!!
Validation loss decreased (0.217948 --> 0.176582).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.229898691177368
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1727004  Vali Loss: 0.1549126 Vali Accuracy: 0.9548453  Vali weighted F1: 0.9540663  Vali macro F1 0.9406681 
new best score!!!!
Validation loss decreased (0.176582 --> 0.154913).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.237077951431274
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1515174  Vali Loss: 0.1544148 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9525726  Vali macro F1 0.9370044 
new best score!!!!
Validation loss decreased (0.154913 --> 0.154415).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.228657007217407
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1425253  Vali Loss: 0.1598190 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9515610  Vali macro F1 0.9385289 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.237492322921753
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1317022  Vali Loss: 0.1290129 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9612145  Vali macro F1 0.9494542 
new best score!!!!
Validation loss decreased (0.154415 --> 0.129013).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.225051164627075
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1126690  Vali Loss: 0.1115185 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9639179  Vali macro F1 0.9544456 
new best score!!!!
Validation loss decreased (0.129013 --> 0.111519).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.222877025604248
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1033401  Vali Loss: 0.1269175 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9604690  Vali macro F1 0.9479705 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.209689617156982
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0963810  Vali Loss: 0.1040709 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9710884  Vali macro F1 0.9644925 
new best score!!!!
Validation loss decreased (0.111519 --> 0.104071).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.21835732460022
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0920211  Vali Loss: 0.1082964 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9663611  Vali macro F1 0.9596754 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.221522092819214
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0857956  Vali Loss: 0.1128566 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9657227  Vali macro F1 0.9536019 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.2158989906311035
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0726787  Vali Loss: 0.1024618 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9678938  Vali macro F1 0.9544510 
new best score!!!!
Validation loss decreased (0.104071 --> 0.102462).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.238000154495239
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0682995  Vali Loss: 0.0848018 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9743587  Vali macro F1 0.9649964 
new best score!!!!
Validation loss decreased (0.102462 --> 0.084802).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.240725755691528
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0646602  Vali Loss: 0.0913348 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707063  Vali macro F1 0.9621554 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.224149942398071
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0664790  Vali Loss: 0.0821999 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9753107  Vali macro F1 0.9672907 
new best score!!!!
Validation loss decreased (0.084802 --> 0.082200).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.221420764923096
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0554064  Vali Loss: 0.0782462 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9783325  Vali macro F1 0.9712750 
new best score!!!!
Validation loss decreased (0.082200 --> 0.078246).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.227585315704346
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0560324  Vali Loss: 0.0912257 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9713139  Vali macro F1 0.9641292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.234301328659058
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0541834  Vali Loss: 0.0710367 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9793543  Vali macro F1 0.9710388 
new best score!!!!
Validation loss decreased (0.078246 --> 0.071037).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.230955600738525
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0486012  Vali Loss: 0.0707455 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766621  Vali macro F1 0.9700529 
new best score!!!!
Validation loss decreased (0.071037 --> 0.070745).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.234149217605591
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0422297  Vali Loss: 0.0752774 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9738839  Vali macro F1 0.9655233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.2447509765625
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0500494  Vali Loss: 0.0881807 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9686477  Vali macro F1 0.9616032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.2371721267700195
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0411369  Vali Loss: 0.0723927 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772030  Vali macro F1 0.9705389 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.216184139251709
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0413003  Vali Loss: 0.0851735 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9741352  Vali macro F1 0.9669483 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.215737819671631
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0376225  Vali Loss: 0.0763939 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778839  Vali macro F1 0.9712728 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 6.231352806091309
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0280088  Vali Loss: 0.0601727 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833073  Vali macro F1 0.9782498 
new best score!!!!
Validation loss decreased (0.070745 --> 0.060173).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.23042893409729
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0238413  Vali Loss: 0.0604113 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837952  Vali macro F1 0.9791103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.227845907211304
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0233617  Vali Loss: 0.0600889 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837952  Vali macro F1 0.9791103 
new best score!!!!
Validation loss decreased (0.060173 --> 0.060089).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.226605176925659
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0206907  Vali Loss: 0.0603234 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838050  Vali macro F1 0.9791350 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.246528625488281
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0219547  Vali Loss: 0.0597935 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848159  Vali macro F1 0.9804390 
new best score!!!!
Validation loss decreased (0.060089 --> 0.059794).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.241579532623291
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0204475  Vali Loss: 0.0600157 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832708  Vali macro F1 0.9783497 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.218938589096069
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0201133  Vali Loss: 0.0592760 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827641  Vali macro F1 0.9778447 
new best score!!!!
Validation loss decreased (0.059794 --> 0.059276).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.2274134159088135
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0199249  Vali Loss: 0.0623183 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842863  Vali macro F1 0.9780564 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.229250907897949
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0195175  Vali Loss: 0.0602272 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832730  Vali macro F1 0.9773666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.231274843215942
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0202615  Vali Loss: 0.0611175 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832800  Vali macro F1 0.9783574 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.227396488189697
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0192058  Vali Loss: 0.0615507 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832574  Vali macro F1 0.9785155 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.229773759841919
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0185364  Vali Loss: 0.0608041 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832649  Vali macro F1 0.9786609 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 41 cost time: 6.240147113800049
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0174628  Vali Loss: 0.0608270 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832649  Vali macro F1 0.9786609 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.245234251022339
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0173294  Vali Loss: 0.0609630 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832605  Vali macro F1 0.9783248 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.244720220565796
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0175498  Vali Loss: 0.0612970 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832800  Vali macro F1 0.9783574 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.237798452377319
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0172075  Vali Loss: 0.0610698 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827780  Vali macro F1 0.9778014 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.228160858154297
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0188362  Vali Loss: 0.0606828 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827780  Vali macro F1 0.9778014 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 46 cost time: 6.235446929931641
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0170000  Vali Loss: 0.0607193 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827780  Vali macro F1 0.9778014 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.228001356124878
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0169349  Vali Loss: 0.0607352 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827780  Vali macro F1 0.9778014 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.232334852218628
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0174553  Vali Loss: 0.0607036 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827780  Vali macro F1 0.9778014 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.238020181655884
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0170417  Vali Loss: 0.0606979 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827780  Vali macro F1 0.9778014 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.238723516464233
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0176132  Vali Loss: 0.0607041 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832800  Vali macro F1 0.9783574 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9338364  Test weighted F1: 0.9339163  Test macro F1 0.8859022 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.255401611328125
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0218235  Vali Loss: 0.0600119 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837605  Vali macro F1 0.9787355 
Validation loss decreased (inf --> 0.060012).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2107298374176025
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0201050  Vali Loss: 0.0604766 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842950  Vali macro F1 0.9788663 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.210851430892944
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0191204  Vali Loss: 0.0615984 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837885  Vali macro F1 0.9801406 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.21458625793457
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0199020  Vali Loss: 0.0606210 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847937  Vali macro F1 0.9801668 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.233394622802734
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0180194  Vali Loss: 0.0612065 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832704  Vali macro F1 0.9783499 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.243407964706421
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0182155  Vali Loss: 0.0609266 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843186  Vali macro F1 0.9797414 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.2420783042907715
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0175342  Vali Loss: 0.0619528 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847784  Vali macro F1 0.9811704 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.254061460494995
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0165484  Vali Loss: 0.0632396 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847846  Vali macro F1 0.9799189 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.247851610183716
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0181761  Vali Loss: 0.0612369 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857949  Vali macro F1 0.9822522 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.230039119720459
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0164575  Vali Loss: 0.0606878 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847991  Vali macro F1 0.9804860 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.232811450958252
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0145374  Vali Loss: 0.0601508 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848072  Vali macro F1 0.9801776 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.234632730484009
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0158814  Vali Loss: 0.0599206 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848072  Vali macro F1 0.9801776 
new best score!!!!
Validation loss decreased (0.060012 --> 0.059921).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.254216432571411
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0146503  Vali Loss: 0.0599014 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848072  Vali macro F1 0.9801776 
new best score!!!!
Validation loss decreased (0.059921 --> 0.059901).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.25032377243042
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0145096  Vali Loss: 0.0600132 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853089  Vali macro F1 0.9816392 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.231756925582886
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0141182  Vali Loss: 0.0598025 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848001  Vali macro F1 0.9813939 
new best score!!!!
Validation loss decreased (0.059901 --> 0.059803).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.239081144332886
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0153729  Vali Loss: 0.0600114 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858106  Vali macro F1 0.9821951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.265375852584839
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0144971  Vali Loss: 0.0600368 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853089  Vali macro F1 0.9816392 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.243583917617798
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0149516  Vali Loss: 0.0594317 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853089  Vali macro F1 0.9816392 
new best score!!!!
Validation loss decreased (0.059803 --> 0.059432).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.23110032081604
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0156114  Vali Loss: 0.0599247 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858106  Vali macro F1 0.9821951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.234480619430542
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0154704  Vali Loss: 0.0595784 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848070  Vali macro F1 0.9808214 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.245393753051758
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0157325  Vali Loss: 0.0591913 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848070  Vali macro F1 0.9808214 
new best score!!!!
Validation loss decreased (0.059432 --> 0.059191).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.239367485046387
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0146717  Vali Loss: 0.0591999 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853089  Vali macro F1 0.9816392 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.240870237350464
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0149621  Vali Loss: 0.0592419 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843053  Vali macro F1 0.9793599 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.239368915557861
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0144057  Vali Loss: 0.0594242 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.248840093612671
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0141109  Vali Loss: 0.0589391 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848070  Vali macro F1 0.9808214 
new best score!!!!
Validation loss decreased (0.059191 --> 0.058939).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.258411884307861
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0152701  Vali Loss: 0.0594996 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853089  Vali macro F1 0.9816392 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.248448848724365
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0147971  Vali Loss: 0.0596256 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848062  Vali macro F1 0.9798588 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.246093034744263
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0137600  Vali Loss: 0.0593306 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.244235038757324
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0145974  Vali Loss: 0.0593267 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.2354817390441895
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0147522  Vali Loss: 0.0591789 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853089  Vali macro F1 0.9816392 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 6.237591743469238
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0142390  Vali Loss: 0.0591462 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853089  Vali macro F1 0.9816392 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.246896028518677
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0148406  Vali Loss: 0.0591453 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853089  Vali macro F1 0.9816392 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.243770360946655
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0139522  Vali Loss: 0.0591356 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.250459909439087
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0142505  Vali Loss: 0.0591177 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848004  Vali macro F1 0.9798560 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.238013744354248
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0140317  Vali Loss: 0.0591566 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848004  Vali macro F1 0.9798560 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 36 cost time: 6.235394477844238
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0144608  Vali Loss: 0.0591579 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.2298424243927
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0150012  Vali Loss: 0.0591532 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.235398054122925
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0137862  Vali Loss: 0.0591571 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.242280006408691
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0145398  Vali Loss: 0.0591609 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.238703727722168
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0143814  Vali Loss: 0.0591602 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842985  Vali macro F1 0.9790382 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9343885  Test weighted F1: 0.9345036  Test macro F1 0.8862737 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00014029 0.00018169 0.00103093 0.00130208 0.00049358 0.00059809]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.342623949050903
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.1061113  Vali Loss: 0.7106231 Vali Accuracy: 0.7390438  Vali weighted F1: 0.6648831  Vali macro F1 0.4655789 
Validation loss decreased (inf --> 0.710623).  Saving model ...
Epoch: 2 cost time: 6.313300371170044
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5508263  Vali Loss: 0.5003518 Vali Accuracy: 0.8172311  Vali weighted F1: 0.8052273  Vali macro F1 0.7591289 
new best score!!!!
Validation loss decreased (0.710623 --> 0.500352).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.315668821334839
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4271710  Vali Loss: 0.3991747 Vali Accuracy: 0.8620518  Vali weighted F1: 0.8494847  Vali macro F1 0.8089390 
new best score!!!!
Validation loss decreased (0.500352 --> 0.399175).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.317574739456177
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3227722  Vali Loss: 0.2858547 Vali Accuracy: 0.8994024  Vali weighted F1: 0.8959391  Vali macro F1 0.8653308 
new best score!!!!
Validation loss decreased (0.399175 --> 0.285855).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.33084774017334
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2638763  Vali Loss: 0.2712023 Vali Accuracy: 0.9033865  Vali weighted F1: 0.9005779  Vali macro F1 0.8726864 
new best score!!!!
Validation loss decreased (0.285855 --> 0.271202).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.3369057178497314
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2123826  Vali Loss: 0.1881213 Vali Accuracy: 0.9397410  Vali weighted F1: 0.9384968  Vali macro F1 0.9211839 
new best score!!!!
Validation loss decreased (0.271202 --> 0.188121).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.32979416847229
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1771277  Vali Loss: 0.1701652 Vali Accuracy: 0.9477092  Vali weighted F1: 0.9464138  Vali macro F1 0.9318361 
new best score!!!!
Validation loss decreased (0.188121 --> 0.170165).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.336509704589844
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1644608  Vali Loss: 0.1567346 Vali Accuracy: 0.9501992  Vali weighted F1: 0.9492199  Vali macro F1 0.9368316 
new best score!!!!
Validation loss decreased (0.170165 --> 0.156735).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.356801509857178
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1454781  Vali Loss: 0.1241412 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9586954  Vali macro F1 0.9432352 
new best score!!!!
Validation loss decreased (0.156735 --> 0.124141).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.344196557998657
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1310234  Vali Loss: 0.1724354 Vali Accuracy: 0.9516932  Vali weighted F1: 0.9521516  Vali macro F1 0.9407140 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.328341484069824
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1197720  Vali Loss: 0.1360834 Vali Accuracy: 0.9526892  Vali weighted F1: 0.9522753  Vali macro F1 0.9351153 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.330411911010742
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1141334  Vali Loss: 0.1064990 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9648640  Vali macro F1 0.9552783 
new best score!!!!
Validation loss decreased (0.124141 --> 0.106499).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.349272727966309
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1036613  Vali Loss: 0.1088502 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9640261  Vali macro F1 0.9559517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.339844703674316
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0896803  Vali Loss: 0.1034974 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9676371  Vali macro F1 0.9595676 
new best score!!!!
Validation loss decreased (0.106499 --> 0.103497).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.342428684234619
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0903938  Vali Loss: 0.0932478 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697276  Vali macro F1 0.9584234 
new best score!!!!
Validation loss decreased (0.103497 --> 0.093248).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.347564935684204
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0968580  Vali Loss: 0.1383820 Vali Accuracy: 0.9566733  Vali weighted F1: 0.9555606  Vali macro F1 0.9454442 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.365186452865601
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0778995  Vali Loss: 0.0854714 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733173  Vali macro F1 0.9654294 
new best score!!!!
Validation loss decreased (0.093248 --> 0.085471).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.3542163372039795
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0746392  Vali Loss: 0.0834094 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9735381  Vali macro F1 0.9647081 
new best score!!!!
Validation loss decreased (0.085471 --> 0.083409).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.329532861709595
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0726111  Vali Loss: 0.0816221 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9760630  Vali macro F1 0.9681043 
new best score!!!!
Validation loss decreased (0.083409 --> 0.081622).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.339220285415649
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0654311  Vali Loss: 0.0879885 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9701683  Vali macro F1 0.9612012 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.344679832458496
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0647018  Vali Loss: 0.0786954 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9751297  Vali macro F1 0.9660701 
new best score!!!!
Validation loss decreased (0.081622 --> 0.078695).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.336881399154663
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0554335  Vali Loss: 0.0801900 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9782619  Vali macro F1 0.9716996 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.338370084762573
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0591306  Vali Loss: 0.0737537 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9777603  Vali macro F1 0.9713034 
new best score!!!!
Validation loss decreased (0.078695 --> 0.073754).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.3433496952056885
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0543137  Vali Loss: 0.0764913 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9751839  Vali macro F1 0.9672266 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.3508241176605225
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0487764  Vali Loss: 0.0704315 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9782364  Vali macro F1 0.9710922 
new best score!!!!
Validation loss decreased (0.073754 --> 0.070432).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.34350061416626
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0457592  Vali Loss: 0.0644745 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9791509  Vali macro F1 0.9730818 
new best score!!!!
Validation loss decreased (0.070432 --> 0.064475).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.329836130142212
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0571404  Vali Loss: 0.0668933 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811488  Vali macro F1 0.9739834 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.341968774795532
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0455464  Vali Loss: 0.0685445 Vali Accuracy: 0.9770916  Vali weighted F1: 0.9770900  Vali macro F1 0.9698219 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.339724540710449
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0410019  Vali Loss: 0.0642893 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816207  Vali macro F1 0.9746200 
new best score!!!!
Validation loss decreased (0.064475 --> 0.064289).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 8.09129548072815
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0390385  Vali Loss: 0.0815719 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9756996  Vali macro F1 0.9675408 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.2617998123168945
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0361665  Vali Loss: 0.0876892 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9726234  Vali macro F1 0.9635929 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.270200490951538
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0425712  Vali Loss: 0.0724760 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732843  Vali macro F1 0.9659813 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.262333631515503
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0349029  Vali Loss: 0.0822254 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9757119  Vali macro F1 0.9692837 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.2610509395599365
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0345071  Vali Loss: 0.0643492 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831257  Vali macro F1 0.9764014 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.254106521606445
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0231405  Vali Loss: 0.0585102 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816441  Vali macro F1 0.9749424 
new best score!!!!
Validation loss decreased (0.064289 --> 0.058510).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.260402202606201
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0199806  Vali Loss: 0.0582149 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835637  Vali macro F1 0.9776824 
new best score!!!!
Validation loss decreased (0.058510 --> 0.058215).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.254583358764648
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0199383  Vali Loss: 0.0597191 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825690  Vali macro F1 0.9760751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.259349584579468
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0193538  Vali Loss: 0.0588522 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815687  Vali macro F1 0.9751657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.36767578125
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0177443  Vali Loss: 0.0615423 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821210  Vali macro F1 0.9756761 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.277163982391357
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0165667  Vali Loss: 0.0597809 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811368  Vali macro F1 0.9743579 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.269761800765991
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0180239  Vali Loss: 0.0590714 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826069  Vali macro F1 0.9762823 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 6.2614099979400635
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0165113  Vali Loss: 0.0600616 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811282  Vali macro F1 0.9742005 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.25852108001709
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0169526  Vali Loss: 0.0600198 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806173  Vali macro F1 0.9737356 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.265523910522461
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0156708  Vali Loss: 0.0595325 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816023  Vali macro F1 0.9749608 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.263449668884277
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0168008  Vali Loss: 0.0594654 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810941  Vali macro F1 0.9745121 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.259341716766357
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0163640  Vali Loss: 0.0596101 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816059  Vali macro F1 0.9749786 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 6.264708518981934
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0163695  Vali Loss: 0.0595808 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816059  Vali macro F1 0.9749786 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.2681379318237305
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0165957  Vali Loss: 0.0594796 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816059  Vali macro F1 0.9749786 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.262851238250732
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0153833  Vali Loss: 0.0594899 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816059  Vali macro F1 0.9749786 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.273607969284058
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0161627  Vali Loss: 0.0595579 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816059  Vali macro F1 0.9749786 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.265408039093018
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0158461  Vali Loss: 0.0595589 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816059  Vali macro F1 0.9749786 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9435824  Test weighted F1: 0.9434345  Test macro F1 0.9229729 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.297623634338379
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0199736  Vali Loss: 0.0599811 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821292  Vali macro F1 0.9755876 
Validation loss decreased (inf --> 0.059981).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.285238265991211
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0186715  Vali Loss: 0.0581058 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821000  Vali macro F1 0.9757704 
new best score!!!!
Validation loss decreased (0.059981 --> 0.058106).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.292432069778442
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0183702  Vali Loss: 0.0609644 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835752  Vali macro F1 0.9778974 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.3121936321258545
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0167477  Vali Loss: 0.0589174 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825772  Vali macro F1 0.9759732 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.315326690673828
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0151843  Vali Loss: 0.0604538 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825933  Vali macro F1 0.9766045 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.297884225845337
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0179613  Vali Loss: 0.0674122 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821582  Vali macro F1 0.9764742 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.297144889831543
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0153935  Vali Loss: 0.0627957 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806607  Vali macro F1 0.9742700 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.3000829219818115
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0167639  Vali Loss: 0.0581433 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830606  Vali macro F1 0.9761675 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.293953895568848
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0146054  Vali Loss: 0.0577745 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850585  Vali macro F1 0.9801719 
new best score!!!!
Validation loss decreased (0.058106 --> 0.057775).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.300334215164185
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0159824  Vali Loss: 0.0601676 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835759  Vali macro F1 0.9770467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.304412126541138
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0148057  Vali Loss: 0.0575749 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845651  Vali macro F1 0.9785414 
new best score!!!!
Validation loss decreased (0.057775 --> 0.057575).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.309406518936157
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0144597  Vali Loss: 0.0572004 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840740  Vali macro F1 0.9791209 
new best score!!!!
Validation loss decreased (0.057575 --> 0.057200).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.312674522399902
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0140437  Vali Loss: 0.0589013 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845767  Vali macro F1 0.9783777 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.314030170440674
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0137097  Vali Loss: 0.0570431 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820764  Vali macro F1 0.9758068 
new best score!!!!
Validation loss decreased (0.057200 --> 0.057043).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.303949356079102
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0135038  Vali Loss: 0.0586118 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825887  Vali macro F1 0.9759749 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.3165366649627686
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0136693  Vali Loss: 0.0583797 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841035  Vali macro F1 0.9782368 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.300540924072266
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0134873  Vali Loss: 0.0599953 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835597  Vali macro F1 0.9777882 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.300597429275513
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0125070  Vali Loss: 0.0624544 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826531  Vali macro F1 0.9771894 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.305967569351196
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0126393  Vali Loss: 0.0605262 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825897  Vali macro F1 0.9764849 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.313391923904419
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0110097  Vali Loss: 0.0606705 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835738  Vali macro F1 0.9783616 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.3243842124938965
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0115008  Vali Loss: 0.0604339 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825876  Vali macro F1 0.9771334 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.322675704956055
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0119881  Vali Loss: 0.0599384 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825876  Vali macro F1 0.9771334 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.3085246086120605
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0116733  Vali Loss: 0.0598222 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840686  Vali macro F1 0.9778263 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.284138917922974
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0106806  Vali Loss: 0.0597641 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820967  Vali macro F1 0.9748926 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 6.291344165802002
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0114726  Vali Loss: 0.0597453 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820967  Vali macro F1 0.9748926 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.294643402099609
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0113811  Vali Loss: 0.0597816 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820967  Vali macro F1 0.9748926 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.303670883178711
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0112459  Vali Loss: 0.0597720 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825953  Vali macro F1 0.9757034 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.304784297943115
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0113308  Vali Loss: 0.0598080 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825953  Vali macro F1 0.9757034 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.314440965652466
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0113210  Vali Loss: 0.0597842 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820967  Vali macro F1 0.9748926 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9432498  Test weighted F1: 0.9430722  Test macro F1 0.9213886 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 138143
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014616 0.00018232 0.00096154 0.001221   0.00048263 0.00060864]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.219484329223633
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0772346  Vali Loss: 0.6717225 Vali Accuracy: 0.7611865  Vali weighted F1: 0.7136996  Vali macro F1 0.4917317 
Validation loss decreased (inf --> 0.671723).  Saving model ...
Epoch: 2 cost time: 6.218332052230835
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5742873  Vali Loss: 0.4799397 Vali Accuracy: 0.8360985  Vali weighted F1: 0.8184436  Vali macro F1 0.7677857 
new best score!!!!
Validation loss decreased (0.671723 --> 0.479940).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.218751430511475
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4132390  Vali Loss: 0.3696537 Vali Accuracy: 0.8707893  Vali weighted F1: 0.8685459  Vali macro F1 0.8342021 
new best score!!!!
Validation loss decreased (0.479940 --> 0.369654).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.220816373825073
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2858106  Vali Loss: 0.2960279 Vali Accuracy: 0.9019608  Vali weighted F1: 0.8940070  Vali macro F1 0.8744370 
new best score!!!!
Validation loss decreased (0.369654 --> 0.296028).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.227364540100098
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2336888  Vali Loss: 0.2124286 Vali Accuracy: 0.9351433  Vali weighted F1: 0.9339052  Vali macro F1 0.9159547 
new best score!!!!
Validation loss decreased (0.296028 --> 0.212429).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.243415117263794
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1981214  Vali Loss: 0.1874435 Vali Accuracy: 0.9406737  Vali weighted F1: 0.9390794  Vali macro F1 0.9225740 
new best score!!!!
Validation loss decreased (0.212429 --> 0.187444).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.251488924026489
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1750847  Vali Loss: 0.1642550 Vali Accuracy: 0.9467069  Vali weighted F1: 0.9462676  Vali macro F1 0.9298601 
new best score!!!!
Validation loss decreased (0.187444 --> 0.164255).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.2282493114471436
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1573508  Vali Loss: 0.1397963 Vali Accuracy: 0.9562594  Vali weighted F1: 0.9566624  Vali macro F1 0.9427228 
new best score!!!!
Validation loss decreased (0.164255 --> 0.139796).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.238526105880737
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1505082  Vali Loss: 0.1449554 Vali Accuracy: 0.9517345  Vali weighted F1: 0.9505020  Vali macro F1 0.9343834 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.227510213851929
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1343739  Vali Loss: 0.1271781 Vali Accuracy: 0.9512318  Vali weighted F1: 0.9513010  Vali macro F1 0.9301021 
new best score!!!!
Validation loss decreased (0.139796 --> 0.127178).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.227326154708862
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1186913  Vali Loss: 0.1197154 Vali Accuracy: 0.9572650  Vali weighted F1: 0.9570344  Vali macro F1 0.9381192 
new best score!!!!
Validation loss decreased (0.127178 --> 0.119715).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.230364561080933
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1094238  Vali Loss: 0.0970405 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9651623  Vali macro F1 0.9510339 
new best score!!!!
Validation loss decreased (0.119715 --> 0.097041).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.238319396972656
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1000288  Vali Loss: 0.0969677 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9644296  Vali macro F1 0.9486377 
new best score!!!!
Validation loss decreased (0.097041 --> 0.096968).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.234021902084351
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0923704  Vali Loss: 0.0789570 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9740757  Vali macro F1 0.9686586 
new best score!!!!
Validation loss decreased (0.096968 --> 0.078957).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.247101306915283
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0828311  Vali Loss: 0.0962121 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9679515  Vali macro F1 0.9597818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.258671998977661
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0833696  Vali Loss: 0.0833248 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9705694  Vali macro F1 0.9638753 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.237422704696655
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0788708  Vali Loss: 0.0681454 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9773522  Vali macro F1 0.9703230 
new best score!!!!
Validation loss decreased (0.078957 --> 0.068145).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.242112398147583
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0740500  Vali Loss: 0.0659234 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787890  Vali macro F1 0.9726616 
new best score!!!!
Validation loss decreased (0.068145 --> 0.065923).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.237965106964111
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0672621  Vali Loss: 0.0624798 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764750  Vali macro F1 0.9688358 
new best score!!!!
Validation loss decreased (0.065923 --> 0.062480).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.231685161590576
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0635317  Vali Loss: 0.0511472 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9829785  Vali macro F1 0.9781932 
new best score!!!!
Validation loss decreased (0.062480 --> 0.051147).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.229554176330566
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0617672  Vali Loss: 0.0712551 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754025  Vali macro F1 0.9687960 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.212735652923584
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0528842  Vali Loss: 0.0636531 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802779  Vali macro F1 0.9754194 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.226639270782471
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0515616  Vali Loss: 0.0565265 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9796939  Vali macro F1 0.9741451 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.228469371795654
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0494900  Vali Loss: 0.0623460 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9788252  Vali macro F1 0.9733358 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 6.220324277877808
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0501076  Vali Loss: 0.0473077 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839320  Vali macro F1 0.9799777 
new best score!!!!
Validation loss decreased (0.051147 --> 0.047308).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.220470190048218
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0463556  Vali Loss: 0.0578910 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9780088  Vali macro F1 0.9698119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.214599370956421
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0438222  Vali Loss: 0.0492053 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833946  Vali macro F1 0.9782070 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.217019319534302
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0424097  Vali Loss: 0.0553174 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787957  Vali macro F1 0.9727276 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.212334394454956
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0452743  Vali Loss: 0.0661041 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9793582  Vali macro F1 0.9744674 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.221180200576782
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0364858  Vali Loss: 0.0470418 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839553  Vali macro F1 0.9773656 
new best score!!!!
Validation loss decreased (0.047308 --> 0.047042).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.24238133430481
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0341243  Vali Loss: 0.0475378 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848838  Vali macro F1 0.9804448 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.223878622055054
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0471525  Vali Loss: 0.0558800 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844928  Vali macro F1 0.9776450 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.212587356567383
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0327936  Vali Loss: 0.0463817 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849358  Vali macro F1 0.9807854 
new best score!!!!
Validation loss decreased (0.047042 --> 0.046382).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.220293283462524
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0291837  Vali Loss: 0.0526965 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833469  Vali macro F1 0.9778132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.2131805419921875
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0241622  Vali Loss: 0.0409445 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859184  Vali macro F1 0.9801416 
new best score!!!!
Validation loss decreased (0.046382 --> 0.040945).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.210479736328125
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0213792  Vali Loss: 0.0497174 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9868968  Vali macro F1 0.9820542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.2094786167144775
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0236547  Vali Loss: 0.0470974 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859529  Vali macro F1 0.9785677 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.219026565551758
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0274650  Vali Loss: 0.0564718 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824557  Vali macro F1 0.9768496 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.248722076416016
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0209975  Vali Loss: 0.0487070 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859586  Vali macro F1 0.9811587 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.213490009307861
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0242005  Vali Loss: 0.0382526 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874126  Vali macro F1 0.9829586 
new best score!!!!
Validation loss decreased (0.040945 --> 0.038253).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.209768772125244
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0193464  Vali Loss: 0.0445318 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863837  Vali macro F1 0.9803707 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.2043986320495605
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0301884  Vali Loss: 0.0609052 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9807438  Vali macro F1 0.9733912 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.2085511684417725
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0219998  Vali Loss: 0.0495969 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864197  Vali macro F1 0.9818648 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.217891693115234
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0153150  Vali Loss: 0.0416573 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9878791  Vali macro F1 0.9832661 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.221459627151489
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0154286  Vali Loss: 0.0464769 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849600  Vali macro F1 0.9783723 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 6.233774423599243
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0108074  Vali Loss: 0.0458986 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9868996  Vali macro F1 0.9814795 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.2314136028289795
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0088708  Vali Loss: 0.0468605 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9878982  Vali macro F1 0.9827512 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.213340759277344
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0084869  Vali Loss: 0.0435975 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879209  Vali macro F1 0.9831214 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.213867664337158
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0084540  Vali Loss: 0.0467126 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9878890  Vali macro F1 0.9830513 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.216801166534424
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0081623  Vali Loss: 0.0451282 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894239  Vali macro F1 0.9846234 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 6.216920375823975
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0072927  Vali Loss: 0.0452321 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884158  Vali macro F1 0.9835840 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.2144615650177
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0073988  Vali Loss: 0.0454542 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884158  Vali macro F1 0.9835840 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.21672797203064
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0075173  Vali Loss: 0.0455012 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889114  Vali macro F1 0.9840481 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.240196228027344
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0067722  Vali Loss: 0.0452174 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884158  Vali macro F1 0.9835840 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.238598346710205
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0069414  Vali Loss: 0.0452869 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884158  Vali macro F1 0.9835840 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9118327  Test weighted F1: 0.9106037  Test macro F1 0.8758246 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.23751163482666
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0141346  Vali Loss: 0.0409576 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858970  Vali macro F1 0.9802656 
Validation loss decreased (inf --> 0.040958).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.204283237457275
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0117257  Vali Loss: 0.0410704 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869166  Vali macro F1 0.9815481 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.195363283157349
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0118944  Vali Loss: 0.0415315 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858952  Vali macro F1 0.9798238 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.201583385467529
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0104855  Vali Loss: 0.0410829 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869555  Vali macro F1 0.9812346 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.212956666946411
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0114188  Vali Loss: 0.0432227 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9868961  Vali macro F1 0.9815990 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.21565055847168
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0098275  Vali Loss: 0.0423100 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879190  Vali macro F1 0.9825050 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.255824565887451
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0098372  Vali Loss: 0.0436550 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869312  Vali macro F1 0.9806858 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.229548454284668
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0094061  Vali Loss: 0.0426527 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.215043067932129
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0093866  Vali Loss: 0.0428476 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894133  Vali macro F1 0.9848982 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.219442844390869
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0086100  Vali Loss: 0.0406177 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884365  Vali macro F1 0.9831015 
new best score!!!!
Validation loss decreased (0.040958 --> 0.040618).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.232990741729736
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0090663  Vali Loss: 0.0411624 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884365  Vali macro F1 0.9831015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.2287867069244385
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0083880  Vali Loss: 0.0455230 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884380  Vali macro F1 0.9830373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.23114538192749
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0079733  Vali Loss: 0.0427150 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884272  Vali macro F1 0.9833350 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.223268270492554
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0079629  Vali Loss: 0.0428576 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894281  Vali macro F1 0.9849212 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.259045362472534
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0079211  Vali Loss: 0.0456894 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.225958585739136
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0066630  Vali Loss: 0.0453790 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.215054988861084
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0071137  Vali Loss: 0.0449565 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874329  Vali macro F1 0.9814905 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.223515748977661
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0065176  Vali Loss: 0.0446431 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874329  Vali macro F1 0.9814905 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.217210054397583
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0070142  Vali Loss: 0.0441366 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.2245707511901855
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0072322  Vali Loss: 0.0437755 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 21 cost time: 6.2251787185668945
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0073081  Vali Loss: 0.0437938 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.227205038070679
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0069733  Vali Loss: 0.0437226 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.223859786987305
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0069199  Vali Loss: 0.0437217 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.226028919219971
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0067766  Vali Loss: 0.0437431 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.21845006942749
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0066845  Vali Loss: 0.0437958 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879347  Vali macro F1 0.9822958 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8618679  Test weighted F1: 0.8695618  Test macro F1 0.8303672 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014914 0.00018315 0.00110742 0.00140252 0.00050633 0.00062617]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.025539398193359
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.0624715  Vali Loss: 0.6900395 Vali Accuracy: 0.7568688  Vali weighted F1: 0.6912282  Vali macro F1 0.4760028 
Validation loss decreased (inf --> 0.690040).  Saving model ...
Epoch: 2 cost time: 6.0207390785217285
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5703814  Vali Loss: 0.4665797 Vali Accuracy: 0.8310005  Vali weighted F1: 0.8050765  Vali macro F1 0.7513032 
new best score!!!!
Validation loss decreased (0.690040 --> 0.466580).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.021191358566284
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.4184259  Vali Loss: 0.3408478 Vali Accuracy: 0.8843961  Vali weighted F1: 0.8772764  Vali macro F1 0.8414049 
new best score!!!!
Validation loss decreased (0.466580 --> 0.340848).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.019901275634766
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.3261191  Vali Loss: 0.2779731 Vali Accuracy: 0.9072058  Vali weighted F1: 0.9038679  Vali macro F1 0.8755534 
new best score!!!!
Validation loss decreased (0.340848 --> 0.277973).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.053511142730713
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2600457  Vali Loss: 0.2277582 Vali Accuracy: 0.9212027  Vali weighted F1: 0.9171652  Vali macro F1 0.8918782 
new best score!!!!
Validation loss decreased (0.277973 --> 0.227758).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.061788082122803
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2235552  Vali Loss: 0.2004167 Vali Accuracy: 0.9274235  Vali weighted F1: 0.9256488  Vali macro F1 0.8986562 
new best score!!!!
Validation loss decreased (0.227758 --> 0.200417).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.0395426750183105
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1950037  Vali Loss: 0.1784821 Vali Accuracy: 0.9357180  Vali weighted F1: 0.9356076  Vali macro F1 0.9070517 
new best score!!!!
Validation loss decreased (0.200417 --> 0.178482).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.0300633907318115
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1687755  Vali Loss: 0.1445865 Vali Accuracy: 0.9523069  Vali weighted F1: 0.9518687  Vali macro F1 0.9322251 
new best score!!!!
Validation loss decreased (0.178482 --> 0.144587).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.028982639312744
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1542779  Vali Loss: 0.1469427 Vali Accuracy: 0.9460861  Vali weighted F1: 0.9458328  Vali macro F1 0.9202849 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.030559301376343
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1333143  Vali Loss: 0.1420345 Vali Accuracy: 0.9502333  Vali weighted F1: 0.9487594  Vali macro F1 0.9280884 
new best score!!!!
Validation loss decreased (0.144587 --> 0.142034).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.026017189025879
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1308242  Vali Loss: 0.1310135 Vali Accuracy: 0.9491965  Vali weighted F1: 0.9504903  Vali macro F1 0.9368507 
new best score!!!!
Validation loss decreased (0.142034 --> 0.131013).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.04127049446106
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1130832  Vali Loss: 0.1121971 Vali Accuracy: 0.9580093  Vali weighted F1: 0.9579858  Vali macro F1 0.9437311 
new best score!!!!
Validation loss decreased (0.131013 --> 0.112197).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.038451910018921
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1084039  Vali Loss: 0.1055208 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9616772  Vali macro F1 0.9510730 
new best score!!!!
Validation loss decreased (0.112197 --> 0.105521).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.0611512660980225
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0919020  Vali Loss: 0.0963878 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9610710  Vali macro F1 0.9502272 
new best score!!!!
Validation loss decreased (0.105521 --> 0.096388).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.024852991104126
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0851799  Vali Loss: 0.1207028 Vali Accuracy: 0.9590461  Vali weighted F1: 0.9584572  Vali macro F1 0.9422568 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 7.109957456588745
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0832741  Vali Loss: 0.1074809 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9688554  Vali macro F1 0.9621777 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.030472755432129
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0767977  Vali Loss: 0.0811871 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9719091  Vali macro F1 0.9591850 
new best score!!!!
Validation loss decreased (0.096388 --> 0.081187).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.030089378356934
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0682262  Vali Loss: 0.0819528 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9744099  Vali macro F1 0.9665233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.0365612506866455
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0641416  Vali Loss: 0.0794105 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9720615  Vali macro F1 0.9638679 
new best score!!!!
Validation loss decreased (0.081187 --> 0.079411).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.02948784828186
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0573901  Vali Loss: 0.0852752 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9717585  Vali macro F1 0.9590044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.034586191177368
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0632886  Vali Loss: 0.0763298 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9738087  Vali macro F1 0.9630318 
new best score!!!!
Validation loss decreased (0.079411 --> 0.076330).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.040234804153442
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0526584  Vali Loss: 0.0710504 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9791800  Vali macro F1 0.9714660 
new best score!!!!
Validation loss decreased (0.076330 --> 0.071050).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.0392091274261475
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0499710  Vali Loss: 0.0596524 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833749  Vali macro F1 0.9759410 
new best score!!!!
Validation loss decreased (0.071050 --> 0.059652).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.036882162094116
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0419105  Vali Loss: 0.0534724 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854327  Vali macro F1 0.9802943 
new best score!!!!
Validation loss decreased (0.059652 --> 0.053472).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.0323326587677
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0350188  Vali Loss: 0.0513795 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839147  Vali macro F1 0.9769898 
new best score!!!!
Validation loss decreased (0.053472 --> 0.051380).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.04011607170105
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0400083  Vali Loss: 0.0607043 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817296  Vali macro F1 0.9757615 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.03829026222229
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0457936  Vali Loss: 0.0590186 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9838824  Vali macro F1 0.9779187 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.034472703933716
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0335142  Vali Loss: 0.0541900 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9843624  Vali macro F1 0.9787239 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.037707805633545
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0416447  Vali Loss: 0.0512431 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834289  Vali macro F1 0.9754245 
new best score!!!!
Validation loss decreased (0.051380 --> 0.051243).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.0308997631073
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0321231  Vali Loss: 0.0530948 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817489  Vali macro F1 0.9744225 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.060466289520264
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0303664  Vali Loss: 0.0533154 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849064  Vali macro F1 0.9793517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.033203363418579
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0295418  Vali Loss: 0.0669548 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9782374  Vali macro F1 0.9700335 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.037476301193237
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0339568  Vali Loss: 0.0621933 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797751  Vali macro F1 0.9727734 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.0456702709198
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0315886  Vali Loss: 0.0777650 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9789773  Vali macro F1 0.9734712 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.044212579727173
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0216186  Vali Loss: 0.0409178 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896142  Vali macro F1 0.9846934 
new best score!!!!
Validation loss decreased (0.051243 --> 0.040918).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.03200888633728
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0167736  Vali Loss: 0.0438073 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859259  Vali macro F1 0.9815196 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.030732154846191
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0157036  Vali Loss: 0.0405408 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896245  Vali macro F1 0.9849674 
new best score!!!!
Validation loss decreased (0.040918 --> 0.040541).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.0421531200408936
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0147443  Vali Loss: 0.0403453 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880605  Vali macro F1 0.9833630 
new best score!!!!
Validation loss decreased (0.040541 --> 0.040345).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.053430080413818
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0139008  Vali Loss: 0.0425504 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875194  Vali macro F1 0.9834366 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.070738315582275
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0141077  Vali Loss: 0.0435025 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875227  Vali macro F1 0.9834191 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.0410850048065186
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0132790  Vali Loss: 0.0416064 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875366  Vali macro F1 0.9827812 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.048054456710815
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0134062  Vali Loss: 0.0423799 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864798  Vali macro F1 0.9817631 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.044726610183716
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0127765  Vali Loss: 0.0438634 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875137  Vali macro F1 0.9837365 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 6.041007995605469
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0119548  Vali Loss: 0.0436942 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875137  Vali macro F1 0.9837365 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.038050413131714
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0129949  Vali Loss: 0.0429275 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875306  Vali macro F1 0.9830992 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.039921522140503
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0115929  Vali Loss: 0.0428147 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875306  Vali macro F1 0.9830992 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.042890310287476
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0124531  Vali Loss: 0.0428264 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875306  Vali macro F1 0.9830992 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.071840524673462
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0120507  Vali Loss: 0.0426943 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875306  Vali macro F1 0.9830992 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.051851511001587
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0121913  Vali Loss: 0.0427588 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880504  Vali macro F1 0.9839273 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.037919521331787
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0116859  Vali Loss: 0.0428646 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880504  Vali macro F1 0.9839273 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.035448789596558
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0118505  Vali Loss: 0.0429305 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880504  Vali macro F1 0.9839273 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.048478126525879
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0130331  Vali Loss: 0.0430053 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880504  Vali macro F1 0.9839273 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.057602882385254
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0124295  Vali Loss: 0.0430472 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875227  Vali macro F1 0.9834191 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9196951  Test weighted F1: 0.9185003  Test macro F1 0.8416038 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.056811332702637
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0148169  Vali Loss: 0.0439888 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864778  Vali macro F1 0.9817271 
Validation loss decreased (inf --> 0.043989).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.027621746063232
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0136888  Vali Loss: 0.0450629 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875238  Vali macro F1 0.9830844 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.054877758026123
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0133702  Vali Loss: 0.0436514 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875358  Vali macro F1 0.9827851 
new best score!!!!
Validation loss decreased (0.043989 --> 0.043651).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.031737804412842
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0124999  Vali Loss: 0.0449853 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864876  Vali macro F1 0.9814291 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.037255525588989
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0118342  Vali Loss: 0.0434902 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864982  Vali macro F1 0.9817924 
new best score!!!!
Validation loss decreased (0.043651 --> 0.043490).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.042803049087524
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0110560  Vali Loss: 0.0436630 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875083  Vali macro F1 0.9837325 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.036854028701782
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0125523  Vali Loss: 0.0420218 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885748  Vali macro F1 0.9845052 
new best score!!!!
Validation loss decreased (0.043490 --> 0.042022).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.047760725021362
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0106445  Vali Loss: 0.0434504 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864697  Vali macro F1 0.9820610 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.052698373794556
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0118788  Vali Loss: 0.0446262 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860260  Vali macro F1 0.9801205 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.048989295959473
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0111612  Vali Loss: 0.0452840 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880294  Vali macro F1 0.9842869 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.062847852706909
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0110015  Vali Loss: 0.0442890 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9869891  Vali macro F1 0.9828879 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.055796384811401
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0096132  Vali Loss: 0.0450486 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880552  Vali macro F1 0.9836121 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.064855337142944
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0104616  Vali Loss: 0.0443931 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885893  Vali macro F1 0.9838717 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.11846137046814
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0100288  Vali Loss: 0.0459378 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9869995  Vali macro F1 0.9825909 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.0460755825042725
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0093982  Vali Loss: 0.0453164 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864811  Vali macro F1 0.9816949 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.0502026081085205
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0108600  Vali Loss: 0.0415939 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875413  Vali macro F1 0.9820274 
new best score!!!!
Validation loss decreased (0.042022 --> 0.041594).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.0317370891571045
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0094433  Vali Loss: 0.0414379 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885964  Vali macro F1 0.9835814 
new best score!!!!
Validation loss decreased (0.041594 --> 0.041438).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.035178184509277
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0096637  Vali Loss: 0.0433672 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870060  Vali macro F1 0.9829865 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.025765895843506
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0084918  Vali Loss: 0.0420224 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891100  Vali macro F1 0.9846639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.036669731140137
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0101606  Vali Loss: 0.0480019 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875082  Vali macro F1 0.9837141 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.067646265029907
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0089837  Vali Loss: 0.0458006 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865162  Vali macro F1 0.9812309 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.059167385101318
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0086729  Vali Loss: 0.0526221 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864367  Vali macro F1 0.9826587 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.0419182777404785
Fine Tuning VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0082896  Vali Loss: 0.0452012 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880468  Vali macro F1 0.9839969 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.033581972122192
Fine Tuning VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0077125  Vali Loss: 0.0447557 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885748  Vali macro F1 0.9845052 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.034024000167847
Fine Tuning VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0077151  Vali Loss: 0.0454809 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885649  Vali macro F1 0.9848216 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.040757417678833
Fine Tuning VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0071184  Vali Loss: 0.0450403 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880468  Vali macro F1 0.9839969 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.032680511474609
Fine Tuning VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0075710  Vali Loss: 0.0449380 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875345  Vali macro F1 0.9835146 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 6.044740915298462
Fine Tuning VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0070004  Vali Loss: 0.0447524 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880468  Vali macro F1 0.9839969 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.047743797302246
Fine Tuning VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0080864  Vali Loss: 0.0446566 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880468  Vali macro F1 0.9839969 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.076860666275024
Fine Tuning VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0076706  Vali Loss: 0.0447337 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880468  Vali macro F1 0.9839969 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.035191059112549
Fine Tuning VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0071567  Vali Loss: 0.0447346 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880468  Vali macro F1 0.9839969 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.031662464141846
Fine Tuning VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0074543  Vali Loss: 0.0446989 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880468  Vali macro F1 0.9839969 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9252387  Test weighted F1: 0.9262289  Test macro F1 0.8664449 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.0001478  0.00018292 0.00097371 0.00126422 0.00049579 0.00061881]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.161225080490112
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0795320  Vali Loss: 0.7408930 Vali Accuracy: 0.7180662  Vali weighted F1: 0.6776865  Vali macro F1 0.4768413 
Validation loss decreased (inf --> 0.740893).  Saving model ...
Epoch: 2 cost time: 6.149889707565308
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5367215  Vali Loss: 0.4550700 Vali Accuracy: 0.8427481  Vali weighted F1: 0.8164895  Vali macro F1 0.7610296 
new best score!!!!
Validation loss decreased (0.740893 --> 0.455070).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.1471474170684814
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3910740  Vali Loss: 0.3311982 Vali Accuracy: 0.8849873  Vali weighted F1: 0.8833615  Vali macro F1 0.8500705 
new best score!!!!
Validation loss decreased (0.455070 --> 0.331198).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.146713733673096
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3127799  Vali Loss: 0.4973544 Vali Accuracy: 0.8203562  Vali weighted F1: 0.8304563  Vali macro F1 0.8041445 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 5 cost time: 6.178520917892456
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2793023  Vali Loss: 0.2172167 Vali Accuracy: 0.9251908  Vali weighted F1: 0.9233370  Vali macro F1 0.8939695 
new best score!!!!
Validation loss decreased (0.331198 --> 0.217217).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.172738075256348
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2181405  Vali Loss: 0.2069027 Vali Accuracy: 0.9323155  Vali weighted F1: 0.9302886  Vali macro F1 0.9032833 
new best score!!!!
Validation loss decreased (0.217217 --> 0.206903).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.157857179641724
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1922541  Vali Loss: 0.1862499 Vali Accuracy: 0.9353690  Vali weighted F1: 0.9324455  Vali macro F1 0.9114272 
new best score!!!!
Validation loss decreased (0.206903 --> 0.186250).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.163569688796997
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1635705  Vali Loss: 0.1483075 Vali Accuracy: 0.9516539  Vali weighted F1: 0.9519135  Vali macro F1 0.9366211 
new best score!!!!
Validation loss decreased (0.186250 --> 0.148307).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.16338324546814
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1608105  Vali Loss: 0.1453384 Vali Accuracy: 0.9536896  Vali weighted F1: 0.9534784  Vali macro F1 0.9347342 
new best score!!!!
Validation loss decreased (0.148307 --> 0.145338).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.170570135116577
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1439620  Vali Loss: 0.1352509 Vali Accuracy: 0.9526718  Vali weighted F1: 0.9514597  Vali macro F1 0.9355190 
new best score!!!!
Validation loss decreased (0.145338 --> 0.135251).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.166682958602905
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1181862  Vali Loss: 0.1074243 Vali Accuracy: 0.9633588  Vali weighted F1: 0.9630354  Vali macro F1 0.9489527 
new best score!!!!
Validation loss decreased (0.135251 --> 0.107424).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.16037917137146
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1090199  Vali Loss: 0.0969342 Vali Accuracy: 0.9633588  Vali weighted F1: 0.9630410  Vali macro F1 0.9490488 
new best score!!!!
Validation loss decreased (0.107424 --> 0.096934).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.150285005569458
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0993213  Vali Loss: 0.1091346 Vali Accuracy: 0.9608142  Vali weighted F1: 0.9610808  Vali macro F1 0.9457175 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.170718431472778
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1117186  Vali Loss: 0.0861845 Vali Accuracy: 0.9664122  Vali weighted F1: 0.9660187  Vali macro F1 0.9543204 
new best score!!!!
Validation loss decreased (0.096934 --> 0.086185).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.167821168899536
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0897927  Vali Loss: 0.0850764 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9764160  Vali macro F1 0.9667738 
new best score!!!!
Validation loss decreased (0.086185 --> 0.085076).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.173466205596924
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0822146  Vali Loss: 0.0780169 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9730777  Vali macro F1 0.9605268 
new best score!!!!
Validation loss decreased (0.085076 --> 0.078017).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.140300512313843
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0762158  Vali Loss: 0.0710825 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758849  Vali macro F1 0.9672799 
new best score!!!!
Validation loss decreased (0.078017 --> 0.071082).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.14630913734436
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0698895  Vali Loss: 0.0773957 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9750554  Vali macro F1 0.9666759 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.150998115539551
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0676834  Vali Loss: 0.0773200 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9765394  Vali macro F1 0.9662459 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.147955656051636
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0666692  Vali Loss: 0.0642243 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9811094  Vali macro F1 0.9746845 
new best score!!!!
Validation loss decreased (0.071082 --> 0.064224).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.162461757659912
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0576471  Vali Loss: 0.0691821 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9789727  Vali macro F1 0.9702001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.162933111190796
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0525676  Vali Loss: 0.0649738 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9815696  Vali macro F1 0.9753366 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.179982662200928
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0567881  Vali Loss: 0.0599710 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9807328  Vali macro F1 0.9673712 
new best score!!!!
Validation loss decreased (0.064224 --> 0.059971).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.165896654129028
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0477635  Vali Loss: 0.3861633 Vali Accuracy: 0.8992366  Vali weighted F1: 0.8977815  Vali macro F1 0.8945629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.154957056045532
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.1303643  Vali Loss: 0.0829173 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9731679  Vali macro F1 0.9640295 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.149744272232056
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0598494  Vali Loss: 0.0584812 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9806176  Vali macro F1 0.9734393 
new best score!!!!
Validation loss decreased (0.059971 --> 0.058481).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.148775815963745
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0428431  Vali Loss: 0.0625897 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9826532  Vali macro F1 0.9739547 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.162869453430176
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0396470  Vali Loss: 0.0553800 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9856662  Vali macro F1 0.9799999 
new best score!!!!
Validation loss decreased (0.058481 --> 0.055380).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.163219451904297
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0397529  Vali Loss: 0.0705673 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9768059  Vali macro F1 0.9668279 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.1545751094818115
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0353818  Vali Loss: 0.0588603 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836790  Vali macro F1 0.9757312 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.182013750076294
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0344891  Vali Loss: 0.0550719 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852158  Vali macro F1 0.9782584 
new best score!!!!
Validation loss decreased (0.055380 --> 0.055072).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.15580153465271
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0341770  Vali Loss: 0.0717453 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9770417  Vali macro F1 0.9643680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.164672136306763
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0320414  Vali Loss: 0.0826922 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9762667  Vali macro F1 0.9695203 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.161618232727051
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0312358  Vali Loss: 0.0860313 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9774088  Vali macro F1 0.9692676 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.167598724365234
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0351282  Vali Loss: 0.0563722 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836334  Vali macro F1 0.9773668 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.15994668006897
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0242473  Vali Loss: 0.0540797 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851569  Vali macro F1 0.9782194 
new best score!!!!
Validation loss decreased (0.055072 --> 0.054080).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.168989419937134
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0212976  Vali Loss: 0.0638440 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9820263  Vali macro F1 0.9748951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.171586751937866
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0233579  Vali Loss: 0.0518504 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846966  Vali macro F1 0.9780759 
new best score!!!!
Validation loss decreased (0.054080 --> 0.051850).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.192075729370117
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0226337  Vali Loss: 0.0745787 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9821504  Vali macro F1 0.9744918 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.157787561416626
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0234897  Vali Loss: 0.0673550 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9795635  Vali macro F1 0.9720148 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.16234016418457
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0223951  Vali Loss: 0.0601311 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9831240  Vali macro F1 0.9762723 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.16980504989624
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0245804  Vali Loss: 0.0726164 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9790001  Vali macro F1 0.9712786 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.1762614250183105
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0348099  Vali Loss: 0.0570616 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847048  Vali macro F1 0.9794276 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 6.172537803649902
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0164987  Vali Loss: 0.0421333 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903180  Vali macro F1 0.9857045 
new best score!!!!
Validation loss decreased (0.051850 --> 0.042133).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.159818887710571
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0136937  Vali Loss: 0.0441322 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897854  Vali macro F1 0.9853595 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.153336524963379
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0134092  Vali Loss: 0.0444891 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882713  Vali macro F1 0.9832099 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.176461458206177
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0118827  Vali Loss: 0.0462052 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877444  Vali macro F1 0.9833088 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.15681791305542
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0118635  Vali Loss: 0.0463673 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897830  Vali macro F1 0.9853263 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.171108722686768
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0109805  Vali Loss: 0.0466994 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872399  Vali macro F1 0.9827069 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.172837495803833
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0109784  Vali Loss: 0.0466899 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872399  Vali macro F1 0.9827069 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.159382581710815
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0112287  Vali Loss: 0.0467605 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887795  Vali macro F1 0.9840307 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.153785705566406
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0102979  Vali Loss: 0.0464188 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877473  Vali macro F1 0.9829538 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.16217303276062
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0111939  Vali Loss: 0.0463739 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882638  Vali macro F1 0.9834931 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.174667119979858
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0112031  Vali Loss: 0.0462650 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882638  Vali macro F1 0.9834931 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.216919660568237
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0116006  Vali Loss: 0.0463032 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882638  Vali macro F1 0.9834931 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.152953386306763
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0102506  Vali Loss: 0.0463192 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882638  Vali macro F1 0.9834931 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.154817342758179
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0101835  Vali Loss: 0.0463326 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882638  Vali macro F1 0.9834931 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.167767763137817
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0102768  Vali Loss: 0.0462788 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882638  Vali macro F1 0.9834931 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.162739992141724
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0107303  Vali Loss: 0.0462626 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882638  Vali macro F1 0.9834931 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8665053  Test weighted F1: 0.8721889  Test macro F1 0.8521509 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.183592081069946
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0141413  Vali Loss: 0.0447500 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892670  Vali macro F1 0.9847846 
Validation loss decreased (inf --> 0.044750).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.16002893447876
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0128037  Vali Loss: 0.0474702 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877601  Vali macro F1 0.9833033 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.196143388748169
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0107301  Vali Loss: 0.0460367 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897918  Vali macro F1 0.9856691 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.15851092338562
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0112129  Vali Loss: 0.0469175 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892864  Vali macro F1 0.9854573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.157872676849365
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0106838  Vali Loss: 0.0496692 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867014  Vali macro F1 0.9820630 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.153909921646118
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0094380  Vali Loss: 0.0491352 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877475  Vali macro F1 0.9838143 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.146428108215332
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0113127  Vali Loss: 0.0485236 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882782  Vali macro F1 0.9835028 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.165386199951172
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0117467  Vali Loss: 0.0485272 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887805  Vali macro F1 0.9849264 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.160949230194092
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0094893  Vali Loss: 0.0498296 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9861900  Vali macro F1 0.9812560 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.167673349380493
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0099520  Vali Loss: 0.0472528 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887790  Vali macro F1 0.9842449 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.168047904968262
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0091175  Vali Loss: 0.0476593 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882559  Vali macro F1 0.9836813 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.17584753036499
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0084818  Vali Loss: 0.0488874 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887663  Vali macro F1 0.9848474 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.170599937438965
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0082444  Vali Loss: 0.0481349 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887765  Vali macro F1 0.9842633 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.154264688491821
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0079443  Vali Loss: 0.0488054 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882540  Vali macro F1 0.9830982 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.157057523727417
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0077832  Vali Loss: 0.0488827 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877574  Vali macro F1 0.9831791 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.178272485733032
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0081256  Vali Loss: 0.0489217 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877574  Vali macro F1 0.9831791 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8694639  Test weighted F1: 0.8734155  Test macro F1 0.8551884 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014943 0.00018335 0.00100705 0.00123609 0.00051813 0.00062696]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.060786247253418
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.0811920  Vali Loss: 0.6731162 Vali Accuracy: 0.7703399  Vali weighted F1: 0.7033583  Vali macro F1 0.4752189 
Validation loss decreased (inf --> 0.673116).  Saving model ...
Epoch: 2 cost time: 6.049068212509155
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.5573243  Vali Loss: 0.5001672 Vali Accuracy: 0.8151390  Vali weighted F1: 0.7863755  Vali macro F1 0.7201250 
new best score!!!!
Validation loss decreased (0.673116 --> 0.500167).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.057077646255493
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.4002659  Vali Loss: 0.3015113 Vali Accuracy: 0.8898043  Vali weighted F1: 0.8835349  Vali macro F1 0.8285805 
new best score!!!!
Validation loss decreased (0.500167 --> 0.301511).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.098791122436523
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.3043044  Vali Loss: 0.2421014 Vali Accuracy: 0.9119464  Vali weighted F1: 0.9093754  Vali macro F1 0.8642624 
new best score!!!!
Validation loss decreased (0.301511 --> 0.242101).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.063555717468262
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2464862  Vali Loss: 0.2424224 Vali Accuracy: 0.9114315  Vali weighted F1: 0.9058661  Vali macro F1 0.8642072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.0669615268707275
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2104084  Vali Loss: 0.1758860 Vali Accuracy: 0.9438723  Vali weighted F1: 0.9438176  Vali macro F1 0.9144015 
new best score!!!!
Validation loss decreased (0.242101 --> 0.175886).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.070944547653198
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1898329  Vali Loss: 0.1520732 Vali Accuracy: 0.9454171  Vali weighted F1: 0.9451693  Vali macro F1 0.9157527 
new best score!!!!
Validation loss decreased (0.175886 --> 0.152073).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.084555149078369
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1714720  Vali Loss: 0.1488450 Vali Accuracy: 0.9469619  Vali weighted F1: 0.9459587  Vali macro F1 0.9160302 
new best score!!!!
Validation loss decreased (0.152073 --> 0.148845).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.077255964279175
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1645896  Vali Loss: 0.1359548 Vali Accuracy: 0.9521112  Vali weighted F1: 0.9521154  Vali macro F1 0.9284903 
new best score!!!!
Validation loss decreased (0.148845 --> 0.135955).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.07396388053894
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1503631  Vali Loss: 0.1191930 Vali Accuracy: 0.9567456  Vali weighted F1: 0.9564159  Vali macro F1 0.9317559 
new best score!!!!
Validation loss decreased (0.135955 --> 0.119193).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.07343864440918
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1522194  Vali Loss: 0.1085563 Vali Accuracy: 0.9613800  Vali weighted F1: 0.9617061  Vali macro F1 0.9389227 
new best score!!!!
Validation loss decreased (0.119193 --> 0.108556).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.093277454376221
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1245246  Vali Loss: 0.1139481 Vali Accuracy: 0.9582904  Vali weighted F1: 0.9573412  Vali macro F1 0.9420333 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.096483945846558
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1110517  Vali Loss: 0.1128768 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9590125  Vali macro F1 0.9360524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.0793421268463135
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1076310  Vali Loss: 0.1083638 Vali Accuracy: 0.9660144  Vali weighted F1: 0.9664980  Vali macro F1 0.9537048 
new best score!!!!
Validation loss decreased (0.108556 --> 0.108364).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.068247556686401
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1048952  Vali Loss: 0.1376074 Vali Accuracy: 0.9505664  Vali weighted F1: 0.9504016  Vali macro F1 0.9237142 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.061326503753662
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0901730  Vali Loss: 0.0806062 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9735311  Vali macro F1 0.9619841 
new best score!!!!
Validation loss decreased (0.108364 --> 0.080606).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.060627460479736
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0880033  Vali Loss: 0.0688250 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9777261  Vali macro F1 0.9672207 
new best score!!!!
Validation loss decreased (0.080606 --> 0.068825).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.0650107860565186
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0883275  Vali Loss: 0.1008642 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9614019  Vali macro F1 0.9429364 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.069164991378784
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0786188  Vali Loss: 0.0640063 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793938  Vali macro F1 0.9687935 
new best score!!!!
Validation loss decreased (0.068825 --> 0.064006).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.06833028793335
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0684917  Vali Loss: 0.0725263 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9760804  Vali macro F1 0.9652578 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.069895029067993
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0671246  Vali Loss: 0.0646393 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795053  Vali macro F1 0.9683808 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.070973873138428
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0683997  Vali Loss: 0.0681954 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9782398  Vali macro F1 0.9671505 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.061134099960327
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0594849  Vali Loss: 0.0787356 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9745656  Vali macro F1 0.9553528 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.056055784225464
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0642140  Vali Loss: 0.0621492 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9792674  Vali macro F1 0.9686089 
new best score!!!!
Validation loss decreased (0.064006 --> 0.062149).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.0592193603515625
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0551917  Vali Loss: 0.0614457 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793266  Vali macro F1 0.9681818 
new best score!!!!
Validation loss decreased (0.062149 --> 0.061446).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.062835931777954
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0505049  Vali Loss: 0.0532274 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793275  Vali macro F1 0.9697148 
new best score!!!!
Validation loss decreased (0.061446 --> 0.053227).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.067116737365723
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0462951  Vali Loss: 0.0556489 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820257  Vali macro F1 0.9716165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.082030534744263
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0483000  Vali Loss: 0.0575662 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9823669  Vali macro F1 0.9741610 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.082186698913574
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0406361  Vali Loss: 0.0569126 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799652  Vali macro F1 0.9686303 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.097725868225098
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0382956  Vali Loss: 0.0669542 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9806458  Vali macro F1 0.9717126 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.071523427963257
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0395293  Vali Loss: 0.0504385 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850454  Vali macro F1 0.9760262 
new best score!!!!
Validation loss decreased (0.053227 --> 0.050438).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.190623998641968
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0347477  Vali Loss: 0.0706564 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9766869  Vali macro F1 0.9631436 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.055003881454468
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0394700  Vali Loss: 0.0609635 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9808515  Vali macro F1 0.9703683 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.063447713851929
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0324249  Vali Loss: 0.0545783 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850169  Vali macro F1 0.9752432 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.060351133346558
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0305334  Vali Loss: 0.0593822 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815254  Vali macro F1 0.9703852 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.047151565551758
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0309382  Vali Loss: 0.0554550 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9834680  Vali macro F1 0.9744165 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 6.064466238021851
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0224361  Vali Loss: 0.0502278 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845360  Vali macro F1 0.9755598 
new best score!!!!
Validation loss decreased (0.050438 --> 0.050228).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.0692479610443115
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0170989  Vali Loss: 0.0467633 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9851125  Vali macro F1 0.9758524 
new best score!!!!
Validation loss decreased (0.050228 --> 0.046763).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.0548176765441895
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0172932  Vali Loss: 0.0476292 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856086  Vali macro F1 0.9763965 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.057711839675903
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0156997  Vali Loss: 0.0474271 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866207  Vali macro F1 0.9777709 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.056365728378296
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0162319  Vali Loss: 0.0478676 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855522  Vali macro F1 0.9765644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.058619737625122
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0160830  Vali Loss: 0.0474226 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861061  Vali macro F1 0.9775227 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.0625646114349365
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0147242  Vali Loss: 0.0481082 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855842  Vali macro F1 0.9766487 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 6.054373502731323
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0152486  Vali Loss: 0.0478926 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.0445637702941895
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0148980  Vali Loss: 0.0476483 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.074047803878784
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0144009  Vali Loss: 0.0477063 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856234  Vali macro F1 0.9766998 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.055110931396484
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0147471  Vali Loss: 0.0473043 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.059684753417969
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0150294  Vali Loss: 0.0474195 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.060451984405518
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0151700  Vali Loss: 0.0474066 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.047443389892578
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0146074  Vali Loss: 0.0474032 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.052679538726807
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0154547  Vali Loss: 0.0474122 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.065698623657227
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0143693  Vali Loss: 0.0474246 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.075675010681152
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0151705  Vali Loss: 0.0474205 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856188  Vali macro F1 0.9766879 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9602891  Test weighted F1: 0.9604143  Test macro F1 0.9508390 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.127333402633667
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0179231  Vali Loss: 0.0485035 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850814  Vali macro F1 0.9758559 
Validation loss decreased (inf --> 0.048503).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.073292970657349
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0172386  Vali Loss: 0.0461889 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845493  Vali macro F1 0.9752428 
new best score!!!!
Validation loss decreased (0.048503 --> 0.046189).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.084038496017456
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0167909  Vali Loss: 0.0475099 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9865647  Vali macro F1 0.9779384 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.0773327350616455
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0156100  Vali Loss: 0.0487963 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845839  Vali macro F1 0.9753097 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.091251850128174
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0154792  Vali Loss: 0.0494940 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855893  Vali macro F1 0.9766613 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.077772378921509
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0143517  Vali Loss: 0.0499510 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860914  Vali macro F1 0.9771935 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.080801010131836
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0150931  Vali Loss: 0.0501617 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866048  Vali macro F1 0.9780456 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.0897626876831055
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0138583  Vali Loss: 0.0505468 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845718  Vali macro F1 0.9755678 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.1008501052856445
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0129858  Vali Loss: 0.0480780 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856501  Vali macro F1 0.9773664 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.110985040664673
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0129536  Vali Loss: 0.0474554 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866008  Vali macro F1 0.9780352 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.0941174030303955
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0140394  Vali Loss: 0.0511659 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840369  Vali macro F1 0.9749451 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.097039461135864
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0131549  Vali Loss: 0.0484132 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9865986  Vali macro F1 0.9783439 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.090814828872681
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0113099  Vali Loss: 0.0482998 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871212  Vali macro F1 0.9788792 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.103845119476318
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0126547  Vali Loss: 0.0481910 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871030  Vali macro F1 0.9791464 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.08549165725708
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0114340  Vali Loss: 0.0482316 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871028  Vali macro F1 0.9791184 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.089370965957642
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0110489  Vali Loss: 0.0481446 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871212  Vali macro F1 0.9788792 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.110275506973267
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0113884  Vali Loss: 0.0481889 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871212  Vali macro F1 0.9788792 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9559851  Test weighted F1: 0.9561490  Test macro F1 0.9451163 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014941 0.00018685 0.00139276 0.00148368 0.00052743 0.00064599]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.907723665237427
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.0813474  Vali Loss: 0.6869453 Vali Accuracy: 0.7190832  Vali weighted F1: 0.6506703  Vali macro F1 0.3414663 
Validation loss decreased (inf --> 0.686945).  Saving model ...
Epoch: 2 cost time: 5.8838958740234375
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5709981  Vali Loss: 0.4958753 Vali Accuracy: 0.8384861  Vali weighted F1: 0.8227359  Vali macro F1 0.7657451 
new best score!!!!
Validation loss decreased (0.686945 --> 0.495875).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.880711555480957
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.4388578  Vali Loss: 0.3945885 Vali Accuracy: 0.8571429  Vali weighted F1: 0.8464281  Vali macro F1 0.8094808 
new best score!!!!
Validation loss decreased (0.495875 --> 0.394589).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.890681982040405
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.3275397  Vali Loss: 0.2680423 Vali Accuracy: 0.9093817  Vali weighted F1: 0.9055732  Vali macro F1 0.8836836 
new best score!!!!
Validation loss decreased (0.394589 --> 0.268042).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.905174970626831
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2578116  Vali Loss: 0.2303068 Vali Accuracy: 0.9200426  Vali weighted F1: 0.9166480  Vali macro F1 0.8962087 
new best score!!!!
Validation loss decreased (0.268042 --> 0.230307).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.901525974273682
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.2177415  Vali Loss: 0.1945461 Vali Accuracy: 0.9355011  Vali weighted F1: 0.9342312  Vali macro F1 0.9183950 
new best score!!!!
Validation loss decreased (0.230307 --> 0.194546).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.906453371047974
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.2012012  Vali Loss: 0.1797133 Vali Accuracy: 0.9344350  Vali weighted F1: 0.9335269  Vali macro F1 0.9185714 
new best score!!!!
Validation loss decreased (0.194546 --> 0.179713).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.8967931270599365
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1739009  Vali Loss: 0.1873941 Vali Accuracy: 0.9424307  Vali weighted F1: 0.9419261  Vali macro F1 0.9262329 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.916222810745239
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1746150  Vali Loss: 0.1831481 Vali Accuracy: 0.9333689  Vali weighted F1: 0.9311374  Vali macro F1 0.9147469 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 10 cost time: 5.900338649749756
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1509325  Vali Loss: 0.1470249 Vali Accuracy: 0.9445629  Vali weighted F1: 0.9437530  Vali macro F1 0.9284281 
new best score!!!!
Validation loss decreased (0.179713 --> 0.147025).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.911053419113159
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1426337  Vali Loss: 0.1461106 Vali Accuracy: 0.9482942  Vali weighted F1: 0.9480214  Vali macro F1 0.9347133 
new best score!!!!
Validation loss decreased (0.147025 --> 0.146111).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.9094154834747314
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1414920  Vali Loss: 0.1282619 Vali Accuracy: 0.9498934  Vali weighted F1: 0.9499941  Vali macro F1 0.9353167 
new best score!!!!
Validation loss decreased (0.146111 --> 0.128262).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.901889801025391
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1224447  Vali Loss: 0.1596829 Vali Accuracy: 0.9440299  Vali weighted F1: 0.9421904  Vali macro F1 0.9306725 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.892418146133423
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1160614  Vali Loss: 0.1328389 Vali Accuracy: 0.9525586  Vali weighted F1: 0.9519333  Vali macro F1 0.9402294 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.892575025558472
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1105038  Vali Loss: 0.1114264 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9569158  Vali macro F1 0.9461452 
new best score!!!!
Validation loss decreased (0.128262 --> 0.111426).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.896628379821777
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1007340  Vali Loss: 0.1038206 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9612006  Vali macro F1 0.9484909 
new best score!!!!
Validation loss decreased (0.111426 --> 0.103821).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.90635347366333
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0939701  Vali Loss: 0.1052194 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9652345  Vali macro F1 0.9567923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.909593105316162
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0886898  Vali Loss: 0.1131571 Vali Accuracy: 0.9589552  Vali weighted F1: 0.9587573  Vali macro F1 0.9460468 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.908587694168091
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0881348  Vali Loss: 0.1362443 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9548549  Vali macro F1 0.9358322 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.9015116691589355
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0915675  Vali Loss: 0.0992131 Vali Accuracy: 0.9621535  Vali weighted F1: 0.9620017  Vali macro F1 0.9517429 
new best score!!!!
Validation loss decreased (0.103821 --> 0.099213).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.9037299156188965
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0831948  Vali Loss: 0.0965875 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9667607  Vali macro F1 0.9548357 
new best score!!!!
Validation loss decreased (0.099213 --> 0.096588).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.900425434112549
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0811212  Vali Loss: 0.0835528 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9680478  Vali macro F1 0.9572099 
new best score!!!!
Validation loss decreased (0.096588 --> 0.083553).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.892929792404175
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0735946  Vali Loss: 0.1433484 Vali Accuracy: 0.9509595  Vali weighted F1: 0.9491431  Vali macro F1 0.9350027 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.879805326461792
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0832991  Vali Loss: 0.0878558 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9722769  Vali macro F1 0.9635862 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.879058599472046
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0663814  Vali Loss: 0.0893952 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9702529  Vali macro F1 0.9606697 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.886521816253662
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0614751  Vali Loss: 0.0787652 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9741046  Vali macro F1 0.9651497 
new best score!!!!
Validation loss decreased (0.083553 --> 0.078765).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.913328409194946
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0565071  Vali Loss: 0.0782758 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9738127  Vali macro F1 0.9661266 
new best score!!!!
Validation loss decreased (0.078765 --> 0.078276).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.885638952255249
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0632698  Vali Loss: 0.0962785 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9693997  Vali macro F1 0.9594932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.889192581176758
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0571484  Vali Loss: 0.0828753 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9729247  Vali macro F1 0.9655105 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.870957612991333
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0489637  Vali Loss: 0.0836526 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9738310  Vali macro F1 0.9675472 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.885451793670654
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0527664  Vali Loss: 0.0778230 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9776980  Vali macro F1 0.9732639 
new best score!!!!
Validation loss decreased (0.078276 --> 0.077823).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.891043663024902
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0443929  Vali Loss: 0.0840554 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721903  Vali macro F1 0.9660325 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.88945460319519
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0451244  Vali Loss: 0.0715081 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9794275  Vali macro F1 0.9754558 
new best score!!!!
Validation loss decreased (0.077823 --> 0.071508).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.886024236679077
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0406291  Vali Loss: 0.0717575 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9776486  Vali macro F1 0.9705533 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.9135520458221436
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0374180  Vali Loss: 0.0753551 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9769684  Vali macro F1 0.9717077 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.885955095291138
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0376708  Vali Loss: 0.0845403 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9726752  Vali macro F1 0.9666234 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.8712708950042725
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0393820  Vali Loss: 0.0937706 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9714541  Vali macro F1 0.9620973 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.8853065967559814
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0381838  Vali Loss: 0.0763227 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9744262  Vali macro F1 0.9662052 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 5.878080368041992
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0268629  Vali Loss: 0.0647532 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792410  Vali macro F1 0.9736339 
new best score!!!!
Validation loss decreased (0.071508 --> 0.064753).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.886691570281982
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0218129  Vali Loss: 0.0625923 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792448  Vali macro F1 0.9729504 
new best score!!!!
Validation loss decreased (0.064753 --> 0.062592).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.8921284675598145
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0208432  Vali Loss: 0.0622532 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9787481  Vali macro F1 0.9728248 
new best score!!!!
Validation loss decreased (0.062592 --> 0.062253).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.896846294403076
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0213508  Vali Loss: 0.0624703 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797548  Vali macro F1 0.9742929 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.906465768814087
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0202880  Vali Loss: 0.0619022 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797446  Vali macro F1 0.9740828 
new best score!!!!
Validation loss decreased (0.062253 --> 0.061902).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.9094297885894775
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0197625  Vali Loss: 0.0631825 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792002  Vali macro F1 0.9741567 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.892761707305908
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0184464  Vali Loss: 0.0636588 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781467  Vali macro F1 0.9718819 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.887341260910034
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0187965  Vali Loss: 0.0660073 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786742  Vali macro F1 0.9728090 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.890944004058838
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0174930  Vali Loss: 0.0648987 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786696  Vali macro F1 0.9727906 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.892046213150024
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0184080  Vali Loss: 0.0629179 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797369  Vali macro F1 0.9739152 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 5.8890745639801025
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0174714  Vali Loss: 0.0629439 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792006  Vali macro F1 0.9736422 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.8878467082977295
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0178240  Vali Loss: 0.0629744 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792006  Vali macro F1 0.9736422 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.908851861953735
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0175098  Vali Loss: 0.0633714 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792006  Vali macro F1 0.9736422 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.948100805282593
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0170141  Vali Loss: 0.0633780 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792006  Vali macro F1 0.9736422 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.8895769119262695
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0175673  Vali Loss: 0.0627842 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786794  Vali macro F1 0.9725266 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 5.883090019226074
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0176887  Vali Loss: 0.0628750 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786794  Vali macro F1 0.9725266 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.891040802001953
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0172472  Vali Loss: 0.0629745 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786642  Vali macro F1 0.9727711 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 5.889685869216919
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0173332  Vali Loss: 0.0630510 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792006  Vali macro F1 0.9736422 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 5.886739253997803
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0159810  Vali Loss: 0.0630340 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792006  Vali macro F1 0.9736422 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 5.888016939163208
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0166917  Vali Loss: 0.0631054 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792006  Vali macro F1 0.9736422 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9082639  Test weighted F1: 0.9110305  Test macro F1 0.8701439 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.939617395401001
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0202938  Vali Loss: 0.0644207 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813552  Vali macro F1 0.9774631 
Validation loss decreased (inf --> 0.064421).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.8732476234436035
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0194435  Vali Loss: 0.0625027 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824367  Vali macro F1 0.9793416 
new best score!!!!
Validation loss decreased (0.064421 --> 0.062503).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.865434646606445
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0193596  Vali Loss: 0.0633545 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797587  Vali macro F1 0.9739086 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.867595911026001
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0186477  Vali Loss: 0.0666934 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792936  Vali macro F1 0.9734108 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.892005443572998
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0195933  Vali Loss: 0.0611811 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797181  Vali macro F1 0.9749163 
new best score!!!!
Validation loss decreased (0.062503 --> 0.061181).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 5.895216226577759
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0172486  Vali Loss: 0.0656375 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792338  Vali macro F1 0.9740352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.875814437866211
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0179158  Vali Loss: 0.0641742 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797273  Vali macro F1 0.9748481 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.867144346237183
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0176471  Vali Loss: 0.0612138 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786964  Vali macro F1 0.9740139 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.90237021446228
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0167262  Vali Loss: 0.0591355 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813613  Vali macro F1 0.9770282 
new best score!!!!
Validation loss decreased (0.061181 --> 0.059136).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 5.904629707336426
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0160389  Vali Loss: 0.0604152 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829761  Vali macro F1 0.9789611 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 5.898440361022949
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0168196  Vali Loss: 0.0606177 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802521  Vali macro F1 0.9766999 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 5.892107009887695
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0150291  Vali Loss: 0.0646031 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797030  Vali macro F1 0.9738987 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 5.899690628051758
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0159260  Vali Loss: 0.0609347 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818861  Vali macro F1 0.9782551 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 5.901981592178345
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0151391  Vali Loss: 0.0609447 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797689  Vali macro F1 0.9739644 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 5.8858702182769775
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0152653  Vali Loss: 0.0614613 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9798020  Vali macro F1 0.9751614 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 5.902340650558472
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0154278  Vali Loss: 0.0609704 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818950  Vali macro F1 0.9769747 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 5.889507293701172
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0138550  Vali Loss: 0.0603737 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813674  Vali macro F1 0.9762715 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 5.906625032424927
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0149877  Vali Loss: 0.0606737 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802560  Vali macro F1 0.9767457 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 5.897578239440918
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0149038  Vali Loss: 0.0609461 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808132  Vali macro F1 0.9747746 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 5.902360677719116
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0138331  Vali Loss: 0.0584656 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808242  Vali macro F1 0.9759191 
new best score!!!!
Validation loss decreased (0.059136 --> 0.058466).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 5.897501468658447
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0130999  Vali Loss: 0.0584244 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829786  Vali macro F1 0.9779467 
new best score!!!!
Validation loss decreased (0.058466 --> 0.058424).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 5.892306089401245
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0123426  Vali Loss: 0.0586387 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819140  Vali macro F1 0.9768283 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 5.886674404144287
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0114546  Vali Loss: 0.0588664 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819068  Vali macro F1 0.9774073 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 5.89044451713562
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0117590  Vali Loss: 0.0593132 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824146  Vali macro F1 0.9781607 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 5.890741586685181
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0124597  Vali Loss: 0.0598888 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808319  Vali macro F1 0.9750932 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 5.884972810745239
Fine Tuning VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0125438  Vali Loss: 0.0596748 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813495  Vali macro F1 0.9762520 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 5.8937342166900635
Fine Tuning VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0121865  Vali Loss: 0.0597570 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813495  Vali macro F1 0.9762520 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 5.90365743637085
Fine Tuning VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0124565  Vali Loss: 0.0598008 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808180  Vali macro F1 0.9753997 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 5.884939193725586
Fine Tuning VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0118700  Vali Loss: 0.0598255 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808180  Vali macro F1 0.9753997 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 5.880167245864868
Fine Tuning VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0124195  Vali Loss: 0.0599260 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808180  Vali macro F1 0.9753997 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 5.882302761077881
Fine Tuning VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0123349  Vali Loss: 0.0596692 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813351  Vali macro F1 0.9764885 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 32 cost time: 5.888876676559448
Fine Tuning VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0114651  Vali Loss: 0.0596606 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813351  Vali macro F1 0.9764885 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 5.888490676879883
Fine Tuning VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0118113  Vali Loss: 0.0596695 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813351  Vali macro F1 0.9764885 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 5.905030012130737
Fine Tuning VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0118109  Vali Loss: 0.0596692 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813351  Vali macro F1 0.9764885 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 5.907078266143799
Fine Tuning VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0131657  Vali Loss: 0.0596787 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808036  Vali macro F1 0.9756357 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 5.918097496032715
Fine Tuning VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0118110  Vali Loss: 0.0597016 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808036  Vali macro F1 0.9756357 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9030750  Test weighted F1: 0.9059940  Test macro F1 0.8656197 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001418  0.00018584 0.00096061 0.00123305 0.00052826 0.00064267]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.166828870773315
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0766327  Vali Loss: 0.6685218 Vali Accuracy: 0.7742263  Vali weighted F1: 0.7210547  Vali macro F1 0.4983998 
Validation loss decreased (inf --> 0.668522).  Saving model ...
Epoch: 2 cost time: 6.1560070514678955
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5676096  Vali Loss: 0.4525575 Vali Accuracy: 0.8346017  Vali weighted F1: 0.8157255  Vali macro F1 0.7488182 
new best score!!!!
Validation loss decreased (0.668522 --> 0.452557).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.156470775604248
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4008548  Vali Loss: 0.3326339 Vali Accuracy: 0.8858447  Vali weighted F1: 0.8813782  Vali macro F1 0.8419036 
new best score!!!!
Validation loss decreased (0.452557 --> 0.332634).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.159411430358887
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3018760  Vali Loss: 0.2294312 Vali Accuracy: 0.9213597  Vali weighted F1: 0.9173045  Vali macro F1 0.8916088 
new best score!!!!
Validation loss decreased (0.332634 --> 0.229431).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.179209232330322
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2438130  Vali Loss: 0.2311055 Vali Accuracy: 0.9264333  Vali weighted F1: 0.9217839  Vali macro F1 0.8979100 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.188902378082275
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2075224  Vali Loss: 0.1516053 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9489177  Vali macro F1 0.9283932 
new best score!!!!
Validation loss decreased (0.229431 --> 0.151605).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.174654960632324
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1874156  Vali Loss: 0.1390653 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9464595  Vali macro F1 0.9251855 
new best score!!!!
Validation loss decreased (0.151605 --> 0.139065).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.1782684326171875
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1649194  Vali Loss: 0.1313663 Vali Accuracy: 0.9538305  Vali weighted F1: 0.9530249  Vali macro F1 0.9328958 
new best score!!!!
Validation loss decreased (0.139065 --> 0.131366).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.172668933868408
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1515229  Vali Loss: 0.1055787 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9598915  Vali macro F1 0.9419172 
new best score!!!!
Validation loss decreased (0.131366 --> 0.105579).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.175709962844849
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1438435  Vali Loss: 0.1139505 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9587576  Vali macro F1 0.9397668 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.1800854206085205
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1350916  Vali Loss: 0.1007322 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9613931  Vali macro F1 0.9407347 
new best score!!!!
Validation loss decreased (0.105579 --> 0.100732).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.182248592376709
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1244769  Vali Loss: 0.1016448 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9597226  Vali macro F1 0.9412628 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.1769890785217285
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1204848  Vali Loss: 0.0879530 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9661981  Vali macro F1 0.9500391 
new best score!!!!
Validation loss decreased (0.100732 --> 0.087953).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.162338733673096
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1091344  Vali Loss: 0.0851275 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9667339  Vali macro F1 0.9505851 
new best score!!!!
Validation loss decreased (0.087953 --> 0.085128).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.1866841316223145
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1009253  Vali Loss: 0.0770819 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9712441  Vali macro F1 0.9586990 
new best score!!!!
Validation loss decreased (0.085128 --> 0.077082).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.186290264129639
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0986931  Vali Loss: 0.0777876 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9729734  Vali macro F1 0.9595210 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.179272174835205
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0935400  Vali Loss: 0.0811947 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9712762  Vali macro F1 0.9597740 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.174704551696777
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0870380  Vali Loss: 0.0670445 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9723599  Vali macro F1 0.9615327 
new best score!!!!
Validation loss decreased (0.077082 --> 0.067045).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.179933547973633
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0777817  Vali Loss: 0.0683054 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786240  Vali macro F1 0.9718261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.17248797416687
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0734738  Vali Loss: 0.0552976 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827361  Vali macro F1 0.9752140 
new best score!!!!
Validation loss decreased (0.067045 --> 0.055298).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.186364650726318
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0810355  Vali Loss: 0.0618180 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781715  Vali macro F1 0.9684248 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.201904773712158
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0710046  Vali Loss: 0.0509899 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821757  Vali macro F1 0.9763332 
new best score!!!!
Validation loss decreased (0.055298 --> 0.050990).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.201917409896851
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0687364  Vali Loss: 0.0450910 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842433  Vali macro F1 0.9778060 
new best score!!!!
Validation loss decreased (0.050990 --> 0.045091).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.230740547180176
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0609003  Vali Loss: 0.0596592 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9795973  Vali macro F1 0.9719643 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.224771738052368
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0604229  Vali Loss: 0.0688317 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9757095  Vali macro F1 0.9679215 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.213545560836792
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0581737  Vali Loss: 0.0474289 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9836500  Vali macro F1 0.9772240 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.213839530944824
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0537795  Vali Loss: 0.0529330 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862736  Vali macro F1 0.9826892 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.213056325912476
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0547030  Vali Loss: 0.0414381 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837880  Vali macro F1 0.9781481 
new best score!!!!
Validation loss decreased (0.045091 --> 0.041438).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.207957744598389
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0478106  Vali Loss: 0.0422072 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857727  Vali macro F1 0.9802593 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.214496612548828
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0492201  Vali Loss: 0.0535734 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842857  Vali macro F1 0.9798953 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.209627628326416
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0499973  Vali Loss: 0.0655522 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9805990  Vali macro F1 0.9704294 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.217191696166992
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0426754  Vali Loss: 0.0497030 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9836228  Vali macro F1 0.9787083 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.2300026416778564
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0511339  Vali Loss: 0.0481045 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806854  Vali macro F1 0.9756149 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 6.209142208099365
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0356739  Vali Loss: 0.0384822 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9877711  Vali macro F1 0.9832946 
new best score!!!!
Validation loss decreased (0.041438 --> 0.038482).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.204712629318237
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0313023  Vali Loss: 0.0371508 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9887956  Vali macro F1 0.9847307 
new best score!!!!
Validation loss decreased (0.038482 --> 0.037151).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.197531700134277
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0289403  Vali Loss: 0.0373908 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898111  Vali macro F1 0.9858342 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.19303035736084
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0268309  Vali Loss: 0.0362035 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903077  Vali macro F1 0.9863906 
new best score!!!!
Validation loss decreased (0.037151 --> 0.036204).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.1960906982421875
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0264479  Vali Loss: 0.0374798 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903077  Vali macro F1 0.9863906 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.211609363555908
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0266478  Vali Loss: 0.0372523 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908200  Vali macro F1 0.9872600 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.221004247665405
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0236736  Vali Loss: 0.0355832 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903077  Vali macro F1 0.9863906 
new best score!!!!
Validation loss decreased (0.036204 --> 0.035583).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.2187652587890625
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0251154  Vali Loss: 0.0341820 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903113  Vali macro F1 0.9863945 
new best score!!!!
Validation loss decreased (0.035583 --> 0.034182).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.217510938644409
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0246979  Vali Loss: 0.0358220 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9892861  Vali macro F1 0.9849354 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.210359334945679
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0227039  Vali Loss: 0.0375604 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9882593  Vali macro F1 0.9844485 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.206482887268066
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0248116  Vali Loss: 0.0331949 Vali Accuracy: 0.9913749  Vali weighted F1: 0.9913401  Vali macro F1 0.9878291 
new best score!!!!
Validation loss decreased (0.034182 --> 0.033195).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.204077959060669
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0229256  Vali Loss: 0.0340860 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898140  Vali macro F1 0.9858811 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.20405387878418
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0227179  Vali Loss: 0.0427743 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9877550  Vali macro F1 0.9838890 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.2028632164001465
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0238903  Vali Loss: 0.0326365 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898228  Vali macro F1 0.9855865 
new best score!!!!
Validation loss decreased (0.033195 --> 0.032637).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.217355251312256
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0215401  Vali Loss: 0.0338333 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908200  Vali macro F1 0.9872600 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.223937749862671
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0210827  Vali Loss: 0.0335717 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908200  Vali macro F1 0.9872600 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.2171220779418945
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0207783  Vali Loss: 0.0327497 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898012  Vali macro F1 0.9861526 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.202229976654053
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0207933  Vali Loss: 0.0341577 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9892883  Vali macro F1 0.9855869 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.2093186378479
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0195767  Vali Loss: 0.0327099 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898187  Vali macro F1 0.9865101 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.203206300735474
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0208829  Vali Loss: 0.0328040 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898117  Vali macro F1 0.9865070 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.201699256896973
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0199469  Vali Loss: 0.0321141 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903317  Vali macro F1 0.9870759 
new best score!!!!
Validation loss decreased (0.032637 --> 0.032114).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.202610015869141
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0199379  Vali Loss: 0.0322526 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903182  Vali macro F1 0.9867450 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.203815221786499
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0190595  Vali Loss: 0.0323407 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903182  Vali macro F1 0.9867450 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.222909927368164
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0202515  Vali Loss: 0.0320241 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903182  Vali macro F1 0.9867450 
new best score!!!!
Validation loss decreased (0.032114 --> 0.032024).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.2114081382751465
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0181494  Vali Loss: 0.0320119 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
new best score!!!!
Validation loss decreased (0.032024 --> 0.032012).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 6.2244932651519775
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0189133  Vali Loss: 0.0315951 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
new best score!!!!
Validation loss decreased (0.032012 --> 0.031595).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.194658994674683
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0194477  Vali Loss: 0.0321033 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903249  Vali macro F1 0.9867480 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.189817667007446
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0186060  Vali Loss: 0.0327343 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903136  Vali macro F1 0.9870220 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.189540863037109
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0208084  Vali Loss: 0.0318576 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903182  Vali macro F1 0.9867450 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.194831132888794
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0183394  Vali Loss: 0.0317746 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.194957256317139
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0191320  Vali Loss: 0.0321976 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908200  Vali macro F1 0.9872600 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 65 cost time: 6.2013163566589355
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0205264  Vali Loss: 0.0321255 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903182  Vali macro F1 0.9867450 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 6.214439868927002
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0191241  Vali Loss: 0.0320874 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 6.209564447402954
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0191166  Vali Loss: 0.0320074 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.202118396759033
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0189036  Vali Loss: 0.0319974 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.206401348114014
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0194916  Vali Loss: 0.0319824 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 70 cost time: 6.213207721710205
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0195301  Vali Loss: 0.0319913 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 6.204071283340454
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0190922  Vali Loss: 0.0320033 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 6.1954872608184814
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0191250  Vali Loss: 0.0320100 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 6.192216873168945
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0192616  Vali Loss: 0.0320002 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 6.215336322784424
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0175417  Vali Loss: 0.0319958 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908382  Vali macro F1 0.9873140 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9311454  Test weighted F1: 0.9297015  Test macro F1 0.9338023 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.243576765060425
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0207115  Vali Loss: 0.0324489 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908291  Vali macro F1 0.9869619 
Validation loss decreased (inf --> 0.032449).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.192839860916138
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0203506  Vali Loss: 0.0362998 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9882684  Vali macro F1 0.9847810 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.1840808391571045
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0209214  Vali Loss: 0.0330977 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898012  Vali macro F1 0.9861526 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.1820478439331055
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0190396  Vali Loss: 0.0329039 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893094  Vali macro F1 0.9856662 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.215287685394287
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0188781  Vali Loss: 0.0334411 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898106  Vali macro F1 0.9858816 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.20885443687439
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0208425  Vali Loss: 0.0316528 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908390  Vali macro F1 0.9873368 
new best score!!!!
Validation loss decreased (0.032449 --> 0.031653).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.206898212432861
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0185477  Vali Loss: 0.0349291 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9892844  Vali macro F1 0.9849570 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.207147836685181
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0180622  Vali Loss: 0.0368391 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897944  Vali macro F1 0.9858248 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.20832371711731
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0178982  Vali Loss: 0.0331918 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898048  Vali macro F1 0.9861567 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.2123377323150635
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0184677  Vali Loss: 0.0385782 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9887743  Vali macro F1 0.9850188 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.210037469863892
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0171579  Vali Loss: 0.0303981 Vali Accuracy: 0.9913749  Vali weighted F1: 0.9913675  Vali macro F1 0.9881611 
new best score!!!!
Validation loss decreased (0.031653 --> 0.030398).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.190556049346924
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0164011  Vali Loss: 0.0335010 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903077  Vali macro F1 0.9863906 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.1997668743133545
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0173668  Vali Loss: 0.0330179 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903497  Vali macro F1 0.9874041 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.198655366897583
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0165451  Vali Loss: 0.0313901 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898111  Vali macro F1 0.9859041 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.193259239196777
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0163860  Vali Loss: 0.0326764 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898057  Vali macro F1 0.9855282 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.19708776473999
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0157827  Vali Loss: 0.0341397 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897926  Vali macro F1 0.9861493 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.191266059875488
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0157621  Vali Loss: 0.0318715 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9892852  Vali macro F1 0.9849797 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.22324800491333
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0154191  Vali Loss: 0.0319829 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903117  Vali macro F1 0.9864171 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.21693754196167
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0146325  Vali Loss: 0.0324442 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897995  Vali macro F1 0.9855479 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.204970121383667
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0144165  Vali Loss: 0.0322592 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897974  Vali macro F1 0.9858488 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.20953893661499
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0146434  Vali Loss: 0.0321656 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897995  Vali macro F1 0.9855479 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 6.2028608322143555
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0140986  Vali Loss: 0.0318994 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897995  Vali macro F1 0.9855479 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.931956052780151
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0139358  Vali Loss: 0.0318620 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897995  Vali macro F1 0.9855479 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.2448601722717285
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0145332  Vali Loss: 0.0317883 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897995  Vali macro F1 0.9855479 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.199535846710205
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0138702  Vali Loss: 0.0317495 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897995  Vali macro F1 0.9855479 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.212539434432983
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0133787  Vali Loss: 0.0316407 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9897995  Vali macro F1 0.9855479 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9259974  Test weighted F1: 0.9247712  Test macro F1 0.9227797 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014192 0.00017857 0.00096712 0.00121803 0.00047893 0.00060533]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.42618727684021
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.0623723  Vali Loss: 0.6583541 Vali Accuracy: 0.7577701  Vali weighted F1: 0.6942308  Vali macro F1 0.4780804 
Validation loss decreased (inf --> 0.658354).  Saving model ...
Epoch: 2 cost time: 6.400700330734253
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.5235921  Vali Loss: 0.4110393 Vali Accuracy: 0.8598915  Vali weighted F1: 0.8454158  Vali macro F1 0.8034760 
new best score!!!!
Validation loss decreased (0.658354 --> 0.411039).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.3775153160095215
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3666629  Vali Loss: 0.3766690 Vali Accuracy: 0.8633448  Vali weighted F1: 0.8559196  Vali macro F1 0.8287041 
new best score!!!!
Validation loss decreased (0.411039 --> 0.376669).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.406035900115967
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2834283  Vali Loss: 0.2406982 Vali Accuracy: 0.9126788  Vali weighted F1: 0.9109131  Vali macro F1 0.8832984 
new best score!!!!
Validation loss decreased (0.376669 --> 0.240698).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.409320831298828
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2178070  Vali Loss: 0.1764458 Vali Accuracy: 0.9412926  Vali weighted F1: 0.9395148  Vali macro F1 0.9247712 
new best score!!!!
Validation loss decreased (0.240698 --> 0.176446).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.408356428146362
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1756509  Vali Loss: 0.1407348 Vali Accuracy: 0.9546127  Vali weighted F1: 0.9552446  Vali macro F1 0.9437651 
new best score!!!!
Validation loss decreased (0.176446 --> 0.140735).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.406096935272217
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1450840  Vali Loss: 0.1211968 Vali Accuracy: 0.9575728  Vali weighted F1: 0.9567557  Vali macro F1 0.9467493 
new best score!!!!
Validation loss decreased (0.140735 --> 0.121197).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.4042582511901855
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1255088  Vali Loss: 0.1131844 Vali Accuracy: 0.9575728  Vali weighted F1: 0.9578992  Vali macro F1 0.9450135 
new best score!!!!
Validation loss decreased (0.121197 --> 0.113184).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.505886077880859
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1180610  Vali Loss: 0.0911988 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9716566  Vali macro F1 0.9612006 
new best score!!!!
Validation loss decreased (0.113184 --> 0.091199).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.416252613067627
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1074014  Vali Loss: 0.0918875 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9684883  Vali macro F1 0.9597197 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.407764434814453
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1060096  Vali Loss: 0.0901305 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9681708  Vali macro F1 0.9598647 
new best score!!!!
Validation loss decreased (0.091199 --> 0.090130).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.408684968948364
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0905742  Vali Loss: 0.0799035 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9718635  Vali macro F1 0.9636241 
new best score!!!!
Validation loss decreased (0.090130 --> 0.079904).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.402318239212036
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0874676  Vali Loss: 0.0808656 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9728131  Vali macro F1 0.9647029 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.4048357009887695
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0823856  Vali Loss: 0.0717938 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9772639  Vali macro F1 0.9697490 
new best score!!!!
Validation loss decreased (0.079904 --> 0.071794).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.414665460586548
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0779515  Vali Loss: 0.0738618 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9784032  Vali macro F1 0.9704224 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.433781623840332
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0664136  Vali Loss: 0.0680898 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9758198  Vali macro F1 0.9678931 
new best score!!!!
Validation loss decreased (0.071794 --> 0.068090).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.434576749801636
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0612424  Vali Loss: 0.0643528 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798231  Vali macro F1 0.9728004 
new best score!!!!
Validation loss decreased (0.068090 --> 0.064353).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.412269592285156
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0615359  Vali Loss: 0.0637511 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9801698  Vali macro F1 0.9730715 
new best score!!!!
Validation loss decreased (0.064353 --> 0.063751).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.416209936141968
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0556298  Vali Loss: 0.0562827 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818427  Vali macro F1 0.9741885 
new best score!!!!
Validation loss decreased (0.063751 --> 0.056283).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.397671937942505
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0588022  Vali Loss: 0.0702339 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9742975  Vali macro F1 0.9660849 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.4045774936676025
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0588026  Vali Loss: 0.0634679 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9824114  Vali macro F1 0.9751062 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.410336256027222
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0515445  Vali Loss: 0.0644731 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812182  Vali macro F1 0.9742402 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.410884380340576
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0552708  Vali Loss: 0.0542318 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837093  Vali macro F1 0.9792439 
new best score!!!!
Validation loss decreased (0.056283 --> 0.054232).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.426104784011841
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0447121  Vali Loss: 0.0564980 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832326  Vali macro F1 0.9759242 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.431630373001099
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0445932  Vali Loss: 0.0469207 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857471  Vali macro F1 0.9799254 
new best score!!!!
Validation loss decreased (0.054232 --> 0.046921).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.410657167434692
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0474356  Vali Loss: 0.0502517 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9823124  Vali macro F1 0.9745615 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.404022932052612
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0397502  Vali Loss: 0.0561436 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9791532  Vali macro F1 0.9720545 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.3988800048828125
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0385358  Vali Loss: 0.0890677 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9707938  Vali macro F1 0.9641534 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.412267208099365
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0418029  Vali Loss: 0.0533940 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818859  Vali macro F1 0.9746002 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.3992016315460205
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0355461  Vali Loss: 0.0467675 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871922  Vali macro F1 0.9816387 
new best score!!!!
Validation loss decreased (0.046921 --> 0.046767).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.41006326675415
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0315708  Vali Loss: 0.0474300 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9833071  Vali macro F1 0.9751674 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.439680099487305
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0276659  Vali Loss: 0.0463398 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9851881  Vali macro F1 0.9794604 
new best score!!!!
Validation loss decreased (0.046767 --> 0.046340).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.42689847946167
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0279651  Vali Loss: 0.0541246 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9806839  Vali macro F1 0.9743681 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.403856515884399
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0258119  Vali Loss: 0.0496266 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852003  Vali macro F1 0.9792080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.402498960494995
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0250396  Vali Loss: 0.0543122 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9816986  Vali macro F1 0.9751301 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.4108195304870605
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0285563  Vali Loss: 0.0530098 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832262  Vali macro F1 0.9763695 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.417612552642822
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0296651  Vali Loss: 0.0575587 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813397  Vali macro F1 0.9737742 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 6.418154954910278
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0196938  Vali Loss: 0.0448274 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852087  Vali macro F1 0.9786555 
new best score!!!!
Validation loss decreased (0.046340 --> 0.044827).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.432846307754517
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0153995  Vali Loss: 0.0448120 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857041  Vali macro F1 0.9794061 
new best score!!!!
Validation loss decreased (0.044827 --> 0.044812).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.432325124740601
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0151244  Vali Loss: 0.0465271 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842168  Vali macro F1 0.9773187 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.4123077392578125
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0148997  Vali Loss: 0.0451308 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861927  Vali macro F1 0.9801877 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.407876491546631
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0134910  Vali Loss: 0.0438735 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856959  Vali macro F1 0.9793849 
new best score!!!!
Validation loss decreased (0.044812 --> 0.043874).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.407313823699951
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0141097  Vali Loss: 0.0450110 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861927  Vali macro F1 0.9801877 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.403790473937988
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0128145  Vali Loss: 0.0447425 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861927  Vali macro F1 0.9801877 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.4127233028411865
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0134347  Vali Loss: 0.0467123 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861750  Vali macro F1 0.9801604 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.409195423126221
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0135128  Vali Loss: 0.0448941 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861927  Vali macro F1 0.9801877 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.434153318405151
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0131891  Vali Loss: 0.0431749 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857159  Vali macro F1 0.9791762 
new best score!!!!
Validation loss decreased (0.043874 --> 0.043175).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.3980090618133545
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0125612  Vali Loss: 0.0433693 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861927  Vali macro F1 0.9801877 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.398188591003418
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0121930  Vali Loss: 0.0424219 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856959  Vali macro F1 0.9793849 
new best score!!!!
Validation loss decreased (0.043175 --> 0.042422).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.403550863265991
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0127369  Vali Loss: 0.0419358 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871998  Vali macro F1 0.9810179 
new best score!!!!
Validation loss decreased (0.042422 --> 0.041936).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.4050538539886475
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0124917  Vali Loss: 0.0433141 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861927  Vali macro F1 0.9801877 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.403011083602905
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0106655  Vali Loss: 0.0431322 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866767  Vali macro F1 0.9803567 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.41588282585144
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0116570  Vali Loss: 0.0445089 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866767  Vali macro F1 0.9803567 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.405102252960205
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0113270  Vali Loss: 0.0440448 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856888  Vali macro F1 0.9790757 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.428551197052002
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0118720  Vali Loss: 0.0452759 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861925  Vali macro F1 0.9799474 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 6.417382001876831
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0102723  Vali Loss: 0.0439769 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861927  Vali macro F1 0.9801877 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.403976917266846
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0105331  Vali Loss: 0.0441653 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866752  Vali macro F1 0.9806614 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.417940616607666
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0114714  Vali Loss: 0.0444092 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861865  Vali macro F1 0.9798797 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.406587362289429
VALI: Epoch: 59, Steps: 72 | Train Loss: 0.0098118  Vali Loss: 0.0442740 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866752  Vali macro F1 0.9806614 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 8.77557373046875
VALI: Epoch: 60, Steps: 72 | Train Loss: 0.0117785  Vali Loss: 0.0443490 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861865  Vali macro F1 0.9798797 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.409411668777466
VALI: Epoch: 61, Steps: 72 | Train Loss: 0.0102323  Vali Loss: 0.0442937 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866752  Vali macro F1 0.9806614 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.435985565185547
VALI: Epoch: 62, Steps: 72 | Train Loss: 0.0100463  Vali Loss: 0.0442645 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861865  Vali macro F1 0.9798797 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.408978700637817
VALI: Epoch: 63, Steps: 72 | Train Loss: 0.0096958  Vali Loss: 0.0442073 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866752  Vali macro F1 0.9806614 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.3968565464019775
VALI: Epoch: 64, Steps: 72 | Train Loss: 0.0110502  Vali Loss: 0.0441281 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866752  Vali macro F1 0.9806614 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.420562028884888
VALI: Epoch: 65, Steps: 72 | Train Loss: 0.0105108  Vali Loss: 0.0441316 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866752  Vali macro F1 0.9806614 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8627962  Test weighted F1: 0.8522050  Test macro F1 0.6367254 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.4055891036987305
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0115152  Vali Loss: 0.0461456 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861773  Vali macro F1 0.9798571 
Validation loss decreased (inf --> 0.046146).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3863844871521
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0119995  Vali Loss: 0.0433768 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862045  Vali macro F1 0.9799577 
new best score!!!!
Validation loss decreased (0.046146 --> 0.043377).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.386659145355225
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0120323  Vali Loss: 0.0468653 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9851957  Vali macro F1 0.9785946 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.412081480026245
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0117296  Vali Loss: 0.0428079 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871994  Vali macro F1 0.9812577 
new best score!!!!
Validation loss decreased (0.043377 --> 0.042808).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.417766809463501
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0118387  Vali Loss: 0.0464049 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856844  Vali macro F1 0.9796151 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.402935743331909
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0109411  Vali Loss: 0.0453319 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861838  Vali macro F1 0.9801147 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.399538516998291
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0115605  Vali Loss: 0.0416132 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866921  Vali macro F1 0.9806873 
new best score!!!!
Validation loss decreased (0.042808 --> 0.041613).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.412781000137329
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0111223  Vali Loss: 0.0416933 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872115  Vali macro F1 0.9810277 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.40278434753418
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0109606  Vali Loss: 0.0448766 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862050  Vali macro F1 0.9799841 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.40632700920105
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0107864  Vali Loss: 0.0428300 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862164  Vali macro F1 0.9796773 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.403339862823486
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0091758  Vali Loss: 0.0425698 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867048  Vali macro F1 0.9802187 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.408483505249023
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0107605  Vali Loss: 0.0473299 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867048  Vali macro F1 0.9802187 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.432800054550171
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0093391  Vali Loss: 0.0461357 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867039  Vali macro F1 0.9804572 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.3911120891571045
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0094616  Vali Loss: 0.0470066 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852074  Vali macro F1 0.9786035 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.377865791320801
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0103825  Vali Loss: 0.0505470 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856817  Vali macro F1 0.9791057 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.367995262145996
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0096733  Vali Loss: 0.0441306 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856959  Vali macro F1 0.9793849 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.39035177230835
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0091593  Vali Loss: 0.0438676 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871951  Vali macro F1 0.9815575 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.388954401016235
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0086103  Vali Loss: 0.0440362 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862045  Vali macro F1 0.9799577 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.387327194213867
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0075140  Vali Loss: 0.0450014 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857159  Vali macro F1 0.9791762 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.382053375244141
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0073482  Vali Loss: 0.0449416 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862045  Vali macro F1 0.9799577 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.402771711349487
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0089096  Vali Loss: 0.0450665 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867039  Vali macro F1 0.9804572 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.366403341293335
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0078056  Vali Loss: 0.0451723 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857159  Vali macro F1 0.9791762 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8580821  Test weighted F1: 0.8492213  Test macro F1 0.6370059 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014422 0.00016992 0.000999   0.00131579 0.00050025 0.00062814]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.330286026000977
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0455820  Vali Loss: 0.6244563 Vali Accuracy: 0.7756315  Vali weighted F1: 0.7127436  Vali macro F1 0.5167203 
Validation loss decreased (inf --> 0.624456).  Saving model ...
Epoch: 2 cost time: 6.318069696426392
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5385307  Vali Loss: 0.4763415 Vali Accuracy: 0.8410104  Vali weighted F1: 0.8143683  Vali macro F1 0.7478733 
new best score!!!!
Validation loss decreased (0.624456 --> 0.476342).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.309544086456299
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4007620  Vali Loss: 0.3052657 Vali Accuracy: 0.8845963  Vali weighted F1: 0.8772513  Vali macro F1 0.8340788 
new best score!!!!
Validation loss decreased (0.476342 --> 0.305266).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.310816049575806
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2792099  Vali Loss: 0.2195367 Vali Accuracy: 0.9227340  Vali weighted F1: 0.9184064  Vali macro F1 0.8844245 
new best score!!!!
Validation loss decreased (0.305266 --> 0.219537).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.331448793411255
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2140929  Vali Loss: 0.1566413 Vali Accuracy: 0.9470035  Vali weighted F1: 0.9461990  Vali macro F1 0.9203360 
new best score!!!!
Validation loss decreased (0.219537 --> 0.156641).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.374869108200073
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1780123  Vali Loss: 0.1469652 Vali Accuracy: 0.9484894  Vali weighted F1: 0.9475216  Vali macro F1 0.9217012 
new best score!!!!
Validation loss decreased (0.156641 --> 0.146965).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.341672420501709
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1604661  Vali Loss: 0.1231011 Vali Accuracy: 0.9549282  Vali weighted F1: 0.9542721  Vali macro F1 0.9312729 
new best score!!!!
Validation loss decreased (0.146965 --> 0.123101).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.332083225250244
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1495918  Vali Loss: 0.1174008 Vali Accuracy: 0.9588905  Vali weighted F1: 0.9587126  Vali macro F1 0.9371907 
new best score!!!!
Validation loss decreased (0.123101 --> 0.117401).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.331971645355225
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1329774  Vali Loss: 0.1191669 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9593058  Vali macro F1 0.9376810 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.3326592445373535
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1254654  Vali Loss: 0.1156531 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9637026  Vali macro F1 0.9436261 
new best score!!!!
Validation loss decreased (0.117401 --> 0.115653).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.342352628707886
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1248195  Vali Loss: 0.1003150 Vali Accuracy: 0.9603764  Vali weighted F1: 0.9599675  Vali macro F1 0.9393613 
new best score!!!!
Validation loss decreased (0.115653 --> 0.100315).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.331881999969482
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1141860  Vali Loss: 0.0986117 Vali Accuracy: 0.9673105  Vali weighted F1: 0.9671652  Vali macro F1 0.9474360 
new best score!!!!
Validation loss decreased (0.100315 --> 0.098612).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.336453676223755
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1048160  Vali Loss: 0.0872567 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9665808  Vali macro F1 0.9464268 
new best score!!!!
Validation loss decreased (0.098612 --> 0.087257).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.35905909538269
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1075719  Vali Loss: 0.0853232 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9695156  Vali macro F1 0.9508880 
new best score!!!!
Validation loss decreased (0.087257 --> 0.085323).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.346684217453003
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0933100  Vali Loss: 0.0739720 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742014  Vali macro F1 0.9565135 
new best score!!!!
Validation loss decreased (0.085323 --> 0.073972).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.3283162117004395
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0917439  Vali Loss: 0.0980069 Vali Accuracy: 0.9678058  Vali weighted F1: 0.9682484  Vali macro F1 0.9529250 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.331276893615723
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0897937  Vali Loss: 0.0762804 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9741761  Vali macro F1 0.9634220 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.335898399353027
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0831386  Vali Loss: 0.0776012 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9738561  Vali macro F1 0.9616455 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 6.330382823944092
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0758006  Vali Loss: 0.0633397 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9752981  Vali macro F1 0.9646054 
new best score!!!!
Validation loss decreased (0.073972 --> 0.063340).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.3447184562683105
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0722368  Vali Loss: 0.0725156 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9723308  Vali macro F1 0.9607539 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.333959341049194
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0672102  Vali Loss: 0.0576736 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9786510  Vali macro F1 0.9691498 
new best score!!!!
Validation loss decreased (0.063340 --> 0.057674).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.348108530044556
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0663008  Vali Loss: 0.0599291 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9761361  Vali macro F1 0.9652913 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.348195314407349
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0609379  Vali Loss: 0.0664930 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9762065  Vali macro F1 0.9664430 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.334334850311279
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0662793  Vali Loss: 0.0504347 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836999  Vali macro F1 0.9752434 
new best score!!!!
Validation loss decreased (0.057674 --> 0.050435).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.3249592781066895
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0549248  Vali Loss: 0.0548014 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808223  Vali macro F1 0.9725130 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.32763147354126
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0544262  Vali Loss: 0.0509869 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837560  Vali macro F1 0.9751584 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.343053817749023
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0500993  Vali Loss: 0.0492709 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836376  Vali macro F1 0.9750986 
new best score!!!!
Validation loss decreased (0.050435 --> 0.049271).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.337208271026611
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0438185  Vali Loss: 0.0540978 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846727  Vali macro F1 0.9767569 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.336956977844238
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0431186  Vali Loss: 0.0426933 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851072  Vali macro F1 0.9774012 
new best score!!!!
Validation loss decreased (0.049271 --> 0.042693).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.362405776977539
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0508635  Vali Loss: 0.0500599 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832027  Vali macro F1 0.9741420 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.3349363803863525
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0410465  Vali Loss: 0.0546778 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9795773  Vali macro F1 0.9700889 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.336624383926392
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0396321  Vali Loss: 0.0461216 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9853012  Vali macro F1 0.9778483 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.335533618927002
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0351467  Vali Loss: 0.0485942 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9813153  Vali macro F1 0.9730360 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.337258338928223
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0344225  Vali Loss: 0.0472367 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837474  Vali macro F1 0.9767899 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.338212251663208
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0254029  Vali Loss: 0.0413131 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851736  Vali macro F1 0.9780838 
new best score!!!!
Validation loss decreased (0.042693 --> 0.041313).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.343100547790527
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0226322  Vali Loss: 0.0393041 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876703  Vali macro F1 0.9816652 
new best score!!!!
Validation loss decreased (0.041313 --> 0.039304).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.358191728591919
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0213994  Vali Loss: 0.0422676 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871289  Vali macro F1 0.9804874 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.3487091064453125
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0221556  Vali Loss: 0.0374314 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881591  Vali macro F1 0.9828724 
new best score!!!!
Validation loss decreased (0.039304 --> 0.037431).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.332276821136475
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0220689  Vali Loss: 0.0372274 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871710  Vali macro F1 0.9807873 
new best score!!!!
Validation loss decreased (0.037431 --> 0.037227).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.342634677886963
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0214448  Vali Loss: 0.0364746 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866652  Vali macro F1 0.9806432 
new best score!!!!
Validation loss decreased (0.037227 --> 0.036475).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.34571385383606
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0201907  Vali Loss: 0.0385630 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881325  Vali macro F1 0.9825655 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.3364856243133545
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0200869  Vali Loss: 0.0386560 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861518  Vali macro F1 0.9796052 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.3318188190460205
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0182363  Vali Loss: 0.0369383 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866571  Vali macro F1 0.9807458 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.3244359493255615
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0194117  Vali Loss: 0.0368430 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871282  Vali macro F1 0.9811887 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.358503103256226
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0193073  Vali Loss: 0.0368940 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867029  Vali macro F1 0.9800871 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 6.330514669418335
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0180627  Vali Loss: 0.0376140 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871294  Vali macro F1 0.9805721 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.329930782318115
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0182547  Vali Loss: 0.0387638 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866360  Vali macro F1 0.9797246 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.331145286560059
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0174670  Vali Loss: 0.0388746 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871309  Vali macro F1 0.9805848 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.323861598968506
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0180653  Vali Loss: 0.0391788 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866360  Vali macro F1 0.9797246 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.324953317642212
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0180090  Vali Loss: 0.0390536 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871309  Vali macro F1 0.9805848 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 6.326408386230469
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0173192  Vali Loss: 0.0389700 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871309  Vali macro F1 0.9805848 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.325727224349976
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0178242  Vali Loss: 0.0389675 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871309  Vali macro F1 0.9805848 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.344271183013916
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0172490  Vali Loss: 0.0388504 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871309  Vali macro F1 0.9805848 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.350855588912964
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0171196  Vali Loss: 0.0388269 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871309  Vali macro F1 0.9805848 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.336380243301392
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0169484  Vali Loss: 0.0387803 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871309  Vali macro F1 0.9805848 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8991716  Test weighted F1: 0.8961620  Test macro F1 0.8545870 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.45248818397522
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0212454  Vali Loss: 0.0395151 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871856  Vali macro F1 0.9814524 
Validation loss decreased (inf --> 0.039515).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.401290655136108
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0209082  Vali Loss: 0.0416274 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861258  Vali macro F1 0.9798335 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.3557798862457275
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0194559  Vali Loss: 0.0396981 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871294  Vali macro F1 0.9808434 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.3925511837005615
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0191391  Vali Loss: 0.0404861 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871294  Vali macro F1 0.9805721 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.3781561851501465
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0204482  Vali Loss: 0.0388144 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861605  Vali macro F1 0.9797973 
new best score!!!!
Validation loss decreased (0.039515 --> 0.038814).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.372981071472168
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0188802  Vali Loss: 0.0361437 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876229  Vali macro F1 0.9814204 
new best score!!!!
Validation loss decreased (0.038814 --> 0.036144).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.404002904891968
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0163002  Vali Loss: 0.0386179 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876244  Vali macro F1 0.9814326 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.384509086608887
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0167250  Vali Loss: 0.0399082 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866550  Vali macro F1 0.9800397 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.379486083984375
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0177307  Vali Loss: 0.0447350 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861253  Vali macro F1 0.9792269 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.352811336517334
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0172000  Vali Loss: 0.0366053 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871450  Vali macro F1 0.9814874 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.364335060119629
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0167390  Vali Loss: 0.0384316 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861427  Vali macro F1 0.9794953 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.37061071395874
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0160330  Vali Loss: 0.0358977 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876397  Vali macro F1 0.9820773 
new best score!!!!
Validation loss decreased (0.036144 --> 0.035898).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.388300657272339
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0165418  Vali Loss: 0.0370618 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871650  Vali macro F1 0.9815328 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.410104036331177
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0161606  Vali Loss: 0.0381913 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881228  Vali macro F1 0.9820172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.385376691818237
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0171903  Vali Loss: 0.0372438 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876254  Vali macro F1 0.9820528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.382030487060547
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0145189  Vali Loss: 0.0375129 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876452  Vali macro F1 0.9821169 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.388843297958374
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0160285  Vali Loss: 0.0386391 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881519  Vali macro F1 0.9825028 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.383752346038818
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0141060  Vali Loss: 0.0382382 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881519  Vali macro F1 0.9825028 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.393807888031006
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0140554  Vali Loss: 0.0375068 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876563  Vali macro F1 0.9816420 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.376050710678101
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0140513  Vali Loss: 0.0371794 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881473  Vali macro F1 0.9824855 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.415397882461548
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0129783  Vali Loss: 0.0364803 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876558  Vali macro F1 0.9820084 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.406212568283081
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0140044  Vali Loss: 0.0369683 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881473  Vali macro F1 0.9824855 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.3911216259002686
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0132578  Vali Loss: 0.0369633 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881473  Vali macro F1 0.9824855 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.391008138656616
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0144448  Vali Loss: 0.0369049 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881473  Vali macro F1 0.9824855 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.371346712112427
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0140061  Vali Loss: 0.0368779 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881473  Vali macro F1 0.9824855 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.388454914093018
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0143706  Vali Loss: 0.0367752 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881473  Vali macro F1 0.9824855 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.375333547592163
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0136183  Vali Loss: 0.0368023 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881473  Vali macro F1 0.9824855 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9007101  Test weighted F1: 0.8980131  Test macro F1 0.8604109 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014641 0.00017768 0.00108108 0.00133156 0.0005     0.00062461]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.207131385803223
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0806730  Vali Loss: 0.7398235 Vali Accuracy: 0.7468290  Vali weighted F1: 0.6893474  Vali macro F1 0.4756013 
Validation loss decreased (inf --> 0.739824).  Saving model ...
Epoch: 2 cost time: 6.195070505142212
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6068017  Vali Loss: 0.5186733 Vali Accuracy: 0.8138001  Vali weighted F1: 0.7744766  Vali macro F1 0.7026544 
new best score!!!!
Validation loss decreased (0.739824 --> 0.518673).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.225678205490112
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4485891  Vali Loss: 0.3745479 Vali Accuracy: 0.8772197  Vali weighted F1: 0.8658118  Vali macro F1 0.8305956 
new best score!!!!
Validation loss decreased (0.518673 --> 0.374548).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.203543186187744
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3328482  Vali Loss: 0.3090193 Vali Accuracy: 0.9010654  Vali weighted F1: 0.8916338  Vali macro F1 0.8639011 
new best score!!!!
Validation loss decreased (0.374548 --> 0.309019).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.21060585975647
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2775505  Vali Loss: 0.2364340 Vali Accuracy: 0.9228818  Vali weighted F1: 0.9221974  Vali macro F1 0.8973781 
new best score!!!!
Validation loss decreased (0.309019 --> 0.236434).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.193704128265381
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2225353  Vali Loss: 0.2104649 Vali Accuracy: 0.9355657  Vali weighted F1: 0.9338011  Vali macro F1 0.9175678 
new best score!!!!
Validation loss decreased (0.236434 --> 0.210465).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.199500322341919
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1931226  Vali Loss: 0.1716550 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9412021  Vali macro F1 0.9172515 
new best score!!!!
Validation loss decreased (0.210465 --> 0.171655).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.208691835403442
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1647648  Vali Loss: 0.1499726 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9496315  Vali macro F1 0.9304473 
new best score!!!!
Validation loss decreased (0.171655 --> 0.149973).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.209474325180054
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1502254  Vali Loss: 0.2210480 Vali Accuracy: 0.9320142  Vali weighted F1: 0.9255737  Vali macro F1 0.9144445 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.233829736709595
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1581969  Vali Loss: 0.1378831 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9553382  Vali macro F1 0.9432024 
new best score!!!!
Validation loss decreased (0.149973 --> 0.137883).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.239251375198364
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1280496  Vali Loss: 0.1163751 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9639000  Vali macro F1 0.9569736 
new best score!!!!
Validation loss decreased (0.137883 --> 0.116375).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.208062648773193
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1269249  Vali Loss: 0.1194249 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9622698  Vali macro F1 0.9565036 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.21206259727478
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1103023  Vali Loss: 0.1144710 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9654104  Vali macro F1 0.9568247 
new best score!!!!
Validation loss decreased (0.116375 --> 0.114471).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.21056866645813
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1044144  Vali Loss: 0.1054234 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9679414  Vali macro F1 0.9635748 
new best score!!!!
Validation loss decreased (0.114471 --> 0.105423).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.2082602977752686
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0911308  Vali Loss: 0.0828350 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9731014  Vali macro F1 0.9676949 
new best score!!!!
Validation loss decreased (0.105423 --> 0.082835).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.211814880371094
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0967545  Vali Loss: 0.0924882 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9700187  Vali macro F1 0.9655680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.217674970626831
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0853311  Vali Loss: 0.1220398 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9586098  Vali macro F1 0.9563566 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.235222816467285
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0834500  Vali Loss: 0.0705073 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9805518  Vali macro F1 0.9763948 
new best score!!!!
Validation loss decreased (0.082835 --> 0.070507).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.2197465896606445
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0830184  Vali Loss: 0.0848240 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9729632  Vali macro F1 0.9660901 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.216427803039551
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0797223  Vali Loss: 0.0769958 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9761152  Vali macro F1 0.9674657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.218525648117065
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0713686  Vali Loss: 0.0704195 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9800254  Vali macro F1 0.9765212 
new best score!!!!
Validation loss decreased (0.070507 --> 0.070420).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.212738513946533
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0718989  Vali Loss: 0.0940723 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9688225  Vali macro F1 0.9613683 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.210897445678711
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0647975  Vali Loss: 0.0663218 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832489  Vali macro F1 0.9810100 
new best score!!!!
Validation loss decreased (0.070420 --> 0.066322).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.213868618011475
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0595587  Vali Loss: 0.0661737 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796126  Vali macro F1 0.9771234 
new best score!!!!
Validation loss decreased (0.066322 --> 0.066174).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.208127021789551
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0553636  Vali Loss: 0.0935317 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9698824  Vali macro F1 0.9649475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.223520278930664
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0590575  Vali Loss: 0.0559946 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832726  Vali macro F1 0.9796882 
new best score!!!!
Validation loss decreased (0.066174 --> 0.055995).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.208508491516113
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0505857  Vali Loss: 0.0957850 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9673730  Vali macro F1 0.9630595 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.216074705123901
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0521034  Vali Loss: 0.0745954 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9764635  Vali macro F1 0.9711146 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.2160632610321045
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0496339  Vali Loss: 0.0638561 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9810928  Vali macro F1 0.9781624 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.219073057174683
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0595548  Vali Loss: 0.0813414 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9730503  Vali macro F1 0.9703538 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.216440200805664
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0414330  Vali Loss: 0.0610575 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806953  Vali macro F1 0.9778947 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.209876298904419
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0310912  Vali Loss: 0.0540817 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837220  Vali macro F1 0.9804354 
new best score!!!!
Validation loss decreased (0.055995 --> 0.054082).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.208019256591797
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0294457  Vali Loss: 0.0524351 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9836984  Vali macro F1 0.9814331 
new best score!!!!
Validation loss decreased (0.054082 --> 0.052435).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.225940942764282
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0263297  Vali Loss: 0.0526165 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832371  Vali macro F1 0.9814133 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.208907127380371
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0265960  Vali Loss: 0.0522981 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847689  Vali macro F1 0.9829495 
new best score!!!!
Validation loss decreased (0.052435 --> 0.052298).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.209785461425781
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0265513  Vali Loss: 0.0530427 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842535  Vali macro F1 0.9825720 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.202229261398315
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0262359  Vali Loss: 0.0515051 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852403  Vali macro F1 0.9836899 
new best score!!!!
Validation loss decreased (0.052298 --> 0.051505).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.200573921203613
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0253518  Vali Loss: 0.0523519 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842323  Vali macro F1 0.9823113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.208879232406616
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0255012  Vali Loss: 0.0515079 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842135  Vali macro F1 0.9830003 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.206173896789551
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0248175  Vali Loss: 0.0538258 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837171  Vali macro F1 0.9822070 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.194338083267212
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0251535  Vali Loss: 0.0529627 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842399  Vali macro F1 0.9819695 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.21289849281311
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0231538  Vali Loss: 0.0529429 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842189  Vali macro F1 0.9824548 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 6.230665445327759
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0233602  Vali Loss: 0.0529916 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847453  Vali macro F1 0.9829235 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.204791307449341
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0235621  Vali Loss: 0.0532248 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847453  Vali macro F1 0.9829235 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.215245962142944
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0243109  Vali Loss: 0.0535901 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847549  Vali macro F1 0.9825928 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.209230422973633
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0215140  Vali Loss: 0.0534689 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842275  Vali macro F1 0.9823422 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.207181453704834
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0227253  Vali Loss: 0.0531854 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842363  Vali macro F1 0.9821246 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 48 cost time: 6.206711292266846
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0233063  Vali Loss: 0.0531736 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847436  Vali macro F1 0.9829480 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.2146079540252686
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0230575  Vali Loss: 0.0531237 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847436  Vali macro F1 0.9829480 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.243640184402466
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0233089  Vali Loss: 0.0531826 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842363  Vali macro F1 0.9821246 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.212490081787109
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0233594  Vali Loss: 0.0532058 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842363  Vali macro F1 0.9821246 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.220702409744263
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0224303  Vali Loss: 0.0531564 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842363  Vali macro F1 0.9821246 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9297874  Test weighted F1: 0.9295107  Test macro F1 0.8722178 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.234606981277466
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0256662  Vali Loss: 0.0541448 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9831892  Vali macro F1 0.9813511 
Validation loss decreased (inf --> 0.054145).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2259299755096436
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0250079  Vali Loss: 0.0560669 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832183  Vali macro F1 0.9811409 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.209860324859619
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0256243  Vali Loss: 0.0533264 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9836959  Vali macro F1 0.9815965 
new best score!!!!
Validation loss decreased (0.054145 --> 0.053326).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.220131874084473
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0246252  Vali Loss: 0.0520898 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847570  Vali macro F1 0.9825852 
new best score!!!!
Validation loss decreased (0.053326 --> 0.052090).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.248069524765015
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0241172  Vali Loss: 0.0550962 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847044  Vali macro F1 0.9831869 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.256325006484985
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0228745  Vali Loss: 0.0510614 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852717  Vali macro F1 0.9831989 
new best score!!!!
Validation loss decreased (0.052090 --> 0.051061).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.238785266876221
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0218069  Vali Loss: 0.0515450 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852672  Vali macro F1 0.9835263 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.220578193664551
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0220655  Vali Loss: 0.0515275 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9841805  Vali macro F1 0.9824442 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.222722768783569
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0220543  Vali Loss: 0.0569670 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842561  Vali macro F1 0.9821297 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.225407361984253
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0216197  Vali Loss: 0.0511393 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867950  Vali macro F1 0.9849256 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.230490684509277
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0203880  Vali Loss: 0.0526320 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9846497  Vali macro F1 0.9831240 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.230736017227173
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0198797  Vali Loss: 0.0505333 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847186  Vali macro F1 0.9828688 
new best score!!!!
Validation loss decreased (0.051061 --> 0.050533).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.245485544204712
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0222482  Vali Loss: 0.0551325 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842365  Vali macro F1 0.9818894 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.238688945770264
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0199549  Vali Loss: 0.0587871 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837433  Vali macro F1 0.9807779 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.2444658279418945
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0201296  Vali Loss: 0.0555850 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842624  Vali macro F1 0.9817890 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.234057426452637
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0196856  Vali Loss: 0.0586341 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9831453  Vali macro F1 0.9809374 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.228949069976807
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0180077  Vali Loss: 0.0543701 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847631  Vali macro F1 0.9823571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.228832721710205
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0179364  Vali Loss: 0.0539790 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852642  Vali macro F1 0.9833920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.2497475147247314
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0169290  Vali Loss: 0.0540273 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837045  Vali macro F1 0.9816597 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.217632532119751
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0164072  Vali Loss: 0.0541701 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847791  Vali macro F1 0.9829611 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.214935779571533
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0175803  Vali Loss: 0.0539068 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847720  Vali macro F1 0.9826039 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.250630617141724
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0165500  Vali Loss: 0.0538598 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852580  Vali macro F1 0.9834205 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.217531442642212
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0159336  Vali Loss: 0.0539070 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847512  Vali macro F1 0.9825987 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.2264955043792725
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0169797  Vali Loss: 0.0538567 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847512  Vali macro F1 0.9825987 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.239821434020996
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0163615  Vali Loss: 0.0538538 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852580  Vali macro F1 0.9834205 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.249781847000122
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0164792  Vali Loss: 0.0539591 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852702  Vali macro F1 0.9830672 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.265337705612183
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0162525  Vali Loss: 0.0540112 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852702  Vali macro F1 0.9830672 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9342965  Test weighted F1: 0.9345242  Test macro F1 0.8864251 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013949 0.00018396 0.00103413 0.00129702 0.00048591 0.00059988]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.3701488971710205
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0391997  Vali Loss: 0.6343366 Vali Accuracy: 0.7674303  Vali weighted F1: 0.7115793  Vali macro F1 0.4936064 
Validation loss decreased (inf --> 0.634337).  Saving model ...
Epoch: 2 cost time: 6.353519916534424
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5341834  Vali Loss: 0.4142628 Vali Accuracy: 0.8441235  Vali weighted F1: 0.8235742  Vali macro F1 0.7569682 
new best score!!!!
Validation loss decreased (0.634337 --> 0.414263).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 7.79206395149231
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3619579  Vali Loss: 0.2779601 Vali Accuracy: 0.9078685  Vali weighted F1: 0.9066375  Vali macro F1 0.8650329 
new best score!!!!
Validation loss decreased (0.414263 --> 0.277960).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.303878545761108
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2709180  Vali Loss: 0.2212972 Vali Accuracy: 0.9208167  Vali weighted F1: 0.9191586  Vali macro F1 0.8738176 
new best score!!!!
Validation loss decreased (0.277960 --> 0.221297).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.3291895389556885
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2162037  Vali Loss: 0.1896272 Vali Accuracy: 0.9377490  Vali weighted F1: 0.9371348  Vali macro F1 0.9021081 
new best score!!!!
Validation loss decreased (0.221297 --> 0.189627).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.325434684753418
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2035310  Vali Loss: 0.1859201 Vali Accuracy: 0.9377490  Vali weighted F1: 0.9373873  Vali macro F1 0.9065800 
new best score!!!!
Validation loss decreased (0.189627 --> 0.185920).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.320997476577759
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1714161  Vali Loss: 0.1559949 Vali Accuracy: 0.9477092  Vali weighted F1: 0.9478615  Vali macro F1 0.9198003 
new best score!!!!
Validation loss decreased (0.185920 --> 0.155995).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.316449880599976
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1649922  Vali Loss: 0.1511873 Vali Accuracy: 0.9511952  Vali weighted F1: 0.9506363  Vali macro F1 0.9292802 
new best score!!!!
Validation loss decreased (0.155995 --> 0.151187).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.304578065872192
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1455706  Vali Loss: 0.1467825 Vali Accuracy: 0.9472112  Vali weighted F1: 0.9473159  Vali macro F1 0.9191664 
new best score!!!!
Validation loss decreased (0.151187 --> 0.146782).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.337763071060181
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1313633  Vali Loss: 0.1393283 Vali Accuracy: 0.9541833  Vali weighted F1: 0.9535377  Vali macro F1 0.9320932 
new best score!!!!
Validation loss decreased (0.146782 --> 0.139328).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.337467432022095
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1177024  Vali Loss: 0.1422571 Vali Accuracy: 0.9531873  Vali weighted F1: 0.9529249  Vali macro F1 0.9287016 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.332556962966919
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1116343  Vali Loss: 0.1352293 Vali Accuracy: 0.9551793  Vali weighted F1: 0.9546443  Vali macro F1 0.9299983 
new best score!!!!
Validation loss decreased (0.139328 --> 0.135229).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.323898077011108
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1103508  Vali Loss: 0.1264233 Vali Accuracy: 0.9611554  Vali weighted F1: 0.9599070  Vali macro F1 0.9458124 
new best score!!!!
Validation loss decreased (0.135229 --> 0.126423).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.334043979644775
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0953695  Vali Loss: 0.1044009 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9659664  Vali macro F1 0.9510022 
new best score!!!!
Validation loss decreased (0.126423 --> 0.104401).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.3391852378845215
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0879975  Vali Loss: 0.1174297 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9633179  Vali macro F1 0.9430909 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.320415258407593
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0953806  Vali Loss: 0.1049565 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9653754  Vali macro F1 0.9490907 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.333071708679199
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0827764  Vali Loss: 0.0906637 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9706335  Vali macro F1 0.9546163 
new best score!!!!
Validation loss decreased (0.104401 --> 0.090664).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.358025550842285
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0775070  Vali Loss: 0.0911855 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9741111  Vali macro F1 0.9595648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.337306022644043
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0718098  Vali Loss: 0.0915229 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723536  Vali macro F1 0.9561740 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.334354400634766
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0749739  Vali Loss: 0.0860735 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9720605  Vali macro F1 0.9576851 
new best score!!!!
Validation loss decreased (0.090664 --> 0.086073).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.336136817932129
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0632869  Vali Loss: 0.0893741 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742436  Vali macro F1 0.9613209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.320071220397949
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0656851  Vali Loss: 0.0808428 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9749719  Vali macro F1 0.9623920 
new best score!!!!
Validation loss decreased (0.086073 --> 0.080843).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.328790187835693
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0613860  Vali Loss: 0.0858261 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9724498  Vali macro F1 0.9580933 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.326337099075317
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0561995  Vali Loss: 0.0890922 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9741540  Vali macro F1 0.9614145 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.348637104034424
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0572703  Vali Loss: 0.0874207 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9736868  Vali macro F1 0.9591842 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.345934867858887
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0477691  Vali Loss: 0.0863025 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9759422  Vali macro F1 0.9643983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 6.341839551925659
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0516831  Vali Loss: 0.0755451 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9765174  Vali macro F1 0.9654726 
new best score!!!!
Validation loss decreased (0.080843 --> 0.075545).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.343335866928101
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0438056  Vali Loss: 0.0884848 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9755946  Vali macro F1 0.9626786 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.343293190002441
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0407063  Vali Loss: 0.0978632 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9739173  Vali macro F1 0.9611144 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.341739177703857
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0438168  Vali Loss: 0.0789759 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9723653  Vali macro F1 0.9586837 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.333187103271484
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0391362  Vali Loss: 0.0794157 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9780043  Vali macro F1 0.9684341 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.327783823013306
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0412371  Vali Loss: 0.0742116 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806144  Vali macro F1 0.9695158 
new best score!!!!
Validation loss decreased (0.075545 --> 0.074212).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.34578013420105
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0303140  Vali Loss: 0.0894177 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9749341  Vali macro F1 0.9630554 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.366072177886963
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0295834  Vali Loss: 0.0877516 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9745416  Vali macro F1 0.9617674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.339798927307129
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0338916  Vali Loss: 0.0703081 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825443  Vali macro F1 0.9744397 
new best score!!!!
Validation loss decreased (0.074212 --> 0.070308).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.330016851425171
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0347934  Vali Loss: 0.0739980 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9775411  Vali macro F1 0.9676578 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.327587127685547
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0340487  Vali Loss: 0.0986459 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9691046  Vali macro F1 0.9523948 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.327432155609131
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0357515  Vali Loss: 0.0755977 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9775852  Vali macro F1 0.9660201 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.331728458404541
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0216961  Vali Loss: 0.0701793 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811048  Vali macro F1 0.9721980 
new best score!!!!
Validation loss decreased (0.070308 --> 0.070179).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.3311450481414795
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0257879  Vali Loss: 0.0841373 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9778459  Vali macro F1 0.9680423 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.359996795654297
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0255350  Vali Loss: 0.0874340 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9766410  Vali macro F1 0.9649316 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.352270126342773
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0282489  Vali Loss: 0.0725056 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806271  Vali macro F1 0.9710948 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.336558818817139
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0220725  Vali Loss: 0.0767823 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836374  Vali macro F1 0.9748007 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.340203046798706
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0214185  Vali Loss: 0.0864424 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9773598  Vali macro F1 0.9689350 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 45 cost time: 6.333067893981934
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0136143  Vali Loss: 0.0739765 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810639  Vali macro F1 0.9714970 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.334110736846924
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0106530  Vali Loss: 0.0736505 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805763  Vali macro F1 0.9710128 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.338466167449951
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0110842  Vali Loss: 0.0719418 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816105  Vali macro F1 0.9727026 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.342251300811768
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0101589  Vali Loss: 0.0716080 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820936  Vali macro F1 0.9732309 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.360578775405884
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0099310  Vali Loss: 0.0730714 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811141  Vali macro F1 0.9718640 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.349146604537964
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0093139  Vali Loss: 0.0735931 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816079  Vali macro F1 0.9727049 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.33010458946228
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0092915  Vali Loss: 0.0735362 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811113  Vali macro F1 0.9718662 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.335572004318237
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0091345  Vali Loss: 0.0731060 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815920  Vali macro F1 0.9723902 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.3393309116363525
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0090232  Vali Loss: 0.0727308 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810983  Vali macro F1 0.9715495 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.346147298812866
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0095100  Vali Loss: 0.0726830 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810983  Vali macro F1 0.9715495 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9358235  Test weighted F1: 0.9335481  Test macro F1 0.8762191 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3565404415130615
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0168760  Vali Loss: 0.0710363 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816402  Vali macro F1 0.9718430 
Validation loss decreased (inf --> 0.071036).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.343409776687622
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0153459  Vali Loss: 0.0713268 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831146  Vali macro F1 0.9743347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.363999843597412
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0149582  Vali Loss: 0.0714514 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821345  Vali macro F1 0.9735599 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.384192943572998
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0138890  Vali Loss: 0.0740070 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821235  Vali macro F1 0.9732462 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.417069673538208
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0130228  Vali Loss: 0.0693488 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841204  Vali macro F1 0.9766485 
new best score!!!!
Validation loss decreased (0.071036 --> 0.069349).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.405203819274902
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0136778  Vali Loss: 0.0702869 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831163  Vali macro F1 0.9743313 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.4134461879730225
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0127104  Vali Loss: 0.0674864 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835863  Vali macro F1 0.9751297 
new best score!!!!
Validation loss decreased (0.069349 --> 0.067486).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.4084930419921875
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0124004  Vali Loss: 0.0755476 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816102  Vali macro F1 0.9727231 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.412909030914307
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0115391  Vali Loss: 0.0777447 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811089  Vali macro F1 0.9724666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.3956685066223145
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0110542  Vali Loss: 0.0726367 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831218  Vali macro F1 0.9746869 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.430069923400879
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0116615  Vali Loss: 0.0782709 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800899  Vali macro F1 0.9703794 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.402953624725342
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0120774  Vali Loss: 0.0782627 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806484  Vali macro F1 0.9710936 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.39622950553894
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0109681  Vali Loss: 0.0812616 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9796406  Vali macro F1 0.9697119 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.396312475204468
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0110986  Vali Loss: 0.0696053 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816203  Vali macro F1 0.9730207 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.393175840377808
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0103645  Vali Loss: 0.0795360 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9796677  Vali macro F1 0.9694134 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.384742021560669
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0096387  Vali Loss: 0.0795198 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826491  Vali macro F1 0.9744779 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.379231214523315
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0098103  Vali Loss: 0.0802901 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816478  Vali macro F1 0.9730782 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.4062721729278564
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0086571  Vali Loss: 0.0792847 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806601  Vali macro F1 0.9714094 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.39916205406189
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0090756  Vali Loss: 0.0778528 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811414  Vali macro F1 0.9719335 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.379557132720947
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0089828  Vali Loss: 0.0782384 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806279  Vali macro F1 0.9713828 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.376711845397949
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0083872  Vali Loss: 0.0774900 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816171  Vali macro F1 0.9730606 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.390756368637085
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0092490  Vali Loss: 0.0766409 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806279  Vali macro F1 0.9713828 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9328309  Test weighted F1: 0.9302380  Test macro F1 0.8721199 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 138143
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014618 0.00018175 0.00097182 0.00121655 0.00048263 0.00061162]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.293764591217041
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1017419  Vali Loss: 0.6634817 Vali Accuracy: 0.7637004  Vali weighted F1: 0.7015957  Vali macro F1 0.4837523 
Validation loss decreased (inf --> 0.663482).  Saving model ...
Epoch: 2 cost time: 6.2953643798828125
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5250115  Vali Loss: 0.4265001 Vali Accuracy: 0.8531926  Vali weighted F1: 0.8404678  Vali macro F1 0.7964060 
new best score!!!!
Validation loss decreased (0.663482 --> 0.426500).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.335925579071045
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3899968  Vali Loss: 0.3199102 Vali Accuracy: 0.8903972  Vali weighted F1: 0.8837585  Vali macro F1 0.8508773 
new best score!!!!
Validation loss decreased (0.426500 --> 0.319910).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.304686784744263
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2844531  Vali Loss: 0.2337961 Vali Accuracy: 0.9170437  Vali weighted F1: 0.9154327  Vali macro F1 0.8876970 
new best score!!!!
Validation loss decreased (0.319910 --> 0.233796).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.307703256607056
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2151396  Vali Loss: 0.2131751 Vali Accuracy: 0.9301156  Vali weighted F1: 0.9273837  Vali macro F1 0.9075496 
new best score!!!!
Validation loss decreased (0.233796 --> 0.213175).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.302619934082031
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1768472  Vali Loss: 0.1434164 Vali Accuracy: 0.9517345  Vali weighted F1: 0.9513896  Vali macro F1 0.9342554 
new best score!!!!
Validation loss decreased (0.213175 --> 0.143416).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.295950651168823
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1631654  Vali Loss: 0.1338391 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9582585  Vali macro F1 0.9480073 
new best score!!!!
Validation loss decreased (0.143416 --> 0.133839).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.298621654510498
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1462751  Vali Loss: 0.1293041 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9611793  Vali macro F1 0.9487574 
new best score!!!!
Validation loss decreased (0.133839 --> 0.129304).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.298182725906372
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1329855  Vali Loss: 0.1080635 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9674239  Vali macro F1 0.9590084 
new best score!!!!
Validation loss decreased (0.129304 --> 0.108063).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.297343015670776
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1135946  Vali Loss: 0.0977154 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9658455  Vali macro F1 0.9517709 
new best score!!!!
Validation loss decreased (0.108063 --> 0.097715).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.3139848709106445
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1084796  Vali Loss: 0.1080893 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9667018  Vali macro F1 0.9555854 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.299972772598267
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1021429  Vali Loss: 0.0834890 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9739374  Vali macro F1 0.9653051 
new best score!!!!
Validation loss decreased (0.097715 --> 0.083489).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.319705247879028
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0948938  Vali Loss: 0.0883932 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9733317  Vali macro F1 0.9661250 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.306228399276733
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0875872  Vali Loss: 0.0999715 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9682030  Vali macro F1 0.9597126 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.293196678161621
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0814480  Vali Loss: 0.0857112 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9744984  Vali macro F1 0.9669436 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 6.2894017696380615
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0779209  Vali Loss: 0.0716768 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789920  Vali macro F1 0.9729596 
new best score!!!!
Validation loss decreased (0.083489 --> 0.071677).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.308946847915649
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0755321  Vali Loss: 0.0709053 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9783948  Vali macro F1 0.9720878 
new best score!!!!
Validation loss decreased (0.071677 --> 0.070905).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.299372673034668
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0675812  Vali Loss: 0.0694236 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9788800  Vali macro F1 0.9725697 
new best score!!!!
Validation loss decreased (0.070905 --> 0.069424).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.31072473526001
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0644153  Vali Loss: 0.0628237 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789714  Vali macro F1 0.9719936 
new best score!!!!
Validation loss decreased (0.069424 --> 0.062824).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.346155166625977
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0662563  Vali Loss: 0.0656181 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9795368  Vali macro F1 0.9733192 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.3037495613098145
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0575608  Vali Loss: 0.0642121 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9776373  Vali macro F1 0.9700524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.294037818908691
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0520042  Vali Loss: 0.0649030 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9767685  Vali macro F1 0.9681396 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.305864095687866
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0627506  Vali Loss: 0.0637543 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808026  Vali macro F1 0.9743133 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.293803930282593
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0481618  Vali Loss: 0.0570558 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9815731  Vali macro F1 0.9752681 
new best score!!!!
Validation loss decreased (0.062824 --> 0.057056).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.307915210723877
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0446673  Vali Loss: 0.0528369 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809451  Vali macro F1 0.9737040 
new best score!!!!
Validation loss decreased (0.057056 --> 0.052837).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.309867858886719
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0445172  Vali Loss: 0.0662842 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9731688  Vali macro F1 0.9626921 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.340463876724243
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0414028  Vali Loss: 0.0644301 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9806650  Vali macro F1 0.9727400 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.320059537887573
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0405767  Vali Loss: 0.0634942 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9791548  Vali macro F1 0.9709298 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.331857442855835
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0429509  Vali Loss: 0.0476362 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9830232  Vali macro F1 0.9769163 
new best score!!!!
Validation loss decreased (0.052837 --> 0.047636).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.3227269649505615
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0326449  Vali Loss: 0.0491522 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9835124  Vali macro F1 0.9770100 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.31540846824646
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0364638  Vali Loss: 0.0486353 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9825115  Vali macro F1 0.9752002 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.3177330493927
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0320438  Vali Loss: 0.0421188 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9840300  Vali macro F1 0.9779863 
new best score!!!!
Validation loss decreased (0.047636 --> 0.042119).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.324842214584351
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0384956  Vali Loss: 0.0410109 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874983  Vali macro F1 0.9824541 
new best score!!!!
Validation loss decreased (0.042119 --> 0.041011).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.324873685836792
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0257998  Vali Loss: 0.0530906 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9835569  Vali macro F1 0.9791824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.324551105499268
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0310690  Vali Loss: 0.0611818 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9786735  Vali macro F1 0.9703379 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.321542978286743
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0316017  Vali Loss: 0.0520200 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9840648  Vali macro F1 0.9787193 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.334059715270996
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0289634  Vali Loss: 0.0558698 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824853  Vali macro F1 0.9768785 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.313886404037476
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0298135  Vali Loss: 0.0469220 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849714  Vali macro F1 0.9772138 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 6.322758436203003
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0175800  Vali Loss: 0.0352317 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894547  Vali macro F1 0.9843653 
new best score!!!!
Validation loss decreased (0.041011 --> 0.035232).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.318018674850464
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0156527  Vali Loss: 0.0362685 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879913  Vali macro F1 0.9826688 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.319617986679077
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0135001  Vali Loss: 0.0330380 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899676  Vali macro F1 0.9851573 
new best score!!!!
Validation loss decreased (0.035232 --> 0.033038).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.323214769363403
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0136585  Vali Loss: 0.0348512 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904625  Vali macro F1 0.9856403 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.314722537994385
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0130734  Vali Loss: 0.0349835 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889791  Vali macro F1 0.9839116 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.3519508838653564
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0125733  Vali Loss: 0.0358459 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894745  Vali macro F1 0.9847499 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.313368558883667
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0128980  Vali Loss: 0.0359533 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.313340902328491
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0120769  Vali Loss: 0.0359284 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.31364107131958
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0114611  Vali Loss: 0.0355672 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894736  Vali macro F1 0.9847710 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.323448419570923
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0102126  Vali Loss: 0.0357480 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.313779830932617
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0118899  Vali Loss: 0.0355559 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889692  Vali macro F1 0.9845290 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.320539236068726
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0120547  Vali Loss: 0.0360973 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.328284740447998
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0104044  Vali Loss: 0.0362351 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 6.3387956619262695
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0109854  Vali Loss: 0.0361983 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.3168418407440186
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0110691  Vali Loss: 0.0361345 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.315465927124023
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0116443  Vali Loss: 0.0361536 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.315698623657227
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0108322  Vali Loss: 0.0361620 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.31852650642395
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0117290  Vali Loss: 0.0361438 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889837  Vali macro F1 0.9842933 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8110988  Test weighted F1: 0.8271307  Test macro F1 0.7388601 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3309948444366455
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0161528  Vali Loss: 0.0335896 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899599  Vali macro F1 0.9857757 
Validation loss decreased (inf --> 0.033590).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.309897184371948
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0135621  Vali Loss: 0.0336085 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894650  Vali macro F1 0.9855905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.316802740097046
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0127460  Vali Loss: 0.0344507 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904582  Vali macro F1 0.9865634 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.2970733642578125
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0131990  Vali Loss: 0.0344029 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894605  Vali macro F1 0.9850077 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.313912391662598
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0110512  Vali Loss: 0.0336989 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904582  Vali macro F1 0.9865634 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.295106887817383
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0111451  Vali Loss: 0.0344722 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899581  Vali macro F1 0.9860330 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.300279855728149
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0120659  Vali Loss: 0.0384985 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899560  Vali macro F1 0.9855327 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.318289518356323
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0102202  Vali Loss: 0.0387367 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894911  Vali macro F1 0.9850371 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.3217902183532715
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0103555  Vali Loss: 0.0380063 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889898  Vali macro F1 0.9846009 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.322506427764893
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0109219  Vali Loss: 0.0388829 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889928  Vali macro F1 0.9846370 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.346895933151245
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0093786  Vali Loss: 0.0380011 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894776  Vali macro F1 0.9850778 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.3105149269104
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0085124  Vali Loss: 0.0383018 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889861  Vali macro F1 0.9846210 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.3100855350494385
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0088203  Vali Loss: 0.0385790 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889861  Vali macro F1 0.9846210 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.310975074768066
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0090057  Vali Loss: 0.0381264 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894789  Vali macro F1 0.9850998 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.320583343505859
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0090617  Vali Loss: 0.0389256 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889890  Vali macro F1 0.9846221 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.321878433227539
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0081410  Vali Loss: 0.0388226 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894789  Vali macro F1 0.9850998 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8335176  Test weighted F1: 0.8423977  Test macro F1 0.7503267 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00015017 0.00018275 0.0010846  0.0013947  0.00050201 0.00062854]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.1060216426849365
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.1311573  Vali Loss: 0.6866706 Vali Accuracy: 0.7169518  Vali weighted F1: 0.6434170  Vali macro F1 0.3615756 
Validation loss decreased (inf --> 0.686671).  Saving model ...
Epoch: 2 cost time: 6.099022388458252
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5560095  Vali Loss: 0.4388162 Vali Accuracy: 0.8387766  Vali weighted F1: 0.8192505  Vali macro F1 0.7684627 
new best score!!!!
Validation loss decreased (0.686671 --> 0.438816).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.117741107940674
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.3708516  Vali Loss: 0.3049401 Vali Accuracy: 0.8932089  Vali weighted F1: 0.8878154  Vali macro F1 0.8537716 
new best score!!!!
Validation loss decreased (0.438816 --> 0.304940).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.109533786773682
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.2716555  Vali Loss: 0.2210457 Vali Accuracy: 0.9206843  Vali weighted F1: 0.9187308  Vali macro F1 0.8848167 
new best score!!!!
Validation loss decreased (0.304940 --> 0.221046).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.110159158706665
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2169394  Vali Loss: 0.1896378 Vali Accuracy: 0.9279419  Vali weighted F1: 0.9262787  Vali macro F1 0.8954547 
new best score!!!!
Validation loss decreased (0.221046 --> 0.189638).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.121852874755859
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.1916686  Vali Loss: 0.1658902 Vali Accuracy: 0.9424572  Vali weighted F1: 0.9425320  Vali macro F1 0.9160445 
new best score!!!!
Validation loss decreased (0.189638 --> 0.165890).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.1015307903289795
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1725499  Vali Loss: 0.1409125 Vali Accuracy: 0.9476413  Vali weighted F1: 0.9480240  Vali macro F1 0.9266074 
new best score!!!!
Validation loss decreased (0.165890 --> 0.140912).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.112403631210327
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1495171  Vali Loss: 0.1523418 Vali Accuracy: 0.9460861  Vali weighted F1: 0.9446753  Vali macro F1 0.9286575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.108468055725098
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1326858  Vali Loss: 0.1175818 Vali Accuracy: 0.9590461  Vali weighted F1: 0.9590310  Vali macro F1 0.9501128 
new best score!!!!
Validation loss decreased (0.140912 --> 0.117582).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.129072427749634
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1207317  Vali Loss: 0.1279031 Vali Accuracy: 0.9543805  Vali weighted F1: 0.9535686  Vali macro F1 0.9406370 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.13855504989624
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1079196  Vali Loss: 0.1070482 Vali Accuracy: 0.9626750  Vali weighted F1: 0.9625672  Vali macro F1 0.9489254 
new best score!!!!
Validation loss decreased (0.117582 --> 0.107048).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.1134867668151855
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1109246  Vali Loss: 0.1165965 Vali Accuracy: 0.9564541  Vali weighted F1: 0.9559658  Vali macro F1 0.9344884 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.098752975463867
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0985521  Vali Loss: 0.0979065 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9646519  Vali macro F1 0.9540162 
new best score!!!!
Validation loss decreased (0.107048 --> 0.097907).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.109910726547241
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0939991  Vali Loss: 0.0920801 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9694149  Vali macro F1 0.9586662 
new best score!!!!
Validation loss decreased (0.097907 --> 0.092080).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.100306749343872
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0759470  Vali Loss: 0.0903432 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9672614  Vali macro F1 0.9549507 
new best score!!!!
Validation loss decreased (0.092080 --> 0.090343).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.122379302978516
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0725979  Vali Loss: 0.0774686 Vali Accuracy: 0.9709694  Vali weighted F1: 0.9711549  Vali macro F1 0.9630014 
new best score!!!!
Validation loss decreased (0.090343 --> 0.077469).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.1053595542907715
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0778438  Vali Loss: 0.0778374 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9728401  Vali macro F1 0.9625498 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.113661527633667
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0719827  Vali Loss: 0.0788269 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9722203  Vali macro F1 0.9604736 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.117666244506836
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0592857  Vali Loss: 0.0676328 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9764283  Vali macro F1 0.9666269 
new best score!!!!
Validation loss decreased (0.077469 --> 0.067633).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.122220993041992
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0516564  Vali Loss: 0.0678947 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9735349  Vali macro F1 0.9611843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.108194589614868
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0512900  Vali Loss: 0.0603656 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9740868  Vali macro F1 0.9613583 
new best score!!!!
Validation loss decreased (0.067633 --> 0.060366).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.1157066822052
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0548244  Vali Loss: 0.0683232 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9755709  Vali macro F1 0.9645442 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.1099278926849365
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0482459  Vali Loss: 0.0682191 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9752368  Vali macro F1 0.9644548 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.108844518661499
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0407635  Vali Loss: 0.0676360 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9789550  Vali macro F1 0.9706466 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.098199367523193
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0358827  Vali Loss: 0.0540763 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813991  Vali macro F1 0.9746365 
new best score!!!!
Validation loss decreased (0.060366 --> 0.054076).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.104895353317261
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0386418  Vali Loss: 0.0578481 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9784069  Vali macro F1 0.9681910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.119462251663208
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0348443  Vali Loss: 0.0617283 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813369  Vali macro F1 0.9736778 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.124235391616821
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0327545  Vali Loss: 0.0551124 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818708  Vali macro F1 0.9754463 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.10489559173584
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0352134  Vali Loss: 0.0515652 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849331  Vali macro F1 0.9797501 
new best score!!!!
Validation loss decreased (0.054076 --> 0.051565).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.116606950759888
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0267453  Vali Loss: 0.0493258 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829200  Vali macro F1 0.9758735 
new best score!!!!
Validation loss decreased (0.051565 --> 0.049326).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.110943794250488
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0250579  Vali Loss: 0.0489529 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834400  Vali macro F1 0.9763470 
new best score!!!!
Validation loss decreased (0.049326 --> 0.048953).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.10778021812439
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0283724  Vali Loss: 0.0494488 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839330  Vali macro F1 0.9775002 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.0891406536102295
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0250175  Vali Loss: 0.0526785 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9809571  Vali macro F1 0.9689522 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.100218772888184
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0256963  Vali Loss: 0.0470932 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844806  Vali macro F1 0.9784272 
new best score!!!!
Validation loss decreased (0.048953 --> 0.047093).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.101548910140991
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0236703  Vali Loss: 0.0453513 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839729  Vali macro F1 0.9785501 
new best score!!!!
Validation loss decreased (0.047093 --> 0.045351).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.122763395309448
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0256986  Vali Loss: 0.0623179 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9811425  Vali macro F1 0.9748360 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.10873818397522
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0211019  Vali Loss: 0.0706402 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9791221  Vali macro F1 0.9692086 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.102407693862915
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0223120  Vali Loss: 0.0518784 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9840262  Vali macro F1 0.9762882 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.104517698287964
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0193471  Vali Loss: 0.0599802 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9825580  Vali macro F1 0.9763363 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.096169471740723
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0169846  Vali Loss: 0.0529990 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844390  Vali macro F1 0.9780969 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 6.103084087371826
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0132664  Vali Loss: 0.0415093 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860496  Vali macro F1 0.9792202 
new best score!!!!
Validation loss decreased (0.045351 --> 0.041509).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.094850063323975
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0102140  Vali Loss: 0.0416539 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865717  Vali macro F1 0.9805087 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.103205442428589
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0081974  Vali Loss: 0.0433015 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865548  Vali macro F1 0.9801571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.124136209487915
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0086380  Vali Loss: 0.0411261 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865727  Vali macro F1 0.9810747 
new best score!!!!
Validation loss decreased (0.041509 --> 0.041126).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.1333324909210205
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0073705  Vali Loss: 0.0429129 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860505  Vali macro F1 0.9797861 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.100902557373047
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0070861  Vali Loss: 0.0398669 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876019  Vali macro F1 0.9828921 
new best score!!!!
Validation loss decreased (0.041126 --> 0.039867).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.110659837722778
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0071717  Vali Loss: 0.0394322 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870652  Vali macro F1 0.9817263 
new best score!!!!
Validation loss decreased (0.039867 --> 0.039432).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.093021392822266
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0074579  Vali Loss: 0.0388054 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876019  Vali macro F1 0.9828921 
new best score!!!!
Validation loss decreased (0.039432 --> 0.038805).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.102622985839844
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0073994  Vali Loss: 0.0403050 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865592  Vali macro F1 0.9813477 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.109866142272949
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0066961  Vali Loss: 0.0402139 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881039  Vali macro F1 0.9823707 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.1130876541137695
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0066038  Vali Loss: 0.0394145 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886348  Vali macro F1 0.9832067 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.107969760894775
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0073513  Vali Loss: 0.0394941 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881109  Vali macro F1 0.9826800 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.137678146362305
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0062638  Vali Loss: 0.0393078 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881442  Vali macro F1 0.9834524 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 6.105504512786865
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0063770  Vali Loss: 0.0399147 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881442  Vali macro F1 0.9834524 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.11310338973999
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0065520  Vali Loss: 0.0404634 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9871018  Vali macro F1 0.9819097 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.103411436080933
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0064759  Vali Loss: 0.0401533 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881442  Vali macro F1 0.9834524 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.105703830718994
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0059391  Vali Loss: 0.0401730 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876223  Vali macro F1 0.9821599 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.104841470718384
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0062393  Vali Loss: 0.0396385 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876204  Vali macro F1 0.9829257 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 59 cost time: 6.104077339172363
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0063946  Vali Loss: 0.0396938 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876204  Vali macro F1 0.9829257 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.100820302963257
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0058557  Vali Loss: 0.0397827 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881442  Vali macro F1 0.9834524 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 6.121573209762573
VALI: Epoch: 61, Steps: 68 | Train Loss: 0.0058627  Vali Loss: 0.0398434 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876204  Vali macro F1 0.9829257 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 6.114832878112793
VALI: Epoch: 62, Steps: 68 | Train Loss: 0.0061201  Vali Loss: 0.0398366 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876204  Vali macro F1 0.9829257 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 6.08247971534729
VALI: Epoch: 63, Steps: 68 | Train Loss: 0.0066516  Vali Loss: 0.0400144 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876204  Vali macro F1 0.9829257 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9417154  Test weighted F1: 0.9422190  Test macro F1 0.8955373 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.134281158447266
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0084688  Vali Loss: 0.0413577 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870585  Vali macro F1 0.9806238 
Validation loss decreased (inf --> 0.041358).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.086898326873779
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0076479  Vali Loss: 0.0386077 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876017  Vali macro F1 0.9812067 
new best score!!!!
Validation loss decreased (0.041358 --> 0.038608).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.088395833969116
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0069513  Vali Loss: 0.0423378 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860451  Vali macro F1 0.9791265 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.081475496292114
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0078069  Vali Loss: 0.0408688 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865714  Vali macro F1 0.9801336 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.1026341915130615
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0067240  Vali Loss: 0.0363437 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896772  Vali macro F1 0.9853426 
new best score!!!!
Validation loss decreased (0.038608 --> 0.036344).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.136070728302002
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0059846  Vali Loss: 0.0449791 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9850162  Vali macro F1 0.9786487 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.149883031845093
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0062879  Vali Loss: 0.0480728 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865487  Vali macro F1 0.9813259 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.109271049499512
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0069707  Vali Loss: 0.0442500 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865778  Vali macro F1 0.9813807 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.106870174407959
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0062577  Vali Loss: 0.0410423 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860351  Vali macro F1 0.9783814 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.105192184448242
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0052772  Vali Loss: 0.0434464 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860390  Vali macro F1 0.9797106 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.104039907455444
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0051125  Vali Loss: 0.0430009 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865793  Vali macro F1 0.9796749 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.100726366043091
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0053203  Vali Loss: 0.0450307 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855200  Vali macro F1 0.9790178 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.106980562210083
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0051053  Vali Loss: 0.0438533 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865597  Vali macro F1 0.9801039 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.105966329574585
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0054507  Vali Loss: 0.0484819 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860088  Vali macro F1 0.9790670 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.126333713531494
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0059622  Vali Loss: 0.0410369 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875941  Vali macro F1 0.9807536 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.129810333251953
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0052146  Vali Loss: 0.0415403 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875984  Vali macro F1 0.9810308 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.117959499359131
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0045699  Vali Loss: 0.0420248 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870748  Vali macro F1 0.9805041 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.112695932388306
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0048773  Vali Loss: 0.0424503 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870748  Vali macro F1 0.9805041 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.111116886138916
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0049260  Vali Loss: 0.0425879 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875984  Vali macro F1 0.9810308 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.100858688354492
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0041328  Vali Loss: 0.0426355 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870748  Vali macro F1 0.9805041 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9441792  Test weighted F1: 0.9447478  Test macro F1 0.8984626 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014843 0.00018235 0.00095238 0.00126904 0.00049925 0.00061652]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.220723867416382
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0841679  Vali Loss: 0.8280126 Vali Accuracy: 0.6875318  Vali weighted F1: 0.6447522  Vali macro F1 0.4502492 
Validation loss decreased (inf --> 0.828013).  Saving model ...
Epoch: 2 cost time: 6.20161247253418
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5274144  Vali Loss: 0.4053258 Vali Accuracy: 0.8580153  Vali weighted F1: 0.8433832  Vali macro F1 0.8023139 
new best score!!!!
Validation loss decreased (0.828013 --> 0.405326).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.207552433013916
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3649071  Vali Loss: 0.2884196 Vali Accuracy: 0.8961832  Vali weighted F1: 0.8941918  Vali macro F1 0.8658508 
new best score!!!!
Validation loss decreased (0.405326 --> 0.288420).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.219834566116333
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2536976  Vali Loss: 0.2645017 Vali Accuracy: 0.9099237  Vali weighted F1: 0.9133724  Vali macro F1 0.8896740 
new best score!!!!
Validation loss decreased (0.288420 --> 0.264502).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.239023923873901
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2090216  Vali Loss: 0.2336648 Vali Accuracy: 0.9231552  Vali weighted F1: 0.9216321  Vali macro F1 0.8923658 
new best score!!!!
Validation loss decreased (0.264502 --> 0.233665).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.221845865249634
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1857688  Vali Loss: 0.1351916 Vali Accuracy: 0.9567430  Vali weighted F1: 0.9566486  Vali macro F1 0.9407139 
new best score!!!!
Validation loss decreased (0.233665 --> 0.135192).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.224348068237305
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1539617  Vali Loss: 0.1213292 Vali Accuracy: 0.9592875  Vali weighted F1: 0.9589393  Vali macro F1 0.9471270 
new best score!!!!
Validation loss decreased (0.135192 --> 0.121329).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.212551116943359
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1445164  Vali Loss: 0.1297867 Vali Accuracy: 0.9541985  Vali weighted F1: 0.9531422  Vali macro F1 0.9433921 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.211469650268555
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1438106  Vali Loss: 0.1071148 Vali Accuracy: 0.9643766  Vali weighted F1: 0.9641590  Vali macro F1 0.9566851 
new best score!!!!
Validation loss decreased (0.121329 --> 0.107115).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.209365129470825
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1188663  Vali Loss: 0.0980890 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9694046  Vali macro F1 0.9627988 
new best score!!!!
Validation loss decreased (0.107115 --> 0.098089).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.212554454803467
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1105525  Vali Loss: 0.2261448 Vali Accuracy: 0.9145038  Vali weighted F1: 0.9181760  Vali macro F1 0.9083119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.2187340259552
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1307513  Vali Loss: 0.1040325 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9713631  Vali macro F1 0.9644916 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.2402753829956055
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1069054  Vali Loss: 0.0877667 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9718349  Vali macro F1 0.9660820 
new best score!!!!
Validation loss decreased (0.098089 --> 0.087767).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.228009223937988
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0967544  Vali Loss: 0.0842601 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9735401  Vali macro F1 0.9677627 
new best score!!!!
Validation loss decreased (0.087767 --> 0.084260).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.203489780426025
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0836169  Vali Loss: 0.0807938 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9752057  Vali macro F1 0.9697731 
new best score!!!!
Validation loss decreased (0.084260 --> 0.080794).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.209323167800903
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0808111  Vali Loss: 0.0746498 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9754590  Vali macro F1 0.9706652 
new best score!!!!
Validation loss decreased (0.080794 --> 0.074650).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.204834222793579
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0744620  Vali Loss: 0.0759949 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9752137  Vali macro F1 0.9697500 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.200053930282593
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0696302  Vali Loss: 0.0794192 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9767583  Vali macro F1 0.9713222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.20719313621521
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0669701  Vali Loss: 0.0686766 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9772408  Vali macro F1 0.9699473 
new best score!!!!
Validation loss decreased (0.074650 --> 0.068677).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.205177545547485
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0634781  Vali Loss: 0.0728462 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9787664  Vali macro F1 0.9733160 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.215202569961548
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0634435  Vali Loss: 0.0724485 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9767851  Vali macro F1 0.9713777 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.196625471115112
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0608108  Vali Loss: 0.0614759 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9796079  Vali macro F1 0.9746777 
new best score!!!!
Validation loss decreased (0.068677 --> 0.061476).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.2078869342803955
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0475896  Vali Loss: 0.0594046 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9812483  Vali macro F1 0.9777504 
new best score!!!!
Validation loss decreased (0.061476 --> 0.059405).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.19780707359314
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0550350  Vali Loss: 0.0760675 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9769893  Vali macro F1 0.9663991 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.194728851318359
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0474631  Vali Loss: 0.0551374 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842501  Vali macro F1 0.9816570 
new best score!!!!
Validation loss decreased (0.059405 --> 0.055137).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.202908277511597
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0458959  Vali Loss: 0.0668083 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9792022  Vali macro F1 0.9736221 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.1976637840271
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0451695  Vali Loss: 0.0538475 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9841528  Vali macro F1 0.9811899 
new best score!!!!
Validation loss decreased (0.055137 --> 0.053848).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.204408407211304
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0418792  Vali Loss: 0.0570954 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9827352  Vali macro F1 0.9794757 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.208053112030029
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0439936  Vali Loss: 0.0656358 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818017  Vali macro F1 0.9779038 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.227218389511108
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0338099  Vali Loss: 0.0613093 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9801094  Vali macro F1 0.9752776 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.22838282585144
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0329154  Vali Loss: 0.0634830 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837735  Vali macro F1 0.9807576 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.209233999252319
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0318436  Vali Loss: 0.0657162 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836235  Vali macro F1 0.9815114 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 6.209033489227295
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0237064  Vali Loss: 0.0497019 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868156  Vali macro F1 0.9846316 
new best score!!!!
Validation loss decreased (0.053848 --> 0.049702).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.209439992904663
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0196858  Vali Loss: 0.0478985 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873198  Vali macro F1 0.9854452 
new best score!!!!
Validation loss decreased (0.049702 --> 0.047899).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.212249040603638
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0196608  Vali Loss: 0.0482432 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868200  Vali macro F1 0.9849550 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.209250450134277
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0192224  Vali Loss: 0.0482403 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863208  Vali macro F1 0.9844000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.210095643997192
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0171477  Vali Loss: 0.0485747 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873155  Vali macro F1 0.9850848 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.226516485214233
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0172229  Vali Loss: 0.0487140 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878156  Vali macro F1 0.9861557 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.220319986343384
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0162918  Vali Loss: 0.0471991 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873001  Vali macro F1 0.9856676 
new best score!!!!
Validation loss decreased (0.047899 --> 0.047199).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.2330405712127686
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0164865  Vali Loss: 0.0470780 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878202  Vali macro F1 0.9859993 
new best score!!!!
Validation loss decreased (0.047199 --> 0.047078).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.217432975769043
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0165853  Vali Loss: 0.0463810 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867897  Vali macro F1 0.9849039 
new best score!!!!
Validation loss decreased (0.047078 --> 0.046381).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.213258504867554
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0152588  Vali Loss: 0.0453366 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888354  Vali macro F1 0.9875564 
new best score!!!!
Validation loss decreased (0.046381 --> 0.045337).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.207552909851074
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0155636  Vali Loss: 0.0461348 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867831  Vali macro F1 0.9851499 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.208981275558472
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0160663  Vali Loss: 0.0476181 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868156  Vali macro F1 0.9846316 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.204267978668213
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0165419  Vali Loss: 0.0444695 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878336  Vali macro F1 0.9860232 
new best score!!!!
Validation loss decreased (0.045337 --> 0.044469).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.213578224182129
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0153385  Vali Loss: 0.0442430 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888531  Vali macro F1 0.9873298 
new best score!!!!
Validation loss decreased (0.044469 --> 0.044243).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.219923257827759
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0145403  Vali Loss: 0.0460224 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883233  Vali macro F1 0.9869811 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.21225118637085
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0136533  Vali Loss: 0.0471838 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888255  Vali macro F1 0.9878900 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.231149673461914
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0146354  Vali Loss: 0.0479672 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883176  Vali macro F1 0.9867486 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.209315061569214
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0154535  Vali Loss: 0.0492895 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873077  Vali macro F1 0.9854298 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.211008310317993
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0138638  Vali Loss: 0.0493075 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883498  Vali macro F1 0.9865176 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 6.206388711929321
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0133678  Vali Loss: 0.0477909 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883378  Vali macro F1 0.9868430 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.208215951919556
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0129604  Vali Loss: 0.0470300 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878217  Vali macro F1 0.9863546 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.221721649169922
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0131373  Vali Loss: 0.0470013 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883253  Vali macro F1 0.9868206 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.218832731246948
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0128799  Vali Loss: 0.0466847 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883378  Vali macro F1 0.9868430 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.229868412017822
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0123206  Vali Loss: 0.0471433 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883378  Vali macro F1 0.9868430 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 57 cost time: 6.204790353775024
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0136047  Vali Loss: 0.0471326 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878217  Vali macro F1 0.9863546 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.220243692398071
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0132836  Vali Loss: 0.0471476 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878217  Vali macro F1 0.9863546 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.208124399185181
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0132292  Vali Loss: 0.0471802 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878217  Vali macro F1 0.9863546 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.196516752243042
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0134410  Vali Loss: 0.0471678 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878217  Vali macro F1 0.9863546 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.209582090377808
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0127125  Vali Loss: 0.0471609 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883378  Vali macro F1 0.9868430 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8362919  Test weighted F1: 0.8434103  Test macro F1 0.8380600 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.218480110168457
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0164493  Vali Loss: 0.0505828 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863302  Vali macro F1 0.9841597 
Validation loss decreased (inf --> 0.050583).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.20482873916626
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0146247  Vali Loss: 0.0476197 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878095  Vali macro F1 0.9865017 
new best score!!!!
Validation loss decreased (0.050583 --> 0.047620).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.230258941650391
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0142515  Vali Loss: 0.0491742 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878091  Vali macro F1 0.9864738 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.532831907272339
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0137485  Vali Loss: 0.0525876 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877872  Vali macro F1 0.9859597 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.225743293762207
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0135427  Vali Loss: 0.0501972 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872802  Vali macro F1 0.9857082 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.238482713699341
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0146679  Vali Loss: 0.0512002 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888232  Vali macro F1 0.9875643 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.223598003387451
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0129580  Vali Loss: 0.0510950 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888531  Vali macro F1 0.9873298 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.220568418502808
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0145232  Vali Loss: 0.0474034 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862699  Vali macro F1 0.9845980 
new best score!!!!
Validation loss decreased (0.047620 --> 0.047403).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.529746770858765
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0136092  Vali Loss: 0.0481223 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867921  Vali macro F1 0.9848412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.3659751415252686
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0134537  Vali Loss: 0.0520757 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878174  Vali macro F1 0.9856640 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.19057559967041
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0127474  Vali Loss: 0.0483477 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878334  Vali macro F1 0.9860291 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.196731805801392
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0118106  Vali Loss: 0.0477945 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893546  Vali macro F1 0.9877388 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.223751783370972
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0119052  Vali Loss: 0.0478380 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878369  Vali macro F1 0.9863512 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.202491283416748
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0111588  Vali Loss: 0.0483464 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.1880762577056885
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0107671  Vali Loss: 0.0483215 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.181626796722412
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0113724  Vali Loss: 0.0477652 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.190807104110718
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0113574  Vali Loss: 0.0475838 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.20959210395813
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0094927  Vali Loss: 0.0485907 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 19 cost time: 6.19519305229187
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0098563  Vali Loss: 0.0484764 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.183840990066528
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0107418  Vali Loss: 0.0484450 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.200902938842773
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0108831  Vali Loss: 0.0484390 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.20355486869812
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0099915  Vali Loss: 0.0484419 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.200417518615723
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0108192  Vali Loss: 0.0484947 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893414  Vali macro F1 0.9883784 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8474090  Test weighted F1: 0.8548133  Test macro F1 0.8422001 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014899 0.00018302 0.000998   0.00125313 0.00052329 0.00063052]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.154316186904907
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.1305285  Vali Loss: 0.6919042 Vali Accuracy: 0.7523172  Vali weighted F1: 0.6852424  Vali macro F1 0.4769010 
Validation loss decreased (inf --> 0.691904).  Saving model ...
Epoch: 2 cost time: 6.153632640838623
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.5259929  Vali Loss: 0.4321606 Vali Accuracy: 0.8357364  Vali weighted F1: 0.8181036  Vali macro F1 0.7752672 
new best score!!!!
Validation loss decreased (0.691904 --> 0.432161).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.14228892326355
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.3881263  Vali Loss: 0.3327976 Vali Accuracy: 0.8805355  Vali weighted F1: 0.8738948  Vali macro F1 0.8413896 
new best score!!!!
Validation loss decreased (0.432161 --> 0.332798).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.1642372608184814
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.2866692  Vali Loss: 0.2203902 Vali Accuracy: 0.9289392  Vali weighted F1: 0.9278123  Vali macro F1 0.9064822 
new best score!!!!
Validation loss decreased (0.332798 --> 0.220390).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.168552875518799
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2262404  Vali Loss: 0.1920940 Vali Accuracy: 0.9361483  Vali weighted F1: 0.9359944  Vali macro F1 0.9115306 
new best score!!!!
Validation loss decreased (0.220390 --> 0.192094).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.152673006057739
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2042229  Vali Loss: 0.1586282 Vali Accuracy: 0.9454171  Vali weighted F1: 0.9456134  Vali macro F1 0.9245907 
new best score!!!!
Validation loss decreased (0.192094 --> 0.158628).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.144335508346558
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1708502  Vali Loss: 0.1644667 Vali Accuracy: 0.9346035  Vali weighted F1: 0.9327300  Vali macro F1 0.9107019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.120306015014648
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1478017  Vali Loss: 0.1359922 Vali Accuracy: 0.9521112  Vali weighted F1: 0.9513842  Vali macro F1 0.9319592 
new best score!!!!
Validation loss decreased (0.158628 --> 0.135992).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.120082378387451
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1418287  Vali Loss: 0.1175095 Vali Accuracy: 0.9572606  Vali weighted F1: 0.9570253  Vali macro F1 0.9449122 
new best score!!!!
Validation loss decreased (0.135992 --> 0.117510).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.122131109237671
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1284593  Vali Loss: 0.1188290 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9632211  Vali macro F1 0.9500931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.109720945358276
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1134455  Vali Loss: 0.1196040 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9635079  Vali macro F1 0.9509389 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.119786977767944
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1085823  Vali Loss: 0.1029518 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9664076  Vali macro F1 0.9525835 
new best score!!!!
Validation loss decreased (0.117510 --> 0.102952).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.127446413040161
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1078310  Vali Loss: 0.1372945 Vali Accuracy: 0.9521112  Vali weighted F1: 0.9503597  Vali macro F1 0.9334215 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.130463600158691
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0955850  Vali Loss: 0.0933384 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9705494  Vali macro F1 0.9589835 
new best score!!!!
Validation loss decreased (0.102952 --> 0.093338).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.1234753131866455
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1055987  Vali Loss: 0.1144433 Vali Accuracy: 0.9598352  Vali weighted F1: 0.9593567  Vali macro F1 0.9465982 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.129189491271973
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0807236  Vali Loss: 0.0926099 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9711820  Vali macro F1 0.9596556 
new best score!!!!
Validation loss decreased (0.093338 --> 0.092610).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.119972229003906
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0775037  Vali Loss: 0.0943690 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9719747  Vali macro F1 0.9654498 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.103604555130005
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0718196  Vali Loss: 0.0828792 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9758301  Vali macro F1 0.9706731 
new best score!!!!
Validation loss decreased (0.092610 --> 0.082879).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.114468812942505
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0699177  Vali Loss: 0.0859924 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753398  Vali macro F1 0.9692402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.105122089385986
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0607912  Vali Loss: 0.0796660 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9778605  Vali macro F1 0.9736162 
new best score!!!!
Validation loss decreased (0.082879 --> 0.079666).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.112895965576172
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0574752  Vali Loss: 0.0708219 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794700  Vali macro F1 0.9755703 
new best score!!!!
Validation loss decreased (0.079666 --> 0.070822).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.167109251022339
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0531551  Vali Loss: 0.0917135 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724749  Vali macro F1 0.9645006 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.1411566734313965
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0525910  Vali Loss: 0.0751474 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9764084  Vali macro F1 0.9720794 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.136383771896362
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0530013  Vali Loss: 0.1142804 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9636807  Vali macro F1 0.9564449 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.116938352584839
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0591986  Vali Loss: 0.0873256 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9716939  Vali macro F1 0.9635207 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.1206114292144775
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0474824  Vali Loss: 0.0771489 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789345  Vali macro F1 0.9749571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 6.112545728683472
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0369649  Vali Loss: 0.0626692 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810028  Vali macro F1 0.9776308 
new best score!!!!
Validation loss decreased (0.070822 --> 0.062669).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.12580418586731
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0298083  Vali Loss: 0.0651115 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794172  Vali macro F1 0.9757485 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.116165399551392
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0310620  Vali Loss: 0.0627649 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815009  Vali macro F1 0.9780911 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.119503021240234
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0294574  Vali Loss: 0.0639958 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805390  Vali macro F1 0.9772218 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.138594150543213
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0275867  Vali Loss: 0.0647026 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804565  Vali macro F1 0.9770833 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.1384265422821045
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0273495  Vali Loss: 0.0661478 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804905  Vali macro F1 0.9771337 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 6.1063714027404785
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0287428  Vali Loss: 0.0659171 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804905  Vali macro F1 0.9771337 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.098330974578857
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0266849  Vali Loss: 0.0656401 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810020  Vali macro F1 0.9779327 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.104694366455078
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0265707  Vali Loss: 0.0657654 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810020  Vali macro F1 0.9779327 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.102551698684692
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0275898  Vali Loss: 0.0650982 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810020  Vali macro F1 0.9779327 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.116180658340454
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0268192  Vali Loss: 0.0650875 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809953  Vali macro F1 0.9779279 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 38 cost time: 6.107203722000122
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0267723  Vali Loss: 0.0651698 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809953  Vali macro F1 0.9779279 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.125317811965942
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0276823  Vali Loss: 0.0651660 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809953  Vali macro F1 0.9779279 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.11396861076355
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0272013  Vali Loss: 0.0651636 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809953  Vali macro F1 0.9779279 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.117849588394165
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0265906  Vali Loss: 0.0651847 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809953  Vali macro F1 0.9779279 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.102536678314209
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0266152  Vali Loss: 0.0651270 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809953  Vali macro F1 0.9779279 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9680039  Test weighted F1: 0.9675557  Test macro F1 0.9590424 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.142557859420776
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0340291  Vali Loss: 0.0684517 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794663  Vali macro F1 0.9755329 
Validation loss decreased (inf --> 0.068452).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.133880615234375
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0289634  Vali Loss: 0.0659183 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805107  Vali macro F1 0.9769029 
new best score!!!!
Validation loss decreased (0.068452 --> 0.065918).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.140433073043823
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0296195  Vali Loss: 0.0662506 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814721  Vali macro F1 0.9789247 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.1282007694244385
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0283422  Vali Loss: 0.0662387 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835004  Vali macro F1 0.9809352 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.1406919956207275
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0283650  Vali Loss: 0.0684360 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9803458  Vali macro F1 0.9768976 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.151823997497559
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0263635  Vali Loss: 0.0643679 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814800  Vali macro F1 0.9786814 
new best score!!!!
Validation loss decreased (0.065918 --> 0.064368).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.135669708251953
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0267449  Vali Loss: 0.0648826 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814651  Vali macro F1 0.9783985 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.130889177322388
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0258262  Vali Loss: 0.0625368 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830041  Vali macro F1 0.9801693 
new best score!!!!
Validation loss decreased (0.064368 --> 0.062537).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.126124620437622
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0241380  Vali Loss: 0.0664034 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810083  Vali macro F1 0.9782374 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.1415016651153564
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0250498  Vali Loss: 0.0665419 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804445  Vali macro F1 0.9773486 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.121432304382324
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0242836  Vali Loss: 0.0662526 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815297  Vali macro F1 0.9787952 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.131337881088257
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0242101  Vali Loss: 0.0632956 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825028  Vali macro F1 0.9797044 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.123581647872925
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0249107  Vali Loss: 0.0620824 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820002  Vali macro F1 0.9791689 
new best score!!!!
Validation loss decreased (0.062537 --> 0.062082).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.138739109039307
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0205053  Vali Loss: 0.0637601 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830206  Vali macro F1 0.9811090 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.141441822052002
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0216214  Vali Loss: 0.0657377 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825575  Vali macro F1 0.9803650 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.130978107452393
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0219081  Vali Loss: 0.0687709 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814865  Vali macro F1 0.9787147 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.143340110778809
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0216502  Vali Loss: 0.0641948 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840359  Vali macro F1 0.9817742 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.124515533447266
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0213260  Vali Loss: 0.0642885 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835378  Vali macro F1 0.9815550 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 6.11358642578125
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0209577  Vali Loss: 0.0682423 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824846  Vali macro F1 0.9802979 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.122123956680298
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0215213  Vali Loss: 0.0648311 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825110  Vali macro F1 0.9805842 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.122248411178589
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0205089  Vali Loss: 0.0645338 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830072  Vali macro F1 0.9804200 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.141636371612549
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0207222  Vali Loss: 0.0703482 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810108  Vali macro F1 0.9772229 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.148087739944458
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0205824  Vali Loss: 0.0653231 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840718  Vali macro F1 0.9824174 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.145477294921875
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0176259  Vali Loss: 0.0656711 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845687  Vali macro F1 0.9826090 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.120786666870117
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0182265  Vali Loss: 0.0661143 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845830  Vali macro F1 0.9829445 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.097993850708008
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0179552  Vali Loss: 0.0667032 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840717  Vali macro F1 0.9821468 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.094947338104248
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0179660  Vali Loss: 0.0655195 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850859  Vali macro F1 0.9834114 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.1047446727752686
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0170213  Vali Loss: 0.0658141 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845830  Vali macro F1 0.9829445 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9717395  Test weighted F1: 0.9715494  Test macro F1 0.9645924 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014986 0.00018779 0.00137741 0.00144092 0.00052356 0.00064392]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.904451131820679
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.1045992  Vali Loss: 0.6333826 Vali Accuracy: 0.7494670  Vali weighted F1: 0.6922055  Vali macro F1 0.3965319 
Validation loss decreased (inf --> 0.633383).  Saving model ...
Epoch: 2 cost time: 5.890485048294067
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5525214  Vali Loss: 0.4160104 Vali Accuracy: 0.8523454  Vali weighted F1: 0.8437447  Vali macro F1 0.7942368 
new best score!!!!
Validation loss decreased (0.633383 --> 0.416010).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.897010326385498
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.3603702  Vali Loss: 0.2845278 Vali Accuracy: 0.9008529  Vali weighted F1: 0.8959997  Vali macro F1 0.8683970 
new best score!!!!
Validation loss decreased (0.416010 --> 0.284528).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.913877010345459
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.2665156  Vali Loss: 0.2292293 Vali Accuracy: 0.9296375  Vali weighted F1: 0.9277773  Vali macro F1 0.9126856 
new best score!!!!
Validation loss decreased (0.284528 --> 0.229229).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.8983635902404785
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2221940  Vali Loss: 0.1926168 Vali Accuracy: 0.9424307  Vali weighted F1: 0.9414260  Vali macro F1 0.9295287 
new best score!!!!
Validation loss decreased (0.229229 --> 0.192617).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.9033942222595215
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.1989859  Vali Loss: 0.1668734 Vali Accuracy: 0.9493603  Vali weighted F1: 0.9484203  Vali macro F1 0.9394520 
new best score!!!!
Validation loss decreased (0.192617 --> 0.166873).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.907607078552246
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1619804  Vali Loss: 0.1453701 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9583631  Vali macro F1 0.9493810 
new best score!!!!
Validation loss decreased (0.166873 --> 0.145370).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.908429145812988
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1516721  Vali Loss: 0.1369318 Vali Accuracy: 0.9600213  Vali weighted F1: 0.9599986  Vali macro F1 0.9509662 
new best score!!!!
Validation loss decreased (0.145370 --> 0.136932).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.9147255420684814
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1448478  Vali Loss: 0.1449288 Vali Accuracy: 0.9552239  Vali weighted F1: 0.9553718  Vali macro F1 0.9428361 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.903592824935913
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1329522  Vali Loss: 0.1203885 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9592910  Vali macro F1 0.9453660 
new best score!!!!
Validation loss decreased (0.136932 --> 0.120389).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.908778190612793
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1164460  Vali Loss: 0.1153009 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9611336  Vali macro F1 0.9459409 
new best score!!!!
Validation loss decreased (0.120389 --> 0.115301).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.912975788116455
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1055520  Vali Loss: 0.1211934 Vali Accuracy: 0.9621535  Vali weighted F1: 0.9618467  Vali macro F1 0.9473938 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.895624399185181
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1067341  Vali Loss: 0.1135476 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9664898  Vali macro F1 0.9572385 
new best score!!!!
Validation loss decreased (0.115301 --> 0.113548).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.924630403518677
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0926506  Vali Loss: 0.1014133 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9706217  Vali macro F1 0.9623626 
new best score!!!!
Validation loss decreased (0.113548 --> 0.101413).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.897216558456421
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0914245  Vali Loss: 0.1015971 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9695881  Vali macro F1 0.9615750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.89917254447937
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0846557  Vali Loss: 0.1004518 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9684172  Vali macro F1 0.9519798 
new best score!!!!
Validation loss decreased (0.101413 --> 0.100452).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.908966064453125
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0797473  Vali Loss: 0.0903802 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9727940  Vali macro F1 0.9635139 
new best score!!!!
Validation loss decreased (0.100452 --> 0.090380).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.9007110595703125
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0693225  Vali Loss: 0.0971937 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9719010  Vali macro F1 0.9595037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.888107776641846
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0683302  Vali Loss: 0.0986722 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9683482  Vali macro F1 0.9582413 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.894826650619507
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0610058  Vali Loss: 0.0948124 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9708343  Vali macro F1 0.9652453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.883550405502319
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0571373  Vali Loss: 0.0821777 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9759925  Vali macro F1 0.9682275 
new best score!!!!
Validation loss decreased (0.090380 --> 0.082178).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.923296213150024
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0621087  Vali Loss: 0.1001289 Vali Accuracy: 0.9642857  Vali weighted F1: 0.9646035  Vali macro F1 0.9491472 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.9133312702178955
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0615353  Vali Loss: 0.1190122 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9650584  Vali macro F1 0.9560184 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.906546592712402
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0579373  Vali Loss: 0.0869590 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9751657  Vali macro F1 0.9668862 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.901260137557983
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0450271  Vali Loss: 0.0977995 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9704845  Vali macro F1 0.9632480 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.888441562652588
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0476211  Vali Loss: 0.0727822 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9749991  Vali macro F1 0.9671407 
new best score!!!!
Validation loss decreased (0.082178 --> 0.072782).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.9040045738220215
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0434568  Vali Loss: 0.0659050 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9809434  Vali macro F1 0.9742538 
new best score!!!!
Validation loss decreased (0.072782 --> 0.065905).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.908640146255493
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0391547  Vali Loss: 0.0818980 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782462  Vali macro F1 0.9680128 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.889935731887817
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0420469  Vali Loss: 0.0827986 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9762355  Vali macro F1 0.9665841 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.90169882774353
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0401320  Vali Loss: 0.0744050 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9778325  Vali macro F1 0.9707698 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.909671783447266
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0330103  Vali Loss: 0.0720885 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792329  Vali macro F1 0.9704287 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.932426691055298
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0297495  Vali Loss: 0.0731697 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786416  Vali macro F1 0.9725212 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 5.902277708053589
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0248300  Vali Loss: 0.0618513 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824966  Vali macro F1 0.9766246 
new best score!!!!
Validation loss decreased (0.065905 --> 0.061851).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.9068827629089355
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0192233  Vali Loss: 0.0617960 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819444  Vali macro F1 0.9752272 
new best score!!!!
Validation loss decreased (0.061851 --> 0.061796).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.891632556915283
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0187189  Vali Loss: 0.0637512 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808840  Vali macro F1 0.9737254 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.905149459838867
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0183151  Vali Loss: 0.0637364 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819301  Vali macro F1 0.9752107 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.888665676116943
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0177827  Vali Loss: 0.0595767 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819571  Vali macro F1 0.9752413 
new best score!!!!
Validation loss decreased (0.061796 --> 0.059577).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.895538806915283
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0172354  Vali Loss: 0.0598272 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814199  Vali macro F1 0.9743465 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.884629964828491
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0172974  Vali Loss: 0.0609010 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824883  Vali macro F1 0.9761592 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.886463165283203
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0166399  Vali Loss: 0.0596554 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819543  Vali macro F1 0.9752534 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.907285451889038
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0166433  Vali Loss: 0.0632692 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835490  Vali macro F1 0.9780251 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.917661428451538
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0170986  Vali Loss: 0.0621659 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824900  Vali macro F1 0.9761597 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 5.888827562332153
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0163577  Vali Loss: 0.0608242 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824653  Vali macro F1 0.9761183 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.890000820159912
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0147957  Vali Loss: 0.0604993 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819301  Vali macro F1 0.9752107 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 5.9001569747924805
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0160662  Vali Loss: 0.0607684 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824563  Vali macro F1 0.9760940 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 5.893539190292358
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0157329  Vali Loss: 0.0596863 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829916  Vali macro F1 0.9770019 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 5.895064353942871
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0154110  Vali Loss: 0.0603858 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824653  Vali macro F1 0.9761183 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 48 cost time: 5.882667541503906
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0149105  Vali Loss: 0.0603391 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824653  Vali macro F1 0.9761183 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.9005091190338135
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0153542  Vali Loss: 0.0603882 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824653  Vali macro F1 0.9761183 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.899647951126099
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0145180  Vali Loss: 0.0604397 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824653  Vali macro F1 0.9761183 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.931153774261475
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0159406  Vali Loss: 0.0603860 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824653  Vali macro F1 0.9761183 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 5.894848346710205
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0153391  Vali Loss: 0.0604153 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824653  Vali macro F1 0.9761183 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9145420  Test weighted F1: 0.9183851  Test macro F1 0.8841294 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.936761379241943
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0184412  Vali Loss: 0.0609660 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9841028  Vali macro F1 0.9777740 
Validation loss decreased (inf --> 0.060966).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.912802696228027
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0180126  Vali Loss: 0.0587633 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9830104  Vali macro F1 0.9767436 
new best score!!!!
Validation loss decreased (0.060966 --> 0.058763).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.9133288860321045
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0172945  Vali Loss: 0.0603794 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840817  Vali macro F1 0.9781927 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.914822101593018
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0164184  Vali Loss: 0.0629618 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834909  Vali macro F1 0.9778478 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.920948028564453
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0171802  Vali Loss: 0.0577807 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845767  Vali macro F1 0.9789812 
new best score!!!!
Validation loss decreased (0.058763 --> 0.057781).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 5.91870641708374
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0150958  Vali Loss: 0.0593000 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845865  Vali macro F1 0.9793317 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.946392059326172
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0149860  Vali Loss: 0.0590895 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835365  Vali macro F1 0.9775673 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.951855897903442
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0143017  Vali Loss: 0.0590007 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840764  Vali macro F1 0.9785499 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.925781726837158
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0146679  Vali Loss: 0.0550102 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856920  Vali macro F1 0.9802372 
new best score!!!!
Validation loss decreased (0.057781 --> 0.055010).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 5.923985719680786
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0152284  Vali Loss: 0.0636950 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845738  Vali macro F1 0.9797767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 5.913892984390259
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0151452  Vali Loss: 0.0609902 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840551  Vali macro F1 0.9788152 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 5.926537990570068
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0153472  Vali Loss: 0.0569921 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851765  Vali macro F1 0.9797300 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 5.934387922286987
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0130345  Vali Loss: 0.0592258 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835780  Vali macro F1 0.9774072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 5.929561376571655
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0133976  Vali Loss: 0.0617481 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856812  Vali macro F1 0.9802250 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 5.930929899215698
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0111683  Vali Loss: 0.0616866 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9846123  Vali macro F1 0.9787229 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 5.946433782577515
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0124455  Vali Loss: 0.0622306 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845704  Vali macro F1 0.9793616 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 5.951390504837036
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0125334  Vali Loss: 0.0582593 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845770  Vali macro F1 0.9789957 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 5.92199444770813
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0119483  Vali Loss: 0.0610602 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829751  Vali macro F1 0.9773427 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 5.9342474937438965
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0133925  Vali Loss: 0.0600074 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867436  Vali macro F1 0.9812558 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 5.941213607788086
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0108411  Vali Loss: 0.0604375 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851192  Vali macro F1 0.9795568 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 5.9404027462005615
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0110696  Vali Loss: 0.0591128 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851311  Vali macro F1 0.9796627 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 5.938832998275757
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0113234  Vali Loss: 0.0597797 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851222  Vali macro F1 0.9799462 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 5.941481828689575
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0103946  Vali Loss: 0.0595259 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840425  Vali macro F1 0.9784747 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 5.938649415969849
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0103247  Vali Loss: 0.0598767 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840425  Vali macro F1 0.9784747 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9170404  Test weighted F1: 0.9205293  Test macro F1 0.8860988 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00014229 0.00018477 0.00097087 0.00122549 0.0005322  0.00063735]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.219553709030151
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1263535  Vali Loss: 0.6834129 Vali Accuracy: 0.7579909  Vali weighted F1: 0.6909882  Vali macro F1 0.4624106 
Validation loss decreased (inf --> 0.683413).  Saving model ...
Epoch: 2 cost time: 6.220303058624268
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5105716  Vali Loss: 0.4503955 Vali Accuracy: 0.8447489  Vali weighted F1: 0.8454558  Vali macro F1 0.7983460 
new best score!!!!
Validation loss decreased (0.683413 --> 0.450396).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.193225145339966
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3636674  Vali Loss: 0.2776621 Vali Accuracy: 0.9061390  Vali weighted F1: 0.9025482  Vali macro F1 0.8588334 
new best score!!!!
Validation loss decreased (0.450396 --> 0.277662).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.194572925567627
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2575334  Vali Loss: 0.1990344 Vali Accuracy: 0.9335363  Vali weighted F1: 0.9327847  Vali macro F1 0.9014804 
new best score!!!!
Validation loss decreased (0.277662 --> 0.199034).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.211297035217285
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2049975  Vali Loss: 0.1671906 Vali Accuracy: 0.9467275  Vali weighted F1: 0.9463135  Vali macro F1 0.9166151 
new best score!!!!
Validation loss decreased (0.199034 --> 0.167191).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.208606958389282
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1707481  Vali Loss: 0.1462136 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9527753  Vali macro F1 0.9367666 
new best score!!!!
Validation loss decreased (0.167191 --> 0.146214).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.198922157287598
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1477131  Vali Loss: 0.1409242 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9529425  Vali macro F1 0.9319676 
new best score!!!!
Validation loss decreased (0.146214 --> 0.140924).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.213963985443115
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1321859  Vali Loss: 0.1135411 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9655415  Vali macro F1 0.9543586 
new best score!!!!
Validation loss decreased (0.140924 --> 0.113541).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.219817399978638
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1243218  Vali Loss: 0.1114699 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9614348  Vali macro F1 0.9430451 
new best score!!!!
Validation loss decreased (0.113541 --> 0.111470).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.221479415893555
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0973587  Vali Loss: 0.0934553 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9715276  Vali macro F1 0.9603983 
new best score!!!!
Validation loss decreased (0.111470 --> 0.093455).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.20238471031189
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1078620  Vali Loss: 0.0887234 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9709357  Vali macro F1 0.9608307 
new best score!!!!
Validation loss decreased (0.093455 --> 0.088723).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.220595598220825
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0869180  Vali Loss: 0.0775644 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9741455  Vali macro F1 0.9645287 
new best score!!!!
Validation loss decreased (0.088723 --> 0.077564).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.224157810211182
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0833575  Vali Loss: 0.0876236 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9738066  Vali macro F1 0.9632408 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.2155442237854
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0763823  Vali Loss: 0.0821539 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9768867  Vali macro F1 0.9686457 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.223362684249878
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0702239  Vali Loss: 0.0720239 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9755231  Vali macro F1 0.9662208 
new best score!!!!
Validation loss decreased (0.077564 --> 0.072024).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.217367887496948
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0600105  Vali Loss: 0.0721241 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785867  Vali macro F1 0.9729085 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.213914394378662
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0700629  Vali Loss: 0.0565733 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821932  Vali macro F1 0.9751128 
new best score!!!!
Validation loss decreased (0.072024 --> 0.056573).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.223658561706543
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0609387  Vali Loss: 0.0683931 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801060  Vali macro F1 0.9735786 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.234259366989136
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0573319  Vali Loss: 0.0671271 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9790305  Vali macro F1 0.9684128 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.21567440032959
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0509688  Vali Loss: 0.0666057 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797012  Vali macro F1 0.9688876 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.211713790893555
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0452494  Vali Loss: 0.0562470 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822447  Vali macro F1 0.9766231 
new best score!!!!
Validation loss decreased (0.056573 --> 0.056247).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.217494249343872
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0435274  Vali Loss: 0.0665303 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9762798  Vali macro F1 0.9674356 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.217384338378906
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0390126  Vali Loss: 0.0567051 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833233  Vali macro F1 0.9761235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.208012580871582
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0480246  Vali Loss: 0.0536629 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828584  Vali macro F1 0.9753860 
new best score!!!!
Validation loss decreased (0.056247 --> 0.053663).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.220367193222046
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0344655  Vali Loss: 0.0493095 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848040  Vali macro F1 0.9775910 
new best score!!!!
Validation loss decreased (0.053663 --> 0.049309).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.217353582382202
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0308411  Vali Loss: 0.0493883 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827712  Vali macro F1 0.9760784 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.250726222991943
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0323129  Vali Loss: 0.0672311 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9779667  Vali macro F1 0.9701387 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.217218399047852
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0394284  Vali Loss: 0.0580531 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833431  Vali macro F1 0.9777214 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.211956977844238
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0353982  Vali Loss: 0.0549538 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828432  Vali macro F1 0.9775758 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.211332321166992
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0279004  Vali Loss: 0.0532529 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848566  Vali macro F1 0.9790970 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 6.2154152393341064
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0182154  Vali Loss: 0.0472553 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858503  Vali macro F1 0.9803053 
new best score!!!!
Validation loss decreased (0.049309 --> 0.047255).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.205703973770142
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0164635  Vali Loss: 0.0443918 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858182  Vali macro F1 0.9805234 
new best score!!!!
Validation loss decreased (0.047255 --> 0.044392).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.204023361206055
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0156968  Vali Loss: 0.0435769 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853311  Vali macro F1 0.9796344 
new best score!!!!
Validation loss decreased (0.044392 --> 0.043577).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.224543809890747
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0168898  Vali Loss: 0.0458805 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868531  Vali macro F1 0.9816049 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.2405595779418945
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0156470  Vali Loss: 0.0456574 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858255  Vali macro F1 0.9805290 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.217560052871704
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0155427  Vali Loss: 0.0443054 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863275  Vali macro F1 0.9813919 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.213609933853149
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0139721  Vali Loss: 0.0430268 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868161  Vali macro F1 0.9818074 
new best score!!!!
Validation loss decreased (0.043577 --> 0.043027).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.219874143600464
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0153882  Vali Loss: 0.0449533 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838134  Vali macro F1 0.9770655 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.208388090133667
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0135840  Vali Loss: 0.0446657 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868502  Vali macro F1 0.9818078 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.208648920059204
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0130268  Vali Loss: 0.0446321 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853018  Vali macro F1 0.9801654 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.211816310882568
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0138344  Vali Loss: 0.0441398 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868204  Vali macro F1 0.9818084 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.208263635635376
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0131477  Vali Loss: 0.0439144 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853179  Vali macro F1 0.9795806 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 6.23828125
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0138701  Vali Loss: 0.0428623 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858117  Vali macro F1 0.9800748 
new best score!!!!
Validation loss decreased (0.043027 --> 0.042862).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.2146522998809814
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0127341  Vali Loss: 0.0427129 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853067  Vali macro F1 0.9792063 
new best score!!!!
Validation loss decreased (0.042862 --> 0.042713).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.2255332469940186
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0124861  Vali Loss: 0.0428428 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858117  Vali macro F1 0.9800748 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.195874452590942
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0136636  Vali Loss: 0.0429362 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858125  Vali macro F1 0.9812093 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.207073450088501
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0121560  Vali Loss: 0.0426628 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853167  Vali macro F1 0.9795684 
new best score!!!!
Validation loss decreased (0.042713 --> 0.042663).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.218358039855957
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0118699  Vali Loss: 0.0426266 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863171  Vali macro F1 0.9820767 
new best score!!!!
Validation loss decreased (0.042663 --> 0.042627).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.2226927280426025
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0107830  Vali Loss: 0.0425622 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873196  Vali macro F1 0.9834545 
new best score!!!!
Validation loss decreased (0.042627 --> 0.042562).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.220338344573975
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0125188  Vali Loss: 0.0427856 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868259  Vali macro F1 0.9821620 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.2075676918029785
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0129011  Vali Loss: 0.0428255 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868204  Vali macro F1 0.9818084 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.227763414382935
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0126610  Vali Loss: 0.0431079 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.2270591259002686
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0123297  Vali Loss: 0.0430263 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.198339462280273
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0120327  Vali Loss: 0.0431897 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868314  Vali macro F1 0.9826156 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.213853120803833
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0125865  Vali Loss: 0.0431735 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868314  Vali macro F1 0.9826156 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.219547986984253
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0117688  Vali Loss: 0.0431543 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868314  Vali macro F1 0.9826156 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.219369649887085
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0109593  Vali Loss: 0.0431329 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868314  Vali macro F1 0.9826156 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.219023942947388
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0126519  Vali Loss: 0.0431356 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.211253643035889
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0112880  Vali Loss: 0.0431067 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 60 cost time: 6.2255024909973145
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0114667  Vali Loss: 0.0431135 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.22712779045105
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0130563  Vali Loss: 0.0431090 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.21712327003479
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0119095  Vali Loss: 0.0431023 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.203728914260864
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0114487  Vali Loss: 0.0430980 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.2155046463012695
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0120317  Vali Loss: 0.0430958 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863344  Vali macro F1 0.9809729 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9022798  Test weighted F1: 0.9005988  Test macro F1 0.9131381 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.23012900352478
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0145010  Vali Loss: 0.0453528 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868346  Vali macro F1 0.9823171 
Validation loss decreased (inf --> 0.045353).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.230350017547607
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0130571  Vali Loss: 0.0433423 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852728  Vali macro F1 0.9806089 
new best score!!!!
Validation loss decreased (0.045353 --> 0.043342).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.215910196304321
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0131527  Vali Loss: 0.0454612 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868323  Vali macro F1 0.9817839 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.215828895568848
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0126650  Vali Loss: 0.0444258 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858079  Vali macro F1 0.9811827 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.236238241195679
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0126333  Vali Loss: 0.0467902 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847870  Vali macro F1 0.9797400 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.230578422546387
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0116985  Vali Loss: 0.0438802 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858222  Vali macro F1 0.9818660 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.204447507858276
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0118833  Vali Loss: 0.0458388 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858313  Vali macro F1 0.9812414 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.203031301498413
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0129994  Vali Loss: 0.0456132 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847973  Vali macro F1 0.9801627 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.203490734100342
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0117771  Vali Loss: 0.0431480 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847806  Vali macro F1 0.9794672 
new best score!!!!
Validation loss decreased (0.043342 --> 0.043148).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.211449861526489
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0109621  Vali Loss: 0.0462742 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848043  Vali macro F1 0.9792077 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.212825298309326
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0109133  Vali Loss: 0.0442074 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857654  Vali macro F1 0.9820153 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.21465539932251
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0113685  Vali Loss: 0.0463555 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832961  Vali macro F1 0.9772855 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.238451242446899
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0118974  Vali Loss: 0.0497605 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827142  Vali macro F1 0.9775658 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.239377737045288
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0103399  Vali Loss: 0.0483580 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828384  Vali macro F1 0.9759048 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.216245174407959
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0098532  Vali Loss: 0.0455912 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858298  Vali macro F1 0.9806434 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.2186901569366455
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0089204  Vali Loss: 0.0451958 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863332  Vali macro F1 0.9815092 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.219679594039917
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0088501  Vali Loss: 0.0449246 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863332  Vali macro F1 0.9815092 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.227977275848389
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0093510  Vali Loss: 0.0446396 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863332  Vali macro F1 0.9815092 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.210245370864868
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0086301  Vali Loss: 0.0446067 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868346  Vali macro F1 0.9822849 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 6.2160804271698
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0082256  Vali Loss: 0.0445299 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868346  Vali macro F1 0.9822849 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.238533973693848
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0080908  Vali Loss: 0.0445244 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868346  Vali macro F1 0.9823171 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.234364748001099
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0083666  Vali Loss: 0.0445298 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868363  Vali macro F1 0.9824060 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.22711968421936
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0090850  Vali Loss: 0.0445138 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863332  Vali macro F1 0.9815092 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.206818342208862
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0092790  Vali Loss: 0.0445170 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863332  Vali macro F1 0.9815414 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8954771  Test weighted F1: 0.8933144  Test macro F1 0.9096686 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014168 0.00017867 0.00095969 0.00122549 0.000481   0.00060643]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.380457162857056
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.0939974  Vali Loss: 0.6737516 Vali Accuracy: 0.7498767  Vali weighted F1: 0.6872992  Vali macro F1 0.4765911 
Validation loss decreased (inf --> 0.673752).  Saving model ...
Epoch: 2 cost time: 6.379953622817993
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.5043397  Vali Loss: 0.3848242 Vali Accuracy: 0.8623582  Vali weighted F1: 0.8516536  Vali macro F1 0.8188514 
new best score!!!!
Validation loss decreased (0.673752 --> 0.384824).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.383133172988892
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3361412  Vali Loss: 0.2592757 Vali Accuracy: 0.9092255  Vali weighted F1: 0.9085464  Vali macro F1 0.8840787 
new best score!!!!
Validation loss decreased (0.384824 --> 0.259276).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.388601303100586
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2377235  Vali Loss: 0.2377455 Vali Accuracy: 0.9190923  Vali weighted F1: 0.9176444  Vali macro F1 0.8990879 
new best score!!!!
Validation loss decreased (0.259276 --> 0.237746).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.422651767730713
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.1968523  Vali Loss: 0.2017194 Vali Accuracy: 0.9348791  Vali weighted F1: 0.9326230  Vali macro F1 0.9175372 
new best score!!!!
Validation loss decreased (0.237746 --> 0.201719).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.407419204711914
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1710351  Vali Loss: 0.1530507 Vali Accuracy: 0.9452393  Vali weighted F1: 0.9447956  Vali macro F1 0.9276834 
new best score!!!!
Validation loss decreased (0.201719 --> 0.153051).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.399471998214722
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1491817  Vali Loss: 0.1331880 Vali Accuracy: 0.9541194  Vali weighted F1: 0.9543082  Vali macro F1 0.9409007 
new best score!!!!
Validation loss decreased (0.153051 --> 0.133188).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.405160903930664
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1415244  Vali Loss: 0.1259987 Vali Accuracy: 0.9570794  Vali weighted F1: 0.9569594  Vali macro F1 0.9459391 
new best score!!!!
Validation loss decreased (0.133188 --> 0.125999).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.384856224060059
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1230552  Vali Loss: 0.1067854 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9638574  Vali macro F1 0.9531265 
new best score!!!!
Validation loss decreased (0.125999 --> 0.106785).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.384722948074341
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1094256  Vali Loss: 0.1151835 Vali Accuracy: 0.9629995  Vali weighted F1: 0.9626369  Vali macro F1 0.9548226 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.380026817321777
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1057662  Vali Loss: 0.1267710 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9575601  Vali macro F1 0.9469522 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.384199380874634
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0961338  Vali Loss: 0.0861783 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9685075  Vali macro F1 0.9587485 
new best score!!!!
Validation loss decreased (0.106785 --> 0.086178).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.420700788497925
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0963969  Vali Loss: 0.0956942 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9665775  Vali macro F1 0.9562035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.399749040603638
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0893072  Vali Loss: 0.0857154 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9735969  Vali macro F1 0.9647750 
new best score!!!!
Validation loss decreased (0.086178 --> 0.085715).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.3869171142578125
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0814805  Vali Loss: 0.0787318 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9745497  Vali macro F1 0.9652363 
new best score!!!!
Validation loss decreased (0.085715 --> 0.078732).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.388859748840332
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0779052  Vali Loss: 0.0878267 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9732894  Vali macro F1 0.9654991 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.387497186660767
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0719411  Vali Loss: 0.0718485 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9758261  Vali macro F1 0.9676307 
new best score!!!!
Validation loss decreased (0.078732 --> 0.071848).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.389353513717651
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0637324  Vali Loss: 0.0887667 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9757118  Vali macro F1 0.9669034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.393903493881226
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0605451  Vali Loss: 0.0652491 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813074  Vali macro F1 0.9724624 
new best score!!!!
Validation loss decreased (0.071848 --> 0.065249).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.40800404548645
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0583473  Vali Loss: 0.0706817 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798628  Vali macro F1 0.9708587 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.404761075973511
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0546482  Vali Loss: 0.0840227 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9719527  Vali macro F1 0.9620420 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.396834373474121
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0529699  Vali Loss: 0.0721038 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788065  Vali macro F1 0.9721835 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.391041040420532
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0553019  Vali Loss: 0.0657972 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827776  Vali macro F1 0.9761900 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.386443376541138
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0499377  Vali Loss: 0.0581301 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808295  Vali macro F1 0.9738057 
new best score!!!!
Validation loss decreased (0.065249 --> 0.058130).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.396617412567139
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0429106  Vali Loss: 0.0662672 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9819229  Vali macro F1 0.9751030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.3878493309021
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0410158  Vali Loss: 0.0608860 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9810203  Vali macro F1 0.9734213 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.3779990673065186
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0368395  Vali Loss: 0.0574347 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847094  Vali macro F1 0.9773429 
new best score!!!!
Validation loss decreased (0.058130 --> 0.057435).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.395148992538452
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0313200  Vali Loss: 0.0797507 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777347  Vali macro F1 0.9694195 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.410467624664307
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0373061  Vali Loss: 0.0631368 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9838329  Vali macro F1 0.9773259 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.41176438331604
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0323623  Vali Loss: 0.0539405 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862150  Vali macro F1 0.9806874 
new best score!!!!
Validation loss decreased (0.057435 --> 0.053940).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.398000240325928
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0291972  Vali Loss: 0.0534816 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852967  Vali macro F1 0.9793798 
new best score!!!!
Validation loss decreased (0.053940 --> 0.053482).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.391700029373169
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0283811  Vali Loss: 0.0785774 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9776780  Vali macro F1 0.9709057 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.397775650024414
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0300121  Vali Loss: 0.0699951 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812222  Vali macro F1 0.9735896 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.394543647766113
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0319228  Vali Loss: 0.0543807 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867445  Vali macro F1 0.9806130 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.399570941925049
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0250604  Vali Loss: 0.0663022 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9819341  Vali macro F1 0.9776244 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.4002907276153564
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0265524  Vali Loss: 0.0602824 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842006  Vali macro F1 0.9779151 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 6.4186553955078125
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0151954  Vali Loss: 0.0545089 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842534  Vali macro F1 0.9775735 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.412088632583618
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0151747  Vali Loss: 0.0544055 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842132  Vali macro F1 0.9775700 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.390176057815552
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0138728  Vali Loss: 0.0536854 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857314  Vali macro F1 0.9803153 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.388377666473389
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0125722  Vali Loss: 0.0538616 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862452  Vali macro F1 0.9802404 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.40101957321167
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0132603  Vali Loss: 0.0534091 Vali Accuracy: 0.9876665  Vali weighted F1: 0.9877174  Vali macro F1 0.9820179 
new best score!!!!
Validation loss decreased (0.053482 --> 0.053409).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.385882377624512
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0112688  Vali Loss: 0.0537220 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862208  Vali macro F1 0.9804929 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.3977813720703125
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0130581  Vali Loss: 0.0536433 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872268  Vali macro F1 0.9817504 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.399258852005005
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0122439  Vali Loss: 0.0537960 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857443  Vali macro F1 0.9798145 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.422410249710083
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0108846  Vali Loss: 0.0544017 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867261  Vali macro F1 0.9810466 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.407931327819824
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0110031  Vali Loss: 0.0558360 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857233  Vali macro F1 0.9796998 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.395860433578491
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0106702  Vali Loss: 0.0554676 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.393301486968994
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0113907  Vali Loss: 0.0554343 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.397522687911987
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0114792  Vali Loss: 0.0553178 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.389398574829102
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0098730  Vali Loss: 0.0554079 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852398  Vali macro F1 0.9792385 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.391865253448486
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0113074  Vali Loss: 0.0552157 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 6.389517307281494
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0113429  Vali Loss: 0.0552245 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.412189960479736
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0110392  Vali Loss: 0.0552339 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.394373655319214
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0121929  Vali Loss: 0.0552232 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.38880467414856
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0110443  Vali Loss: 0.0551856 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.392634868621826
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0115442  Vali Loss: 0.0551969 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857331  Vali macro F1 0.9800072 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8884754  Test weighted F1: 0.8762178  Test macro F1 0.6619888 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.402486324310303
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0132673  Vali Loss: 0.0525835 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867508  Vali macro F1 0.9809488 
Validation loss decreased (inf --> 0.052584).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.391914367675781
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0139035  Vali Loss: 0.0545273 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852157  Vali macro F1 0.9788199 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.38811469078064
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0114054  Vali Loss: 0.0521386 Vali Accuracy: 0.9876665  Vali weighted F1: 0.9877133  Vali macro F1 0.9816301 
new best score!!!!
Validation loss decreased (0.052584 --> 0.052139).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.3955864906311035
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0112962  Vali Loss: 0.0527196 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862521  Vali macro F1 0.9801570 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.426724195480347
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0131245  Vali Loss: 0.0564562 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9851856  Vali macro F1 0.9797768 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.412139654159546
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0115773  Vali Loss: 0.0559617 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872304  Vali macro F1 0.9817501 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.407660722732544
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0113349  Vali Loss: 0.0549131 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866959  Vali macro F1 0.9809543 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.400104999542236
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0105828  Vali Loss: 0.0565713 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867531  Vali macro F1 0.9816221 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.4077513217926025
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0110633  Vali Loss: 0.0548184 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867235  Vali macro F1 0.9802993 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.415695667266846
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0104816  Vali Loss: 0.0544298 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867249  Vali macro F1 0.9806816 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.420432090759277
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0106547  Vali Loss: 0.0547448 Vali Accuracy: 0.9881598  Vali weighted F1: 0.9881928  Vali macro F1 0.9827605 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.418970823287964
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0095961  Vali Loss: 0.0566536 Vali Accuracy: 0.9876665  Vali weighted F1: 0.9877041  Vali macro F1 0.9822135 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.421182155609131
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0093026  Vali Loss: 0.0543261 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872021  Vali macro F1 0.9817242 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.4111714363098145
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0088488  Vali Loss: 0.0540457 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872124  Vali macro F1 0.9811185 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.424269914627075
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0085703  Vali Loss: 0.0542312 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867283  Vali macro F1 0.9806560 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.404618263244629
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0090678  Vali Loss: 0.0538361 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872032  Vali macro F1 0.9813967 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.406787872314453
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0087963  Vali Loss: 0.0540417 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867108  Vali macro F1 0.9806294 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.405429840087891
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0080988  Vali Loss: 0.0543210 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872124  Vali macro F1 0.9811185 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8821486  Test weighted F1: 0.8699702  Test macro F1 0.6548855 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0001452  0.00016892 0.00099305 0.00131234 0.00049875 0.00062893]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.341463565826416
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0696395  Vali Loss: 0.6444591 Vali Accuracy: 0.7934621  Vali weighted F1: 0.7399775  Vali macro F1 0.5146213 
Validation loss decreased (inf --> 0.644459).  Saving model ...
Epoch: 2 cost time: 6.336925506591797
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5228613  Vali Loss: 0.3792925 Vali Accuracy: 0.8628034  Vali weighted F1: 0.8505029  Vali macro F1 0.8048441 
new best score!!!!
Validation loss decreased (0.644459 --> 0.379293).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.344533681869507
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3367016  Vali Loss: 0.2306642 Vali Accuracy: 0.9212481  Vali weighted F1: 0.9195972  Vali macro F1 0.8888466 
new best score!!!!
Validation loss decreased (0.379293 --> 0.230664).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.350208520889282
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2467688  Vali Loss: 0.1944961 Vali Accuracy: 0.9356117  Vali weighted F1: 0.9325378  Vali macro F1 0.8998136 
new best score!!!!
Validation loss decreased (0.230664 --> 0.194496).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.35676121711731
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1950042  Vali Loss: 0.1530501 Vali Accuracy: 0.9519564  Vali weighted F1: 0.9525048  Vali macro F1 0.9296385 
new best score!!!!
Validation loss decreased (0.194496 --> 0.153050).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.346720218658447
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1658244  Vali Loss: 0.1338836 Vali Accuracy: 0.9554235  Vali weighted F1: 0.9549676  Vali macro F1 0.9366986 
new best score!!!!
Validation loss decreased (0.153050 --> 0.133884).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.345730781555176
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1499361  Vali Loss: 0.1351982 Vali Accuracy: 0.9549282  Vali weighted F1: 0.9546874  Vali macro F1 0.9335721 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.351322174072266
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1421332  Vali Loss: 0.1158977 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9625141  Vali macro F1 0.9461240 
new best score!!!!
Validation loss decreased (0.133884 --> 0.115898).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.339125871658325
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1205756  Vali Loss: 0.1117849 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9650674  Vali macro F1 0.9504925 
new best score!!!!
Validation loss decreased (0.115898 --> 0.111785).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.346286058425903
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1177334  Vali Loss: 0.1181581 Vali Accuracy: 0.9608717  Vali weighted F1: 0.9614057  Vali macro F1 0.9435686 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.358497381210327
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1112759  Vali Loss: 0.1099424 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9611087  Vali macro F1 0.9436399 
new best score!!!!
Validation loss decreased (0.111785 --> 0.109942).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.340580224990845
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0957995  Vali Loss: 0.0866370 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9709928  Vali macro F1 0.9575834 
new best score!!!!
Validation loss decreased (0.109942 --> 0.086637).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.372982978820801
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0893391  Vali Loss: 0.0900755 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9692972  Vali macro F1 0.9497437 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.361142635345459
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0856549  Vali Loss: 0.0763520 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747741  Vali macro F1 0.9636089 
new best score!!!!
Validation loss decreased (0.086637 --> 0.076352).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.363138675689697
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0802422  Vali Loss: 0.0760643 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9722414  Vali macro F1 0.9577257 
new best score!!!!
Validation loss decreased (0.076352 --> 0.076064).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.365490674972534
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0711775  Vali Loss: 0.0810669 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9728312  Vali macro F1 0.9611665 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.3515167236328125
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0709670  Vali Loss: 0.0766467 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9746913  Vali macro F1 0.9617216 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.35470175743103
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0620256  Vali Loss: 0.0647276 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9772798  Vali macro F1 0.9666391 
new best score!!!!
Validation loss decreased (0.076064 --> 0.064728).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.349360942840576
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0636926  Vali Loss: 0.0731104 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9743334  Vali macro F1 0.9631322 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.352294445037842
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0606190  Vali Loss: 0.0845523 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9712441  Vali macro F1 0.9591998 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.350460529327393
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0549381  Vali Loss: 0.0587160 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797132  Vali macro F1 0.9682364 
new best score!!!!
Validation loss decreased (0.064728 --> 0.058716).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.366329908370972
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0498898  Vali Loss: 0.0664467 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9768840  Vali macro F1 0.9641497 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.3738672733306885
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0419167  Vali Loss: 0.0524505 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817205  Vali macro F1 0.9711300 
new best score!!!!
Validation loss decreased (0.058716 --> 0.052451).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.36298942565918
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0402600  Vali Loss: 0.0663343 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9771943  Vali macro F1 0.9648549 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.364251375198364
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0455377  Vali Loss: 0.0633032 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9786930  Vali macro F1 0.9671703 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.353399991989136
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0383631  Vali Loss: 0.0590924 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807857  Vali macro F1 0.9696114 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.350507020950317
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0403316  Vali Loss: 0.0514506 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807245  Vali macro F1 0.9697547 
new best score!!!!
Validation loss decreased (0.052451 --> 0.051451).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.35575532913208
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0455714  Vali Loss: 0.0633435 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793414  Vali macro F1 0.9648838 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.352150201797485
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0326798  Vali Loss: 0.0533225 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822646  Vali macro F1 0.9726244 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.355698108673096
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0416702  Vali Loss: 0.0813596 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9728847  Vali macro F1 0.9597012 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.37575888633728
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0356467  Vali Loss: 0.0602225 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9796670  Vali macro F1 0.9693703 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.380619287490845
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0278653  Vali Loss: 0.0529384 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802067  Vali macro F1 0.9698552 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 6.352183818817139
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0207330  Vali Loss: 0.0471736 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832179  Vali macro F1 0.9731557 
new best score!!!!
Validation loss decreased (0.051451 --> 0.047174).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.344909429550171
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0187273  Vali Loss: 0.0517792 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.359012126922607
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0174171  Vali Loss: 0.0504814 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832245  Vali macro F1 0.9735467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.358155250549316
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0173390  Vali Loss: 0.0482537 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832179  Vali macro F1 0.9731557 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.371514797210693
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0157530  Vali Loss: 0.0475328 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832256  Vali macro F1 0.9731575 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.359226942062378
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0156807  Vali Loss: 0.0493620 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.373083114624023
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0153411  Vali Loss: 0.0484825 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.368304014205933
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0156289  Vali Loss: 0.0482926 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.3501152992248535
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0157653  Vali Loss: 0.0481444 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.341086149215698
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0151569  Vali Loss: 0.0481523 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.348613262176514
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0162652  Vali Loss: 0.0483864 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.3530800342559814
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0152516  Vali Loss: 0.0483714 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.352991104125977
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0162135  Vali Loss: 0.0482863 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.358497858047485
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0146645  Vali Loss: 0.0482940 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.3651041984558105
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0156906  Vali Loss: 0.0483284 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.362128496170044
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0145478  Vali Loss: 0.0483137 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832337  Vali macro F1 0.9735514 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8946746  Test weighted F1: 0.8915570  Test macro F1 0.8445260 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3952460289001465
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0199430  Vali Loss: 0.0491755 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822423  Vali macro F1 0.9718371 
Validation loss decreased (inf --> 0.049176).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3619606494903564
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0179775  Vali Loss: 0.0506675 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822250  Vali macro F1 0.9720896 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.353737115859985
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0179929  Vali Loss: 0.0488352 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836420  Vali macro F1 0.9740621 
new best score!!!!
Validation loss decreased (0.049176 --> 0.048835).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.3613340854644775
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0167180  Vali Loss: 0.0471885 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827740  Vali macro F1 0.9734195 
new best score!!!!
Validation loss decreased (0.048835 --> 0.047189).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.38015079498291
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0156663  Vali Loss: 0.0480223 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832454  Vali macro F1 0.9738770 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.3722429275512695
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0159138  Vali Loss: 0.0487447 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837359  Vali macro F1 0.9736692 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.367741346359253
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0154227  Vali Loss: 0.0480002 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9847057  Vali macro F1 0.9757307 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.368696928024292
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0164324  Vali Loss: 0.0487699 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837137  Vali macro F1 0.9740134 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.387411594390869
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0151252  Vali Loss: 0.0513796 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837465  Vali macro F1 0.9739929 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.3889241218566895
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0136353  Vali Loss: 0.0464801 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837465  Vali macro F1 0.9739929 
new best score!!!!
Validation loss decreased (0.047189 --> 0.046480).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.387368202209473
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0138713  Vali Loss: 0.0478542 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822227  Vali macro F1 0.9717176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.381180047988892
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0133945  Vali Loss: 0.0453693 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9857194  Vali macro F1 0.9767681 
new best score!!!!
Validation loss decreased (0.046480 --> 0.045369).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.379853010177612
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0129156  Vali Loss: 0.0446205 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856990  Vali macro F1 0.9767253 
new best score!!!!
Validation loss decreased (0.045369 --> 0.044621).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.377480983734131
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0133449  Vali Loss: 0.0490671 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832805  Vali macro F1 0.9739997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.370999574661255
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0141511  Vali Loss: 0.0467833 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846707  Vali macro F1 0.9755680 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.373765230178833
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0126419  Vali Loss: 0.0504092 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851669  Vali macro F1 0.9764268 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.380963087081909
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0116871  Vali Loss: 0.0488120 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836709  Vali macro F1 0.9741734 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.389930725097656
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0116313  Vali Loss: 0.0471538 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841937  Vali macro F1 0.9751262 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.376646041870117
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0112551  Vali Loss: 0.0484163 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.390836238861084
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0107895  Vali Loss: 0.0478783 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.373721599578857
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0107420  Vali Loss: 0.0482929 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.371116876602173
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0106124  Vali Loss: 0.0483506 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.373065948486328
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0105597  Vali Loss: 0.0478790 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851937  Vali macro F1 0.9765859 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 6.3710715770721436
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0106369  Vali Loss: 0.0479341 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.371659755706787
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0099557  Vali Loss: 0.0480110 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.370906829833984
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0103834  Vali Loss: 0.0480682 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.41635274887085
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0109707  Vali Loss: 0.0480961 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.404919147491455
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0108664  Vali Loss: 0.0481403 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846976  Vali macro F1 0.9757266 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8917160  Test weighted F1: 0.8884491  Test macro F1 0.8580627 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014665 0.00017765 0.00108578 0.00135318 0.00049407 0.00062383]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.217371225357056
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1105947  Vali Loss: 0.7017283 Vali Accuracy: 0.7534247  Vali weighted F1: 0.6956005  Vali macro F1 0.5159507 
Validation loss decreased (inf --> 0.701728).  Saving model ...
Epoch: 2 cost time: 6.213141202926636
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5577711  Vali Loss: 0.4334255 Vali Accuracy: 0.8467783  Vali weighted F1: 0.8200151  Vali macro F1 0.7611774 
new best score!!!!
Validation loss decreased (0.701728 --> 0.433425).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.210290908813477
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3794047  Vali Loss: 0.2865627 Vali Accuracy: 0.9046169  Vali weighted F1: 0.9029655  Vali macro F1 0.8759513 
new best score!!!!
Validation loss decreased (0.433425 --> 0.286563).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2017786502838135
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2852264  Vali Loss: 0.2306508 Vali Accuracy: 0.9249112  Vali weighted F1: 0.9232103  Vali macro F1 0.9002396 
new best score!!!!
Validation loss decreased (0.286563 --> 0.230651).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.2193403244018555
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2305833  Vali Loss: 0.2672002 Vali Accuracy: 0.9173009  Vali weighted F1: 0.9107439  Vali macro F1 0.8922877 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.228008270263672
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1945392  Vali Loss: 0.1955853 Vali Accuracy: 0.9360731  Vali weighted F1: 0.9339477  Vali macro F1 0.9168476 
new best score!!!!
Validation loss decreased (0.230651 --> 0.195585).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.265735864639282
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1546547  Vali Loss: 0.1283924 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9554624  Vali macro F1 0.9398828 
new best score!!!!
Validation loss decreased (0.195585 --> 0.128392).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.250770330429077
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1339665  Vali Loss: 0.1354341 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9549986  Vali macro F1 0.9416019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.225313901901245
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1227879  Vali Loss: 0.1290114 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9562416  Vali macro F1 0.9422515 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 10 cost time: 6.225863456726074
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1127522  Vali Loss: 0.1214143 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9568480  Vali macro F1 0.9425202 
new best score!!!!
Validation loss decreased (0.128392 --> 0.121414).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.236291408538818
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1004655  Vali Loss: 0.1105130 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9614091  Vali macro F1 0.9488752 
new best score!!!!
Validation loss decreased (0.121414 --> 0.110513).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.233661890029907
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0894403  Vali Loss: 0.1081232 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9639166  Vali macro F1 0.9548182 
new best score!!!!
Validation loss decreased (0.110513 --> 0.108123).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.232102632522583
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0870659  Vali Loss: 0.0876592 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9705351  Vali macro F1 0.9597453 
new best score!!!!
Validation loss decreased (0.108123 --> 0.087659).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.223466396331787
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0791565  Vali Loss: 0.0770299 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9744315  Vali macro F1 0.9655615 
new best score!!!!
Validation loss decreased (0.087659 --> 0.077030).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.227020263671875
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0718989  Vali Loss: 0.0866745 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9693196  Vali macro F1 0.9606461 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.24401330947876
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0679863  Vali Loss: 0.0967562 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9662633  Vali macro F1 0.9516455 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.219998121261597
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0644097  Vali Loss: 0.1020487 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9677834  Vali macro F1 0.9561695 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.212726831436157
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0661213  Vali Loss: 0.0968738 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9685765  Vali macro F1 0.9559507 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 19 cost time: 6.219706773757935
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0600795  Vali Loss: 0.0741287 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778508  Vali macro F1 0.9689968 
new best score!!!!
Validation loss decreased (0.077030 --> 0.074129).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.217125654220581
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0614440  Vali Loss: 0.0886408 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9693826  Vali macro F1 0.9552144 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.22362756729126
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0558797  Vali Loss: 0.0804779 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9731469  Vali macro F1 0.9590281 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.222966194152832
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0558981  Vali Loss: 0.0827604 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9744207  Vali macro F1 0.9637152 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.223819732666016
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0476911  Vali Loss: 0.0769024 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9751161  Vali macro F1 0.9634605 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.242956638336182
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0485103  Vali Loss: 0.0835653 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9745139  Vali macro F1 0.9639611 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 6.2266151905059814
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0335300  Vali Loss: 0.0616911 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801878  Vali macro F1 0.9725585 
new best score!!!!
Validation loss decreased (0.074129 --> 0.061691).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.228773832321167
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0311945  Vali Loss: 0.0649986 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782373  Vali macro F1 0.9688640 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.228403806686401
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0295115  Vali Loss: 0.0613944 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807658  Vali macro F1 0.9722350 
new best score!!!!
Validation loss decreased (0.061691 --> 0.061394).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.233874797821045
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0303785  Vali Loss: 0.0636770 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797519  Vali macro F1 0.9707787 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.224720478057861
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0286297  Vali Loss: 0.0660350 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801585  Vali macro F1 0.9716660 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.230753183364868
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0271718  Vali Loss: 0.0656445 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797039  Vali macro F1 0.9719897 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.22996973991394
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0273225  Vali Loss: 0.0630239 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802370  Vali macro F1 0.9717134 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.246960401535034
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0269104  Vali Loss: 0.0626834 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802165  Vali macro F1 0.9697203 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 6.247829914093018
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0249006  Vali Loss: 0.0638428 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797281  Vali macro F1 0.9688054 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.238208770751953
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0250145  Vali Loss: 0.0632512 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792082  Vali macro F1 0.9683670 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.23891806602478
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0259114  Vali Loss: 0.0639636 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787199  Vali macro F1 0.9674532 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.2280802726745605
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0258530  Vali Loss: 0.0632996 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792255  Vali macro F1 0.9683002 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.225247859954834
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0268819  Vali Loss: 0.0634205 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787199  Vali macro F1 0.9674532 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 38 cost time: 6.2229530811309814
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0254328  Vali Loss: 0.0635122 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781881  Vali macro F1 0.9669004 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.224680662155151
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0256789  Vali Loss: 0.0633747 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781881  Vali macro F1 0.9669004 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.231771230697632
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0252846  Vali Loss: 0.0633312 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787199  Vali macro F1 0.9674532 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.24503493309021
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0258518  Vali Loss: 0.0633276 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781881  Vali macro F1 0.9669004 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.242163896560669
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0245651  Vali Loss: 0.0633321 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787199  Vali macro F1 0.9674532 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9316279  Test weighted F1: 0.9319788  Test macro F1 0.8817918 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.246007680892944
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0296222  Vali Loss: 0.0635421 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792693  Vali macro F1 0.9693799 
Validation loss decreased (inf --> 0.063542).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2267584800720215
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0297614  Vali Loss: 0.0690872 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791718  Vali macro F1 0.9717886 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.219125986099243
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0288389  Vali Loss: 0.0595130 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811234  Vali macro F1 0.9749547 
new best score!!!!
Validation loss decreased (0.063542 --> 0.059513).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.224347114562988
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0283884  Vali Loss: 0.0653639 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797571  Vali macro F1 0.9688521 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.240453004837036
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0268546  Vali Loss: 0.0646849 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802067  Vali macro F1 0.9724948 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.245639085769653
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0276934  Vali Loss: 0.0572799 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817665  Vali macro F1 0.9750449 
new best score!!!!
Validation loss decreased (0.059513 --> 0.057280).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.268279075622559
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0252780  Vali Loss: 0.0609918 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806408  Vali macro F1 0.9734984 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.231154918670654
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0262162  Vali Loss: 0.0669670 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781845  Vali macro F1 0.9677428 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.223524332046509
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0250869  Vali Loss: 0.0656351 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807160  Vali macro F1 0.9725299 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.23117470741272
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0243446  Vali Loss: 0.0611606 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807544  Vali macro F1 0.9712239 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.244422912597656
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0277146  Vali Loss: 0.0674987 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802877  Vali macro F1 0.9717565 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.243017673492432
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0243812  Vali Loss: 0.0635055 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802629  Vali macro F1 0.9714055 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.235568046569824
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0236374  Vali Loss: 0.0636820 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801871  Vali macro F1 0.9705044 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.234710931777954
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0211493  Vali Loss: 0.0649856 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797020  Vali macro F1 0.9708185 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.258090019226074
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0225778  Vali Loss: 0.0614800 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782501  Vali macro F1 0.9678899 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.258553981781006
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0220354  Vali Loss: 0.0615723 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786941  Vali macro F1 0.9686079 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.229119777679443
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0204994  Vali Loss: 0.0629679 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791965  Vali macro F1 0.9691129 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.236323356628418
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0189246  Vali Loss: 0.0630745 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792010  Vali macro F1 0.9694569 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.240570783615112
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0212363  Vali Loss: 0.0619516 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792010  Vali macro F1 0.9694569 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.240002870559692
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0200091  Vali Loss: 0.0621197 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797034  Vali macro F1 0.9699619 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.252845048904419
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0191384  Vali Loss: 0.0620503 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792010  Vali macro F1 0.9694569 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9275789  Test weighted F1: 0.9281841  Test macro F1 0.8757432 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00014041 0.00018215 0.00102459 0.00129702 0.00049213 0.0005963 ]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.336362600326538
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0951868  Vali Loss: 0.6439409 Vali Accuracy: 0.7778884  Vali weighted F1: 0.7319869  Vali macro F1 0.5235471 
Validation loss decreased (inf --> 0.643941).  Saving model ...
Epoch: 2 cost time: 6.342706918716431
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5102346  Vali Loss: 0.3946730 Vali Accuracy: 0.8670319  Vali weighted F1: 0.8562821  Vali macro F1 0.8077805 
new best score!!!!
Validation loss decreased (0.643941 --> 0.394673).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.347419023513794
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3485211  Vali Loss: 0.2660755 Vali Accuracy: 0.9088645  Vali weighted F1: 0.9048082  Vali macro F1 0.8704582 
new best score!!!!
Validation loss decreased (0.394673 --> 0.266075).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.325793266296387
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2560906  Vali Loss: 0.2076880 Vali Accuracy: 0.9332669  Vali weighted F1: 0.9306155  Vali macro F1 0.9131515 
new best score!!!!
Validation loss decreased (0.266075 --> 0.207688).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.324227809906006
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2139796  Vali Loss: 0.2537836 Vali Accuracy: 0.9193227  Vali weighted F1: 0.9172065  Vali macro F1 0.8975883 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.314584732055664
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1839976  Vali Loss: 0.1674154 Vali Accuracy: 0.9432271  Vali weighted F1: 0.9432834  Vali macro F1 0.9257636 
new best score!!!!
Validation loss decreased (0.207688 --> 0.167415).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.343034982681274
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1637919  Vali Loss: 0.1424298 Vali Accuracy: 0.9516932  Vali weighted F1: 0.9515381  Vali macro F1 0.9335866 
new best score!!!!
Validation loss decreased (0.167415 --> 0.142430).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.337500810623169
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1527699  Vali Loss: 0.1495050 Vali Accuracy: 0.9501992  Vali weighted F1: 0.9485153  Vali macro F1 0.9323378 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.331370830535889
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1405451  Vali Loss: 0.1375647 Vali Accuracy: 0.9487052  Vali weighted F1: 0.9486368  Vali macro F1 0.9282087 
new best score!!!!
Validation loss decreased (0.142430 --> 0.137565).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.353808164596558
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1333426  Vali Loss: 0.1229432 Vali Accuracy: 0.9591633  Vali weighted F1: 0.9587717  Vali macro F1 0.9445783 
new best score!!!!
Validation loss decreased (0.137565 --> 0.122943).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.374098062515259
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1257844  Vali Loss: 0.1200438 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9632473  Vali macro F1 0.9491320 
new best score!!!!
Validation loss decreased (0.122943 --> 0.120044).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.340293884277344
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1141183  Vali Loss: 0.1089949 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9669360  Vali macro F1 0.9523518 
new best score!!!!
Validation loss decreased (0.120044 --> 0.108995).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.310231924057007
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1034548  Vali Loss: 0.1002013 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9664046  Vali macro F1 0.9506694 
new best score!!!!
Validation loss decreased (0.108995 --> 0.100201).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.319056987762451
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1014818  Vali Loss: 0.1104050 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9652063  Vali macro F1 0.9501283 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.313669204711914
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0958255  Vali Loss: 0.1425256 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9585032  Vali macro F1 0.9416276 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.326465845108032
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1019945  Vali Loss: 0.0939729 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9675755  Vali macro F1 0.9527955 
new best score!!!!
Validation loss decreased (0.100201 --> 0.093973).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.324302911758423
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0872169  Vali Loss: 0.0923448 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9724298  Vali macro F1 0.9604756 
new best score!!!!
Validation loss decreased (0.093973 --> 0.092345).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.332822322845459
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0781331  Vali Loss: 0.0916049 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9731970  Vali macro F1 0.9614044 
new best score!!!!
Validation loss decreased (0.092345 --> 0.091605).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.346253871917725
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0756651  Vali Loss: 0.0945744 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9719796  Vali macro F1 0.9596136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.343838214874268
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0748385  Vali Loss: 0.1158698 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9665867  Vali macro F1 0.9492909 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.3224852085113525
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0708073  Vali Loss: 0.0792880 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9786649  Vali macro F1 0.9676563 
new best score!!!!
Validation loss decreased (0.091605 --> 0.079288).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.328962564468384
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0644622  Vali Loss: 0.0810217 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9744745  Vali macro F1 0.9612674 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.332165956497192
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0582785  Vali Loss: 0.0859015 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9747296  Vali macro F1 0.9614151 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.341691732406616
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0552335  Vali Loss: 0.0904629 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728933  Vali macro F1 0.9605240 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.334281921386719
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0550691  Vali Loss: 0.0862005 Vali Accuracy: 0.9770916  Vali weighted F1: 0.9772849  Vali macro F1 0.9680338 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.336504697799683
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0604371  Vali Loss: 0.0791645 Vali Accuracy: 0.9770916  Vali weighted F1: 0.9771342  Vali macro F1 0.9671475 
new best score!!!!
Validation loss decreased (0.079288 --> 0.079164).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.350256681442261
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0451071  Vali Loss: 0.0838760 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9786907  Vali macro F1 0.9686887 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.337713718414307
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0416447  Vali Loss: 0.0784585 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9791583  Vali macro F1 0.9685402 
new best score!!!!
Validation loss decreased (0.079164 --> 0.078458).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.326694011688232
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0464522  Vali Loss: 0.0820527 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9752074  Vali macro F1 0.9639692 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.319698333740234
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0389808  Vali Loss: 0.0779972 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9787252  Vali macro F1 0.9672284 
new best score!!!!
Validation loss decreased (0.078458 --> 0.077997).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.336993932723999
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0446493  Vali Loss: 0.0831007 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9746292  Vali macro F1 0.9616183 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.324436902999878
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0535236  Vali Loss: 0.0723980 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806286  Vali macro F1 0.9715256 
new best score!!!!
Validation loss decreased (0.077997 --> 0.072398).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.340655088424683
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0351192  Vali Loss: 0.0717035 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9796613  Vali macro F1 0.9682696 
new best score!!!!
Validation loss decreased (0.072398 --> 0.071704).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.330830812454224
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0347159  Vali Loss: 0.0804128 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9792810  Vali macro F1 0.9707751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.869915723800659
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0351168  Vali Loss: 0.0716116 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811975  Vali macro F1 0.9720833 
new best score!!!!
Validation loss decreased (0.071704 --> 0.071612).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.344784736633301
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0276696  Vali Loss: 0.0662907 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836440  Vali macro F1 0.9756107 
new best score!!!!
Validation loss decreased (0.071612 --> 0.066291).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.33051061630249
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0282701  Vali Loss: 0.0666942 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836375  Vali macro F1 0.9756942 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.3354527950286865
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0375451  Vali Loss: 0.0649639 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831811  Vali macro F1 0.9745666 
new best score!!!!
Validation loss decreased (0.066291 --> 0.064964).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.338124752044678
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0238483  Vali Loss: 0.0717817 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825261  Vali macro F1 0.9731222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.340773582458496
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0255156  Vali Loss: 0.0667560 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836475  Vali macro F1 0.9755529 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.340024948120117
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0226800  Vali Loss: 0.0842269 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801546  Vali macro F1 0.9702228 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.325380563735962
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0281588  Vali Loss: 0.0680493 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820654  Vali macro F1 0.9732161 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.33587908744812
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0211056  Vali Loss: 0.0805097 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811687  Vali macro F1 0.9712879 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 6.354984760284424
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0150538  Vali Loss: 0.0727229 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821112  Vali macro F1 0.9729572 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.328086614608765
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0116175  Vali Loss: 0.0752387 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821387  Vali macro F1 0.9736754 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.330888748168945
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0120299  Vali Loss: 0.0720383 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821565  Vali macro F1 0.9727834 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.3478968143463135
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0110241  Vali Loss: 0.0729096 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811706  Vali macro F1 0.9711476 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.325414657592773
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0109906  Vali Loss: 0.0705340 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816629  Vali macro F1 0.9719574 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 6.331344366073608
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0099270  Vali Loss: 0.0714654 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831524  Vali macro F1 0.9745507 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.330540418624878
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0103900  Vali Loss: 0.0724843 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831524  Vali macro F1 0.9745507 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.33999490737915
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0109628  Vali Loss: 0.0720828 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831524  Vali macro F1 0.9745507 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.361243009567261
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0106417  Vali Loss: 0.0719190 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831524  Vali macro F1 0.9745507 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.3385210037231445
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0106091  Vali Loss: 0.0716334 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826666  Vali macro F1 0.9732555 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9416981  Test weighted F1: 0.9412591  Test macro F1 0.9108408 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3457019329071045
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0204813  Vali Loss: 0.0667797 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826481  Vali macro F1 0.9744165 
Validation loss decreased (inf --> 0.066780).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.323192596435547
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0173948  Vali Loss: 0.0715660 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826294  Vali macro F1 0.9753445 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.316145896911621
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0149388  Vali Loss: 0.0685396 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841231  Vali macro F1 0.9770309 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.327441215515137
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0154231  Vali Loss: 0.0697691 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831303  Vali macro F1 0.9745024 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.340161085128784
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0161440  Vali Loss: 0.0683356 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831361  Vali macro F1 0.9755276 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.355753183364868
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0130276  Vali Loss: 0.0703574 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836058  Vali macro F1 0.9753308 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.357001066207886
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0139347  Vali Loss: 0.0696717 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826323  Vali macro F1 0.9739083 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.334469556808472
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0132367  Vali Loss: 0.0719497 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816454  Vali macro F1 0.9722574 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.3417487144470215
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0133091  Vali Loss: 0.0761857 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826380  Vali macro F1 0.9731123 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.338509559631348
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0120207  Vali Loss: 0.0736512 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821401  Vali macro F1 0.9715602 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.335353136062622
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0128757  Vali Loss: 0.0738638 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816589  Vali macro F1 0.9710181 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.347541093826294
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0118471  Vali Loss: 0.0734475 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816447  Vali macro F1 0.9722836 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.335651874542236
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0119042  Vali Loss: 0.0735205 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831598  Vali macro F1 0.9740802 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.348292112350464
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0119729  Vali Loss: 0.0736195 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831598  Vali macro F1 0.9740802 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.3505613803863525
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0113656  Vali Loss: 0.0734493 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826497  Vali macro F1 0.9735693 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.361079216003418
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0107436  Vali Loss: 0.0734873 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826497  Vali macro F1 0.9735693 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9439149  Test weighted F1: 0.9431881  Test macro F1 0.9115075 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 138143
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014613 0.00018073 0.00098135 0.00123762 0.00048216 0.00061576]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.309288740158081
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0944641  Vali Loss: 0.7377090 Vali Accuracy: 0.6918049  Vali weighted F1: 0.6095513  Vali macro F1 0.3494795 
Validation loss decreased (inf --> 0.737709).  Saving model ...
Epoch: 2 cost time: 6.310830116271973
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5558624  Vali Loss: 0.4325197 Vali Accuracy: 0.8521870  Vali weighted F1: 0.8369653  Vali macro F1 0.8013377 
new best score!!!!
Validation loss decreased (0.737709 --> 0.432520).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.315843343734741
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4060666  Vali Loss: 0.3631734 Vali Accuracy: 0.8692810  Vali weighted F1: 0.8614919  Vali macro F1 0.8282659 
new best score!!!!
Validation loss decreased (0.432520 --> 0.363173).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.312641620635986
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2875106  Vali Loss: 0.2066443 Vali Accuracy: 0.9281046  Vali weighted F1: 0.9249712  Vali macro F1 0.9077123 
new best score!!!!
Validation loss decreased (0.363173 --> 0.206644).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.317444324493408
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2211192  Vali Loss: 0.1544759 Vali Accuracy: 0.9517345  Vali weighted F1: 0.9513101  Vali macro F1 0.9369902 
new best score!!!!
Validation loss decreased (0.206644 --> 0.154476).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.33887243270874
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1804412  Vali Loss: 0.1543825 Vali Accuracy: 0.9502262  Vali weighted F1: 0.9504747  Vali macro F1 0.9359018 
new best score!!!!
Validation loss decreased (0.154476 --> 0.154382).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.327163219451904
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1618883  Vali Loss: 0.1200870 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9624350  Vali macro F1 0.9491224 
new best score!!!!
Validation loss decreased (0.154382 --> 0.120087).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.311999559402466
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1436011  Vali Loss: 0.1112117 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9646126  Vali macro F1 0.9545626 
new best score!!!!
Validation loss decreased (0.120087 --> 0.111212).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.315757751464844
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1337437  Vali Loss: 0.1088529 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9631698  Vali macro F1 0.9480737 
new best score!!!!
Validation loss decreased (0.111212 --> 0.108853).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.309515953063965
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1249802  Vali Loss: 0.1129124 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9608050  Vali macro F1 0.9506162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.307822942733765
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1140364  Vali Loss: 0.1019722 Vali Accuracy: 0.9663147  Vali weighted F1: 0.9659574  Vali macro F1 0.9574030 
new best score!!!!
Validation loss decreased (0.108853 --> 0.101972).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.304790496826172
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1089586  Vali Loss: 0.1013098 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9610204  Vali macro F1 0.9509399 
new best score!!!!
Validation loss decreased (0.101972 --> 0.101310).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.307297945022583
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0964883  Vali Loss: 0.0860307 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9698350  Vali macro F1 0.9618318 
new best score!!!!
Validation loss decreased (0.101310 --> 0.086031).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.312932968139648
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0979444  Vali Loss: 0.0924663 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9707952  Vali macro F1 0.9642571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.3208043575286865
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0882795  Vali Loss: 0.0949279 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9673495  Vali macro F1 0.9581604 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.331890344619751
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0841296  Vali Loss: 0.0862334 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9706137  Vali macro F1 0.9625099 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 6.318399429321289
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0749492  Vali Loss: 0.0872331 Vali Accuracy: 0.9703369  Vali weighted F1: 0.9698407  Vali macro F1 0.9626374 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 18 cost time: 6.3162782192230225
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0790715  Vali Loss: 0.0949219 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9664186  Vali macro F1 0.9575328 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 19 cost time: 6.30728554725647
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0619524  Vali Loss: 0.0642047 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9772429  Vali macro F1 0.9705290 
new best score!!!!
Validation loss decreased (0.086031 --> 0.064205).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.3251025676727295
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0564590  Vali Loss: 0.0662284 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9756560  Vali macro F1 0.9683838 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.305248022079468
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0557562  Vali Loss: 0.0625720 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9782217  Vali macro F1 0.9715300 
new best score!!!!
Validation loss decreased (0.064205 --> 0.062572).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.309088230133057
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0538988  Vali Loss: 0.0658291 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9767050  Vali macro F1 0.9697273 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.312500238418579
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0534057  Vali Loss: 0.0621219 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9767023  Vali macro F1 0.9702762 
new best score!!!!
Validation loss decreased (0.062572 --> 0.062122).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.345010280609131
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0527636  Vali Loss: 0.0594506 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787929  Vali macro F1 0.9719188 
new best score!!!!
Validation loss decreased (0.062122 --> 0.059451).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.330037832260132
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0498706  Vali Loss: 0.0615058 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9797830  Vali macro F1 0.9731231 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.329766035079956
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0501578  Vali Loss: 0.0588291 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787678  Vali macro F1 0.9718688 
new best score!!!!
Validation loss decreased (0.059451 --> 0.058829).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.317492723464966
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0497536  Vali Loss: 0.0597323 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9792276  Vali macro F1 0.9725550 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.314101696014404
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0493289  Vali Loss: 0.0584036 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787662  Vali macro F1 0.9721736 
new best score!!!!
Validation loss decreased (0.058829 --> 0.058404).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.304329872131348
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0501663  Vali Loss: 0.0588546 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787750  Vali macro F1 0.9724006 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.311157941818237
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0488011  Vali Loss: 0.0594193 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802997  Vali macro F1 0.9747377 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.311439275741577
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0474435  Vali Loss: 0.0590846 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802939  Vali macro F1 0.9742073 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.320630073547363
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0468848  Vali Loss: 0.0594645 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787337  Vali macro F1 0.9723411 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.332533836364746
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0469504  Vali Loss: 0.0557080 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802834  Vali macro F1 0.9736739 
new best score!!!!
Validation loss decreased (0.058404 --> 0.055708).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.321321725845337
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0443374  Vali Loss: 0.0554735 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802894  Vali macro F1 0.9742043 
new best score!!!!
Validation loss decreased (0.055708 --> 0.055473).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.345090389251709
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0438719  Vali Loss: 0.0570448 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9812627  Vali macro F1 0.9751504 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.311745882034302
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0437248  Vali Loss: 0.0601037 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9791734  Vali macro F1 0.9725093 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 12.97769045829773
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0441027  Vali Loss: 0.0553003 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808192  Vali macro F1 0.9747111 
new best score!!!!
Validation loss decreased (0.055473 --> 0.055300).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.296438694000244
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0427839  Vali Loss: 0.0556012 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9797690  Vali macro F1 0.9736648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 7.088960409164429
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0419366  Vali Loss: 0.0539212 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802606  Vali macro F1 0.9741261 
new best score!!!!
Validation loss decreased (0.055300 --> 0.053921).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.299388885498047
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0426235  Vali Loss: 0.0538965 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9817931  Vali macro F1 0.9762223 
new best score!!!!
Validation loss decreased (0.053921 --> 0.053897).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.2968127727508545
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0406128  Vali Loss: 0.0539341 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802944  Vali macro F1 0.9745146 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 7.043543100357056
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0402998  Vali Loss: 0.0540569 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9807655  Vali macro F1 0.9749336 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.234070062637329
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0384302  Vali Loss: 0.0534682 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818072  Vali macro F1 0.9757330 
new best score!!!!
Validation loss decreased (0.053897 --> 0.053468).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.28581976890564
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0391748  Vali Loss: 0.0525589 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833565  Vali macro F1 0.9783916 
new best score!!!!
Validation loss decreased (0.053468 --> 0.052559).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.259328603744507
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0391669  Vali Loss: 0.0536056 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823366  Vali macro F1 0.9768318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.255853891372681
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0410093  Vali Loss: 0.0550702 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808155  Vali macro F1 0.9741690 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.2558722496032715
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0367318  Vali Loss: 0.0545710 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833362  Vali macro F1 0.9780719 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.250889301300049
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0366837  Vali Loss: 0.0565887 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9793101  Vali macro F1 0.9726968 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.250858306884766
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0379490  Vali Loss: 0.0546260 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813045  Vali macro F1 0.9752351 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.250214099884033
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0356775  Vali Loss: 0.0527581 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828312  Vali macro F1 0.9767951 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.259312152862549
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0352342  Vali Loss: 0.0525717 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.2698774337768555
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0347669  Vali Loss: 0.0525733 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.286175489425659
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0351283  Vali Loss: 0.0525725 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823291  Vali macro F1 0.9765471 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.248536825180054
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0356188  Vali Loss: 0.0522477 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823291  Vali macro F1 0.9765471 
new best score!!!!
Validation loss decreased (0.052559 --> 0.052248).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.251098871231079
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0348182  Vali Loss: 0.0517735 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
new best score!!!!
Validation loss decreased (0.052248 --> 0.051773).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.247572898864746
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0358855  Vali Loss: 0.0520594 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.24797511100769
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0349989  Vali Loss: 0.0518836 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.256437540054321
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0329394  Vali Loss: 0.0521061 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.25555157661438
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0346904  Vali Loss: 0.0524786 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.260466575622559
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0351005  Vali Loss: 0.0531643 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818174  Vali macro F1 0.9757672 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.25737738609314
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0342530  Vali Loss: 0.0527971 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818216  Vali macro F1 0.9757691 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.268089294433594
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0340695  Vali Loss: 0.0526305 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823291  Vali macro F1 0.9765471 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.246762037277222
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0341696  Vali Loss: 0.0525663 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.2478859424591064
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0353883  Vali Loss: 0.0523925 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.251225471496582
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0347005  Vali Loss: 0.0523308 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 66 cost time: 6.254374742507935
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0347174  Vali Loss: 0.0523282 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.253988265991211
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0344898  Vali Loss: 0.0523221 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.2539145946502686
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0340616  Vali Loss: 0.0523138 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.2646260261535645
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0348061  Vali Loss: 0.0523080 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.252381801605225
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0332454  Vali Loss: 0.0523160 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8681009  Test weighted F1: 0.8695079  Test macro F1 0.7700288 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.480915307998657
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0358560  Vali Loss: 0.0521087 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828487  Vali macro F1 0.9770527 
Validation loss decreased (inf --> 0.052109).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.325497388839722
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0363264  Vali Loss: 0.0545480 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808102  Vali macro F1 0.9747181 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.285399675369263
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0368253  Vali Loss: 0.0531915 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818741  Vali macro F1 0.9760810 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.312349319458008
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0360705  Vali Loss: 0.0528877 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808134  Vali macro F1 0.9739714 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.308781147003174
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0345472  Vali Loss: 0.0492739 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828386  Vali macro F1 0.9772903 
new best score!!!!
Validation loss decreased (0.052109 --> 0.049274).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.310589790344238
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0348034  Vali Loss: 0.0492836 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838545  Vali macro F1 0.9780773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.286089897155762
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0322881  Vali Loss: 0.0534493 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833570  Vali macro F1 0.9781426 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.467641353607178
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0322928  Vali Loss: 0.0489116 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858837  Vali macro F1 0.9809396 
new best score!!!!
Validation loss decreased (0.049274 --> 0.048912).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.313103199005127
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0331524  Vali Loss: 0.0536014 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9803341  Vali macro F1 0.9747412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.289656162261963
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0328553  Vali Loss: 0.0523604 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819237  Vali macro F1 0.9762227 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.295206069946289
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0312079  Vali Loss: 0.0537693 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833293  Vali macro F1 0.9783486 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.307225465774536
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0301894  Vali Loss: 0.0514051 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833462  Vali macro F1 0.9781408 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.307464122772217
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0290003  Vali Loss: 0.0536599 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9832965  Vali macro F1 0.9782982 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 6.3018951416015625
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0304193  Vali Loss: 0.0554767 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9817899  Vali macro F1 0.9757024 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.3198325634002686
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0305096  Vali Loss: 0.0569158 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9799063  Vali macro F1 0.9728274 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.3107664585113525
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0293075  Vali Loss: 0.0498143 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833680  Vali macro F1 0.9779021 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.30109429359436
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0304139  Vali Loss: 0.0498814 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834342  Vali macro F1 0.9782474 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.301022529602051
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0293520  Vali Loss: 0.0535197 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828692  Vali macro F1 0.9771271 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.291347503662109
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0275298  Vali Loss: 0.0512983 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838774  Vali macro F1 0.9781233 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.288539886474609
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0266253  Vali Loss: 0.0506055 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848900  Vali macro F1 0.9796764 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.279544115066528
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0264487  Vali Loss: 0.0496383 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838816  Vali macro F1 0.9786518 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.2663733959198
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0263583  Vali Loss: 0.0498251 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838816  Vali macro F1 0.9786518 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.2647459506988525
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0264748  Vali Loss: 0.0489921 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838816  Vali macro F1 0.9786518 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8716196  Test weighted F1: 0.8723345  Test macro F1 0.7731704 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00015004 0.00018238 0.0010989  0.00140056 0.00050813 0.00061996]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.158597230911255
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.1041961  Vali Loss: 0.7107408 Vali Accuracy: 0.7024365  Vali weighted F1: 0.6144679  Vali macro F1 0.3304060 
Validation loss decreased (inf --> 0.710741).  Saving model ...
Epoch: 2 cost time: 6.14132833480835
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5882510  Vali Loss: 0.5089616 Vali Accuracy: 0.8237429  Vali weighted F1: 0.7902964  Vali macro F1 0.7344453 
new best score!!!!
Validation loss decreased (0.710741 --> 0.508962).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.099353075027466
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.4047842  Vali Loss: 0.2856872 Vali Accuracy: 0.9009850  Vali weighted F1: 0.8973309  Vali macro F1 0.8564665 
new best score!!!!
Validation loss decreased (0.508962 --> 0.285687).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.147658586502075
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.2797470  Vali Loss: 0.2148061 Vali Accuracy: 0.9253499  Vali weighted F1: 0.9255442  Vali macro F1 0.8877139 
new best score!!!!
Validation loss decreased (0.285687 --> 0.214806).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.140523433685303
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2283043  Vali Loss: 0.1979468 Vali Accuracy: 0.9398652  Vali weighted F1: 0.9393405  Vali macro F1 0.9149473 
new best score!!!!
Validation loss decreased (0.214806 --> 0.197947).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.123874664306641
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.1784167  Vali Loss: 0.1602335 Vali Accuracy: 0.9517885  Vali weighted F1: 0.9514937  Vali macro F1 0.9255328 
new best score!!!!
Validation loss decreased (0.197947 --> 0.160233).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.099948406219482
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1617316  Vali Loss: 0.1408376 Vali Accuracy: 0.9538621  Vali weighted F1: 0.9539998  Vali macro F1 0.9365425 
new best score!!!!
Validation loss decreased (0.160233 --> 0.140838).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.13407564163208
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1392914  Vali Loss: 0.2007715 Vali Accuracy: 0.9284603  Vali weighted F1: 0.9248303  Vali macro F1 0.8998085 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.083942174911499
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1307210  Vali Loss: 0.1251746 Vali Accuracy: 0.9580093  Vali weighted F1: 0.9575893  Vali macro F1 0.9435187 
new best score!!!!
Validation loss decreased (0.140838 --> 0.125175).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.075501918792725
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1181286  Vali Loss: 0.1103620 Vali Accuracy: 0.9600829  Vali weighted F1: 0.9598535  Vali macro F1 0.9449383 
new best score!!!!
Validation loss decreased (0.125175 --> 0.110362).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.0732741355896
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1026708  Vali Loss: 0.1375700 Vali Accuracy: 0.9502333  Vali weighted F1: 0.9502450  Vali macro F1 0.9352898 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.0612335205078125
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1021435  Vali Loss: 0.1074389 Vali Accuracy: 0.9631934  Vali weighted F1: 0.9626255  Vali macro F1 0.9504112 
new best score!!!!
Validation loss decreased (0.110362 --> 0.107439).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.076711654663086
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0855211  Vali Loss: 0.0840756 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9735872  Vali macro F1 0.9611564 
new best score!!!!
Validation loss decreased (0.107439 --> 0.084076).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.066838264465332
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0807859  Vali Loss: 0.0851963 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9726189  Vali macro F1 0.9620259 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.089980602264404
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0737351  Vali Loss: 0.0903706 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9718989  Vali macro F1 0.9601839 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.073263168334961
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0706553  Vali Loss: 0.0892793 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9729967  Vali macro F1 0.9598148 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 6.0824174880981445
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0639014  Vali Loss: 0.0984621 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9691141  Vali macro F1 0.9578807 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 18 cost time: 6.080233335494995
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0602595  Vali Loss: 0.0716896 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9776444  Vali macro F1 0.9669969 
new best score!!!!
Validation loss decreased (0.084076 --> 0.071690).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.0707008838653564
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0554482  Vali Loss: 0.0816804 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9772017  Vali macro F1 0.9669094 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.078624725341797
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0564420  Vali Loss: 0.0721001 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9787684  Vali macro F1 0.9683758 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.069110870361328
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0527519  Vali Loss: 0.0753730 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9785888  Vali macro F1 0.9699434 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.063416242599487
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0521210  Vali Loss: 0.0808822 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9749830  Vali macro F1 0.9642947 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 6.064634561538696
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0545239  Vali Loss: 0.0585525 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839864  Vali macro F1 0.9748405 
new best score!!!!
Validation loss decreased (0.071690 --> 0.058553).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.0775628089904785
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0421885  Vali Loss: 0.0781671 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9785635  Vali macro F1 0.9710952 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.0978920459747314
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0423439  Vali Loss: 0.0651112 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828691  Vali macro F1 0.9750040 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.0871422290802
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0479677  Vali Loss: 0.0602715 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828575  Vali macro F1 0.9737218 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.0790627002716064
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0329880  Vali Loss: 0.0578522 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829201  Vali macro F1 0.9746338 
new best score!!!!
Validation loss decreased (0.058553 --> 0.057852).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.080746412277222
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0346244  Vali Loss: 0.0562932 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833562  Vali macro F1 0.9760167 
new best score!!!!
Validation loss decreased (0.057852 --> 0.056293).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.086372375488281
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0278346  Vali Loss: 0.0620141 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829260  Vali macro F1 0.9754803 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.062624931335449
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0288673  Vali Loss: 0.0534650 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870904  Vali macro F1 0.9786855 
new best score!!!!
Validation loss decreased (0.056293 --> 0.053465).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.068012475967407
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0302041  Vali Loss: 0.0600718 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9838625  Vali macro F1 0.9758846 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.065169095993042
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0293113  Vali Loss: 0.0615332 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9814697  Vali macro F1 0.9739714 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.071253538131714
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0338775  Vali Loss: 0.0539995 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828632  Vali macro F1 0.9750071 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.090003728866577
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0252651  Vali Loss: 0.0657132 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9807710  Vali macro F1 0.9732892 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.0901780128479
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0225534  Vali Loss: 0.0525124 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849733  Vali macro F1 0.9780825 
new best score!!!!
Validation loss decreased (0.053465 --> 0.052512).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.071282625198364
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0351306  Vali Loss: 0.1305278 Vali Accuracy: 0.9631934  Vali weighted F1: 0.9618483  Vali macro F1 0.9507441 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.062428951263428
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0273489  Vali Loss: 0.0552468 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844143  Vali macro F1 0.9763458 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.0620434284210205
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0208767  Vali Loss: 0.0456863 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901656  Vali macro F1 0.9858672 
new best score!!!!
Validation loss decreased (0.052512 --> 0.045686).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.060811996459961
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0180810  Vali Loss: 0.0601516 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9838668  Vali macro F1 0.9778583 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.061963319778442
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0213829  Vali Loss: 0.0513778 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886041  Vali macro F1 0.9821192 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.065717935562134
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0174079  Vali Loss: 0.0505947 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880740  Vali macro F1 0.9814941 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.067708730697632
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0135164  Vali Loss: 0.0590288 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849961  Vali macro F1 0.9773095 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.089718341827393
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0130135  Vali Loss: 0.0573209 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854217  Vali macro F1 0.9808640 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 6.088707685470581
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0093361  Vali Loss: 0.0508954 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870084  Vali macro F1 0.9817444 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.074147462844849
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0083209  Vali Loss: 0.0497138 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870302  Vali macro F1 0.9816269 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.078099966049194
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0070555  Vali Loss: 0.0480125 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875400  Vali macro F1 0.9822001 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.0685460567474365
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0073918  Vali Loss: 0.0490284 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880773  Vali macro F1 0.9829661 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.063927412033081
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0070110  Vali Loss: 0.0492545 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886045  Vali macro F1 0.9834543 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 6.068099021911621
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0071073  Vali Loss: 0.0493726 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886045  Vali macro F1 0.9834543 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.076911211013794
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0063102  Vali Loss: 0.0494092 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886045  Vali macro F1 0.9834543 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.0724523067474365
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0069207  Vali Loss: 0.0496211 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886045  Vali macro F1 0.9834543 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.0895771980285645
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0063821  Vali Loss: 0.0493135 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891227  Vali macro F1 0.9843121 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.0879292488098145
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0065841  Vali Loss: 0.0494568 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886059  Vali macro F1 0.9834658 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9417154  Test weighted F1: 0.9433988  Test macro F1 0.9050918 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.100330114364624
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0130744  Vali Loss: 0.0446850 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896296  Vali macro F1 0.9840400 
Validation loss decreased (inf --> 0.044685).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.051990509033203
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0111319  Vali Loss: 0.0467844 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896408  Vali macro F1 0.9839137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.051463842391968
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0094656  Vali Loss: 0.0503231 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870137  Vali macro F1 0.9822267 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.052374601364136
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0094007  Vali Loss: 0.0465229 Vali Accuracy: 0.9906687  Vali weighted F1: 0.9906772  Vali macro F1 0.9861401 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.066352367401123
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0091161  Vali Loss: 0.0484810 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891202  Vali macro F1 0.9841677 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.05396842956543
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0093942  Vali Loss: 0.0485101 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896378  Vali macro F1 0.9844195 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.08257532119751
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0081082  Vali Loss: 0.0484406 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901565  Vali macro F1 0.9852797 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.096896648406982
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0088891  Vali Loss: 0.0497019 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896330  Vali macro F1 0.9841578 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.074501037597656
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0087588  Vali Loss: 0.0538767 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880572  Vali macro F1 0.9824288 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.0630292892456055
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0078850  Vali Loss: 0.0491514 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901567  Vali macro F1 0.9853100 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.063418626785278
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0071696  Vali Loss: 0.0487008 Vali Accuracy: 0.9911871  Vali weighted F1: 0.9912002  Vali macro F1 0.9866531 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.064558029174805
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0065366  Vali Loss: 0.0487691 Vali Accuracy: 0.9911871  Vali weighted F1: 0.9912002  Vali macro F1 0.9866531 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.070858716964722
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0060926  Vali Loss: 0.0489160 Vali Accuracy: 0.9906687  Vali weighted F1: 0.9906808  Vali macro F1 0.9857935 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.076068162918091
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0068311  Vali Loss: 0.0492678 Vali Accuracy: 0.9906687  Vali weighted F1: 0.9906676  Vali macro F1 0.9858958 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.07426118850708
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0066919  Vali Loss: 0.0493575 Vali Accuracy: 0.9906687  Vali weighted F1: 0.9906808  Vali macro F1 0.9857935 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.079675912857056
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0070601  Vali Loss: 0.0493047 Vali Accuracy: 0.9906687  Vali weighted F1: 0.9906808  Vali macro F1 0.9857935 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9445642  Test weighted F1: 0.9453488  Test macro F1 0.9053782 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014912 0.00018123 0.00097087 0.00125    0.00049702 0.00061805]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.350793123245239
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0827433  Vali Loss: 0.7092768 Vali Accuracy: 0.7078880  Vali weighted F1: 0.6486437  Vali macro F1 0.3927243 
Validation loss decreased (inf --> 0.709277).  Saving model ...
Epoch: 2 cost time: 6.209195852279663
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5419170  Vali Loss: 0.3869823 Vali Accuracy: 0.8661578  Vali weighted F1: 0.8589774  Vali macro F1 0.8140059 
new best score!!!!
Validation loss decreased (0.709277 --> 0.386982).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.177228212356567
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3313270  Vali Loss: 0.2375537 Vali Accuracy: 0.9160305  Vali weighted F1: 0.9131130  Vali macro F1 0.8747341 
new best score!!!!
Validation loss decreased (0.386982 --> 0.237554).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.217872619628906
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2306470  Vali Loss: 0.1897711 Vali Accuracy: 0.9333333  Vali weighted F1: 0.9327066  Vali macro F1 0.8994526 
new best score!!!!
Validation loss decreased (0.237554 --> 0.189771).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.190052509307861
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1952545  Vali Loss: 0.2138253 Vali Accuracy: 0.9246819  Vali weighted F1: 0.9229542  Vali macro F1 0.8855557 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.19396710395813
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1788928  Vali Loss: 0.1645759 Vali Accuracy: 0.9374046  Vali weighted F1: 0.9379196  Vali macro F1 0.9038005 
new best score!!!!
Validation loss decreased (0.189771 --> 0.164576).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.199452638626099
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1490529  Vali Loss: 0.1479870 Vali Accuracy: 0.9440204  Vali weighted F1: 0.9430501  Vali macro F1 0.9081058 
new best score!!!!
Validation loss decreased (0.164576 --> 0.147987).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.217770099639893
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1375677  Vali Loss: 0.1519527 Vali Accuracy: 0.9414758  Vali weighted F1: 0.9399885  Vali macro F1 0.9065058 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.225675821304321
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1271186  Vali Loss: 0.1433955 Vali Accuracy: 0.9506361  Vali weighted F1: 0.9501329  Vali macro F1 0.9177412 
new best score!!!!
Validation loss decreased (0.147987 --> 0.143395).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.214486837387085
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1251971  Vali Loss: 0.1153859 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9596500  Vali macro F1 0.9408547 
new best score!!!!
Validation loss decreased (0.143395 --> 0.115386).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.207595109939575
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1117222  Vali Loss: 0.1073831 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9592394  Vali macro F1 0.9397871 
new best score!!!!
Validation loss decreased (0.115386 --> 0.107383).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.215142011642456
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0990658  Vali Loss: 0.1080587 Vali Accuracy: 0.9577608  Vali weighted F1: 0.9577175  Vali macro F1 0.9395221 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.186009883880615
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0894320  Vali Loss: 0.0933595 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9675620  Vali macro F1 0.9547041 
new best score!!!!
Validation loss decreased (0.107383 --> 0.093359).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.196493625640869
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0921791  Vali Loss: 0.0856974 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9681928  Vali macro F1 0.9549313 
new best score!!!!
Validation loss decreased (0.093359 --> 0.085697).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.193019866943359
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0855861  Vali Loss: 0.0854060 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9702280  Vali macro F1 0.9571259 
new best score!!!!
Validation loss decreased (0.085697 --> 0.085406).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.212080955505371
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0821148  Vali Loss: 0.0831057 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9725810  Vali macro F1 0.9619483 
new best score!!!!
Validation loss decreased (0.085406 --> 0.083106).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.208031892776489
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0662539  Vali Loss: 0.0776428 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9745377  Vali macro F1 0.9638839 
new best score!!!!
Validation loss decreased (0.083106 --> 0.077643).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.190009832382202
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0677905  Vali Loss: 0.0924524 Vali Accuracy: 0.9664122  Vali weighted F1: 0.9658267  Vali macro F1 0.9463911 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.18165922164917
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0639354  Vali Loss: 0.0688766 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9739148  Vali macro F1 0.9638595 
new best score!!!!
Validation loss decreased (0.077643 --> 0.068877).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.192584276199341
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0549780  Vali Loss: 0.0584263 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9816285  Vali macro F1 0.9715569 
new best score!!!!
Validation loss decreased (0.068877 --> 0.058426).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.200427532196045
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0542948  Vali Loss: 0.0628379 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9801105  Vali macro F1 0.9720543 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.19730806350708
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0537593  Vali Loss: 0.0753192 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9739827  Vali macro F1 0.9646906 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.1946070194244385
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0521966  Vali Loss: 0.0826159 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9737434  Vali macro F1 0.9634709 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.210098743438721
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0525302  Vali Loss: 0.0527221 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836204  Vali macro F1 0.9776146 
new best score!!!!
Validation loss decreased (0.058426 --> 0.052722).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.1938090324401855
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0475948  Vali Loss: 0.0469140 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872580  Vali macro F1 0.9819237 
new best score!!!!
Validation loss decreased (0.052722 --> 0.046914).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.214022159576416
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0399350  Vali Loss: 0.0561212 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9805061  Vali macro F1 0.9725344 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.190186023712158
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0384812  Vali Loss: 0.0934131 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691023  Vali macro F1 0.9618677 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.186327934265137
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0477719  Vali Loss: 0.0714029 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9741237  Vali macro F1 0.9662997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.188832998275757
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0595901  Vali Loss: 0.0509216 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9831252  Vali macro F1 0.9738028 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.190086603164673
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0343652  Vali Loss: 0.0849515 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9706227  Vali macro F1 0.9611798 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 6.199853420257568
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0271891  Vali Loss: 0.0434331 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851592  Vali macro F1 0.9785972 
new best score!!!!
Validation loss decreased (0.046914 --> 0.043433).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.191728115081787
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0212859  Vali Loss: 0.0421088 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867348  Vali macro F1 0.9805713 
new best score!!!!
Validation loss decreased (0.043433 --> 0.042109).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.189161777496338
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0194194  Vali Loss: 0.0413519 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882375  Vali macro F1 0.9827211 
new best score!!!!
Validation loss decreased (0.042109 --> 0.041352).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.207603693008423
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0195726  Vali Loss: 0.0434798 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867150  Vali macro F1 0.9805339 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.207070350646973
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0189427  Vali Loss: 0.0428609 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872364  Vali macro F1 0.9810816 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.196399688720703
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0191131  Vali Loss: 0.0417138 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9866923  Vali macro F1 0.9804976 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.184401750564575
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0196351  Vali Loss: 0.0418030 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877524  Vali macro F1 0.9816555 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.190657615661621
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0174427  Vali Loss: 0.0403972 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882634  Vali macro F1 0.9818476 
new best score!!!!
Validation loss decreased (0.041352 --> 0.040397).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.204610347747803
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0179473  Vali Loss: 0.0405226 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877533  Vali macro F1 0.9810128 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.2014710903167725
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0168201  Vali Loss: 0.0415899 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882551  Vali macro F1 0.9821682 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.184429168701172
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0158369  Vali Loss: 0.0422455 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877428  Vali macro F1 0.9813356 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.190070152282715
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0157936  Vali Loss: 0.0416601 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882446  Vali macro F1 0.9833253 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.218679666519165
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0155025  Vali Loss: 0.0421091 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872164  Vali macro F1 0.9817179 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 6.223825216293335
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0164507  Vali Loss: 0.0412553 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882521  Vali macro F1 0.9830613 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.195822238922119
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0157303  Vali Loss: 0.0412771 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882530  Vali macro F1 0.9821704 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.203509092330933
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0148941  Vali Loss: 0.0409320 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882530  Vali macro F1 0.9821704 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.199445486068726
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0156590  Vali Loss: 0.0410913 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877353  Vali macro F1 0.9815996 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.187730312347412
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0153065  Vali Loss: 0.0415786 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877245  Vali macro F1 0.9819268 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.190792083740234
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0154175  Vali Loss: 0.0414916 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872133  Vali macro F1 0.9810903 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.193958044052124
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0156453  Vali Loss: 0.0414644 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872133  Vali macro F1 0.9810903 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.193007469177246
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0151641  Vali Loss: 0.0414815 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872133  Vali macro F1 0.9810903 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.216139793395996
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0155124  Vali Loss: 0.0414563 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872133  Vali macro F1 0.9810903 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.228689193725586
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0158437  Vali Loss: 0.0413705 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877245  Vali macro F1 0.9819268 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8755603  Test weighted F1: 0.8763172  Test macro F1 0.8773086 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.196922540664673
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0182576  Vali Loss: 0.0421716 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9871923  Vali macro F1 0.9817006 
Validation loss decreased (inf --> 0.042172).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.181365013122559
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0174351  Vali Loss: 0.0433651 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9866821  Vali macro F1 0.9805963 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.164306879043579
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0174874  Vali Loss: 0.0439957 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9861771  Vali macro F1 0.9794374 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.162647724151611
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0151322  Vali Loss: 0.0440212 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851938  Vali macro F1 0.9789187 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.188052415847778
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0166600  Vali Loss: 0.0417591 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872205  Vali macro F1 0.9808262 
new best score!!!!
Validation loss decreased (0.042172 --> 0.041759).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.194486379623413
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0163451  Vali Loss: 0.0436394 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872162  Vali macro F1 0.9811525 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.203598976135254
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0155175  Vali Loss: 0.0440590 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9856899  Vali macro F1 0.9783125 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.210442066192627
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0148653  Vali Loss: 0.0437703 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872656  Vali macro F1 0.9807610 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.186338663101196
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0157715  Vali Loss: 0.0407986 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872307  Vali macro F1 0.9805034 
new best score!!!!
Validation loss decreased (0.041759 --> 0.040799).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.184812545776367
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0157955  Vali Loss: 0.0453275 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9861828  Vali macro F1 0.9797663 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.195707559585571
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0148572  Vali Loss: 0.0414789 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877337  Vali macro F1 0.9816204 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.194658994674683
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0129507  Vali Loss: 0.0445988 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9866881  Vali macro F1 0.9806000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.187340021133423
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0132415  Vali Loss: 0.0414983 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877337  Vali macro F1 0.9816204 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.191373109817505
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0127142  Vali Loss: 0.0435583 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872231  Vali macro F1 0.9807847 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 6.190851211547852
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0122192  Vali Loss: 0.0441358 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872162  Vali macro F1 0.9811525 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.200535535812378
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0136814  Vali Loss: 0.0421627 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867255  Vali macro F1 0.9802449 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.197795867919922
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0126391  Vali Loss: 0.0419742 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877407  Vali macro F1 0.9813380 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.2148520946502686
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0121750  Vali Loss: 0.0424948 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882422  Vali macro F1 0.9827577 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.1954615116119385
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0117072  Vali Loss: 0.0442544 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877445  Vali macro F1 0.9813324 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.194379568099976
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0103637  Vali Loss: 0.0440650 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882551  Vali macro F1 0.9821682 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.185288190841675
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0104811  Vali Loss: 0.0447864 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882551  Vali macro F1 0.9821682 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.191547870635986
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0110453  Vali Loss: 0.0450688 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877340  Vali macro F1 0.9816607 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.193098783493042
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0109150  Vali Loss: 0.0450025 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877340  Vali macro F1 0.9816607 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.189809560775757
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0110641  Vali Loss: 0.0440409 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882551  Vali macro F1 0.9821682 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8737673  Test weighted F1: 0.8739819  Test macro F1 0.8780207 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014928 0.00018298 0.000999   0.0012837  0.00052329 0.00061805]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.109270095825195
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.0751578  Vali Loss: 0.6907741 Vali Accuracy: 0.7023687  Vali weighted F1: 0.6321358  Vali macro F1 0.3683398 
Validation loss decreased (inf --> 0.690774).  Saving model ...
Epoch: 2 cost time: 6.103936433792114
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.5449755  Vali Loss: 0.3805413 Vali Accuracy: 0.8650875  Vali weighted F1: 0.8524829  Vali macro F1 0.8107379 
new best score!!!!
Validation loss decreased (0.690774 --> 0.380541).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.078976392745972
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.3595561  Vali Loss: 0.2580074 Vali Accuracy: 0.9150360  Vali weighted F1: 0.9131060  Vali macro F1 0.8892245 
new best score!!!!
Validation loss decreased (0.380541 --> 0.258007).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.095746040344238
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.2576569  Vali Loss: 0.2699241 Vali Accuracy: 0.9016478  Vali weighted F1: 0.9015529  Vali macro F1 0.8755546 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 5 cost time: 6.098047494888306
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2213239  Vali Loss: 0.1944054 Vali Accuracy: 0.9356334  Vali weighted F1: 0.9361874  Vali macro F1 0.9187127 
new best score!!!!
Validation loss decreased (0.258007 --> 0.194405).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.108875036239624
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.1806825  Vali Loss: 0.1599171 Vali Accuracy: 0.9438723  Vali weighted F1: 0.9434388  Vali macro F1 0.9291857 
new best score!!!!
Validation loss decreased (0.194405 --> 0.159917).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.101927280426025
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1652508  Vali Loss: 0.2222382 Vali Accuracy: 0.9129763  Vali weighted F1: 0.9147302  Vali macro F1 0.8839233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.102383375167847
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1586937  Vali Loss: 0.1588539 Vali Accuracy: 0.9454171  Vali weighted F1: 0.9455373  Vali macro F1 0.9290043 
new best score!!!!
Validation loss decreased (0.159917 --> 0.158854).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.097489595413208
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1379375  Vali Loss: 0.1364262 Vali Accuracy: 0.9531411  Vali weighted F1: 0.9529661  Vali macro F1 0.9382753 
new best score!!!!
Validation loss decreased (0.158854 --> 0.136426).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.12689208984375
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1316575  Vali Loss: 0.1373188 Vali Accuracy: 0.9515963  Vali weighted F1: 0.9510272  Vali macro F1 0.9366427 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.094238996505737
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1176991  Vali Loss: 0.1451364 Vali Accuracy: 0.9510814  Vali weighted F1: 0.9496608  Vali macro F1 0.9376449 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.091949462890625
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1099906  Vali Loss: 0.1118424 Vali Accuracy: 0.9572606  Vali weighted F1: 0.9575041  Vali macro F1 0.9453843 
new best score!!!!
Validation loss decreased (0.136426 --> 0.111842).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.108157157897949
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1070335  Vali Loss: 0.1086508 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9643987  Vali macro F1 0.9533669 
new best score!!!!
Validation loss decreased (0.111842 --> 0.108651).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.104109764099121
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1038601  Vali Loss: 0.1250335 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9595227  Vali macro F1 0.9512762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.104702472686768
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0957813  Vali Loss: 0.1072896 Vali Accuracy: 0.9603502  Vali weighted F1: 0.9606995  Vali macro F1 0.9488574 
new best score!!!!
Validation loss decreased (0.108651 --> 0.107290).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.095936059951782
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0872312  Vali Loss: 0.1015152 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9642344  Vali macro F1 0.9531200 
new best score!!!!
Validation loss decreased (0.107290 --> 0.101515).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.088209390640259
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0845295  Vali Loss: 0.1059564 Vali Accuracy: 0.9624099  Vali weighted F1: 0.9623574  Vali macro F1 0.9504408 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.1142258644104
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0789689  Vali Loss: 0.1145993 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9578715  Vali macro F1 0.9455879 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.113520383834839
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0846478  Vali Loss: 0.0999151 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9700844  Vali macro F1 0.9604074 
new best score!!!!
Validation loss decreased (0.101515 --> 0.099915).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.098806858062744
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0700140  Vali Loss: 0.0920272 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9712573  Vali macro F1 0.9637246 
new best score!!!!
Validation loss decreased (0.099915 --> 0.092027).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.100780010223389
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0755482  Vali Loss: 0.1009737 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9645359  Vali macro F1 0.9537489 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.098904371261597
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0665076  Vali Loss: 0.0830227 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9711887  Vali macro F1 0.9630406 
new best score!!!!
Validation loss decreased (0.092027 --> 0.083023).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.104615688323975
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0619034  Vali Loss: 0.1003183 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9693935  Vali macro F1 0.9631113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.093859672546387
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0598584  Vali Loss: 0.1194104 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9598270  Vali macro F1 0.9482929 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.105274438858032
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0544167  Vali Loss: 0.0928353 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9697585  Vali macro F1 0.9586523 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.107648849487305
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0625537  Vali Loss: 0.0823362 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9698895  Vali macro F1 0.9605517 
new best score!!!!
Validation loss decreased (0.083023 --> 0.082336).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.1222851276397705
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0487676  Vali Loss: 0.0819672 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9735703  Vali macro F1 0.9641826 
new best score!!!!
Validation loss decreased (0.082336 --> 0.081967).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.124924659729004
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0511156  Vali Loss: 0.0822410 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9722883  Vali macro F1 0.9612339 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.097670555114746
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0445852  Vali Loss: 0.0781588 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9727197  Vali macro F1 0.9631419 
new best score!!!!
Validation loss decreased (0.081967 --> 0.078159).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.088694095611572
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0475615  Vali Loss: 0.0794458 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753192  Vali macro F1 0.9656348 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.087741374969482
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0555995  Vali Loss: 0.0730327 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9754643  Vali macro F1 0.9683144 
new best score!!!!
Validation loss decreased (0.078159 --> 0.073033).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.099866151809692
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0400159  Vali Loss: 0.0727467 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9762340  Vali macro F1 0.9682243 
new best score!!!!
Validation loss decreased (0.073033 --> 0.072747).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.098863124847412
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0337739  Vali Loss: 0.0739883 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9736368  Vali macro F1 0.9641083 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.094811677932739
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0366249  Vali Loss: 0.0661681 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9778179  Vali macro F1 0.9708516 
new best score!!!!
Validation loss decreased (0.072747 --> 0.066168).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.113639831542969
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0387786  Vali Loss: 0.0872386 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9740150  Vali macro F1 0.9687532 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.123230695724487
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0447663  Vali Loss: 0.0721398 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9759220  Vali macro F1 0.9707309 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.109768390655518
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0313025  Vali Loss: 0.0691609 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9786443  Vali macro F1 0.9739214 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.107141733169556
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0280878  Vali Loss: 0.0637527 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9813947  Vali macro F1 0.9757142 
new best score!!!!
Validation loss decreased (0.066168 --> 0.063753).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.09632682800293
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0301557  Vali Loss: 0.0728051 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9760543  Vali macro F1 0.9704808 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.09763503074646
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0234985  Vali Loss: 0.0622464 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814895  Vali macro F1 0.9768073 
new best score!!!!
Validation loss decreased (0.063753 --> 0.062246).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.10770845413208
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0230302  Vali Loss: 0.0627375 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814938  Vali macro F1 0.9770433 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.107007265090942
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0244895  Vali Loss: 0.0912646 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9715291  Vali macro F1 0.9648285 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.105320930480957
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0287109  Vali Loss: 0.0644374 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789348  Vali macro F1 0.9738579 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.123579025268555
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0248757  Vali Loss: 0.0647722 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784470  Vali macro F1 0.9729007 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.110978126525879
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0298465  Vali Loss: 0.1026110 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9688304  Vali macro F1 0.9591331 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 6.099823713302612
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0225316  Vali Loss: 0.0627919 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804195  Vali macro F1 0.9754559 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.094891309738159
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0136851  Vali Loss: 0.0603998 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814399  Vali macro F1 0.9767987 
new best score!!!!
Validation loss decreased (0.062246 --> 0.060400).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.091216564178467
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0126480  Vali Loss: 0.0597887 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819801  Vali macro F1 0.9771233 
new best score!!!!
Validation loss decreased (0.060400 --> 0.059789).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.095360040664673
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0119644  Vali Loss: 0.0602923 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799170  Vali macro F1 0.9742625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.098294734954834
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0103967  Vali Loss: 0.0552392 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835409  Vali macro F1 0.9793151 
new best score!!!!
Validation loss decreased (0.059789 --> 0.055239).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.087263584136963
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0103863  Vali Loss: 0.0565285 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835317  Vali macro F1 0.9789280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.093351364135742
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0103975  Vali Loss: 0.0565709 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840622  Vali macro F1 0.9794534 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.1032609939575195
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0091933  Vali Loss: 0.0575703 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835160  Vali macro F1 0.9792624 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.117360353469849
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0093405  Vali Loss: 0.0566030 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840450  Vali macro F1 0.9797706 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.0939929485321045
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0091618  Vali Loss: 0.0554088 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845887  Vali macro F1 0.9799722 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 6.089435577392578
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0087542  Vali Loss: 0.0559155 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845806  Vali macro F1 0.9795535 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.103016138076782
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0088658  Vali Loss: 0.0558346 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850912  Vali macro F1 0.9804217 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.0898120403289795
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0090405  Vali Loss: 0.0566616 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850995  Vali macro F1 0.9808406 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.095019340515137
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0088222  Vali Loss: 0.0560909 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845852  Vali macro F1 0.9799521 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.0897369384765625
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0082666  Vali Loss: 0.0558409 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845852  Vali macro F1 0.9799521 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.090776205062866
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0086690  Vali Loss: 0.0558753 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845852  Vali macro F1 0.9799521 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.11017370223999
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0087028  Vali Loss: 0.0559307 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845852  Vali macro F1 0.9799521 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.1168529987335205
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0089226  Vali Loss: 0.0558665 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845852  Vali macro F1 0.9799521 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.100970268249512
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0085074  Vali Loss: 0.0559813 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845852  Vali macro F1 0.9799521 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.091947317123413
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0087609  Vali Loss: 0.0560262 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845852  Vali macro F1 0.9799521 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9563911  Test weighted F1: 0.9539204  Test macro F1 0.9338155 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.105121612548828
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0118027  Vali Loss: 0.0563150 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840156  Vali macro F1 0.9798604 
Validation loss decreased (inf --> 0.056315).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.084347724914551
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0108637  Vali Loss: 0.0663874 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819398  Vali macro F1 0.9767788 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.06775426864624
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0102242  Vali Loss: 0.0563489 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845246  Vali macro F1 0.9803212 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.081240177154541
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0087787  Vali Loss: 0.0585109 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824877  Vali macro F1 0.9775008 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.118181943893433
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0095876  Vali Loss: 0.0611471 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824799  Vali macro F1 0.9771148 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.13200044631958
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0088025  Vali Loss: 0.0549595 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840156  Vali macro F1 0.9798604 
new best score!!!!
Validation loss decreased (0.056315 --> 0.054960).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.09123682975769
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0071118  Vali Loss: 0.0578013 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850892  Vali macro F1 0.9805281 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.092421293258667
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0078841  Vali Loss: 0.0586017 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840411  Vali macro F1 0.9798894 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.097997188568115
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0081474  Vali Loss: 0.0618238 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829458  Vali macro F1 0.9783608 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.097437143325806
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0086695  Vali Loss: 0.0613320 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850813  Vali macro F1 0.9813104 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.11087965965271
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0072841  Vali Loss: 0.0605692 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850746  Vali macro F1 0.9808945 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 12 cost time: 6.104609489440918
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0069928  Vali Loss: 0.0588115 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856015  Vali macro F1 0.9814287 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.117302656173706
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0068733  Vali Loss: 0.0582420 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845469  Vali macro F1 0.9803881 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.1224517822265625
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0063282  Vali Loss: 0.0593732 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850746  Vali macro F1 0.9808945 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.099484920501709
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0068170  Vali Loss: 0.0570768 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866266  Vali macro F1 0.9831744 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.0970399379730225
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0062535  Vali Loss: 0.0575143 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850823  Vali macro F1 0.9812991 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 17 cost time: 6.0877580642700195
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0063810  Vali Loss: 0.0575016 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850823  Vali macro F1 0.9812991 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.099419832229614
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0065504  Vali Loss: 0.0573944 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850823  Vali macro F1 0.9812991 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.095547914505005
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0065664  Vali Loss: 0.0575315 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855883  Vali macro F1 0.9817686 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.093076705932617
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0062615  Vali Loss: 0.0575118 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855883  Vali macro F1 0.9817686 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.085480690002441
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0063584  Vali Loss: 0.0573501 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855883  Vali macro F1 0.9817686 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9577716  Test weighted F1: 0.9554095  Test macro F1 0.9351404 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014959 0.00018678 0.00138313 0.00145985 0.00052882 0.00064809]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.910456418991089
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.0978909  Vali Loss: 0.6873462 Vali Accuracy: 0.7190832  Vali weighted F1: 0.6416570  Vali macro F1 0.3535263 
Validation loss decreased (inf --> 0.687346).  Saving model ...
Epoch: 2 cost time: 5.890110015869141
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5385828  Vali Loss: 0.4230853 Vali Accuracy: 0.8523454  Vali weighted F1: 0.8347370  Vali macro F1 0.7995944 
new best score!!!!
Validation loss decreased (0.687346 --> 0.423085).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.876202583312988
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.3808979  Vali Loss: 0.3318841 Vali Accuracy: 0.8891258  Vali weighted F1: 0.8841708  Vali macro F1 0.8627602 
new best score!!!!
Validation loss decreased (0.423085 --> 0.331884).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.89478063583374
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.2930407  Vali Loss: 0.2496920 Vali Accuracy: 0.9173774  Vali weighted F1: 0.9138600  Vali macro F1 0.8960909 
new best score!!!!
Validation loss decreased (0.331884 --> 0.249692).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.899697780609131
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2249935  Vali Loss: 0.1966693 Vali Accuracy: 0.9371002  Vali weighted F1: 0.9357123  Vali macro F1 0.9200312 
new best score!!!!
Validation loss decreased (0.249692 --> 0.196669).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.907232761383057
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.1823209  Vali Loss: 0.1536017 Vali Accuracy: 0.9472281  Vali weighted F1: 0.9469296  Vali macro F1 0.9349943 
new best score!!!!
Validation loss decreased (0.196669 --> 0.153602).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.890537738800049
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1680254  Vali Loss: 0.1606148 Vali Accuracy: 0.9450959  Vali weighted F1: 0.9445548  Vali macro F1 0.9306320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.873867750167847
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1447801  Vali Loss: 0.1410840 Vali Accuracy: 0.9493603  Vali weighted F1: 0.9496456  Vali macro F1 0.9384179 
new best score!!!!
Validation loss decreased (0.153602 --> 0.141084).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.899535179138184
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1312614  Vali Loss: 0.1186747 Vali Accuracy: 0.9621535  Vali weighted F1: 0.9617868  Vali macro F1 0.9546596 
new best score!!!!
Validation loss decreased (0.141084 --> 0.118675).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.9091637134552
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1188083  Vali Loss: 0.1296103 Vali Accuracy: 0.9600213  Vali weighted F1: 0.9596120  Vali macro F1 0.9504046 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.8751304149627686
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1071403  Vali Loss: 0.1061760 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9597686  Vali macro F1 0.9488554 
new best score!!!!
Validation loss decreased (0.118675 --> 0.106176).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.881855249404907
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1007275  Vali Loss: 0.0997971 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9672914  Vali macro F1 0.9594073 
new best score!!!!
Validation loss decreased (0.106176 --> 0.099797).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.446410179138184
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0981277  Vali Loss: 0.1064671 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9660596  Vali macro F1 0.9581258 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.881703853607178
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0913261  Vali Loss: 0.1051471 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9654227  Vali macro F1 0.9559058 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.887789011001587
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0868058  Vali Loss: 0.0871208 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9730531  Vali macro F1 0.9665781 
new best score!!!!
Validation loss decreased (0.099797 --> 0.087121).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.885396480560303
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0805951  Vali Loss: 0.0973079 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9664491  Vali macro F1 0.9599016 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.892192840576172
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0792177  Vali Loss: 0.0932214 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9679522  Vali macro F1 0.9599721 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.913405895233154
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0770991  Vali Loss: 0.0888693 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9708620  Vali macro F1 0.9658262 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.897430181503296
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0671394  Vali Loss: 0.0847116 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9731352  Vali macro F1 0.9670817 
new best score!!!!
Validation loss decreased (0.087121 --> 0.084712).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.899781227111816
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0709093  Vali Loss: 0.0831820 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9710169  Vali macro F1 0.9630989 
new best score!!!!
Validation loss decreased (0.084712 --> 0.083182).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.891241550445557
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0642595  Vali Loss: 0.0756875 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9779791  Vali macro F1 0.9722046 
new best score!!!!
Validation loss decreased (0.083182 --> 0.075688).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.89622163772583
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0653336  Vali Loss: 0.0815022 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9741332  Vali macro F1 0.9686392 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.881750822067261
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0542775  Vali Loss: 0.0791621 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9744237  Vali macro F1 0.9687813 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.881743431091309
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0538056  Vali Loss: 0.0768886 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9723863  Vali macro F1 0.9642504 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.881814241409302
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0591691  Vali Loss: 0.0872917 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9675526  Vali macro F1 0.9581553 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.893738746643066
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0449018  Vali Loss: 0.0769662 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791255  Vali macro F1 0.9749643 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 5.912606239318848
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0351771  Vali Loss: 0.0649816 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802310  Vali macro F1 0.9740365 
new best score!!!!
Validation loss decreased (0.075688 --> 0.064982).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.895053863525391
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0341864  Vali Loss: 0.0668164 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807450  Vali macro F1 0.9748599 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.876433849334717
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0306122  Vali Loss: 0.0667407 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807349  Vali macro F1 0.9762051 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.88239860534668
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0314402  Vali Loss: 0.0666432 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796904  Vali macro F1 0.9742119 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.879397630691528
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0304264  Vali Loss: 0.0658444 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781144  Vali macro F1 0.9726326 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.88721489906311
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0309441  Vali Loss: 0.0681845 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796835  Vali macro F1 0.9748464 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 5.893056631088257
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0287552  Vali Loss: 0.0678928 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791796  Vali macro F1 0.9740320 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.886719226837158
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0295794  Vali Loss: 0.0678629 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796685  Vali macro F1 0.9748341 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.88936448097229
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0285034  Vali Loss: 0.0670449 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797077  Vali macro F1 0.9748678 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.889735698699951
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0290213  Vali Loss: 0.0675780 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796685  Vali macro F1 0.9748341 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.918775796890259
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0292843  Vali Loss: 0.0676207 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796685  Vali macro F1 0.9748341 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 38 cost time: 5.897491931915283
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0279779  Vali Loss: 0.0676860 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796685  Vali macro F1 0.9748341 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.895101547241211
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0287005  Vali Loss: 0.0675725 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796685  Vali macro F1 0.9748341 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.886704444885254
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0295345  Vali Loss: 0.0676027 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796685  Vali macro F1 0.9748341 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.898250341415405
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0275485  Vali Loss: 0.0676195 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796685  Vali macro F1 0.9748341 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.89688777923584
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0283268  Vali Loss: 0.0677299 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796685  Vali macro F1 0.9748341 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9005766  Test weighted F1: 0.9047448  Test macro F1 0.8663515 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.913869857788086
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0339410  Vali Loss: 0.0664138 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791589  Vali macro F1 0.9723513 
Validation loss decreased (inf --> 0.066414).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.890631675720215
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0321503  Vali Loss: 0.0709857 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9785948  Vali macro F1 0.9729017 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.900219917297363
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0313320  Vali Loss: 0.0657745 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791244  Vali macro F1 0.9739849 
new best score!!!!
Validation loss decreased (0.066414 --> 0.065775).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 5.886202573776245
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0312943  Vali Loss: 0.0659450 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797627  Vali macro F1 0.9741964 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 5.887281656265259
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0319778  Vali Loss: 0.0650434 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802751  Vali macro F1 0.9746574 
new best score!!!!
Validation loss decreased (0.065775 --> 0.065043).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 5.878712892532349
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0284006  Vali Loss: 0.0653573 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802374  Vali macro F1 0.9746873 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.901257514953613
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0289071  Vali Loss: 0.0671779 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9780768  Vali macro F1 0.9729035 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.912542343139648
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0284513  Vali Loss: 0.0706969 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801951  Vali macro F1 0.9759191 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.891157865524292
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0285324  Vali Loss: 0.0702972 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9785474  Vali macro F1 0.9733597 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.9119908809661865
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0265245  Vali Loss: 0.0664140 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807652  Vali macro F1 0.9773779 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 5.912269592285156
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0265359  Vali Loss: 0.0717828 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796459  Vali macro F1 0.9739630 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 5.905643463134766
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0250365  Vali Loss: 0.0661919 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802262  Vali macro F1 0.9762193 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 5.8972249031066895
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0250957  Vali Loss: 0.0691928 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9785585  Vali macro F1 0.9720406 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.904923677444458
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0269333  Vali Loss: 0.0655397 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807808  Vali macro F1 0.9756746 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 5.896755695343018
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0248730  Vali Loss: 0.0620486 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813361  Vali macro F1 0.9776858 
new best score!!!!
Validation loss decreased (0.065043 --> 0.062049).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 5.907981872558594
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0235215  Vali Loss: 0.0648644 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807610  Vali macro F1 0.9753738 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 5.911295175552368
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0224903  Vali Loss: 0.0654094 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802482  Vali macro F1 0.9748840 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 5.897840738296509
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0220783  Vali Loss: 0.0653431 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797308  Vali macro F1 0.9731367 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 5.915261507034302
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0224171  Vali Loss: 0.0647196 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791177  Vali macro F1 0.9728761 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 5.932557582855225
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0208998  Vali Loss: 0.0619936 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802698  Vali macro F1 0.9760011 
new best score!!!!
Validation loss decreased (0.062049 --> 0.061994).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 5.920815706253052
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0224381  Vali Loss: 0.0618847 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824002  Vali macro F1 0.9787173 
new best score!!!!
Validation loss decreased (0.061994 --> 0.061885).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 5.904299020767212
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0223572  Vali Loss: 0.0650364 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823944  Vali macro F1 0.9789619 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 5.887670516967773
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0228115  Vali Loss: 0.0656991 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791712  Vali macro F1 0.9742329 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 5.896695613861084
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0198623  Vali Loss: 0.0630512 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829455  Vali macro F1 0.9793159 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 5.896566390991211
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0197932  Vali Loss: 0.0628186 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808210  Vali macro F1 0.9759652 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 5.903339862823486
Fine Tuning VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0231713  Vali Loss: 0.0628153 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813414  Vali macro F1 0.9770423 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 5.897266864776611
Fine Tuning VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0178251  Vali Loss: 0.0646058 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813414  Vali macro F1 0.9770423 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 5.920961618423462
Fine Tuning VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0181614  Vali Loss: 0.0651408 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813232  Vali macro F1 0.9773399 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 5.923254728317261
Fine Tuning VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0182972  Vali Loss: 0.0646994 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807936  Vali macro F1 0.9765019 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 5.891551971435547
Fine Tuning VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0187985  Vali Loss: 0.0638972 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818523  Vali macro F1 0.9781767 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 5.900482416152954
Fine Tuning VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0180769  Vali Loss: 0.0655618 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807751  Vali macro F1 0.9767360 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 5.9017415046691895
Fine Tuning VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0185189  Vali Loss: 0.0653874 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807936  Vali macro F1 0.9765019 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 5.896996974945068
Fine Tuning VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0177359  Vali Loss: 0.0653961 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807936  Vali macro F1 0.9765019 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 5.91510534286499
Fine Tuning VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0180147  Vali Loss: 0.0653906 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807936  Vali macro F1 0.9765019 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 5.909428119659424
Fine Tuning VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0184285  Vali Loss: 0.0653896 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807936  Vali macro F1 0.9765019 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 5.901652097702026
Fine Tuning VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0178857  Vali Loss: 0.0655553 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807751  Vali macro F1 0.9767360 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8942345  Test weighted F1: 0.8999267  Test macro F1 0.8596293 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001419  0.00018467 0.00096712 0.00125    0.0005291  0.00064599]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.21144962310791
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0799726  Vali Loss: 0.6702664 Vali Accuracy: 0.7168950  Vali weighted F1: 0.6408611  Vali macro F1 0.3676380 
Validation loss decreased (inf --> 0.670266).  Saving model ...
Epoch: 2 cost time: 6.187751054763794
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5305376  Vali Loss: 0.3462019 Vali Accuracy: 0.8777270  Vali weighted F1: 0.8646067  Vali macro F1 0.8241013 
new best score!!!!
Validation loss decreased (0.670266 --> 0.346202).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.174788236618042
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3242979  Vali Loss: 0.2081949 Vali Accuracy: 0.9340436  Vali weighted F1: 0.9310160  Vali macro F1 0.9058447 
new best score!!!!
Validation loss decreased (0.346202 --> 0.208195).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.171648979187012
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2265748  Vali Loss: 0.1610637 Vali Accuracy: 0.9477423  Vali weighted F1: 0.9472657  Vali macro F1 0.9249183 
new best score!!!!
Validation loss decreased (0.208195 --> 0.161064).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.188042163848877
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1917993  Vali Loss: 0.1422934 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9537565  Vali macro F1 0.9368660 
new best score!!!!
Validation loss decreased (0.161064 --> 0.142293).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.1858930587768555
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1641175  Vali Loss: 0.1307250 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9556097  Vali macro F1 0.9382426 
new best score!!!!
Validation loss decreased (0.142293 --> 0.130725).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.185377597808838
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1508256  Vali Loss: 0.1243597 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9575584  Vali macro F1 0.9408958 
new best score!!!!
Validation loss decreased (0.130725 --> 0.124360).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.214895486831665
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1339030  Vali Loss: 0.1170786 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9622648  Vali macro F1 0.9483961 
new best score!!!!
Validation loss decreased (0.124360 --> 0.117079).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.2112040519714355
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1233982  Vali Loss: 0.1244802 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9578147  Vali macro F1 0.9403223 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.213234901428223
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1137140  Vali Loss: 0.1070719 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9622379  Vali macro F1 0.9472860 
new best score!!!!
Validation loss decreased (0.117079 --> 0.107072).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.198803186416626
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1147624  Vali Loss: 0.1139024 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9647931  Vali macro F1 0.9492561 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.1933324337005615
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0970423  Vali Loss: 0.1037639 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9649518  Vali macro F1 0.9507679 
new best score!!!!
Validation loss decreased (0.107072 --> 0.103764).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.1970131397247314
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0963011  Vali Loss: 0.0907841 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9697405  Vali macro F1 0.9576122 
new best score!!!!
Validation loss decreased (0.103764 --> 0.090784).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1903979778289795
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0837652  Vali Loss: 0.1065939 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625602  Vali macro F1 0.9477287 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.194763660430908
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0872899  Vali Loss: 0.0780416 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9745512  Vali macro F1 0.9639219 
new best score!!!!
Validation loss decreased (0.090784 --> 0.078042).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.198338508605957
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0793023  Vali Loss: 0.0753246 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9735634  Vali macro F1 0.9623128 
new best score!!!!
Validation loss decreased (0.078042 --> 0.075325).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.200409412384033
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0707685  Vali Loss: 0.0802382 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9694394  Vali macro F1 0.9555351 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.199036359786987
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0686112  Vali Loss: 0.0722259 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9734232  Vali macro F1 0.9616649 
new best score!!!!
Validation loss decreased (0.075325 --> 0.072226).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.210944414138794
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0598341  Vali Loss: 0.0714110 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9739258  Vali macro F1 0.9625551 
new best score!!!!
Validation loss decreased (0.072226 --> 0.071411).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.194425344467163
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0612434  Vali Loss: 0.0825762 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9721240  Vali macro F1 0.9631828 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.19580864906311
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0552984  Vali Loss: 0.0888556 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9680218  Vali macro F1 0.9569938 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.196266174316406
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0698042  Vali Loss: 0.0715315 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9764098  Vali macro F1 0.9684347 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.1975321769714355
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0471655  Vali Loss: 0.0689443 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9764121  Vali macro F1 0.9670693 
new best score!!!!
Validation loss decreased (0.071411 --> 0.068944).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.200118780136108
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0470954  Vali Loss: 0.0687087 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781699  Vali macro F1 0.9713171 
new best score!!!!
Validation loss decreased (0.068944 --> 0.068709).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.191318988800049
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0359802  Vali Loss: 0.0596522 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801820  Vali macro F1 0.9734779 
new best score!!!!
Validation loss decreased (0.068709 --> 0.059652).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.205216884613037
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0375876  Vali Loss: 0.0519021 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9836956  Vali macro F1 0.9759439 
new best score!!!!
Validation loss decreased (0.059652 --> 0.051902).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.208251714706421
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0337123  Vali Loss: 0.0509672 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9841796  Vali macro F1 0.9780420 
new best score!!!!
Validation loss decreased (0.051902 --> 0.050967).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.207759141921997
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0344717  Vali Loss: 0.0705473 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9755771  Vali macro F1 0.9655432 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.194671392440796
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0346716  Vali Loss: 0.1050298 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9706431  Vali macro F1 0.9621158 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.190903186798096
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0358632  Vali Loss: 0.0567391 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817025  Vali macro F1 0.9723917 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.183945655822754
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0296869  Vali Loss: 0.0581390 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838057  Vali macro F1 0.9776387 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.185804128646851
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0282374  Vali Loss: 0.0785024 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9760089  Vali macro F1 0.9678985 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 6.17180871963501
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0213124  Vali Loss: 0.0497543 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862279  Vali macro F1 0.9807990 
new best score!!!!
Validation loss decreased (0.050967 --> 0.049754).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.1836628913879395
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0162999  Vali Loss: 0.0478837 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872357  Vali macro F1 0.9818560 
new best score!!!!
Validation loss decreased (0.049754 --> 0.047884).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.205634355545044
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0163388  Vali Loss: 0.0468361 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872490  Vali macro F1 0.9818603 
new best score!!!!
Validation loss decreased (0.047884 --> 0.046836).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.198038339614868
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0151750  Vali Loss: 0.0477726 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867360  Vali macro F1 0.9810142 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.214031934738159
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0142237  Vali Loss: 0.0460330 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862343  Vali macro F1 0.9799146 
new best score!!!!
Validation loss decreased (0.046836 --> 0.046033).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.1991682052612305
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0139403  Vali Loss: 0.0447972 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867573  Vali macro F1 0.9807739 
new best score!!!!
Validation loss decreased (0.046033 --> 0.044797).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.188709259033203
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0141918  Vali Loss: 0.0461612 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872609  Vali macro F1 0.9818753 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.186393737792969
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0132852  Vali Loss: 0.0482773 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867512  Vali macro F1 0.9807536 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.187869310379028
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0140073  Vali Loss: 0.0470080 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867780  Vali macro F1 0.9816857 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.188701391220093
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0140326  Vali Loss: 0.0493437 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9856900  Vali macro F1 0.9798775 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.18751335144043
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0126962  Vali Loss: 0.0477503 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857734  Vali macro F1 0.9803344 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 6.188313961029053
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0130503  Vali Loss: 0.0471430 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857318  Vali macro F1 0.9799602 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.200472831726074
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0122076  Vali Loss: 0.0482050 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857393  Vali macro F1 0.9796703 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.199904441833496
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0128097  Vali Loss: 0.0465971 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857572  Vali macro F1 0.9800035 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.1793718338012695
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0123559  Vali Loss: 0.0463716 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862599  Vali macro F1 0.9811331 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.181668043136597
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0126329  Vali Loss: 0.0462367 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867376  Vali macro F1 0.9813157 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.18365478515625
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0120676  Vali Loss: 0.0462943 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867376  Vali macro F1 0.9813157 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.184021234512329
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0123495  Vali Loss: 0.0463016 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867376  Vali macro F1 0.9813157 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.182386159896851
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0122990  Vali Loss: 0.0463395 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872501  Vali macro F1 0.9821611 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.183131694793701
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0120701  Vali Loss: 0.0463422 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872501  Vali macro F1 0.9821611 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.179076671600342
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0126463  Vali Loss: 0.0463696 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872501  Vali macro F1 0.9821611 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9422688  Test weighted F1: 0.9415822  Test macro F1 0.9436791 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.227583885192871
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0151338  Vali Loss: 0.0458055 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867445  Vali macro F1 0.9810438 
Validation loss decreased (inf --> 0.045805).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.161468982696533
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0137795  Vali Loss: 0.0464494 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857323  Vali macro F1 0.9796822 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.170916795730591
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0150448  Vali Loss: 0.0473491 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9846840  Vali macro F1 0.9782440 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.159635305404663
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0134788  Vali Loss: 0.0463338 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9826795  Vali macro F1 0.9752256 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.172692060470581
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0143100  Vali Loss: 0.0558640 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9846863  Vali macro F1 0.9790855 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.184147119522095
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0128006  Vali Loss: 0.0504762 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852066  Vali macro F1 0.9799541 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.185941696166992
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0127418  Vali Loss: 0.0554994 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9836916  Vali macro F1 0.9777581 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.185396909713745
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0132800  Vali Loss: 0.0480108 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852051  Vali macro F1 0.9805681 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.200523614883423
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0115502  Vali Loss: 0.0513955 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842045  Vali macro F1 0.9786038 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.194755792617798
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0121402  Vali Loss: 0.0475505 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857034  Vali macro F1 0.9802282 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.220276117324829
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0109049  Vali Loss: 0.0497157 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842111  Vali macro F1 0.9789474 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.181506633758545
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0107503  Vali Loss: 0.0497741 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852276  Vali macro F1 0.9800335 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.185542821884155
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0109744  Vali Loss: 0.0502371 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857397  Vali macro F1 0.9808798 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.186687231063843
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0108097  Vali Loss: 0.0489032 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847231  Vali macro F1 0.9797935 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.179157495498657
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0106633  Vali Loss: 0.0496474 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847213  Vali macro F1 0.9797888 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.199286222457886
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0106994  Vali Loss: 0.0493313 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842090  Vali macro F1 0.9789422 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9403383  Test weighted F1: 0.9396285  Test macro F1 0.9410261 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014207 0.00017835 0.00097371 0.0011976  0.0004817  0.0006035 ]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.377460479736328
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.0843568  Vali Loss: 0.6665848 Vali Accuracy: 0.7720770  Vali weighted F1: 0.7205518  Vali macro F1 0.5177395 
Validation loss decreased (inf --> 0.666585).  Saving model ...
Epoch: 2 cost time: 6.355881929397583
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.5404164  Vali Loss: 0.3648241 Vali Accuracy: 0.8712383  Vali weighted F1: 0.8669821  Vali macro F1 0.8310047 
new best score!!!!
Validation loss decreased (0.666585 --> 0.364824).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.350134611129761
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3034879  Vali Loss: 0.2080058 Vali Accuracy: 0.9289591  Vali weighted F1: 0.9273297  Vali macro F1 0.9017369 
new best score!!!!
Validation loss decreased (0.364824 --> 0.208006).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.359618186950684
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2215013  Vali Loss: 0.1942530 Vali Accuracy: 0.9269857  Vali weighted F1: 0.9237618  Vali macro F1 0.8976809 
new best score!!!!
Validation loss decreased (0.208006 --> 0.194253).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.350102186203003
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.1798731  Vali Loss: 0.1419877 Vali Accuracy: 0.9506660  Vali weighted F1: 0.9508949  Vali macro F1 0.9294027 
new best score!!!!
Validation loss decreased (0.194253 --> 0.141988).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.360885143280029
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1597722  Vali Loss: 0.1311215 Vali Accuracy: 0.9541194  Vali weighted F1: 0.9540903  Vali macro F1 0.9385124 
new best score!!!!
Validation loss decreased (0.141988 --> 0.131122).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.35269832611084
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1426472  Vali Loss: 0.1176624 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9586267  Vali macro F1 0.9462145 
new best score!!!!
Validation loss decreased (0.131122 --> 0.117662).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.358600378036499
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1299438  Vali Loss: 0.1083204 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9614303  Vali macro F1 0.9481084 
new best score!!!!
Validation loss decreased (0.117662 --> 0.108320).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.364890813827515
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1264435  Vali Loss: 0.1071395 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9640436  Vali macro F1 0.9507954 
new best score!!!!
Validation loss decreased (0.108320 --> 0.107139).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.377262353897095
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1106077  Vali Loss: 0.1252465 Vali Accuracy: 0.9526394  Vali weighted F1: 0.9531512  Vali macro F1 0.9400772 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.37469482421875
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1073817  Vali Loss: 0.1064154 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9604280  Vali macro F1 0.9486342 
new best score!!!!
Validation loss decreased (0.107139 --> 0.106415).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.35737419128418
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0963309  Vali Loss: 0.1153453 Vali Accuracy: 0.9555994  Vali weighted F1: 0.9565821  Vali macro F1 0.9426724 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.361086130142212
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0988904  Vali Loss: 0.0864094 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9694582  Vali macro F1 0.9565393 
new best score!!!!
Validation loss decreased (0.106415 --> 0.086409).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.353965520858765
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0817567  Vali Loss: 0.0919016 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9650965  Vali macro F1 0.9536932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.350846529006958
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0801840  Vali Loss: 0.0898638 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9665861  Vali macro F1 0.9552490 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.347081184387207
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0776248  Vali Loss: 0.0832557 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9692879  Vali macro F1 0.9571575 
new best score!!!!
Validation loss decreased (0.086409 --> 0.083256).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.348775625228882
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0691650  Vali Loss: 0.0776175 Vali Accuracy: 0.9674396  Vali weighted F1: 0.9673462  Vali macro F1 0.9544107 
new best score!!!!
Validation loss decreased (0.083256 --> 0.077618).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.375157356262207
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0776962  Vali Loss: 0.1150660 Vali Accuracy: 0.9580661  Vali weighted F1: 0.9578351  Vali macro F1 0.9436137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.370724678039551
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0690694  Vali Loss: 0.1059338 Vali Accuracy: 0.9580661  Vali weighted F1: 0.9579630  Vali macro F1 0.9448266 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.363544225692749
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0584827  Vali Loss: 0.0743124 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9719054  Vali macro F1 0.9624066 
new best score!!!!
Validation loss decreased (0.077618 --> 0.074312).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.363319635391235
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0646258  Vali Loss: 0.0889944 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9686549  Vali macro F1 0.9579939 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.350531339645386
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0539739  Vali Loss: 0.1020211 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9637352  Vali macro F1 0.9511340 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.348999977111816
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0576115  Vali Loss: 0.0729384 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9729057  Vali macro F1 0.9637869 
new best score!!!!
Validation loss decreased (0.074312 --> 0.072938).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.348822832107544
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0667481  Vali Loss: 0.0798309 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9705064  Vali macro F1 0.9597886 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.355544090270996
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0462956  Vali Loss: 0.0711230 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9746460  Vali macro F1 0.9663018 
new best score!!!!
Validation loss decreased (0.072938 --> 0.071123).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.344247817993164
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0505224  Vali Loss: 0.1302704 Vali Accuracy: 0.9560927  Vali weighted F1: 0.9560525  Vali macro F1 0.9436441 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.387671947479248
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0538470  Vali Loss: 0.0611981 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9764643  Vali macro F1 0.9674800 
new best score!!!!
Validation loss decreased (0.071123 --> 0.061198).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.389673948287964
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0437487  Vali Loss: 0.0618306 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9714941  Vali macro F1 0.9593052 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.352293252944946
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0403881  Vali Loss: 0.0708520 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9746893  Vali macro F1 0.9660166 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.356255769729614
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0376058  Vali Loss: 0.0588419 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9763588  Vali macro F1 0.9663557 
new best score!!!!
Validation loss decreased (0.061198 --> 0.058842).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.3519628047943115
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0347764  Vali Loss: 0.0587834 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9763717  Vali macro F1 0.9672418 
new best score!!!!
Validation loss decreased (0.058842 --> 0.058783).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.367286920547485
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0429743  Vali Loss: 0.0718997 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9751067  Vali macro F1 0.9654393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.3665688037872314
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0345468  Vali Loss: 0.0848888 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9702729  Vali macro F1 0.9597645 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.357955694198608
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0278002  Vali Loss: 0.0639403 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803894  Vali macro F1 0.9728584 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.388319969177246
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0284485  Vali Loss: 0.0664260 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9757248  Vali macro F1 0.9659541 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.390361070632935
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0284103  Vali Loss: 0.0570024 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802430  Vali macro F1 0.9729608 
new best score!!!!
Validation loss decreased (0.058783 --> 0.057002).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.358386516571045
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0242171  Vali Loss: 0.0806734 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9732438  Vali macro F1 0.9647135 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.355165481567383
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0280360  Vali Loss: 0.0831785 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9701716  Vali macro F1 0.9579124 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.348650693893433
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0273914  Vali Loss: 0.0781962 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787792  Vali macro F1 0.9700275 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.358689308166504
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0270793  Vali Loss: 0.0900875 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9770165  Vali macro F1 0.9686840 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.354842662811279
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0306726  Vali Loss: 0.0699024 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788500  Vali macro F1 0.9698730 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 6.359130382537842
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0169323  Vali Loss: 0.0560859 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812770  Vali macro F1 0.9724119 
new best score!!!!
Validation loss decreased (0.057002 --> 0.056086).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.366873741149902
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0141794  Vali Loss: 0.0572548 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827542  Vali macro F1 0.9755708 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.364310264587402
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0118648  Vali Loss: 0.0565381 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837178  Vali macro F1 0.9764594 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.367084741592407
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0112187  Vali Loss: 0.0577644 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827560  Vali macro F1 0.9754749 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.36400842666626
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0112963  Vali Loss: 0.0558993 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9836989  Vali macro F1 0.9768487 
new best score!!!!
Validation loss decreased (0.056086 --> 0.055899).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.355725288391113
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0108982  Vali Loss: 0.0579127 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822830  Vali macro F1 0.9754063 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.357652902603149
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0105099  Vali Loss: 0.0628152 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808591  Vali macro F1 0.9723396 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.323699474334717
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0103868  Vali Loss: 0.0563533 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837430  Vali macro F1 0.9769416 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.3502044677734375
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0097466  Vali Loss: 0.0576817 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832904  Vali macro F1 0.9770165 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.365540981292725
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0096506  Vali Loss: 0.0619442 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827931  Vali macro F1 0.9764670 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 6.396577835083008
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0092796  Vali Loss: 0.0590095 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822903  Vali macro F1 0.9757328 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.360958814620972
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0093458  Vali Loss: 0.0565347 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827993  Vali macro F1 0.9762298 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.3730628490448
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0087897  Vali Loss: 0.0565180 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837640  Vali macro F1 0.9775210 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.359476566314697
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0092197  Vali Loss: 0.0571515 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832877  Vali macro F1 0.9770006 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.356197118759155
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0094108  Vali Loss: 0.0572770 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827993  Vali macro F1 0.9762298 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 57 cost time: 6.37312650680542
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0088023  Vali Loss: 0.0572654 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827993  Vali macro F1 0.9762298 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.37111234664917
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0088610  Vali Loss: 0.0571823 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827993  Vali macro F1 0.9762298 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.366103887557983
VALI: Epoch: 59, Steps: 72 | Train Loss: 0.0090845  Vali Loss: 0.0571176 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827993  Vali macro F1 0.9762298 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.398531913757324
VALI: Epoch: 60, Steps: 72 | Train Loss: 0.0093458  Vali Loss: 0.0569378 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832744  Vali macro F1 0.9767481 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.367736577987671
VALI: Epoch: 61, Steps: 72 | Train Loss: 0.0088568  Vali Loss: 0.0569407 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832744  Vali macro F1 0.9767481 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8895919  Test weighted F1: 0.8781823  Test macro F1 0.6671103 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.393070459365845
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0119240  Vali Loss: 0.0540254 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837202  Vali macro F1 0.9768927 
Validation loss decreased (inf --> 0.054025).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.375150442123413
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0106438  Vali Loss: 0.0552790 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832428  Vali macro F1 0.9767599 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.373033046722412
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0110342  Vali Loss: 0.0540904 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832323  Vali macro F1 0.9769936 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.364121437072754
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0097478  Vali Loss: 0.0561248 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827716  Vali macro F1 0.9765805 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.391732692718506
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0096026  Vali Loss: 0.0546356 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837896  Vali macro F1 0.9778646 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.395690679550171
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0093585  Vali Loss: 0.0585853 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827724  Vali macro F1 0.9761784 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.40479850769043
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0088131  Vali Loss: 0.0588102 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832341  Vali macro F1 0.9769915 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.383028984069824
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0083610  Vali Loss: 0.0561358 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852312  Vali macro F1 0.9793862 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.3745176792144775
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0082545  Vali Loss: 0.0566412 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847043  Vali macro F1 0.9784612 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.389269828796387
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0096646  Vali Loss: 0.0598830 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837096  Vali macro F1 0.9776633 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.379446029663086
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0074617  Vali Loss: 0.0576429 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852113  Vali macro F1 0.9795068 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.373102188110352
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0078026  Vali Loss: 0.0585622 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837691  Vali macro F1 0.9779682 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.376648902893066
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0070152  Vali Loss: 0.0605378 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837644  Vali macro F1 0.9780157 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.37489652633667
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0068999  Vali Loss: 0.0589368 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837697  Vali macro F1 0.9779399 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.42507266998291
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0069378  Vali Loss: 0.0596841 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827409  Vali macro F1 0.9767206 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.395386457443237
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0079486  Vali Loss: 0.0594648 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832502  Vali macro F1 0.9771892 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8914527  Test weighted F1: 0.8808415  Test macro F1 0.6716088 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014443 0.00016863 0.00100908 0.00133333 0.00050075 0.00063331]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.3307600021362305
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0452009  Vali Loss: 0.6584120 Vali Accuracy: 0.7241209  Vali weighted F1: 0.6538085  Vali macro F1 0.3830325 
Validation loss decreased (inf --> 0.658412).  Saving model ...
Epoch: 2 cost time: 6.318896532058716
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5455545  Vali Loss: 0.4454968 Vali Accuracy: 0.8474492  Vali weighted F1: 0.8386013  Vali macro F1 0.7753564 
new best score!!!!
Validation loss decreased (0.658412 --> 0.445497).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.3119189739227295
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3656563  Vali Loss: 0.3102399 Vali Accuracy: 0.8994552  Vali weighted F1: 0.8903776  Vali macro F1 0.8547966 
new best score!!!!
Validation loss decreased (0.445497 --> 0.310240).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.3175225257873535
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2558949  Vali Loss: 0.1946583 Vali Accuracy: 0.9346211  Vali weighted F1: 0.9329753  Vali macro F1 0.9008198 
new best score!!!!
Validation loss decreased (0.310240 --> 0.194658).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.336661100387573
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1929665  Vali Loss: 0.1657775 Vali Accuracy: 0.9440317  Vali weighted F1: 0.9433613  Vali macro F1 0.9173971 
new best score!!!!
Validation loss decreased (0.194658 --> 0.165777).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.350750207901001
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1681692  Vali Loss: 0.1450752 Vali Accuracy: 0.9529470  Vali weighted F1: 0.9531776  Vali macro F1 0.9254055 
new best score!!!!
Validation loss decreased (0.165777 --> 0.145075).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.360634803771973
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1493525  Vali Loss: 0.1285310 Vali Accuracy: 0.9559188  Vali weighted F1: 0.9558967  Vali macro F1 0.9308826 
new best score!!!!
Validation loss decreased (0.145075 --> 0.128531).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.331236839294434
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1353402  Vali Loss: 0.1266115 Vali Accuracy: 0.9559188  Vali weighted F1: 0.9553254  Vali macro F1 0.9337075 
new best score!!!!
Validation loss decreased (0.128531 --> 0.126612).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.331053256988525
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1229879  Vali Loss: 0.1230877 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9573947  Vali macro F1 0.9363089 
new best score!!!!
Validation loss decreased (0.126612 --> 0.123088).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.328777551651001
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1224096  Vali Loss: 0.1097575 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9615343  Vali macro F1 0.9418591 
new best score!!!!
Validation loss decreased (0.123088 --> 0.109757).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.334068536758423
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1104325  Vali Loss: 0.1014026 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9610605  Vali macro F1 0.9414644 
new best score!!!!
Validation loss decreased (0.109757 --> 0.101403).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.343719959259033
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1009531  Vali Loss: 0.0982087 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9650637  Vali macro F1 0.9464622 
new best score!!!!
Validation loss decreased (0.101403 --> 0.098209).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.345781564712524
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0909046  Vali Loss: 0.0964772 Vali Accuracy: 0.9638435  Vali weighted F1: 0.9635724  Vali macro F1 0.9474858 
new best score!!!!
Validation loss decreased (0.098209 --> 0.096477).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.329730749130249
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0835994  Vali Loss: 0.0908780 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9685967  Vali macro F1 0.9552632 
new best score!!!!
Validation loss decreased (0.096477 --> 0.090878).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.356905221939087
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0822824  Vali Loss: 0.0799375 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9716371  Vali macro F1 0.9602511 
new best score!!!!
Validation loss decreased (0.090878 --> 0.079938).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.3475658893585205
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0756576  Vali Loss: 0.0704610 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9771382  Vali macro F1 0.9666315 
new best score!!!!
Validation loss decreased (0.079938 --> 0.070461).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.328152418136597
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0717812  Vali Loss: 0.0873868 Vali Accuracy: 0.9697870  Vali weighted F1: 0.9698457  Vali macro F1 0.9573246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.339666128158569
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0655794  Vali Loss: 0.0715983 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9763487  Vali macro F1 0.9660205 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.334571361541748
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0650244  Vali Loss: 0.0735502 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747167  Vali macro F1 0.9643249 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.336092948913574
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0605813  Vali Loss: 0.0718944 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9777807  Vali macro F1 0.9673940 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 6.331766128540039
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0518294  Vali Loss: 0.0723955 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9781966  Vali macro F1 0.9661381 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 6.326820611953735
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0403791  Vali Loss: 0.0645471 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9816617  Vali macro F1 0.9727791 
new best score!!!!
Validation loss decreased (0.070461 --> 0.064547).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.393760442733765
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0357929  Vali Loss: 0.0649580 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9796752  Vali macro F1 0.9701214 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.335479021072388
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0357035  Vali Loss: 0.0657104 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792992  Vali macro F1 0.9698247 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.352886438369751
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0358313  Vali Loss: 0.0678348 Vali Accuracy: 0.9782070  Vali weighted F1: 0.9783844  Vali macro F1 0.9692667 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.344115257263184
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0337236  Vali Loss: 0.0629873 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9816718  Vali macro F1 0.9731214 
new best score!!!!
Validation loss decreased (0.064547 --> 0.062987).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.3456292152404785
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0331715  Vali Loss: 0.0630664 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802234  Vali macro F1 0.9706958 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.3317131996154785
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0326407  Vali Loss: 0.0653718 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9806856  Vali macro F1 0.9714981 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.335299253463745
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0342033  Vali Loss: 0.0641383 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817270  Vali macro F1 0.9731394 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.321973562240601
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0299718  Vali Loss: 0.0624554 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9816818  Vali macro F1 0.9728105 
new best score!!!!
Validation loss decreased (0.062987 --> 0.062455).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.3218302726745605
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0311578  Vali Loss: 0.0621353 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9816881  Vali macro F1 0.9734009 
new best score!!!!
Validation loss decreased (0.062455 --> 0.062135).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.360082387924194
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0297034  Vali Loss: 0.0633828 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822316  Vali macro F1 0.9737080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.357873201370239
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0298276  Vali Loss: 0.0617678 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821900  Vali macro F1 0.9739639 
new best score!!!!
Validation loss decreased (0.062135 --> 0.061768).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.3408026695251465
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0291492  Vali Loss: 0.0627454 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821900  Vali macro F1 0.9739639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.340223550796509
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0277847  Vali Loss: 0.0635130 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832061  Vali macro F1 0.9750054 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.327674150466919
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0300713  Vali Loss: 0.0651704 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812103  Vali macro F1 0.9727080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.33017373085022
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0271666  Vali Loss: 0.0643762 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812728  Vali macro F1 0.9727741 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.328089237213135
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0276831  Vali Loss: 0.0654855 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802325  Vali macro F1 0.9716470 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.3274993896484375
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0282884  Vali Loss: 0.0620314 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9816981  Vali macro F1 0.9731653 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.3312907218933105
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0258605  Vali Loss: 0.0624219 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821897  Vali macro F1 0.9739842 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.352781295776367
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0265128  Vali Loss: 0.0620649 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822069  Vali macro F1 0.9736869 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.34913182258606
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0257157  Vali Loss: 0.0623452 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826810  Vali macro F1 0.9748022 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.340457916259766
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0264332  Vali Loss: 0.0619471 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821897  Vali macro F1 0.9739842 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.333096981048584
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0261806  Vali Loss: 0.0620131 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821897  Vali macro F1 0.9739842 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.339702606201172
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0259340  Vali Loss: 0.0621111 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821897  Vali macro F1 0.9739842 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.326985836029053
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0249458  Vali Loss: 0.0621597 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821897  Vali macro F1 0.9739842 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.340536832809448
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0254170  Vali Loss: 0.0622051 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821897  Vali macro F1 0.9739842 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.334895849227905
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0256541  Vali Loss: 0.0621866 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821897  Vali macro F1 0.9739842 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7673373  Test weighted F1: 0.7710756  Test macro F1 0.7613962 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.393383979797363
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0305843  Vali Loss: 0.0644590 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802731  Vali macro F1 0.9711099 
Validation loss decreased (inf --> 0.064459).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.366058588027954
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0302075  Vali Loss: 0.0643913 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807979  Vali macro F1 0.9716346 
new best score!!!!
Validation loss decreased (0.064459 --> 0.064391).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.3391594886779785
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0294646  Vali Loss: 0.0622409 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797106  Vali macro F1 0.9701128 
new best score!!!!
Validation loss decreased (0.064391 --> 0.062241).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.32778787612915
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0277939  Vali Loss: 0.0622906 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817593  Vali macro F1 0.9726762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.3355488777160645
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0289870  Vali Loss: 0.0609516 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822321  Vali macro F1 0.9737287 
new best score!!!!
Validation loss decreased (0.062241 --> 0.060952).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.333802223205566
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0278709  Vali Loss: 0.0632617 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9831664  Vali macro F1 0.9756381 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.348660945892334
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0282502  Vali Loss: 0.0613988 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822285  Vali macro F1 0.9737118 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.3551344871521
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0261281  Vali Loss: 0.0652773 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807211  Vali macro F1 0.9723868 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.3504955768585205
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0251608  Vali Loss: 0.0645196 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812269  Vali macro F1 0.9729685 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.3611791133880615
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0256649  Vali Loss: 0.0623908 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821927  Vali macro F1 0.9733357 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.373009443283081
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0249129  Vali Loss: 0.0667667 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787596  Vali macro F1 0.9693755 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.347784042358398
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0243406  Vali Loss: 0.0609113 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827122  Vali macro F1 0.9741916 
new best score!!!!
Validation loss decreased (0.060952 --> 0.060911).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.352660417556763
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0247987  Vali Loss: 0.0618323 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817067  Vali macro F1 0.9734504 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.360182285308838
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0224695  Vali Loss: 0.0624307 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817499  Vali macro F1 0.9732517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.352322101593018
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0229569  Vali Loss: 0.0642577 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826837  Vali macro F1 0.9747510 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.355882167816162
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0232331  Vali Loss: 0.0626159 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826947  Vali macro F1 0.9745082 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.355382442474365
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0216365  Vali Loss: 0.0623953 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822209  Vali macro F1 0.9743628 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.359427452087402
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0202821  Vali Loss: 0.0621768 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821847  Vali macro F1 0.9739846 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.360276222229004
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0208821  Vali Loss: 0.0611880 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826810  Vali macro F1 0.9748022 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.372416973114014
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0199025  Vali Loss: 0.0606958 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826810  Vali macro F1 0.9748022 
new best score!!!!
Validation loss decreased (0.060911 --> 0.060696).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.3555262088775635
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0201614  Vali Loss: 0.0617041 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826810  Vali macro F1 0.9748022 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.36533522605896
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0194591  Vali Loss: 0.0620740 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826810  Vali macro F1 0.9748022 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.3611509799957275
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0190973  Vali Loss: 0.0612432 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821847  Vali macro F1 0.9739846 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.356389045715332
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0196615  Vali Loss: 0.0621849 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821847  Vali macro F1 0.9739846 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.3532304763793945
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0196513  Vali Loss: 0.0619216 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.352445125579834
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0194292  Vali Loss: 0.0617839 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.370062589645386
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0194347  Vali Loss: 0.0617675 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.358980178833008
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0204374  Vali Loss: 0.0617981 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.373712778091431
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0194769  Vali Loss: 0.0618736 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.359806299209595
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0186285  Vali Loss: 0.0618247 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 31 cost time: 6.35393214225769
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0194391  Vali Loss: 0.0618206 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.358213424682617
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0204191  Vali Loss: 0.0618033 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.356470108032227
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0199136  Vali Loss: 0.0617912 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.352461814880371
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0195410  Vali Loss: 0.0617893 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.365541219711304
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0184686  Vali Loss: 0.0617910 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826946  Vali macro F1 0.9744877 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7689941  Test weighted F1: 0.7734795  Test macro F1 0.7629793 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014624 0.00017832 0.00108342 0.00132979 0.00049529 0.00062696]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.2050940990448
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0887048  Vali Loss: 0.7023283 Vali Accuracy: 0.7118214  Vali weighted F1: 0.6288993  Vali macro F1 0.3419481 
Validation loss decreased (inf --> 0.702328).  Saving model ...
Epoch: 2 cost time: 6.192481756210327
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5700558  Vali Loss: 0.4280255 Vali Accuracy: 0.8477930  Vali weighted F1: 0.8438233  Vali macro F1 0.8109286 
new best score!!!!
Validation loss decreased (0.702328 --> 0.428025).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.185207366943359
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3447004  Vali Loss: 0.2828329 Vali Accuracy: 0.9107052  Vali weighted F1: 0.9041856  Vali macro F1 0.8805964 
new best score!!!!
Validation loss decreased (0.428025 --> 0.282833).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.174190282821655
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2312930  Vali Loss: 0.1931996 Vali Accuracy: 0.9350583  Vali weighted F1: 0.9350578  Vali macro F1 0.9149655 
new best score!!!!
Validation loss decreased (0.282833 --> 0.193200).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.174973964691162
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2001921  Vali Loss: 0.2020209 Vali Accuracy: 0.9360731  Vali weighted F1: 0.9340473  Vali macro F1 0.9163841 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.178695440292358
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1866086  Vali Loss: 0.1615136 Vali Accuracy: 0.9467275  Vali weighted F1: 0.9460526  Vali macro F1 0.9299855 
new best score!!!!
Validation loss decreased (0.193200 --> 0.161514).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.186758756637573
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1476604  Vali Loss: 0.1603312 Vali Accuracy: 0.9512938  Vali weighted F1: 0.9516744  Vali macro F1 0.9371677 
new best score!!!!
Validation loss decreased (0.161514 --> 0.160331).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.180394172668457
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1421533  Vali Loss: 0.1446366 Vali Accuracy: 0.9553526  Vali weighted F1: 0.9556691  Vali macro F1 0.9408765 
new best score!!!!
Validation loss decreased (0.160331 --> 0.144637).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.188671588897705
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1326882  Vali Loss: 0.1325988 Vali Accuracy: 0.9512938  Vali weighted F1: 0.9505780  Vali macro F1 0.9338871 
new best score!!!!
Validation loss decreased (0.144637 --> 0.132599).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2102062702178955
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1148908  Vali Loss: 0.1350673 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9595745  Vali macro F1 0.9499371 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.195767641067505
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1105161  Vali Loss: 0.1356258 Vali Accuracy: 0.9538305  Vali weighted F1: 0.9530260  Vali macro F1 0.9388418 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.18725061416626
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0973787  Vali Loss: 0.1209945 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9590061  Vali macro F1 0.9488590 
new best score!!!!
Validation loss decreased (0.132599 --> 0.120995).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.182924509048462
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0983578  Vali Loss: 0.1160084 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9634012  Vali macro F1 0.9530583 
new best score!!!!
Validation loss decreased (0.120995 --> 0.116008).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.177714824676514
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0910758  Vali Loss: 0.1022651 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9717417  Vali macro F1 0.9640890 
new best score!!!!
Validation loss decreased (0.116008 --> 0.102265).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.191518783569336
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0825108  Vali Loss: 0.1101005 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9674295  Vali macro F1 0.9579805 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.185040712356567
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0833225  Vali Loss: 0.1030926 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9682553  Vali macro F1 0.9594305 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.185067892074585
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0786191  Vali Loss: 0.1257799 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9624231  Vali macro F1 0.9519526 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.177781581878662
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0716579  Vali Loss: 0.1020392 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9691132  Vali macro F1 0.9583966 
new best score!!!!
Validation loss decreased (0.102265 --> 0.102039).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.202148914337158
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0667699  Vali Loss: 0.1028374 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9693743  Vali macro F1 0.9630810 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.202066898345947
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0624735  Vali Loss: 0.1078516 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9696423  Vali macro F1 0.9646421 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.17255425453186
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0614897  Vali Loss: 0.1003275 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9723923  Vali macro F1 0.9652543 
new best score!!!!
Validation loss decreased (0.102039 --> 0.100328).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.179832220077515
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0569324  Vali Loss: 0.1089585 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9704810  Vali macro F1 0.9644307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.17250657081604
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0563265  Vali Loss: 0.0874817 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9762083  Vali macro F1 0.9710817 
new best score!!!!
Validation loss decreased (0.100328 --> 0.087482).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.174253463745117
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0507206  Vali Loss: 0.0873165 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9760474  Vali macro F1 0.9723889 
new best score!!!!
Validation loss decreased (0.087482 --> 0.087316).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.179771423339844
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0465688  Vali Loss: 0.0990273 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9703589  Vali macro F1 0.9622702 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.182321310043335
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0518239  Vali Loss: 0.0747958 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787909  Vali macro F1 0.9733675 
new best score!!!!
Validation loss decreased (0.087316 --> 0.074796).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.200345516204834
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0420709  Vali Loss: 0.0682481 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9816966  Vali macro F1 0.9787105 
new best score!!!!
Validation loss decreased (0.074796 --> 0.068248).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.195040941238403
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0393382  Vali Loss: 0.1030656 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9705393  Vali macro F1 0.9624769 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.1804399490356445
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0338892  Vali Loss: 0.1008907 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9723331  Vali macro F1 0.9672437 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.173807382583618
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0352020  Vali Loss: 0.0855198 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9723117  Vali macro F1 0.9678097 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.143536567687988
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0451306  Vali Loss: 0.0678904 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796934  Vali macro F1 0.9774122 
new best score!!!!
Validation loss decreased (0.068248 --> 0.067890).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.156031131744385
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0302065  Vali Loss: 0.0925846 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9768387  Vali macro F1 0.9730679 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.146637916564941
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0322833  Vali Loss: 0.0976480 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9753726  Vali macro F1 0.9713772 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.149956226348877
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0420893  Vali Loss: 0.0869699 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9760154  Vali macro F1 0.9702571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.171805143356323
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0268261  Vali Loss: 0.0660528 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9803671  Vali macro F1 0.9778466 
new best score!!!!
Validation loss decreased (0.067890 --> 0.066053).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.186606168746948
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0227701  Vali Loss: 0.0707443 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9816520  Vali macro F1 0.9787064 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.17227578163147
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0254781  Vali Loss: 0.0738035 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801353  Vali macro F1 0.9768791 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.159358024597168
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0236460  Vali Loss: 0.0995937 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9723064  Vali macro F1 0.9658961 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.152770042419434
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0203682  Vali Loss: 0.0652156 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832872  Vali macro F1 0.9805094 
new best score!!!!
Validation loss decreased (0.066053 --> 0.065216).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.1702539920806885
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0255902  Vali Loss: 0.0635369 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832662  Vali macro F1 0.9776828 
new best score!!!!
Validation loss decreased (0.065216 --> 0.063537).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.148292779922485
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0203555  Vali Loss: 0.0713129 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801969  Vali macro F1 0.9736322 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.1601104736328125
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0225681  Vali Loss: 0.0605509 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823308  Vali macro F1 0.9764537 
new best score!!!!
Validation loss decreased (0.063537 --> 0.060551).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.159805059432983
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0226345  Vali Loss: 0.0641566 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9816141  Vali macro F1 0.9775569 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.17398476600647
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0134963  Vali Loss: 0.0706510 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9820495  Vali macro F1 0.9777841 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.163501739501953
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0129299  Vali Loss: 0.0628607 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9831911  Vali macro F1 0.9806574 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.162468671798706
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0214625  Vali Loss: 0.0686006 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9799069  Vali macro F1 0.9777837 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.151071310043335
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0164249  Vali Loss: 0.0688213 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802322  Vali macro F1 0.9762209 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 48 cost time: 6.150526285171509
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0100299  Vali Loss: 0.0628958 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832179  Vali macro F1 0.9806077 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.152412176132202
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0082955  Vali Loss: 0.0609809 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852850  Vali macro F1 0.9827891 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.153443813323975
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0075592  Vali Loss: 0.0655259 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842081  Vali macro F1 0.9817990 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.153324365615845
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0080772  Vali Loss: 0.0596569 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852778  Vali macro F1 0.9824424 
new best score!!!!
Validation loss decreased (0.060551 --> 0.059657).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.159398555755615
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0072289  Vali Loss: 0.0637150 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847154  Vali macro F1 0.9809916 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.169187307357788
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0065015  Vali Loss: 0.0609069 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837393  Vali macro F1 0.9800545 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.166958570480347
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0067276  Vali Loss: 0.0607566 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842620  Vali macro F1 0.9803309 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.1436545848846436
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0070763  Vali Loss: 0.0592491 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837486  Vali macro F1 0.9803294 
new best score!!!!
Validation loss decreased (0.059657 --> 0.059249).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.146738767623901
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0066443  Vali Loss: 0.0611342 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847369  Vali macro F1 0.9822070 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.1473002433776855
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0063219  Vali Loss: 0.0581067 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847693  Vali macro F1 0.9821047 
new best score!!!!
Validation loss decreased (0.059249 --> 0.058107).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.156507253646851
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0060294  Vali Loss: 0.0618552 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837218  Vali macro F1 0.9796819 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.150780439376831
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0072471  Vali Loss: 0.0593904 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853032  Vali macro F1 0.9832376 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.143143653869629
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0064841  Vali Loss: 0.0611750 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842530  Vali macro F1 0.9816073 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.156313180923462
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0058765  Vali Loss: 0.0579924 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857936  Vali macro F1 0.9834307 
new best score!!!!
Validation loss decreased (0.058107 --> 0.057992).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.176246643066406
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0058386  Vali Loss: 0.0598704 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827292  Vali macro F1 0.9770108 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.152759075164795
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0057947  Vali Loss: 0.0590904 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842634  Vali macro F1 0.9808250 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.154878377914429
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0053044  Vali Loss: 0.0594321 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847675  Vali macro F1 0.9810497 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.153412103652954
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0047933  Vali Loss: 0.0588110 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852739  Vali macro F1 0.9830103 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 6.158165216445923
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0056243  Vali Loss: 0.0606498 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827079  Vali macro F1 0.9775679 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 67 cost time: 6.15546178817749
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0054534  Vali Loss: 0.0606248 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 6.149385213851929
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0043168  Vali Loss: 0.0601297 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 6.155712604522705
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0047035  Vali Loss: 0.0588733 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 6.172331094741821
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0047746  Vali Loss: 0.0600685 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 6.181045055389404
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0051007  Vali Loss: 0.0612750 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 72 cost time: 6.160099506378174
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0049866  Vali Loss: 0.0611001 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 6.154051303863525
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0048223  Vali Loss: 0.0609875 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 6.156649827957153
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0045695  Vali Loss: 0.0608729 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 6.153719186782837
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0050375  Vali Loss: 0.0608280 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 6.149348735809326
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0047318  Vali Loss: 0.0608618 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832260  Vali macro F1 0.9780873 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9360449  Test weighted F1: 0.9369615  Test macro F1 0.8968269 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.217986106872559
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0060314  Vali Loss: 0.0598532 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9836950  Vali macro F1 0.9782153 
Validation loss decreased (inf --> 0.059853).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.217092752456665
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0058866  Vali Loss: 0.0610840 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822337  Vali macro F1 0.9764710 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.2193920612335205
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0063059  Vali Loss: 0.0626019 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842126  Vali macro F1 0.9804376 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.197373867034912
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0061530  Vali Loss: 0.0632669 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842130  Vali macro F1 0.9804127 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.208945035934448
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0052295  Vali Loss: 0.0629521 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862625  Vali macro F1 0.9835482 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.201671838760376
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0051801  Vali Loss: 0.0660176 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842102  Vali macro F1 0.9813641 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.19935417175293
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0047218  Vali Loss: 0.0664016 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852189  Vali macro F1 0.9828611 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.214006662368774
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0043793  Vali Loss: 0.0641775 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852372  Vali macro F1 0.9811802 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.216059923171997
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0045185  Vali Loss: 0.0657928 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9831873  Vali macro F1 0.9786198 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.215857744216919
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0047324  Vali Loss: 0.0625768 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862349  Vali macro F1 0.9839407 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.223792791366577
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0042876  Vali Loss: 0.0607550 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847479  Vali macro F1 0.9820701 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.227916240692139
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0039656  Vali Loss: 0.0609560 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847479  Vali macro F1 0.9820701 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.212746858596802
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0036960  Vali Loss: 0.0619885 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842185  Vali macro F1 0.9818848 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.208258628845215
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0041202  Vali Loss: 0.0618283 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842294  Vali macro F1 0.9815504 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.207567453384399
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0040693  Vali Loss: 0.0630607 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832032  Vali macro F1 0.9802133 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.210650444030762
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0037657  Vali Loss: 0.0629233 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837110  Vali macro F1 0.9810496 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9377933  Test weighted F1: 0.9385585  Test macro F1 0.8990988 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013998 0.00018225 0.00103093 0.00127065 0.00049751 0.0005988 ]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.2972331047058105
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0677520  Vali Loss: 0.6748205 Vali Accuracy: 0.7739044  Vali weighted F1: 0.7315396  Vali macro F1 0.5401894 
Validation loss decreased (inf --> 0.674820).  Saving model ...
Epoch: 2 cost time: 6.300663948059082
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5232808  Vali Loss: 0.4063705 Vali Accuracy: 0.8456175  Vali weighted F1: 0.8277483  Vali macro F1 0.7868937 
new best score!!!!
Validation loss decreased (0.674820 --> 0.406370).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.288567066192627
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3366035  Vali Loss: 0.2482555 Vali Accuracy: 0.9143426  Vali weighted F1: 0.9115110  Vali macro F1 0.8877219 
new best score!!!!
Validation loss decreased (0.406370 --> 0.248255).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2891857624053955
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2454103  Vali Loss: 0.2049877 Vali Accuracy: 0.9292829  Vali weighted F1: 0.9295479  Vali macro F1 0.9066355 
new best score!!!!
Validation loss decreased (0.248255 --> 0.204988).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.306961297988892
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1912773  Vali Loss: 0.1849398 Vali Accuracy: 0.9372510  Vali weighted F1: 0.9373391  Vali macro F1 0.9142588 
new best score!!!!
Validation loss decreased (0.204988 --> 0.184940).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.298657178878784
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1690953  Vali Loss: 0.1622895 Vali Accuracy: 0.9407371  Vali weighted F1: 0.9404531  Vali macro F1 0.9168237 
new best score!!!!
Validation loss decreased (0.184940 --> 0.162290).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.311429023742676
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1484006  Vali Loss: 0.1377298 Vali Accuracy: 0.9531873  Vali weighted F1: 0.9530574  Vali macro F1 0.9319928 
new best score!!!!
Validation loss decreased (0.162290 --> 0.137730).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.295450210571289
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1399132  Vali Loss: 0.1383088 Vali Accuracy: 0.9546813  Vali weighted F1: 0.9550189  Vali macro F1 0.9341008 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.298792600631714
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1341277  Vali Loss: 0.1283514 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9576029  Vali macro F1 0.9425687 
new best score!!!!
Validation loss decreased (0.137730 --> 0.128351).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.303306579589844
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1190323  Vali Loss: 0.1355404 Vali Accuracy: 0.9551793  Vali weighted F1: 0.9557531  Vali macro F1 0.9411303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.288233041763306
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1199142  Vali Loss: 0.1186846 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9581496  Vali macro F1 0.9442776 
new best score!!!!
Validation loss decreased (0.128351 --> 0.118685).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.324711084365845
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1100347  Vali Loss: 0.1115137 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9660747  Vali macro F1 0.9563854 
new best score!!!!
Validation loss decreased (0.118685 --> 0.111514).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.3310418128967285
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0995139  Vali Loss: 0.1231262 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9584176  Vali macro F1 0.9483982 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.3025195598602295
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0966407  Vali Loss: 0.1247813 Vali Accuracy: 0.9591633  Vali weighted F1: 0.9592478  Vali macro F1 0.9472428 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.299993991851807
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0956091  Vali Loss: 0.1034288 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9657311  Vali macro F1 0.9563394 
new best score!!!!
Validation loss decreased (0.111514 --> 0.103429).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.302077531814575
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0893532  Vali Loss: 0.1212769 Vali Accuracy: 0.9611554  Vali weighted F1: 0.9608748  Vali macro F1 0.9496961 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.297820568084717
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0865659  Vali Loss: 0.1144882 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9633595  Vali macro F1 0.9531034 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.296323776245117
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0857699  Vali Loss: 0.0998100 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9677246  Vali macro F1 0.9591763 
new best score!!!!
Validation loss decreased (0.103429 --> 0.099810).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.305830478668213
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0713857  Vali Loss: 0.0889561 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9714788  Vali macro F1 0.9627591 
new best score!!!!
Validation loss decreased (0.099810 --> 0.088956).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.303583145141602
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0645148  Vali Loss: 0.0930601 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733423  Vali macro F1 0.9656293 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.307880878448486
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0633626  Vali Loss: 0.0825368 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9721200  Vali macro F1 0.9639118 
new best score!!!!
Validation loss decreased (0.088956 --> 0.082537).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.316513538360596
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0661341  Vali Loss: 0.0857372 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9726669  Vali macro F1 0.9654997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.303114652633667
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0584863  Vali Loss: 0.0967471 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9670301  Vali macro F1 0.9585803 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.300821542739868
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0581224  Vali Loss: 0.0832496 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9736273  Vali macro F1 0.9687953 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.289895534515381
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0505579  Vali Loss: 0.0738996 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9775417  Vali macro F1 0.9722489 
new best score!!!!
Validation loss decreased (0.082537 --> 0.073900).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.293499708175659
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0523379  Vali Loss: 0.0849779 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9763585  Vali macro F1 0.9693798 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.276015520095825
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0544673  Vali Loss: 0.0917291 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9688791  Vali macro F1 0.9611600 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.294205904006958
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0466420  Vali Loss: 0.0768369 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9746754  Vali macro F1 0.9677781 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.292052507400513
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0386588  Vali Loss: 0.0690675 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9786082  Vali macro F1 0.9733120 
new best score!!!!
Validation loss decreased (0.073900 --> 0.069068).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.325075149536133
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0350147  Vali Loss: 0.0705532 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805469  Vali macro F1 0.9757263 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.316635370254517
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0369256  Vali Loss: 0.0766896 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9760529  Vali macro F1 0.9706820 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.300941467285156
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0410103  Vali Loss: 0.0766626 Vali Accuracy: 0.9770916  Vali weighted F1: 0.9772191  Vali macro F1 0.9696859 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.292758464813232
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0329007  Vali Loss: 0.0997459 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9724657  Vali macro F1 0.9648562 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.298089981079102
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0350065  Vali Loss: 0.0801890 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9726090  Vali macro F1 0.9650547 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.297966003417969
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0244432  Vali Loss: 0.0596221 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810861  Vali macro F1 0.9760680 
new best score!!!!
Validation loss decreased (0.069068 --> 0.059622).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.300496816635132
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0211415  Vali Loss: 0.0586162 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825849  Vali macro F1 0.9782898 
new best score!!!!
Validation loss decreased (0.059622 --> 0.058616).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.298837184906006
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0196381  Vali Loss: 0.0622236 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816854  Vali macro F1 0.9761163 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.299844264984131
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0192346  Vali Loss: 0.0593506 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830959  Vali macro F1 0.9784073 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.310771942138672
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0187112  Vali Loss: 0.0613588 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825941  Vali macro F1 0.9776223 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.326675891876221
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0176168  Vali Loss: 0.0590372 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836038  Vali macro F1 0.9788886 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.303930997848511
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0180224  Vali Loss: 0.0619150 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831271  Vali macro F1 0.9780754 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 6.301530838012695
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0161992  Vali Loss: 0.0610062 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831058  Vali macro F1 0.9783517 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.295701503753662
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0174087  Vali Loss: 0.0601562 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835884  Vali macro F1 0.9791892 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.288351058959961
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0165328  Vali Loss: 0.0597275 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835879  Vali macro F1 0.9792240 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.289238452911377
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0159918  Vali Loss: 0.0597132 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835884  Vali macro F1 0.9791892 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.302747011184692
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0160906  Vali Loss: 0.0601199 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841007  Vali macro F1 0.9797065 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 6.321772336959839
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0162384  Vali Loss: 0.0600882 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841007  Vali macro F1 0.9797065 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.302086591720581
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0153540  Vali Loss: 0.0600900 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841007  Vali macro F1 0.9797065 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.321723937988281
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0150200  Vali Loss: 0.0599935 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835879  Vali macro F1 0.9792240 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.2987284660339355
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0159198  Vali Loss: 0.0599617 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835879  Vali macro F1 0.9792240 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.308191776275635
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0156876  Vali Loss: 0.0598926 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835879  Vali macro F1 0.9792240 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9489027  Test weighted F1: 0.9486232  Test macro F1 0.9281922 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 138143
pruned model Parameter : 141902
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.337010622024536
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0196071  Vali Loss: 0.0600111 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830758  Vali macro F1 0.9782033 
Validation loss decreased (inf --> 0.060011).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3138391971588135
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0181018  Vali Loss: 0.0687239 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811111  Vali macro F1 0.9756558 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.306295156478882
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0189146  Vali Loss: 0.0617734 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845985  Vali macro F1 0.9801610 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.3163440227508545
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0161724  Vali Loss: 0.0603630 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840633  Vali macro F1 0.9799398 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.324587821960449
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0169820  Vali Loss: 0.0624997 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831100  Vali macro F1 0.9781255 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.319164752960205
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0164000  Vali Loss: 0.0625369 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841188  Vali macro F1 0.9790817 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.321822166442871
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0162889  Vali Loss: 0.0604836 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836198  Vali macro F1 0.9788005 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.3055338859558105
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0162997  Vali Loss: 0.0643716 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826034  Vali macro F1 0.9771619 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.30768895149231
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0141597  Vali Loss: 0.0614765 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9846030  Vali macro F1 0.9802333 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.311835050582886
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0139876  Vali Loss: 0.0620288 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810327  Vali macro F1 0.9761403 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.3126702308654785
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0140246  Vali Loss: 0.0614336 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820726  Vali macro F1 0.9773424 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.303664207458496
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0134377  Vali Loss: 0.0628678 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810540  Vali macro F1 0.9758098 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.3033294677734375
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0131730  Vali Loss: 0.0628173 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825921  Vali macro F1 0.9778667 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.3204004764556885
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0138247  Vali Loss: 0.0627453 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830686  Vali macro F1 0.9789116 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.319407939910889
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0135851  Vali Loss: 0.0628158 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835821  Vali macro F1 0.9793953 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.3337342739105225
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0131664  Vali Loss: 0.0628204 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835821  Vali macro F1 0.9793953 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9487918  Test weighted F1: 0.9485343  Test macro F1 0.9276608 

============================= JOB FEEDBACK =============================

NodeName=uc2n562
Job ID: 20948443
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 07:50:02
CPU Efficiency: 4.99% of 6-13:00:00 core-walltime
Job Wall-clock time: 07:51:00
Memory Utilized: 5.01 GB
Memory Efficiency: 0.00% of 0.00 MB
