Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 63951
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0001465  0.000181   0.00097182 0.00123001 0.0004852  0.00060716]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.275667667388916
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2223135  Vali Loss: 0.7269642 Vali Accuracy: 0.7104072  Vali weighted F1: 0.6315312  Vali macro F1 0.3488940 
Validation loss decreased (inf --> 0.726964).  Saving model ...
Epoch: 2 cost time: 6.16273832321167
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6449382  Vali Loss: 0.5400616 Vali Accuracy: 0.7828054  Vali weighted F1: 0.7393766  Vali macro F1 0.5319446 
new best score!!!!
Validation loss decreased (0.726964 --> 0.540062).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.142364740371704
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4503504  Vali Loss: 0.3191644 Vali Accuracy: 0.8843640  Vali weighted F1: 0.8880435  Vali macro F1 0.8525414 
new best score!!!!
Validation loss decreased (0.540062 --> 0.319164).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.178994655609131
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2804686  Vali Loss: 0.2637861 Vali Accuracy: 0.9110106  Vali weighted F1: 0.9084149  Vali macro F1 0.8838713 
new best score!!!!
Validation loss decreased (0.319164 --> 0.263786).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.156998157501221
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2225367  Vali Loss: 0.1983926 Vali Accuracy: 0.9321267  Vali weighted F1: 0.9332662  Vali macro F1 0.9103508 
new best score!!!!
Validation loss decreased (0.263786 --> 0.198393).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.136245965957642
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1932439  Vali Loss: 0.2010888 Vali Accuracy: 0.9311212  Vali weighted F1: 0.9320268  Vali macro F1 0.9116124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.1434550285339355
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1828101  Vali Loss: 0.1721855 Vali Accuracy: 0.9411765  Vali weighted F1: 0.9419441  Vali macro F1 0.9244040 
new best score!!!!
Validation loss decreased (0.198393 --> 0.172186).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.145031213760376
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1649367  Vali Loss: 0.1477790 Vali Accuracy: 0.9527401  Vali weighted F1: 0.9531052  Vali macro F1 0.9386629 
new best score!!!!
Validation loss decreased (0.172186 --> 0.147779).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.113318920135498
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1561676  Vali Loss: 0.1473373 Vali Accuracy: 0.9527401  Vali weighted F1: 0.9531187  Vali macro F1 0.9379616 
new best score!!!!
Validation loss decreased (0.147779 --> 0.147337).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.146347999572754
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1384463  Vali Loss: 0.1385806 Vali Accuracy: 0.9497235  Vali weighted F1: 0.9500657  Vali macro F1 0.9307595 
new best score!!!!
Validation loss decreased (0.147337 --> 0.138581).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.118289947509766
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1333947  Vali Loss: 0.1333291 Vali Accuracy: 0.9517345  Vali weighted F1: 0.9519532  Vali macro F1 0.9358087 
new best score!!!!
Validation loss decreased (0.138581 --> 0.133329).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.113823652267456
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1291371  Vali Loss: 0.1320411 Vali Accuracy: 0.9572650  Vali weighted F1: 0.9572854  Vali macro F1 0.9428730 
new best score!!!!
Validation loss decreased (0.133329 --> 0.132041).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.150245428085327
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1220919  Vali Loss: 0.1097899 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9629558  Vali macro F1 0.9509184 
new best score!!!!
Validation loss decreased (0.132041 --> 0.109790).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1229493618011475
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1108093  Vali Loss: 0.1238794 Vali Accuracy: 0.9592760  Vali weighted F1: 0.9589145  Vali macro F1 0.9473691 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.113687992095947
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1140049  Vali Loss: 0.0989707 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9659428  Vali macro F1 0.9571863 
new best score!!!!
Validation loss decreased (0.109790 --> 0.098971).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.137366533279419
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1035617  Vali Loss: 0.1025812 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9690167  Vali macro F1 0.9572411 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.143134593963623
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0927233  Vali Loss: 0.0935685 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9635787  Vali macro F1 0.9463542 
new best score!!!!
Validation loss decreased (0.098971 --> 0.093569).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.1305906772613525
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0942327  Vali Loss: 0.0946142 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9682794  Vali macro F1 0.9544380 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.123514413833618
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0838372  Vali Loss: 0.0822296 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9743396  Vali macro F1 0.9654857 
new best score!!!!
Validation loss decreased (0.093569 --> 0.082230).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.122887134552002
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0812384  Vali Loss: 0.1070973 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9635371  Vali macro F1 0.9565540 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.144512891769409
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0776262  Vali Loss: 0.0766608 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9730519  Vali macro F1 0.9655459 
new best score!!!!
Validation loss decreased (0.082230 --> 0.076661).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.121241569519043
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0722262  Vali Loss: 0.0968966 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9657675  Vali macro F1 0.9562689 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.131746530532837
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0727684  Vali Loss: 0.0808071 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9703721  Vali macro F1 0.9613154 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.126995801925659
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0658859  Vali Loss: 0.0617906 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9745318  Vali macro F1 0.9654613 
new best score!!!!
Validation loss decreased (0.076661 --> 0.061791).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.13861346244812
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0699235  Vali Loss: 0.0832351 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9712682  Vali macro F1 0.9636107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.148911237716675
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0647495  Vali Loss: 0.0610133 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9780040  Vali macro F1 0.9695584 
new best score!!!!
Validation loss decreased (0.061791 --> 0.061013).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.145610809326172
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0683853  Vali Loss: 0.0585645 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794864  Vali macro F1 0.9712872 
new best score!!!!
Validation loss decreased (0.061013 --> 0.058564).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.128472328186035
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0531385  Vali Loss: 0.0575342 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9784228  Vali macro F1 0.9729340 
new best score!!!!
Validation loss decreased (0.058564 --> 0.057534).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.132462978363037
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0558893  Vali Loss: 0.0534390 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804595  Vali macro F1 0.9729444 
new best score!!!!
Validation loss decreased (0.057534 --> 0.053439).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.126418828964233
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0540511  Vali Loss: 0.0649183 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9763672  Vali macro F1 0.9700207 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.133656978607178
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0525944  Vali Loss: 0.0527407 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813799  Vali macro F1 0.9768656 
new best score!!!!
Validation loss decreased (0.053439 --> 0.052741).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.14133620262146
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0510316  Vali Loss: 0.0609287 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808530  Vali macro F1 0.9730538 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.122591018676758
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0469445  Vali Loss: 0.0512426 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854237  Vali macro F1 0.9796844 
new best score!!!!
Validation loss decreased (0.052741 --> 0.051243).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.1239423751831055
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0444010  Vali Loss: 0.0595249 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9781295  Vali macro F1 0.9722931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.126806259155273
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0468237  Vali Loss: 0.0554360 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823415  Vali macro F1 0.9771480 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.1231114864349365
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0439831  Vali Loss: 0.0672109 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9743454  Vali macro F1 0.9657095 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.125990152359009
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0449175  Vali Loss: 0.0557814 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789731  Vali macro F1 0.9689901 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.134862184524536
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0408952  Vali Loss: 0.0789903 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9752647  Vali macro F1 0.9686829 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 6.152334451675415
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0318457  Vali Loss: 0.0476509 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839524  Vali macro F1 0.9795123 
new best score!!!!
Validation loss decreased (0.051243 --> 0.047651).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.120407819747925
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0296948  Vali Loss: 0.0448116 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849801  Vali macro F1 0.9801380 
new best score!!!!
Validation loss decreased (0.047651 --> 0.044812).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.121404409408569
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0288962  Vali Loss: 0.0445949 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849342  Vali macro F1 0.9806486 
new best score!!!!
Validation loss decreased (0.044812 --> 0.044595).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.114917516708374
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0281594  Vali Loss: 0.0468866 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9815332  Vali macro F1 0.9757286 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.113590478897095
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0271704  Vali Loss: 0.0445198 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849332  Vali macro F1 0.9807706 
new best score!!!!
Validation loss decreased (0.044595 --> 0.044520).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.118283033370972
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0287285  Vali Loss: 0.0436605 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859273  Vali macro F1 0.9818407 
new best score!!!!
Validation loss decreased (0.044520 --> 0.043661).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.136877536773682
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0275417  Vali Loss: 0.0440820 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849486  Vali macro F1 0.9790222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.136123418807983
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0266631  Vali Loss: 0.0470271 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834170  Vali macro F1 0.9792508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.121666193008423
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0260668  Vali Loss: 0.0425262 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864443  Vali macro F1 0.9808598 
new best score!!!!
Validation loss decreased (0.043661 --> 0.042526).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.126784086227417
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0255323  Vali Loss: 0.0432903 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854332  Vali macro F1 0.9811476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.121715307235718
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0261224  Vali Loss: 0.0441391 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854687  Vali macro F1 0.9813096 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.120992660522461
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0262280  Vali Loss: 0.0443537 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854141  Vali macro F1 0.9810879 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.120649099349976
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0262939  Vali Loss: 0.0431495 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849525  Vali macro F1 0.9807426 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.143289089202881
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0254535  Vali Loss: 0.0453884 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854186  Vali macro F1 0.9809502 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.1300129890441895
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0247739  Vali Loss: 0.0443499 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844383  Vali macro F1 0.9800449 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.125978946685791
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0231205  Vali Loss: 0.0442346 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849282  Vali macro F1 0.9804828 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.120704412460327
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0245924  Vali Loss: 0.0442499 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839372  Vali macro F1 0.9792092 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.125170469284058
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0241488  Vali Loss: 0.0443790 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844383  Vali macro F1 0.9800166 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.133588790893555
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0234533  Vali Loss: 0.0440033 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844383  Vali macro F1 0.9800166 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 6.133924245834351
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0241549  Vali Loss: 0.0440135 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839372  Vali macro F1 0.9792092 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.151670932769775
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0232919  Vali Loss: 0.0439391 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839372  Vali macro F1 0.9792092 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.1350367069244385
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0229839  Vali Loss: 0.0439751 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839372  Vali macro F1 0.9792092 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.128972768783569
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0240916  Vali Loss: 0.0439803 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839372  Vali macro F1 0.9792092 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.13543438911438
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0248826  Vali Loss: 0.0439920 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839372  Vali macro F1 0.9792092 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8958480  Test weighted F1: 0.8982394  Test macro F1 0.8599865 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.159624814987183
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0281992  Vali Loss: 0.0418725 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859285  Vali macro F1 0.9803405 
Validation loss decreased (inf --> 0.041873).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.148391485214233
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0254065  Vali Loss: 0.0428642 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854074  Vali macro F1 0.9816498 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.173218011856079
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0255966  Vali Loss: 0.0486220 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844252  Vali macro F1 0.9788064 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.148658037185669
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0249954  Vali Loss: 0.0404444 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884305  Vali macro F1 0.9842391 
new best score!!!!
Validation loss decreased (0.041873 --> 0.040444).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.156892776489258
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0264364  Vali Loss: 0.0425140 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849714  Vali macro F1 0.9807427 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.149710655212402
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0271163  Vali Loss: 0.0482442 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834286  Vali macro F1 0.9778316 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.150522470474243
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0258001  Vali Loss: 0.0425325 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849679  Vali macro F1 0.9806354 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.15476655960083
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0237872  Vali Loss: 0.0432961 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854526  Vali macro F1 0.9799264 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.167147159576416
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0250679  Vali Loss: 0.0468723 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838974  Vali macro F1 0.9783086 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.1734912395477295
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0234589  Vali Loss: 0.0453181 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859042  Vali macro F1 0.9798841 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.1703526973724365
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0241466  Vali Loss: 0.0457697 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854079  Vali macro F1 0.9795323 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.16323184967041
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0232315  Vali Loss: 0.0443281 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839352  Vali macro F1 0.9781298 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.159894943237305
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0231018  Vali Loss: 0.0457765 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844210  Vali macro F1 0.9783086 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.1598615646362305
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0217541  Vali Loss: 0.0454332 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9829500  Vali macro F1 0.9771383 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.159154891967773
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0220239  Vali Loss: 0.0447875 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844407  Vali macro F1 0.9783684 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.158204078674316
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0221145  Vali Loss: 0.0448392 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839433  Vali macro F1 0.9778182 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.169478893280029
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0203790  Vali Loss: 0.0447978 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854219  Vali macro F1 0.9807767 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.144276142120361
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0225287  Vali Loss: 0.0444619 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849361  Vali macro F1 0.9801420 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.14562201499939
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0229309  Vali Loss: 0.0446354 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844414  Vali macro F1 0.9795662 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9048959  Test weighted F1: 0.9049538  Test macro F1 0.8645871 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014928 0.00018305 0.00110011 0.00139082 0.00051151 0.00062189]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.971820592880249
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.2612481  Vali Loss: 0.7856136 Vali Accuracy: 0.6775531  Vali weighted F1: 0.5761850  Vali macro F1 0.2925992 
Validation loss decreased (inf --> 0.785614).  Saving model ...
Epoch: 2 cost time: 5.958714962005615
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.6609042  Vali Loss: 0.5675000 Vali Accuracy: 0.7760498  Vali weighted F1: 0.7279773  Vali macro F1 0.5389344 
new best score!!!!
Validation loss decreased (0.785614 --> 0.567500).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.9692933559417725
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.4816521  Vali Loss: 0.4399019 Vali Accuracy: 0.8491446  Vali weighted F1: 0.8302325  Vali macro F1 0.7807720 
new best score!!!!
Validation loss decreased (0.567500 --> 0.439902).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.976263999938965
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.3567219  Vali Loss: 0.3531536 Vali Accuracy: 0.8776568  Vali weighted F1: 0.8723272  Vali macro F1 0.8311199 
new best score!!!!
Validation loss decreased (0.439902 --> 0.353154).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.970287799835205
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2912793  Vali Loss: 0.3004537 Vali Accuracy: 0.9025402  Vali weighted F1: 0.8996512  Vali macro F1 0.8602360 
new best score!!!!
Validation loss decreased (0.353154 --> 0.300454).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.981952667236328
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2224444  Vali Loss: 0.2328607 Vali Accuracy: 0.9258683  Vali weighted F1: 0.9249888  Vali macro F1 0.8939745 
new best score!!!!
Validation loss decreased (0.300454 --> 0.232861).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.986715316772461
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1927730  Vali Loss: 0.2216235 Vali Accuracy: 0.9289787  Vali weighted F1: 0.9279558  Vali macro F1 0.8982871 
new best score!!!!
Validation loss decreased (0.232861 --> 0.221623).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.990142822265625
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1762439  Vali Loss: 0.1840275 Vali Accuracy: 0.9300156  Vali weighted F1: 0.9287204  Vali macro F1 0.8982002 
new best score!!!!
Validation loss decreased (0.221623 --> 0.184027).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.966504812240601
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1687873  Vali Loss: 0.1792012 Vali Accuracy: 0.9429756  Vali weighted F1: 0.9423143  Vali macro F1 0.9214356 
new best score!!!!
Validation loss decreased (0.184027 --> 0.179201).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.007134914398193
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1424846  Vali Loss: 0.1505763 Vali Accuracy: 0.9523069  Vali weighted F1: 0.9526618  Vali macro F1 0.9345688 
new best score!!!!
Validation loss decreased (0.179201 --> 0.150576).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.992779970169067
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1353151  Vali Loss: 0.1527718 Vali Accuracy: 0.9497149  Vali weighted F1: 0.9500030  Vali macro F1 0.9307996 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.972013235092163
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1306669  Vali Loss: 0.1302826 Vali Accuracy: 0.9543805  Vali weighted F1: 0.9541818  Vali macro F1 0.9380865 
new best score!!!!
Validation loss decreased (0.150576 --> 0.130283).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.982658624649048
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1242299  Vali Loss: 0.1564303 Vali Accuracy: 0.9491965  Vali weighted F1: 0.9482271  Vali macro F1 0.9341851 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.983899354934692
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1117936  Vali Loss: 0.1323756 Vali Accuracy: 0.9606013  Vali weighted F1: 0.9606362  Vali macro F1 0.9488143 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.975604057312012
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1055123  Vali Loss: 0.1049645 Vali Accuracy: 0.9637118  Vali weighted F1: 0.9636296  Vali macro F1 0.9524791 
new best score!!!!
Validation loss decreased (0.130283 --> 0.104964).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.976527690887451
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0948535  Vali Loss: 0.1026369 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9657709  Vali macro F1 0.9562105 
new best score!!!!
Validation loss decreased (0.104964 --> 0.102637).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.998004674911499
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1045269  Vali Loss: 0.0994503 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9681051  Vali macro F1 0.9597786 
new best score!!!!
Validation loss decreased (0.102637 --> 0.099450).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.97488808631897
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0869092  Vali Loss: 0.1036016 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9686392  Vali macro F1 0.9599127 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.968047142028809
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0872080  Vali Loss: 0.0897320 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9713450  Vali macro F1 0.9628843 
new best score!!!!
Validation loss decreased (0.099450 --> 0.089732).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.972728729248047
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0769606  Vali Loss: 0.0969770 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9700367  Vali macro F1 0.9599751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.979671001434326
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0740062  Vali Loss: 0.1031912 Vali Accuracy: 0.9652670  Vali weighted F1: 0.9653178  Vali macro F1 0.9555136 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.983530759811401
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0770041  Vali Loss: 0.0762779 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9729324  Vali macro F1 0.9637912 
new best score!!!!
Validation loss decreased (0.089732 --> 0.076278).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.981517553329468
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0714858  Vali Loss: 0.0641671 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9788339  Vali macro F1 0.9708906 
new best score!!!!
Validation loss decreased (0.076278 --> 0.064167).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.992498874664307
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0615539  Vali Loss: 0.0789669 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9730453  Vali macro F1 0.9631185 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.984755277633667
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0580853  Vali Loss: 0.0762525 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9760239  Vali macro F1 0.9684288 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.979357004165649
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0556928  Vali Loss: 0.0752226 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762408  Vali macro F1 0.9685601 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.9824442863464355
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0509128  Vali Loss: 0.0693497 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9765776  Vali macro F1 0.9710350 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.979910135269165
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0527906  Vali Loss: 0.0723422 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9774077  Vali macro F1 0.9688271 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 5.9807045459747314
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0424612  Vali Loss: 0.0615094 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818501  Vali macro F1 0.9761730 
new best score!!!!
Validation loss decreased (0.064167 --> 0.061509).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.9877636432647705
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0375646  Vali Loss: 0.0609223 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823234  Vali macro F1 0.9774496 
new best score!!!!
Validation loss decreased (0.061509 --> 0.060922).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.967426538467407
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0366282  Vali Loss: 0.0594189 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823134  Vali macro F1 0.9774468 
new best score!!!!
Validation loss decreased (0.060922 --> 0.059419).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.954059362411499
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0354683  Vali Loss: 0.0572217 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808453  Vali macro F1 0.9742920 
new best score!!!!
Validation loss decreased (0.059419 --> 0.057222).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.939685344696045
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0360454  Vali Loss: 0.0587774 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813258  Vali macro F1 0.9748287 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.941856622695923
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0350615  Vali Loss: 0.0578663 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818661  Vali macro F1 0.9762553 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.941549777984619
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0351924  Vali Loss: 0.0576752 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818568  Vali macro F1 0.9760218 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.949707984924316
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0336122  Vali Loss: 0.0572638 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833869  Vali macro F1 0.9781327 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.945659637451172
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0338594  Vali Loss: 0.0580286 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802820  Vali macro F1 0.9735146 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 5.9691712856292725
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0331209  Vali Loss: 0.0572148 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823556  Vali macro F1 0.9764886 
new best score!!!!
Validation loss decreased (0.057222 --> 0.057215).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.963899612426758
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0324431  Vali Loss: 0.0576372 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808018  Vali macro F1 0.9747216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.949270486831665
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0310858  Vali Loss: 0.0578643 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818236  Vali macro F1 0.9759870 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.958126544952393
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0326005  Vali Loss: 0.0571977 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818236  Vali macro F1 0.9759870 
new best score!!!!
Validation loss decreased (0.057215 --> 0.057198).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.951850652694702
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0325849  Vali Loss: 0.0573451 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823394  Vali macro F1 0.9768097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.944517612457275
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0324582  Vali Loss: 0.0567423 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
new best score!!!!
Validation loss decreased (0.057198 --> 0.056742).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.938464403152466
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0331955  Vali Loss: 0.0575158 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823394  Vali macro F1 0.9768097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.958874702453613
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0316357  Vali Loss: 0.0566505 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
new best score!!!!
Validation loss decreased (0.056742 --> 0.056650).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 5.947941303253174
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0330430  Vali Loss: 0.0567482 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823556  Vali macro F1 0.9764886 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.93637490272522
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0317301  Vali Loss: 0.0569304 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.944230794906616
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0323384  Vali Loss: 0.0567235 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 5.941087961196899
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0321716  Vali Loss: 0.0570731 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 5.943340301513672
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0312477  Vali Loss: 0.0567122 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 5.932863235473633
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0334552  Vali Loss: 0.0568267 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823556  Vali macro F1 0.9764886 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 5.9559314250946045
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0308693  Vali Loss: 0.0567942 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 5.937731027603149
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0319791  Vali Loss: 0.0568099 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 5.930485963821411
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0313132  Vali Loss: 0.0568253 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 5.935775995254517
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0315300  Vali Loss: 0.0568553 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 56 cost time: 5.9348108768463135
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0308087  Vali Loss: 0.0568686 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 5.942084550857544
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0327867  Vali Loss: 0.0568568 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 5.9374611377716064
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0304432  Vali Loss: 0.0568646 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 5.951703071594238
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0323014  Vali Loss: 0.0568578 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 5.951466083526611
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0313770  Vali Loss: 0.0568596 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828715  Vali macro F1 0.9773114 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9303973  Test weighted F1: 0.9307550  Test macro F1 0.8726707 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.009012222290039
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0329358  Vali Loss: 0.0587163 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9791832  Vali macro F1 0.9723529 
Validation loss decreased (inf --> 0.058716).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.946603536605835
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0345177  Vali Loss: 0.0571312 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818505  Vali macro F1 0.9759011 
new best score!!!!
Validation loss decreased (0.058716 --> 0.057131).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.94318151473999
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0319084  Vali Loss: 0.0576286 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818426  Vali macro F1 0.9760501 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.947702407836914
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0324633  Vali Loss: 0.0587501 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813266  Vali macro F1 0.9753743 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.978464126586914
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0321743  Vali Loss: 0.0609978 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9786264  Vali macro F1 0.9729720 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 5.966760873794556
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0312673  Vali Loss: 0.0600389 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9796699  Vali macro F1 0.9743012 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 5.970663785934448
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0299776  Vali Loss: 0.0566523 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833984  Vali macro F1 0.9779479 
new best score!!!!
Validation loss decreased (0.057131 --> 0.056652).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 5.965886831283569
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0311334  Vali Loss: 0.0593694 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812848  Vali macro F1 0.9754842 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 5.965437650680542
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0308521  Vali Loss: 0.0567672 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808448  Vali macro F1 0.9742986 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 5.958864688873291
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0291820  Vali Loss: 0.0611728 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802327  Vali macro F1 0.9748278 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 5.9587507247924805
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0296703  Vali Loss: 0.0560389 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823707  Vali macro F1 0.9765942 
new best score!!!!
Validation loss decreased (0.056652 --> 0.056039).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 5.976846933364868
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0292512  Vali Loss: 0.0576342 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817881  Vali macro F1 0.9767074 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 5.976215600967407
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0279986  Vali Loss: 0.0595813 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9807709  Vali macro F1 0.9754196 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 5.960752964019775
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0275352  Vali Loss: 0.0581219 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9781527  Vali macro F1 0.9715620 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 5.961552858352661
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0287483  Vali Loss: 0.0587906 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808525  Vali macro F1 0.9750813 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 5.96115779876709
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0275171  Vali Loss: 0.0578432 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823607  Vali macro F1 0.9774422 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 5.960883140563965
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0286431  Vali Loss: 0.0673436 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9796791  Vali macro F1 0.9738764 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 5.973480701446533
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0278576  Vali Loss: 0.0630963 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802319  Vali macro F1 0.9747707 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 5.986112356185913
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0262781  Vali Loss: 0.0587666 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9807390  Vali macro F1 0.9762359 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 5.982424736022949
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0275271  Vali Loss: 0.0553100 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829217  Vali macro F1 0.9777810 
new best score!!!!
Validation loss decreased (0.056039 --> 0.055310).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 5.94687294960022
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0270663  Vali Loss: 0.0575822 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802822  Vali macro F1 0.9746817 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 5.951235055923462
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0249930  Vali Loss: 0.0564925 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818035  Vali macro F1 0.9771664 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 5.9620397090911865
Fine Tuning VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0249618  Vali Loss: 0.0622470 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792002  Vali macro F1 0.9743884 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 5.950810432434082
Fine Tuning VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0249871  Vali Loss: 0.0591065 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812784  Vali macro F1 0.9749233 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 5.955801248550415
Fine Tuning VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0257609  Vali Loss: 0.0574541 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823476  Vali macro F1 0.9771371 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 5.984213829040527
Fine Tuning VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0228128  Vali Loss: 0.0565050 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823510  Vali macro F1 0.9777683 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 5.970810651779175
Fine Tuning VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0235761  Vali Loss: 0.0559363 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813213  Vali macro F1 0.9758190 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 5.9543352127075195
Fine Tuning VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0242139  Vali Loss: 0.0562230 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818191  Vali macro F1 0.9767049 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 5.950732946395874
Fine Tuning VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0229433  Vali Loss: 0.0562009 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813103  Vali macro F1 0.9761343 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 5.953636884689331
Fine Tuning VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0223017  Vali Loss: 0.0559832 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813103  Vali macro F1 0.9761343 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 5.961381673812866
Fine Tuning VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0232039  Vali Loss: 0.0559319 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813103  Vali macro F1 0.9761343 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 5.964779853820801
Fine Tuning VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0227266  Vali Loss: 0.0559098 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813103  Vali macro F1 0.9761343 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 5.987670421600342
Fine Tuning VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0224186  Vali Loss: 0.0558500 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818400  Vali macro F1 0.9766328 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 5.966659307479858
Fine Tuning VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0233506  Vali Loss: 0.0557968 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818400  Vali macro F1 0.9766328 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 5.955058574676514
Fine Tuning VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0236119  Vali Loss: 0.0557537 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818400  Vali macro F1 0.9766328 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9292424  Test weighted F1: 0.9298140  Test macro F1 0.8710205 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014773 0.00018282 0.00097561 0.00126743 0.0005005  0.00061237]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.11622953414917
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2524840  Vali Loss: 0.7482550 Vali Accuracy: 0.7048346  Vali weighted F1: 0.6252931  Vali macro F1 0.3521873 
Validation loss decreased (inf --> 0.748255).  Saving model ...
Epoch: 2 cost time: 6.0437891483306885
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6637416  Vali Loss: 0.5627388 Vali Accuracy: 0.7806616  Vali weighted F1: 0.7309158  Vali macro F1 0.5180666 
new best score!!!!
Validation loss decreased (0.748255 --> 0.562739).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.0556769371032715
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5378313  Vali Loss: 0.4726945 Vali Accuracy: 0.8452926  Vali weighted F1: 0.8247606  Vali macro F1 0.7513000 
new best score!!!!
Validation loss decreased (0.562739 --> 0.472694).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.0636584758758545
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4223031  Vali Loss: 0.3970108 Vali Accuracy: 0.8651399  Vali weighted F1: 0.8513766  Vali macro F1 0.8018126 
new best score!!!!
Validation loss decreased (0.472694 --> 0.397011).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.0522990226745605
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3442440  Vali Loss: 0.2945730 Vali Accuracy: 0.8997455  Vali weighted F1: 0.8922011  Vali macro F1 0.8538025 
new best score!!!!
Validation loss decreased (0.397011 --> 0.294573).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.047438621520996
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2576174  Vali Loss: 0.2118886 Vali Accuracy: 0.9297710  Vali weighted F1: 0.9298598  Vali macro F1 0.9039869 
new best score!!!!
Validation loss decreased (0.294573 --> 0.211889).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.080074310302734
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2165432  Vali Loss: 0.1935022 Vali Accuracy: 0.9409669  Vali weighted F1: 0.9412346  Vali macro F1 0.9183912 
new best score!!!!
Validation loss decreased (0.211889 --> 0.193502).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.073160409927368
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1820828  Vali Loss: 0.2020288 Vali Accuracy: 0.9312977  Vali weighted F1: 0.9305905  Vali macro F1 0.9064406 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.054889440536499
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1750029  Vali Loss: 0.1662563 Vali Accuracy: 0.9511450  Vali weighted F1: 0.9516754  Vali macro F1 0.9337253 
new best score!!!!
Validation loss decreased (0.193502 --> 0.166256).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.072425842285156
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1652449  Vali Loss: 0.1612633 Vali Accuracy: 0.9531807  Vali weighted F1: 0.9527683  Vali macro F1 0.9365572 
new best score!!!!
Validation loss decreased (0.166256 --> 0.161263).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.075647830963135
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1548734  Vali Loss: 0.1625455 Vali Accuracy: 0.9531807  Vali weighted F1: 0.9527231  Vali macro F1 0.9362823 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.072050333023071
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1470340  Vali Loss: 0.1418142 Vali Accuracy: 0.9592875  Vali weighted F1: 0.9595707  Vali macro F1 0.9460416 
new best score!!!!
Validation loss decreased (0.161263 --> 0.141814).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.06647801399231
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1462251  Vali Loss: 0.1574077 Vali Accuracy: 0.9506361  Vali weighted F1: 0.9502038  Vali macro F1 0.9340726 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.062732696533203
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1325247  Vali Loss: 0.1932249 Vali Accuracy: 0.9435115  Vali weighted F1: 0.9444559  Vali macro F1 0.9287068 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.076552391052246
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1369396  Vali Loss: 0.1469707 Vali Accuracy: 0.9531807  Vali weighted F1: 0.9530259  Vali macro F1 0.9356569 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 6.069097280502319
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1339754  Vali Loss: 0.1262665 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9602854  Vali macro F1 0.9456334 
new best score!!!!
Validation loss decreased (0.141814 --> 0.126267).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.072286367416382
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1184492  Vali Loss: 0.1160529 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9615847  Vali macro F1 0.9465913 
new best score!!!!
Validation loss decreased (0.126267 --> 0.116053).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.076856851577759
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1105018  Vali Loss: 0.1169695 Vali Accuracy: 0.9623410  Vali weighted F1: 0.9627037  Vali macro F1 0.9488012 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.076109409332275
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1042895  Vali Loss: 0.1054241 Vali Accuracy: 0.9659033  Vali weighted F1: 0.9659515  Vali macro F1 0.9563916 
new best score!!!!
Validation loss decreased (0.116053 --> 0.105424).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.059099197387695
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0888727  Vali Loss: 0.0968358 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9692653  Vali macro F1 0.9602021 
new best score!!!!
Validation loss decreased (0.105424 --> 0.096836).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.059819936752319
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0851468  Vali Loss: 0.1234296 Vali Accuracy: 0.9592875  Vali weighted F1: 0.9601398  Vali macro F1 0.9483066 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.049171209335327
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0986568  Vali Loss: 0.0898109 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9691090  Vali macro F1 0.9598332 
new best score!!!!
Validation loss decreased (0.096836 --> 0.089811).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.061310291290283
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0818835  Vali Loss: 0.1037396 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9644791  Vali macro F1 0.9522591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.13178563117981
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0791753  Vali Loss: 0.0900531 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697696  Vali macro F1 0.9577872 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.098111629486084
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0759708  Vali Loss: 0.0934182 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9703222  Vali macro F1 0.9621123 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.0664496421813965
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0717842  Vali Loss: 0.0820090 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9728675  Vali macro F1 0.9626768 
new best score!!!!
Validation loss decreased (0.089811 --> 0.082009).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.06304144859314
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0649267  Vali Loss: 0.1014456 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9675420  Vali macro F1 0.9546575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.057882785797119
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0652386  Vali Loss: 0.0966295 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9701378  Vali macro F1 0.9582289 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.0619471073150635
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0593899  Vali Loss: 0.0881150 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9724912  Vali macro F1 0.9634175 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.062351942062378
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0589085  Vali Loss: 0.0804539 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9726471  Vali macro F1 0.9601421 
new best score!!!!
Validation loss decreased (0.082009 --> 0.080454).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.080441951751709
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0595451  Vali Loss: 0.0882832 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9718901  Vali macro F1 0.9599736 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.063572883605957
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0583529  Vali Loss: 0.0726184 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9781748  Vali macro F1 0.9692006 
new best score!!!!
Validation loss decreased (0.080454 --> 0.072618).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.068890333175659
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0580330  Vali Loss: 0.0799859 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9753383  Vali macro F1 0.9656170 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.069232940673828
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0554335  Vali Loss: 0.0871211 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9734532  Vali macro F1 0.9638637 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.069129467010498
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0507600  Vali Loss: 0.0614839 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9791751  Vali macro F1 0.9715056 
new best score!!!!
Validation loss decreased (0.072618 --> 0.061484).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.057175397872925
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0520187  Vali Loss: 0.0908295 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9737383  Vali macro F1 0.9623788 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.0591630935668945
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0569405  Vali Loss: 0.0630708 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9783002  Vali macro F1 0.9690305 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.078418254852295
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0506848  Vali Loss: 0.0657071 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9784487  Vali macro F1 0.9700944 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.07599139213562
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0382230  Vali Loss: 0.0821631 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9786070  Vali macro F1 0.9716467 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.065109014511108
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0451272  Vali Loss: 0.0601366 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828364  Vali macro F1 0.9762334 
new best score!!!!
Validation loss decreased (0.061484 --> 0.060137).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.064041376113892
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0389293  Vali Loss: 0.0573709 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9796831  Vali macro F1 0.9695623 
new best score!!!!
Validation loss decreased (0.060137 --> 0.057371).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.061117172241211
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0345348  Vali Loss: 0.0525788 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9811842  Vali macro F1 0.9743888 
new best score!!!!
Validation loss decreased (0.057371 --> 0.052579).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.060931444168091
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0382394  Vali Loss: 0.0619171 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823183  Vali macro F1 0.9749094 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.058069467544556
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0405688  Vali Loss: 0.0551283 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9812777  Vali macro F1 0.9738938 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.080408811569214
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0332745  Vali Loss: 0.0633731 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9814236  Vali macro F1 0.9741436 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.068944454193115
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0325451  Vali Loss: 0.0696235 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9794372  Vali macro F1 0.9705235 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.060542345046997
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0320828  Vali Loss: 0.0651389 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817481  Vali macro F1 0.9744130 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 48 cost time: 6.0669214725494385
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0234733  Vali Loss: 0.0530641 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832281  Vali macro F1 0.9759700 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.072866201400757
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0202903  Vali Loss: 0.0508022 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848006  Vali macro F1 0.9785923 
new best score!!!!
Validation loss decreased (0.052579 --> 0.050802).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.082921266555786
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0220248  Vali Loss: 0.0524181 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853179  Vali macro F1 0.9790983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.065774440765381
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0227561  Vali Loss: 0.0515853 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837386  Vali macro F1 0.9769334 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.087906122207642
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0231253  Vali Loss: 0.0507993 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842266  Vali macro F1 0.9766580 
new best score!!!!
Validation loss decreased (0.050802 --> 0.050799).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.06313681602478
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0212300  Vali Loss: 0.0493476 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832547  Vali macro F1 0.9759971 
new best score!!!!
Validation loss decreased (0.050799 --> 0.049348).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.073007106781006
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0198835  Vali Loss: 0.0498792 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842915  Vali macro F1 0.9770132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.06766939163208
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0210441  Vali Loss: 0.0515274 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847974  Vali macro F1 0.9778619 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.068913459777832
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0182769  Vali Loss: 0.0495446 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842567  Vali macro F1 0.9772995 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.073421955108643
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0207136  Vali Loss: 0.0512774 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852544  Vali macro F1 0.9778739 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.082045316696167
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0196327  Vali Loss: 0.0497802 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842915  Vali macro F1 0.9770132 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 59 cost time: 6.085136651992798
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0190896  Vali Loss: 0.0488903 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
new best score!!!!
Validation loss decreased (0.049348 --> 0.048890).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.05072808265686
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0192270  Vali Loss: 0.0488137 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
new best score!!!!
Validation loss decreased (0.048890 --> 0.048814).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.057413816452026
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0196705  Vali Loss: 0.0482684 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
new best score!!!!
Validation loss decreased (0.048814 --> 0.048268).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.058613538742065
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0188235  Vali Loss: 0.0476522 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
new best score!!!!
Validation loss decreased (0.048268 --> 0.047652).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 6.057833433151245
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0197411  Vali Loss: 0.0484864 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 6.053551197052002
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0186845  Vali Loss: 0.0484775 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 6.066298484802246
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0191665  Vali Loss: 0.0480676 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 6.069575071334839
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0188509  Vali Loss: 0.0482807 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 6.059471607208252
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0186082  Vali Loss: 0.0489305 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 68 cost time: 6.058674335479736
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0193999  Vali Loss: 0.0488479 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 6.063149929046631
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0180275  Vali Loss: 0.0488267 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 6.066270112991333
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0184666  Vali Loss: 0.0487995 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 6.0533623695373535
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0180846  Vali Loss: 0.0488097 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 6.078676462173462
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0180607  Vali Loss: 0.0488459 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 73 cost time: 6.067598581314087
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0178092  Vali Loss: 0.0488427 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 6.054841756820679
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0186534  Vali Loss: 0.0488409 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 6.058483362197876
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0184772  Vali Loss: 0.0488425 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 6.05523419380188
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0188182  Vali Loss: 0.0488363 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 6.05908465385437
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0197214  Vali Loss: 0.0488329 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837619  Vali macro F1 0.9755017 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8448090  Test weighted F1: 0.8515727  Test macro F1 0.8532654 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.102976560592651
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0184807  Vali Loss: 0.0533638 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832410  Vali macro F1 0.9763354 
Validation loss decreased (inf --> 0.053364).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.078618764877319
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0195133  Vali Loss: 0.0531369 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842826  Vali macro F1 0.9780849 
new best score!!!!
Validation loss decreased (0.053364 --> 0.053137).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.066426515579224
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0179358  Vali Loss: 0.0545379 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9843125  Vali macro F1 0.9770520 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.061176776885986
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0184298  Vali Loss: 0.0496049 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837422  Vali macro F1 0.9771885 
new best score!!!!
Validation loss decreased (0.053137 --> 0.049605).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.080637693405151
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0180105  Vali Loss: 0.0493989 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837552  Vali macro F1 0.9765659 
new best score!!!!
Validation loss decreased (0.049605 --> 0.049399).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.074530839920044
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0193411  Vali Loss: 0.0491927 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852367  Vali macro F1 0.9780819 
new best score!!!!
Validation loss decreased (0.049399 --> 0.049193).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.09488844871521
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0181683  Vali Loss: 0.0506551 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848036  Vali macro F1 0.9766343 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.087486267089844
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0178618  Vali Loss: 0.0478705 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847663  Vali macro F1 0.9775565 
new best score!!!!
Validation loss decreased (0.049193 --> 0.047870).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.097794771194458
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0182254  Vali Loss: 0.0518218 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832752  Vali macro F1 0.9745804 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.09001088142395
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0165994  Vali Loss: 0.0515190 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842794  Vali macro F1 0.9760289 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.093159914016724
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0159057  Vali Loss: 0.0493133 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852818  Vali macro F1 0.9772058 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.091677188873291
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0182527  Vali Loss: 0.0523362 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852717  Vali macro F1 0.9775509 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.086871862411499
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0180433  Vali Loss: 0.0497321 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847829  Vali macro F1 0.9767385 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 6.079038858413696
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0172302  Vali Loss: 0.0492004 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857613  Vali macro F1 0.9783238 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.110441446304321
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0169213  Vali Loss: 0.0494501 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837312  Vali macro F1 0.9753521 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.115737676620483
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0152240  Vali Loss: 0.0531758 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847965  Vali macro F1 0.9772629 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.08815336227417
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0151726  Vali Loss: 0.0521243 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842285  Vali macro F1 0.9764206 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.091638088226318
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0172303  Vali Loss: 0.0531829 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852871  Vali macro F1 0.9774504 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.086253643035889
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0147268  Vali Loss: 0.0524810 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852871  Vali macro F1 0.9774504 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.141330242156982
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0145856  Vali Loss: 0.0513660 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863095  Vali macro F1 0.9788041 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.083691835403442
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0155694  Vali Loss: 0.0515182 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852871  Vali macro F1 0.9774504 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.092576742172241
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0152163  Vali Loss: 0.0506566 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858033  Vali macro F1 0.9779549 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.071183919906616
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0173344  Vali Loss: 0.0503910 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858033  Vali macro F1 0.9779549 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8460642  Test weighted F1: 0.8529976  Test macro F1 0.8547575 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014881 0.00018454 0.00100503 0.00125313 0.00051787 0.00062112]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.014259338378906
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.2665244  Vali Loss: 0.7618467 Vali Accuracy: 0.6869207  Vali weighted F1: 0.5811487  Vali macro F1 0.2765415 
Validation loss decreased (inf --> 0.761847).  Saving model ...
Epoch: 2 cost time: 5.9760682582855225
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.7019895  Vali Loss: 0.5862991 Vali Accuracy: 0.7636457  Vali weighted F1: 0.7027374  Vali macro F1 0.4662990 
new best score!!!!
Validation loss decreased (0.761847 --> 0.586299).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.971487045288086
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.5709405  Vali Loss: 0.5093550 Vali Accuracy: 0.7960865  Vali weighted F1: 0.7506834  Vali macro F1 0.5349497 
new best score!!!!
Validation loss decreased (0.586299 --> 0.509355).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.983161211013794
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.4677208  Vali Loss: 0.3614319 Vali Accuracy: 0.8475798  Vali weighted F1: 0.8293818  Vali macro F1 0.6421535 
new best score!!!!
Validation loss decreased (0.509355 --> 0.361432).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.993369102478027
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.3139913  Vali Loss: 0.2352348 Vali Accuracy: 0.9222451  Vali weighted F1: 0.9194723  Vali macro F1 0.8827494 
new best score!!!!
Validation loss decreased (0.361432 --> 0.235235).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.992673635482788
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2332300  Vali Loss: 0.1875844 Vali Accuracy: 0.9366632  Vali weighted F1: 0.9365891  Vali macro F1 0.9029914 
new best score!!!!
Validation loss decreased (0.235235 --> 0.187584).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.991715908050537
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1954503  Vali Loss: 0.1680580 Vali Accuracy: 0.9469619  Vali weighted F1: 0.9469744  Vali macro F1 0.9232110 
new best score!!!!
Validation loss decreased (0.187584 --> 0.168058).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.992867946624756
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1755627  Vali Loss: 0.1926838 Vali Accuracy: 0.9387230  Vali weighted F1: 0.9403896  Vali macro F1 0.9177628 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.993398189544678
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1694368  Vali Loss: 0.1472513 Vali Accuracy: 0.9531411  Vali weighted F1: 0.9535903  Vali macro F1 0.9341721 
new best score!!!!
Validation loss decreased (0.168058 --> 0.147251).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.990493297576904
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1497346  Vali Loss: 0.1412996 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9543183  Vali macro F1 0.9357382 
new best score!!!!
Validation loss decreased (0.147251 --> 0.141300).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.9858012199401855
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1452733  Vali Loss: 0.1324203 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9550821  Vali macro F1 0.9376947 
new best score!!!!
Validation loss decreased (0.141300 --> 0.132420).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.007383823394775
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1297379  Vali Loss: 0.1248586 Vali Accuracy: 0.9552008  Vali weighted F1: 0.9548560  Vali macro F1 0.9366899 
new best score!!!!
Validation loss decreased (0.132420 --> 0.124859).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.9794628620147705
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1255217  Vali Loss: 0.1200478 Vali Accuracy: 0.9603502  Vali weighted F1: 0.9605302  Vali macro F1 0.9429976 
new best score!!!!
Validation loss decreased (0.124859 --> 0.120048).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.988333463668823
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1178096  Vali Loss: 0.1128899 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9634509  Vali macro F1 0.9466756 
new best score!!!!
Validation loss decreased (0.120048 --> 0.112890).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.006646394729614
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1094867  Vali Loss: 0.1226784 Vali Accuracy: 0.9593203  Vali weighted F1: 0.9595279  Vali macro F1 0.9423466 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.989416837692261
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1028790  Vali Loss: 0.1082983 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9640749  Vali macro F1 0.9468089 
new best score!!!!
Validation loss decreased (0.112890 --> 0.108298).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.983278751373291
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0996264  Vali Loss: 0.0978833 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9650971  Vali macro F1 0.9490080 
new best score!!!!
Validation loss decreased (0.108298 --> 0.097883).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.998225212097168
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0972901  Vali Loss: 0.1200560 Vali Accuracy: 0.9593203  Vali weighted F1: 0.9588692  Vali macro F1 0.9439700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.987612724304199
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0956525  Vali Loss: 0.1018549 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9643752  Vali macro F1 0.9473578 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.978559255599976
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0809804  Vali Loss: 0.0859781 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9735854  Vali macro F1 0.9648768 
new best score!!!!
Validation loss decreased (0.097883 --> 0.085978).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.9798150062561035
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0867352  Vali Loss: 0.0920625 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9673815  Vali macro F1 0.9507988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.979825019836426
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0791085  Vali Loss: 0.0818444 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9740470  Vali macro F1 0.9649734 
new best score!!!!
Validation loss decreased (0.085978 --> 0.081844).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.971697092056274
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0810975  Vali Loss: 0.0813950 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9696560  Vali macro F1 0.9597437 
new best score!!!!
Validation loss decreased (0.081844 --> 0.081395).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.978667497634888
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0692133  Vali Loss: 0.0945129 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9677379  Vali macro F1 0.9548985 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.000112056732178
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0701603  Vali Loss: 0.0951972 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9682014  Vali macro F1 0.9572468 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.996431589126587
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0618040  Vali Loss: 0.0918140 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9710694  Vali macro F1 0.9600195 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.98717474937439
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0599996  Vali Loss: 0.0771160 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9734934  Vali macro F1 0.9624183 
new best score!!!!
Validation loss decreased (0.081395 --> 0.077116).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.9930102825164795
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0577907  Vali Loss: 0.1015502 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9718797  Vali macro F1 0.9584496 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.987295866012573
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0541574  Vali Loss: 0.0765604 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9764433  Vali macro F1 0.9670662 
new best score!!!!
Validation loss decreased (0.077116 --> 0.076560).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.989523410797119
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0589301  Vali Loss: 0.0802698 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9741254  Vali macro F1 0.9663466 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.985682249069214
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0544746  Vali Loss: 0.0888249 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9731569  Vali macro F1 0.9633431 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.0025434494018555
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0515374  Vali Loss: 0.0837551 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724756  Vali macro F1 0.9600077 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.997442007064819
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0547006  Vali Loss: 0.0740376 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9749912  Vali macro F1 0.9658218 
new best score!!!!
Validation loss decreased (0.076560 --> 0.074038).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.99876070022583
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0495508  Vali Loss: 0.0753106 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9759242  Vali macro F1 0.9658343 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.989241361618042
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0513127  Vali Loss: 0.0672933 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9767557  Vali macro F1 0.9677614 
new best score!!!!
Validation loss decreased (0.074038 --> 0.067293).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.991557836532593
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0459021  Vali Loss: 0.0673513 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9768103  Vali macro F1 0.9663738 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.991705656051636
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0418972  Vali Loss: 0.0650990 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9795783  Vali macro F1 0.9708971 
new best score!!!!
Validation loss decreased (0.067293 --> 0.065099).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.986219167709351
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0421862  Vali Loss: 0.0591201 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9801319  Vali macro F1 0.9710154 
new best score!!!!
Validation loss decreased (0.065099 --> 0.059120).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.0180463790893555
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0420595  Vali Loss: 0.0754432 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9762992  Vali macro F1 0.9676104 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.025323867797852
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0368603  Vali Loss: 0.0715949 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9769760  Vali macro F1 0.9663141 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.016814231872559
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0405385  Vali Loss: 0.0595291 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9831162  Vali macro F1 0.9768318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.007966756820679
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0393911  Vali Loss: 0.0662387 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783068  Vali macro F1 0.9713484 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.007166385650635
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0377035  Vali Loss: 0.0578518 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820182  Vali macro F1 0.9742784 
new best score!!!!
Validation loss decreased (0.059120 --> 0.057852).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.000018119812012
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0413957  Vali Loss: 0.0684344 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9771382  Vali macro F1 0.9689056 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.001548767089844
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0303064  Vali Loss: 0.0817521 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9763096  Vali macro F1 0.9685721 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.026064157485962
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0297552  Vali Loss: 0.0624812 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815219  Vali macro F1 0.9750676 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.016096353530884
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0374000  Vali Loss: 0.0918683 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9731714  Vali macro F1 0.9658368 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.008892774581909
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0303704  Vali Loss: 0.0755826 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9790972  Vali macro F1 0.9711690 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 6.005621433258057
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0213727  Vali Loss: 0.0625342 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815722  Vali macro F1 0.9734385 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.993831157684326
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0202182  Vali Loss: 0.0637290 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810105  Vali macro F1 0.9727279 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.994186162948608
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0197760  Vali Loss: 0.0605531 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825495  Vali macro F1 0.9754077 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.003028869628906
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0186464  Vali Loss: 0.0635320 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815656  Vali macro F1 0.9741365 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.012833118438721
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0185241  Vali Loss: 0.0623622 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815242  Vali macro F1 0.9736278 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 6.014923572540283
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0176192  Vali Loss: 0.0615304 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810134  Vali macro F1 0.9727429 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.0141167640686035
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0192947  Vali Loss: 0.0617236 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810134  Vali macro F1 0.9727429 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.015361070632935
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0172297  Vali Loss: 0.0614063 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810134  Vali macro F1 0.9727429 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.000609636306763
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0185170  Vali Loss: 0.0614076 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810134  Vali macro F1 0.9727429 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.005859851837158
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0170403  Vali Loss: 0.0613174 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810134  Vali macro F1 0.9727429 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9732824  Test weighted F1: 0.9726091  Test macro F1 0.9610257 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.035895586013794
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0249333  Vali Loss: 0.0550741 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830707  Vali macro F1 0.9761116 
Validation loss decreased (inf --> 0.055074).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.0047454833984375
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0232077  Vali Loss: 0.0567735 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815646  Vali macro F1 0.9742200 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.992922306060791
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0231662  Vali Loss: 0.0607866 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809396  Vali macro F1 0.9725886 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.001352071762085
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0223851  Vali Loss: 0.0616511 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784806  Vali macro F1 0.9697760 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.002310037612915
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0217017  Vali Loss: 0.0556306 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815384  Vali macro F1 0.9734396 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.017536163330078
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0207108  Vali Loss: 0.0553016 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820232  Vali macro F1 0.9741922 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.0003252029418945
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0203353  Vali Loss: 0.0572618 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810549  Vali macro F1 0.9732511 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.012505054473877
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0205380  Vali Loss: 0.0604145 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814786  Vali macro F1 0.9725800 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.018009901046753
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0208418  Vali Loss: 0.0611760 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789552  Vali macro F1 0.9701465 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.996135234832764
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0206367  Vali Loss: 0.0579340 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824958  Vali macro F1 0.9756713 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.010480880737305
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0193223  Vali Loss: 0.0564077 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809917  Vali macro F1 0.9730507 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.008379220962524
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0179289  Vali Loss: 0.0563618 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815037  Vali macro F1 0.9739385 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.00400710105896
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0168825  Vali Loss: 0.0559030 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815232  Vali macro F1 0.9736834 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.995588541030884
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0182268  Vali Loss: 0.0562561 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804798  Vali macro F1 0.9721634 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.014997482299805
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0183795  Vali Loss: 0.0562021 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815239  Vali macro F1 0.9736941 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.033358335494995
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0216690  Vali Loss: 0.0561124 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815239  Vali macro F1 0.9736941 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9746630  Test weighted F1: 0.9740816  Test macro F1 0.9641971 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00015069 0.00018522 0.00137552 0.001443   0.00053476 0.00064267]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.817339181900024
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.2942742  Vali Loss: 0.7826313 Vali Accuracy: 0.6897655  Vali weighted F1: 0.5825758  Vali macro F1 0.2819935 
Validation loss decreased (inf --> 0.782631).  Saving model ...
Epoch: 2 cost time: 5.787506818771362
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.6637702  Vali Loss: 0.6242598 Vali Accuracy: 0.7665245  Vali weighted F1: 0.7040778  Vali macro F1 0.4800618 
new best score!!!!
Validation loss decreased (0.782631 --> 0.624260).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.779567003250122
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.5318800  Vali Loss: 0.5079839 Vali Accuracy: 0.8017058  Vali weighted F1: 0.7682532  Vali macro F1 0.5731888 
new best score!!!!
Validation loss decreased (0.624260 --> 0.507984).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.801828384399414
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.4319135  Vali Loss: 0.3777442 Vali Accuracy: 0.8630064  Vali weighted F1: 0.8544020  Vali macro F1 0.8085579 
new best score!!!!
Validation loss decreased (0.507984 --> 0.377744).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.81728458404541
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.3333462  Vali Loss: 0.3296706 Vali Accuracy: 0.8773987  Vali weighted F1: 0.8745038  Vali macro F1 0.8318773 
new best score!!!!
Validation loss decreased (0.377744 --> 0.329671).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.802627086639404
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.2580844  Vali Loss: 0.2280559 Vali Accuracy: 0.9253731  Vali weighted F1: 0.9255247  Vali macro F1 0.9005768 
new best score!!!!
Validation loss decreased (0.329671 --> 0.228056).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.796847820281982
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.2075422  Vali Loss: 0.2473537 Vali Accuracy: 0.9184435  Vali weighted F1: 0.9183951  Vali macro F1 0.8930575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.80532169342041
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1877849  Vali Loss: 0.1835333 Vali Accuracy: 0.9424307  Vali weighted F1: 0.9413981  Vali macro F1 0.9247541 
new best score!!!!
Validation loss decreased (0.228056 --> 0.183533).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.80224084854126
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1637749  Vali Loss: 0.1777551 Vali Accuracy: 0.9434968  Vali weighted F1: 0.9426352  Vali macro F1 0.9251399 
new best score!!!!
Validation loss decreased (0.183533 --> 0.177755).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.807174205780029
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1578416  Vali Loss: 0.1673338 Vali Accuracy: 0.9440299  Vali weighted F1: 0.9429075  Vali macro F1 0.9270826 
new best score!!!!
Validation loss decreased (0.177755 --> 0.167334).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.803499221801758
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1483092  Vali Loss: 0.1453312 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9543793  Vali macro F1 0.9442126 
new best score!!!!
Validation loss decreased (0.167334 --> 0.145331).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.8114259243011475
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1430959  Vali Loss: 0.1444714 Vali Accuracy: 0.9541578  Vali weighted F1: 0.9539742  Vali macro F1 0.9388813 
new best score!!!!
Validation loss decreased (0.145331 --> 0.144471).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.810929536819458
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1272962  Vali Loss: 0.1711819 Vali Accuracy: 0.9424307  Vali weighted F1: 0.9412038  Vali macro F1 0.9214817 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.792828798294067
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1310176  Vali Loss: 0.1285674 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9543902  Vali macro F1 0.9382168 
new best score!!!!
Validation loss decreased (0.144471 --> 0.128567).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.792805910110474
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1220830  Vali Loss: 0.1509284 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9472986  Vali macro F1 0.9312893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.7946953773498535
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1175485  Vali Loss: 0.1279541 Vali Accuracy: 0.9562900  Vali weighted F1: 0.9560782  Vali macro F1 0.9340775 
new best score!!!!
Validation loss decreased (0.128567 --> 0.127954).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.812126159667969
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1159640  Vali Loss: 0.1299054 Vali Accuracy: 0.9589552  Vali weighted F1: 0.9585542  Vali macro F1 0.9477455 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.8142311573028564
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1084996  Vali Loss: 0.1201819 Vali Accuracy: 0.9578891  Vali weighted F1: 0.9577219  Vali macro F1 0.9403241 
new best score!!!!
Validation loss decreased (0.127954 --> 0.120182).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.810779333114624
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.1037108  Vali Loss: 0.1122584 Vali Accuracy: 0.9642857  Vali weighted F1: 0.9642934  Vali macro F1 0.9512882 
new best score!!!!
Validation loss decreased (0.120182 --> 0.112258).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.816258430480957
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.1002436  Vali Loss: 0.1249885 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9604471  Vali macro F1 0.9463979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.7915778160095215
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0919096  Vali Loss: 0.1182872 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9622933  Vali macro F1 0.9501774 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.815617084503174
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0925185  Vali Loss: 0.1344214 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9568268  Vali macro F1 0.9450515 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.81572961807251
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0950522  Vali Loss: 0.1067157 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9656844  Vali macro F1 0.9512319 
new best score!!!!
Validation loss decreased (0.112258 --> 0.106716).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.807663917541504
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0888438  Vali Loss: 0.0937859 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9673555  Vali macro F1 0.9544614 
new best score!!!!
Validation loss decreased (0.106716 --> 0.093786).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.803683757781982
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0836704  Vali Loss: 0.1142431 Vali Accuracy: 0.9642857  Vali weighted F1: 0.9640026  Vali macro F1 0.9514829 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.810284376144409
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0854179  Vali Loss: 0.0955291 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9669596  Vali macro F1 0.9509104 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.810651540756226
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0760358  Vali Loss: 0.0931542 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9706094  Vali macro F1 0.9567060 
new best score!!!!
Validation loss decreased (0.093786 --> 0.093154).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.799702167510986
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0734340  Vali Loss: 0.0925771 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9679502  Vali macro F1 0.9545055 
new best score!!!!
Validation loss decreased (0.093154 --> 0.092577).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.809328317642212
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0726669  Vali Loss: 0.1046010 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9655280  Vali macro F1 0.9481947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.793694019317627
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0706182  Vali Loss: 0.0936785 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9685194  Vali macro F1 0.9549642 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.792237281799316
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0689013  Vali Loss: 0.0791480 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9741012  Vali macro F1 0.9639029 
new best score!!!!
Validation loss decreased (0.092577 --> 0.079148).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.798025846481323
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0630622  Vali Loss: 0.0808384 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9731782  Vali macro F1 0.9630062 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.801819086074829
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0580277  Vali Loss: 0.0745375 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9754147  Vali macro F1 0.9675170 
new best score!!!!
Validation loss decreased (0.079148 --> 0.074538).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.826547861099243
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0575973  Vali Loss: 0.1070539 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9685932  Vali macro F1 0.9592723 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.796300649642944
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0561646  Vali Loss: 0.1095723 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9653241  Vali macro F1 0.9571601 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.7996132373809814
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0572683  Vali Loss: 0.0946772 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9731774  Vali macro F1 0.9662495 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.81331992149353
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0549415  Vali Loss: 0.0757941 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9759035  Vali macro F1 0.9694383 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.795647859573364
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0505104  Vali Loss: 0.0877990 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9687448  Vali macro F1 0.9603465 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 5.798630237579346
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0426282  Vali Loss: 0.0730453 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797247  Vali macro F1 0.9739989 
new best score!!!!
Validation loss decreased (0.074538 --> 0.073045).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.8027026653289795
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0387419  Vali Loss: 0.0670867 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802703  Vali macro F1 0.9744227 
new best score!!!!
Validation loss decreased (0.073045 --> 0.067087).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.812146186828613
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0366556  Vali Loss: 0.0669203 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797420  Vali macro F1 0.9741933 
new best score!!!!
Validation loss decreased (0.067087 --> 0.066920).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.803522825241089
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0364865  Vali Loss: 0.0656082 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796969  Vali macro F1 0.9737757 
new best score!!!!
Validation loss decreased (0.066920 --> 0.065608).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.810266494750977
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0349078  Vali Loss: 0.0667387 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792121  Vali macro F1 0.9733714 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.811007261276245
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0357659  Vali Loss: 0.0643410 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807871  Vali macro F1 0.9750119 
new best score!!!!
Validation loss decreased (0.065608 --> 0.064341).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.808316707611084
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0349197  Vali Loss: 0.0661004 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796662  Vali macro F1 0.9742035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.79854416847229
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0326228  Vali Loss: 0.0683175 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792758  Vali macro F1 0.9728040 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.798279285430908
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0338084  Vali Loss: 0.0669246 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796544  Vali macro F1 0.9738103 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.812894344329834
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0331665  Vali Loss: 0.0641489 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824597  Vali macro F1 0.9768841 
new best score!!!!
Validation loss decreased (0.064341 --> 0.064149).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 5.810474157333374
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0327432  Vali Loss: 0.0654760 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802593  Vali macro F1 0.9748034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.804843425750732
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0318136  Vali Loss: 0.0701706 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801544  Vali macro F1 0.9752964 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.792301177978516
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0328042  Vali Loss: 0.0674001 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808169  Vali macro F1 0.9752417 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.805203437805176
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0328719  Vali Loss: 0.0708139 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9785727  Vali macro F1 0.9735208 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.800626277923584
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0315465  Vali Loss: 0.0749008 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786166  Vali macro F1 0.9740982 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 5.79294228553772
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0318985  Vali Loss: 0.0651421 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818438  Vali macro F1 0.9768668 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.820645809173584
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0298753  Vali Loss: 0.0654865 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823909  Vali macro F1 0.9774507 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 5.803839683532715
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0310293  Vali Loss: 0.0640266 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823940  Vali macro F1 0.9773870 
new best score!!!!
Validation loss decreased (0.064149 --> 0.064027).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 5.800956964492798
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0307495  Vali Loss: 0.0640712 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812969  Vali macro F1 0.9762807 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 5.8150975704193115
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0302008  Vali Loss: 0.0644710 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812977  Vali macro F1 0.9762369 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 5.7949135303497314
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0321259  Vali Loss: 0.0647172 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802127  Vali macro F1 0.9749316 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 5.818126916885376
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0303454  Vali Loss: 0.0646300 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802127  Vali macro F1 0.9749316 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 5.813183546066284
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0316788  Vali Loss: 0.0658235 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813027  Vali macro F1 0.9761877 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 5.82459831237793
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0304584  Vali Loss: 0.0656108 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813027  Vali macro F1 0.9761877 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 5.830118417739868
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0301278  Vali Loss: 0.0655505 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813027  Vali macro F1 0.9761877 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 5.81533408164978
VALI: Epoch: 64, Steps: 66 | Train Loss: 0.0298087  Vali Loss: 0.0653016 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807583  Vali macro F1 0.9755611 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 5.8145081996917725
VALI: Epoch: 65, Steps: 66 | Train Loss: 0.0306519  Vali Loss: 0.0648927 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818438  Vali macro F1 0.9768668 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 5.819080591201782
VALI: Epoch: 66, Steps: 66 | Train Loss: 0.0308860  Vali Loss: 0.0648537 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813121  Vali macro F1 0.9760408 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 67 cost time: 5.8206260204315186
VALI: Epoch: 67, Steps: 66 | Train Loss: 0.0297330  Vali Loss: 0.0648476 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813121  Vali macro F1 0.9760408 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 5.824188947677612
VALI: Epoch: 68, Steps: 66 | Train Loss: 0.0310149  Vali Loss: 0.0648424 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813121  Vali macro F1 0.9760408 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 5.815726280212402
VALI: Epoch: 69, Steps: 66 | Train Loss: 0.0292487  Vali Loss: 0.0648303 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813121  Vali macro F1 0.9760408 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 5.834538698196411
VALI: Epoch: 70, Steps: 66 | Train Loss: 0.0303780  Vali Loss: 0.0648192 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813121  Vali macro F1 0.9760408 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 5.8103861808776855
VALI: Epoch: 71, Steps: 66 | Train Loss: 0.0298687  Vali Loss: 0.0648299 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813121  Vali macro F1 0.9760408 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8960922  Test weighted F1: 0.9001970  Test macro F1 0.8623384 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.978034257888794
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0320800  Vali Loss: 0.0655163 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796322  Vali macro F1 0.9748199 
Validation loss decreased (inf --> 0.065516).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.932473421096802
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0309321  Vali Loss: 0.0750684 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9763997  Vali macro F1 0.9706818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.929609060287476
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0311496  Vali Loss: 0.0651810 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813252  Vali macro F1 0.9758425 
new best score!!!!
Validation loss decreased (0.065516 --> 0.065181).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 5.938687086105347
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0320465  Vali Loss: 0.0722357 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797089  Vali macro F1 0.9747144 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 5.902665853500366
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0296684  Vali Loss: 0.0775233 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9774123  Vali macro F1 0.9721654 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 5.934754848480225
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0317949  Vali Loss: 0.0675278 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802076  Vali macro F1 0.9750149 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 5.952195405960083
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0307515  Vali Loss: 0.0649025 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818864  Vali macro F1 0.9767089 
new best score!!!!
Validation loss decreased (0.065181 --> 0.064902).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 5.957359790802002
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0295334  Vali Loss: 0.0758422 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9759938  Vali macro F1 0.9701885 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 5.955557346343994
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0313026  Vali Loss: 0.0656613 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791518  Vali macro F1 0.9729574 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 5.95798134803772
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0286823  Vali Loss: 0.0676726 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791578  Vali macro F1 0.9731560 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 5.915863752365112
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0273458  Vali Loss: 0.0720144 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9775111  Vali macro F1 0.9717619 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 5.888637065887451
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0282152  Vali Loss: 0.0659580 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797270  Vali macro F1 0.9739552 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 5.931925058364868
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0294077  Vali Loss: 0.0660715 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796214  Vali macro F1 0.9743096 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 5.829185962677002
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0273868  Vali Loss: 0.0789642 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777035  Vali macro F1 0.9717409 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 5.956024646759033
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0269756  Vali Loss: 0.0668805 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808176  Vali macro F1 0.9751073 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 5.917508363723755
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0294880  Vali Loss: 0.0640932 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791601  Vali macro F1 0.9728756 
new best score!!!!
Validation loss decreased (0.064902 --> 0.064093).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 5.907664775848389
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0301315  Vali Loss: 0.0663536 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801984  Vali macro F1 0.9748011 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 5.9230592250823975
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0281601  Vali Loss: 0.0652294 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9787217  Vali macro F1 0.9724447 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 5.889338970184326
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0264436  Vali Loss: 0.0664402 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807775  Vali macro F1 0.9756433 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 5.9425764083862305
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0270640  Vali Loss: 0.0729334 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9775874  Vali macro F1 0.9720158 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 5.922793388366699
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0249438  Vali Loss: 0.0707399 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771028  Vali macro F1 0.9710996 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 5.936834096908569
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0248202  Vali Loss: 0.0659579 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791666  Vali macro F1 0.9729086 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 5.938475608825684
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0277064  Vali Loss: 0.0645825 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796977  Vali macro F1 0.9737319 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 5.938316583633423
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0234085  Vali Loss: 0.0675247 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786121  Vali macro F1 0.9723824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 5.920785665512085
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0256966  Vali Loss: 0.0668445 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9791444  Vali macro F1 0.9732073 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 5.883992910385132
Fine Tuning VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0244760  Vali Loss: 0.0651880 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807236  Vali macro F1 0.9754252 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 5.901866912841797
Fine Tuning VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0237032  Vali Loss: 0.0656726 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807135  Vali macro F1 0.9756474 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 5.9432947635650635
Fine Tuning VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0228767  Vali Loss: 0.0660758 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801793  Vali macro F1 0.9748176 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 5.928350210189819
Fine Tuning VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0245937  Vali Loss: 0.0662609 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801793  Vali macro F1 0.9748176 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 5.936332702636719
Fine Tuning VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0247758  Vali Loss: 0.0664481 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801793  Vali macro F1 0.9748176 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 5.9361584186553955
Fine Tuning VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0249437  Vali Loss: 0.0668260 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801793  Vali macro F1 0.9748176 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8930173  Test weighted F1: 0.8984952  Test macro F1 0.8611777 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00014231 0.00018433 0.00095329 0.00125471 0.00053248 0.00064185]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.122835397720337
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2574755  Vali Loss: 0.7716637 Vali Accuracy: 0.6859462  Vali weighted F1: 0.5884384  Vali macro F1 0.2980533 
Validation loss decreased (inf --> 0.771664).  Saving model ...
Epoch: 2 cost time: 6.100922346115112
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6569409  Vali Loss: 0.5660695 Vali Accuracy: 0.7777778  Vali weighted F1: 0.7345792  Vali macro F1 0.5320743 
new best score!!!!
Validation loss decreased (0.771664 --> 0.566069).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.090268135070801
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4878182  Vali Loss: 0.4220994 Vali Accuracy: 0.8543886  Vali weighted F1: 0.8348205  Vali macro F1 0.7835090 
new best score!!!!
Validation loss decreased (0.566069 --> 0.422099).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.090200662612915
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3235272  Vali Loss: 0.2843244 Vali Accuracy: 0.9015728  Vali weighted F1: 0.8987289  Vali macro F1 0.8614916 
new best score!!!!
Validation loss decreased (0.422099 --> 0.284324).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.093952894210815
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2424164  Vali Loss: 0.2287651 Vali Accuracy: 0.9254186  Vali weighted F1: 0.9262537  Vali macro F1 0.8979325 
new best score!!!!
Validation loss decreased (0.284324 --> 0.228765).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.115682125091553
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1953891  Vali Loss: 0.2365945 Vali Accuracy: 0.9228818  Vali weighted F1: 0.9216270  Vali macro F1 0.9015317 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.126174449920654
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1838821  Vali Loss: 0.1914365 Vali Accuracy: 0.9350583  Vali weighted F1: 0.9354753  Vali macro F1 0.9088705 
new best score!!!!
Validation loss decreased (0.228765 --> 0.191436).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.1230902671813965
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1638314  Vali Loss: 0.1580491 Vali Accuracy: 0.9446981  Vali weighted F1: 0.9453143  Vali macro F1 0.9221321 
new best score!!!!
Validation loss decreased (0.191436 --> 0.158049).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.0998854637146
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1436649  Vali Loss: 0.1587023 Vali Accuracy: 0.9431761  Vali weighted F1: 0.9438351  Vali macro F1 0.9226566 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.108398199081421
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1396776  Vali Loss: 0.1618719 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9423937  Vali macro F1 0.9196787 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 6.122121095657349
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1266638  Vali Loss: 0.1307408 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9494939  Vali macro F1 0.9260197 
new best score!!!!
Validation loss decreased (0.158049 --> 0.130741).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.0897376537323
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1247348  Vali Loss: 0.1194465 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9548687  Vali macro F1 0.9331638 
new best score!!!!
Validation loss decreased (0.130741 --> 0.119446).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.107243776321411
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1128734  Vali Loss: 0.1264595 Vali Accuracy: 0.9538305  Vali weighted F1: 0.9550648  Vali macro F1 0.9405034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.136202335357666
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1054732  Vali Loss: 0.1052784 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9591401  Vali macro F1 0.9458603 
new best score!!!!
Validation loss decreased (0.119446 --> 0.105278).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.093513011932373
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1017716  Vali Loss: 0.1140520 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9583004  Vali macro F1 0.9424581 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.127037048339844
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0967311  Vali Loss: 0.0970037 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9654412  Vali macro F1 0.9514656 
new best score!!!!
Validation loss decreased (0.105278 --> 0.097004).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.113181114196777
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0895102  Vali Loss: 0.1042407 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625648  Vali macro F1 0.9519254 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.110320806503296
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0790684  Vali Loss: 0.0896286 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9697689  Vali macro F1 0.9574719 
new best score!!!!
Validation loss decreased (0.097004 --> 0.089629).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.100987911224365
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0799999  Vali Loss: 0.0878454 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9706208  Vali macro F1 0.9599947 
new best score!!!!
Validation loss decreased (0.089629 --> 0.087845).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.123225927352905
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0753643  Vali Loss: 0.0763916 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9726902  Vali macro F1 0.9637802 
new best score!!!!
Validation loss decreased (0.087845 --> 0.076392).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.118128061294556
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0800018  Vali Loss: 0.0774819 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9752922  Vali macro F1 0.9686017 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.107539415359497
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0694641  Vali Loss: 0.0698712 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9784152  Vali macro F1 0.9729703 
new best score!!!!
Validation loss decreased (0.076392 --> 0.069871).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.109811544418335
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0736217  Vali Loss: 0.0672203 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778772  Vali macro F1 0.9704747 
new best score!!!!
Validation loss decreased (0.069871 --> 0.067220).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.115028142929077
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0604245  Vali Loss: 0.0760936 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9736251  Vali macro F1 0.9668917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.107184171676636
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0562404  Vali Loss: 0.0804721 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9776149  Vali macro F1 0.9705504 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.111866474151611
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0541684  Vali Loss: 0.0714681 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9763981  Vali macro F1 0.9710906 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.12791109085083
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0526446  Vali Loss: 0.0784570 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9738319  Vali macro F1 0.9655322 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.112773180007935
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0590478  Vali Loss: 0.0800182 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9740931  Vali macro F1 0.9687276 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 6.099138975143433
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0426824  Vali Loss: 0.0584204 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9803806  Vali macro F1 0.9749450 
new best score!!!!
Validation loss decreased (0.067220 --> 0.058420).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.112649440765381
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0393033  Vali Loss: 0.0549963 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819243  Vali macro F1 0.9764028 
new best score!!!!
Validation loss decreased (0.058420 --> 0.054996).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.111127138137817
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0381392  Vali Loss: 0.0570874 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9814528  Vali macro F1 0.9766016 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.1007702350616455
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0381354  Vali Loss: 0.0567336 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9818906  Vali macro F1 0.9761704 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.131512641906738
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0384531  Vali Loss: 0.0566660 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824533  Vali macro F1 0.9775902 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.128321409225464
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0385927  Vali Loss: 0.0557496 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824437  Vali macro F1 0.9765487 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.118897199630737
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0361692  Vali Loss: 0.0547260 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819265  Vali macro F1 0.9759389 
new best score!!!!
Validation loss decreased (0.054996 --> 0.054726).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.104163646697998
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0362329  Vali Loss: 0.0560391 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829645  Vali macro F1 0.9790674 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.128554582595825
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0368943  Vali Loss: 0.0568377 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9834860  Vali macro F1 0.9794473 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.131728887557983
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0349608  Vali Loss: 0.0565298 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829654  Vali macro F1 0.9784800 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.163807153701782
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0349135  Vali Loss: 0.0579959 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829654  Vali macro F1 0.9784800 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.160875082015991
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0337343  Vali Loss: 0.0546121 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9804255  Vali macro F1 0.9737863 
new best score!!!!
Validation loss decreased (0.054726 --> 0.054612).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.091041803359985
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0346874  Vali Loss: 0.0557708 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819385  Vali macro F1 0.9760423 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.101782321929932
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0352736  Vali Loss: 0.0606843 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819730  Vali macro F1 0.9768319 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.101781606674194
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0333317  Vali Loss: 0.0564351 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9834325  Vali macro F1 0.9789260 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.102693319320679
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0336943  Vali Loss: 0.0527706 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838829  Vali macro F1 0.9788475 
new best score!!!!
Validation loss decreased (0.054612 --> 0.052771).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.099271297454834
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0334023  Vali Loss: 0.0583313 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824364  Vali macro F1 0.9765686 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.122548341751099
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0339549  Vali Loss: 0.0565578 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829176  Vali macro F1 0.9772673 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.124016761779785
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0329168  Vali Loss: 0.0549496 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833954  Vali macro F1 0.9777794 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.121542453765869
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0329224  Vali Loss: 0.0613709 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9814488  Vali macro F1 0.9759897 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.109386444091797
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0318798  Vali Loss: 0.0610346 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819603  Vali macro F1 0.9758237 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.10441780090332
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0312965  Vali Loss: 0.0570820 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9834234  Vali macro F1 0.9781851 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.105957984924316
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0302096  Vali Loss: 0.0574805 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824363  Vali macro F1 0.9768618 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.107939958572388
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0311152  Vali Loss: 0.0574880 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829256  Vali macro F1 0.9773593 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.144235610961914
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0292251  Vali Loss: 0.0571699 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9834234  Vali macro F1 0.9781851 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.106563329696655
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0320242  Vali Loss: 0.0572693 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829256  Vali macro F1 0.9773593 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.116741180419922
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0313818  Vali Loss: 0.0572769 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829256  Vali macro F1 0.9773593 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.10347056388855
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0318593  Vali Loss: 0.0575194 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824276  Vali macro F1 0.9765326 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.098675489425659
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0311741  Vali Loss: 0.0576413 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824276  Vali macro F1 0.9765326 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.1074488162994385
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0294513  Vali Loss: 0.0575715 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829256  Vali macro F1 0.9773593 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.139026641845703
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0314041  Vali Loss: 0.0574772 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829256  Vali macro F1 0.9773593 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9341791  Test weighted F1: 0.9332117  Test macro F1 0.9314870 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.0997021198272705
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0358272  Vali Loss: 0.0558271 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824156  Vali macro F1 0.9767889 
Validation loss decreased (inf --> 0.055827).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.097384214401245
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0317891  Vali Loss: 0.0603532 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824379  Vali macro F1 0.9771155 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.0874316692352295
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0318297  Vali Loss: 0.0596454 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829469  Vali macro F1 0.9771025 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.096220254898071
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0331828  Vali Loss: 0.0577780 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9814060  Vali macro F1 0.9750777 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.1123738288879395
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0323796  Vali Loss: 0.0588622 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824189  Vali macro F1 0.9773826 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.146698474884033
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0316214  Vali Loss: 0.0590816 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824165  Vali macro F1 0.9767839 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.116087436676025
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0326196  Vali Loss: 0.0573567 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9839050  Vali macro F1 0.9799809 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.114872694015503
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0304099  Vali Loss: 0.0541363 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843995  Vali macro F1 0.9796411 
new best score!!!!
Validation loss decreased (0.055827 --> 0.054136).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.114264726638794
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0305304  Vali Loss: 0.0597942 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829670  Vali macro F1 0.9784761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.116891860961914
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0289369  Vali Loss: 0.0547786 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828696  Vali macro F1 0.9777545 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.1085004806518555
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0291663  Vali Loss: 0.0575414 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9849123  Vali macro F1 0.9803032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.127930164337158
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0284309  Vali Loss: 0.0582655 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829556  Vali macro F1 0.9773953 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.143435001373291
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0292721  Vali Loss: 0.0598489 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829556  Vali macro F1 0.9773953 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.115014553070068
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0285562  Vali Loss: 0.0570017 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829218  Vali macro F1 0.9782252 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.12166690826416
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0287772  Vali Loss: 0.0581067 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824250  Vali macro F1 0.9774007 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.119158029556274
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0289287  Vali Loss: 0.0591548 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819491  Vali macro F1 0.9763618 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.11826753616333
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0276218  Vali Loss: 0.0578566 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829218  Vali macro F1 0.9782252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.120082139968872
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0281393  Vali Loss: 0.0589374 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819491  Vali macro F1 0.9763618 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 19 cost time: 6.14274525642395
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0272425  Vali Loss: 0.0585721 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9824453  Vali macro F1 0.9771856 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.115071773529053
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0285768  Vali Loss: 0.0582394 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829410  Vali macro F1 0.9780084 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.121548652648926
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0264677  Vali Loss: 0.0580622 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829410  Vali macro F1 0.9780084 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.111552476882935
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0279294  Vali Loss: 0.0580262 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829410  Vali macro F1 0.9780084 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.116358995437622
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0281004  Vali Loss: 0.0577463 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9829218  Vali macro F1 0.9782252 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9328921  Test weighted F1: 0.9319485  Test macro F1 0.9312872 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014215 0.00017848 0.00096525 0.00123916 0.0004771  0.00060096]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.287142992019653
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.2467673  Vali Loss: 0.7695348 Vali Accuracy: 0.6778490  Vali weighted F1: 0.5856243  Vali macro F1 0.3129874 
Validation loss decreased (inf --> 0.769535).  Saving model ...
Epoch: 2 cost time: 6.264420986175537
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.6363923  Vali Loss: 0.4769594 Vali Accuracy: 0.8342378  Vali weighted F1: 0.8168418  Vali macro F1 0.7538203 
new best score!!!!
Validation loss decreased (0.769535 --> 0.476959).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.254389047622681
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3945991  Vali Loss: 0.2706646 Vali Accuracy: 0.9013320  Vali weighted F1: 0.8959145  Vali macro F1 0.8597522 
new best score!!!!
Validation loss decreased (0.476959 --> 0.270665).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2596049308776855
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2481999  Vali Loss: 0.1954481 Vali Accuracy: 0.9338925  Vali weighted F1: 0.9323227  Vali macro F1 0.9103287 
new best score!!!!
Validation loss decreased (0.270665 --> 0.195448).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.272952318191528
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2069449  Vali Loss: 0.1592838 Vali Accuracy: 0.9467193  Vali weighted F1: 0.9472698  Vali macro F1 0.9230469 
new best score!!!!
Validation loss decreased (0.195448 --> 0.159284).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.265981674194336
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1774966  Vali Loss: 0.1483787 Vali Accuracy: 0.9541194  Vali weighted F1: 0.9544398  Vali macro F1 0.9378353 
new best score!!!!
Validation loss decreased (0.159284 --> 0.148379).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.27146053314209
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1701807  Vali Loss: 0.1444138 Vali Accuracy: 0.9526394  Vali weighted F1: 0.9523904  Vali macro F1 0.9367794 
new best score!!!!
Validation loss decreased (0.148379 --> 0.144414).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.290705442428589
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1520470  Vali Loss: 0.1336354 Vali Accuracy: 0.9570794  Vali weighted F1: 0.9569753  Vali macro F1 0.9404934 
new best score!!!!
Validation loss decreased (0.144414 --> 0.133635).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.261497497558594
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1444465  Vali Loss: 0.1290321 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9594252  Vali macro F1 0.9450436 
new best score!!!!
Validation loss decreased (0.133635 --> 0.129032).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.267603635787964
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1330668  Vali Loss: 0.1305976 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9601880  Vali macro F1 0.9488339 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.267917633056641
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1182856  Vali Loss: 0.1001720 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9731410  Vali macro F1 0.9655612 
new best score!!!!
Validation loss decreased (0.129032 --> 0.100172).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.255500555038452
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1098473  Vali Loss: 0.0933193 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9712591  Vali macro F1 0.9626851 
new best score!!!!
Validation loss decreased (0.100172 --> 0.093319).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.264326810836792
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1071499  Vali Loss: 0.1060280 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9670178  Vali macro F1 0.9569034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.278144598007202
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0997517  Vali Loss: 0.0933901 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9718732  Vali macro F1 0.9615370 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.281850099563599
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0929805  Vali Loss: 0.0896420 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9724174  Vali macro F1 0.9622492 
new best score!!!!
Validation loss decreased (0.093319 --> 0.089642).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.267009735107422
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0892072  Vali Loss: 0.0801530 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9726786  Vali macro F1 0.9623543 
new best score!!!!
Validation loss decreased (0.089642 --> 0.080153).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.268654108047485
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0843429  Vali Loss: 0.0802078 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9749021  Vali macro F1 0.9652607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.271032333374023
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0880001  Vali Loss: 0.0794869 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9745403  Vali macro F1 0.9638126 
new best score!!!!
Validation loss decreased (0.080153 --> 0.079487).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.261699438095093
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0798629  Vali Loss: 0.0655652 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9804431  Vali macro F1 0.9737812 
new best score!!!!
Validation loss decreased (0.079487 --> 0.065565).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.265570640563965
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0750135  Vali Loss: 0.0926211 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9757597  Vali macro F1 0.9688257 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.285823345184326
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0724962  Vali Loss: 0.0733978 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9780293  Vali macro F1 0.9703193 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.275694131851196
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0654912  Vali Loss: 0.0636910 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9828500  Vali macro F1 0.9765183 
new best score!!!!
Validation loss decreased (0.065565 --> 0.063691).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.270249366760254
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0629474  Vali Loss: 0.0624297 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9814025  Vali macro F1 0.9735195 
new best score!!!!
Validation loss decreased (0.063691 --> 0.062430).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.267228841781616
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0615888  Vali Loss: 0.0563304 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9814260  Vali macro F1 0.9742578 
new best score!!!!
Validation loss decreased (0.062430 --> 0.056330).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.283509016036987
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0633495  Vali Loss: 0.0803826 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9776321  Vali macro F1 0.9690103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.272437334060669
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0605864  Vali Loss: 0.0654370 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9799879  Vali macro F1 0.9722986 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.280200958251953
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0537292  Vali Loss: 0.0626975 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818831  Vali macro F1 0.9758036 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.296509027481079
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0523785  Vali Loss: 0.0554712 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847447  Vali macro F1 0.9785397 
new best score!!!!
Validation loss decreased (0.056330 --> 0.055471).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.2685065269470215
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0543898  Vali Loss: 0.0634098 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9809439  Vali macro F1 0.9741952 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.275533199310303
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0517144  Vali Loss: 0.0570519 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857012  Vali macro F1 0.9799681 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.271555662155151
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0591739  Vali Loss: 0.0587989 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9838531  Vali macro F1 0.9774616 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.270969867706299
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0521171  Vali Loss: 0.0530877 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9841896  Vali macro F1 0.9766066 
new best score!!!!
Validation loss decreased (0.055471 --> 0.053088).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.2584757804870605
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0469757  Vali Loss: 0.0559523 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9836311  Vali macro F1 0.9762473 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.286209344863892
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0482718  Vali Loss: 0.0650800 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9805638  Vali macro F1 0.9729687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.277188062667847
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0407605  Vali Loss: 0.0557614 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852026  Vali macro F1 0.9786080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.265111684799194
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0408079  Vali Loss: 0.0659151 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9805241  Vali macro F1 0.9729133 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.2713518142700195
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0433103  Vali Loss: 0.0632701 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9824804  Vali macro F1 0.9761611 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 6.632229328155518
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0345964  Vali Loss: 0.0458933 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862439  Vali macro F1 0.9803729 
new best score!!!!
Validation loss decreased (0.053088 --> 0.045893).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 8.49387264251709
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0313875  Vali Loss: 0.0455823 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862202  Vali macro F1 0.9797223 
new best score!!!!
Validation loss decreased (0.045893 --> 0.045582).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.242278337478638
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0312147  Vali Loss: 0.0452873 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871868  Vali macro F1 0.9807314 
new best score!!!!
Validation loss decreased (0.045582 --> 0.045287).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.263650417327881
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0285007  Vali Loss: 0.0467274 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857516  Vali macro F1 0.9789026 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.239739894866943
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0289559  Vali Loss: 0.0455246 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866746  Vali macro F1 0.9802347 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.241420269012451
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0287309  Vali Loss: 0.0456039 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871966  Vali macro F1 0.9803915 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.246752738952637
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0276811  Vali Loss: 0.0466571 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871966  Vali macro F1 0.9803915 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.240854263305664
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0264435  Vali Loss: 0.0480256 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857466  Vali macro F1 0.9790255 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 6.236072301864624
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0273954  Vali Loss: 0.0469880 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867095  Vali macro F1 0.9799355 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.233011484146118
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0270783  Vali Loss: 0.0466663 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867098  Vali macro F1 0.9798441 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.264692783355713
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0262659  Vali Loss: 0.0465063 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862296  Vali macro F1 0.9792699 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.231022596359253
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0258355  Vali Loss: 0.0462072 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862318  Vali macro F1 0.9792642 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.234166622161865
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0267511  Vali Loss: 0.0461105 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867132  Vali macro F1 0.9798407 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 6.231848955154419
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0265618  Vali Loss: 0.0461107 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867132  Vali macro F1 0.9798407 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.232876539230347
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0284172  Vali Loss: 0.0460860 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867132  Vali macro F1 0.9798407 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.232901334762573
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0256730  Vali Loss: 0.0460666 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867132  Vali macro F1 0.9798407 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.23274302482605
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0253555  Vali Loss: 0.0460608 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867132  Vali macro F1 0.9798407 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.258049964904785
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0253034  Vali Loss: 0.0460714 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867132  Vali macro F1 0.9798407 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8903362  Test weighted F1: 0.8725359  Test macro F1 0.6537663 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.288581132888794
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0298103  Vali Loss: 0.0472991 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857542  Vali macro F1 0.9790288 
Validation loss decreased (inf --> 0.047299).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2708961963653564
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0300497  Vali Loss: 0.0460846 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871966  Vali macro F1 0.9803915 
new best score!!!!
Validation loss decreased (0.047299 --> 0.046085).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.27278733253479
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0281054  Vali Loss: 0.0481935 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852651  Vali macro F1 0.9784488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.281266212463379
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0280332  Vali Loss: 0.0471526 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862444  Vali macro F1 0.9789680 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.284677982330322
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0273551  Vali Loss: 0.0496924 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847920  Vali macro F1 0.9779983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.3013529777526855
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0270569  Vali Loss: 0.0458035 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862097  Vali macro F1 0.9799870 
new best score!!!!
Validation loss decreased (0.046085 --> 0.045804).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.308973789215088
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0258222  Vali Loss: 0.0462192 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862261  Vali macro F1 0.9791039 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.290408372879028
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0271875  Vali Loss: 0.0448240 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862097  Vali macro F1 0.9799870 
new best score!!!!
Validation loss decreased (0.045804 --> 0.044824).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.2778120040893555
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0270006  Vali Loss: 0.0457530 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871940  Vali macro F1 0.9811066 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.282904148101807
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0262241  Vali Loss: 0.0452266 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862012  Vali macro F1 0.9790645 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.282615423202515
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0253739  Vali Loss: 0.0471536 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862159  Vali macro F1 0.9796025 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.29506254196167
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0245913  Vali Loss: 0.0487104 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862315  Vali macro F1 0.9801684 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.290740251541138
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0248352  Vali Loss: 0.0476512 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862284  Vali macro F1 0.9793263 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 6.30192756652832
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0250725  Vali Loss: 0.0501353 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862698  Vali macro F1 0.9805986 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.283694267272949
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0241272  Vali Loss: 0.0456443 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9866668  Vali macro F1 0.9805132 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.279854774475098
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0242374  Vali Loss: 0.0436094 Vali Accuracy: 0.9876665  Vali weighted F1: 0.9876779  Vali macro F1 0.9822329 
new best score!!!!
Validation loss decreased (0.044824 --> 0.043609).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.283646583557129
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0227088  Vali Loss: 0.0480803 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872128  Vali macro F1 0.9815018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.2959511280059814
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0232997  Vali Loss: 0.0468848 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872110  Vali macro F1 0.9820874 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.279346942901611
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0242138  Vali Loss: 0.0485760 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872025  Vali macro F1 0.9812428 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.289323091506958
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0232233  Vali Loss: 0.0486813 Vali Accuracy: 0.9876665  Vali weighted F1: 0.9876896  Vali macro F1 0.9826803 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.394163131713867
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0225292  Vali Loss: 0.0479109 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867057  Vali macro F1 0.9812234 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 6.278565406799316
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0216725  Vali Loss: 0.0481380 Vali Accuracy: 0.9866798  Vali weighted F1: 0.9867123  Vali macro F1 0.9814761 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.276053428649902
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0229883  Vali Loss: 0.0470546 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871885  Vali macro F1 0.9816806 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.278744459152222
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0216497  Vali Loss: 0.0483968 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862292  Vali macro F1 0.9810187 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.28380274772644
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0227763  Vali Loss: 0.0477778 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871962  Vali macro F1 0.9819349 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.279608249664307
Fine Tuning VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0230201  Vali Loss: 0.0470500 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871885  Vali macro F1 0.9816806 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 6.296229362487793
Fine Tuning VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0215221  Vali Loss: 0.0470529 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871885  Vali macro F1 0.9816806 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.295591831207275
Fine Tuning VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0214413  Vali Loss: 0.0470836 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871885  Vali macro F1 0.9816806 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.290761709213257
Fine Tuning VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0204940  Vali Loss: 0.0471231 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871885  Vali macro F1 0.9816806 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.27500057220459
Fine Tuning VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0214871  Vali Loss: 0.0472022 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871885  Vali macro F1 0.9816806 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.277369976043701
Fine Tuning VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0224692  Vali Loss: 0.0471653 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871885  Vali macro F1 0.9816806 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8811562  Test weighted F1: 0.8626451  Test macro F1 0.6446693 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0001451  0.00016764 0.0010142  0.00132979 0.00050327 0.00062933]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.245164632797241
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.2414682  Vali Loss: 0.8436837 Vali Accuracy: 0.6542843  Vali weighted F1: 0.5451864  Vali macro F1 0.2692030 
Validation loss decreased (inf --> 0.843684).  Saving model ...
Epoch: 2 cost time: 6.236056804656982
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.6368992  Vali Loss: 0.5412162 Vali Accuracy: 0.7860327  Vali weighted F1: 0.7482317  Vali macro F1 0.5426340 
new best score!!!!
Validation loss decreased (0.843684 --> 0.541216).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.239816904067993
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4550846  Vali Loss: 0.3582612 Vali Accuracy: 0.8608222  Vali weighted F1: 0.8519135  Vali macro F1 0.7995353 
new best score!!!!
Validation loss decreased (0.541216 --> 0.358261).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.224581241607666
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3072124  Vali Loss: 0.2544476 Vali Accuracy: 0.9083705  Vali weighted F1: 0.9095577  Vali macro F1 0.8669339 
new best score!!!!
Validation loss decreased (0.358261 --> 0.254448).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.23974084854126
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2225858  Vali Loss: 0.2095961 Vali Accuracy: 0.9247152  Vali weighted F1: 0.9253177  Vali macro F1 0.8910391 
new best score!!!!
Validation loss decreased (0.254448 --> 0.209596).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.264848470687866
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1988099  Vali Loss: 0.1753646 Vali Accuracy: 0.9341258  Vali weighted F1: 0.9335833  Vali macro F1 0.9029249 
new best score!!!!
Validation loss decreased (0.209596 --> 0.175365).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.2574450969696045
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1775057  Vali Loss: 0.1586983 Vali Accuracy: 0.9465082  Vali weighted F1: 0.9470481  Vali macro F1 0.9207802 
new best score!!!!
Validation loss decreased (0.175365 --> 0.158698).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.23874568939209
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1609879  Vali Loss: 0.1869263 Vali Accuracy: 0.9356117  Vali weighted F1: 0.9329411  Vali macro F1 0.9050999 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.25310754776001
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1579423  Vali Loss: 0.1424044 Vali Accuracy: 0.9499752  Vali weighted F1: 0.9494760  Vali macro F1 0.9265193 
new best score!!!!
Validation loss decreased (0.158698 --> 0.142404).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.26767635345459
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1431084  Vali Loss: 0.1312842 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9599895  Vali macro F1 0.9450043 
new best score!!!!
Validation loss decreased (0.142404 --> 0.131284).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.235222816467285
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1475841  Vali Loss: 0.1465786 Vali Accuracy: 0.9484894  Vali weighted F1: 0.9495868  Vali macro F1 0.9295514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.231848478317261
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1244932  Vali Loss: 0.1196841 Vali Accuracy: 0.9529470  Vali weighted F1: 0.9531992  Vali macro F1 0.9305817 
new best score!!!!
Validation loss decreased (0.131284 --> 0.119684).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.235079526901245
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1160275  Vali Loss: 0.1351054 Vali Accuracy: 0.9514611  Vali weighted F1: 0.9517360  Vali macro F1 0.9294799 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.233644008636475
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1088568  Vali Loss: 0.1387305 Vali Accuracy: 0.9564141  Vali weighted F1: 0.9569094  Vali macro F1 0.9419514 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.244754076004028
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1031370  Vali Loss: 0.1141610 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9627399  Vali macro F1 0.9498710 
new best score!!!!
Validation loss decreased (0.119684 --> 0.114161).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.270285129547119
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0977173  Vali Loss: 0.1005148 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9645859  Vali macro F1 0.9552575 
new best score!!!!
Validation loss decreased (0.114161 --> 0.100515).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.274379730224609
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0976433  Vali Loss: 0.0938481 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9661661  Vali macro F1 0.9561652 
new best score!!!!
Validation loss decreased (0.100515 --> 0.093848).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.243078947067261
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0916884  Vali Loss: 0.0906843 Vali Accuracy: 0.9697870  Vali weighted F1: 0.9699263  Vali macro F1 0.9600512 
new best score!!!!
Validation loss decreased (0.093848 --> 0.090684).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.231603384017944
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0822271  Vali Loss: 0.0934279 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9704339  Vali macro F1 0.9595211 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.2290565967559814
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0825508  Vali Loss: 0.0820677 Vali Accuracy: 0.9697870  Vali weighted F1: 0.9696156  Vali macro F1 0.9605687 
new best score!!!!
Validation loss decreased (0.090684 --> 0.082068).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.234030723571777
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0771708  Vali Loss: 0.0835750 Vali Accuracy: 0.9697870  Vali weighted F1: 0.9697770  Vali macro F1 0.9609578 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.24261736869812
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0737076  Vali Loss: 0.0758817 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9753899  Vali macro F1 0.9648259 
new best score!!!!
Validation loss decreased (0.082068 --> 0.075882).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.2643046379089355
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0764025  Vali Loss: 0.0882110 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9669168  Vali macro F1 0.9563614 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.234210252761841
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0677240  Vali Loss: 0.0788353 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9721124  Vali macro F1 0.9580741 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.2382543087005615
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0736672  Vali Loss: 0.0731295 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9738939  Vali macro F1 0.9555447 
new best score!!!!
Validation loss decreased (0.075882 --> 0.073130).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.223284482955933
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0634280  Vali Loss: 0.0646617 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9777380  Vali macro F1 0.9708486 
new best score!!!!
Validation loss decreased (0.073130 --> 0.064662).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.224847316741943
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0575328  Vali Loss: 0.0829066 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9745176  Vali macro F1 0.9679359 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.230106592178345
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0554241  Vali Loss: 0.0652532 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792881  Vali macro F1 0.9727597 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.2349629402160645
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0526641  Vali Loss: 0.0735105 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9768893  Vali macro F1 0.9660503 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.259952783584595
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0553826  Vali Loss: 0.0651878 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9786373  Vali macro F1 0.9721800 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.2369842529296875
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0470977  Vali Loss: 0.0559136 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812510  Vali macro F1 0.9752480 
new best score!!!!
Validation loss decreased (0.064662 --> 0.055914).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.235613107681274
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0445771  Vali Loss: 0.0506729 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822231  Vali macro F1 0.9766762 
new best score!!!!
Validation loss decreased (0.055914 --> 0.050673).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.231035470962524
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0456143  Vali Loss: 0.0582382 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798111  Vali macro F1 0.9741325 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.2419939041137695
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0381021  Vali Loss: 0.0517405 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812696  Vali macro F1 0.9749996 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.229511260986328
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0412333  Vali Loss: 0.0616108 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808061  Vali macro F1 0.9727150 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.25433611869812
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0379778  Vali Loss: 0.0585018 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9823120  Vali macro F1 0.9762519 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.238969564437866
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0383560  Vali Loss: 0.0750343 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9771206  Vali macro F1 0.9717300 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 6.231205463409424
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0311080  Vali Loss: 0.0487599 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851662  Vali macro F1 0.9803939 
new best score!!!!
Validation loss decreased (0.050673 --> 0.048760).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.2298972606658936
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0266530  Vali Loss: 0.0473420 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856956  Vali macro F1 0.9812077 
new best score!!!!
Validation loss decreased (0.048760 --> 0.047342).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.23969578742981
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0263994  Vali Loss: 0.0469821 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842017  Vali macro F1 0.9787890 
new best score!!!!
Validation loss decreased (0.047342 --> 0.046982).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.253582954406738
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0266921  Vali Loss: 0.0470308 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842270  Vali macro F1 0.9779428 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.247072219848633
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0248434  Vali Loss: 0.0480747 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837082  Vali macro F1 0.9784603 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.260552406311035
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0249055  Vali Loss: 0.0479641 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836907  Vali macro F1 0.9778186 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.231191635131836
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0265886  Vali Loss: 0.0526100 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827759  Vali macro F1 0.9758098 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.237992525100708
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0239069  Vali Loss: 0.0490829 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822401  Vali macro F1 0.9763261 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 6.2365031242370605
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0241928  Vali Loss: 0.0488860 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827367  Vali macro F1 0.9765692 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.231342315673828
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0223207  Vali Loss: 0.0486512 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817424  Vali macro F1 0.9756273 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.235226631164551
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0229382  Vali Loss: 0.0485790 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817424  Vali macro F1 0.9756273 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.243055105209351
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0235839  Vali Loss: 0.0487769 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817424  Vali macro F1 0.9756273 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.246424198150635
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0232231  Vali Loss: 0.0488186 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812527  Vali macro F1 0.9748003 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 6.229821443557739
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0238940  Vali Loss: 0.0488355 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817424  Vali macro F1 0.9756273 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.232217788696289
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0227700  Vali Loss: 0.0488520 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817424  Vali macro F1 0.9756273 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.225178003311157
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0225747  Vali Loss: 0.0487837 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817424  Vali macro F1 0.9756273 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.229498863220215
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0227714  Vali Loss: 0.0487604 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817424  Vali macro F1 0.9756273 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.224374532699585
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0225737  Vali Loss: 0.0486865 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817424  Vali macro F1 0.9756273 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8964497  Test weighted F1: 0.8935158  Test macro F1 0.8600761 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.292245626449585
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0263738  Vali Loss: 0.0470521 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826964  Vali macro F1 0.9755708 
Validation loss decreased (inf --> 0.047052).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2627575397491455
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0259890  Vali Loss: 0.0470451 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841948  Vali macro F1 0.9780927 
new best score!!!!
Validation loss decreased (0.047052 --> 0.047045).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.248626470565796
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0247767  Vali Loss: 0.0480070 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822438  Vali macro F1 0.9744407 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.242466449737549
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0263941  Vali Loss: 0.0489354 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832256  Vali macro F1 0.9778503 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.242234706878662
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0230376  Vali Loss: 0.0466787 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817498  Vali macro F1 0.9760114 
new best score!!!!
Validation loss decreased (0.047045 --> 0.046679).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.245572805404663
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0241860  Vali Loss: 0.0521531 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9828091  Vali macro F1 0.9768505 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.257303476333618
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0233889  Vali Loss: 0.0548696 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832928  Vali macro F1 0.9773622 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.242766857147217
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0238095  Vali Loss: 0.0490521 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827639  Vali macro F1 0.9759754 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.235108137130737
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0217773  Vali Loss: 0.0477333 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826858  Vali macro F1 0.9762162 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.241573333740234
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0232462  Vali Loss: 0.0495490 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827227  Vali macro F1 0.9750334 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.238964796066284
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0231289  Vali Loss: 0.0487628 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827393  Vali macro F1 0.9751387 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.230598449707031
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0207941  Vali Loss: 0.0488135 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827310  Vali macro F1 0.9771549 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.240419387817383
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0216810  Vali Loss: 0.0533701 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803261  Vali macro F1 0.9699494 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.262382507324219
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0219176  Vali Loss: 0.0488296 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837423  Vali macro F1 0.9773288 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.246233701705933
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0199913  Vali Loss: 0.0480641 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817125  Vali macro F1 0.9748361 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.236410856246948
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0204610  Vali Loss: 0.0476063 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827118  Vali macro F1 0.9757082 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.260821580886841
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0205464  Vali Loss: 0.0480809 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836970  Vali macro F1 0.9773460 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.26008415222168
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0205214  Vali Loss: 0.0480244 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836970  Vali macro F1 0.9773460 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.241230487823486
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0189066  Vali Loss: 0.0479017 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822443  Vali macro F1 0.9754309 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.246302366256714
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0191274  Vali Loss: 0.0481146 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822261  Vali macro F1 0.9752324 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8976331  Test weighted F1: 0.8948182  Test macro F1 0.8672096 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014648 0.00017775 0.00108932 0.00131579 0.00049628 0.00062933]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.086780071258545
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2860233  Vali Loss: 0.7966254 Vali Accuracy: 0.6813800  Vali weighted F1: 0.5740594  Vali macro F1 0.2796979 
Validation loss decreased (inf --> 0.796625).  Saving model ...
Epoch: 2 cost time: 6.101244688034058
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6979112  Vali Loss: 0.6002772 Vali Accuracy: 0.7762557  Vali weighted F1: 0.7198836  Vali macro F1 0.5053533 
new best score!!!!
Validation loss decreased (0.796625 --> 0.600277).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.122140645980835
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5128824  Vali Loss: 0.4738616 Vali Accuracy: 0.8295282  Vali weighted F1: 0.8222687  Vali macro F1 0.7771503 
new best score!!!!
Validation loss decreased (0.600277 --> 0.473862).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.136074542999268
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3843830  Vali Loss: 0.3406821 Vali Accuracy: 0.8787418  Vali weighted F1: 0.8684147  Vali macro F1 0.8313739 
new best score!!!!
Validation loss decreased (0.473862 --> 0.340682).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.084099292755127
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2713969  Vali Loss: 0.2301873 Vali Accuracy: 0.9289701  Vali weighted F1: 0.9267065  Vali macro F1 0.9005633 
new best score!!!!
Validation loss decreased (0.340682 --> 0.230187).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.112629413604736
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2134787  Vali Loss: 0.2009006 Vali Accuracy: 0.9350583  Vali weighted F1: 0.9350776  Vali macro F1 0.9097280 
new best score!!!!
Validation loss decreased (0.230187 --> 0.200901).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.112879514694214
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1828886  Vali Loss: 0.1691257 Vali Accuracy: 0.9446981  Vali weighted F1: 0.9440716  Vali macro F1 0.9231779 
new best score!!!!
Validation loss decreased (0.200901 --> 0.169126).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.152235507965088
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1686310  Vali Loss: 0.1686441 Vali Accuracy: 0.9487570  Vali weighted F1: 0.9491873  Vali macro F1 0.9294559 
new best score!!!!
Validation loss decreased (0.169126 --> 0.168644).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.073265314102173
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1625902  Vali Loss: 0.1952902 Vali Accuracy: 0.9386098  Vali weighted F1: 0.9377251  Vali macro F1 0.9123770 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.095378637313843
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1492889  Vali Loss: 0.1526035 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9496476  Vali macro F1 0.9302220 
new best score!!!!
Validation loss decreased (0.168644 --> 0.152604).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.088980197906494
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1334261  Vali Loss: 0.1355855 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9582571  Vali macro F1 0.9417506 
new best score!!!!
Validation loss decreased (0.152604 --> 0.135585).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.09466814994812
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1258460  Vali Loss: 0.1279115 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9624362  Vali macro F1 0.9477500 
new best score!!!!
Validation loss decreased (0.135585 --> 0.127912).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.112121105194092
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1146616  Vali Loss: 0.1148236 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9647041  Vali macro F1 0.9505261 
new best score!!!!
Validation loss decreased (0.127912 --> 0.114824).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.107875347137451
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1073340  Vali Loss: 0.1620675 Vali Accuracy: 0.9426687  Vali weighted F1: 0.9403615  Vali macro F1 0.9256339 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 8.756357669830322
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1071796  Vali Loss: 0.1143142 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9611658  Vali macro F1 0.9449667 
new best score!!!!
Validation loss decreased (0.114824 --> 0.114314).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.133462905883789
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0987873  Vali Loss: 0.0929697 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9697062  Vali macro F1 0.9566808 
new best score!!!!
Validation loss decreased (0.114314 --> 0.092970).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.091468811035156
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0928087  Vali Loss: 0.1110925 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9593764  Vali macro F1 0.9417312 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.076032638549805
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0798800  Vali Loss: 0.0989203 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9681145  Vali macro F1 0.9550842 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.083469390869141
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0748692  Vali Loss: 0.0923190 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9684775  Vali macro F1 0.9557131 
new best score!!!!
Validation loss decreased (0.092970 --> 0.092319).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.10663104057312
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0748268  Vali Loss: 0.0883207 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9731110  Vali macro F1 0.9573229 
new best score!!!!
Validation loss decreased (0.092319 --> 0.088321).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.0959930419921875
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0739072  Vali Loss: 0.0869362 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9693807  Vali macro F1 0.9521202 
new best score!!!!
Validation loss decreased (0.088321 --> 0.086936).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.081456422805786
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0627120  Vali Loss: 0.0768502 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778131  Vali macro F1 0.9683272 
new best score!!!!
Validation loss decreased (0.086936 --> 0.076850).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.076807022094727
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0650233  Vali Loss: 0.0785620 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9767309  Vali macro F1 0.9665067 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.075621843338013
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0678861  Vali Loss: 0.0861767 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9751424  Vali macro F1 0.9620661 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.075012683868408
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0566587  Vali Loss: 0.0794524 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9759600  Vali macro F1 0.9677683 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.077510833740234
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0574376  Vali Loss: 0.0789806 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9761710  Vali macro F1 0.9646613 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 6.0956480503082275
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0631580  Vali Loss: 0.0706460 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777055  Vali macro F1 0.9694904 
new best score!!!!
Validation loss decreased (0.076850 --> 0.070646).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.082586288452148
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0529329  Vali Loss: 0.0706526 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771000  Vali macro F1 0.9659326 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.080425500869751
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0517958  Vali Loss: 0.0676392 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9793096  Vali macro F1 0.9692730 
new best score!!!!
Validation loss decreased (0.070646 --> 0.067639).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.081329107284546
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0454994  Vali Loss: 0.0700490 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797354  Vali macro F1 0.9706375 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.08369517326355
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0451024  Vali Loss: 0.0662750 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791230  Vali macro F1 0.9686256 
new best score!!!!
Validation loss decreased (0.067639 --> 0.066275).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.086126089096069
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0472755  Vali Loss: 0.0614581 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827898  Vali macro F1 0.9745062 
new best score!!!!
Validation loss decreased (0.066275 --> 0.061458).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.091010093688965
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0380939  Vali Loss: 0.0617591 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807429  Vali macro F1 0.9707776 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.108205080032349
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0377898  Vali Loss: 0.0661357 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832657  Vali macro F1 0.9744834 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.088916540145874
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0380380  Vali Loss: 0.0677885 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791863  Vali macro F1 0.9654305 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.084327697753906
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0385727  Vali Loss: 0.0758545 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802206  Vali macro F1 0.9706285 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.08726954460144
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0420238  Vali Loss: 0.0773406 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772001  Vali macro F1 0.9666583 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 6.083676815032959
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0305152  Vali Loss: 0.0581881 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852960  Vali macro F1 0.9776011 
new best score!!!!
Validation loss decreased (0.061458 --> 0.058188).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.099421262741089
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0270586  Vali Loss: 0.0568230 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857969  Vali macro F1 0.9780899 
new best score!!!!
Validation loss decreased (0.058188 --> 0.056823).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.099542140960693
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0250682  Vali Loss: 0.0569921 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852712  Vali macro F1 0.9778333 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.1220104694366455
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0251116  Vali Loss: 0.0580569 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847840  Vali macro F1 0.9770427 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.086954832077026
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0256245  Vali Loss: 0.0585193 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852904  Vali macro F1 0.9778456 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.092233657836914
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0224583  Vali Loss: 0.0571587 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853211  Vali macro F1 0.9772316 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.083667278289795
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0235588  Vali Loss: 0.0573888 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853017  Vali macro F1 0.9770907 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 6.09401273727417
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0230960  Vali Loss: 0.0575708 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853017  Vali macro F1 0.9770907 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.0858752727508545
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0235166  Vali Loss: 0.0581571 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847966  Vali macro F1 0.9762897 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.108727216720581
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0226536  Vali Loss: 0.0584404 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842757  Vali macro F1 0.9757950 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.088268756866455
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0222526  Vali Loss: 0.0579763 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842757  Vali macro F1 0.9757950 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.0858154296875
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0213385  Vali Loss: 0.0582266 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842757  Vali macro F1 0.9757950 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 6.08768892288208
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0224730  Vali Loss: 0.0582930 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842757  Vali macro F1 0.9757950 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.0840699672698975
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0222885  Vali Loss: 0.0582446 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842757  Vali macro F1 0.9757950 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.08893084526062
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0228955  Vali Loss: 0.0582637 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842757  Vali macro F1 0.9757950 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.08781886100769
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0223503  Vali Loss: 0.0581601 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842757  Vali macro F1 0.9757950 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.116901397705078
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0219536  Vali Loss: 0.0581309 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842757  Vali macro F1 0.9757950 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9324561  Test weighted F1: 0.9331446  Test macro F1 0.8850244 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.175242900848389
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0253518  Vali Loss: 0.0559888 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878396  Vali macro F1 0.9807517 
Validation loss decreased (inf --> 0.055989).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.186206579208374
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0247261  Vali Loss: 0.0573835 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832149  Vali macro F1 0.9745442 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.203307390213013
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0238932  Vali Loss: 0.0611245 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837210  Vali macro F1 0.9753014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.176576137542725
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0231239  Vali Loss: 0.0592915 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827672  Vali macro F1 0.9739988 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.1379194259643555
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0238132  Vali Loss: 0.0602122 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853041  Vali macro F1 0.9775627 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.158571720123291
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0222180  Vali Loss: 0.0592814 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832552  Vali macro F1 0.9747119 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.148015737533569
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0225704  Vali Loss: 0.0650658 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827384  Vali macro F1 0.9736558 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.13340425491333
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0233189  Vali Loss: 0.0630522 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842601  Vali macro F1 0.9755429 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.127298593521118
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0214413  Vali Loss: 0.0600526 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837935  Vali macro F1 0.9754477 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.121762752532959
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0208338  Vali Loss: 0.0607403 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842870  Vali macro F1 0.9758728 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.125780820846558
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0212421  Vali Loss: 0.0597600 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842870  Vali macro F1 0.9758728 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.131450891494751
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0199695  Vali Loss: 0.0592948 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842870  Vali macro F1 0.9758728 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.169079303741455
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0194624  Vali Loss: 0.0589896 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842870  Vali macro F1 0.9758728 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.1710076332092285
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0193220  Vali Loss: 0.0600704 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842870  Vali macro F1 0.9758728 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.113784313201904
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0198743  Vali Loss: 0.0598021 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837744  Vali macro F1 0.9753061 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.1292829513549805
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0195695  Vali Loss: 0.0597398 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837744  Vali macro F1 0.9753061 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9302475  Test weighted F1: 0.9309436  Test macro F1 0.8799326 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013931 0.00018355 0.00106724 0.00127551 0.00049116 0.00059347]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.210617303848267
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.2304108  Vali Loss: 0.7380145 Vali Accuracy: 0.6982072  Vali weighted F1: 0.6099123  Vali macro F1 0.3282926 
Validation loss decreased (inf --> 0.738015).  Saving model ...
Epoch: 2 cost time: 6.208161354064941
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.6344635  Vali Loss: 0.5705165 Vali Accuracy: 0.7768924  Vali weighted F1: 0.7338194  Vali macro F1 0.5319489 
new best score!!!!
Validation loss decreased (0.738015 --> 0.570516).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.232151985168457
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4636468  Vali Loss: 0.3858097 Vali Accuracy: 0.8610558  Vali weighted F1: 0.8478461  Vali macro F1 0.7878709 
new best score!!!!
Validation loss decreased (0.570516 --> 0.385810).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.202591896057129
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3033221  Vali Loss: 0.2463043 Vali Accuracy: 0.9143426  Vali weighted F1: 0.9132190  Vali macro F1 0.8765532 
new best score!!!!
Validation loss decreased (0.385810 --> 0.246304).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.205287933349609
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2285875  Vali Loss: 0.2095063 Vali Accuracy: 0.9262948  Vali weighted F1: 0.9278503  Vali macro F1 0.8971647 
new best score!!!!
Validation loss decreased (0.246304 --> 0.209506).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.217391729354858
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2031662  Vali Loss: 0.2114614 Vali Accuracy: 0.9282869  Vali weighted F1: 0.9261559  Vali macro F1 0.8997505 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.210428714752197
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1762035  Vali Loss: 0.1865443 Vali Accuracy: 0.9347610  Vali weighted F1: 0.9348026  Vali macro F1 0.9052706 
new best score!!!!
Validation loss decreased (0.209506 --> 0.186544).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.198413610458374
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1613992  Vali Loss: 0.1528801 Vali Accuracy: 0.9472112  Vali weighted F1: 0.9472078  Vali macro F1 0.9292687 
new best score!!!!
Validation loss decreased (0.186544 --> 0.152880).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.214705467224121
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1509526  Vali Loss: 0.1453388 Vali Accuracy: 0.9462151  Vali weighted F1: 0.9459599  Vali macro F1 0.9235231 
new best score!!!!
Validation loss decreased (0.152880 --> 0.145339).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.228018522262573
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1380197  Vali Loss: 0.1495969 Vali Accuracy: 0.9467131  Vali weighted F1: 0.9475383  Vali macro F1 0.9306164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.21363091468811
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1321074  Vali Loss: 0.1401213 Vali Accuracy: 0.9536853  Vali weighted F1: 0.9546614  Vali macro F1 0.9415035 
new best score!!!!
Validation loss decreased (0.145339 --> 0.140121).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.2332539558410645
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1229394  Vali Loss: 0.1169909 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9598435  Vali macro F1 0.9467472 
new best score!!!!
Validation loss decreased (0.140121 --> 0.116991).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.205575942993164
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1200429  Vali Loss: 0.1369437 Vali Accuracy: 0.9477092  Vali weighted F1: 0.9481688  Vali macro F1 0.9291328 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.220733642578125
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1126368  Vali Loss: 0.1195155 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9581515  Vali macro F1 0.9410765 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.223294973373413
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1031070  Vali Loss: 0.1198269 Vali Accuracy: 0.9571713  Vali weighted F1: 0.9577097  Vali macro F1 0.9482621 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 6.253125190734863
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0969795  Vali Loss: 0.1172379 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9606068  Vali macro F1 0.9514413 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 17 cost time: 6.23858904838562
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0971359  Vali Loss: 0.1036200 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9653857  Vali macro F1 0.9554554 
new best score!!!!
Validation loss decreased (0.116991 --> 0.103620).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.223018169403076
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0855524  Vali Loss: 0.1131469 Vali Accuracy: 0.9591633  Vali weighted F1: 0.9591845  Vali macro F1 0.9448671 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.210141897201538
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0941399  Vali Loss: 0.0849154 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707774  Vali macro F1 0.9621043 
new best score!!!!
Validation loss decreased (0.103620 --> 0.084915).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.240478515625
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0799842  Vali Loss: 0.1175205 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9595908  Vali macro F1 0.9504064 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.309793710708618
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0805108  Vali Loss: 0.0953701 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9706978  Vali macro F1 0.9613208 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.261929035186768
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0798461  Vali Loss: 0.0949086 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9680697  Vali macro F1 0.9581775 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.310324192047119
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0698156  Vali Loss: 0.0732098 Vali Accuracy: 0.9770916  Vali weighted F1: 0.9773200  Vali macro F1 0.9712947 
new best score!!!!
Validation loss decreased (0.084915 --> 0.073210).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.277233839035034
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0653904  Vali Loss: 0.0845901 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9717244  Vali macro F1 0.9629687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.291073560714722
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0681427  Vali Loss: 0.0634910 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9792355  Vali macro F1 0.9739726 
new best score!!!!
Validation loss decreased (0.073210 --> 0.063491).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.23961615562439
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0595628  Vali Loss: 0.0671431 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785346  Vali macro F1 0.9719369 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.231434345245361
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0573409  Vali Loss: 0.0737728 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9748289  Vali macro F1 0.9666583 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.233726978302002
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0604636  Vali Loss: 0.0874725 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9725791  Vali macro F1 0.9635646 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.235655784606934
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0557539  Vali Loss: 0.0766104 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9744163  Vali macro F1 0.9654559 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.24042820930481
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0506552  Vali Loss: 0.0531264 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811419  Vali macro F1 0.9745314 
new best score!!!!
Validation loss decreased (0.063491 --> 0.053126).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.232670068740845
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0501332  Vali Loss: 0.0576720 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806162  Vali macro F1 0.9746991 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.208775043487549
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0531367  Vali Loss: 0.0709005 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9774946  Vali macro F1 0.9697910 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.218842267990112
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0462309  Vali Loss: 0.0577982 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830784  Vali macro F1 0.9767098 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.20630145072937
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0441072  Vali Loss: 0.0577466 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9796953  Vali macro F1 0.9711720 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.214517116546631
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0435404  Vali Loss: 0.0616587 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830579  Vali macro F1 0.9767099 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 36 cost time: 6.242366313934326
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0346379  Vali Loss: 0.0584661 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815559  Vali macro F1 0.9748358 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.237867116928101
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0318783  Vali Loss: 0.0548110 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840557  Vali macro F1 0.9785920 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.232282876968384
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0315183  Vali Loss: 0.0525341 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840851  Vali macro F1 0.9784965 
new best score!!!!
Validation loss decreased (0.053126 --> 0.052534).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.250384092330933
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0301945  Vali Loss: 0.0507561 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841333  Vali macro F1 0.9777946 
new best score!!!!
Validation loss decreased (0.052534 --> 0.050756).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.257690191268921
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0298014  Vali Loss: 0.0500812 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9846142  Vali macro F1 0.9791530 
new best score!!!!
Validation loss decreased (0.050756 --> 0.050081).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.240727186203003
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0299997  Vali Loss: 0.0496913 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855849  Vali macro F1 0.9803361 
new best score!!!!
Validation loss decreased (0.050081 --> 0.049691).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.248681545257568
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0284390  Vali Loss: 0.0510519 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836628  Vali macro F1 0.9771226 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.278169631958008
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0294862  Vali Loss: 0.0488351 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836668  Vali macro F1 0.9766519 
new best score!!!!
Validation loss decreased (0.049691 --> 0.048835).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.269474267959595
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0287334  Vali Loss: 0.0483513 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9851235  Vali macro F1 0.9796596 
new best score!!!!
Validation loss decreased (0.048835 --> 0.048351).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.226097106933594
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0281171  Vali Loss: 0.0446881 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9861389  Vali macro F1 0.9806463 
new best score!!!!
Validation loss decreased (0.048351 --> 0.044688).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.2088463306427
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0276101  Vali Loss: 0.0535198 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830742  Vali macro F1 0.9768415 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.212296962738037
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0278535  Vali Loss: 0.0469395 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9846440  Vali macro F1 0.9780697 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.213425397872925
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0286886  Vali Loss: 0.0474782 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9851121  Vali macro F1 0.9792162 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.2397239208221436
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0278961  Vali Loss: 0.0470035 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9846342  Vali macro F1 0.9777352 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.231633901596069
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0274000  Vali Loss: 0.0515511 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830741  Vali macro F1 0.9772287 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 6.2163050174713135
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0267256  Vali Loss: 0.0482599 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840718  Vali macro F1 0.9783955 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.226483345031738
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0275513  Vali Loss: 0.0469381 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9851009  Vali macro F1 0.9797657 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.219180345535278
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0258262  Vali Loss: 0.0462230 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865933  Vali macro F1 0.9816821 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.216983795166016
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0260527  Vali Loss: 0.0463799 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865933  Vali macro F1 0.9816821 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.21758770942688
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0261737  Vali Loss: 0.0465996 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856096  Vali macro F1 0.9802270 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 56 cost time: 6.238964080810547
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0266158  Vali Loss: 0.0466253 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856096  Vali macro F1 0.9802270 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.221510410308838
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0270445  Vali Loss: 0.0466167 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856096  Vali macro F1 0.9802270 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.219458818435669
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0250839  Vali Loss: 0.0466657 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856096  Vali macro F1 0.9802270 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.215759515762329
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0256010  Vali Loss: 0.0466995 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856096  Vali macro F1 0.9802270 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.209320545196533
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0264378  Vali Loss: 0.0466872 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856096  Vali macro F1 0.9802270 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9271780  Test weighted F1: 0.9248275  Test macro F1 0.8635581 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.22385573387146
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0300455  Vali Loss: 0.0503848 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845475  Vali macro F1 0.9799109 
Validation loss decreased (inf --> 0.050385).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.250272989273071
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0289612  Vali Loss: 0.0491670 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865997  Vali macro F1 0.9818043 
new best score!!!!
Validation loss decreased (0.050385 --> 0.049167).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.229889869689941
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0284557  Vali Loss: 0.0531424 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840553  Vali macro F1 0.9788106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.2282280921936035
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0256736  Vali Loss: 0.0497171 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845768  Vali macro F1 0.9789653 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.241828680038452
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0270385  Vali Loss: 0.0507762 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850708  Vali macro F1 0.9791497 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.244694709777832
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0286705  Vali Loss: 0.0512048 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831363  Vali macro F1 0.9764976 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.222490310668945
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0285553  Vali Loss: 0.0514949 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835157  Vali macro F1 0.9777863 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.223408460617065
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0269114  Vali Loss: 0.0482349 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860761  Vali macro F1 0.9822389 
new best score!!!!
Validation loss decreased (0.049167 --> 0.048235).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.2457804679870605
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0277974  Vali Loss: 0.0502194 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835564  Vali macro F1 0.9779750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.229103326797485
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0269047  Vali Loss: 0.0555119 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9804675  Vali macro F1 0.9747068 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.227540969848633
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0252695  Vali Loss: 0.0493206 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841325  Vali macro F1 0.9781077 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.220378875732422
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0265684  Vali Loss: 0.0462893 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856251  Vali macro F1 0.9797580 
new best score!!!!
Validation loss decreased (0.048235 --> 0.046289).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.231517553329468
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0253832  Vali Loss: 0.0445834 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856101  Vali macro F1 0.9802142 
new best score!!!!
Validation loss decreased (0.046289 --> 0.044583).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.233285188674927
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0254943  Vali Loss: 0.0469879 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9846307  Vali macro F1 0.9788401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.253000259399414
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0270921  Vali Loss: 0.0472444 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9846355  Vali macro F1 0.9785602 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.249159812927246
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0264564  Vali Loss: 0.0527940 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820002  Vali macro F1 0.9763791 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.234903335571289
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0239253  Vali Loss: 0.0455843 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9851057  Vali macro F1 0.9798562 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.2342305183410645
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0226515  Vali Loss: 0.0450657 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9846283  Vali macro F1 0.9790487 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.225989103317261
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0237426  Vali Loss: 0.0461295 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9851184  Vali macro F1 0.9794755 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.222444534301758
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0224153  Vali Loss: 0.0464356 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9851320  Vali macro F1 0.9791364 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.219221830368042
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0227835  Vali Loss: 0.0467328 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9861158  Vali macro F1 0.9804477 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.246162176132202
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0223993  Vali Loss: 0.0460600 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856284  Vali macro F1 0.9799979 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.233105421066284
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0223311  Vali Loss: 0.0464742 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9861202  Vali macro F1 0.9808376 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 6.221743822097778
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0220332  Vali Loss: 0.0463523 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856284  Vali macro F1 0.9799979 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.236084699630737
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0229180  Vali Loss: 0.0461718 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856284  Vali macro F1 0.9799979 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.226349353790283
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0229380  Vali Loss: 0.0463225 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856284  Vali macro F1 0.9799979 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.223699331283569
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0228301  Vali Loss: 0.0463623 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856284  Vali macro F1 0.9799979 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.241155624389648
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0226914  Vali Loss: 0.0463465 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856284  Vali macro F1 0.9799979 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9292840  Test weighted F1: 0.9266904  Test macro F1 0.8670328 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 63951
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014674 0.00018002 0.00097466 0.00124224 0.00048757 0.00060643]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.145411729812622
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1742447  Vali Loss: 0.7517542 Vali Accuracy: 0.6948215  Vali weighted F1: 0.6206564  Vali macro F1 0.3500981 
Validation loss decreased (inf --> 0.751754).  Saving model ...
Epoch: 2 cost time: 6.151287317276001
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6374591  Vali Loss: 0.5496390 Vali Accuracy: 0.7732529  Vali weighted F1: 0.7379896  Vali macro F1 0.5487972 
new best score!!!!
Validation loss decreased (0.751754 --> 0.549639).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.145600318908691
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4564459  Vali Loss: 0.3941256 Vali Accuracy: 0.8531926  Vali weighted F1: 0.8441854  Vali macro F1 0.7974303 
new best score!!!!
Validation loss decreased (0.549639 --> 0.394126).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.149921417236328
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3404733  Vali Loss: 0.3399778 Vali Accuracy: 0.8728004  Vali weighted F1: 0.8689749  Vali macro F1 0.8416626 
new best score!!!!
Validation loss decreased (0.394126 --> 0.339978).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.15491509437561
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2683692  Vali Loss: 0.2695912 Vali Accuracy: 0.8984414  Vali weighted F1: 0.8964658  Vali macro F1 0.8710397 
new best score!!!!
Validation loss decreased (0.339978 --> 0.269591).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.174463510513306
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2256807  Vali Loss: 0.2314826 Vali Accuracy: 0.9150327  Vali weighted F1: 0.9135958  Vali macro F1 0.8904783 
new best score!!!!
Validation loss decreased (0.269591 --> 0.231483).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.1690590381622314
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1998625  Vali Loss: 0.2163975 Vali Accuracy: 0.9225742  Vali weighted F1: 0.9201100  Vali macro F1 0.8991911 
new best score!!!!
Validation loss decreased (0.231483 --> 0.216398).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.171711206436157
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1859556  Vali Loss: 0.2404800 Vali Accuracy: 0.9145299  Vali weighted F1: 0.9174995  Vali macro F1 0.8969509 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.157204866409302
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1795982  Vali Loss: 0.2135633 Vali Accuracy: 0.9260935  Vali weighted F1: 0.9250716  Vali macro F1 0.9068542 
new best score!!!!
Validation loss decreased (0.216398 --> 0.213563).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.1545093059539795
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1682170  Vali Loss: 0.1580088 Vali Accuracy: 0.9446958  Vali weighted F1: 0.9453554  Vali macro F1 0.9273920 
new best score!!!!
Validation loss decreased (0.213563 --> 0.158009).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.157991170883179
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1610024  Vali Loss: 0.1585221 Vali Accuracy: 0.9441931  Vali weighted F1: 0.9436609  Vali macro F1 0.9276978 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.156911849975586
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1462030  Vali Loss: 0.1371802 Vali Accuracy: 0.9502262  Vali weighted F1: 0.9501897  Vali macro F1 0.9329815 
new best score!!!!
Validation loss decreased (0.158009 --> 0.137180).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.161297798156738
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1321532  Vali Loss: 0.1519271 Vali Accuracy: 0.9507290  Vali weighted F1: 0.9512045  Vali macro F1 0.9375535 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.169838905334473
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1285774  Vali Loss: 0.1164446 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9629197  Vali macro F1 0.9539434 
new best score!!!!
Validation loss decreased (0.137180 --> 0.116445).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.159343481063843
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1233768  Vali Loss: 0.1254608 Vali Accuracy: 0.9557567  Vali weighted F1: 0.9559740  Vali macro F1 0.9444129 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.165838718414307
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1145359  Vali Loss: 0.1207348 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9580036  Vali macro F1 0.9434012 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.169564485549927
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1086824  Vali Loss: 0.1143575 Vali Accuracy: 0.9607843  Vali weighted F1: 0.9603900  Vali macro F1 0.9529794 
new best score!!!!
Validation loss decreased (0.116445 --> 0.114358).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.171329021453857
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1067048  Vali Loss: 0.1111048 Vali Accuracy: 0.9592760  Vali weighted F1: 0.9597804  Vali macro F1 0.9459873 
new best score!!!!
Validation loss decreased (0.114358 --> 0.111105).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.166874885559082
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0989776  Vali Loss: 0.0991594 Vali Accuracy: 0.9663147  Vali weighted F1: 0.9663765  Vali macro F1 0.9568280 
new best score!!!!
Validation loss decreased (0.111105 --> 0.099159).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.179567813873291
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0994082  Vali Loss: 0.1038999 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9653274  Vali macro F1 0.9548269 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.18862247467041
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0964158  Vali Loss: 0.1018706 Vali Accuracy: 0.9612871  Vali weighted F1: 0.9614633  Vali macro F1 0.9486497 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.167760848999023
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0962722  Vali Loss: 0.1019132 Vali Accuracy: 0.9648064  Vali weighted F1: 0.9648268  Vali macro F1 0.9537288 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.170675039291382
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0904753  Vali Loss: 0.1012033 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9670020  Vali macro F1 0.9552883 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.16471791267395
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0827619  Vali Loss: 0.0924554 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9691001  Vali macro F1 0.9583713 
new best score!!!!
Validation loss decreased (0.099159 --> 0.092455).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.164728879928589
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0744611  Vali Loss: 0.0814739 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9760001  Vali macro F1 0.9675952 
new best score!!!!
Validation loss decreased (0.092455 --> 0.081474).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.16063928604126
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0717194  Vali Loss: 0.0880284 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9701697  Vali macro F1 0.9602256 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.174057483673096
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0693620  Vali Loss: 0.0854789 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9729927  Vali macro F1 0.9650218 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.197415351867676
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0738195  Vali Loss: 0.0909448 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9686569  Vali macro F1 0.9581682 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.169537305831909
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0721398  Vali Loss: 0.0832322 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9740210  Vali macro F1 0.9656210 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.169532060623169
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0676241  Vali Loss: 0.0947884 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9726311  Vali macro F1 0.9649063 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 6.1650519371032715
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0555013  Vali Loss: 0.0745335 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764446  Vali macro F1 0.9683563 
new best score!!!!
Validation loss decreased (0.081474 --> 0.074533).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.160430669784546
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0522497  Vali Loss: 0.0731611 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764417  Vali macro F1 0.9682769 
new best score!!!!
Validation loss decreased (0.074533 --> 0.073161).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.162637233734131
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0494739  Vali Loss: 0.0727790 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769512  Vali macro F1 0.9689739 
new best score!!!!
Validation loss decreased (0.073161 --> 0.072779).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.167957782745361
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0492852  Vali Loss: 0.0720577 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9779393  Vali macro F1 0.9702107 
new best score!!!!
Validation loss decreased (0.072779 --> 0.072058).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.186151504516602
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0507081  Vali Loss: 0.0735751 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759452  Vali macro F1 0.9668444 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.165290117263794
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0496487  Vali Loss: 0.0721930 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9768868  Vali macro F1 0.9682215 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.187383651733398
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0481484  Vali Loss: 0.0728545 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9753700  Vali macro F1 0.9664520 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.167997121810913
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0476174  Vali Loss: 0.0722682 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769149  Vali macro F1 0.9682451 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.165120601654053
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0466921  Vali Loss: 0.0740805 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759390  Vali macro F1 0.9672371 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 6.1659910678863525
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0462824  Vali Loss: 0.0728682 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769149  Vali macro F1 0.9682451 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.1735663414001465
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0461763  Vali Loss: 0.0728079 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769149  Vali macro F1 0.9682451 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.190670490264893
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0448260  Vali Loss: 0.0725809 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769077  Vali macro F1 0.9683500 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.163776397705078
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0462386  Vali Loss: 0.0724994 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9774068  Vali macro F1 0.9686688 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.169022560119629
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0462485  Vali Loss: 0.0725005 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769077  Vali macro F1 0.9683500 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 6.1802098751068115
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0487481  Vali Loss: 0.0725037 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769077  Vali macro F1 0.9683500 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.167985439300537
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0465953  Vali Loss: 0.0724680 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769077  Vali macro F1 0.9683500 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.165573358535767
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0451359  Vali Loss: 0.0724260 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9773986  Vali macro F1 0.9687724 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.172675132751465
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0471876  Vali Loss: 0.0724308 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9773986  Vali macro F1 0.9687724 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.186946868896484
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0454521  Vali Loss: 0.0724266 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769077  Vali macro F1 0.9683500 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8250729  Test weighted F1: 0.8342153  Test macro F1 0.7904242 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.166784286499023
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0498262  Vali Loss: 0.0739345 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764557  Vali macro F1 0.9670858 
Validation loss decreased (inf --> 0.073934).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.165307998657227
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0489697  Vali Loss: 0.0723548 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759179  Vali macro F1 0.9665374 
new best score!!!!
Validation loss decreased (0.073934 --> 0.072355).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.160503149032593
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0477173  Vali Loss: 0.0735608 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9763933  Vali macro F1 0.9678625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.147452116012573
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0467207  Vali Loss: 0.0712578 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9794473  Vali macro F1 0.9729955 
new best score!!!!
Validation loss decreased (0.072355 --> 0.071258).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.173913478851318
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0464347  Vali Loss: 0.0725200 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9774045  Vali macro F1 0.9701808 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.199270486831665
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0476348  Vali Loss: 0.0746881 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9734480  Vali macro F1 0.9629055 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.188851594924927
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0462627  Vali Loss: 0.0715686 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9779091  Vali macro F1 0.9694695 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.171246767044067
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0448282  Vali Loss: 0.0726546 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769386  Vali macro F1 0.9686316 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.169475793838501
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0450806  Vali Loss: 0.0715039 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9749788  Vali macro F1 0.9664506 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.170961856842041
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0454749  Vali Loss: 0.0737891 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754721  Vali macro F1 0.9667431 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.17722749710083
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0442854  Vali Loss: 0.0734018 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9739357  Vali macro F1 0.9634979 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.1814868450164795
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0437463  Vali Loss: 0.0708128 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764094  Vali macro F1 0.9674202 
new best score!!!!
Validation loss decreased (0.071258 --> 0.070813).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.195237159729004
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0439022  Vali Loss: 0.0722745 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759561  Vali macro F1 0.9670515 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.203740358352661
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0422379  Vali Loss: 0.0710507 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754128  Vali macro F1 0.9664054 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.1816346645355225
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0440820  Vali Loss: 0.0744611 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9745085  Vali macro F1 0.9660589 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.179596185684204
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0418320  Vali Loss: 0.0729311 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9744268  Vali macro F1 0.9642432 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.177318334579468
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0425642  Vali Loss: 0.0749378 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9730012  Vali macro F1 0.9632607 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.178656339645386
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0391927  Vali Loss: 0.0717506 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764283  Vali macro F1 0.9676955 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.1756744384765625
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0383384  Vali Loss: 0.0716435 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9769193  Vali macro F1 0.9681180 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.185459136962891
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0384611  Vali Loss: 0.0721363 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9749491  Vali macro F1 0.9660172 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.191235780715942
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0388773  Vali Loss: 0.0720371 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754496  Vali macro F1 0.9668170 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.172270774841309
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0381690  Vali Loss: 0.0721940 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759390  Vali macro F1 0.9672371 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.177366256713867
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0375196  Vali Loss: 0.0720949 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764290  Vali macro F1 0.9676583 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.171572208404541
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0373262  Vali Loss: 0.0720787 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764290  Vali macro F1 0.9676583 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.168292760848999
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0386956  Vali Loss: 0.0720402 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764290  Vali macro F1 0.9676583 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.173298358917236
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0394746  Vali Loss: 0.0720484 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764290  Vali macro F1 0.9676583 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.189870119094849
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0389568  Vali Loss: 0.0720441 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759390  Vali macro F1 0.9672371 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8355283  Test weighted F1: 0.8433378  Test macro F1 0.8033561 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014952 0.00018225 0.0010989  0.00140056 0.0005071  0.00063211]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.005674362182617
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.2146570  Vali Loss: 0.8098747 Vali Accuracy: 0.6692587  Vali weighted F1: 0.5587997  Vali macro F1 0.2810374 
Validation loss decreased (inf --> 0.809875).  Saving model ...
Epoch: 2 cost time: 5.966984510421753
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.6798034  Vali Loss: 0.6138576 Vali Accuracy: 0.7682737  Vali weighted F1: 0.7260263  Vali macro F1 0.5372828 
new best score!!!!
Validation loss decreased (0.809875 --> 0.613858).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.9561426639556885
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.5231539  Vali Loss: 0.4673489 Vali Accuracy: 0.8408502  Vali weighted F1: 0.8279465  Vali macro F1 0.7877396 
new best score!!!!
Validation loss decreased (0.613858 --> 0.467349).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.962838411331177
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.3730422  Vali Loss: 0.3448053 Vali Accuracy: 0.8833593  Vali weighted F1: 0.8771317  Vali macro F1 0.8476956 
new best score!!!!
Validation loss decreased (0.467349 --> 0.344805).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.975424289703369
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2740497  Vali Loss: 0.2592979 Vali Accuracy: 0.9139450  Vali weighted F1: 0.9112977  Vali macro F1 0.8864761 
new best score!!!!
Validation loss decreased (0.344805 --> 0.259298).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.982569217681885
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2310660  Vali Loss: 0.2341282 Vali Accuracy: 0.9201659  Vali weighted F1: 0.9181878  Vali macro F1 0.8904003 
new best score!!!!
Validation loss decreased (0.259298 --> 0.234128).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.994580507278442
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.2048794  Vali Loss: 0.2123773 Vali Accuracy: 0.9284603  Vali weighted F1: 0.9280239  Vali macro F1 0.9081520 
new best score!!!!
Validation loss decreased (0.234128 --> 0.212377).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.997933864593506
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1840385  Vali Loss: 0.1920387 Vali Accuracy: 0.9326076  Vali weighted F1: 0.9319041  Vali macro F1 0.9133437 
new best score!!!!
Validation loss decreased (0.212377 --> 0.192039).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.971410751342773
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1652384  Vali Loss: 0.2076233 Vali Accuracy: 0.9362364  Vali weighted F1: 0.9350137  Vali macro F1 0.9156264 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.973021745681763
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1593801  Vali Loss: 0.1832863 Vali Accuracy: 0.9409020  Vali weighted F1: 0.9413481  Vali macro F1 0.9250221 
new best score!!!!
Validation loss decreased (0.192039 --> 0.183286).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.97660231590271
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1500589  Vali Loss: 0.1684882 Vali Accuracy: 0.9414204  Vali weighted F1: 0.9416251  Vali macro F1 0.9223364 
new best score!!!!
Validation loss decreased (0.183286 --> 0.168488).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.975634336471558
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1443885  Vali Loss: 0.1572869 Vali Accuracy: 0.9414204  Vali weighted F1: 0.9412736  Vali macro F1 0.9230152 
new best score!!!!
Validation loss decreased (0.168488 --> 0.157287).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.969565153121948
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1319172  Vali Loss: 0.1703293 Vali Accuracy: 0.9471229  Vali weighted F1: 0.9474113  Vali macro F1 0.9305163 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.979419469833374
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1348500  Vali Loss: 0.1621020 Vali Accuracy: 0.9476413  Vali weighted F1: 0.9468773  Vali macro F1 0.9322657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.974848031997681
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1260262  Vali Loss: 0.1433059 Vali Accuracy: 0.9455677  Vali weighted F1: 0.9456833  Vali macro F1 0.9273765 
new best score!!!!
Validation loss decreased (0.157287 --> 0.143306).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.974539279937744
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1105124  Vali Loss: 0.1330111 Vali Accuracy: 0.9543805  Vali weighted F1: 0.9540861  Vali macro F1 0.9399984 
new best score!!!!
Validation loss decreased (0.143306 --> 0.133011).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.981142520904541
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1108444  Vali Loss: 0.1262456 Vali Accuracy: 0.9574909  Vali weighted F1: 0.9569643  Vali macro F1 0.9431902 
new best score!!!!
Validation loss decreased (0.133011 --> 0.126246).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.974424362182617
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.1039607  Vali Loss: 0.1022270 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9623043  Vali macro F1 0.9494058 
new best score!!!!
Validation loss decreased (0.126246 --> 0.102227).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.975069284439087
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0968927  Vali Loss: 0.1258153 Vali Accuracy: 0.9523069  Vali weighted F1: 0.9521157  Vali macro F1 0.9360944 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.961714744567871
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0884581  Vali Loss: 0.1059020 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9643803  Vali macro F1 0.9559081 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.990142345428467
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0845939  Vali Loss: 0.1027999 Vali Accuracy: 0.9642302  Vali weighted F1: 0.9641100  Vali macro F1 0.9514411 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 5.985015630722046
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0751413  Vali Loss: 0.1017333 Vali Accuracy: 0.9637118  Vali weighted F1: 0.9635922  Vali macro F1 0.9553899 
new best score!!!!
Validation loss decreased (0.102227 --> 0.101733).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.971590518951416
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0819842  Vali Loss: 0.0888597 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9715995  Vali macro F1 0.9642322 
new best score!!!!
Validation loss decreased (0.101733 --> 0.088860).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.97248911857605
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0730878  Vali Loss: 0.0930320 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9700223  Vali macro F1 0.9622170 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.98902153968811
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0668350  Vali Loss: 0.0994261 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9640954  Vali macro F1 0.9552182 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.97833514213562
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0634071  Vali Loss: 0.0872699 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9700666  Vali macro F1 0.9659711 
new best score!!!!
Validation loss decreased (0.088860 --> 0.087270).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.9808995723724365
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0637195  Vali Loss: 0.0755718 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757645  Vali macro F1 0.9712478 
new best score!!!!
Validation loss decreased (0.087270 --> 0.075572).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.99270486831665
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0620312  Vali Loss: 0.0738513 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9755732  Vali macro F1 0.9717451 
new best score!!!!
Validation loss decreased (0.075572 --> 0.073851).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.990301847457886
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0582134  Vali Loss: 0.0762967 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9739586  Vali macro F1 0.9686055 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.976909399032593
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0633426  Vali Loss: 0.0691821 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9747110  Vali macro F1 0.9690605 
new best score!!!!
Validation loss decreased (0.073851 --> 0.069182).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.988135576248169
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0512472  Vali Loss: 0.0832404 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9699938  Vali macro F1 0.9640613 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.9788978099823
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0567800  Vali Loss: 0.0730727 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9741897  Vali macro F1 0.9686116 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.976284980773926
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0480179  Vali Loss: 0.0706223 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9753557  Vali macro F1 0.9697871 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.979743957519531
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0531553  Vali Loss: 0.0758811 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9742723  Vali macro F1 0.9690523 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.0031538009643555
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0453255  Vali Loss: 0.0586688 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829395  Vali macro F1 0.9790176 
new best score!!!!
Validation loss decreased (0.069182 --> 0.058669).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.985767841339111
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0455373  Vali Loss: 0.0729889 Vali Accuracy: 0.9714878  Vali weighted F1: 0.9716590  Vali macro F1 0.9644871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.985389947891235
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0423305  Vali Loss: 0.0933215 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9694336  Vali macro F1 0.9570786 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.9773008823394775
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0460766  Vali Loss: 0.0727056 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9803433  Vali macro F1 0.9760801 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.976571559906006
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0397536  Vali Loss: 0.0760070 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9743838  Vali macro F1 0.9689264 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 5.9786906242370605
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0385940  Vali Loss: 0.0628378 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9776790  Vali macro F1 0.9724883 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 5.975057363510132
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0272255  Vali Loss: 0.0599813 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808105  Vali macro F1 0.9764597 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.988614082336426
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0252086  Vali Loss: 0.0598832 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813585  Vali macro F1 0.9770968 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.982041120529175
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0261153  Vali Loss: 0.0579995 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808661  Vali macro F1 0.9754350 
new best score!!!!
Validation loss decreased (0.058669 --> 0.058000).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.968087196350098
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0263734  Vali Loss: 0.0580821 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808424  Vali macro F1 0.9754336 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.989186763763428
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0247217  Vali Loss: 0.0593839 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792500  Vali macro F1 0.9736053 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.975957632064819
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0255307  Vali Loss: 0.0568253 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808241  Vali macro F1 0.9757118 
new best score!!!!
Validation loss decreased (0.058000 --> 0.056825).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.9755823612213135
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0244001  Vali Loss: 0.0578796 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813694  Vali macro F1 0.9764872 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.964320182800293
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0237008  Vali Loss: 0.0563859 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824038  Vali macro F1 0.9775310 
new best score!!!!
Validation loss decreased (0.056825 --> 0.056386).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 5.994871139526367
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0237925  Vali Loss: 0.0595151 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9807981  Vali macro F1 0.9756837 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.9695961475372314
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0228182  Vali Loss: 0.0588553 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813582  Vali macro F1 0.9767432 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.977811813354492
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0232659  Vali Loss: 0.0570179 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829153  Vali macro F1 0.9780375 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.974574565887451
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0231696  Vali Loss: 0.0565612 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834287  Vali macro F1 0.9797420 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.967968940734863
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0219379  Vali Loss: 0.0578513 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834096  Vali macro F1 0.9796824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 5.973843336105347
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0211079  Vali Loss: 0.0568106 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.97067666053772
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0217081  Vali Loss: 0.0563735 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
new best score!!!!
Validation loss decreased (0.056386 --> 0.056374).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 5.9923646450042725
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0204834  Vali Loss: 0.0568996 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834096  Vali macro F1 0.9796824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 5.969463348388672
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0220196  Vali Loss: 0.0572911 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 5.988215684890747
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0212729  Vali Loss: 0.0567765 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 5.984116554260254
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0213840  Vali Loss: 0.0569619 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 5.975225925445557
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0222832  Vali Loss: 0.0567575 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 5.964468717575073
VALI: Epoch: 61, Steps: 68 | Train Loss: 0.0213468  Vali Loss: 0.0568081 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 5.974531888961792
VALI: Epoch: 62, Steps: 68 | Train Loss: 0.0201761  Vali Loss: 0.0567785 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 5.98839545249939
VALI: Epoch: 63, Steps: 68 | Train Loss: 0.0221305  Vali Loss: 0.0567340 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 5.972728252410889
VALI: Epoch: 64, Steps: 68 | Train Loss: 0.0214417  Vali Loss: 0.0567196 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 5.965044260025024
VALI: Epoch: 65, Steps: 68 | Train Loss: 0.0201681  Vali Loss: 0.0567119 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 66 cost time: 5.969294309616089
VALI: Epoch: 66, Steps: 68 | Train Loss: 0.0203742  Vali Loss: 0.0567145 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 5.982856035232544
VALI: Epoch: 67, Steps: 68 | Train Loss: 0.0223212  Vali Loss: 0.0567163 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 5.963772535324097
VALI: Epoch: 68, Steps: 68 | Train Loss: 0.0212119  Vali Loss: 0.0567097 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 5.976787567138672
VALI: Epoch: 69, Steps: 68 | Train Loss: 0.0209037  Vali Loss: 0.0567175 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 5.993000268936157
VALI: Epoch: 70, Steps: 68 | Train Loss: 0.0205001  Vali Loss: 0.0567168 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839377  Vali macro F1 0.9802110 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9541115  Test weighted F1: 0.9549482  Test macro F1 0.9309953 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.987481355667114
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0238387  Vali Loss: 0.0628175 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792428  Vali macro F1 0.9743576 
Validation loss decreased (inf --> 0.062817).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.979272365570068
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0226494  Vali Loss: 0.0591885 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808638  Vali macro F1 0.9755014 
new best score!!!!
Validation loss decreased (0.062817 --> 0.059188).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.968594074249268
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0212463  Vali Loss: 0.0607813 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9803681  Vali macro F1 0.9752825 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.968759059906006
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0214016  Vali Loss: 0.0618454 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808194  Vali macro F1 0.9766024 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.9927098751068115
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0220891  Vali Loss: 0.0579849 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9803551  Vali macro F1 0.9750094 
new best score!!!!
Validation loss decreased (0.059188 --> 0.057985).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.014610290527344
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0219525  Vali Loss: 0.0555172 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813605  Vali macro F1 0.9762157 
new best score!!!!
Validation loss decreased (0.057985 --> 0.055517).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 5.982891082763672
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0201780  Vali Loss: 0.0578463 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818770  Vali macro F1 0.9769625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 5.989025592803955
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0193205  Vali Loss: 0.0592752 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813761  Vali macro F1 0.9765582 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.003734827041626
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0214538  Vali Loss: 0.0584024 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813118  Vali macro F1 0.9762536 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 5.984601736068726
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0211873  Vali Loss: 0.0555847 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813720  Vali macro F1 0.9759225 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 5.9902801513671875
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0185734  Vali Loss: 0.0549999 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823813  Vali macro F1 0.9784162 
new best score!!!!
Validation loss decreased (0.055517 --> 0.055000).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 5.993612289428711
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0204644  Vali Loss: 0.0566410 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839381  Vali macro F1 0.9797279 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.003610134124756
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0202856  Vali Loss: 0.0554337 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839590  Vali macro F1 0.9797352 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 5.959704637527466
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0183883  Vali Loss: 0.0565520 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818909  Vali macro F1 0.9767913 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 5.960949182510376
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0183067  Vali Loss: 0.0578766 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823962  Vali macro F1 0.9782213 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 5.9451751708984375
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0193670  Vali Loss: 0.0586876 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834611  Vali macro F1 0.9801196 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 5.9532482624053955
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0195466  Vali Loss: 0.0593926 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813090  Vali macro F1 0.9768553 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 5.962562799453735
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0196287  Vali Loss: 0.0541731 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844557  Vali macro F1 0.9809192 
new best score!!!!
Validation loss decreased (0.055000 --> 0.054173).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 5.963775634765625
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0183381  Vali Loss: 0.0567783 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839724  Vali macro F1 0.9803018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 5.9722740650177
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0188200  Vali Loss: 0.0554438 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834108  Vali macro F1 0.9796380 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 5.95946192741394
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0197200  Vali Loss: 0.0588320 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818702  Vali macro F1 0.9779206 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 5.943280458450317
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0190488  Vali Loss: 0.0562871 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839310  Vali macro F1 0.9794839 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 5.961519002914429
Fine Tuning VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0181787  Vali Loss: 0.0542222 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839366  Vali macro F1 0.9796875 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 5.942402601242065
Fine Tuning VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0167654  Vali Loss: 0.0543204 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834288  Vali macro F1 0.9792168 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 5.954999685287476
Fine Tuning VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0160550  Vali Loss: 0.0540809 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834304  Vali macro F1 0.9797883 
new best score!!!!
Validation loss decreased (0.054173 --> 0.054081).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 5.959729909896851
Fine Tuning VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0164919  Vali Loss: 0.0547969 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839354  Vali macro F1 0.9802542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.481891870498657
Fine Tuning VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0158759  Vali Loss: 0.0550507 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839289  Vali macro F1 0.9799403 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 5.960359334945679
Fine Tuning VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0178605  Vali Loss: 0.0548327 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844459  Vali macro F1 0.9807248 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 5.9444568157196045
Fine Tuning VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0165309  Vali Loss: 0.0539120 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834218  Vali macro F1 0.9795169 
new best score!!!!
Validation loss decreased (0.054081 --> 0.053912).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 5.9408018589019775
Fine Tuning VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0166662  Vali Loss: 0.0555600 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839414  Vali macro F1 0.9801495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 5.938966512680054
Fine Tuning VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0152943  Vali Loss: 0.0546601 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844390  Vali macro F1 0.9804532 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 5.937540054321289
Fine Tuning VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0171257  Vali Loss: 0.0549849 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833984  Vali macro F1 0.9794368 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 5.949702262878418
Fine Tuning VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0158708  Vali Loss: 0.0547137 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834288  Vali macro F1 0.9792168 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 5.969849109649658
Fine Tuning VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0159573  Vali Loss: 0.0549524 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844551  Vali macro F1 0.9804703 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 35 cost time: 5.946398735046387
Fine Tuning VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0158689  Vali Loss: 0.0548472 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839382  Vali macro F1 0.9796858 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 5.939019680023193
Fine Tuning VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0156406  Vali Loss: 0.0549626 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844551  Vali macro F1 0.9804703 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 5.943740367889404
Fine Tuning VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0152432  Vali Loss: 0.0549947 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839382  Vali macro F1 0.9796858 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 5.947174549102783
Fine Tuning VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0160456  Vali Loss: 0.0548698 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839405  Vali macro F1 0.9796472 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 5.946693181991577
Fine Tuning VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0164466  Vali Loss: 0.0550456 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839405  Vali macro F1 0.9796472 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 40 cost time: 5.945159673690796
Fine Tuning VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0166045  Vali Loss: 0.0550464 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839405  Vali macro F1 0.9796472 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 5.967390298843384
Fine Tuning VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0156027  Vali Loss: 0.0550554 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839405  Vali macro F1 0.9796472 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 5.959015607833862
Fine Tuning VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0164581  Vali Loss: 0.0550440 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839405  Vali macro F1 0.9796472 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 5.940608501434326
Fine Tuning VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0166905  Vali Loss: 0.0550392 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839405  Vali macro F1 0.9796472 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 5.940159320831299
Fine Tuning VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0159467  Vali Loss: 0.0550311 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839300  Vali macro F1 0.9798998 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9542655  Test weighted F1: 0.9553318  Test macro F1 0.9313257 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014912 0.00018139 0.00098425 0.00125471 0.00049529 0.00061237]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.055254697799683
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2171820  Vali Loss: 0.7481462 Vali Accuracy: 0.7058524  Vali weighted F1: 0.6211186  Vali macro F1 0.3425992 
Validation loss decreased (inf --> 0.748146).  Saving model ...
Epoch: 2 cost time: 6.0609290599823
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6794933  Vali Loss: 0.5523446 Vali Accuracy: 0.7954198  Vali weighted F1: 0.7488639  Vali macro F1 0.5415656 
new best score!!!!
Validation loss decreased (0.748146 --> 0.552345).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.076084613800049
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5093193  Vali Loss: 0.4148741 Vali Accuracy: 0.8575064  Vali weighted F1: 0.8419407  Vali macro F1 0.7823515 
new best score!!!!
Validation loss decreased (0.552345 --> 0.414874).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.061707973480225
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3638434  Vali Loss: 0.3156124 Vali Accuracy: 0.8905852  Vali weighted F1: 0.8906286  Vali macro F1 0.8490863 
new best score!!!!
Validation loss decreased (0.414874 --> 0.315612).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.07644248008728
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2651204  Vali Loss: 0.2274816 Vali Accuracy: 0.9211196  Vali weighted F1: 0.9186289  Vali macro F1 0.8860273 
new best score!!!!
Validation loss decreased (0.315612 --> 0.227482).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.0650975704193115
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2181351  Vali Loss: 0.1869531 Vali Accuracy: 0.9399491  Vali weighted F1: 0.9395456  Vali macro F1 0.9125840 
new best score!!!!
Validation loss decreased (0.227482 --> 0.186953).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.0679357051849365
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1981175  Vali Loss: 0.1676062 Vali Accuracy: 0.9424936  Vali weighted F1: 0.9410895  Vali macro F1 0.9168908 
new best score!!!!
Validation loss decreased (0.186953 --> 0.167606).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.058027029037476
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1783900  Vali Loss: 0.1570803 Vali Accuracy: 0.9526718  Vali weighted F1: 0.9530014  Vali macro F1 0.9347872 
new best score!!!!
Validation loss decreased (0.167606 --> 0.157080).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.077774524688721
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1695099  Vali Loss: 0.1467738 Vali Accuracy: 0.9552163  Vali weighted F1: 0.9551803  Vali macro F1 0.9366828 
new best score!!!!
Validation loss decreased (0.157080 --> 0.146774).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.077423095703125
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1515173  Vali Loss: 0.1415819 Vali Accuracy: 0.9567430  Vali weighted F1: 0.9565044  Vali macro F1 0.9407437 
new best score!!!!
Validation loss decreased (0.146774 --> 0.141582).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.099457502365112
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1447618  Vali Loss: 0.1212386 Vali Accuracy: 0.9582697  Vali weighted F1: 0.9582057  Vali macro F1 0.9400706 
new best score!!!!
Validation loss decreased (0.141582 --> 0.121239).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.067696571350098
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1375621  Vali Loss: 0.1278973 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9601997  Vali macro F1 0.9448319 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.214761018753052
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1275023  Vali Loss: 0.1177551 Vali Accuracy: 0.9562341  Vali weighted F1: 0.9551876  Vali macro F1 0.9385095 
new best score!!!!
Validation loss decreased (0.121239 --> 0.117755).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.056460857391357
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1294237  Vali Loss: 0.1005588 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9647885  Vali macro F1 0.9502491 
new best score!!!!
Validation loss decreased (0.117755 --> 0.100559).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.078394889831543
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1120085  Vali Loss: 0.0993534 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9678497  Vali macro F1 0.9533615 
new best score!!!!
Validation loss decreased (0.100559 --> 0.099353).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.056411981582642
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1048077  Vali Loss: 0.0992601 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9648367  Vali macro F1 0.9488966 
new best score!!!!
Validation loss decreased (0.099353 --> 0.099260).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.073603391647339
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1070428  Vali Loss: 0.0994898 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9697702  Vali macro F1 0.9575097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.07868504524231
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0997836  Vali Loss: 0.1019738 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9684728  Vali macro F1 0.9539353 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.058314561843872
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0987115  Vali Loss: 0.0896837 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9734484  Vali macro F1 0.9655178 
new best score!!!!
Validation loss decreased (0.099260 --> 0.089684).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.069575309753418
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0933306  Vali Loss: 0.0902840 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9756731  Vali macro F1 0.9643365 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.056348085403442
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0901581  Vali Loss: 0.0896208 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9735916  Vali macro F1 0.9645312 
new best score!!!!
Validation loss decreased (0.089684 --> 0.089621).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.048109531402588
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0867333  Vali Loss: 0.0833990 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9743588  Vali macro F1 0.9633522 
new best score!!!!
Validation loss decreased (0.089621 --> 0.083399).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.0394287109375
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0776708  Vali Loss: 0.0828622 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9739699  Vali macro F1 0.9640969 
new best score!!!!
Validation loss decreased (0.083399 --> 0.082862).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.062809228897095
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0748860  Vali Loss: 0.0921038 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9715785  Vali macro F1 0.9547721 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.068260908126831
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0753380  Vali Loss: 0.0985838 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9688008  Vali macro F1 0.9501663 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.03476619720459
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0759058  Vali Loss: 0.0678984 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9797882  Vali macro F1 0.9724162 
new best score!!!!
Validation loss decreased (0.082862 --> 0.067898).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.030330419540405
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0659814  Vali Loss: 0.0683381 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9772865  Vali macro F1 0.9659681 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.044212579727173
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0684085  Vali Loss: 0.1256212 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9618472  Vali macro F1 0.9518471 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.036439418792725
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0931380  Vali Loss: 0.0696762 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9788505  Vali macro F1 0.9688892 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.0268168449401855
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0744139  Vali Loss: 0.0781016 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9736616  Vali macro F1 0.9620056 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.040025949478149
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0565650  Vali Loss: 0.0653958 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9803453  Vali macro F1 0.9720502 
new best score!!!!
Validation loss decreased (0.067898 --> 0.065396).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.0478596687316895
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0557431  Vali Loss: 0.0906893 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9749279  Vali macro F1 0.9651787 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.029897451400757
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0570762  Vali Loss: 0.0636077 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9787081  Vali macro F1 0.9704665 
new best score!!!!
Validation loss decreased (0.065396 --> 0.063608).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.026853799819946
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0539886  Vali Loss: 0.0650688 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9765780  Vali macro F1 0.9674759 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.01859974861145
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0540615  Vali Loss: 0.0624911 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9771284  Vali macro F1 0.9673057 
new best score!!!!
Validation loss decreased (0.063608 --> 0.062491).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.018215894699097
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0522720  Vali Loss: 0.0929800 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9721028  Vali macro F1 0.9605800 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.029592037200928
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0612377  Vali Loss: 0.0569768 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9807775  Vali macro F1 0.9729559 
new best score!!!!
Validation loss decreased (0.062491 --> 0.056977).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.050522089004517
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0478347  Vali Loss: 0.0620584 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9787936  Vali macro F1 0.9686302 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.058988094329834
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0428111  Vali Loss: 0.0670784 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842939  Vali macro F1 0.9797235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.05188512802124
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0444273  Vali Loss: 0.0738206 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9783022  Vali macro F1 0.9690311 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.027055978775024
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0424359  Vali Loss: 0.0692141 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9793031  Vali macro F1 0.9696742 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.02699089050293
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0422555  Vali Loss: 0.0635992 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9812867  Vali macro F1 0.9739485 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 43 cost time: 6.023956298828125
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0323875  Vali Loss: 0.0572066 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9828260  Vali macro F1 0.9768562 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.028892755508423
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0280604  Vali Loss: 0.0559666 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9843684  Vali macro F1 0.9786010 
new best score!!!!
Validation loss decreased (0.056977 --> 0.055967).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.035877704620361
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0291191  Vali Loss: 0.0555676 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838632  Vali macro F1 0.9779571 
new best score!!!!
Validation loss decreased (0.055967 --> 0.055568).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.057180881500244
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0292860  Vali Loss: 0.0549478 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838836  Vali macro F1 0.9780175 
new best score!!!!
Validation loss decreased (0.055568 --> 0.054948).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.0446131229400635
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0307234  Vali Loss: 0.0554700 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833530  Vali macro F1 0.9773438 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.03087854385376
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0267325  Vali Loss: 0.0543864 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848479  Vali macro F1 0.9794257 
new best score!!!!
Validation loss decreased (0.054948 --> 0.054386).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.0259997844696045
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0269944  Vali Loss: 0.0551995 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833800  Vali macro F1 0.9774019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.0289247035980225
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0278658  Vali Loss: 0.0503795 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863789  Vali macro F1 0.9817399 
new best score!!!!
Validation loss decreased (0.054386 --> 0.050379).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.035972356796265
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0287615  Vali Loss: 0.0514570 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848665  Vali macro F1 0.9793694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.045135736465454
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0257483  Vali Loss: 0.0510879 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858715  Vali macro F1 0.9811063 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.052010536193848
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0254080  Vali Loss: 0.0523187 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858715  Vali macro F1 0.9811063 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.051333427429199
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0271172  Vali Loss: 0.0533543 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838639  Vali macro F1 0.9779185 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.034293174743652
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0262000  Vali Loss: 0.0507175 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838143  Vali macro F1 0.9774025 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 6.0301008224487305
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0257555  Vali Loss: 0.0510177 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848461  Vali macro F1 0.9788605 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.029247522354126
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0246539  Vali Loss: 0.0512233 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848461  Vali macro F1 0.9788605 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.049727201461792
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0257831  Vali Loss: 0.0510795 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848461  Vali macro F1 0.9788605 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.04297137260437
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0249941  Vali Loss: 0.0513608 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848622  Vali macro F1 0.9791892 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.034251689910889
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0243226  Vali Loss: 0.0511323 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853515  Vali macro F1 0.9797390 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.038486480712891
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0245629  Vali Loss: 0.0511139 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853515  Vali macro F1 0.9797390 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.0175933837890625
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0254281  Vali Loss: 0.0510478 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853515  Vali macro F1 0.9797390 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.026293039321899
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0248599  Vali Loss: 0.0510893 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853515  Vali macro F1 0.9797390 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.03029727935791
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0262483  Vali Loss: 0.0510924 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853515  Vali macro F1 0.9797390 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.037977457046509
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0261587  Vali Loss: 0.0510751 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853515  Vali macro F1 0.9797390 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8515331  Test weighted F1: 0.8585171  Test macro F1 0.8270240 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.066533088684082
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0275784  Vali Loss: 0.0569336 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9849197  Vali macro F1 0.9797226 
Validation loss decreased (inf --> 0.056934).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.079493999481201
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0270286  Vali Loss: 0.0502340 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842925  Vali macro F1 0.9781942 
new best score!!!!
Validation loss decreased (0.056934 --> 0.050234).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.063689470291138
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0270032  Vali Loss: 0.0514523 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838482  Vali macro F1 0.9773947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.049794673919678
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0253898  Vali Loss: 0.0536220 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848111  Vali macro F1 0.9795662 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.066635608673096
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0242071  Vali Loss: 0.0510635 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858448  Vali macro F1 0.9805992 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.0603601932525635
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0242362  Vali Loss: 0.0520390 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853381  Vali macro F1 0.9802335 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.060523986816406
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0258708  Vali Loss: 0.0496196 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842769  Vali macro F1 0.9784890 
new best score!!!!
Validation loss decreased (0.050234 --> 0.049620).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.07160758972168
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0234492  Vali Loss: 0.0525586 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848329  Vali macro F1 0.9794865 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.080790758132935
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0240939  Vali Loss: 0.0518765 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853341  Vali macro F1 0.9803490 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.089533090591431
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0246087  Vali Loss: 0.0501472 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848067  Vali macro F1 0.9788392 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.065327167510986
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0243449  Vali Loss: 0.0530370 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838890  Vali macro F1 0.9780075 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.07525897026062
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0238471  Vali Loss: 0.0497991 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858156  Vali macro F1 0.9806025 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.0702269077301025
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0232189  Vali Loss: 0.0512037 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848145  Vali macro F1 0.9791350 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.066469669342041
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0221889  Vali Loss: 0.0495967 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868407  Vali macro F1 0.9820300 
new best score!!!!
Validation loss decreased (0.049620 --> 0.049597).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.051636219024658
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0226300  Vali Loss: 0.0500178 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853341  Vali macro F1 0.9799596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.0702104568481445
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0254188  Vali Loss: 0.0521950 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832960  Vali macro F1 0.9765581 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.200483798980713
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0238518  Vali Loss: 0.0500429 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858099  Vali macro F1 0.9808332 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 7.487972736358643
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0216151  Vali Loss: 0.0479087 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848396  Vali macro F1 0.9793495 
new best score!!!!
Validation loss decreased (0.049597 --> 0.047909).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 7.311421155929565
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0212959  Vali Loss: 0.0497156 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852881  Vali macro F1 0.9802623 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.056869983673096
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0200883  Vali Loss: 0.0492195 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842565  Vali macro F1 0.9788871 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.0389039516448975
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0203341  Vali Loss: 0.0512915 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9843242  Vali macro F1 0.9785393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.04797887802124
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0212526  Vali Loss: 0.0484039 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852750  Vali macro F1 0.9803775 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.062898635864258
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0201854  Vali Loss: 0.0504788 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853657  Vali macro F1 0.9803165 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.067376136779785
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0196709  Vali Loss: 0.0486289 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853522  Vali macro F1 0.9799922 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.040713548660278
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0189928  Vali Loss: 0.0482437 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853243  Vali macro F1 0.9799888 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.0310890674591064
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0190610  Vali Loss: 0.0474389 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858057  Vali macro F1 0.9806640 
new best score!!!!
Validation loss decreased (0.047909 --> 0.047439).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.058721542358398
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0206609  Vali Loss: 0.0478448 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848218  Vali macro F1 0.9791240 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.046100616455078
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0194634  Vali Loss: 0.0478450 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853243  Vali macro F1 0.9799888 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.045071601867676
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0184957  Vali Loss: 0.0477729 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9848097  Vali macro F1 0.9793845 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.033607244491577
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0211949  Vali Loss: 0.0481227 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863196  Vali macro F1 0.9814697 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.040392637252808
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0209840  Vali Loss: 0.0483966 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853243  Vali macro F1 0.9799888 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 6.067962646484375
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0196702  Vali Loss: 0.0482815 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.075775146484375
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0191057  Vali Loss: 0.0482379 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.053245544433594
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0204691  Vali Loss: 0.0480790 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.043970823287964
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0183161  Vali Loss: 0.0480143 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.036179065704346
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0196580  Vali Loss: 0.0479835 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 37 cost time: 6.053804874420166
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0198958  Vali Loss: 0.0479741 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.041895151138306
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0188309  Vali Loss: 0.0479735 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.057424545288086
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0199588  Vali Loss: 0.0479696 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.0424792766571045
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0190847  Vali Loss: 0.0479726 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.061832666397095
Fine Tuning VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0166968  Vali Loss: 0.0479646 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858151  Vali macro F1 0.9805844 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8483952  Test weighted F1: 0.8562671  Test macro F1 0.8272413 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014914 0.00018464 0.000999   0.00124378 0.00051733 0.00061958]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.9532952308654785
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.2052668  Vali Loss: 0.7292282 Vali Accuracy: 0.7059732  Vali weighted F1: 0.6078360  Vali macro F1 0.2973337 
Validation loss decreased (inf --> 0.729228).  Saving model ...
Epoch: 2 cost time: 5.966845989227295
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.6727095  Vali Loss: 0.5321441 Vali Accuracy: 0.8032956  Vali weighted F1: 0.7667769  Vali macro F1 0.5559927 
new best score!!!!
Validation loss decreased (0.729228 --> 0.532144).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.951709270477295
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.4693790  Vali Loss: 0.3348145 Vali Accuracy: 0.8898043  Vali weighted F1: 0.8869179  Vali macro F1 0.8352921 
new best score!!!!
Validation loss decreased (0.532144 --> 0.334815).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.954824924468994
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.3149209  Vali Loss: 0.2406287 Vali Accuracy: 0.9263646  Vali weighted F1: 0.9260096  Vali macro F1 0.8962583 
new best score!!!!
Validation loss decreased (0.334815 --> 0.240629).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.973506212234497
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2489254  Vali Loss: 0.2265425 Vali Accuracy: 0.9330587  Vali weighted F1: 0.9327181  Vali macro F1 0.9060592 
new best score!!!!
Validation loss decreased (0.240629 --> 0.226542).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.9773712158203125
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2187932  Vali Loss: 0.1964142 Vali Accuracy: 0.9325438  Vali weighted F1: 0.9326217  Vali macro F1 0.9058068 
new best score!!!!
Validation loss decreased (0.226542 --> 0.196414).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.995860815048218
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.2055816  Vali Loss: 0.2182012 Vali Accuracy: 0.9335736  Vali weighted F1: 0.9338928  Vali macro F1 0.9078115 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.991011142730713
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1884667  Vali Loss: 0.1809149 Vali Accuracy: 0.9412976  Vali weighted F1: 0.9399472  Vali macro F1 0.9145205 
new best score!!!!
Validation loss decreased (0.196414 --> 0.180915).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.97767972946167
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1664898  Vali Loss: 0.1732628 Vali Accuracy: 0.9428424  Vali weighted F1: 0.9434685  Vali macro F1 0.9195926 
new best score!!!!
Validation loss decreased (0.180915 --> 0.173263).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 9.630516290664673
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1712230  Vali Loss: 0.1472861 Vali Accuracy: 0.9485067  Vali weighted F1: 0.9480741  Vali macro F1 0.9252242 
new best score!!!!
Validation loss decreased (0.173263 --> 0.147286).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.977366924285889
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1495539  Vali Loss: 0.1724456 Vali Accuracy: 0.9449022  Vali weighted F1: 0.9468601  Vali macro F1 0.9231249 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.982651472091675
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1451680  Vali Loss: 0.1313667 Vali Accuracy: 0.9567456  Vali weighted F1: 0.9569524  Vali macro F1 0.9372382 
new best score!!!!
Validation loss decreased (0.147286 --> 0.131367).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.979632377624512
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1327083  Vali Loss: 0.1204270 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9607275  Vali macro F1 0.9417752 
new best score!!!!
Validation loss decreased (0.131367 --> 0.120427).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.9803643226623535
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1213665  Vali Loss: 0.1337880 Vali Accuracy: 0.9541710  Vali weighted F1: 0.9536341  Vali macro F1 0.9330246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.976565599441528
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1240036  Vali Loss: 0.1146298 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9626763  Vali macro F1 0.9476394 
new best score!!!!
Validation loss decreased (0.120427 --> 0.114630).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.994399309158325
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1260509  Vali Loss: 0.1128753 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9647231  Vali macro F1 0.9489976 
new best score!!!!
Validation loss decreased (0.114630 --> 0.112875).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.980090856552124
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1008689  Vali Loss: 0.1169798 Vali Accuracy: 0.9603502  Vali weighted F1: 0.9600219  Vali macro F1 0.9423986 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.95920991897583
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0972626  Vali Loss: 0.1113028 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9645217  Vali macro F1 0.9479839 
new best score!!!!
Validation loss decreased (0.112875 --> 0.111303).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.958349227905273
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0987218  Vali Loss: 0.1055936 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9644647  Vali macro F1 0.9473733 
new best score!!!!
Validation loss decreased (0.111303 --> 0.105594).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.979018926620483
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0929303  Vali Loss: 0.1003860 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9654787  Vali macro F1 0.9505411 
new best score!!!!
Validation loss decreased (0.105594 --> 0.100386).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.947434425354004
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0893715  Vali Loss: 0.1004265 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9699451  Vali macro F1 0.9528388 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.982254266738892
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0859430  Vali Loss: 0.0993878 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9700842  Vali macro F1 0.9554786 
new best score!!!!
Validation loss decreased (0.100386 --> 0.099388).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.980410814285278
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0767695  Vali Loss: 0.0890997 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9718844  Vali macro F1 0.9559656 
new best score!!!!
Validation loss decreased (0.099388 --> 0.089100).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.975488185882568
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0749342  Vali Loss: 0.1116349 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9654755  Vali macro F1 0.9488831 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.992090225219727
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0718163  Vali Loss: 0.0937771 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9719589  Vali macro F1 0.9580697 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.97855281829834
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0762975  Vali Loss: 0.0847759 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9732468  Vali macro F1 0.9583563 
new best score!!!!
Validation loss decreased (0.089100 --> 0.084776).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.973596811294556
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0713968  Vali Loss: 0.0927059 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9719951  Vali macro F1 0.9503377 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.960364580154419
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0639540  Vali Loss: 0.0830920 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9730505  Vali macro F1 0.9585749 
new best score!!!!
Validation loss decreased (0.084776 --> 0.083092).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.970214128494263
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0634702  Vali Loss: 0.0995337 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9710500  Vali macro F1 0.9560782 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.955516576766968
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0613218  Vali Loss: 0.0855943 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9755026  Vali macro F1 0.9627841 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.957303524017334
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0594807  Vali Loss: 0.0845330 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9743821  Vali macro F1 0.9564016 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.952805042266846
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0613359  Vali Loss: 0.0728338 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9749328  Vali macro F1 0.9602164 
new best score!!!!
Validation loss decreased (0.083092 --> 0.072834).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.96985650062561
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0559872  Vali Loss: 0.0738563 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748563  Vali macro F1 0.9603818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.986349582672119
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0490197  Vali Loss: 0.0850237 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748643  Vali macro F1 0.9599377 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.961392402648926
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0510868  Vali Loss: 0.1184865 Vali Accuracy: 0.9624099  Vali weighted F1: 0.9635300  Vali macro F1 0.9488301 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.966359376907349
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0595630  Vali Loss: 0.0806758 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9744949  Vali macro F1 0.9618741 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.9576051235198975
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0496224  Vali Loss: 0.0793783 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9761386  Vali macro F1 0.9630597 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 5.963952302932739
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0378719  Vali Loss: 0.0662114 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9779480  Vali macro F1 0.9661693 
new best score!!!!
Validation loss decreased (0.072834 --> 0.066211).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.965680360794067
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0351261  Vali Loss: 0.0645176 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820144  Vali macro F1 0.9713088 
new best score!!!!
Validation loss decreased (0.066211 --> 0.064518).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.9650349617004395
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0358432  Vali Loss: 0.0636234 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815594  Vali macro F1 0.9704511 
new best score!!!!
Validation loss decreased (0.064518 --> 0.063623).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.970666170120239
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0344980  Vali Loss: 0.0650313 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805317  Vali macro F1 0.9693076 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.98666787147522
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0336714  Vali Loss: 0.0654656 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814607  Vali macro F1 0.9705618 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.971014976501465
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0328187  Vali Loss: 0.0650210 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804598  Vali macro F1 0.9696414 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.961049556732178
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0314479  Vali Loss: 0.0653320 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799420  Vali macro F1 0.9700332 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 5.964682102203369
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0318510  Vali Loss: 0.0665423 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810039  Vali macro F1 0.9704065 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 5.963324546813965
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0305014  Vali Loss: 0.0655151 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804593  Vali macro F1 0.9702139 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.968555212020874
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0303493  Vali Loss: 0.0654002 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799607  Vali macro F1 0.9697148 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.970244884490967
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0312793  Vali Loss: 0.0658468 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809937  Vali macro F1 0.9714409 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 5.970137596130371
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0297778  Vali Loss: 0.0657917 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794505  Vali macro F1 0.9694792 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 5.97892427444458
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0299977  Vali Loss: 0.0653611 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804657  Vali macro F1 0.9709065 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 5.974217414855957
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0319124  Vali Loss: 0.0654110 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804657  Vali macro F1 0.9709065 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 5.968344449996948
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0312012  Vali Loss: 0.0655519 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804657  Vali macro F1 0.9709065 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 5.967008113861084
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0312386  Vali Loss: 0.0655130 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804657  Vali macro F1 0.9709065 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 5.96605110168457
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0307543  Vali Loss: 0.0654078 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804657  Vali macro F1 0.9709065 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 5.962680339813232
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0302960  Vali Loss: 0.0652033 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804657  Vali macro F1 0.9709065 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9642683  Test weighted F1: 0.9640423  Test macro F1 0.9543214 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.077985048294067
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0345432  Vali Loss: 0.0639613 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794502  Vali macro F1 0.9672962 
Validation loss decreased (inf --> 0.063961).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.01010799407959
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0339259  Vali Loss: 0.0663636 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814630  Vali macro F1 0.9709563 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.010610103607178
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0355562  Vali Loss: 0.0671638 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810542  Vali macro F1 0.9708633 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.019308805465698
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0331713  Vali Loss: 0.0652984 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809563  Vali macro F1 0.9700269 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.014601469039917
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0321640  Vali Loss: 0.0675314 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804845  Vali macro F1 0.9696011 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.025615215301514
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0313253  Vali Loss: 0.0647001 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809467  Vali macro F1 0.9704213 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.012950897216797
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0320314  Vali Loss: 0.0695282 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805847  Vali macro F1 0.9697712 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.024616718292236
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0316045  Vali Loss: 0.0638901 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814472  Vali macro F1 0.9709238 
new best score!!!!
Validation loss decreased (0.063961 --> 0.063890).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.032432317733765
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0308622  Vali Loss: 0.0652007 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820087  Vali macro F1 0.9721829 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.019979238510132
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0317331  Vali Loss: 0.0633182 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835249  Vali macro F1 0.9741980 
new best score!!!!
Validation loss decreased (0.063890 --> 0.063318).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.019562005996704
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0302053  Vali Loss: 0.0697121 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9790361  Vali macro F1 0.9687750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.01978063583374
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0309910  Vali Loss: 0.0631970 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825022  Vali macro F1 0.9728004 
new best score!!!!
Validation loss decreased (0.063318 --> 0.063197).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.031063556671143
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0284539  Vali Loss: 0.0627956 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835918  Vali macro F1 0.9739453 
new best score!!!!
Validation loss decreased (0.063197 --> 0.062796).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.027991771697998
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0292446  Vali Loss: 0.0637109 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825218  Vali macro F1 0.9731723 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.01659083366394
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0296747  Vali Loss: 0.0620500 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814899  Vali macro F1 0.9714461 
new best score!!!!
Validation loss decreased (0.062796 --> 0.062050).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.019871950149536
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0267108  Vali Loss: 0.0606955 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820010  Vali macro F1 0.9722248 
new best score!!!!
Validation loss decreased (0.062050 --> 0.060695).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.005282640457153
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0285243  Vali Loss: 0.0652932 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819503  Vali macro F1 0.9713773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.012324571609497
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0282252  Vali Loss: 0.0628551 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825401  Vali macro F1 0.9728499 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.001185178756714
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0280836  Vali Loss: 0.0640186 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819999  Vali macro F1 0.9715485 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.007378816604614
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0274283  Vali Loss: 0.0646073 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9844945  Vali macro F1 0.9749468 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.027410507202148
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0272724  Vali Loss: 0.0652798 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830746  Vali macro F1 0.9737099 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 6.033549785614014
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0263637  Vali Loss: 0.0641687 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.010652303695679
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0252129  Vali Loss: 0.0642439 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.013467311859131
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0249150  Vali Loss: 0.0639748 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.0403971672058105
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0244382  Vali Loss: 0.0638286 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825108  Vali macro F1 0.9727408 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.023303031921387
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0255652  Vali Loss: 0.0647424 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 6.012999057769775
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0242432  Vali Loss: 0.0644997 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.017383575439453
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0248338  Vali Loss: 0.0643665 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.0225160121917725
Fine Tuning VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0242418  Vali Loss: 0.0640871 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.043163061141968
Fine Tuning VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0242848  Vali Loss: 0.0640020 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.037394762039185
Fine Tuning VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0252221  Vali Loss: 0.0640039 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830383  Vali macro F1 0.9732918 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9668670  Test weighted F1: 0.9666284  Test macro F1 0.9577190 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014993 0.00018664 0.00140056 0.0014556  0.0005277  0.00064226]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.8171186447143555
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.2218840  Vali Loss: 0.7308326 Vali Accuracy: 0.6993603  Vali weighted F1: 0.5943341  Vali macro F1 0.2847885 
Validation loss decreased (inf --> 0.730833).  Saving model ...
Epoch: 2 cost time: 5.784664869308472
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.6616081  Vali Loss: 0.5743331 Vali Accuracy: 0.7873134  Vali weighted F1: 0.7439591  Vali macro F1 0.5227568 
new best score!!!!
Validation loss decreased (0.730833 --> 0.574333).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.785245418548584
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.5091540  Vali Loss: 0.4331209 Vali Accuracy: 0.8283582  Vali weighted F1: 0.8047353  Vali macro F1 0.6075323 
new best score!!!!
Validation loss decreased (0.574333 --> 0.433121).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.8014912605285645
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.3893469  Vali Loss: 0.3483384 Vali Accuracy: 0.8901919  Vali weighted F1: 0.8847757  Vali macro F1 0.8360884 
new best score!!!!
Validation loss decreased (0.433121 --> 0.348338).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.817092657089233
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.3068311  Vali Loss: 0.2422888 Vali Accuracy: 0.9200426  Vali weighted F1: 0.9156054  Vali macro F1 0.8852949 
new best score!!!!
Validation loss decreased (0.348338 --> 0.242289).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.812264442443848
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.2453970  Vali Loss: 0.2010309 Vali Accuracy: 0.9323028  Vali weighted F1: 0.9294901  Vali macro F1 0.9095083 
new best score!!!!
Validation loss decreased (0.242289 --> 0.201031).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.8210129737854
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.2086354  Vali Loss: 0.1850170 Vali Accuracy: 0.9392324  Vali weighted F1: 0.9368999  Vali macro F1 0.9192662 
new best score!!!!
Validation loss decreased (0.201031 --> 0.185017).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.79459810256958
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1911562  Vali Loss: 0.1595502 Vali Accuracy: 0.9424307  Vali weighted F1: 0.9416326  Vali macro F1 0.9216127 
new best score!!!!
Validation loss decreased (0.185017 --> 0.159550).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.798937082290649
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1753274  Vali Loss: 0.1517435 Vali Accuracy: 0.9456290  Vali weighted F1: 0.9451264  Vali macro F1 0.9273314 
new best score!!!!
Validation loss decreased (0.159550 --> 0.151743).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.806511878967285
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1544245  Vali Loss: 0.1376042 Vali Accuracy: 0.9520256  Vali weighted F1: 0.9520897  Vali macro F1 0.9345925 
new best score!!!!
Validation loss decreased (0.151743 --> 0.137604).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.816279411315918
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1475959  Vali Loss: 0.1299463 Vali Accuracy: 0.9541578  Vali weighted F1: 0.9541502  Vali macro F1 0.9394425 
new best score!!!!
Validation loss decreased (0.137604 --> 0.129946).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.805689811706543
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1385467  Vali Loss: 0.1251025 Vali Accuracy: 0.9541578  Vali weighted F1: 0.9539763  Vali macro F1 0.9409428 
new best score!!!!
Validation loss decreased (0.129946 --> 0.125102).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.804548501968384
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1288183  Vali Loss: 0.1091741 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9568785  Vali macro F1 0.9445989 
new best score!!!!
Validation loss decreased (0.125102 --> 0.109174).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.800146818161011
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1349267  Vali Loss: 0.1369928 Vali Accuracy: 0.9520256  Vali weighted F1: 0.9508913  Vali macro F1 0.9399012 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.816937208175659
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1189897  Vali Loss: 0.1223794 Vali Accuracy: 0.9541578  Vali weighted F1: 0.9536437  Vali macro F1 0.9387148 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.823271036148071
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1119610  Vali Loss: 0.1006504 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9585428  Vali macro F1 0.9456046 
new best score!!!!
Validation loss decreased (0.109174 --> 0.100650).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.805406093597412
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1039721  Vali Loss: 0.1073640 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9611845  Vali macro F1 0.9479077 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.801907062530518
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1137679  Vali Loss: 0.1080577 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9584280  Vali macro F1 0.9479999 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.8056299686431885
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0974366  Vali Loss: 0.0927664 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9674026  Vali macro F1 0.9582033 
new best score!!!!
Validation loss decreased (0.100650 --> 0.092766).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.811844348907471
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0871170  Vali Loss: 0.0995986 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9644801  Vali macro F1 0.9517614 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.803065299987793
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0917393  Vali Loss: 0.0914235 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9678756  Vali macro F1 0.9589637 
new best score!!!!
Validation loss decreased (0.092766 --> 0.091424).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.809025764465332
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0784405  Vali Loss: 0.1015950 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9648639  Vali macro F1 0.9533212 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.814587593078613
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0800055  Vali Loss: 0.0807959 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9722858  Vali macro F1 0.9639746 
new best score!!!!
Validation loss decreased (0.091424 --> 0.080796).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.837625503540039
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0746686  Vali Loss: 0.0835993 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9714484  Vali macro F1 0.9620823 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.823408126831055
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0688553  Vali Loss: 0.0803809 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9729498  Vali macro F1 0.9638113 
new best score!!!!
Validation loss decreased (0.080796 --> 0.080381).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.8210906982421875
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0668602  Vali Loss: 0.0816705 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9749970  Vali macro F1 0.9659090 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.8085777759552
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0659000  Vali Loss: 0.0855291 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9739075  Vali macro F1 0.9658127 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.808788537979126
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0605839  Vali Loss: 0.0747593 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9711036  Vali macro F1 0.9611232 
new best score!!!!
Validation loss decreased (0.080381 --> 0.074759).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.810274124145508
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0629542  Vali Loss: 0.0704999 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9744997  Vali macro F1 0.9664668 
new best score!!!!
Validation loss decreased (0.074759 --> 0.070500).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.816123008728027
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0584985  Vali Loss: 0.0712589 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9770928  Vali macro F1 0.9692278 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.823618412017822
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0546181  Vali Loss: 0.0759882 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9772403  Vali macro F1 0.9712551 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.812514305114746
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0495790  Vali Loss: 0.0788750 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9749905  Vali macro F1 0.9677361 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.826691627502441
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0483195  Vali Loss: 0.0665576 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777074  Vali macro F1 0.9688206 
new best score!!!!
Validation loss decreased (0.070500 --> 0.066558).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.837716102600098
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0608435  Vali Loss: 0.0790593 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9722132  Vali macro F1 0.9639277 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.816286087036133
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0498577  Vali Loss: 0.0655296 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788286  Vali macro F1 0.9729405 
new best score!!!!
Validation loss decreased (0.066558 --> 0.065530).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.8138158321380615
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0461717  Vali Loss: 0.0946938 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9726446  Vali macro F1 0.9641448 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.817111492156982
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0438216  Vali Loss: 0.0656186 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807622  Vali macro F1 0.9749516 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.821534872055054
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0383866  Vali Loss: 0.0562572 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814353  Vali macro F1 0.9751219 
new best score!!!!
Validation loss decreased (0.065530 --> 0.056257).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.8133368492126465
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0388509  Vali Loss: 0.0532325 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824861  Vali macro F1 0.9778718 
new best score!!!!
Validation loss decreased (0.056257 --> 0.053232).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.811681509017944
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0444555  Vali Loss: 0.0659461 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786965  Vali macro F1 0.9732621 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.809743881225586
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0369006  Vali Loss: 0.0667983 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9772311  Vali macro F1 0.9685752 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.813356876373291
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0337212  Vali Loss: 0.0609200 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819448  Vali macro F1 0.9761298 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.816422939300537
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0408048  Vali Loss: 0.0606279 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9804156  Vali macro F1 0.9747779 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.800099611282349
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0323343  Vali Loss: 0.0619786 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813567  Vali macro F1 0.9755471 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 45 cost time: 5.815706253051758
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0247529  Vali Loss: 0.0535772 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824360  Vali macro F1 0.9770816 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.813344717025757
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0229345  Vali Loss: 0.0527187 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813929  Vali macro F1 0.9750936 
new best score!!!!
Validation loss decreased (0.053232 --> 0.052719).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.811723709106445
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0215812  Vali Loss: 0.0549040 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819196  Vali macro F1 0.9765950 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.810443878173828
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0216894  Vali Loss: 0.0545186 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840461  Vali macro F1 0.9778817 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 5.81395411491394
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0207366  Vali Loss: 0.0508069 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835267  Vali macro F1 0.9783634 
new best score!!!!
Validation loss decreased (0.052719 --> 0.050807).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 5.806492567062378
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0225913  Vali Loss: 0.0518763 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851235  Vali macro F1 0.9797269 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.81809139251709
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0219218  Vali Loss: 0.0527884 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845803  Vali macro F1 0.9797132 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 5.831446170806885
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0207586  Vali Loss: 0.0526286 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840761  Vali macro F1 0.9779116 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 5.815825462341309
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0199705  Vali Loss: 0.0530340 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851044  Vali macro F1 0.9796193 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 5.815170526504517
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0191769  Vali Loss: 0.0528124 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840761  Vali macro F1 0.9779116 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 55 cost time: 5.812859773635864
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0194122  Vali Loss: 0.0524812 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 5.804983854293823
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0194256  Vali Loss: 0.0527670 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 5.807084083557129
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0199173  Vali Loss: 0.0525887 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 5.807226657867432
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0189519  Vali Loss: 0.0528865 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840510  Vali macro F1 0.9788438 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 5.820145606994629
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0191162  Vali Loss: 0.0527176 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 60 cost time: 5.8313915729522705
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0189963  Vali Loss: 0.0527270 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 5.821981430053711
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0195554  Vali Loss: 0.0527421 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 5.810455799102783
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0191611  Vali Loss: 0.0527856 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 5.81766152381897
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0186520  Vali Loss: 0.0528042 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 5.810915470123291
VALI: Epoch: 64, Steps: 66 | Train Loss: 0.0196662  Vali Loss: 0.0528461 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840697  Vali macro F1 0.9785238 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8936579  Test weighted F1: 0.8997583  Test macro F1 0.8722649 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.8146233558654785
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0228795  Vali Loss: 0.0540543 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840399  Vali macro F1 0.9795585 
Validation loss decreased (inf --> 0.054054).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.805338144302368
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0212462  Vali Loss: 0.0522822 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845654  Vali macro F1 0.9794483 
new best score!!!!
Validation loss decreased (0.054054 --> 0.052282).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.782943487167358
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0213336  Vali Loss: 0.0523767 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845752  Vali macro F1 0.9787501 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.824049472808838
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0201161  Vali Loss: 0.0545085 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850961  Vali macro F1 0.9803315 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.8321754932403564
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0204797  Vali Loss: 0.0536588 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829953  Vali macro F1 0.9765058 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 5.827597141265869
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0202457  Vali Loss: 0.0544536 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819013  Vali macro F1 0.9769018 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 5.832141160964966
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0187672  Vali Loss: 0.0537189 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9830060  Vali macro F1 0.9762360 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 5.847142457962036
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0193349  Vali Loss: 0.0543249 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835426  Vali macro F1 0.9772247 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 5.8513360023498535
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0187303  Vali Loss: 0.0557819 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9846025  Vali macro F1 0.9787772 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 5.8272833824157715
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0177470  Vali Loss: 0.0573557 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835072  Vali macro F1 0.9771036 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 5.832705736160278
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0185233  Vali Loss: 0.0576163 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819100  Vali macro F1 0.9749941 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 5.834028005599976
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0188115  Vali Loss: 0.0560555 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840246  Vali macro F1 0.9781848 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 5.839655876159668
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0162174  Vali Loss: 0.0551799 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845858  Vali macro F1 0.9784948 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 5.830530405044556
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0174806  Vali Loss: 0.0550016 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845858  Vali macro F1 0.9784948 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 5.850249290466309
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0166833  Vali Loss: 0.0547707 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845858  Vali macro F1 0.9784948 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 5.8406922817230225
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0183248  Vali Loss: 0.0546957 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845858  Vali macro F1 0.9784948 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 5.852097272872925
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0170541  Vali Loss: 0.0542728 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845858  Vali macro F1 0.9784948 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8922486  Test weighted F1: 0.8986421  Test macro F1 0.8715439 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001428  0.00018382 0.00096525 0.00125628 0.00053135 0.00063412]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.150914907455444
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1801861  Vali Loss: 0.7260116 Vali Accuracy: 0.7047184  Vali weighted F1: 0.6192299  Vali macro F1 0.3272672 
Validation loss decreased (inf --> 0.726012).  Saving model ...
Epoch: 2 cost time: 6.124723434448242
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6256273  Vali Loss: 0.4986434 Vali Accuracy: 0.8330797  Vali weighted F1: 0.8180125  Vali macro F1 0.7562441 
new best score!!!!
Validation loss decreased (0.726012 --> 0.498643).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.147157669067383
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4318550  Vali Loss: 0.3567222 Vali Accuracy: 0.8762050  Vali weighted F1: 0.8667448  Vali macro F1 0.8210637 
new best score!!!!
Validation loss decreased (0.498643 --> 0.356722).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.128152847290039
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3086287  Vali Loss: 0.2586049 Vali Accuracy: 0.9137494  Vali weighted F1: 0.9136080  Vali macro F1 0.8722196 
new best score!!!!
Validation loss decreased (0.356722 --> 0.258605).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.147114515304565
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2415901  Vali Loss: 0.2277101 Vali Accuracy: 0.9198376  Vali weighted F1: 0.9209746  Vali macro F1 0.8899889 
new best score!!!!
Validation loss decreased (0.258605 --> 0.227710).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.132240056991577
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2134805  Vali Loss: 0.2023387 Vali Accuracy: 0.9320142  Vali weighted F1: 0.9324316  Vali macro F1 0.9034778 
new best score!!!!
Validation loss decreased (0.227710 --> 0.202339).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.121685981750488
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1873139  Vali Loss: 0.1829936 Vali Accuracy: 0.9340436  Vali weighted F1: 0.9332301  Vali macro F1 0.9041971 
new best score!!!!
Validation loss decreased (0.202339 --> 0.182994).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.1107447147369385
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1792957  Vali Loss: 0.1777476 Vali Accuracy: 0.9391172  Vali weighted F1: 0.9402053  Vali macro F1 0.9140106 
new best score!!!!
Validation loss decreased (0.182994 --> 0.177748).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.111480951309204
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1780384  Vali Loss: 0.1793637 Vali Accuracy: 0.9345510  Vali weighted F1: 0.9326103  Vali macro F1 0.9016150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.107795238494873
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1568355  Vali Loss: 0.1505502 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9475401  Vali macro F1 0.9228822 
new best score!!!!
Validation loss decreased (0.177748 --> 0.150550).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.166860580444336
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1426138  Vali Loss: 0.1430304 Vali Accuracy: 0.9502790  Vali weighted F1: 0.9500164  Vali macro F1 0.9268379 
new best score!!!!
Validation loss decreased (0.150550 --> 0.143030).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.189926624298096
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1447147  Vali Loss: 0.1287144 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9585296  Vali macro F1 0.9385518 
new best score!!!!
Validation loss decreased (0.143030 --> 0.128714).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.1605119705200195
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1287443  Vali Loss: 0.1381911 Vali Accuracy: 0.9518011  Vali weighted F1: 0.9514085  Vali macro F1 0.9270464 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.103437900543213
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1244648  Vali Loss: 0.1512315 Vali Accuracy: 0.9462202  Vali weighted F1: 0.9455477  Vali macro F1 0.9168247 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.091028213500977
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1186505  Vali Loss: 0.1175588 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9604471  Vali macro F1 0.9413901 
new best score!!!!
Validation loss decreased (0.128714 --> 0.117559).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.08840799331665
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1035611  Vali Loss: 0.1129855 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9641257  Vali macro F1 0.9510885 
new best score!!!!
Validation loss decreased (0.117559 --> 0.112985).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.101897954940796
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1062652  Vali Loss: 0.1064274 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9637330  Vali macro F1 0.9505353 
new best score!!!!
Validation loss decreased (0.112985 --> 0.106427).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.102467775344849
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0955703  Vali Loss: 0.0935235 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9677955  Vali macro F1 0.9549667 
new best score!!!!
Validation loss decreased (0.106427 --> 0.093523).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.146559953689575
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0919049  Vali Loss: 0.1115350 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9654497  Vali macro F1 0.9536129 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.137872219085693
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0984180  Vali Loss: 0.1267411 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9547160  Vali macro F1 0.9370183 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.106576919555664
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0850706  Vali Loss: 0.0906396 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9690385  Vali macro F1 0.9567327 
new best score!!!!
Validation loss decreased (0.093523 --> 0.090640).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.102267742156982
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0729080  Vali Loss: 0.0900027 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9673003  Vali macro F1 0.9549600 
new best score!!!!
Validation loss decreased (0.090640 --> 0.090003).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.109148979187012
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0856858  Vali Loss: 0.0800632 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9721450  Vali macro F1 0.9595220 
new best score!!!!
Validation loss decreased (0.090003 --> 0.080063).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.10588264465332
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0708080  Vali Loss: 0.0875024 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9716019  Vali macro F1 0.9601472 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.115984916687012
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0654285  Vali Loss: 0.1035309 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9660244  Vali macro F1 0.9535950 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.12071967124939
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0704248  Vali Loss: 0.0769177 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9709674  Vali macro F1 0.9606964 
new best score!!!!
Validation loss decreased (0.080063 --> 0.076918).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.182672023773193
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0613062  Vali Loss: 0.0804602 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9740463  Vali macro F1 0.9625018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.190269708633423
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0606685  Vali Loss: 0.0776820 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9724961  Vali macro F1 0.9617774 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.186166286468506
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0556297  Vali Loss: 0.0791418 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9741799  Vali macro F1 0.9629744 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.100678443908691
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0527252  Vali Loss: 0.0768894 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9735212  Vali macro F1 0.9621843 
new best score!!!!
Validation loss decreased (0.076918 --> 0.076889).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.110981464385986
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0581166  Vali Loss: 0.1071219 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9660154  Vali macro F1 0.9553759 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.105493783950806
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0532231  Vali Loss: 0.0652221 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9765399  Vali macro F1 0.9677058 
new best score!!!!
Validation loss decreased (0.076889 --> 0.065222).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.105637311935425
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0466715  Vali Loss: 0.0756736 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9746025  Vali macro F1 0.9644792 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.153041124343872
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0452110  Vali Loss: 0.0648188 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781344  Vali macro F1 0.9682049 
new best score!!!!
Validation loss decreased (0.065222 --> 0.064819).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.163858652114868
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0469784  Vali Loss: 0.0682720 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772561  Vali macro F1 0.9678858 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.186357259750366
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0464492  Vali Loss: 0.0609562 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791118  Vali macro F1 0.9702259 
new best score!!!!
Validation loss decreased (0.064819 --> 0.060956).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.179232597351074
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0409399  Vali Loss: 0.0634886 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801755  Vali macro F1 0.9729717 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.1957151889801025
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0390507  Vali Loss: 0.0610365 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9783093  Vali macro F1 0.9684722 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.116445779800415
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0410470  Vali Loss: 0.0681982 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780772  Vali macro F1 0.9694916 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.1179587841033936
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0304725  Vali Loss: 0.0552460 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842967  Vali macro F1 0.9783744 
new best score!!!!
Validation loss decreased (0.060956 --> 0.055246).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.118388652801514
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0332593  Vali Loss: 0.0621814 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9773247  Vali macro F1 0.9691167 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.120107889175415
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0358749  Vali Loss: 0.0523000 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832412  Vali macro F1 0.9778075 
new best score!!!!
Validation loss decreased (0.055246 --> 0.052300).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.121119976043701
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0404404  Vali Loss: 0.0676876 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776939  Vali macro F1 0.9691910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.137970924377441
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0320953  Vali Loss: 0.0615066 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9767555  Vali macro F1 0.9671598 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.1272947788238525
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0416178  Vali Loss: 0.0647016 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781813  Vali macro F1 0.9716825 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.115846633911133
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0318410  Vali Loss: 0.0586855 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798192  Vali macro F1 0.9713192 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.110906600952148
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0284023  Vali Loss: 0.0599688 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807915  Vali macro F1 0.9723592 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 48 cost time: 6.0948100090026855
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0220871  Vali Loss: 0.0560153 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797238  Vali macro F1 0.9714687 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.087049245834351
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0189715  Vali Loss: 0.0530836 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822512  Vali macro F1 0.9749970 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.094465017318726
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0180428  Vali Loss: 0.0538491 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812520  Vali macro F1 0.9727032 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.094502210617065
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0165771  Vali Loss: 0.0541696 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807579  Vali macro F1 0.9719241 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.175283432006836
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0179031  Vali Loss: 0.0539538 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802062  Vali macro F1 0.9715716 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.169576644897461
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0160335  Vali Loss: 0.0527328 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807295  Vali macro F1 0.9721383 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.202610015869141
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0166428  Vali Loss: 0.0531903 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802062  Vali macro F1 0.9715716 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.15933895111084
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0168564  Vali Loss: 0.0536051 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802062  Vali macro F1 0.9715716 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.125074863433838
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0157082  Vali Loss: 0.0523804 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812520  Vali macro F1 0.9727032 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.109253168106079
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0161390  Vali Loss: 0.0523577 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812520  Vali macro F1 0.9727032 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9280199  Test weighted F1: 0.9266333  Test macro F1 0.9158355 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.110468149185181
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0249506  Vali Loss: 0.0541011 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817792  Vali macro F1 0.9741970 
Validation loss decreased (inf --> 0.054101).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.150275707244873
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0226841  Vali Loss: 0.0573062 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811899  Vali macro F1 0.9735387 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.185247182846069
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0221924  Vali Loss: 0.0573135 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801257  Vali macro F1 0.9726262 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.178625106811523
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0216657  Vali Loss: 0.0560405 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822388  Vali macro F1 0.9758137 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.175750970840454
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0213212  Vali Loss: 0.0543276 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823068  Vali macro F1 0.9745539 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.122676134109497
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0212014  Vali Loss: 0.0545480 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9818053  Vali macro F1 0.9720991 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.105226993560791
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0196691  Vali Loss: 0.0583180 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796146  Vali macro F1 0.9718027 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.1177918910980225
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0190671  Vali Loss: 0.0537566 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827791  Vali macro F1 0.9748470 
new best score!!!!
Validation loss decreased (0.054101 --> 0.053757).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.118232727050781
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0194542  Vali Loss: 0.0509073 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843131  Vali macro F1 0.9781423 
new best score!!!!
Validation loss decreased (0.053757 --> 0.050907).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.166610956192017
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0187824  Vali Loss: 0.0516623 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817291  Vali macro F1 0.9734559 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.179213285446167
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0183755  Vali Loss: 0.0519318 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843421  Vali macro F1 0.9790442 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.112645626068115
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0180295  Vali Loss: 0.0521304 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843337  Vali macro F1 0.9785789 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.167966365814209
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0183274  Vali Loss: 0.0571831 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801436  Vali macro F1 0.9723347 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.183670520782471
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0178902  Vali Loss: 0.0504297 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838056  Vali macro F1 0.9775969 
new best score!!!!
Validation loss decreased (0.050907 --> 0.050430).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.1538872718811035
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0180036  Vali Loss: 0.0520762 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833071  Vali macro F1 0.9762323 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.128127098083496
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0176861  Vali Loss: 0.0505225 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842766  Vali macro F1 0.9786416 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.088955402374268
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0174049  Vali Loss: 0.0526030 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853150  Vali macro F1 0.9782107 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.127351522445679
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0180169  Vali Loss: 0.0538921 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817169  Vali macro F1 0.9742172 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.118056535720825
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0159581  Vali Loss: 0.0508807 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843473  Vali macro F1 0.9779034 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.1117987632751465
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0154646  Vali Loss: 0.0516691 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838296  Vali macro F1 0.9773895 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.137230157852173
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0151195  Vali Loss: 0.0512407 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843180  Vali macro F1 0.9779513 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.132410287857056
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0152988  Vali Loss: 0.0510336 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843180  Vali macro F1 0.9779513 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.122079372406006
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0157978  Vali Loss: 0.0518690 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832808  Vali macro F1 0.9768348 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.11500358581543
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0158486  Vali Loss: 0.0519805 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832808  Vali macro F1 0.9768348 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 6.1055684089660645
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0154034  Vali Loss: 0.0519024 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832808  Vali macro F1 0.9768348 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.101946115493774
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0165397  Vali Loss: 0.0518084 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832808  Vali macro F1 0.9768348 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.11274528503418
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0148125  Vali Loss: 0.0516816 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832808  Vali macro F1 0.9768348 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.107825994491577
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0153467  Vali Loss: 0.0515224 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832808  Vali macro F1 0.9768348 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.140411138534546
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0151942  Vali Loss: 0.0515786 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832808  Vali macro F1 0.9768348 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9350064  Test weighted F1: 0.9336988  Test macro F1 0.9315025 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014223 0.00017892 0.00098039 0.00120192 0.00047619 0.00059916]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.297168493270874
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.1931020  Vali Loss: 0.7359238 Vali Accuracy: 0.6956093  Vali weighted F1: 0.6105099  Vali macro F1 0.3278229 
Validation loss decreased (inf --> 0.735924).  Saving model ...
Epoch: 2 cost time: 6.260515451431274
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.6529808  Vali Loss: 0.5254222 Vali Accuracy: 0.8149975  Vali weighted F1: 0.7847652  Vali macro F1 0.6578269 
new best score!!!!
Validation loss decreased (0.735924 --> 0.525422).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.265584468841553
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.4451938  Vali Loss: 0.3320540 Vali Accuracy: 0.8880118  Vali weighted F1: 0.8809292  Vali macro F1 0.8494022 
new best score!!!!
Validation loss decreased (0.525422 --> 0.332054).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.264770030975342
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.3151998  Vali Loss: 0.2644278 Vali Accuracy: 0.9057721  Vali weighted F1: 0.8993125  Vali macro F1 0.8685611 
new best score!!!!
Validation loss decreased (0.332054 --> 0.264428).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.274329900741577
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2363860  Vali Loss: 0.1885890 Vali Accuracy: 0.9368525  Vali weighted F1: 0.9377850  Vali macro F1 0.9181713 
new best score!!!!
Validation loss decreased (0.264428 --> 0.188589).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.275479316711426
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.2112815  Vali Loss: 0.1790029 Vali Accuracy: 0.9417859  Vali weighted F1: 0.9421493  Vali macro F1 0.9241392 
new best score!!!!
Validation loss decreased (0.188589 --> 0.179003).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.269126653671265
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1808321  Vali Loss: 0.1737816 Vali Accuracy: 0.9437593  Vali weighted F1: 0.9436965  Vali macro F1 0.9229719 
new best score!!!!
Validation loss decreased (0.179003 --> 0.173782).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.285660743713379
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1687503  Vali Loss: 0.1240142 Vali Accuracy: 0.9595461  Vali weighted F1: 0.9594847  Vali macro F1 0.9467521 
new best score!!!!
Validation loss decreased (0.173782 --> 0.124014).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.328125953674316
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1458408  Vali Loss: 0.1496927 Vali Accuracy: 0.9472126  Vali weighted F1: 0.9474910  Vali macro F1 0.9324701 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.286520481109619
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1470388  Vali Loss: 0.1154986 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9623944  Vali macro F1 0.9529110 
new best score!!!!
Validation loss decreased (0.124014 --> 0.115499).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.288148880004883
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1370976  Vali Loss: 0.1062627 Vali Accuracy: 0.9659595  Vali weighted F1: 0.9657797  Vali macro F1 0.9565074 
new best score!!!!
Validation loss decreased (0.115499 --> 0.106263).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.278764247894287
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1238547  Vali Loss: 0.1076742 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9671446  Vali macro F1 0.9575363 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.2742204666137695
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1208243  Vali Loss: 0.1316670 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9593418  Vali macro F1 0.9493346 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.282994747161865
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1162778  Vali Loss: 0.1007933 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9683358  Vali macro F1 0.9594978 
new best score!!!!
Validation loss decreased (0.106263 --> 0.100793).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.287698745727539
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1059945  Vali Loss: 0.0965696 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9725525  Vali macro F1 0.9657165 
new best score!!!!
Validation loss decreased (0.100793 --> 0.096570).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.293848037719727
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.1072748  Vali Loss: 0.1070164 Vali Accuracy: 0.9659595  Vali weighted F1: 0.9664722  Vali macro F1 0.9580632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.299008131027222
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.1061382  Vali Loss: 0.1192032 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9646773  Vali macro F1 0.9555557 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.2781291007995605
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0998555  Vali Loss: 0.1051227 Vali Accuracy: 0.9639862  Vali weighted F1: 0.9644993  Vali macro F1 0.9539492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 6.277955770492554
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0948520  Vali Loss: 0.1013370 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9701690  Vali macro F1 0.9607660 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 6.286892890930176
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0894200  Vali Loss: 0.0826771 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9732556  Vali macro F1 0.9644585 
new best score!!!!
Validation loss decreased (0.096570 --> 0.082677).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.280986785888672
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0826865  Vali Loss: 0.1368619 Vali Accuracy: 0.9511593  Vali weighted F1: 0.9527100  Vali macro F1 0.9439713 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.278776407241821
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0825462  Vali Loss: 0.0757362 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9764237  Vali macro F1 0.9683869 
new best score!!!!
Validation loss decreased (0.082677 --> 0.075736).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.278334617614746
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0756556  Vali Loss: 0.0744061 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9750630  Vali macro F1 0.9672137 
new best score!!!!
Validation loss decreased (0.075736 --> 0.074406).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.283966541290283
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0742086  Vali Loss: 0.0791670 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9737167  Vali macro F1 0.9663655 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.296446323394775
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0750570  Vali Loss: 0.0794493 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9760153  Vali macro F1 0.9681600 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.297750949859619
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0698747  Vali Loss: 0.0652350 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9794202  Vali macro F1 0.9732579 
new best score!!!!
Validation loss decreased (0.074406 --> 0.065235).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.2716920375823975
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0632516  Vali Loss: 0.0727076 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9765833  Vali macro F1 0.9681804 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.273698091506958
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0639382  Vali Loss: 0.0778577 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9733172  Vali macro F1 0.9656564 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.266517162322998
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0673989  Vali Loss: 0.0667452 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807490  Vali macro F1 0.9751672 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.271408557891846
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0651004  Vali Loss: 0.0730163 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9790230  Vali macro F1 0.9720231 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.270250082015991
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0526356  Vali Loss: 0.0719655 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9779748  Vali macro F1 0.9724632 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.266242980957031
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0448486  Vali Loss: 0.0645400 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9794684  Vali macro F1 0.9740763 
new best score!!!!
Validation loss decreased (0.065235 --> 0.064540).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.288138389587402
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0437931  Vali Loss: 0.0607359 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808633  Vali macro F1 0.9754446 
new best score!!!!
Validation loss decreased (0.064540 --> 0.060736).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.286959648132324
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0422594  Vali Loss: 0.0630806 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808384  Vali macro F1 0.9753889 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.279143810272217
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0452950  Vali Loss: 0.0603060 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813369  Vali macro F1 0.9760123 
new best score!!!!
Validation loss decreased (0.060736 --> 0.060306).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.2709550857543945
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0419307  Vali Loss: 0.0604839 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808939  Vali macro F1 0.9758896 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.268614053726196
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0423689  Vali Loss: 0.0598293 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798796  Vali macro F1 0.9740428 
new best score!!!!
Validation loss decreased (0.060306 --> 0.059829).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.273671388626099
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0420339  Vali Loss: 0.0599310 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9804037  Vali macro F1 0.9743190 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.268844842910767
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0396588  Vali Loss: 0.0619717 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9809189  Vali macro F1 0.9758928 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.273491621017456
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0416249  Vali Loss: 0.0631668 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808521  Vali macro F1 0.9753166 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.286798000335693
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0408299  Vali Loss: 0.0598942 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803490  Vali macro F1 0.9745631 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.299725770950317
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0391782  Vali Loss: 0.0604028 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803878  Vali macro F1 0.9745600 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 6.273283243179321
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0385573  Vali Loss: 0.0596705 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818546  Vali macro F1 0.9764385 
new best score!!!!
Validation loss decreased (0.059829 --> 0.059671).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.2702953815460205
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0372365  Vali Loss: 0.0598378 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.269468069076538
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0379699  Vali Loss: 0.0597951 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813818  Vali macro F1 0.9758982 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.265514373779297
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0385798  Vali Loss: 0.0598816 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9804121  Vali macro F1 0.9742368 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.269900321960449
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0368860  Vali Loss: 0.0599203 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.2685887813568115
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0378739  Vali Loss: 0.0597537 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.2741310596466064
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0390154  Vali Loss: 0.0597789 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.283353090286255
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0364848  Vali Loss: 0.0597720 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.258891582489014
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0374761  Vali Loss: 0.0597502 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.258239507675171
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0390966  Vali Loss: 0.0597394 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.262306213378906
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0366457  Vali Loss: 0.0597223 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 54 cost time: 6.256445407867432
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0386275  Vali Loss: 0.0597204 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.26780104637146
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0383834  Vali Loss: 0.0597164 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.277298927307129
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0372838  Vali Loss: 0.0597116 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.278199195861816
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0388938  Vali Loss: 0.0597129 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.291329383850098
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0381502  Vali Loss: 0.0597144 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8802878  Test weighted F1: 0.8707354  Test macro F1 0.6591329 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.317266941070557
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0396622  Vali Loss: 0.0605411 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818425  Vali macro F1 0.9763493 
Validation loss decreased (inf --> 0.060541).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.274533033370972
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0414637  Vali Loss: 0.0630572 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818814  Vali macro F1 0.9765246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.278164386749268
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0403436  Vali Loss: 0.0616485 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9799626  Vali macro F1 0.9741990 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.271478176116943
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0392940  Vali Loss: 0.0608400 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808750  Vali macro F1 0.9750972 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.289403676986694
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0373192  Vali Loss: 0.0595663 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808970  Vali macro F1 0.9750672 
new best score!!!!
Validation loss decreased (0.060541 --> 0.059566).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.280672311782837
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0389832  Vali Loss: 0.0601062 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818847  Vali macro F1 0.9765429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.288527488708496
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0374151  Vali Loss: 0.0591332 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808746  Vali macro F1 0.9751800 
new best score!!!!
Validation loss decreased (0.059566 --> 0.059133).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.293306827545166
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0362882  Vali Loss: 0.0598786 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9809111  Vali macro F1 0.9744971 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.283567667007446
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0380574  Vali Loss: 0.0589557 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822974  Vali macro F1 0.9769304 
new best score!!!!
Validation loss decreased (0.059133 --> 0.058956).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.274440288543701
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0363496  Vali Loss: 0.0574763 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808757  Vali macro F1 0.9751952 
new best score!!!!
Validation loss decreased (0.058956 --> 0.057476).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.429194450378418
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0364739  Vali Loss: 0.0577775 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818575  Vali macro F1 0.9762432 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.275841236114502
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0345982  Vali Loss: 0.0577598 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837975  Vali macro F1 0.9788669 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.275994062423706
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0360313  Vali Loss: 0.0588975 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832634  Vali macro F1 0.9779767 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.37675929069519
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0347729  Vali Loss: 0.0596523 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818812  Vali macro F1 0.9761838 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.2751171588897705
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0339891  Vali Loss: 0.0600879 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9833512  Vali macro F1 0.9777409 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 6.304724216461182
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0369759  Vali Loss: 0.0576204 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9833517  Vali macro F1 0.9777149 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.303234338760376
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0361537  Vali Loss: 0.0594288 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9838534  Vali macro F1 0.9785038 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.275285482406616
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0344393  Vali Loss: 0.0620349 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9823510  Vali macro F1 0.9769947 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.278321743011475
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0339486  Vali Loss: 0.0598254 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9823195  Vali macro F1 0.9763287 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.276614189147949
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0342222  Vali Loss: 0.0595249 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837664  Vali macro F1 0.9783890 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.273274183273315
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0302652  Vali Loss: 0.0585552 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842557  Vali macro F1 0.9786995 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.279234170913696
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0302707  Vali Loss: 0.0584950 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827925  Vali macro F1 0.9769087 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.284560203552246
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0310776  Vali Loss: 0.0585808 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842637  Vali macro F1 0.9793385 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.282898187637329
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0319882  Vali Loss: 0.0580051 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827925  Vali macro F1 0.9769087 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.301339626312256
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0324117  Vali Loss: 0.0585436 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818306  Vali macro F1 0.9763174 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8831410  Test weighted F1: 0.8734048  Test macro F1 0.6617396 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014451 0.00016909 0.00099108 0.00134953 0.00049579 0.00063694]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.251756191253662
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.1607097  Vali Loss: 0.6965992 Vali Accuracy: 0.7082714  Vali weighted F1: 0.6190433  Vali macro F1 0.3212379 
Validation loss decreased (inf --> 0.696599).  Saving model ...
Epoch: 2 cost time: 6.227057218551636
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.6027925  Vali Loss: 0.5133096 Vali Accuracy: 0.7994056  Vali weighted F1: 0.7595115  Vali macro F1 0.5581737 
new best score!!!!
Validation loss decreased (0.696599 --> 0.513310).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.225668907165527
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4101988  Vali Loss: 0.3266179 Vali Accuracy: 0.8816246  Vali weighted F1: 0.8719394  Vali macro F1 0.8326965 
new best score!!!!
Validation loss decreased (0.513310 --> 0.326618).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.235842704772949
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2910752  Vali Loss: 0.2460227 Vali Accuracy: 0.9182764  Vali weighted F1: 0.9180321  Vali macro F1 0.8896979 
new best score!!!!
Validation loss decreased (0.326618 --> 0.246023).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.236402750015259
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2334119  Vali Loss: 0.2203716 Vali Accuracy: 0.9247152  Vali weighted F1: 0.9228179  Vali macro F1 0.8921908 
new best score!!!!
Validation loss decreased (0.246023 --> 0.220372).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.262137413024902
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1942409  Vali Loss: 0.1783977 Vali Accuracy: 0.9395740  Vali weighted F1: 0.9386609  Vali macro F1 0.9161530 
new best score!!!!
Validation loss decreased (0.220372 --> 0.178398).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.265367746353149
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1796467  Vali Loss: 0.1586197 Vali Accuracy: 0.9470035  Vali weighted F1: 0.9466903  Vali macro F1 0.9224645 
new best score!!!!
Validation loss decreased (0.178398 --> 0.158620).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.25555419921875
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1662479  Vali Loss: 0.1577383 Vali Accuracy: 0.9519564  Vali weighted F1: 0.9510067  Vali macro F1 0.9334405 
new best score!!!!
Validation loss decreased (0.158620 --> 0.157738).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.244855165481567
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1522170  Vali Loss: 0.1362422 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9569267  Vali macro F1 0.9428913 
new best score!!!!
Validation loss decreased (0.157738 --> 0.136242).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.220375061035156
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1416014  Vali Loss: 0.1370179 Vali Accuracy: 0.9544329  Vali weighted F1: 0.9541376  Vali macro F1 0.9393788 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.252344131469727
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1369046  Vali Loss: 0.1279899 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9573027  Vali macro F1 0.9405527 
new best score!!!!
Validation loss decreased (0.136242 --> 0.127990).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.250482082366943
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1358912  Vali Loss: 0.1288364 Vali Accuracy: 0.9564141  Vali weighted F1: 0.9558175  Vali macro F1 0.9416802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.250020503997803
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1200618  Vali Loss: 0.1202764 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9634998  Vali macro F1 0.9517483 
new best score!!!!
Validation loss decreased (0.127990 --> 0.120276).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.2391440868377686
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1224212  Vali Loss: 0.1258937 Vali Accuracy: 0.9583952  Vali weighted F1: 0.9573096  Vali macro F1 0.9447553 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.272090911865234
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1092697  Vali Loss: 0.1069460 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9609004  Vali macro F1 0.9488577 
new best score!!!!
Validation loss decreased (0.120276 --> 0.106946).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.267101764678955
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1012313  Vali Loss: 0.1123538 Vali Accuracy: 0.9608717  Vali weighted F1: 0.9603582  Vali macro F1 0.9484063 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.233184337615967
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0993126  Vali Loss: 0.1108211 Vali Accuracy: 0.9638435  Vali weighted F1: 0.9637616  Vali macro F1 0.9481235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.229614019393921
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0980207  Vali Loss: 0.1281612 Vali Accuracy: 0.9554235  Vali weighted F1: 0.9558151  Vali macro F1 0.9429603 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 6.2358479499816895
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0895084  Vali Loss: 0.0962970 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9690766  Vali macro F1 0.9583440 
new best score!!!!
Validation loss decreased (0.106946 --> 0.096297).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.241887807846069
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0813431  Vali Loss: 0.0861769 Vali Accuracy: 0.9727588  Vali weighted F1: 0.9728463  Vali macro F1 0.9626646 
new best score!!!!
Validation loss decreased (0.096297 --> 0.086177).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.240190744400024
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0865899  Vali Loss: 0.0952353 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9715923  Vali macro F1 0.9626977 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.287792682647705
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0809538  Vali Loss: 0.1132453 Vali Accuracy: 0.9608717  Vali weighted F1: 0.9619026  Vali macro F1 0.9503499 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.251166105270386
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0748367  Vali Loss: 0.0825956 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9748808  Vali macro F1 0.9664808 
new best score!!!!
Validation loss decreased (0.086177 --> 0.082596).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.259471654891968
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0689508  Vali Loss: 0.0799486 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9743899  Vali macro F1 0.9658831 
new best score!!!!
Validation loss decreased (0.082596 --> 0.079949).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.248513460159302
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0621930  Vali Loss: 0.0998883 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9701886  Vali macro F1 0.9620991 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.238447666168213
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0658132  Vali Loss: 0.0814626 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9750428  Vali macro F1 0.9678235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.255637168884277
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0543107  Vali Loss: 0.0824192 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9741363  Vali macro F1 0.9666951 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.241363525390625
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0554508  Vali Loss: 0.1054365 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9643885  Vali macro F1 0.9537123 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.2470543384552
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0538026  Vali Loss: 0.0764718 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9770472  Vali macro F1 0.9705101 
new best score!!!!
Validation loss decreased (0.079949 --> 0.076472).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.2413270473480225
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0546620  Vali Loss: 0.0810859 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9744724  Vali macro F1 0.9634062 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.2492780685424805
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0486577  Vali Loss: 0.0753976 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9740454  Vali macro F1 0.9667675 
new best score!!!!
Validation loss decreased (0.076472 --> 0.075398).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.263244867324829
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0505153  Vali Loss: 0.0631884 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9789328  Vali macro F1 0.9717564 
new best score!!!!
Validation loss decreased (0.075398 --> 0.063188).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.237635850906372
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0444167  Vali Loss: 0.0653117 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9813303  Vali macro F1 0.9755481 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.242645263671875
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0428760  Vali Loss: 0.0590978 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792514  Vali macro F1 0.9717275 
new best score!!!!
Validation loss decreased (0.063188 --> 0.059098).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.238648414611816
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0412534  Vali Loss: 0.1048820 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9691925  Vali macro F1 0.9618316 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.242688894271851
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0441689  Vali Loss: 0.0613216 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9804845  Vali macro F1 0.9735100 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.236547946929932
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0392842  Vali Loss: 0.0640173 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9813305  Vali macro F1 0.9757871 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.237475872039795
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0411857  Vali Loss: 0.0820562 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9739115  Vali macro F1 0.9650712 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.235389947891235
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0372568  Vali Loss: 0.0602866 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832697  Vali macro F1 0.9772459 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 6.266069650650024
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0289054  Vali Loss: 0.0595373 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827219  Vali macro F1 0.9772266 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.262877702713013
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0256179  Vali Loss: 0.0581722 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9823183  Vali macro F1 0.9765221 
new best score!!!!
Validation loss decreased (0.059098 --> 0.058172).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.237474679946899
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0242623  Vali Loss: 0.0562785 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837192  Vali macro F1 0.9782938 
new best score!!!!
Validation loss decreased (0.058172 --> 0.056279).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.234148025512695
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0240763  Vali Loss: 0.0582082 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827169  Vali macro F1 0.9772117 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.2420079708099365
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0238918  Vali Loss: 0.0550346 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842457  Vali macro F1 0.9785515 
new best score!!!!
Validation loss decreased (0.056279 --> 0.055035).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.221424579620361
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0237493  Vali Loss: 0.0569463 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832188  Vali macro F1 0.9774258 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.256061315536499
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0226476  Vali Loss: 0.0580177 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832355  Vali macro F1 0.9777582 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.23090124130249
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0219640  Vali Loss: 0.0563958 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842147  Vali macro F1 0.9787875 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.280807018280029
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0229408  Vali Loss: 0.0560132 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837473  Vali macro F1 0.9786280 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.285358667373657
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0234593  Vali Loss: 0.0562423 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842375  Vali macro F1 0.9788563 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.246257543563843
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0207503  Vali Loss: 0.0553216 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9847172  Vali macro F1 0.9793428 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.240511655807495
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0206642  Vali Loss: 0.0566257 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837317  Vali macro F1 0.9782976 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.23689603805542
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0214801  Vali Loss: 0.0563912 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837095  Vali macro F1 0.9782557 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.269855499267578
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0202531  Vali Loss: 0.0563257 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842147  Vali macro F1 0.9787875 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.259981870651245
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0223079  Vali Loss: 0.0562231 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837205  Vali macro F1 0.9779541 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.272881984710693
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0209223  Vali Loss: 0.0562944 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837205  Vali macro F1 0.9779541 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.281910419464111
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0206533  Vali Loss: 0.0561765 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837205  Vali macro F1 0.9779541 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.281053781509399
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0197084  Vali Loss: 0.0562900 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837205  Vali macro F1 0.9779541 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.241195201873779
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0197230  Vali Loss: 0.0563382 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837205  Vali macro F1 0.9779541 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.242305755615234
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0200513  Vali Loss: 0.0564109 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842147  Vali macro F1 0.9787875 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8170414  Test weighted F1: 0.8184623  Test macro F1 0.8439654 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.237306356430054
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0235140  Vali Loss: 0.0586298 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822497  Vali macro F1 0.9766936 
Validation loss decreased (inf --> 0.058630).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.289252281188965
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0239428  Vali Loss: 0.0588071 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832278  Vali macro F1 0.9777392 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.273659944534302
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0235979  Vali Loss: 0.0568915 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827161  Vali macro F1 0.9768955 
new best score!!!!
Validation loss decreased (0.058630 --> 0.056891).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.266831636428833
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0218576  Vali Loss: 0.0595557 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842572  Vali macro F1 0.9794935 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.2863757610321045
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0216196  Vali Loss: 0.0556792 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837095  Vali macro F1 0.9782557 
new best score!!!!
Validation loss decreased (0.056891 --> 0.055679).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.282026290893555
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0215891  Vali Loss: 0.0582713 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832356  Vali macro F1 0.9777764 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.261728763580322
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0195222  Vali Loss: 0.0588453 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832834  Vali macro F1 0.9781720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.255084991455078
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0209181  Vali Loss: 0.0558083 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827510  Vali macro F1 0.9772480 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.257422685623169
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0191242  Vali Loss: 0.0551672 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837229  Vali macro F1 0.9782436 
new best score!!!!
Validation loss decreased (0.055679 --> 0.055167).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.263992547988892
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0193202  Vali Loss: 0.0561043 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842375  Vali macro F1 0.9788563 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.262059926986694
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0191522  Vali Loss: 0.0604143 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827162  Vali macro F1 0.9774791 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.288384675979614
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0189257  Vali Loss: 0.0608022 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9833136  Vali macro F1 0.9782511 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.28934121131897
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0184090  Vali Loss: 0.0555400 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837491  Vali macro F1 0.9783336 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.3039867877960205
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0198704  Vali Loss: 0.0573437 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9847268  Vali macro F1 0.9793810 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 6.289839744567871
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0205570  Vali Loss: 0.0577655 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842896  Vali macro F1 0.9792733 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.294067859649658
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0187442  Vali Loss: 0.0568523 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842483  Vali macro F1 0.9788962 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.348006248474121
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0187542  Vali Loss: 0.0570251 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837309  Vali macro F1 0.9786118 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.356940507888794
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0164310  Vali Loss: 0.0549696 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837183  Vali macro F1 0.9785518 
new best score!!!!
Validation loss decreased (0.055167 --> 0.054970).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.324195146560669
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0176148  Vali Loss: 0.0542697 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832434  Vali macro F1 0.9777750 
new best score!!!!
Validation loss decreased (0.054970 --> 0.054270).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.267398834228516
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0169591  Vali Loss: 0.0572831 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837046  Vali macro F1 0.9782232 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.261689901351929
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0169691  Vali Loss: 0.0623224 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817594  Vali macro F1 0.9764819 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.281740188598633
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0164830  Vali Loss: 0.0578998 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832241  Vali macro F1 0.9777002 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.281425714492798
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0182233  Vali Loss: 0.0612297 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817789  Vali macro F1 0.9762294 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.3223557472229
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0186613  Vali Loss: 0.0566017 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842255  Vali macro F1 0.9794292 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.338080883026123
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0156048  Vali Loss: 0.0551004 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837424  Vali macro F1 0.9783192 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.326650857925415
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0159563  Vali Loss: 0.0551302 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837424  Vali macro F1 0.9783192 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.2730631828308105
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0157285  Vali Loss: 0.0566123 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832649  Vali macro F1 0.9778362 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.254829168319702
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0149082  Vali Loss: 0.0569479 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837603  Vali macro F1 0.9786717 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.2562220096588135
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0162436  Vali Loss: 0.0560778 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837424  Vali macro F1 0.9783192 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 6.276634693145752
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0148549  Vali Loss: 0.0561739 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837424  Vali macro F1 0.9783192 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.267340898513794
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0160417  Vali Loss: 0.0562702 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837424  Vali macro F1 0.9783192 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.327897071838379
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0151989  Vali Loss: 0.0562878 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837424  Vali macro F1 0.9783192 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.314709901809692
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0155655  Vali Loss: 0.0560200 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837424  Vali macro F1 0.9783192 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.32461953163147
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0155597  Vali Loss: 0.0562602 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837424  Vali macro F1 0.9783192 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7968047  Test weighted F1: 0.7995725  Test macro F1 0.8322493 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014601 0.00017819 0.00109529 0.00133156 0.00049603 0.00062735]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.169230222702026
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.1818060  Vali Loss: 0.7614285 Vali Accuracy: 0.6834094  Vali weighted F1: 0.5780076  Vali macro F1 0.2877791 
Validation loss decreased (inf --> 0.761429).  Saving model ...
Epoch: 2 cost time: 6.1948652267456055
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6740237  Vali Loss: 0.5460718 Vali Accuracy: 0.7929985  Vali weighted F1: 0.7498119  Vali macro F1 0.5479201 
new best score!!!!
Validation loss decreased (0.761429 --> 0.546072).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.1948699951171875
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5172646  Vali Loss: 0.4520309 Vali Accuracy: 0.8477930  Vali weighted F1: 0.8247593  Vali macro F1 0.7763201 
new best score!!!!
Validation loss decreased (0.546072 --> 0.452031).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.13095235824585
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3678341  Vali Loss: 0.3129654 Vali Accuracy: 0.8975140  Vali weighted F1: 0.8914376  Vali macro F1 0.8606822 
new best score!!!!
Validation loss decreased (0.452031 --> 0.312965).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.109233379364014
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2818909  Vali Loss: 0.2533846 Vali Accuracy: 0.9157788  Vali weighted F1: 0.9118836  Vali macro F1 0.8891758 
new best score!!!!
Validation loss decreased (0.312965 --> 0.253385).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.111628770828247
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2320825  Vali Loss: 0.1993239 Vali Accuracy: 0.9386098  Vali weighted F1: 0.9366404  Vali macro F1 0.9192552 
new best score!!!!
Validation loss decreased (0.253385 --> 0.199324).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.1203835010528564
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2176867  Vali Loss: 0.1866141 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9403089  Vali macro F1 0.9223899 
new best score!!!!
Validation loss decreased (0.199324 --> 0.186614).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.13477635383606
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2012889  Vali Loss: 0.1782605 Vali Accuracy: 0.9391172  Vali weighted F1: 0.9373660  Vali macro F1 0.9195352 
new best score!!!!
Validation loss decreased (0.186614 --> 0.178260).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.184504270553589
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1814392  Vali Loss: 0.1672155 Vali Accuracy: 0.9452055  Vali weighted F1: 0.9438422  Vali macro F1 0.9287318 
new best score!!!!
Validation loss decreased (0.178260 --> 0.167216).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.166849136352539
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1688261  Vali Loss: 0.1592086 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9491055  Vali macro F1 0.9337454 
new best score!!!!
Validation loss decreased (0.167216 --> 0.159209).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.17043137550354
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1543947  Vali Loss: 0.1815162 Vali Accuracy: 0.9452055  Vali weighted F1: 0.9435710  Vali macro F1 0.9294333 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.140157699584961
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1480488  Vali Loss: 0.1522789 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9490038  Vali macro F1 0.9327124 
new best score!!!!
Validation loss decreased (0.159209 --> 0.152279).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.128091335296631
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1427526  Vali Loss: 0.1277549 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9591581  Vali macro F1 0.9463957 
new best score!!!!
Validation loss decreased (0.152279 --> 0.127755).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.113699674606323
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1242840  Vali Loss: 0.1197595 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9625984  Vali macro F1 0.9499495 
new best score!!!!
Validation loss decreased (0.127755 --> 0.119759).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.1211841106414795
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1216633  Vali Loss: 0.1214370 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9603801  Vali macro F1 0.9478959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.14093542098999
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1161879  Vali Loss: 0.1105739 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9648358  Vali macro F1 0.9535100 
new best score!!!!
Validation loss decreased (0.119759 --> 0.110574).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.1650614738464355
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1087596  Vali Loss: 0.1049504 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9668710  Vali macro F1 0.9570301 
new best score!!!!
Validation loss decreased (0.110574 --> 0.104950).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.180943012237549
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0974965  Vali Loss: 0.1109448 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9595247  Vali macro F1 0.9459351 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.15685248374939
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0962631  Vali Loss: 0.1041509 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9688950  Vali macro F1 0.9592685 
new best score!!!!
Validation loss decreased (0.104950 --> 0.104151).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.121788024902344
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0926050  Vali Loss: 0.1055291 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707503  Vali macro F1 0.9619237 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.1433470249176025
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0772597  Vali Loss: 0.0926402 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9689426  Vali macro F1 0.9566601 
new best score!!!!
Validation loss decreased (0.104151 --> 0.092640).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.1094465255737305
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0785843  Vali Loss: 0.0901398 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9699679  Vali macro F1 0.9586455 
new best score!!!!
Validation loss decreased (0.092640 --> 0.090140).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.120080947875977
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0685375  Vali Loss: 0.0820461 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9758149  Vali macro F1 0.9672358 
new best score!!!!
Validation loss decreased (0.090140 --> 0.082046).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.173810958862305
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0742260  Vali Loss: 0.0836184 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9741586  Vali macro F1 0.9647242 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.166428089141846
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0639938  Vali Loss: 0.0791084 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9761404  Vali macro F1 0.9681267 
new best score!!!!
Validation loss decreased (0.082046 --> 0.079108).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.188817501068115
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0580501  Vali Loss: 0.0753310 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766633  Vali macro F1 0.9693033 
new best score!!!!
Validation loss decreased (0.079108 --> 0.075331).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.1518943309783936
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0565105  Vali Loss: 0.1000709 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9717883  Vali macro F1 0.9666332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.106053352355957
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0633750  Vali Loss: 0.0803099 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9730955  Vali macro F1 0.9565318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.128933668136597
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0547075  Vali Loss: 0.0758323 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792547  Vali macro F1 0.9736013 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.123220205307007
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0553702  Vali Loss: 0.0838932 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9741417  Vali macro F1 0.9648275 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.102731704711914
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0483146  Vali Loss: 0.0793187 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9757601  Vali macro F1 0.9667520 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.150280952453613
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0419335  Vali Loss: 0.0695591 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797782  Vali macro F1 0.9724927 
new best score!!!!
Validation loss decreased (0.075331 --> 0.069559).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.127057075500488
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0367867  Vali Loss: 0.0682613 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797554  Vali macro F1 0.9727215 
new best score!!!!
Validation loss decreased (0.069559 --> 0.068261).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.191009283065796
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0345900  Vali Loss: 0.0657938 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792166  Vali macro F1 0.9721488 
new best score!!!!
Validation loss decreased (0.068261 --> 0.065794).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.139681577682495
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0341640  Vali Loss: 0.0647648 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9803253  Vali macro F1 0.9729842 
new best score!!!!
Validation loss decreased (0.065794 --> 0.064765).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.113022565841675
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0335853  Vali Loss: 0.0647661 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787678  Vali macro F1 0.9705596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.126108646392822
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0342552  Vali Loss: 0.0660016 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802205  Vali macro F1 0.9731496 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.126239061355591
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0339256  Vali Loss: 0.0643618 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792814  Vali macro F1 0.9708830 
new best score!!!!
Validation loss decreased (0.064765 --> 0.064362).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.117574214935303
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0328457  Vali Loss: 0.0682578 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786627  Vali macro F1 0.9705265 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.1268110275268555
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0358727  Vali Loss: 0.0653776 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796964  Vali macro F1 0.9714050 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.148838996887207
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0332074  Vali Loss: 0.0627301 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9793267  Vali macro F1 0.9707117 
new best score!!!!
Validation loss decreased (0.064362 --> 0.062730).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.13957953453064
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0309268  Vali Loss: 0.0649992 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802263  Vali macro F1 0.9729673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.112358093261719
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0315989  Vali Loss: 0.0644500 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9813659  Vali macro F1 0.9733393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.110595941543579
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0315869  Vali Loss: 0.0644569 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9818132  Vali macro F1 0.9737884 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.114172697067261
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0304061  Vali Loss: 0.0662265 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786631  Vali macro F1 0.9703182 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.1270716190338135
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0290674  Vali Loss: 0.0632247 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9808276  Vali macro F1 0.9728003 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.142120361328125
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0306226  Vali Loss: 0.0634169 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797599  Vali macro F1 0.9709858 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.174303293228149
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0300487  Vali Loss: 0.0635885 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797303  Vali macro F1 0.9710450 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.1408350467681885
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0302936  Vali Loss: 0.0634218 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807582  Vali macro F1 0.9723618 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.131785154342651
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0289167  Vali Loss: 0.0630786 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802382  Vali macro F1 0.9717657 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.1675519943237305
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0289531  Vali Loss: 0.0632232 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812778  Vali macro F1 0.9728592 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 6.173003673553467
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0304685  Vali Loss: 0.0632760 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807582  Vali macro F1 0.9723618 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.188246250152588
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0287898  Vali Loss: 0.0632284 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802382  Vali macro F1 0.9717657 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.126050710678101
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0295432  Vali Loss: 0.0632109 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802382  Vali macro F1 0.9717657 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.125746488571167
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0284625  Vali Loss: 0.0631792 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802382  Vali macro F1 0.9717657 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.115572690963745
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0296388  Vali Loss: 0.0632552 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802382  Vali macro F1 0.9717657 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9353087  Test weighted F1: 0.9359430  Test macro F1 0.8945226 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.113313913345337
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0323903  Vali Loss: 0.0611057 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9808705  Vali macro F1 0.9726255 
Validation loss decreased (inf --> 0.061106).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.0980544090271
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0316907  Vali Loss: 0.0628891 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801865  Vali macro F1 0.9734726 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.150139093399048
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0315555  Vali Loss: 0.0631133 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791923  Vali macro F1 0.9718028 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.169039249420166
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0316284  Vali Loss: 0.0661419 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9808052  Vali macro F1 0.9727423 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.1851630210876465
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0319810  Vali Loss: 0.0606476 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802688  Vali macro F1 0.9719799 
new best score!!!!
Validation loss decreased (0.061106 --> 0.060648).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.217411994934082
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0311555  Vali Loss: 0.0612310 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822808  Vali macro F1 0.9746425 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.166286945343018
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0305094  Vali Loss: 0.0630249 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802644  Vali macro F1 0.9725560 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.117771625518799
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0301793  Vali Loss: 0.0664160 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807443  Vali macro F1 0.9731167 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.1019673347473145
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0303573  Vali Loss: 0.0619442 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822850  Vali macro F1 0.9749314 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.117642879486084
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0292203  Vali Loss: 0.0661852 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797176  Vali macro F1 0.9713055 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.113539218902588
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0301267  Vali Loss: 0.0619713 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802190  Vali macro F1 0.9730534 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.117032051086426
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0296914  Vali Loss: 0.0616228 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802248  Vali macro F1 0.9730587 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.162225008010864
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0274199  Vali Loss: 0.0644621 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801989  Vali macro F1 0.9725372 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.206509828567505
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0284910  Vali Loss: 0.0574290 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828512  Vali macro F1 0.9753383 
new best score!!!!
Validation loss decreased (0.060648 --> 0.057429).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.210721492767334
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0284465  Vali Loss: 0.0606084 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807607  Vali macro F1 0.9724525 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.1817991733551025
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0279154  Vali Loss: 0.0631191 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802503  Vali macro F1 0.9715730 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.147183179855347
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0275775  Vali Loss: 0.0615693 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828449  Vali macro F1 0.9754829 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.114101409912109
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0292020  Vali Loss: 0.0601104 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812851  Vali macro F1 0.9730634 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.110281467437744
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0274410  Vali Loss: 0.0619827 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797107  Vali macro F1 0.9715037 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.115094423294067
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0255706  Vali Loss: 0.0606314 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807441  Vali macro F1 0.9726180 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.121265172958374
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0249110  Vali Loss: 0.0602703 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807441  Vali macro F1 0.9726180 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.1088783740997314
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0261960  Vali Loss: 0.0596768 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797661  Vali macro F1 0.9712937 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.132204055786133
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0258973  Vali Loss: 0.0593827 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802862  Vali macro F1 0.9717923 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.124248266220093
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0248715  Vali Loss: 0.0597713 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802534  Vali macro F1 0.9721662 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 6.14659857749939
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0242972  Vali Loss: 0.0598560 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802534  Vali macro F1 0.9721662 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.146007537841797
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0246296  Vali Loss: 0.0599113 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802534  Vali macro F1 0.9721662 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.119603872299194
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0255792  Vali Loss: 0.0599786 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807441  Vali macro F1 0.9726180 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.108433485031128
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0259233  Vali Loss: 0.0599771 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807441  Vali macro F1 0.9726180 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.113426208496094
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0248838  Vali Loss: 0.0599814 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807441  Vali macro F1 0.9726180 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9319039  Test weighted F1: 0.9325783  Test macro F1 0.8888632 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00014029 0.00018169 0.00103093 0.00130208 0.00049358 0.00059809]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.220200538635254
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.1455347  Vali Loss: 0.7472898 Vali Accuracy: 0.6947211  Vali weighted F1: 0.6121568  Vali macro F1 0.3370156 
Validation loss decreased (inf --> 0.747290).  Saving model ...
Epoch: 2 cost time: 6.236001014709473
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5949225  Vali Loss: 0.5124500 Vali Accuracy: 0.7988048  Vali weighted F1: 0.7637606  Vali macro F1 0.5778901 
new best score!!!!
Validation loss decreased (0.747290 --> 0.512450).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.281567573547363
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3930711  Vali Loss: 0.3080563 Vali Accuracy: 0.8999004  Vali weighted F1: 0.8988973  Vali macro F1 0.8739090 
new best score!!!!
Validation loss decreased (0.512450 --> 0.308056).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2816550731658936
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2741323  Vali Loss: 0.2304208 Vali Accuracy: 0.9277888  Vali weighted F1: 0.9255029  Vali macro F1 0.9047533 
new best score!!!!
Validation loss decreased (0.308056 --> 0.230421).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.311897039413452
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2377515  Vali Loss: 0.2256475 Vali Accuracy: 0.9272908  Vali weighted F1: 0.9258913  Vali macro F1 0.9027637 
new best score!!!!
Validation loss decreased (0.230421 --> 0.225647).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.271292209625244
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2183823  Vali Loss: 0.2133901 Vali Accuracy: 0.9282869  Vali weighted F1: 0.9260159  Vali macro F1 0.9075647 
new best score!!!!
Validation loss decreased (0.225647 --> 0.213390).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.218793153762817
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1924745  Vali Loss: 0.1886752 Vali Accuracy: 0.9397410  Vali weighted F1: 0.9389498  Vali macro F1 0.9217645 
new best score!!!!
Validation loss decreased (0.213390 --> 0.188675).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.2184672355651855
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1920775  Vali Loss: 0.1999485 Vali Accuracy: 0.9327689  Vali weighted F1: 0.9307813  Vali macro F1 0.9116708 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.221439599990845
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1743309  Vali Loss: 0.1926849 Vali Accuracy: 0.9387450  Vali weighted F1: 0.9393223  Vali macro F1 0.9212305 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 10 cost time: 6.237416982650757
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1713426  Vali Loss: 0.1617321 Vali Accuracy: 0.9472112  Vali weighted F1: 0.9467700  Vali macro F1 0.9295676 
new best score!!!!
Validation loss decreased (0.188675 --> 0.161732).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.221184253692627
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1651346  Vali Loss: 0.1536618 Vali Accuracy: 0.9516932  Vali weighted F1: 0.9519353  Vali macro F1 0.9346650 
new best score!!!!
Validation loss decreased (0.161732 --> 0.153662).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.244064092636108
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1461619  Vali Loss: 0.1748298 Vali Accuracy: 0.9467131  Vali weighted F1: 0.9472110  Vali macro F1 0.9306743 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.303340435028076
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1424926  Vali Loss: 0.1588619 Vali Accuracy: 0.9437251  Vali weighted F1: 0.9425593  Vali macro F1 0.9257353 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.301027536392212
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1396452  Vali Loss: 0.1382781 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9581554  Vali macro F1 0.9421870 
new best score!!!!
Validation loss decreased (0.153662 --> 0.138278).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.304512023925781
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1295170  Vali Loss: 0.1397924 Vali Accuracy: 0.9566733  Vali weighted F1: 0.9564066  Vali macro F1 0.9399256 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.293908357620239
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1301736  Vali Loss: 0.1484307 Vali Accuracy: 0.9521912  Vali weighted F1: 0.9508912  Vali macro F1 0.9327097 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.2991602420806885
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1264092  Vali Loss: 0.1393305 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9580725  Vali macro F1 0.9432879 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.314656496047974
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1121028  Vali Loss: 0.1112805 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9644291  Vali macro F1 0.9493848 
new best score!!!!
Validation loss decreased (0.138278 --> 0.111281).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.325568675994873
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1139582  Vali Loss: 0.1108544 Vali Accuracy: 0.9626494  Vali weighted F1: 0.9629394  Vali macro F1 0.9519721 
new best score!!!!
Validation loss decreased (0.111281 --> 0.110854).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.251980304718018
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1096972  Vali Loss: 0.1057277 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9681364  Vali macro F1 0.9580437 
new best score!!!!
Validation loss decreased (0.110854 --> 0.105728).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.198261499404907
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0991238  Vali Loss: 0.1193296 Vali Accuracy: 0.9536853  Vali weighted F1: 0.9531532  Vali macro F1 0.9106411 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.186331510543823
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0995608  Vali Loss: 0.1024884 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9710857  Vali macro F1 0.9569218 
new best score!!!!
Validation loss decreased (0.105728 --> 0.102488).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.192775726318359
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0948146  Vali Loss: 0.1134752 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9637417  Vali macro F1 0.9536861 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.19567608833313
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0891006  Vali Loss: 0.0987975 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9685535  Vali macro F1 0.9555484 
new best score!!!!
Validation loss decreased (0.102488 --> 0.098798).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.1876726150512695
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0900665  Vali Loss: 0.1032875 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9673739  Vali macro F1 0.9585275 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.431181907653809
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0819413  Vali Loss: 0.0868385 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9744495  Vali macro F1 0.9654311 
new best score!!!!
Validation loss decreased (0.098798 --> 0.086839).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.236313581466675
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0847414  Vali Loss: 0.0941020 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9735306  Vali macro F1 0.9652072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.276818037033081
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0818877  Vali Loss: 0.0890593 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9749809  Vali macro F1 0.9665891 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.275033950805664
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0777225  Vali Loss: 0.0881130 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9749651  Vali macro F1 0.9638567 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.266877174377441
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0836428  Vali Loss: 0.0925903 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9744902  Vali macro F1 0.9667289 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.27850604057312
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0677950  Vali Loss: 0.0872964 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9726909  Vali macro F1 0.9636443 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.268160581588745
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0588130  Vali Loss: 0.0753000 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9780252  Vali macro F1 0.9709044 
new best score!!!!
Validation loss decreased (0.086839 --> 0.075300).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.26244044303894
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0575993  Vali Loss: 0.0736939 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795547  Vali macro F1 0.9730273 
new best score!!!!
Validation loss decreased (0.075300 --> 0.073694).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.278333425521851
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0558470  Vali Loss: 0.0742703 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800709  Vali macro F1 0.9734997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.281632661819458
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0546420  Vali Loss: 0.0725367 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795547  Vali macro F1 0.9730273 
new best score!!!!
Validation loss decreased (0.073694 --> 0.072537).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.2320661544799805
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0561893  Vali Loss: 0.0742267 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9775730  Vali macro F1 0.9700985 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.190232753753662
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0554008  Vali Loss: 0.0714242 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
new best score!!!!
Validation loss decreased (0.072537 --> 0.071424).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.195384979248047
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0541579  Vali Loss: 0.0714650 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790538  Vali macro F1 0.9722261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.187323093414307
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0523982  Vali Loss: 0.0707199 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800877  Vali macro F1 0.9735368 
new best score!!!!
Validation loss decreased (0.071424 --> 0.070720).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.181261301040649
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0529146  Vali Loss: 0.0714511 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795891  Vali macro F1 0.9727393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.1819000244140625
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0527058  Vali Loss: 0.0716825 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.184072732925415
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0515129  Vali Loss: 0.0706448 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790716  Vali macro F1 0.9724931 
new best score!!!!
Validation loss decreased (0.070720 --> 0.070645).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.206169605255127
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0526028  Vali Loss: 0.0685595 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790716  Vali macro F1 0.9724931 
new best score!!!!
Validation loss decreased (0.070645 --> 0.068559).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.273798227310181
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0517284  Vali Loss: 0.0693024 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.265124320983887
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0508020  Vali Loss: 0.0696376 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795684  Vali macro F1 0.9727398 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.266038179397583
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0509294  Vali Loss: 0.0701808 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795343  Vali macro F1 0.9722926 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.271632194519043
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0510175  Vali Loss: 0.0691141 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9796398  Vali macro F1 0.9729795 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.2721898555755615
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0500161  Vali Loss: 0.0688550 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785574  Vali macro F1 0.9719796 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 6.283100128173828
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0509217  Vali Loss: 0.0685366 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790716  Vali macro F1 0.9724931 
new best score!!!!
Validation loss decreased (0.068559 --> 0.068537).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 7.68012809753418
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0488060  Vali Loss: 0.0683130 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785574  Vali macro F1 0.9719796 
new best score!!!!
Validation loss decreased (0.068537 --> 0.068313).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.263616323471069
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0495227  Vali Loss: 0.0681487 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785574  Vali macro F1 0.9719796 
new best score!!!!
Validation loss decreased (0.068313 --> 0.068149).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.217259645462036
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0501547  Vali Loss: 0.0678993 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785574  Vali macro F1 0.9719796 
new best score!!!!
Validation loss decreased (0.068149 --> 0.067899).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.180458307266235
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0501802  Vali Loss: 0.0675525 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790583  Vali macro F1 0.9727809 
new best score!!!!
Validation loss decreased (0.067899 --> 0.067552).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.185132741928101
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0488949  Vali Loss: 0.0676860 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785574  Vali macro F1 0.9719796 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.18269681930542
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0467841  Vali Loss: 0.0676283 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785574  Vali macro F1 0.9719796 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.184521913528442
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0502977  Vali Loss: 0.0677641 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785574  Vali macro F1 0.9719796 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.178773403167725
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0484584  Vali Loss: 0.0673642 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
new best score!!!!
Validation loss decreased (0.067552 --> 0.067364).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.174800395965576
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0473910  Vali Loss: 0.0673613 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
new best score!!!!
Validation loss decreased (0.067364 --> 0.067361).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 6.230411767959595
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0484812  Vali Loss: 0.0674476 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.28916335105896
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0487396  Vali Loss: 0.0674350 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 6.262153148651123
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0465708  Vali Loss: 0.0674862 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800557  Vali macro F1 0.9738293 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 6.25493049621582
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0480476  Vali Loss: 0.0671215 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
new best score!!!!
Validation loss decreased (0.067361 --> 0.067121).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 6.239182233810425
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0487559  Vali Loss: 0.0669702 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790583  Vali macro F1 0.9727809 
new best score!!!!
Validation loss decreased (0.067121 --> 0.066970).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 6.254223108291626
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0472955  Vali Loss: 0.0669799 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 6.2505271434783936
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0471233  Vali Loss: 0.0667034 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
new best score!!!!
Validation loss decreased (0.066970 --> 0.066703).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 6.259137153625488
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0474285  Vali Loss: 0.0667667 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800712  Vali macro F1 0.9740933 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.262134075164795
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0475336  Vali Loss: 0.0667513 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.216173410415649
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0476541  Vali Loss: 0.0671103 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795674  Vali macro F1 0.9729658 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.203906536102295
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0473788  Vali Loss: 0.0667807 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800557  Vali macro F1 0.9738293 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.180589914321899
VALI: Epoch: 70, Steps: 71 | Train Loss: 0.0466706  Vali Loss: 0.0663153 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795713  Vali macro F1 0.9732928 
new best score!!!!
Validation loss decreased (0.066703 --> 0.066315).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 6.167694568634033
VALI: Epoch: 71, Steps: 71 | Train Loss: 0.0485370  Vali Loss: 0.0665515 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800837  Vali macro F1 0.9738034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 6.170464754104614
VALI: Epoch: 72, Steps: 71 | Train Loss: 0.0476484  Vali Loss: 0.0665920 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795851  Vali macro F1 0.9730053 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 6.1809022426605225
VALI: Epoch: 73, Steps: 71 | Train Loss: 0.0479768  Vali Loss: 0.0665948 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800557  Vali macro F1 0.9738293 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 6.180168390274048
VALI: Epoch: 74, Steps: 71 | Train Loss: 0.0497020  Vali Loss: 0.0665012 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800682  Vali macro F1 0.9735395 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 6.225400686264038
VALI: Epoch: 75, Steps: 71 | Train Loss: 0.0482659  Vali Loss: 0.0661947 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800837  Vali macro F1 0.9738034 
new best score!!!!
Validation loss decreased (0.066315 --> 0.066195).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 6.260345458984375
VALI: Epoch: 76, Steps: 71 | Train Loss: 0.0465843  Vali Loss: 0.0660300 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795851  Vali macro F1 0.9730053 
new best score!!!!
Validation loss decreased (0.066195 --> 0.066030).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 6.269137382507324
VALI: Epoch: 77, Steps: 71 | Train Loss: 0.0467375  Vali Loss: 0.0659747 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
new best score!!!!
Validation loss decreased (0.066030 --> 0.065975).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 6.2578301429748535
VALI: Epoch: 78, Steps: 71 | Train Loss: 0.0476597  Vali Loss: 0.0665205 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810708  Vali macro F1 0.9751015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 6.248953580856323
VALI: Epoch: 79, Steps: 71 | Train Loss: 0.0471913  Vali Loss: 0.0661282 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805824  Vali macro F1 0.9746024 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 6.261755466461182
VALI: Epoch: 80, Steps: 71 | Train Loss: 0.0487583  Vali Loss: 0.0661174 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805568  Vali macro F1 0.9746321 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 6.264791250228882
VALI: Epoch: 81, Steps: 71 | Train Loss: 0.0472752  Vali Loss: 0.0661449 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810820  Vali macro F1 0.9748093 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 6.255014896392822
VALI: Epoch: 82, Steps: 71 | Train Loss: 0.0474688  Vali Loss: 0.0660077 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805680  Vali macro F1 0.9743399 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 83 cost time: 6.253502607345581
VALI: Epoch: 83, Steps: 71 | Train Loss: 0.0469457  Vali Loss: 0.0659491 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805680  Vali macro F1 0.9743399 
new best score!!!!
Validation loss decreased (0.065975 --> 0.065949).  Saving model ...
new best score!!!!
Epoch: 84 cost time: 6.1839540004730225
VALI: Epoch: 84, Steps: 71 | Train Loss: 0.0472847  Vali Loss: 0.0659537 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805680  Vali macro F1 0.9743399 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 6.198148727416992
VALI: Epoch: 85, Steps: 71 | Train Loss: 0.0475431  Vali Loss: 0.0659608 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 6.1777660846710205
VALI: Epoch: 86, Steps: 71 | Train Loss: 0.0469514  Vali Loss: 0.0659373 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
new best score!!!!
Validation loss decreased (0.065949 --> 0.065937).  Saving model ...
new best score!!!!
Epoch: 87 cost time: 6.173657655715942
VALI: Epoch: 87, Steps: 71 | Train Loss: 0.0471991  Vali Loss: 0.0658875 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
new best score!!!!
Validation loss decreased (0.065937 --> 0.065888).  Saving model ...
new best score!!!!
Epoch: 88 cost time: 6.167788982391357
VALI: Epoch: 88, Steps: 71 | Train Loss: 0.0482493  Vali Loss: 0.0658589 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
new best score!!!!
Validation loss decreased (0.065888 --> 0.065859).  Saving model ...
new best score!!!!
Epoch: 89 cost time: 6.179424524307251
VALI: Epoch: 89, Steps: 71 | Train Loss: 0.0456087  Vali Loss: 0.0658692 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 6.177956819534302
VALI: Epoch: 90, Steps: 71 | Train Loss: 0.0453164  Vali Loss: 0.0658211 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
new best score!!!!
Validation loss decreased (0.065859 --> 0.065821).  Saving model ...
new best score!!!!
Epoch: 91 cost time: 6.175975561141968
VALI: Epoch: 91, Steps: 71 | Train Loss: 0.0483558  Vali Loss: 0.0658112 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
new best score!!!!
Validation loss decreased (0.065821 --> 0.065811).  Saving model ...
new best score!!!!
Epoch: 92 cost time: 6.170562028884888
VALI: Epoch: 92, Steps: 71 | Train Loss: 0.0477437  Vali Loss: 0.0658163 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 93 cost time: 6.189102649688721
VALI: Epoch: 93, Steps: 71 | Train Loss: 0.0476501  Vali Loss: 0.0658520 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 94 cost time: 6.20717716217041
VALI: Epoch: 94, Steps: 71 | Train Loss: 0.0461736  Vali Loss: 0.0658673 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 95 cost time: 6.237685203552246
VALI: Epoch: 95, Steps: 71 | Train Loss: 0.0486267  Vali Loss: 0.0658591 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 96 cost time: 6.262671947479248
VALI: Epoch: 96, Steps: 71 | Train Loss: 0.0476298  Vali Loss: 0.0658559 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 97 cost time: 6.255613803863525
VALI: Epoch: 97, Steps: 71 | Train Loss: 0.0465058  Vali Loss: 0.0658583 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 98 cost time: 6.261845827102661
VALI: Epoch: 98, Steps: 71 | Train Loss: 0.0465274  Vali Loss: 0.0658636 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 99 cost time: 6.255935430526733
VALI: Epoch: 99, Steps: 71 | Train Loss: 0.0479286  Vali Loss: 0.0658619 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 100 cost time: 6.244882822036743
VALI: Epoch: 100, Steps: 71 | Train Loss: 0.0483799  Vali Loss: 0.0658625 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 101 cost time: 6.188318729400635
VALI: Epoch: 101, Steps: 71 | Train Loss: 0.0461461  Vali Loss: 0.0658613 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000004e-08
Epoch: 102 cost time: 6.19951319694519
VALI: Epoch: 102, Steps: 71 | Train Loss: 0.0466504  Vali Loss: 0.0658614 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 103 cost time: 6.2018444538116455
VALI: Epoch: 103, Steps: 71 | Train Loss: 0.0462553  Vali Loss: 0.0658612 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 104 cost time: 6.286822557449341
VALI: Epoch: 104, Steps: 71 | Train Loss: 0.0466175  Vali Loss: 0.0658616 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 105 cost time: 6.196094751358032
VALI: Epoch: 105, Steps: 71 | Train Loss: 0.0475956  Vali Loss: 0.0658614 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 106 cost time: 8.585240125656128
VALI: Epoch: 106, Steps: 71 | Train Loss: 0.0472683  Vali Loss: 0.0658610 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810681  Vali macro F1 0.9751412 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9422523  Test weighted F1: 0.9430484  Test macro F1 0.9431290 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.2301647663116455
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0473221  Vali Loss: 0.0674333 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795654  Vali macro F1 0.9738269 
Validation loss decreased (inf --> 0.067433).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.201197385787964
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0481723  Vali Loss: 0.0675103 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815907  Vali macro F1 0.9753574 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.212105989456177
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0482558  Vali Loss: 0.0657358 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810950  Vali macro F1 0.9748840 
new best score!!!!
Validation loss decreased (0.067433 --> 0.065736).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.207552194595337
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0477403  Vali Loss: 0.0674096 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806232  Vali macro F1 0.9739104 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.197705268859863
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0490998  Vali Loss: 0.0655561 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800935  Vali macro F1 0.9734778 
new best score!!!!
Validation loss decreased (0.065736 --> 0.065556).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.202924966812134
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0486803  Vali Loss: 0.0657231 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826293  Vali macro F1 0.9777716 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.212022542953491
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0463609  Vali Loss: 0.0658277 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815869  Vali macro F1 0.9764704 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.216648578643799
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0468922  Vali Loss: 0.0655748 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810641  Vali macro F1 0.9747116 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.224815368652344
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0449730  Vali Loss: 0.0635611 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835938  Vali macro F1 0.9786853 
new best score!!!!
Validation loss decreased (0.065556 --> 0.063561).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.307888507843018
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0465035  Vali Loss: 0.0623171 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815913  Vali macro F1 0.9763639 
new best score!!!!
Validation loss decreased (0.063561 --> 0.062317).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.312399625778198
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0463439  Vali Loss: 0.0625029 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820831  Vali macro F1 0.9761567 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.333933591842651
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0436748  Vali Loss: 0.0672802 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835945  Vali macro F1 0.9786444 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.314321041107178
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0433851  Vali Loss: 0.0653620 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826102  Vali macro F1 0.9775815 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.309994220733643
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0447283  Vali Loss: 0.0623328 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825861  Vali macro F1 0.9778162 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.301503896713257
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0420430  Vali Loss: 0.0632114 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826218  Vali macro F1 0.9774588 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 6.317317247390747
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0439118  Vali Loss: 0.0636862 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821264  Vali macro F1 0.9772055 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.293583154678345
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0442382  Vali Loss: 0.0637539 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836205  Vali macro F1 0.9778861 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.291656255722046
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0434243  Vali Loss: 0.0639619 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820947  Vali macro F1 0.9756767 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.3059868812561035
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0416935  Vali Loss: 0.0626495 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811123  Vali macro F1 0.9748189 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.3175129890441895
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0460588  Vali Loss: 0.0615188 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826293  Vali macro F1 0.9772729 
new best score!!!!
Validation loss decreased (0.062317 --> 0.061519).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.313717603683472
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0415105  Vali Loss: 0.0620208 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831256  Vali macro F1 0.9781746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.298943758010864
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0449676  Vali Loss: 0.0632053 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815494  Vali macro F1 0.9768511 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.288749694824219
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0409576  Vali Loss: 0.0612937 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840957  Vali macro F1 0.9792184 
new best score!!!!
Validation loss decreased (0.061519 --> 0.061294).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.222421169281006
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0411183  Vali Loss: 0.0626386 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831239  Vali macro F1 0.9785145 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.2235236167907715
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0426057  Vali Loss: 0.0628407 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825841  Vali macro F1 0.9775642 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.223589897155762
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0403900  Vali Loss: 0.0638093 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831345  Vali macro F1 0.9782807 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.23499608039856
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0401713  Vali Loss: 0.0641219 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816112  Vali macro F1 0.9758378 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.24514627456665
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0399336  Vali Loss: 0.0637538 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811729  Vali macro F1 0.9743209 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 29 cost time: 6.24218225479126
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0392778  Vali Loss: 0.0628135 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821285  Vali macro F1 0.9762755 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.227421522140503
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0393222  Vali Loss: 0.0622951 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836029  Vali macro F1 0.9789079 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.239233493804932
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0398578  Vali Loss: 0.0615994 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.220495939254761
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0382337  Vali Loss: 0.0611987 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
new best score!!!!
Validation loss decreased (0.061294 --> 0.061199).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.222503423690796
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0382871  Vali Loss: 0.0612129 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.221134662628174
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0388362  Vali Loss: 0.0612720 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.25287389755249
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0380931  Vali Loss: 0.0611283 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831108  Vali macro F1 0.9784728 
new best score!!!!
Validation loss decreased (0.061199 --> 0.061128).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 36 cost time: 6.312774896621704
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0386291  Vali Loss: 0.0612191 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831108  Vali macro F1 0.9784728 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.32510232925415
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0382679  Vali Loss: 0.0612162 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821323  Vali macro F1 0.9771770 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.307924270629883
Fine Tuning VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0391491  Vali Loss: 0.0617167 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840849  Vali macro F1 0.9797650 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.314439296722412
Fine Tuning VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0391044  Vali Loss: 0.0612574 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826261  Vali macro F1 0.9779362 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.305225133895874
Fine Tuning VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0366120  Vali Loss: 0.0614787 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821091  Vali macro F1 0.9772099 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 41 cost time: 6.291130304336548
Fine Tuning VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0372481  Vali Loss: 0.0613008 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831032  Vali macro F1 0.9782525 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 6.312300205230713
Fine Tuning VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0385557  Vali Loss: 0.0612187 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 6.298907041549683
Fine Tuning VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0381808  Vali Loss: 0.0611567 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 6.32485818862915
Fine Tuning VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0366898  Vali Loss: 0.0611283 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
new best score!!!!
Validation loss decreased (0.061128 --> 0.061128).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 45 cost time: 6.3216872215271
Fine Tuning VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0362233  Vali Loss: 0.0611015 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
new best score!!!!
Validation loss decreased (0.061128 --> 0.061101).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 6.312511920928955
Fine Tuning VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0358169  Vali Loss: 0.0610936 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
new best score!!!!
Validation loss decreased (0.061101 --> 0.061094).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 47 cost time: 6.285072088241577
Fine Tuning VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0370334  Vali Loss: 0.0610908 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
new best score!!!!
Validation loss decreased (0.061094 --> 0.061091).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 48 cost time: 6.280691623687744
Fine Tuning VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0381121  Vali Loss: 0.0610914 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 49 cost time: 6.219192266464233
Fine Tuning VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0386334  Vali Loss: 0.0610801 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
new best score!!!!
Validation loss decreased (0.061091 --> 0.061080).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 6.21516489982605
Fine Tuning VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0382431  Vali Loss: 0.0610453 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
new best score!!!!
Validation loss decreased (0.061080 --> 0.061045).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 6.2080254554748535
Fine Tuning VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0376063  Vali Loss: 0.0610913 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 52 cost time: 6.218987464904785
Fine Tuning VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0378692  Vali Loss: 0.0611082 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 53 cost time: 6.246005058288574
Fine Tuning VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0375582  Vali Loss: 0.0610667 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 54 cost time: 6.227426767349243
Fine Tuning VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0358650  Vali Loss: 0.0610578 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826181  Vali macro F1 0.9776721 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 55 cost time: 6.222739219665527
Fine Tuning VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0380732  Vali Loss: 0.0610244 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835945  Vali macro F1 0.9786444 
new best score!!!!
Validation loss decreased (0.061045 --> 0.061024).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 56 cost time: 6.222350835800171
Fine Tuning VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0379331  Vali Loss: 0.0610206 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835945  Vali macro F1 0.9786444 
new best score!!!!
Validation loss decreased (0.061024 --> 0.061021).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 57 cost time: 6.21449613571167
Fine Tuning VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0368365  Vali Loss: 0.0610611 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 58 cost time: 6.212137699127197
Fine Tuning VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0378260  Vali Loss: 0.0611019 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 59 cost time: 6.2076735496521
Fine Tuning VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0376115  Vali Loss: 0.0611001 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 60 cost time: 6.226119518280029
Fine Tuning VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0366407  Vali Loss: 0.0611103 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 61 cost time: 6.295499086380005
Fine Tuning VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0370666  Vali Loss: 0.0610742 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835945  Vali macro F1 0.9786444 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 62 cost time: 6.312015533447266
Fine Tuning VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0390030  Vali Loss: 0.0610695 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835945  Vali macro F1 0.9786444 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 63 cost time: 6.287015199661255
Fine Tuning VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0386356  Vali Loss: 0.0610684 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835945  Vali macro F1 0.9786444 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 64 cost time: 6.288159608840942
Fine Tuning VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0374630  Vali Loss: 0.0610678 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835945  Vali macro F1 0.9786444 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 65 cost time: 6.2856481075286865
Fine Tuning VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0360054  Vali Loss: 0.0610680 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835945  Vali macro F1 0.9786444 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 66 cost time: 6.289137601852417
Fine Tuning VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0392916  Vali Loss: 0.0610690 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000004e-08
Fine Tuning Epoch: 67 cost time: 6.286566972732544
Fine Tuning VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0387460  Vali Loss: 0.0610688 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 68 cost time: 6.263311862945557
Fine Tuning VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0393976  Vali Loss: 0.0610689 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 69 cost time: 6.219005584716797
Fine Tuning VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0365528  Vali Loss: 0.0610685 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 70 cost time: 6.220604658126831
Fine Tuning VALI: Epoch: 70, Steps: 71 | Train Loss: 0.0367235  Vali Loss: 0.0610685 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 71 cost time: 6.216152667999268
Fine Tuning VALI: Epoch: 71, Steps: 71 | Train Loss: 0.0387276  Vali Loss: 0.0610680 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9831093  Vali macro F1 0.9781058 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9379295  Test weighted F1: 0.9389933  Test macro F1 0.9385166 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 63951
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014616 0.00018232 0.00096154 0.001221   0.00048263 0.00060864]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.166473388671875
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2426943  Vali Loss: 0.7381683 Vali Accuracy: 0.7008547  Vali weighted F1: 0.5966842  Vali macro F1 0.2860801 
Validation loss decreased (inf --> 0.738168).  Saving model ...
Epoch: 2 cost time: 6.187311172485352
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6618268  Vali Loss: 0.6770103 Vali Accuracy: 0.7395676  Vali weighted F1: 0.6630876  Vali macro F1 0.4451923 
new best score!!!!
Validation loss decreased (0.738168 --> 0.677010).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.195624828338623
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5580655  Vali Loss: 0.4795238 Vali Accuracy: 0.8235294  Vali weighted F1: 0.8055474  Vali macro F1 0.7522531 
new best score!!!!
Validation loss decreased (0.677010 --> 0.479524).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.170528888702393
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4200407  Vali Loss: 0.3768387 Vali Accuracy: 0.8652589  Vali weighted F1: 0.8630688  Vali macro F1 0.8284320 
new best score!!!!
Validation loss decreased (0.479524 --> 0.376839).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.1874659061431885
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3301971  Vali Loss: 0.3162445 Vali Accuracy: 0.8903972  Vali weighted F1: 0.8831092  Vali macro F1 0.8510292 
new best score!!!!
Validation loss decreased (0.376839 --> 0.316245).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.211587905883789
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2441393  Vali Loss: 0.2003067 Vali Accuracy: 0.9396682  Vali weighted F1: 0.9384814  Vali macro F1 0.9167643 
new best score!!!!
Validation loss decreased (0.316245 --> 0.200307).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.191137075424194
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1891745  Vali Loss: 0.1642498 Vali Accuracy: 0.9512318  Vali weighted F1: 0.9509906  Vali macro F1 0.9343155 
new best score!!!!
Validation loss decreased (0.200307 --> 0.164250).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.181543827056885
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1723963  Vali Loss: 0.1625016 Vali Accuracy: 0.9517345  Vali weighted F1: 0.9509819  Vali macro F1 0.9346450 
new best score!!!!
Validation loss decreased (0.164250 --> 0.162502).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.179863929748535
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1543864  Vali Loss: 0.1338783 Vali Accuracy: 0.9582705  Vali weighted F1: 0.9581041  Vali macro F1 0.9429142 
new best score!!!!
Validation loss decreased (0.162502 --> 0.133878).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.175435304641724
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1533681  Vali Loss: 0.1323432 Vali Accuracy: 0.9522373  Vali weighted F1: 0.9529730  Vali macro F1 0.9361591 
new best score!!!!
Validation loss decreased (0.133878 --> 0.132343).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.186078786849976
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1346901  Vali Loss: 0.1263601 Vali Accuracy: 0.9562594  Vali weighted F1: 0.9558885  Vali macro F1 0.9399139 
new best score!!!!
Validation loss decreased (0.132343 --> 0.126360).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.178925514221191
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1332912  Vali Loss: 0.1171113 Vali Accuracy: 0.9567622  Vali weighted F1: 0.9567972  Vali macro F1 0.9389431 
new best score!!!!
Validation loss decreased (0.126360 --> 0.117111).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.184582471847534
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1171422  Vali Loss: 0.1043556 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9621418  Vali macro F1 0.9458886 
new best score!!!!
Validation loss decreased (0.117111 --> 0.104356).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.20759391784668
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1145175  Vali Loss: 0.0898491 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9698190  Vali macro F1 0.9563328 
new best score!!!!
Validation loss decreased (0.104356 --> 0.089849).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.280444383621216
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1139387  Vali Loss: 0.1188816 Vali Accuracy: 0.9582705  Vali weighted F1: 0.9579208  Vali macro F1 0.9388893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.232641935348511
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0999579  Vali Loss: 0.0983417 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9630556  Vali macro F1 0.9479759 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.21830415725708
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1042575  Vali Loss: 0.0908648 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9686007  Vali macro F1 0.9558611 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.261081218719482
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0932552  Vali Loss: 0.0896473 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9682517  Vali macro F1 0.9574982 
new best score!!!!
Validation loss decreased (0.089849 --> 0.089647).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.263092994689941
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0867759  Vali Loss: 0.0766784 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9712835  Vali macro F1 0.9568781 
new best score!!!!
Validation loss decreased (0.089647 --> 0.076678).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.259323358535767
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0873998  Vali Loss: 0.0968681 Vali Accuracy: 0.9653092  Vali weighted F1: 0.9656607  Vali macro F1 0.9506576 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.262641668319702
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0780801  Vali Loss: 0.0730495 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9725742  Vali macro F1 0.9566140 
new best score!!!!
Validation loss decreased (0.076678 --> 0.073049).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.2681968212127686
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0733699  Vali Loss: 0.0843098 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9685281  Vali macro F1 0.9538178 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.2843029499053955
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0689609  Vali Loss: 0.0703644 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9725966  Vali macro F1 0.9608491 
new best score!!!!
Validation loss decreased (0.073049 --> 0.070364).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.262387752532959
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0680612  Vali Loss: 0.0660273 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9760114  Vali macro F1 0.9698380 
new best score!!!!
Validation loss decreased (0.070364 --> 0.066027).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.2595765590667725
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0681812  Vali Loss: 0.0773663 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9721179  Vali macro F1 0.9658365 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.260054349899292
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0704647  Vali Loss: 0.0595212 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9772680  Vali macro F1 0.9710578 
new best score!!!!
Validation loss decreased (0.066027 --> 0.059521).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.265456438064575
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0664504  Vali Loss: 0.0921343 Vali Accuracy: 0.9663147  Vali weighted F1: 0.9665055  Vali macro F1 0.9568368 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.220262289047241
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0607066  Vali Loss: 0.0610278 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9786089  Vali macro F1 0.9730272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.187352418899536
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0572410  Vali Loss: 0.0567274 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9806010  Vali macro F1 0.9731915 
new best score!!!!
Validation loss decreased (0.059521 --> 0.056727).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.198875188827515
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0510117  Vali Loss: 0.0472523 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9850083  Vali macro F1 0.9802633 
new best score!!!!
Validation loss decreased (0.056727 --> 0.047252).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.210774183273315
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0471610  Vali Loss: 0.0540845 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808981  Vali macro F1 0.9764915 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.192924499511719
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0494762  Vali Loss: 0.0725927 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9786896  Vali macro F1 0.9735781 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.191447496414185
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0522915  Vali Loss: 0.0758696 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9758934  Vali macro F1 0.9650022 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.190366744995117
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0653705  Vali Loss: 0.0573838 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9797926  Vali macro F1 0.9744181 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.1931140422821045
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0492055  Vali Loss: 0.0617516 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808462  Vali macro F1 0.9729130 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 36 cost time: 6.188960313796997
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0359015  Vali Loss: 0.0441434 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864179  Vali macro F1 0.9804510 
new best score!!!!
Validation loss decreased (0.047252 --> 0.044143).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.187148332595825
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0310005  Vali Loss: 0.0410750 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859138  Vali macro F1 0.9808554 
new best score!!!!
Validation loss decreased (0.044143 --> 0.041075).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.1894755363464355
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0331885  Vali Loss: 0.0415370 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869241  Vali macro F1 0.9822252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.209208250045776
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0313558  Vali Loss: 0.0406862 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869258  Vali macro F1 0.9818264 
new best score!!!!
Validation loss decreased (0.041075 --> 0.040686).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.265354871749878
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0304706  Vali Loss: 0.0437613 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864114  Vali macro F1 0.9813316 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.26809024810791
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0292222  Vali Loss: 0.0430623 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863870  Vali macro F1 0.9813116 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.263933420181274
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0296178  Vali Loss: 0.0410452 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874081  Vali macro F1 0.9821860 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.262240171432495
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0270986  Vali Loss: 0.0445135 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9854336  Vali macro F1 0.9804636 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.277047395706177
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0278855  Vali Loss: 0.0419215 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874388  Vali macro F1 0.9824177 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 6.261843919754028
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0281721  Vali Loss: 0.0416609 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874382  Vali macro F1 0.9823996 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.261720418930054
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0266232  Vali Loss: 0.0415772 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.269071578979492
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0268814  Vali Loss: 0.0417138 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.280570030212402
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0260901  Vali Loss: 0.0412789 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.2409162521362305
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0272148  Vali Loss: 0.0417022 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 6.253942489624023
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0254094  Vali Loss: 0.0416272 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.261808156967163
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0269283  Vali Loss: 0.0415751 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.258044004440308
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0288766  Vali Loss: 0.0415429 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.233820199966431
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0259061  Vali Loss: 0.0415389 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.198960304260254
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0279672  Vali Loss: 0.0414791 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869227  Vali macro F1 0.9819044 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8637780  Test weighted F1: 0.8711341  Test macro F1 0.8373896 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.199047088623047
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0299588  Vali Loss: 0.0420189 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874269  Vali macro F1 0.9826384 
Validation loss decreased (inf --> 0.042019).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.188787460327148
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0300368  Vali Loss: 0.0414975 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874382  Vali macro F1 0.9823996 
new best score!!!!
Validation loss decreased (0.042019 --> 0.041498).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.15715217590332
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0284969  Vali Loss: 0.0432644 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879429  Vali macro F1 0.9832273 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.165659427642822
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0280934  Vali Loss: 0.0469558 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859850  Vali macro F1 0.9812697 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.179924249649048
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0281743  Vali Loss: 0.0476729 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849696  Vali macro F1 0.9796489 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.3020546436309814
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0292053  Vali Loss: 0.0405469 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869502  Vali macro F1 0.9818046 
new best score!!!!
Validation loss decreased (0.041498 --> 0.040547).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.1693994998931885
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0268152  Vali Loss: 0.0432358 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869585  Vali macro F1 0.9819607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.177123785018921
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0276270  Vali Loss: 0.0422319 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879294  Vali macro F1 0.9834679 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.1902549266815186
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0249796  Vali Loss: 0.0407172 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884272  Vali macro F1 0.9843337 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.209239959716797
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0254876  Vali Loss: 0.0453232 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879818  Vali macro F1 0.9838457 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.226114273071289
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0258803  Vali Loss: 0.0383953 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889559  Vali macro F1 0.9845288 
new best score!!!!
Validation loss decreased (0.040547 --> 0.038395).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.231706142425537
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0245862  Vali Loss: 0.0386722 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879040  Vali macro F1 0.9830167 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.2344348430633545
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0241301  Vali Loss: 0.0375620 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879193  Vali macro F1 0.9831165 
new best score!!!!
Validation loss decreased (0.038395 --> 0.037562).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.183624267578125
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0248866  Vali Loss: 0.0386899 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884307  Vali macro F1 0.9836875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.1782121658325195
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0237713  Vali Loss: 0.0384202 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884245  Vali macro F1 0.9832961 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.178328990936279
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0257952  Vali Loss: 0.0374143 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879445  Vali macro F1 0.9832258 
new best score!!!!
Validation loss decreased (0.037562 --> 0.037414).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.190004825592041
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0240663  Vali Loss: 0.0392029 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884337  Vali macro F1 0.9842776 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.197411775588989
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0225113  Vali Loss: 0.0404370 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884924  Vali macro F1 0.9843523 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.191423654556274
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0234813  Vali Loss: 0.0367619 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904589  Vali macro F1 0.9868794 
new best score!!!!
Validation loss decreased (0.037414 --> 0.036762).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.1792168617248535
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0227910  Vali Loss: 0.0387191 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889300  Vali macro F1 0.9850872 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.164659023284912
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0223371  Vali Loss: 0.0394160 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884117  Vali macro F1 0.9848016 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.168501853942871
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0224914  Vali Loss: 0.0471573 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889183  Vali macro F1 0.9852483 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.17305326461792
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0215175  Vali Loss: 0.0367859 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904536  Vali macro F1 0.9865562 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.1693339347839355
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0230577  Vali Loss: 0.0364963 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894459  Vali macro F1 0.9849915 
new best score!!!!
Validation loss decreased (0.036762 --> 0.036496).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.180500745773315
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0197530  Vali Loss: 0.0410824 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889873  Vali macro F1 0.9849091 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.300310373306274
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0209574  Vali Loss: 0.0392982 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904707  Vali macro F1 0.9866533 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.190211296081543
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0212134  Vali Loss: 0.0390724 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899672  Vali macro F1 0.9863969 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.172158718109131
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0206230  Vali Loss: 0.0392271 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894512  Vali macro F1 0.9855966 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.16582989692688
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0191843  Vali Loss: 0.0372089 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904326  Vali macro F1 0.9866003 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 30 cost time: 6.163177967071533
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0194588  Vali Loss: 0.0369491 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904518  Vali macro F1 0.9867275 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.169673681259155
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0193392  Vali Loss: 0.0366030 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899582  Vali macro F1 0.9861640 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.17203164100647
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0202748  Vali Loss: 0.0345076 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904589  Vali macro F1 0.9868794 
new best score!!!!
Validation loss decreased (0.036496 --> 0.034508).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.176936149597168
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0198536  Vali Loss: 0.0328724 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909546  Vali macro F1 0.9873625 
new best score!!!!
Validation loss decreased (0.034508 --> 0.032872).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 6.178736925125122
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0203409  Vali Loss: 0.0377375 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899347  Vali macro F1 0.9860494 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 6.19306492805481
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0187611  Vali Loss: 0.0387163 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884223  Vali macro F1 0.9829245 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 6.175767660140991
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0192525  Vali Loss: 0.0363373 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894570  Vali macro F1 0.9853545 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 6.171391010284424
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0178284  Vali Loss: 0.0439172 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874876  Vali macro F1 0.9842821 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 6.174036264419556
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0184486  Vali Loss: 0.0390864 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894578  Vali macro F1 0.9852904 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 39 cost time: 6.178136587142944
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0166204  Vali Loss: 0.0366882 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909546  Vali macro F1 0.9873625 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 6.15685510635376
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0171196  Vali Loss: 0.0366623 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909519  Vali macro F1 0.9874356 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 6.157939910888672
Fine Tuning VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0174870  Vali Loss: 0.0359053 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909519  Vali macro F1 0.9874356 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 6.161849021911621
Fine Tuning VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0176560  Vali Loss: 0.0362851 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909546  Vali macro F1 0.9873625 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 6.184103012084961
Fine Tuning VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0183121  Vali Loss: 0.0354690 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909596  Vali macro F1 0.9872932 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 44 cost time: 6.198693037033081
Fine Tuning VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0174129  Vali Loss: 0.0354987 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909596  Vali macro F1 0.9872932 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 45 cost time: 6.170463562011719
Fine Tuning VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0156115  Vali Loss: 0.0354251 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909596  Vali macro F1 0.9872932 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 46 cost time: 6.177289724349976
Fine Tuning VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0165533  Vali Loss: 0.0355278 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909596  Vali macro F1 0.9872932 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 47 cost time: 6.1674604415893555
Fine Tuning VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0167342  Vali Loss: 0.0354004 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909596  Vali macro F1 0.9872932 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 48 cost time: 6.177130222320557
Fine Tuning VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0171494  Vali Loss: 0.0354743 Vali Accuracy: 0.9909502  Vali weighted F1: 0.9909596  Vali macro F1 0.9872932 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8729265  Test weighted F1: 0.8797583  Test macro F1 0.8469164 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014914 0.00018315 0.00110742 0.00140252 0.00050633 0.00062617]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.980360507965088
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.2490797  Vali Loss: 0.8023516 Vali Accuracy: 0.6682219  Vali weighted F1: 0.5595769  Vali macro F1 0.2751055 
Validation loss decreased (inf --> 0.802352).  Saving model ...
Epoch: 2 cost time: 5.9876697063446045
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.6787884  Vali Loss: 0.6005889 Vali Accuracy: 0.7682737  Vali weighted F1: 0.7121734  Vali macro F1 0.5075572 
new best score!!!!
Validation loss decreased (0.802352 --> 0.600589).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.990572690963745
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.5267902  Vali Loss: 0.4461343 Vali Accuracy: 0.8247797  Vali weighted F1: 0.7922617  Vali macro F1 0.6111729 
new best score!!!!
Validation loss decreased (0.600589 --> 0.446134).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.961926221847534
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.4237610  Vali Loss: 0.3602383 Vali Accuracy: 0.8589943  Vali weighted F1: 0.8406237  Vali macro F1 0.6736542 
new best score!!!!
Validation loss decreased (0.446134 --> 0.360238).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.973292827606201
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.3252082  Vali Loss: 0.2835740 Vali Accuracy: 0.9118714  Vali weighted F1: 0.9080747  Vali macro F1 0.8730048 
new best score!!!!
Validation loss decreased (0.360238 --> 0.283574).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.9865148067474365
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2410635  Vali Loss: 0.2049148 Vali Accuracy: 0.9331260  Vali weighted F1: 0.9316787  Vali macro F1 0.9096743 
new best score!!!!
Validation loss decreased (0.283574 --> 0.204915).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.976117134094238
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1992779  Vali Loss: 0.1709744 Vali Accuracy: 0.9471229  Vali weighted F1: 0.9470500  Vali macro F1 0.9292536 
new best score!!!!
Validation loss decreased (0.204915 --> 0.170974).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.992286682128906
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1853313  Vali Loss: 0.1585414 Vali Accuracy: 0.9481597  Vali weighted F1: 0.9479979  Vali macro F1 0.9302145 
new best score!!!!
Validation loss decreased (0.170974 --> 0.158541).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.993507623672485
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1676331  Vali Loss: 0.1548098 Vali Accuracy: 0.9507517  Vali weighted F1: 0.9509546  Vali macro F1 0.9360425 
new best score!!!!
Validation loss decreased (0.158541 --> 0.154810).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.984342575073242
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1601832  Vali Loss: 0.1545221 Vali Accuracy: 0.9512701  Vali weighted F1: 0.9516113  Vali macro F1 0.9347415 
new best score!!!!
Validation loss decreased (0.154810 --> 0.154522).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.985546350479126
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1465227  Vali Loss: 0.1416248 Vali Accuracy: 0.9559357  Vali weighted F1: 0.9562571  Vali macro F1 0.9419724 
new best score!!!!
Validation loss decreased (0.154522 --> 0.141625).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.996266603469849
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1537418  Vali Loss: 0.1376803 Vali Accuracy: 0.9517885  Vali weighted F1: 0.9517816  Vali macro F1 0.9323952 
new best score!!!!
Validation loss decreased (0.141625 --> 0.137680).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.982408285140991
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1336295  Vali Loss: 0.1375396 Vali Accuracy: 0.9523069  Vali weighted F1: 0.9515678  Vali macro F1 0.9347047 
new best score!!!!
Validation loss decreased (0.137680 --> 0.137540).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.980393409729004
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1217979  Vali Loss: 0.1126536 Vali Accuracy: 0.9626750  Vali weighted F1: 0.9626047  Vali macro F1 0.9459600 
new best score!!!!
Validation loss decreased (0.137540 --> 0.112654).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.990541696548462
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1152646  Vali Loss: 0.1107983 Vali Accuracy: 0.9564541  Vali weighted F1: 0.9566448  Vali macro F1 0.9408951 
new best score!!!!
Validation loss decreased (0.112654 --> 0.110798).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.990096807479858
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1059817  Vali Loss: 0.1027613 Vali Accuracy: 0.9626750  Vali weighted F1: 0.9624701  Vali macro F1 0.9474944 
new best score!!!!
Validation loss decreased (0.110798 --> 0.102761).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.989352464675903
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1009937  Vali Loss: 0.1107742 Vali Accuracy: 0.9590461  Vali weighted F1: 0.9587720  Vali macro F1 0.9360222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.984120845794678
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0959198  Vali Loss: 0.0907489 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9665257  Vali macro F1 0.9506273 
new best score!!!!
Validation loss decreased (0.102761 --> 0.090749).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.981565475463867
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0944158  Vali Loss: 0.0998180 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9624072  Vali macro F1 0.9480148 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.986766576766968
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0856168  Vali Loss: 0.0893647 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9683433  Vali macro F1 0.9592705 
new best score!!!!
Validation loss decreased (0.090749 --> 0.089365).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.001509666442871
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0831830  Vali Loss: 0.1029459 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9615881  Vali macro F1 0.9444446 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.988604307174683
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0762015  Vali Loss: 0.0797112 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9704049  Vali macro F1 0.9548816 
new best score!!!!
Validation loss decreased (0.089365 --> 0.079711).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.985794305801392
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0778656  Vali Loss: 0.1065766 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9661522  Vali macro F1 0.9529880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.994096517562866
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0684289  Vali Loss: 0.0716868 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9749591  Vali macro F1 0.9627803 
new best score!!!!
Validation loss decreased (0.079711 --> 0.071687).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.976154327392578
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0675954  Vali Loss: 0.0757161 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9730862  Vali macro F1 0.9570907 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.975024700164795
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0584762  Vali Loss: 0.0786486 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9703202  Vali macro F1 0.9525528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.97046971321106
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0586148  Vali Loss: 0.1110766 Vali Accuracy: 0.9606013  Vali weighted F1: 0.9610976  Vali macro F1 0.9466688 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.988865852355957
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0625504  Vali Loss: 0.0688882 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762179  Vali macro F1 0.9625918 
new best score!!!!
Validation loss decreased (0.071687 --> 0.068888).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.007760286331177
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0516113  Vali Loss: 0.0792735 Vali Accuracy: 0.9709694  Vali weighted F1: 0.9713763  Vali macro F1 0.9563577 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.99250864982605
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0548387  Vali Loss: 0.0818024 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9732161  Vali macro F1 0.9614613 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.995729923248291
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0522834  Vali Loss: 0.0699843 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9771419  Vali macro F1 0.9658664 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.984839677810669
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0517968  Vali Loss: 0.0724749 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767503  Vali macro F1 0.9643135 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 5.979644060134888
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0485036  Vali Loss: 0.0678824 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9776609  Vali macro F1 0.9673473 
new best score!!!!
Validation loss decreased (0.068888 --> 0.067882).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.984477519989014
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0431498  Vali Loss: 0.0589423 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9796928  Vali macro F1 0.9687809 
new best score!!!!
Validation loss decreased (0.067882 --> 0.058942).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.9898481369018555
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0439027  Vali Loss: 0.0613761 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792116  Vali macro F1 0.9683765 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.995692729949951
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0368242  Vali Loss: 0.0543212 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813297  Vali macro F1 0.9710560 
new best score!!!!
Validation loss decreased (0.058942 --> 0.054321).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.009077787399292
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0370679  Vali Loss: 0.0630231 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808424  Vali macro F1 0.9702281 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.0021326541900635
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0414580  Vali Loss: 0.0659878 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9800871  Vali macro F1 0.9709544 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.987191438674927
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0500880  Vali Loss: 0.1556083 Vali Accuracy: 0.9574909  Vali weighted F1: 0.9555725  Vali macro F1 0.9449349 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.974496364593506
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0523724  Vali Loss: 0.0644688 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9791202  Vali macro F1 0.9684543 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.971392869949341
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0359722  Vali Loss: 0.0602532 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9803496  Vali macro F1 0.9649276 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 5.981164455413818
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0269296  Vali Loss: 0.0557299 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819122  Vali macro F1 0.9720019 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.988022804260254
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0243506  Vali Loss: 0.0553569 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818969  Vali macro F1 0.9725961 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.985204458236694
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0236753  Vali Loss: 0.0523490 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844844  Vali macro F1 0.9751988 
new best score!!!!
Validation loss decreased (0.054321 --> 0.052349).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.993688583374023
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0218103  Vali Loss: 0.0535871 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839720  Vali macro F1 0.9743816 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.000040769577026
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0224032  Vali Loss: 0.0529448 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849965  Vali macro F1 0.9763287 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.999912977218628
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0234263  Vali Loss: 0.0523947 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849965  Vali macro F1 0.9763287 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.981058359146118
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0207925  Vali Loss: 0.0537507 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855165  Vali macro F1 0.9771511 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.991067171096802
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0195620  Vali Loss: 0.0538352 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844694  Vali macro F1 0.9755028 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 5.982717275619507
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0200926  Vali Loss: 0.0533464 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855093  Vali macro F1 0.9771465 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.990008354187012
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0195817  Vali Loss: 0.0534288 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849893  Vali macro F1 0.9763244 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 5.980417013168335
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0194461  Vali Loss: 0.0533861 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855093  Vali macro F1 0.9771465 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 5.9887168407440186
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0197213  Vali Loss: 0.0534098 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849893  Vali macro F1 0.9763244 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 5.997403383255005
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0190604  Vali Loss: 0.0534357 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855093  Vali macro F1 0.9771465 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 5.996069669723511
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0190559  Vali Loss: 0.0534403 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855093  Vali macro F1 0.9771465 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 5.990857839584351
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0198443  Vali Loss: 0.0535052 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855093  Vali macro F1 0.9771465 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 5.9854443073272705
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0201096  Vali Loss: 0.0534995 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855093  Vali macro F1 0.9771465 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 5.985825061798096
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0196020  Vali Loss: 0.0535309 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855093  Vali macro F1 0.9771465 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 5.989473819732666
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0192460  Vali Loss: 0.0535457 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855093  Vali macro F1 0.9771465 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9416384  Test weighted F1: 0.9428901  Test macro F1 0.9084176 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.972486257553101
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0221942  Vali Loss: 0.0561387 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824158  Vali macro F1 0.9731922 
Validation loss decreased (inf --> 0.056139).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.96114182472229
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0231767  Vali Loss: 0.0523524 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823912  Vali macro F1 0.9730286 
new best score!!!!
Validation loss decreased (0.056139 --> 0.052352).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.980074644088745
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0218606  Vali Loss: 0.0532159 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860465  Vali macro F1 0.9776612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.988201379776001
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0209029  Vali Loss: 0.0531121 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855277  Vali macro F1 0.9768405 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.974704742431641
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0200063  Vali Loss: 0.0534595 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834224  Vali macro F1 0.9741500 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 5.9728007316589355
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0197442  Vali Loss: 0.0548447 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839591  Vali macro F1 0.9749826 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 5.9655537605285645
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0214678  Vali Loss: 0.0503798 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839117  Vali macro F1 0.9752464 
new best score!!!!
Validation loss decreased (0.052352 --> 0.050380).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 5.980366468429565
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0201647  Vali Loss: 0.0552663 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834914  Vali macro F1 0.9738965 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 5.972955942153931
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0196204  Vali Loss: 0.0522538 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865263  Vali macro F1 0.9780454 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 5.97822380065918
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0189457  Vali Loss: 0.0519495 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860465  Vali macro F1 0.9776612 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 5.973197937011719
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0188422  Vali Loss: 0.0524424 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9840231  Vali macro F1 0.9750539 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.014951944351196
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0189220  Vali Loss: 0.0533575 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865217  Vali macro F1 0.9781139 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 5.998027324676514
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0185329  Vali Loss: 0.0550335 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844134  Vali macro F1 0.9756627 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 5.982165098190308
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0186485  Vali Loss: 0.0551573 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829865  Vali macro F1 0.9734136 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 5.979254245758057
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0182347  Vali Loss: 0.0512318 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855356  Vali macro F1 0.9771675 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 5.985966920852661
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0163981  Vali Loss: 0.0526120 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9845094  Vali macro F1 0.9752001 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 5.990332841873169
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0175111  Vali Loss: 0.0528036 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844960  Vali macro F1 0.9752019 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 5.974088191986084
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0172743  Vali Loss: 0.0524807 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839267  Vali macro F1 0.9746402 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 5.974985599517822
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0157347  Vali Loss: 0.0518639 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855010  Vali macro F1 0.9768193 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 5.997107028961182
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0154175  Vali Loss: 0.0523288 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860211  Vali macro F1 0.9776418 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 5.988314390182495
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0164769  Vali Loss: 0.0532896 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844549  Vali macro F1 0.9754672 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 5.98517370223999
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0150561  Vali Loss: 0.0536292 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849615  Vali macro F1 0.9762826 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9445642  Test weighted F1: 0.9454945  Test macro F1 0.9149798 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.0001478  0.00018292 0.00097371 0.00126422 0.00049579 0.00061881]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.10251522064209
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2229536  Vali Loss: 0.8060467 Vali Accuracy: 0.6666667  Vali weighted F1: 0.5596821  Vali macro F1 0.2740618 
Validation loss decreased (inf --> 0.806047).  Saving model ...
Epoch: 2 cost time: 6.086627960205078
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6534427  Vali Loss: 0.5473614 Vali Accuracy: 0.7847328  Vali weighted F1: 0.7335848  Vali macro F1 0.5263605 
new best score!!!!
Validation loss decreased (0.806047 --> 0.547361).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.083222150802612
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4940803  Vali Loss: 0.3907076 Vali Accuracy: 0.8671756  Vali weighted F1: 0.8553625  Vali macro F1 0.8185900 
new best score!!!!
Validation loss decreased (0.547361 --> 0.390708).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.069985866546631
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3637539  Vali Loss: 0.3254436 Vali Accuracy: 0.8885496  Vali weighted F1: 0.8843266  Vali macro F1 0.8513426 
new best score!!!!
Validation loss decreased (0.390708 --> 0.325444).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.095097064971924
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2911257  Vali Loss: 0.2506147 Vali Accuracy: 0.9124682  Vali weighted F1: 0.9084051  Vali macro F1 0.8776424 
new best score!!!!
Validation loss decreased (0.325444 --> 0.250615).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.1110429763793945
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2358717  Vali Loss: 0.2260459 Vali Accuracy: 0.9246819  Vali weighted F1: 0.9218549  Vali macro F1 0.8987370 
new best score!!!!
Validation loss decreased (0.250615 --> 0.226046).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.119610786437988
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2111384  Vali Loss: 0.1890259 Vali Accuracy: 0.9379135  Vali weighted F1: 0.9364677  Vali macro F1 0.9169003 
new best score!!!!
Validation loss decreased (0.226046 --> 0.189026).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.09637975692749
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1879821  Vali Loss: 0.1698428 Vali Accuracy: 0.9404580  Vali weighted F1: 0.9397596  Vali macro F1 0.9214897 
new best score!!!!
Validation loss decreased (0.189026 --> 0.169843).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.099478244781494
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1692793  Vali Loss: 0.1652361 Vali Accuracy: 0.9424936  Vali weighted F1: 0.9416457  Vali macro F1 0.9242470 
new best score!!!!
Validation loss decreased (0.169843 --> 0.165236).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.101404666900635
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1634240  Vali Loss: 0.1953280 Vali Accuracy: 0.9368957  Vali weighted F1: 0.9357191  Vali macro F1 0.9215642 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.096746444702148
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1613263  Vali Loss: 0.1298225 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9570675  Vali macro F1 0.9435222 
new best score!!!!
Validation loss decreased (0.165236 --> 0.129822).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.092257499694824
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1391942  Vali Loss: 0.1196590 Vali Accuracy: 0.9592875  Vali weighted F1: 0.9592505  Vali macro F1 0.9469066 
new best score!!!!
Validation loss decreased (0.129822 --> 0.119659).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.090019464492798
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1315936  Vali Loss: 0.1122425 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9639303  Vali macro F1 0.9522933 
new best score!!!!
Validation loss decreased (0.119659 --> 0.112243).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.099957704544067
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1233668  Vali Loss: 0.1259111 Vali Accuracy: 0.9577608  Vali weighted F1: 0.9581983  Vali macro F1 0.9429143 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.12186861038208
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1155600  Vali Loss: 0.0976837 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9682767  Vali macro F1 0.9594497 
new best score!!!!
Validation loss decreased (0.112243 --> 0.097684).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.106958866119385
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1077874  Vali Loss: 0.0895268 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9687682  Vali macro F1 0.9583749 
new best score!!!!
Validation loss decreased (0.097684 --> 0.089527).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.101964950561523
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1024038  Vali Loss: 0.0931678 Vali Accuracy: 0.9659033  Vali weighted F1: 0.9654852  Vali macro F1 0.9539592 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.097588777542114
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0996334  Vali Loss: 0.0862020 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9685698  Vali macro F1 0.9572607 
new best score!!!!
Validation loss decreased (0.089527 --> 0.086202).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.102625846862793
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1016250  Vali Loss: 0.1161199 Vali Accuracy: 0.9567430  Vali weighted F1: 0.9557868  Vali macro F1 0.9389464 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.096079587936401
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0909776  Vali Loss: 0.0834783 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9707189  Vali macro F1 0.9594007 
new best score!!!!
Validation loss decreased (0.086202 --> 0.083478).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.091973543167114
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0825093  Vali Loss: 0.1144878 Vali Accuracy: 0.9608142  Vali weighted F1: 0.9600697  Vali macro F1 0.9466922 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.095219135284424
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0912105  Vali Loss: 0.0852925 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9744246  Vali macro F1 0.9641974 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.117528200149536
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0769074  Vali Loss: 0.0750980 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9757510  Vali macro F1 0.9673358 
new best score!!!!
Validation loss decreased (0.083478 --> 0.075098).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.108241319656372
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0718631  Vali Loss: 0.0841516 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9737877  Vali macro F1 0.9636046 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.083730459213257
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0681285  Vali Loss: 0.0875626 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9701374  Vali macro F1 0.9605217 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.087797164916992
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0671106  Vali Loss: 0.0816523 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9715758  Vali macro F1 0.9605966 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.089606761932373
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0742253  Vali Loss: 0.2299102 Vali Accuracy: 0.9206107  Vali weighted F1: 0.9222937  Vali macro F1 0.8997468 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.097317934036255
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0921473  Vali Loss: 0.0653967 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9790981  Vali macro F1 0.9704485 
new best score!!!!
Validation loss decreased (0.075098 --> 0.065397).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.115419626235962
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0557430  Vali Loss: 0.0589963 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9801760  Vali macro F1 0.9729284 
new best score!!!!
Validation loss decreased (0.065397 --> 0.058996).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.100515604019165
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0521198  Vali Loss: 0.0711039 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9811174  Vali macro F1 0.9728683 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.114485502243042
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0490276  Vali Loss: 0.0655089 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9789316  Vali macro F1 0.9729286 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.11396861076355
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0526834  Vali Loss: 0.0622506 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9821000  Vali macro F1 0.9749874 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.097838640213013
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0484753  Vali Loss: 0.0663482 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9782176  Vali macro F1 0.9699310 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.092639923095703
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0437275  Vali Loss: 0.0671856 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9820075  Vali macro F1 0.9751596 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.0914905071258545
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0378777  Vali Loss: 0.0575127 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9841987  Vali macro F1 0.9778759 
new best score!!!!
Validation loss decreased (0.058996 --> 0.057513).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.107487440109253
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0353735  Vali Loss: 0.0526648 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846645  Vali macro F1 0.9786469 
new best score!!!!
Validation loss decreased (0.057513 --> 0.052665).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.08507227897644
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0350728  Vali Loss: 0.0509021 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846720  Vali macro F1 0.9791552 
new best score!!!!
Validation loss decreased (0.052665 --> 0.050902).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.078164100646973
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0319570  Vali Loss: 0.0474974 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857148  Vali macro F1 0.9802877 
new best score!!!!
Validation loss decreased (0.050902 --> 0.047497).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.086994171142578
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0325650  Vali Loss: 0.0504600 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846847  Vali macro F1 0.9795087 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.10553503036499
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0313470  Vali Loss: 0.0476510 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862247  Vali macro F1 0.9811261 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.102633714675903
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0299956  Vali Loss: 0.0470792 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862261  Vali macro F1 0.9811232 
new best score!!!!
Validation loss decreased (0.047497 --> 0.047079).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.0918357372283936
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0289167  Vali Loss: 0.0470521 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862247  Vali macro F1 0.9811261 
new best score!!!!
Validation loss decreased (0.047079 --> 0.047052).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.08873987197876
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0294518  Vali Loss: 0.0487078 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846712  Vali macro F1 0.9791595 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.097807168960571
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0283951  Vali Loss: 0.0474463 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862247  Vali macro F1 0.9811261 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.08730936050415
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0269972  Vali Loss: 0.0508946 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842155  Vali macro F1 0.9784540 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.079457998275757
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0305707  Vali Loss: 0.0479213 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867475  Vali macro F1 0.9816585 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.0903706550598145
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0295422  Vali Loss: 0.0496222 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862295  Vali macro F1 0.9810843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 48 cost time: 6.09953761100769
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0289130  Vali Loss: 0.0487410 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857185  Vali macro F1 0.9802442 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.118170976638794
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0277545  Vali Loss: 0.0485237 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857185  Vali macro F1 0.9802442 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.104885101318359
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0283411  Vali Loss: 0.0483762 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851943  Vali macro F1 0.9797142 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.0916218757629395
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0290058  Vali Loss: 0.0482869 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857056  Vali macro F1 0.9805495 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.089084625244141
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0272689  Vali Loss: 0.0479594 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846949  Vali macro F1 0.9792047 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 53 cost time: 6.09321403503418
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0305473  Vali Loss: 0.0479577 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846949  Vali macro F1 0.9792047 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.096152305603027
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0276418  Vali Loss: 0.0478595 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846949  Vali macro F1 0.9792047 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.097977161407471
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0260519  Vali Loss: 0.0479002 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851943  Vali macro F1 0.9797142 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.0949387550354
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0260819  Vali Loss: 0.0478731 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851943  Vali macro F1 0.9797142 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.116724014282227
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0271159  Vali Loss: 0.0478608 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851943  Vali macro F1 0.9797142 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8798637  Test weighted F1: 0.8859128  Test macro F1 0.8757461 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.100579261779785
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0302981  Vali Loss: 0.0492591 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851943  Vali macro F1 0.9797086 
Validation loss decreased (inf --> 0.049259).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.088427305221558
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0289156  Vali Loss: 0.0487317 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846816  Vali macro F1 0.9788996 
new best score!!!!
Validation loss decreased (0.049259 --> 0.048732).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.082445383071899
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0285948  Vali Loss: 0.0538483 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9820438  Vali macro F1 0.9775061 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.063853979110718
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0281523  Vali Loss: 0.0474065 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846817  Vali macro F1 0.9788597 
new best score!!!!
Validation loss decreased (0.048732 --> 0.047407).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.093777179718018
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0278579  Vali Loss: 0.0480451 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847077  Vali macro F1 0.9797209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.0995190143585205
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0278156  Vali Loss: 0.0471434 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857298  Vali macro F1 0.9805686 
new best score!!!!
Validation loss decreased (0.047407 --> 0.047143).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.093404531478882
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0270808  Vali Loss: 0.0493241 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9826277  Vali macro F1 0.9772187 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.108737945556641
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0264808  Vali Loss: 0.0480982 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847076  Vali macro F1 0.9789082 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.107159852981567
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0282343  Vali Loss: 0.0505271 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836648  Vali macro F1 0.9778092 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.075804233551025
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0281710  Vali Loss: 0.0454458 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857391  Vali macro F1 0.9803425 
new best score!!!!
Validation loss decreased (0.047143 --> 0.045446).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.102735757827759
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0268744  Vali Loss: 0.0478748 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9841597  Vali macro F1 0.9782832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.106328010559082
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0263469  Vali Loss: 0.0457944 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857174  Vali macro F1 0.9808754 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.105058193206787
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0256213  Vali Loss: 0.0493363 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846642  Vali macro F1 0.9793893 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.914994239807129
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0247959  Vali Loss: 0.0454076 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857295  Vali macro F1 0.9806132 
new best score!!!!
Validation loss decreased (0.045446 --> 0.045408).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.146279573440552
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0261270  Vali Loss: 0.0483117 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857262  Vali macro F1 0.9799598 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.10962700843811
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0257867  Vali Loss: 0.0498581 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836670  Vali macro F1 0.9777906 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.0936455726623535
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0248421  Vali Loss: 0.0460991 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842100  Vali macro F1 0.9778242 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.095395803451538
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0254184  Vali Loss: 0.0498155 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9841597  Vali macro F1 0.9783181 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.0738842487335205
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0234120  Vali Loss: 0.0497183 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847096  Vali macro F1 0.9795119 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 20 cost time: 6.093826055526733
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0241224  Vali Loss: 0.0478553 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857265  Vali macro F1 0.9806001 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.085181474685669
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0254625  Vali Loss: 0.0483523 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852427  Vali macro F1 0.9792107 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.049546480178833
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0232617  Vali Loss: 0.0469724 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9841756  Vali macro F1 0.9786498 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.087446451187134
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0216269  Vali Loss: 0.0479809 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852032  Vali macro F1 0.9793855 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.054829120635986
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0210963  Vali Loss: 0.0474051 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9862381  Vali macro F1 0.9807820 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.0819690227508545
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0220159  Vali Loss: 0.0480624 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851943  Vali macro F1 0.9797086 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.050206422805786
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0211369  Vali Loss: 0.0471522 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851943  Vali macro F1 0.9797086 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.3005759716033936
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0214401  Vali Loss: 0.0467347 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846831  Vali macro F1 0.9788735 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.071459054946899
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0213899  Vali Loss: 0.0468023 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857148  Vali macro F1 0.9802877 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.052908897399902
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0209298  Vali Loss: 0.0471957 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836634  Vali macro F1 0.9777849 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8743948  Test weighted F1: 0.8809321  Test macro F1 0.8739669 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014943 0.00018335 0.00100705 0.00123609 0.00051813 0.00062696]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.045125722885132
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.2408826  Vali Loss: 0.7603837 Vali Accuracy: 0.6946447  Vali weighted F1: 0.5883091  Vali macro F1 0.2887779 
Validation loss decreased (inf --> 0.760384).  Saving model ...
Epoch: 2 cost time: 6.005986213684082
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.6928142  Vali Loss: 0.5600609 Vali Accuracy: 0.7857878  Vali weighted F1: 0.7296701  Vali macro F1 0.5149564 
new best score!!!!
Validation loss decreased (0.760384 --> 0.560061).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.992608547210693
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.5103966  Vali Loss: 0.3914457 Vali Accuracy: 0.8661174  Vali weighted F1: 0.8508866  Vali macro F1 0.7922611 
new best score!!!!
Validation loss decreased (0.560061 --> 0.391446).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.018213510513306
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.3369958  Vali Loss: 0.2580165 Vali Accuracy: 0.9145211  Vali weighted F1: 0.9157170  Vali macro F1 0.8703844 
new best score!!!!
Validation loss decreased (0.391446 --> 0.258016).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.987393379211426
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2618117  Vali Loss: 0.2140797 Vali Accuracy: 0.9273944  Vali weighted F1: 0.9279961  Vali macro F1 0.8882193 
new best score!!!!
Validation loss decreased (0.258016 --> 0.214080).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.982783794403076
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2238492  Vali Loss: 0.1821782 Vali Accuracy: 0.9407827  Vali weighted F1: 0.9406017  Vali macro F1 0.9031689 
new best score!!!!
Validation loss decreased (0.214080 --> 0.182178).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.986734628677368
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1984581  Vali Loss: 0.1689211 Vali Accuracy: 0.9392379  Vali weighted F1: 0.9385077  Vali macro F1 0.9007604 
new best score!!!!
Validation loss decreased (0.182178 --> 0.168921).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.990571022033691
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1820578  Vali Loss: 0.1519190 Vali Accuracy: 0.9449022  Vali weighted F1: 0.9442372  Vali macro F1 0.9076964 
new best score!!!!
Validation loss decreased (0.168921 --> 0.151919).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.021506071090698
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1749525  Vali Loss: 0.1456850 Vali Accuracy: 0.9521112  Vali weighted F1: 0.9519470  Vali macro F1 0.9184436 
new best score!!!!
Validation loss decreased (0.151919 --> 0.145685).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.993582010269165
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1555877  Vali Loss: 0.1315495 Vali Accuracy: 0.9536560  Vali weighted F1: 0.9533105  Vali macro F1 0.9224108 
new best score!!!!
Validation loss decreased (0.145685 --> 0.131549).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.989887475967407
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1459636  Vali Loss: 0.2884089 Vali Accuracy: 0.9155510  Vali weighted F1: 0.9117205  Vali macro F1 0.8811931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.986111640930176
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1625613  Vali Loss: 0.1253003 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9588892  Vali macro F1 0.9312770 
new best score!!!!
Validation loss decreased (0.131549 --> 0.125300).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.984881401062012
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1278768  Vali Loss: 0.1281445 Vali Accuracy: 0.9562307  Vali weighted F1: 0.9561531  Vali macro F1 0.9266433 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.992492198944092
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1216176  Vali Loss: 0.1078988 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9637341  Vali macro F1 0.9398739 
new best score!!!!
Validation loss decreased (0.125300 --> 0.107899).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.999662637710571
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1162103  Vali Loss: 0.1013104 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9669316  Vali macro F1 0.9479388 
new best score!!!!
Validation loss decreased (0.107899 --> 0.101310).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.986664533615112
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1108234  Vali Loss: 0.1201763 Vali Accuracy: 0.9572606  Vali weighted F1: 0.9572204  Vali macro F1 0.9259831 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.975614786148071
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1009260  Vali Loss: 0.0961721 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9678362  Vali macro F1 0.9457333 
new best score!!!!
Validation loss decreased (0.101310 --> 0.096172).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.985004663467407
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.1006507  Vali Loss: 0.0916500 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9716651  Vali macro F1 0.9503339 
new best score!!!!
Validation loss decreased (0.096172 --> 0.091650).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.970808744430542
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0981431  Vali Loss: 0.0935244 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9706708  Vali macro F1 0.9513973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.993037462234497
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0857357  Vali Loss: 0.0920367 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9700786  Vali macro F1 0.9488398 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.999402284622192
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0836542  Vali Loss: 0.0831383 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9722382  Vali macro F1 0.9518312 
new best score!!!!
Validation loss decreased (0.091650 --> 0.083138).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.985317945480347
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0839444  Vali Loss: 0.0687381 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773604  Vali macro F1 0.9620398 
new best score!!!!
Validation loss decreased (0.083138 --> 0.068738).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.992702484130859
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0813254  Vali Loss: 0.0883660 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9680106  Vali macro F1 0.9460162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.990282773971558
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0806067  Vali Loss: 0.0705164 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9742361  Vali macro F1 0.9563780 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.9846038818359375
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0706666  Vali Loss: 0.0694114 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800220  Vali macro F1 0.9671299 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.9851720333099365
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0726456  Vali Loss: 0.0698272 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789244  Vali macro F1 0.9662110 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.987434387207031
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0720576  Vali Loss: 0.0934155 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9694126  Vali macro F1 0.9514726 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 6.002401113510132
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0567908  Vali Loss: 0.0614436 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804506  Vali macro F1 0.9637852 
new best score!!!!
Validation loss decreased (0.068738 --> 0.061444).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.03108811378479
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0538097  Vali Loss: 0.0623591 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9779112  Vali macro F1 0.9594869 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.9926323890686035
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0525725  Vali Loss: 0.0603181 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789672  Vali macro F1 0.9612546 
new best score!!!!
Validation loss decreased (0.061444 --> 0.060318).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.00109601020813
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0497072  Vali Loss: 0.0592975 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804445  Vali macro F1 0.9677797 
new best score!!!!
Validation loss decreased (0.060318 --> 0.059298).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.9821131229400635
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0487596  Vali Loss: 0.0600140 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799150  Vali macro F1 0.9642361 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.991081714630127
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0458121  Vali Loss: 0.0596099 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819607  Vali macro F1 0.9699185 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.986613512039185
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0468334  Vali Loss: 0.0567788 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809521  Vali macro F1 0.9669346 
new best score!!!!
Validation loss decreased (0.059298 --> 0.056779).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.996075630187988
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0476669  Vali Loss: 0.0592235 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9803602  Vali macro F1 0.9686158 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.997464179992676
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0461245  Vali Loss: 0.0588111 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824687  Vali macro F1 0.9717962 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.00430154800415
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0463585  Vali Loss: 0.0605979 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809670  Vali macro F1 0.9679876 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 5.977651834487915
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0431869  Vali Loss: 0.0594795 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809202  Vali macro F1 0.9679192 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 5.991662502288818
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0464887  Vali Loss: 0.0574652 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820007  Vali macro F1 0.9694072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 5.980401515960693
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0426777  Vali Loss: 0.0576929 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809352  Vali macro F1 0.9682460 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.985397100448608
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0433940  Vali Loss: 0.0577668 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809177  Vali macro F1 0.9685168 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.9967124462127686
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0438597  Vali Loss: 0.0581225 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814423  Vali macro F1 0.9690482 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.002542495727539
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0444302  Vali Loss: 0.0577106 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814429  Vali macro F1 0.9701230 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.992129802703857
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0459132  Vali Loss: 0.0577424 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809280  Vali macro F1 0.9692641 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 6.0021443367004395
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0427279  Vali Loss: 0.0576969 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814429  Vali macro F1 0.9701230 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.99581503868103
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0429627  Vali Loss: 0.0575770 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814429  Vali macro F1 0.9701230 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.978501796722412
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0415631  Vali Loss: 0.0575798 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814429  Vali macro F1 0.9701230 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.9861836433410645
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0429887  Vali Loss: 0.0575342 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814429  Vali macro F1 0.9701230 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.9869704246521
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0439702  Vali Loss: 0.0575292 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814429  Vali macro F1 0.9701230 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9725516  Test weighted F1: 0.9714521  Test macro F1 0.9594654 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.0415449142456055
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0480374  Vali Loss: 0.0597023 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814783  Vali macro F1 0.9695926 
Validation loss decreased (inf --> 0.059702).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.011316537857056
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0462999  Vali Loss: 0.0587900 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9803926  Vali macro F1 0.9675903 
new best score!!!!
Validation loss decreased (0.059702 --> 0.058790).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.0150158405303955
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0459832  Vali Loss: 0.0576241 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829876  Vali macro F1 0.9710021 
new best score!!!!
Validation loss decreased (0.058790 --> 0.057624).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.023813247680664
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0467653  Vali Loss: 0.0609845 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814986  Vali macro F1 0.9695456 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.028862953186035
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0462631  Vali Loss: 0.0596230 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814219  Vali macro F1 0.9703634 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.020956754684448
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0472265  Vali Loss: 0.0600817 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9813927  Vali macro F1 0.9697174 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.019438743591309
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0422715  Vali Loss: 0.0578794 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814898  Vali macro F1 0.9677625 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.021924257278442
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0440851  Vali Loss: 0.0592967 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793409  Vali macro F1 0.9648374 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.0048508644104
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0434454  Vali Loss: 0.0566733 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9803802  Vali macro F1 0.9662617 
new best score!!!!
Validation loss decreased (0.057624 --> 0.056673).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.021178960800171
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0442964  Vali Loss: 0.0573747 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804605  Vali macro F1 0.9666632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.026455879211426
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0453261  Vali Loss: 0.0548355 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845419  Vali macro F1 0.9743341 
new best score!!!!
Validation loss decreased (0.056673 --> 0.054836).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.0441062450408936
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0425921  Vali Loss: 0.0624856 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804225  Vali macro F1 0.9680013 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.04986834526062
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0415241  Vali Loss: 0.0577604 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824802  Vali macro F1 0.9714824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.019275665283203
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0416286  Vali Loss: 0.0558033 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824926  Vali macro F1 0.9694551 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.011936664581299
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0418354  Vali Loss: 0.0634934 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819193  Vali macro F1 0.9709254 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.033132314682007
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0410682  Vali Loss: 0.0556476 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824682  Vali macro F1 0.9711601 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.036430358886719
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0404548  Vali Loss: 0.0557777 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824550  Vali macro F1 0.9708883 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.038640022277832
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0371273  Vali Loss: 0.0558612 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824550  Vali macro F1 0.9708883 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.035467624664307
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0371725  Vali Loss: 0.0562508 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829722  Vali macro F1 0.9717463 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.014703989028931
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0377189  Vali Loss: 0.0566716 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829556  Vali macro F1 0.9720143 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.017501592636108
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0393071  Vali Loss: 0.0563689 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9813933  Vali macro F1 0.9686718 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 6.037823915481567
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0380078  Vali Loss: 0.0562776 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9813933  Vali macro F1 0.9686718 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.012926340103149
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0379123  Vali Loss: 0.0561939 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9813933  Vali macro F1 0.9686718 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.029853582382202
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0372362  Vali Loss: 0.0561336 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824618  Vali macro F1 0.9698543 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.022168874740601
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0401578  Vali Loss: 0.0560596 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824618  Vali macro F1 0.9698543 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.022928476333618
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0382007  Vali Loss: 0.0560758 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824618  Vali macro F1 0.9698543 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9729576  Test weighted F1: 0.9720408  Test macro F1 0.9608957 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014941 0.00018685 0.00139276 0.00148368 0.00052743 0.00064599]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.808204174041748
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.2362077  Vali Loss: 0.8055458 Vali Accuracy: 0.6748401  Vali weighted F1: 0.5716816  Vali macro F1 0.2753961 
Validation loss decreased (inf --> 0.805546).  Saving model ...
Epoch: 2 cost time: 5.794555902481079
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.6466416  Vali Loss: 0.5360049 Vali Accuracy: 0.7873134  Vali weighted F1: 0.7428271  Vali macro F1 0.5323311 
new best score!!!!
Validation loss decreased (0.805546 --> 0.536005).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.817487478256226
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.4686266  Vali Loss: 0.4029242 Vali Accuracy: 0.8566098  Vali weighted F1: 0.8400763  Vali macro F1 0.7839217 
new best score!!!!
Validation loss decreased (0.536005 --> 0.402924).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.823639392852783
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.3490537  Vali Loss: 0.3061348 Vali Accuracy: 0.8896588  Vali weighted F1: 0.8817155  Vali macro F1 0.8494570 
new best score!!!!
Validation loss decreased (0.402924 --> 0.306135).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.814122676849365
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2929187  Vali Loss: 0.2861520 Vali Accuracy: 0.8971215  Vali weighted F1: 0.8891985  Vali macro F1 0.8577624 
new best score!!!!
Validation loss decreased (0.306135 --> 0.286152).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.810381174087524
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.2408749  Vali Loss: 0.2041604 Vali Accuracy: 0.9307036  Vali weighted F1: 0.9305643  Vali macro F1 0.9054729 
new best score!!!!
Validation loss decreased (0.286152 --> 0.204160).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.797850608825684
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.2030017  Vali Loss: 0.1759376 Vali Accuracy: 0.9355011  Vali weighted F1: 0.9361298  Vali macro F1 0.9133447 
new best score!!!!
Validation loss decreased (0.204160 --> 0.175938).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.811079740524292
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1825099  Vali Loss: 0.1736493 Vali Accuracy: 0.9413646  Vali weighted F1: 0.9410985  Vali macro F1 0.9184005 
new best score!!!!
Validation loss decreased (0.175938 --> 0.173649).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.795396566390991
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1575533  Vali Loss: 0.1734975 Vali Accuracy: 0.9440299  Vali weighted F1: 0.9444825  Vali macro F1 0.9243443 
new best score!!!!
Validation loss decreased (0.173649 --> 0.173498).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.805418014526367
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1540159  Vali Loss: 0.1297378 Vali Accuracy: 0.9520256  Vali weighted F1: 0.9525573  Vali macro F1 0.9325698 
new best score!!!!
Validation loss decreased (0.173498 --> 0.129738).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.807926654815674
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1425338  Vali Loss: 0.1429937 Vali Accuracy: 0.9488273  Vali weighted F1: 0.9476224  Vali macro F1 0.9325335 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.819421291351318
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1269644  Vali Loss: 0.1185141 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9573884  Vali macro F1 0.9446746 
new best score!!!!
Validation loss decreased (0.129738 --> 0.118514).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.814940690994263
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1186256  Vali Loss: 0.1057438 Vali Accuracy: 0.9632196  Vali weighted F1: 0.9633660  Vali macro F1 0.9520581 
new best score!!!!
Validation loss decreased (0.118514 --> 0.105744).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.8010289669036865
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1146376  Vali Loss: 0.1041756 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9616993  Vali macro F1 0.9498181 
new best score!!!!
Validation loss decreased (0.105744 --> 0.104176).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.791533946990967
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1065824  Vali Loss: 0.1073843 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9673505  Vali macro F1 0.9563367 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.788061618804932
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1044835  Vali Loss: 0.1153386 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9596505  Vali macro F1 0.9427933 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.794111728668213
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0949187  Vali Loss: 0.0936038 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9636158  Vali macro F1 0.9533360 
new best score!!!!
Validation loss decreased (0.104176 --> 0.093604).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.801560878753662
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1018857  Vali Loss: 0.1121079 Vali Accuracy: 0.9621535  Vali weighted F1: 0.9622640  Vali macro F1 0.9493420 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.797834396362305
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0911652  Vali Loss: 0.0971621 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9667486  Vali macro F1 0.9537927 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.813637971878052
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0824692  Vali Loss: 0.0880738 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9709569  Vali macro F1 0.9627996 
new best score!!!!
Validation loss decreased (0.093604 --> 0.088074).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.821778297424316
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0781053  Vali Loss: 0.0816321 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9735736  Vali macro F1 0.9678274 
new best score!!!!
Validation loss decreased (0.088074 --> 0.081632).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.812216281890869
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0769331  Vali Loss: 0.0916692 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9701288  Vali macro F1 0.9607424 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.798130512237549
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0699523  Vali Loss: 0.0835530 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9728431  Vali macro F1 0.9655307 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.798514127731323
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0716120  Vali Loss: 0.1127616 Vali Accuracy: 0.9632196  Vali weighted F1: 0.9629590  Vali macro F1 0.9555698 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.795430421829224
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0771118  Vali Loss: 0.0796025 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9744793  Vali macro F1 0.9673162 
new best score!!!!
Validation loss decreased (0.081632 --> 0.079602).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.8073225021362305
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0697202  Vali Loss: 0.0847544 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9755996  Vali macro F1 0.9687890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.813825368881226
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0622967  Vali Loss: 0.0781302 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9770559  Vali macro F1 0.9707896 
new best score!!!!
Validation loss decreased (0.079602 --> 0.078130).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.809295654296875
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0593592  Vali Loss: 0.0752176 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9748497  Vali macro F1 0.9681845 
new best score!!!!
Validation loss decreased (0.078130 --> 0.075218).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.8166868686676025
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0579288  Vali Loss: 0.0770120 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9752623  Vali macro F1 0.9687523 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.817383527755737
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0536432  Vali Loss: 0.0746688 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9744203  Vali macro F1 0.9671830 
new best score!!!!
Validation loss decreased (0.075218 --> 0.074669).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.831449747085571
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0538058  Vali Loss: 0.0708031 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9773592  Vali macro F1 0.9712924 
new best score!!!!
Validation loss decreased (0.074669 --> 0.070803).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.822467565536499
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0513589  Vali Loss: 0.0689792 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9776304  Vali macro F1 0.9712054 
new best score!!!!
Validation loss decreased (0.070803 --> 0.068979).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.803580045700073
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0463616  Vali Loss: 0.0694517 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9787922  Vali macro F1 0.9727276 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.797501802444458
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0563069  Vali Loss: 0.0753950 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9721973  Vali macro F1 0.9636141 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.798889636993408
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0427975  Vali Loss: 0.0760287 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9731265  Vali macro F1 0.9653218 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.803375959396362
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0476674  Vali Loss: 0.0798362 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9739341  Vali macro F1 0.9682568 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.8050572872161865
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0549791  Vali Loss: 0.0648109 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9793065  Vali macro F1 0.9723413 
new best score!!!!
Validation loss decreased (0.068979 --> 0.064811).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.829846620559692
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0421012  Vali Loss: 0.0756089 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9746032  Vali macro F1 0.9671160 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.825104236602783
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0436123  Vali Loss: 0.0604340 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9794221  Vali macro F1 0.9724252 
new best score!!!!
Validation loss decreased (0.064811 --> 0.060434).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.833238363265991
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0391875  Vali Loss: 0.0673364 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781993  Vali macro F1 0.9727051 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.820202112197876
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0386887  Vali Loss: 0.0639080 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9798723  Vali macro F1 0.9742639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.80156397819519
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0345241  Vali Loss: 0.0506408 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9825329  Vali macro F1 0.9761871 
new best score!!!!
Validation loss decreased (0.060434 --> 0.050641).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.813613414764404
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0324135  Vali Loss: 0.0587355 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792474  Vali macro F1 0.9727152 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.804869890213013
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0340492  Vali Loss: 0.0618377 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9809264  Vali macro F1 0.9750130 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 5.811328887939453
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0282622  Vali Loss: 0.0641925 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835916  Vali macro F1 0.9799924 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 5.813358545303345
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0307996  Vali Loss: 0.0691767 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9774358  Vali macro F1 0.9733137 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 5.821859836578369
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0281030  Vali Loss: 0.0504753 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802793  Vali macro F1 0.9750859 
new best score!!!!
Validation loss decreased (0.050641 --> 0.050475).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 5.826430559158325
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0272173  Vali Loss: 0.0505140 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862654  Vali macro F1 0.9829114 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.8053319454193115
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0318442  Vali Loss: 0.0623923 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824831  Vali macro F1 0.9753625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.804253578186035
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0337548  Vali Loss: 0.0715937 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782237  Vali macro F1 0.9725355 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.814248085021973
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0273436  Vali Loss: 0.0667481 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792579  Vali macro F1 0.9744299 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 5.81905460357666
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0243583  Vali Loss: 0.0628659 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814672  Vali macro F1 0.9776580 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 53 cost time: 5.816850185394287
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0173783  Vali Loss: 0.0468309 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9846110  Vali macro F1 0.9808514 
new best score!!!!
Validation loss decreased (0.050475 --> 0.046831).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 5.813992261886597
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0174225  Vali Loss: 0.0473977 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862253  Vali macro F1 0.9828064 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.813136339187622
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0153785  Vali Loss: 0.0492564 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856362  Vali macro F1 0.9818293 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 5.810860872268677
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0145607  Vali Loss: 0.0470808 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856470  Vali macro F1 0.9825954 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 5.823965787887573
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0140859  Vali Loss: 0.0448839 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862034  Vali macro F1 0.9827803 
new best score!!!!
Validation loss decreased (0.046831 --> 0.044884).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 5.812004804611206
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0140909  Vali Loss: 0.0486477 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851414  Vali macro F1 0.9817764 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 5.8056511878967285
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0140779  Vali Loss: 0.0458420 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851558  Vali macro F1 0.9814364 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 5.803131103515625
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0134336  Vali Loss: 0.0485753 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851788  Vali macro F1 0.9814730 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 5.808590412139893
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0131203  Vali Loss: 0.0475903 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856945  Vali macro F1 0.9826390 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 5.7996275424957275
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0139220  Vali Loss: 0.0485600 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862048  Vali macro F1 0.9827734 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 63 cost time: 5.800692558288574
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0125184  Vali Loss: 0.0476308 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862048  Vali macro F1 0.9827734 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 5.800070762634277
VALI: Epoch: 64, Steps: 66 | Train Loss: 0.0120850  Vali Loss: 0.0478061 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862048  Vali macro F1 0.9827734 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 5.813148260116577
VALI: Epoch: 65, Steps: 66 | Train Loss: 0.0130114  Vali Loss: 0.0474867 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851561  Vali macro F1 0.9814369 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 5.829590320587158
VALI: Epoch: 66, Steps: 66 | Train Loss: 0.0132013  Vali Loss: 0.0472939 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856756  Vali macro F1 0.9819160 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 5.802006483078003
VALI: Epoch: 67, Steps: 66 | Train Loss: 0.0128378  Vali Loss: 0.0471353 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856756  Vali macro F1 0.9819160 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 68 cost time: 5.801664113998413
VALI: Epoch: 68, Steps: 66 | Train Loss: 0.0122706  Vali Loss: 0.0471257 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856756  Vali macro F1 0.9819160 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 5.8087451457977295
VALI: Epoch: 69, Steps: 66 | Train Loss: 0.0120800  Vali Loss: 0.0471882 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856756  Vali macro F1 0.9819160 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 5.800459623336792
VALI: Epoch: 70, Steps: 66 | Train Loss: 0.0132351  Vali Loss: 0.0472275 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856756  Vali macro F1 0.9819160 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 5.8049070835113525
VALI: Epoch: 71, Steps: 66 | Train Loss: 0.0119888  Vali Loss: 0.0472678 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856756  Vali macro F1 0.9819160 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 5.797640562057495
VALI: Epoch: 72, Steps: 66 | Train Loss: 0.0125087  Vali Loss: 0.0473705 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856756  Vali macro F1 0.9819160 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8986547  Test weighted F1: 0.9028028  Test macro F1 0.8715269 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.857240438461304
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0136836  Vali Loss: 0.0483955 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851727  Vali macro F1 0.9820404 
Validation loss decreased (inf --> 0.048395).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.926372766494751
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0146661  Vali Loss: 0.0505579 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856281  Vali macro F1 0.9824734 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.971449375152588
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0140499  Vali Loss: 0.0477875 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9857328  Vali macro F1 0.9824531 
new best score!!!!
Validation loss decreased (0.048395 --> 0.047788).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 5.82430624961853
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0139524  Vali Loss: 0.0475046 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867805  Vali macro F1 0.9831197 
new best score!!!!
Validation loss decreased (0.047788 --> 0.047505).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 5.848877668380737
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0134031  Vali Loss: 0.0490075 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872619  Vali macro F1 0.9844849 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 5.840413808822632
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0128926  Vali Loss: 0.0470692 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9846500  Vali macro F1 0.9805974 
new best score!!!!
Validation loss decreased (0.047505 --> 0.047069).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 5.836470127105713
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0143464  Vali Loss: 0.0538982 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840595  Vali macro F1 0.9805465 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 5.832784652709961
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0144255  Vali Loss: 0.0483926 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9857149  Vali macro F1 0.9826968 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 5.826604843139648
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0132135  Vali Loss: 0.0475432 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829780  Vali macro F1 0.9797746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 5.845574378967285
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0121581  Vali Loss: 0.0486437 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9846118  Vali macro F1 0.9809018 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 5.840359210968018
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0117556  Vali Loss: 0.0497002 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862307  Vali macro F1 0.9831281 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 5.855432748794556
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0114792  Vali Loss: 0.0502959 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9857010  Vali macro F1 0.9822544 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 5.837850570678711
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0110283  Vali Loss: 0.0508044 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861915  Vali macro F1 0.9835091 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 5.838616847991943
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0110270  Vali Loss: 0.0484670 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872553  Vali macro F1 0.9841447 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 5.839668035507202
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0109711  Vali Loss: 0.0497284 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862022  Vali macro F1 0.9833348 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 5.831206321716309
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0132166  Vali Loss: 0.0494604 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861369  Vali macro F1 0.9833292 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 5.84412145614624
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0110252  Vali Loss: 0.0467558 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867190  Vali macro F1 0.9839685 
new best score!!!!
Validation loss decreased (0.047069 --> 0.046756).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 5.834728240966797
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0100428  Vali Loss: 0.0471063 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861752  Vali macro F1 0.9834504 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 5.850582838058472
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0114129  Vali Loss: 0.0469327 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878200  Vali macro F1 0.9850511 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 5.851258039474487
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0104046  Vali Loss: 0.0465495 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872797  Vali macro F1 0.9845384 
new best score!!!!
Validation loss decreased (0.046756 --> 0.046549).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 5.847789287567139
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0097893  Vali Loss: 0.0466931 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872984  Vali macro F1 0.9845442 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 5.847715616226196
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0101044  Vali Loss: 0.0470364 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883424  Vali macro F1 0.9855593 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 5.838578224182129
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0103587  Vali Loss: 0.0466069 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872607  Vali macro F1 0.9845323 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 5.8488380908966064
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0098470  Vali Loss: 0.0463245 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883424  Vali macro F1 0.9855593 
new best score!!!!
Validation loss decreased (0.046549 --> 0.046325).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 5.839022636413574
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0106120  Vali Loss: 0.0465189 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9866987  Vali macro F1 0.9839599 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 5.844883680343628
Fine Tuning VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0100047  Vali Loss: 0.0466924 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872609  Vali macro F1 0.9845084 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 5.829554557800293
Fine Tuning VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0100623  Vali Loss: 0.0467865 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872609  Vali macro F1 0.9845084 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 5.837082624435425
Fine Tuning VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0103323  Vali Loss: 0.0474147 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872797  Vali macro F1 0.9845384 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 5.8537797927856445
Fine Tuning VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0111593  Vali Loss: 0.0474778 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872797  Vali macro F1 0.9845384 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 5.830676555633545
Fine Tuning VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0100764  Vali Loss: 0.0474891 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 5.824927806854248
Fine Tuning VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0092885  Vali Loss: 0.0474633 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 5.82949686050415
Fine Tuning VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0094216  Vali Loss: 0.0474676 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 5.835432529449463
Fine Tuning VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0095528  Vali Loss: 0.0474715 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 5.840262174606323
Fine Tuning VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0090520  Vali Loss: 0.0475491 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 35 cost time: 5.834296941757202
Fine Tuning VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0097745  Vali Loss: 0.0475521 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 5.8237152099609375
Fine Tuning VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0105991  Vali Loss: 0.0475335 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 5.847668409347534
Fine Tuning VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0098338  Vali Loss: 0.0475196 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 5.868311166763306
Fine Tuning VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0099647  Vali Loss: 0.0475084 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 5.839537143707275
Fine Tuning VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0100558  Vali Loss: 0.0474949 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878020  Vali macro F1 0.9850467 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8906470  Test weighted F1: 0.8961587  Test macro F1 0.8628128 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001418  0.00018584 0.00096061 0.00123305 0.00052826 0.00064267]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.112918138504028
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2395211  Vali Loss: 0.7522904 Vali Accuracy: 0.7011669  Vali weighted F1: 0.5957586  Vali macro F1 0.2809957 
Validation loss decreased (inf --> 0.752290).  Saving model ...
Epoch: 2 cost time: 6.117908477783203
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6643140  Vali Loss: 0.5802131 Vali Accuracy: 0.7721969  Vali weighted F1: 0.7477558  Vali macro F1 0.5488658 
new best score!!!!
Validation loss decreased (0.752290 --> 0.580213).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.11636209487915
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4711671  Vali Loss: 0.3634658 Vali Accuracy: 0.8762050  Vali weighted F1: 0.8623936  Vali macro F1 0.8252823 
new best score!!!!
Validation loss decreased (0.580213 --> 0.363466).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.105108022689819
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3264845  Vali Loss: 0.2653987 Vali Accuracy: 0.9152714  Vali weighted F1: 0.9102656  Vali macro F1 0.8816930 
new best score!!!!
Validation loss decreased (0.363466 --> 0.265399).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.119842052459717
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2359422  Vali Loss: 0.1985025 Vali Accuracy: 0.9365804  Vali weighted F1: 0.9340387  Vali macro F1 0.9114963 
new best score!!!!
Validation loss decreased (0.265399 --> 0.198502).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.135415315628052
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2043901  Vali Loss: 0.1903741 Vali Accuracy: 0.9411466  Vali weighted F1: 0.9417977  Vali macro F1 0.9171697 
new best score!!!!
Validation loss decreased (0.198502 --> 0.190374).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.139508962631226
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1892132  Vali Loss: 0.1597480 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9478646  Vali macro F1 0.9272131 
new best score!!!!
Validation loss decreased (0.190374 --> 0.159748).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.137942314147949
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1700459  Vali Loss: 0.1568243 Vali Accuracy: 0.9482496  Vali weighted F1: 0.9483160  Vali macro F1 0.9257656 
new best score!!!!
Validation loss decreased (0.159748 --> 0.156824).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.133367300033569
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1578176  Vali Loss: 0.1355236 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9589342  Vali macro F1 0.9406387 
new best score!!!!
Validation loss decreased (0.156824 --> 0.135524).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.125092506408691
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1448698  Vali Loss: 0.1067455 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9637216  Vali macro F1 0.9469643 
new best score!!!!
Validation loss decreased (0.135524 --> 0.106745).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.128725051879883
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1302074  Vali Loss: 0.1070595 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9651318  Vali macro F1 0.9496179 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.111886262893677
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1182299  Vali Loss: 0.1003622 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9644632  Vali macro F1 0.9486126 
new best score!!!!
Validation loss decreased (0.106745 --> 0.100362).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.111638784408569
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1127655  Vali Loss: 0.0921767 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9656886  Vali macro F1 0.9499370 
new best score!!!!
Validation loss decreased (0.100362 --> 0.092177).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.114649772644043
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1119017  Vali Loss: 0.1052204 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9636537  Vali macro F1 0.9480897 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.128336429595947
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1013682  Vali Loss: 0.0864314 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9698829  Vali macro F1 0.9542253 
new best score!!!!
Validation loss decreased (0.092177 --> 0.086431).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.114420175552368
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1001897  Vali Loss: 0.0927233 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9666366  Vali macro F1 0.9512065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.116966724395752
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0949652  Vali Loss: 0.0764860 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9750965  Vali macro F1 0.9635046 
new best score!!!!
Validation loss decreased (0.086431 --> 0.076486).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.102958679199219
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0819401  Vali Loss: 0.1044599 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9650813  Vali macro F1 0.9512761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.1108558177948
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0860701  Vali Loss: 0.0709046 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9751658  Vali macro F1 0.9610809 
new best score!!!!
Validation loss decreased (0.076486 --> 0.070905).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.110093593597412
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0768409  Vali Loss: 0.0672965 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9770812  Vali macro F1 0.9660969 
new best score!!!!
Validation loss decreased (0.070905 --> 0.067296).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.103253602981567
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0692144  Vali Loss: 0.0765456 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9719400  Vali macro F1 0.9583578 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.1128973960876465
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0723524  Vali Loss: 0.0525253 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837488  Vali macro F1 0.9731680 
new best score!!!!
Validation loss decreased (0.067296 --> 0.052525).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.109999179840088
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0680263  Vali Loss: 0.0584561 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797176  Vali macro F1 0.9681102 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.125014781951904
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0693462  Vali Loss: 0.0639433 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9758785  Vali macro F1 0.9627708 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.108009338378906
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0639666  Vali Loss: 0.0533116 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837461  Vali macro F1 0.9739695 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.116300106048584
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0641770  Vali Loss: 0.0594809 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9810470  Vali macro F1 0.9729772 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 6.117237567901611
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0610599  Vali Loss: 0.0429841 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863104  Vali macro F1 0.9805070 
new best score!!!!
Validation loss decreased (0.052525 --> 0.042984).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.125088691711426
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0561266  Vali Loss: 0.0751180 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9752112  Vali macro F1 0.9625097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.11992073059082
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0598308  Vali Loss: 0.0787156 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9755972  Vali macro F1 0.9656425 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.124450922012329
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0542765  Vali Loss: 0.0451168 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862751  Vali macro F1 0.9820344 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.133633136749268
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0490171  Vali Loss: 0.0454874 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852341  Vali macro F1 0.9824693 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.129437446594238
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0438922  Vali Loss: 0.0456716 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857289  Vali macro F1 0.9813968 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 6.117480754852295
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0354813  Vali Loss: 0.0430255 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883017  Vali macro F1 0.9842055 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.108258008956909
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0335951  Vali Loss: 0.0424231 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883098  Vali macro F1 0.9845066 
new best score!!!!
Validation loss decreased (0.042984 --> 0.042423).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.10285758972168
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0308193  Vali Loss: 0.0430512 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9877954  Vali macro F1 0.9839675 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.10751485824585
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0316851  Vali Loss: 0.0405485 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888281  Vali macro F1 0.9850822 
new best score!!!!
Validation loss decreased (0.042423 --> 0.040549).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.120754718780518
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0306607  Vali Loss: 0.0407081 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9877954  Vali macro F1 0.9839675 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.115233659744263
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0309579  Vali Loss: 0.0411490 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878045  Vali macro F1 0.9833370 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.121252059936523
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0323172  Vali Loss: 0.0405554 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878055  Vali macro F1 0.9836809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.127882242202759
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0307328  Vali Loss: 0.0400582 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883051  Vali macro F1 0.9844962 
new best score!!!!
Validation loss decreased (0.040549 --> 0.040058).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.120572566986084
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0304151  Vali Loss: 0.0401589 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883215  Vali macro F1 0.9842223 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.122791528701782
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0289276  Vali Loss: 0.0409492 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878084  Vali macro F1 0.9833464 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 7.499709844589233
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0298578  Vali Loss: 0.0421371 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9877954  Vali macro F1 0.9839675 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.140665292739868
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0285676  Vali Loss: 0.0384809 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883098  Vali macro F1 0.9845066 
new best score!!!!
Validation loss decreased (0.040058 --> 0.038481).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 11.277928352355957
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0286301  Vali Loss: 0.0412238 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872800  Vali macro F1 0.9834263 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.110064506530762
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0269936  Vali Loss: 0.0412631 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873024  Vali macro F1 0.9831310 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.122095584869385
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0289268  Vali Loss: 0.0429037 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9877860  Vali macro F1 0.9833034 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.141149997711182
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0272424  Vali Loss: 0.0378889 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888321  Vali macro F1 0.9847518 
new best score!!!!
Validation loss decreased (0.038481 --> 0.037889).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.1346728801727295
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0274488  Vali Loss: 0.0421052 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872938  Vali macro F1 0.9828072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.126418590545654
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0277163  Vali Loss: 0.0395322 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888321  Vali macro F1 0.9847518 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.1264073848724365
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0271386  Vali Loss: 0.0386448 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883035  Vali macro F1 0.9844656 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.132006406784058
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0262278  Vali Loss: 0.0382451 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883134  Vali macro F1 0.9845429 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.113345384597778
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0263176  Vali Loss: 0.0370566 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893418  Vali macro F1 0.9856195 
new best score!!!!
Validation loss decreased (0.037889 --> 0.037057).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 6.126569747924805
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0259487  Vali Loss: 0.0393365 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888281  Vali macro F1 0.9850822 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.109255790710449
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0262483  Vali Loss: 0.0399832 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888232  Vali macro F1 0.9850437 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.126128673553467
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0260773  Vali Loss: 0.0386594 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878084  Vali macro F1 0.9833464 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.1428539752960205
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0271229  Vali Loss: 0.0370194 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883120  Vali macro F1 0.9841735 
new best score!!!!
Validation loss decreased (0.037057 --> 0.037019).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.130118370056152
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0263271  Vali Loss: 0.0401433 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888300  Vali macro F1 0.9851055 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.120805978775024
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0248754  Vali Loss: 0.0399348 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883098  Vali macro F1 0.9845066 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.11458683013916
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0257679  Vali Loss: 0.0363655 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893267  Vali macro F1 0.9856203 
new best score!!!!
Validation loss decreased (0.037019 --> 0.036366).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 6.123209714889526
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0255783  Vali Loss: 0.0396008 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9882942  Vali macro F1 0.9845054 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.118780851364136
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0259438  Vali Loss: 0.0400971 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872895  Vali macro F1 0.9827891 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.1177732944488525
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0246812  Vali Loss: 0.0379263 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888139  Vali macro F1 0.9850755 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.121359348297119
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0251720  Vali Loss: 0.0377958 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9877903  Vali macro F1 0.9843251 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.131600618362427
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0235530  Vali Loss: 0.0347486 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893150  Vali macro F1 0.9858837 
new best score!!!!
Validation loss decreased (0.036366 --> 0.034749).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 6.148072719573975
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0247594  Vali Loss: 0.0392065 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888422  Vali macro F1 0.9844546 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 6.113671064376831
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0245842  Vali Loss: 0.0353168 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893528  Vali macro F1 0.9853735 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 6.121999502182007
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0245545  Vali Loss: 0.0353419 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903080  Vali macro F1 0.9863365 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 6.134308576583862
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0248380  Vali Loss: 0.0374068 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872982  Vali macro F1 0.9834242 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 6.12310791015625
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0238763  Vali Loss: 0.0368955 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893064  Vali macro F1 0.9855537 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 71 cost time: 6.114785194396973
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0220187  Vali Loss: 0.0368013 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883083  Vali macro F1 0.9844835 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 6.1297595500946045
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0242730  Vali Loss: 0.0376214 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888172  Vali macro F1 0.9847525 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 6.132843255996704
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0215997  Vali Loss: 0.0366696 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888281  Vali macro F1 0.9850822 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 6.141180753707886
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0222243  Vali Loss: 0.0371354 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883184  Vali macro F1 0.9842146 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 6.125135660171509
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0241172  Vali Loss: 0.0369456 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883184  Vali macro F1 0.9842146 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 76 cost time: 6.115711688995361
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0222572  Vali Loss: 0.0370204 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883184  Vali macro F1 0.9842146 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 6.104485034942627
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0212539  Vali Loss: 0.0368273 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883184  Vali macro F1 0.9842146 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 6.109105825424194
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0224303  Vali Loss: 0.0367072 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883184  Vali macro F1 0.9842146 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 6.069272756576538
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0218817  Vali Loss: 0.0367333 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883184  Vali macro F1 0.9842146 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 6.07176947593689
VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0204395  Vali Loss: 0.0366228 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883184  Vali macro F1 0.9842146 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9176319  Test weighted F1: 0.9159841  Test macro F1 0.9073657 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.1423163414001465
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0236037  Vali Loss: 0.0349297 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898606  Vali macro F1 0.9862158 
Validation loss decreased (inf --> 0.034930).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.149028301239014
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0246590  Vali Loss: 0.0361277 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903186  Vali macro F1 0.9869885 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.101289749145508
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0226151  Vali Loss: 0.0377941 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867636  Vali macro F1 0.9828830 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.1008219718933105
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0239744  Vali Loss: 0.0358708 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888321  Vali macro F1 0.9847518 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.116387367248535
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0224566  Vali Loss: 0.0370517 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893270  Vali macro F1 0.9856203 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.124321460723877
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0220658  Vali Loss: 0.0362760 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883486  Vali macro F1 0.9839814 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.117268085479736
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0221845  Vali Loss: 0.0348111 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888560  Vali macro F1 0.9848452 
new best score!!!!
Validation loss decreased (0.034930 --> 0.034811).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.12328839302063
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0226132  Vali Loss: 0.0394985 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873111  Vali macro F1 0.9832047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.125298738479614
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0219409  Vali Loss: 0.0391327 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872844  Vali macro F1 0.9834551 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.138990163803101
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0230699  Vali Loss: 0.0365211 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883407  Vali macro F1 0.9842775 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.143346071243286
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0235864  Vali Loss: 0.0357573 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872876  Vali macro F1 0.9831055 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.124020338058472
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0204402  Vali Loss: 0.0384614 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9882833  Vali macro F1 0.9838544 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.123600959777832
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0200477  Vali Loss: 0.0381991 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888155  Vali macro F1 0.9847218 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.125314712524414
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0194389  Vali Loss: 0.0376838 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883180  Vali macro F1 0.9841861 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.129531621932983
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0203269  Vali Loss: 0.0375035 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883180  Vali macro F1 0.9841861 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.117764472961426
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0221924  Vali Loss: 0.0381372 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888232  Vali macro F1 0.9850437 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.126440048217773
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0204862  Vali Loss: 0.0370687 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888232  Vali macro F1 0.9850437 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 18 cost time: 6.135107755661011
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0202258  Vali Loss: 0.0371070 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888232  Vali macro F1 0.9850437 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.148978233337402
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0205597  Vali Loss: 0.0371676 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888232  Vali macro F1 0.9850437 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.149477005004883
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0197471  Vali Loss: 0.0370650 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888232  Vali macro F1 0.9850437 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.1163880825042725
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0198943  Vali Loss: 0.0370878 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888232  Vali macro F1 0.9850437 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.119202136993408
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0197256  Vali Loss: 0.0371441 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888232  Vali macro F1 0.9850437 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9160691  Test weighted F1: 0.9142532  Test macro F1 0.9050420 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014192 0.00017857 0.00096712 0.00121803 0.00047893 0.00060533]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.281822919845581
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.2171605  Vali Loss: 0.7519937 Vali Accuracy: 0.6803157  Vali weighted F1: 0.5701405  Vali macro F1 0.2826969 
Validation loss decreased (inf --> 0.751994).  Saving model ...
Epoch: 2 cost time: 6.280993223190308
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.6434992  Vali Loss: 0.5545860 Vali Accuracy: 0.7873705  Vali weighted F1: 0.7429971  Vali macro F1 0.5514554 
new best score!!!!
Validation loss decreased (0.751994 --> 0.554586).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.27899432182312
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.4736424  Vali Loss: 0.3526838 Vali Accuracy: 0.8820918  Vali weighted F1: 0.8708566  Vali macro F1 0.8389409 
new best score!!!!
Validation loss decreased (0.554586 --> 0.352684).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2946295738220215
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.3392797  Vali Loss: 0.2694166 Vali Accuracy: 0.9047854  Vali weighted F1: 0.8963436  Vali macro F1 0.8651767 
new best score!!!!
Validation loss decreased (0.352684 --> 0.269417).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.297385931015015
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2558029  Vali Loss: 0.2091341 Vali Accuracy: 0.9289591  Vali weighted F1: 0.9266462  Vali macro F1 0.9090724 
new best score!!!!
Validation loss decreased (0.269417 --> 0.209134).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.273212909698486
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.2046032  Vali Loss: 0.1571834 Vali Accuracy: 0.9501727  Vali weighted F1: 0.9506580  Vali macro F1 0.9373335 
new best score!!!!
Validation loss decreased (0.209134 --> 0.157183).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.272945165634155
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1742364  Vali Loss: 0.1454013 Vali Accuracy: 0.9506660  Vali weighted F1: 0.9501459  Vali macro F1 0.9361948 
new best score!!!!
Validation loss decreased (0.157183 --> 0.145401).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.289520263671875
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1604543  Vali Loss: 0.1413912 Vali Accuracy: 0.9536260  Vali weighted F1: 0.9540704  Vali macro F1 0.9396623 
new best score!!!!
Validation loss decreased (0.145401 --> 0.141391).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.29877781867981
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1436012  Vali Loss: 0.1533958 Vali Accuracy: 0.9491860  Vali weighted F1: 0.9489406  Vali macro F1 0.9332345 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.281681060791016
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1364056  Vali Loss: 0.1249357 Vali Accuracy: 0.9629995  Vali weighted F1: 0.9627974  Vali macro F1 0.9516198 
new best score!!!!
Validation loss decreased (0.141391 --> 0.124936).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.284268140792847
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1269087  Vali Loss: 0.1058601 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9652007  Vali macro F1 0.9533684 
new best score!!!!
Validation loss decreased (0.124936 --> 0.105860).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.294466018676758
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1148349  Vali Loss: 0.1080340 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9647284  Vali macro F1 0.9539640 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.312913656234741
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1200542  Vali Loss: 0.1075163 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9682083  Vali macro F1 0.9605793 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.275134563446045
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1042410  Vali Loss: 0.0889515 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9729324  Vali macro F1 0.9660809 
new best score!!!!
Validation loss decreased (0.105860 --> 0.088952).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.279160976409912
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0962363  Vali Loss: 0.0935921 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9717929  Vali macro F1 0.9640701 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.2818684577941895
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0893371  Vali Loss: 0.0866909 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9758960  Vali macro F1 0.9692886 
new best score!!!!
Validation loss decreased (0.088952 --> 0.086691).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.2847535610198975
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0848829  Vali Loss: 0.0855787 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9740108  Vali macro F1 0.9664248 
new best score!!!!
Validation loss decreased (0.086691 --> 0.085579).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.288965225219727
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0837443  Vali Loss: 0.0885296 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9708054  Vali macro F1 0.9628856 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.275207757949829
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0776687  Vali Loss: 0.0765468 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9778122  Vali macro F1 0.9716475 
new best score!!!!
Validation loss decreased (0.085579 --> 0.076547).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.271109342575073
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0740741  Vali Loss: 0.0901171 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9730722  Vali macro F1 0.9665004 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.293121814727783
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0731611  Vali Loss: 0.0825325 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9751419  Vali macro F1 0.9692575 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.300806045532227
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0740546  Vali Loss: 0.0757610 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9784068  Vali macro F1 0.9721039 
new best score!!!!
Validation loss decreased (0.076547 --> 0.075761).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.2856550216674805
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0675657  Vali Loss: 0.0688043 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807855  Vali macro F1 0.9735467 
new best score!!!!
Validation loss decreased (0.075761 --> 0.068804).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.28701114654541
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0646214  Vali Loss: 0.0728897 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9751757  Vali macro F1 0.9670475 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.280054330825806
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0678514  Vali Loss: 0.0680814 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813594  Vali macro F1 0.9762787 
new best score!!!!
Validation loss decreased (0.068804 --> 0.068081).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.270251512527466
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0550163  Vali Loss: 0.0713801 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9779151  Vali macro F1 0.9689576 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.2785608768463135
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0587312  Vali Loss: 0.0623141 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822685  Vali macro F1 0.9766157 
new best score!!!!
Validation loss decreased (0.068081 --> 0.062314).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.284379243850708
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0517781  Vali Loss: 0.0565326 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9823728  Vali macro F1 0.9769696 
new best score!!!!
Validation loss decreased (0.062314 --> 0.056533).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.309527635574341
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0492877  Vali Loss: 0.0682105 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812009  Vali macro F1 0.9747750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.289161443710327
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0502972  Vali Loss: 0.0686201 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9813798  Vali macro F1 0.9755706 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.287705659866333
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0454736  Vali Loss: 0.0612672 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9809527  Vali macro F1 0.9741398 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.275102138519287
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0441812  Vali Loss: 0.0588710 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812619  Vali macro F1 0.9749419 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.269795656204224
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0412945  Vali Loss: 0.0644040 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9833195  Vali macro F1 0.9775448 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 6.270507097244263
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0336499  Vali Loss: 0.0592654 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837532  Vali macro F1 0.9769244 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.2626354694366455
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0307948  Vali Loss: 0.0579207 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9784902 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.272597312927246
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0298733  Vali Loss: 0.0573795 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842661  Vali macro F1 0.9780487 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.2906036376953125
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0278823  Vali Loss: 0.0557244 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837833  Vali macro F1 0.9774990 
new best score!!!!
Validation loss decreased (0.056533 --> 0.055724).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.307023763656616
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0264846  Vali Loss: 0.0571572 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.27736496925354
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0280715  Vali Loss: 0.0570494 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852589  Vali macro F1 0.9794028 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.284727334976196
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0274057  Vali Loss: 0.0573149 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852165  Vali macro F1 0.9795937 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.286239862442017
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0270938  Vali Loss: 0.0568306 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.296760559082031
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0271727  Vali Loss: 0.0599521 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812257  Vali macro F1 0.9744304 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 6.288600921630859
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0261924  Vali Loss: 0.0580486 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827391  Vali macro F1 0.9761983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.28740930557251
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0254209  Vali Loss: 0.0568131 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842538  Vali macro F1 0.9777232 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.293509244918823
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0254765  Vali Loss: 0.0563565 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.314752817153931
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0266731  Vali Loss: 0.0562926 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842538  Vali macro F1 0.9777232 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.281667232513428
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0264630  Vali Loss: 0.0564398 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 48 cost time: 6.276564598083496
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0268262  Vali Loss: 0.0563577 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.272960901260376
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0251296  Vali Loss: 0.0565003 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.285275220870972
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0251999  Vali Loss: 0.0564942 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.294235467910767
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0252576  Vali Loss: 0.0563655 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.275787591934204
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0253788  Vali Loss: 0.0564431 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8810321  Test weighted F1: 0.8730992  Test macro F1 0.6643957 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.299914360046387
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0281423  Vali Loss: 0.0534948 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842856  Vali macro F1 0.9786345 
Validation loss decreased (inf --> 0.053495).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.333937883377075
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0264059  Vali Loss: 0.0545898 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852585  Vali macro F1 0.9794290 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.315224885940552
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0265253  Vali Loss: 0.0547979 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847448  Vali macro F1 0.9785166 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.308277606964111
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0252355  Vali Loss: 0.0585582 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832282  Vali macro F1 0.9763845 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.28735876083374
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0268018  Vali Loss: 0.0578647 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827705  Vali macro F1 0.9756912 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.28589653968811
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0264314  Vali Loss: 0.0585751 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837262  Vali macro F1 0.9777847 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.285317420959473
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0268607  Vali Loss: 0.0575062 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822321  Vali macro F1 0.9756281 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.2829084396362305
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0256778  Vali Loss: 0.0587356 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847109  Vali macro F1 0.9790577 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.304405689239502
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0271669  Vali Loss: 0.0547787 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852209  Vali macro F1 0.9804102 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.317144870758057
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0239798  Vali Loss: 0.0541931 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852354  Vali macro F1 0.9792826 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.3250768184661865
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0229026  Vali Loss: 0.0554814 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9851972  Vali macro F1 0.9795565 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.2849977016448975
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0239469  Vali Loss: 0.0562530 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9851581  Vali macro F1 0.9798008 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.2995524406433105
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0224903  Vali Loss: 0.0554896 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856879  Vali macro F1 0.9803483 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.278045415878296
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0241558  Vali Loss: 0.0551203 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857172  Vali macro F1 0.9797743 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.2982447147369385
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0253752  Vali Loss: 0.0556799 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856879  Vali macro F1 0.9803483 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.4220051765441895
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0244158  Vali Loss: 0.0552443 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9856879  Vali macro F1 0.9803483 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8812802  Test weighted F1: 0.8736498  Test macro F1 0.6650619 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014422 0.00016992 0.000999   0.00131579 0.00050025 0.00062814]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.264708042144775
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.2064977  Vali Loss: 0.7389426 Vali Accuracy: 0.6998514  Vali weighted F1: 0.5947202  Vali macro F1 0.2825265 
Validation loss decreased (inf --> 0.738943).  Saving model ...
Epoch: 2 cost time: 6.264133930206299
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.6335712  Vali Loss: 0.5156892 Vali Accuracy: 0.8058445  Vali weighted F1: 0.7632090  Vali macro F1 0.5482424 
new best score!!!!
Validation loss decreased (0.738943 --> 0.515689).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.247722387313843
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4510731  Vali Loss: 0.3532147 Vali Accuracy: 0.8786528  Vali weighted F1: 0.8671564  Vali macro F1 0.8200311 
new best score!!!!
Validation loss decreased (0.515689 --> 0.353215).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.225725173950195
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3354753  Vali Loss: 0.2620517 Vali Accuracy: 0.9068846  Vali weighted F1: 0.9031655  Vali macro F1 0.8663564 
new best score!!!!
Validation loss decreased (0.353215 --> 0.262052).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.239943981170654
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2608252  Vali Loss: 0.2045519 Vali Accuracy: 0.9276870  Vali weighted F1: 0.9266819  Vali macro F1 0.8960511 
new best score!!!!
Validation loss decreased (0.262052 --> 0.204552).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.264952659606934
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2128088  Vali Loss: 0.1701791 Vali Accuracy: 0.9385835  Vali weighted F1: 0.9383596  Vali macro F1 0.9109666 
new best score!!!!
Validation loss decreased (0.204552 --> 0.170179).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.2608888149261475
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1910571  Vali Loss: 0.1553855 Vali Accuracy: 0.9435364  Vali weighted F1: 0.9429866  Vali macro F1 0.9150918 
new best score!!!!
Validation loss decreased (0.170179 --> 0.155386).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.251178979873657
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1845809  Vali Loss: 0.1438461 Vali Accuracy: 0.9539376  Vali weighted F1: 0.9540580  Vali macro F1 0.9311166 
new best score!!!!
Validation loss decreased (0.155386 --> 0.143846).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.244749546051025
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1647975  Vali Loss: 0.1301281 Vali Accuracy: 0.9559188  Vali weighted F1: 0.9557989  Vali macro F1 0.9332086 
new best score!!!!
Validation loss decreased (0.143846 --> 0.130128).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.264958381652832
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1456055  Vali Loss: 0.1326983 Vali Accuracy: 0.9529470  Vali weighted F1: 0.9527630  Vali macro F1 0.9295594 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.27556300163269
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1431098  Vali Loss: 0.1374007 Vali Accuracy: 0.9504705  Vali weighted F1: 0.9507850  Vali macro F1 0.9272782 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.260117292404175
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1302126  Vali Loss: 0.1138232 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9567149  Vali macro F1 0.9363142 
new best score!!!!
Validation loss decreased (0.130128 --> 0.113823).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.255791187286377
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1281009  Vali Loss: 0.0995201 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9626435  Vali macro F1 0.9422351 
new best score!!!!
Validation loss decreased (0.113823 --> 0.099520).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.252073526382446
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1216338  Vali Loss: 0.1082323 Vali Accuracy: 0.9603764  Vali weighted F1: 0.9601509  Vali macro F1 0.9407188 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.2610414028167725
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1065818  Vali Loss: 0.1018759 Vali Accuracy: 0.9618623  Vali weighted F1: 0.9622227  Vali macro F1 0.9411214 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.255999565124512
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1120119  Vali Loss: 0.0968928 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9685365  Vali macro F1 0.9541566 
new best score!!!!
Validation loss decreased (0.099520 --> 0.096893).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.25981879234314
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1079448  Vali Loss: 0.0979421 Vali Accuracy: 0.9673105  Vali weighted F1: 0.9670395  Vali macro F1 0.9543081 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.279388189315796
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0945751  Vali Loss: 0.0845858 Vali Accuracy: 0.9697870  Vali weighted F1: 0.9700221  Vali macro F1 0.9572739 
new best score!!!!
Validation loss decreased (0.096893 --> 0.084586).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.280929327011108
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0913847  Vali Loss: 0.0895869 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9715249  Vali macro F1 0.9586744 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.265553951263428
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0933670  Vali Loss: 0.0745975 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9707873  Vali macro F1 0.9580394 
new best score!!!!
Validation loss decreased (0.084586 --> 0.074597).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.25738000869751
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0823515  Vali Loss: 0.0853242 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9701655  Vali macro F1 0.9574320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.258347034454346
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0836001  Vali Loss: 0.0736920 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9710887  Vali macro F1 0.9576636 
new best score!!!!
Validation loss decreased (0.074597 --> 0.073692).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.261397361755371
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0755566  Vali Loss: 0.0795911 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9729865  Vali macro F1 0.9623625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.2714457511901855
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0789944  Vali Loss: 0.0729553 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742070  Vali macro F1 0.9559325 
new best score!!!!
Validation loss decreased (0.073692 --> 0.072955).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.260249137878418
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0793923  Vali Loss: 0.0781825 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9749708  Vali macro F1 0.9576353 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.273452281951904
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0715629  Vali Loss: 0.0687067 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9759233  Vali macro F1 0.9589237 
new best score!!!!
Validation loss decreased (0.072955 --> 0.068707).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.283627986907959
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0697996  Vali Loss: 0.0779507 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9736145  Vali macro F1 0.9576357 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.26174783706665
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0633583  Vali Loss: 0.0688158 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742708  Vali macro F1 0.9583109 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.268576622009277
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0661482  Vali Loss: 0.0722172 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9732490  Vali macro F1 0.9606558 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.266621828079224
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0607824  Vali Loss: 0.0612093 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9779244  Vali macro F1 0.9675962 
new best score!!!!
Validation loss decreased (0.068707 --> 0.061209).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.256436109542847
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0592576  Vali Loss: 0.0607367 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788030  Vali macro F1 0.9685081 
new best score!!!!
Validation loss decreased (0.061209 --> 0.060737).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.250266790390015
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0506918  Vali Loss: 0.0549466 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803141  Vali macro F1 0.9728734 
new best score!!!!
Validation loss decreased (0.060737 --> 0.054947).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.263225078582764
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0618216  Vali Loss: 0.0937170 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9659867  Vali macro F1 0.9516723 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.271644115447998
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0538065  Vali Loss: 0.0882438 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9707083  Vali macro F1 0.9599517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.273282051086426
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0444205  Vali Loss: 0.0771926 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9741826  Vali macro F1 0.9632290 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.270345211029053
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0385993  Vali Loss: 0.0561007 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9823374  Vali macro F1 0.9740473 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.249231815338135
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0430324  Vali Loss: 0.0524158 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832355  Vali macro F1 0.9745561 
new best score!!!!
Validation loss decreased (0.054947 --> 0.052416).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.252843618392944
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0404011  Vali Loss: 0.0576428 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9801763  Vali macro F1 0.9710503 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.265561819076538
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0423347  Vali Loss: 0.0560084 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9800782  Vali macro F1 0.9695501 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.252655267715454
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0391405  Vali Loss: 0.0692369 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9742092  Vali macro F1 0.9645436 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.255862474441528
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0410913  Vali Loss: 0.0645238 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797968  Vali macro F1 0.9718546 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.251303434371948
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0341453  Vali Loss: 0.0591164 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812687  Vali macro F1 0.9714792 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 43 cost time: 6.263635158538818
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0275184  Vali Loss: 0.0458703 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9852752  Vali macro F1 0.9769869 
new best score!!!!
Validation loss decreased (0.052416 --> 0.045870).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.260464191436768
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0243534  Vali Loss: 0.0466135 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867145  Vali macro F1 0.9791971 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.256897211074829
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0233374  Vali Loss: 0.0444229 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9862166  Vali macro F1 0.9787230 
new best score!!!!
Validation loss decreased (0.045870 --> 0.044423).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.245254039764404
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0230072  Vali Loss: 0.0451981 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867037  Vali macro F1 0.9795611 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.266622304916382
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0220187  Vali Loss: 0.0436085 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867160  Vali macro F1 0.9793157 
new best score!!!!
Validation loss decreased (0.044423 --> 0.043608).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.2535789012908936
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0219202  Vali Loss: 0.0442695 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876937  Vali macro F1 0.9817073 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.2568347454071045
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0213594  Vali Loss: 0.0454057 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867185  Vali macro F1 0.9807315 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.255756616592407
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0220778  Vali Loss: 0.0444119 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877074  Vali macro F1 0.9809501 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.262480735778809
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0200944  Vali Loss: 0.0460517 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867354  Vali macro F1 0.9792790 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.278002977371216
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0207464  Vali Loss: 0.0454737 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872017  Vali macro F1 0.9801646 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.247262001037598
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0204595  Vali Loss: 0.0444820 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.254108667373657
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0188961  Vali Loss: 0.0443346 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876922  Vali macro F1 0.9812803 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.253206014633179
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0201301  Vali Loss: 0.0438835 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876944  Vali macro F1 0.9806537 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.252784490585327
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0200427  Vali Loss: 0.0434899 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876944  Vali macro F1 0.9806537 
new best score!!!!
Validation loss decreased (0.043608 --> 0.043490).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 6.2412707805633545
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0209760  Vali Loss: 0.0435291 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867160  Vali macro F1 0.9793157 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.249177932739258
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0193763  Vali Loss: 0.0435117 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867160  Vali macro F1 0.9793157 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.261595249176025
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0204409  Vali Loss: 0.0438872 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881879  Vali macro F1 0.9815125 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.284688949584961
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0184290  Vali Loss: 0.0441991 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.2544450759887695
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0206407  Vali Loss: 0.0441132 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 6.247871160507202
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0207964  Vali Loss: 0.0440231 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.252194404602051
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0199859  Vali Loss: 0.0439609 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.251283168792725
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0195486  Vali Loss: 0.0439359 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.243813753128052
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0185259  Vali Loss: 0.0438789 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 6.251879692077637
VALI: Epoch: 66, Steps: 71 | Train Loss: 0.0200122  Vali Loss: 0.0439599 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 67 cost time: 6.2595534324646
VALI: Epoch: 67, Steps: 71 | Train Loss: 0.0205065  Vali Loss: 0.0439523 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 6.2808239459991455
VALI: Epoch: 68, Steps: 71 | Train Loss: 0.0192424  Vali Loss: 0.0439400 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 6.267405033111572
VALI: Epoch: 69, Steps: 71 | Train Loss: 0.0182260  Vali Loss: 0.0439330 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 6.264821290969849
VALI: Epoch: 70, Steps: 71 | Train Loss: 0.0192500  Vali Loss: 0.0439291 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 6.257597923278809
VALI: Epoch: 71, Steps: 71 | Train Loss: 0.0192625  Vali Loss: 0.0439184 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9877011  Vali macro F1 0.9810312 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8814201  Test weighted F1: 0.8762169  Test macro F1 0.8378526 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3162925243377686
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0196564  Vali Loss: 0.0444091 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872015  Vali macro F1 0.9798979 
Validation loss decreased (inf --> 0.044409).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.286727428436279
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0197555  Vali Loss: 0.0428033 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9862011  Vali macro F1 0.9790634 
new best score!!!!
Validation loss decreased (0.044409 --> 0.042803).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.296175003051758
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0200538  Vali Loss: 0.0429279 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872087  Vali macro F1 0.9801741 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.29494047164917
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0204516  Vali Loss: 0.0457750 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861826  Vali macro F1 0.9781392 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.319705486297607
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0195127  Vali Loss: 0.0442593 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866979  Vali macro F1 0.9802740 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.295841693878174
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0194649  Vali Loss: 0.0426653 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891312  Vali macro F1 0.9842865 
new best score!!!!
Validation loss decreased (0.042803 --> 0.042665).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.2851879596710205
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0201931  Vali Loss: 0.0415202 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881806  Vali macro F1 0.9819222 
new best score!!!!
Validation loss decreased (0.042665 --> 0.041520).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.284329652786255
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0190590  Vali Loss: 0.0444066 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9838005  Vali macro F1 0.9758886 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.289582252502441
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0174948  Vali Loss: 0.0437751 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861923  Vali macro F1 0.9787748 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.283920049667358
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0193295  Vali Loss: 0.0441685 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881898  Vali macro F1 0.9811381 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.286269187927246
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0176169  Vali Loss: 0.0459231 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851826  Vali macro F1 0.9777641 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.2866411209106445
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0197799  Vali Loss: 0.0451831 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9867276  Vali macro F1 0.9795067 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.2985639572143555
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0172190  Vali Loss: 0.0416521 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876649  Vali macro F1 0.9813416 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.310984373092651
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0174322  Vali Loss: 0.0453355 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872040  Vali macro F1 0.9799249 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.278839588165283
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0177027  Vali Loss: 0.0434208 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871792  Vali macro F1 0.9808514 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.286700963973999
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0178608  Vali Loss: 0.0469122 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9852973  Vali macro F1 0.9770864 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.288249969482422
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0174714  Vali Loss: 0.0434431 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876926  Vali macro F1 0.9807651 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.298836708068848
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0168786  Vali Loss: 0.0424506 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876926  Vali macro F1 0.9807651 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.2922704219818115
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0161257  Vali Loss: 0.0419502 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872002  Vali macro F1 0.9799080 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.291091203689575
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0151997  Vali Loss: 0.0412722 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876888  Vali macro F1 0.9807488 
new best score!!!!
Validation loss decreased (0.041520 --> 0.041272).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.319533109664917
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0152566  Vali Loss: 0.0413892 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876888  Vali macro F1 0.9807488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.308826446533203
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0154212  Vali Loss: 0.0411710 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881776  Vali macro F1 0.9815906 
new best score!!!!
Validation loss decreased (0.041272 --> 0.041171).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.2939088344573975
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0180952  Vali Loss: 0.0415087 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876888  Vali macro F1 0.9807488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.306496620178223
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0151793  Vali Loss: 0.0421907 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876888  Vali macro F1 0.9807488 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.301658391952515
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0150813  Vali Loss: 0.0409880 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876888  Vali macro F1 0.9807488 
new best score!!!!
Validation loss decreased (0.041171 --> 0.040988).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.295366048812866
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0155937  Vali Loss: 0.0412626 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876888  Vali macro F1 0.9807488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.295166969299316
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0156777  Vali Loss: 0.0413663 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876888  Vali macro F1 0.9807488 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.290297508239746
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0150678  Vali Loss: 0.0417532 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.29749870300293
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0148593  Vali Loss: 0.0416400 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.30735969543457
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0148059  Vali Loss: 0.0418016 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 6.3033530712127686
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0149933  Vali Loss: 0.0418290 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.290638208389282
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0147611  Vali Loss: 0.0418071 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.291602611541748
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0158005  Vali Loss: 0.0417375 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.289411783218384
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0145652  Vali Loss: 0.0417417 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.283616542816162
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0147718  Vali Loss: 0.0418294 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 36 cost time: 6.28419041633606
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0138878  Vali Loss: 0.0418195 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.285744667053223
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0165469  Vali Loss: 0.0418188 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.274372100830078
Fine Tuning VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0142408  Vali Loss: 0.0418164 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.2606120109558105
Fine Tuning VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0151952  Vali Loss: 0.0418062 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.246122598648071
Fine Tuning VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0156578  Vali Loss: 0.0418072 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881918  Vali macro F1 0.9812560 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8805917  Test weighted F1: 0.8751196  Test macro F1 0.8412986 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014641 0.00017768 0.00108108 0.00133156 0.0005     0.00062461]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.1080029010772705
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2268329  Vali Loss: 0.7861450 Vali Accuracy: 0.6818874  Vali weighted F1: 0.5747977  Vali macro F1 0.2819561 
Validation loss decreased (inf --> 0.786145).  Saving model ...
Epoch: 2 cost time: 6.09477972984314
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6756695  Vali Loss: 0.5896662 Vali Accuracy: 0.7869102  Vali weighted F1: 0.7393046  Vali macro F1 0.5350042 
new best score!!!!
Validation loss decreased (0.786145 --> 0.589666).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.095040321350098
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.5092537  Vali Loss: 0.4525300 Vali Accuracy: 0.8244546  Vali weighted F1: 0.7969616  Vali macro F1 0.6086600 
new best score!!!!
Validation loss decreased (0.589666 --> 0.452530).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.087054967880249
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.4249297  Vali Loss: 0.3963714 Vali Accuracy: 0.8472856  Vali weighted F1: 0.8230035  Vali macro F1 0.6408387 
new best score!!!!
Validation loss decreased (0.452530 --> 0.396371).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.12629771232605
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3385854  Vali Loss: 0.2910943 Vali Accuracy: 0.9218671  Vali weighted F1: 0.9196986  Vali macro F1 0.8905502 
new best score!!!!
Validation loss decreased (0.396371 --> 0.291094).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.119769811630249
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2482064  Vali Loss: 0.1846199 Vali Accuracy: 0.9436834  Vali weighted F1: 0.9423561  Vali macro F1 0.9213759 
new best score!!!!
Validation loss decreased (0.291094 --> 0.184620).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.108267784118652
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1957564  Vali Loss: 0.1795749 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9453770  Vali macro F1 0.9372892 
new best score!!!!
Validation loss decreased (0.184620 --> 0.179575).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.119967222213745
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1773454  Vali Loss: 0.1345775 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9641578  Vali macro F1 0.9564992 
new best score!!!!
Validation loss decreased (0.179575 --> 0.134578).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.111500024795532
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1544565  Vali Loss: 0.1377172 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9590583  Vali macro F1 0.9513275 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.111863613128662
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1411817  Vali Loss: 0.1235799 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9611328  Vali macro F1 0.9465914 
new best score!!!!
Validation loss decreased (0.134578 --> 0.123580).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.090132474899292
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1306757  Vali Loss: 0.1635956 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9492117  Vali macro F1 0.9319152 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.092998504638672
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1231946  Vali Loss: 0.1255327 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9625634  Vali macro F1 0.9562657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.1124701499938965
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1115320  Vali Loss: 0.1104261 Vali Accuracy: 0.9649924  Vali weighted F1: 0.9648116  Vali macro F1 0.9525123 
new best score!!!!
Validation loss decreased (0.123580 --> 0.110426).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.121664047241211
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1066024  Vali Loss: 0.0979339 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9668456  Vali macro F1 0.9555575 
new best score!!!!
Validation loss decreased (0.110426 --> 0.097934).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.108313322067261
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1025916  Vali Loss: 0.0943122 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9694181  Vali macro F1 0.9642393 
new best score!!!!
Validation loss decreased (0.097934 --> 0.094312).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.104413032531738
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0992571  Vali Loss: 0.0940140 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9692683  Vali macro F1 0.9642577 
new best score!!!!
Validation loss decreased (0.094312 --> 0.094014).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.096026659011841
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0913894  Vali Loss: 0.1072902 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9666335  Vali macro F1 0.9594570 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.099607706069946
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0885164  Vali Loss: 0.0781770 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9760849  Vali macro F1 0.9723121 
new best score!!!!
Validation loss decreased (0.094014 --> 0.078177).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.1074769496917725
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0799345  Vali Loss: 0.0721316 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791792  Vali macro F1 0.9740296 
new best score!!!!
Validation loss decreased (0.078177 --> 0.072132).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.101435899734497
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0784337  Vali Loss: 0.0881302 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9726687  Vali macro F1 0.9680507 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.107537031173706
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0767654  Vali Loss: 0.0813229 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9755045  Vali macro F1 0.9695648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.137009143829346
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0700151  Vali Loss: 0.0635952 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812014  Vali macro F1 0.9781541 
new best score!!!!
Validation loss decreased (0.072132 --> 0.063595).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.126841068267822
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0665762  Vali Loss: 0.0631154 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806140  Vali macro F1 0.9759675 
new best score!!!!
Validation loss decreased (0.063595 --> 0.063115).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.107968330383301
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0745660  Vali Loss: 0.0756119 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9763757  Vali macro F1 0.9716756 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.10354208946228
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0639543  Vali Loss: 0.0638564 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9789787  Vali macro F1 0.9735128 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.110494375228882
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0611106  Vali Loss: 0.0602087 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766185  Vali macro F1 0.9710903 
new best score!!!!
Validation loss decreased (0.063115 --> 0.060209).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.102524995803833
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0665969  Vali Loss: 0.0661934 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9769255  Vali macro F1 0.9729617 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.1116063594818115
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0580038  Vali Loss: 0.0588696 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9800276  Vali macro F1 0.9762457 
new best score!!!!
Validation loss decreased (0.060209 --> 0.058870).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.105736970901489
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0516459  Vali Loss: 0.0510113 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827825  Vali macro F1 0.9730929 
new best score!!!!
Validation loss decreased (0.058870 --> 0.051011).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.113725662231445
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0472416  Vali Loss: 0.0592762 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796571  Vali macro F1 0.9743090 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.129762411117554
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0494473  Vali Loss: 0.0480360 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822565  Vali macro F1 0.9730638 
new best score!!!!
Validation loss decreased (0.051011 --> 0.048036).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.109726190567017
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0534553  Vali Loss: 0.0555875 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9773232  Vali macro F1 0.9667420 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.1083009243011475
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0446456  Vali Loss: 0.0539283 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837788  Vali macro F1 0.9817504 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.111925840377808
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0401256  Vali Loss: 0.0719912 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9746524  Vali macro F1 0.9722176 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.113746881484985
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0419122  Vali Loss: 0.0709658 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9759223  Vali macro F1 0.9736717 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.119290351867676
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0380571  Vali Loss: 0.0598969 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9814422  Vali macro F1 0.9781712 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 6.101693391799927
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0308490  Vali Loss: 0.0457831 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857468  Vali macro F1 0.9846708 
new best score!!!!
Validation loss decreased (0.048036 --> 0.045783).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.093170404434204
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0265187  Vali Loss: 0.0441082 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847667  Vali macro F1 0.9829733 
new best score!!!!
Validation loss decreased (0.045783 --> 0.044108).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.124279022216797
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0259810  Vali Loss: 0.0424214 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858046  Vali macro F1 0.9836267 
new best score!!!!
Validation loss decreased (0.044108 --> 0.042421).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.106088161468506
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0246330  Vali Loss: 0.0419666 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847926  Vali macro F1 0.9827023 
new best score!!!!
Validation loss decreased (0.042421 --> 0.041967).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.094752788543701
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0234349  Vali Loss: 0.0431753 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852970  Vali macro F1 0.9828137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.112650156021118
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0231645  Vali Loss: 0.0425791 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847926  Vali macro F1 0.9827023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.111542463302612
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0241414  Vali Loss: 0.0415838 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842788  Vali macro F1 0.9828093 
new best score!!!!
Validation loss decreased (0.041967 --> 0.041584).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.1062071323394775
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0228671  Vali Loss: 0.0398800 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847793  Vali macro F1 0.9824623 
new best score!!!!
Validation loss decreased (0.041584 --> 0.039880).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.110040903091431
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0228740  Vali Loss: 0.0416327 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847770  Vali macro F1 0.9830369 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.095110177993774
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0238958  Vali Loss: 0.0404244 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868450  Vali macro F1 0.9844233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.110748052597046
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0220853  Vali Loss: 0.0409667 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832382  Vali macro F1 0.9811184 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.132351398468018
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0221757  Vali Loss: 0.0418297 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848049  Vali macro F1 0.9827450 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.109993934631348
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0211915  Vali Loss: 0.0412024 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863101  Vali macro F1 0.9843435 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.103827714920044
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0197633  Vali Loss: 0.0409102 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863199  Vali macro F1 0.9841515 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.0942676067352295
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0197977  Vali Loss: 0.0404647 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863360  Vali macro F1 0.9842921 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.112943649291992
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0202632  Vali Loss: 0.0405741 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858369  Vali macro F1 0.9837251 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.101735353469849
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0206481  Vali Loss: 0.0408609 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853212  Vali macro F1 0.9832357 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.103591203689575
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0186162  Vali Loss: 0.0405463 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858369  Vali macro F1 0.9837251 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.105972051620483
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0205637  Vali Loss: 0.0404643 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858369  Vali macro F1 0.9837251 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.129561424255371
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0191851  Vali Loss: 0.0404535 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858369  Vali macro F1 0.9837251 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.129901647567749
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0202358  Vali Loss: 0.0404828 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858369  Vali macro F1 0.9837251 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.100037336349487
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0202376  Vali Loss: 0.0405155 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858369  Vali macro F1 0.9837251 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.102596759796143
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0196835  Vali Loss: 0.0405144 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858369  Vali macro F1 0.9837251 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9433146  Test weighted F1: 0.9438855  Test macro F1 0.9145184 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.085651874542236
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0219909  Vali Loss: 0.0418457 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853329  Vali macro F1 0.9833593 
Validation loss decreased (inf --> 0.041846).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.081280708312988
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0245335  Vali Loss: 0.0428077 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848244  Vali macro F1 0.9825453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.082694053649902
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0235596  Vali Loss: 0.0425146 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832465  Vali macro F1 0.9815045 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.084734916687012
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0216491  Vali Loss: 0.0405285 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853150  Vali macro F1 0.9831224 
new best score!!!!
Validation loss decreased (0.041846 --> 0.040529).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.102154016494751
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0232139  Vali Loss: 0.0419554 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852870  Vali macro F1 0.9831709 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.107106447219849
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0199885  Vali Loss: 0.0398968 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848049  Vali macro F1 0.9827450 
new best score!!!!
Validation loss decreased (0.040529 --> 0.039897).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.0967559814453125
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0212724  Vali Loss: 0.0471906 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837195  Vali macro F1 0.9817193 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.08830714225769
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0202622  Vali Loss: 0.0415424 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842880  Vali macro F1 0.9821252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.075347423553467
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0202021  Vali Loss: 0.0411491 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853129  Vali macro F1 0.9829906 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.081752061843872
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0198508  Vali Loss: 0.0432186 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837961  Vali macro F1 0.9812212 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.0839293003082275
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0205892  Vali Loss: 0.0423533 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863638  Vali macro F1 0.9839724 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.380010604858398
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0211038  Vali Loss: 0.0430592 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842657  Vali macro F1 0.9824274 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.130788803100586
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0185907  Vali Loss: 0.0399576 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853129  Vali macro F1 0.9829906 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.102699041366577
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0192205  Vali Loss: 0.0394729 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863296  Vali macro F1 0.9839349 
new best score!!!!
Validation loss decreased (0.039897 --> 0.039473).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.106868743896484
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0187863  Vali Loss: 0.0398100 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852975  Vali macro F1 0.9829802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.088283538818359
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0195861  Vali Loss: 0.0385303 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858105  Vali macro F1 0.9834269 
new best score!!!!
Validation loss decreased (0.039473 --> 0.038530).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.094097137451172
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0191609  Vali Loss: 0.0382595 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863184  Vali macro F1 0.9842647 
new best score!!!!
Validation loss decreased (0.038530 --> 0.038260).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.103622913360596
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0180374  Vali Loss: 0.0399700 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842993  Vali macro F1 0.9818087 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.104747295379639
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0173716  Vali Loss: 0.0400921 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868719  Vali macro F1 0.9841027 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.094148635864258
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0164473  Vali Loss: 0.0414978 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873593  Vali macro F1 0.9848846 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.089187383651733
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0181235  Vali Loss: 0.0383119 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873249  Vali macro F1 0.9848202 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.098504066467285
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0176759  Vali Loss: 0.0430193 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847331  Vali macro F1 0.9826696 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.1169679164886475
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0181436  Vali Loss: 0.0391260 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863184  Vali macro F1 0.9842647 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.08850359916687
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0156935  Vali Loss: 0.0391065 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863184  Vali macro F1 0.9842647 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.088564872741699
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0152444  Vali Loss: 0.0397921 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863184  Vali macro F1 0.9842647 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.0858237743377686
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0163495  Vali Loss: 0.0392858 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863184  Vali macro F1 0.9842647 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.084291696548462
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0158583  Vali Loss: 0.0398229 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858196  Vali macro F1 0.9836978 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 6.079927921295166
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0163150  Vali Loss: 0.0397607 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858196  Vali macro F1 0.9836978 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.080185651779175
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0149583  Vali Loss: 0.0397528 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858196  Vali macro F1 0.9836978 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.084883213043213
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0146499  Vali Loss: 0.0397829 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858196  Vali macro F1 0.9836978 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.111103296279907
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0165445  Vali Loss: 0.0397565 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863184  Vali macro F1 0.9842647 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.116451025009155
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0146086  Vali Loss: 0.0397237 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863184  Vali macro F1 0.9842647 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9430386  Test weighted F1: 0.9435212  Test macro F1 0.9152131 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013949 0.00018396 0.00103413 0.00129702 0.00048591 0.00059988]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.193906784057617
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.2250599  Vali Loss: 0.7445249 Vali Accuracy: 0.6972112  Vali weighted F1: 0.5903722  Vali macro F1 0.2875035 
Validation loss decreased (inf --> 0.744525).  Saving model ...
Epoch: 2 cost time: 6.194855690002441
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.6499072  Vali Loss: 0.5385582 Vali Accuracy: 0.7828685  Vali weighted F1: 0.7329387  Vali macro F1 0.5164145 
new best score!!!!
Validation loss decreased (0.744525 --> 0.538558).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.176631689071655
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4814339  Vali Loss: 0.3698466 Vali Accuracy: 0.8665339  Vali weighted F1: 0.8510974  Vali macro F1 0.7946921 
new best score!!!!
Validation loss decreased (0.538558 --> 0.369847).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2005226612091064
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3518885  Vali Loss: 0.3107203 Vali Accuracy: 0.8914343  Vali weighted F1: 0.8828074  Vali macro F1 0.8365591 
new best score!!!!
Validation loss decreased (0.369847 --> 0.310720).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.200270175933838
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2748329  Vali Loss: 0.2309443 Vali Accuracy: 0.9193227  Vali weighted F1: 0.9191810  Vali macro F1 0.8871645 
new best score!!!!
Validation loss decreased (0.310720 --> 0.230944).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.215770244598389
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2256747  Vali Loss: 0.1936529 Vali Accuracy: 0.9317729  Vali weighted F1: 0.9300546  Vali macro F1 0.9001974 
new best score!!!!
Validation loss decreased (0.230944 --> 0.193653).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.231343030929565
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1845879  Vali Loss: 0.1850280 Vali Accuracy: 0.9347610  Vali weighted F1: 0.9327630  Vali macro F1 0.9016490 
new best score!!!!
Validation loss decreased (0.193653 --> 0.185028).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.21537184715271
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1695917  Vali Loss: 0.1637297 Vali Accuracy: 0.9412351  Vali weighted F1: 0.9404578  Vali macro F1 0.9116231 
new best score!!!!
Validation loss decreased (0.185028 --> 0.163730).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 7.486069440841675
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1564014  Vali Loss: 0.1526631 Vali Accuracy: 0.9482072  Vali weighted F1: 0.9475321  Vali macro F1 0.9217074 
new best score!!!!
Validation loss decreased (0.163730 --> 0.152663).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 7.153825998306274
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1443574  Vali Loss: 0.1464285 Vali Accuracy: 0.9501992  Vali weighted F1: 0.9497963  Vali macro F1 0.9286211 
new best score!!!!
Validation loss decreased (0.152663 --> 0.146428).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.183041572570801
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1362722  Vali Loss: 0.1482502 Vali Accuracy: 0.9506972  Vali weighted F1: 0.9509500  Vali macro F1 0.9298256 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.176229953765869
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1313617  Vali Loss: 0.1389126 Vali Accuracy: 0.9561753  Vali weighted F1: 0.9561744  Vali macro F1 0.9354592 
new best score!!!!
Validation loss decreased (0.146428 --> 0.138913).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.173290729522705
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1170221  Vali Loss: 0.1353694 Vali Accuracy: 0.9541833  Vali weighted F1: 0.9536080  Vali macro F1 0.9342783 
new best score!!!!
Validation loss decreased (0.138913 --> 0.135369).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.1715569496154785
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1157900  Vali Loss: 0.1717420 Vali Accuracy: 0.9412351  Vali weighted F1: 0.9426941  Vali macro F1 0.9186261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.187303781509399
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1102552  Vali Loss: 0.1231372 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9574315  Vali macro F1 0.9390567 
new best score!!!!
Validation loss decreased (0.135369 --> 0.123137).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.182220935821533
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1008255  Vali Loss: 0.1850963 Vali Accuracy: 0.9367530  Vali weighted F1: 0.9397434  Vali macro F1 0.9212928 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.173838138580322
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1002104  Vali Loss: 0.1456466 Vali Accuracy: 0.9521912  Vali weighted F1: 0.9519310  Vali macro F1 0.9339323 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.18192720413208
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0962904  Vali Loss: 0.1183645 Vali Accuracy: 0.9601594  Vali weighted F1: 0.9604030  Vali macro F1 0.9438447 
new best score!!!!
Validation loss decreased (0.123137 --> 0.118364).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.18290901184082
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0896896  Vali Loss: 0.1200071 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9595158  Vali macro F1 0.9394165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.180221796035767
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0885307  Vali Loss: 0.1239912 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9588779  Vali macro F1 0.9386142 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.1821675300598145
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0823230  Vali Loss: 0.1147915 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9640698  Vali macro F1 0.9472346 
new best score!!!!
Validation loss decreased (0.118364 --> 0.114792).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.179797887802124
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0824690  Vali Loss: 0.1078771 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9647874  Vali macro F1 0.9488069 
new best score!!!!
Validation loss decreased (0.114792 --> 0.107877).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.18343448638916
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0718091  Vali Loss: 0.1147672 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9635492  Vali macro F1 0.9455441 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.1830573081970215
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0787265  Vali Loss: 0.1094182 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9663750  Vali macro F1 0.9483489 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.181485176086426
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0667424  Vali Loss: 0.1009408 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9669060  Vali macro F1 0.9518904 
new best score!!!!
Validation loss decreased (0.107877 --> 0.100941).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.18255615234375
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0633770  Vali Loss: 0.1036007 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9670863  Vali macro F1 0.9497385 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.180646657943726
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0631601  Vali Loss: 0.1159194 Vali Accuracy: 0.9651394  Vali weighted F1: 0.9651456  Vali macro F1 0.9501367 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.179656505584717
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0679515  Vali Loss: 0.1125840 Vali Accuracy: 0.9666335  Vali weighted F1: 0.9671241  Vali macro F1 0.9528991 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.1801557540893555
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0630851  Vali Loss: 0.1064272 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9665329  Vali macro F1 0.9506811 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.1889050006866455
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0570277  Vali Loss: 0.1062983 Vali Accuracy: 0.9631474  Vali weighted F1: 0.9633926  Vali macro F1 0.9476524 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 6.186796188354492
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0452779  Vali Loss: 0.0951160 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707502  Vali macro F1 0.9574877 
new best score!!!!
Validation loss decreased (0.100941 --> 0.095116).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.218320608139038
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0422553  Vali Loss: 0.0947109 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707864  Vali macro F1 0.9575606 
new best score!!!!
Validation loss decreased (0.095116 --> 0.094711).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.185678005218506
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0423307  Vali Loss: 0.0951207 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713340  Vali macro F1 0.9578818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.172820806503296
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0416437  Vali Loss: 0.0945594 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9708427  Vali macro F1 0.9576871 
new best score!!!!
Validation loss decreased (0.094711 --> 0.094559).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.174652814865112
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0404217  Vali Loss: 0.0937914 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732492  Vali macro F1 0.9601145 
new best score!!!!
Validation loss decreased (0.094559 --> 0.093791).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.172518491744995
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0379246  Vali Loss: 0.0937632 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9724289  Vali macro F1 0.9595306 
new best score!!!!
Validation loss decreased (0.093791 --> 0.093763).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.1817686557769775
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0403697  Vali Loss: 0.0939073 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738722  Vali macro F1 0.9616162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.198407888412476
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0385868  Vali Loss: 0.0932286 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738299  Vali macro F1 0.9614949 
new best score!!!!
Validation loss decreased (0.093763 --> 0.093229).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.185462951660156
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0383855  Vali Loss: 0.0920875 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727479  Vali macro F1 0.9598570 
new best score!!!!
Validation loss decreased (0.093229 --> 0.092087).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.209907293319702
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0372798  Vali Loss: 0.0926036 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9748042  Vali macro F1 0.9630729 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.208611011505127
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0383956  Vali Loss: 0.0950933 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728701  Vali macro F1 0.9595296 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.181161880493164
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0398966  Vali Loss: 0.0950475 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9747841  Vali macro F1 0.9624270 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.180542707443237
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0370876  Vali Loss: 0.0935328 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727040  Vali macro F1 0.9600194 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.170795679092407
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0363722  Vali Loss: 0.0921622 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9747719  Vali macro F1 0.9629943 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 6.1736297607421875
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0361342  Vali Loss: 0.0930780 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737477  Vali macro F1 0.9612508 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.185302019119263
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0354456  Vali Loss: 0.0927910 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742753  Vali macro F1 0.9621563 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.186089992523193
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0358085  Vali Loss: 0.0928333 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737858  Vali macro F1 0.9613290 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.195780515670776
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0353452  Vali Loss: 0.0927021 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9747960  Vali macro F1 0.9627684 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.2086567878723145
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0345372  Vali Loss: 0.0926889 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732962  Vali macro F1 0.9605020 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 6.186455726623535
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0339275  Vali Loss: 0.0927018 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732962  Vali macro F1 0.9605020 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.194047451019287
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0357619  Vali Loss: 0.0926216 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732962  Vali macro F1 0.9605020 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.1984405517578125
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0355954  Vali Loss: 0.0926491 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732962  Vali macro F1 0.9605020 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.202651500701904
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0342409  Vali Loss: 0.0925830 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738139  Vali macro F1 0.9611001 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.185142993927002
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0359704  Vali Loss: 0.0924550 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743036  Vali macro F1 0.9619273 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9438040  Test weighted F1: 0.9435200  Test macro F1 0.9216773 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.292223691940308
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0374717  Vali Loss: 0.0927229 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732965  Vali macro F1 0.9612185 
Validation loss decreased (inf --> 0.092723).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.240227937698364
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0380513  Vali Loss: 0.0934727 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9747974  Vali macro F1 0.9627897 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.232179641723633
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0371584  Vali Loss: 0.0923436 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742099  Vali macro F1 0.9628320 
new best score!!!!
Validation loss decreased (0.092723 --> 0.092344).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.345569133758545
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0375931  Vali Loss: 0.0956080 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742514  Vali macro F1 0.9629293 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.218417167663574
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0382348  Vali Loss: 0.0960775 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742915  Vali macro F1 0.9630469 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.2231690883636475
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0347076  Vali Loss: 0.0930504 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737351  Vali macro F1 0.9617038 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.24094557762146
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0357538  Vali Loss: 0.0925784 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743189  Vali macro F1 0.9630942 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.240082263946533
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0349288  Vali Loss: 0.0963540 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737714  Vali macro F1 0.9618130 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.2173614501953125
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0359293  Vali Loss: 0.0945028 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738201  Vali macro F1 0.9618694 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.226400136947632
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0350179  Vali Loss: 0.0943491 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9757894  Vali macro F1 0.9646803 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.266481161117554
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0328417  Vali Loss: 0.0940262 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737726  Vali macro F1 0.9624105 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.239327907562256
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0334936  Vali Loss: 0.0934318 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9757863  Vali macro F1 0.9646480 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.237817287445068
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0349691  Vali Loss: 0.0911877 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9757903  Vali macro F1 0.9638587 
new best score!!!!
Validation loss decreased (0.092344 --> 0.091188).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.2368762493133545
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0365557  Vali Loss: 0.0958063 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9719382  Vali macro F1 0.9587993 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.232836008071899
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0325070  Vali Loss: 0.0934084 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9752397  Vali macro F1 0.9631871 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.236852169036865
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0342751  Vali Loss: 0.0945525 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9762800  Vali macro F1 0.9657647 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.236764430999756
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0330216  Vali Loss: 0.0932310 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9757097  Vali macro F1 0.9642345 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.230205297470093
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0336372  Vali Loss: 0.0949536 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738325  Vali macro F1 0.9624192 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.2384724617004395
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0323749  Vali Loss: 0.0929201 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9762763  Vali macro F1 0.9654762 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.244865894317627
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0310903  Vali Loss: 0.0931680 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9762782  Vali macro F1 0.9654977 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.226557493209839
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0313773  Vali Loss: 0.0929567 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9762741  Vali macro F1 0.9654640 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.230008363723755
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0305365  Vali Loss: 0.0931866 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9767918  Vali macro F1 0.9660883 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.223643064498901
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0300795  Vali Loss: 0.0931588 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9758100  Vali macro F1 0.9644117 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 6.223542213439941
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0302560  Vali Loss: 0.0932404 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9758100  Vali macro F1 0.9644117 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.211785078048706
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0299682  Vali Loss: 0.0931782 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9758100  Vali macro F1 0.9644117 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.238402605056763
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0310200  Vali Loss: 0.0932088 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9758100  Vali macro F1 0.9644117 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.2539331912994385
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0303211  Vali Loss: 0.0931844 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9758100  Vali macro F1 0.9644117 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.251744031906128
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0301518  Vali Loss: 0.0931955 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9758100  Vali macro F1 0.9644117 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9285081  Test weighted F1: 0.9257805  Test macro F1 0.8669324 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 63951
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014618 0.00018175 0.00097182 0.00121655 0.00048263 0.00061162]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.217734098434448
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2084191  Vali Loss: 0.7249001 Vali Accuracy: 0.6928105  Vali weighted F1: 0.5847466  Vali macro F1 0.2843835 
Validation loss decreased (inf --> 0.724900).  Saving model ...
Epoch: 2 cost time: 6.214680910110474
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6307682  Vali Loss: 0.5134586 Vali Accuracy: 0.7898441  Vali weighted F1: 0.7485283  Vali macro F1 0.5438312 
new best score!!!!
Validation loss decreased (0.724900 --> 0.513459).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.214010715484619
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4175429  Vali Loss: 0.3152647 Vali Accuracy: 0.8873806  Vali weighted F1: 0.8788783  Vali macro F1 0.8396116 
new best score!!!!
Validation loss decreased (0.513459 --> 0.315265).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.228417158126831
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2998625  Vali Loss: 0.2607530 Vali Accuracy: 0.9185520  Vali weighted F1: 0.9157047  Vali macro F1 0.8869597 
new best score!!!!
Validation loss decreased (0.315265 --> 0.260753).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.217603445053101
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2476065  Vali Loss: 0.2062826 Vali Accuracy: 0.9296129  Vali weighted F1: 0.9285525  Vali macro F1 0.9052615 
new best score!!!!
Validation loss decreased (0.260753 --> 0.206283).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.254999160766602
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2202053  Vali Loss: 0.2154977 Vali Accuracy: 0.9281046  Vali weighted F1: 0.9279849  Vali macro F1 0.9045387 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.2444610595703125
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1983381  Vali Loss: 0.1666211 Vali Accuracy: 0.9457014  Vali weighted F1: 0.9455547  Vali macro F1 0.9253050 
new best score!!!!
Validation loss decreased (0.206283 --> 0.166621).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.2332680225372314
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1911710  Vali Loss: 0.1699722 Vali Accuracy: 0.9431875  Vali weighted F1: 0.9437583  Vali macro F1 0.9256262 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.208441257476807
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1739887  Vali Loss: 0.1549939 Vali Accuracy: 0.9482152  Vali weighted F1: 0.9473700  Vali macro F1 0.9282147 
new best score!!!!
Validation loss decreased (0.166621 --> 0.154994).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.230791091918945
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1645360  Vali Loss: 0.1388422 Vali Accuracy: 0.9517345  Vali weighted F1: 0.9521492  Vali macro F1 0.9340945 
new best score!!!!
Validation loss decreased (0.154994 --> 0.138842).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.253535032272339
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1568964  Vali Loss: 0.1493480 Vali Accuracy: 0.9502262  Vali weighted F1: 0.9499565  Vali macro F1 0.9321367 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.217733383178711
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1481264  Vali Loss: 0.1253551 Vali Accuracy: 0.9602815  Vali weighted F1: 0.9605955  Vali macro F1 0.9444212 
new best score!!!!
Validation loss decreased (0.138842 --> 0.125355).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.235653877258301
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1341971  Vali Loss: 0.1128964 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9644493  Vali macro F1 0.9468437 
new best score!!!!
Validation loss decreased (0.125355 --> 0.112896).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.225344181060791
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1392734  Vali Loss: 0.1142443 Vali Accuracy: 0.9663147  Vali weighted F1: 0.9661104  Vali macro F1 0.9491646 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.234840631484985
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1224589  Vali Loss: 0.1106776 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9658736  Vali macro F1 0.9500198 
new best score!!!!
Validation loss decreased (0.112896 --> 0.110678).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.229188919067383
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1186835  Vali Loss: 0.1060017 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9656638  Vali macro F1 0.9494375 
new best score!!!!
Validation loss decreased (0.110678 --> 0.106002).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.221344709396362
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1089475  Vali Loss: 0.1033264 Vali Accuracy: 0.9653092  Vali weighted F1: 0.9654494  Vali macro F1 0.9486137 
new best score!!!!
Validation loss decreased (0.106002 --> 0.103326).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.216254472732544
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1111907  Vali Loss: 0.1078027 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9643419  Vali macro F1 0.9471757 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.206865549087524
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1128956  Vali Loss: 0.0995872 Vali Accuracy: 0.9678230  Vali weighted F1: 0.9675726  Vali macro F1 0.9509753 
new best score!!!!
Validation loss decreased (0.103326 --> 0.099587).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.222340106964111
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1009288  Vali Loss: 0.1005997 Vali Accuracy: 0.9663147  Vali weighted F1: 0.9666312  Vali macro F1 0.9514061 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.2027506828308105
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0953443  Vali Loss: 0.0878536 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9732162  Vali macro F1 0.9578752 
new best score!!!!
Validation loss decreased (0.099587 --> 0.087854).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.219521999359131
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0958570  Vali Loss: 0.0927136 Vali Accuracy: 0.9673203  Vali weighted F1: 0.9672161  Vali macro F1 0.9524825 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.215939521789551
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0943587  Vali Loss: 0.0853094 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9706898  Vali macro F1 0.9545402 
new best score!!!!
Validation loss decreased (0.087854 --> 0.085309).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.2491841316223145
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0844039  Vali Loss: 0.0936391 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9693796  Vali macro F1 0.9547370 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.2350146770477295
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0817394  Vali Loss: 0.0819334 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9762398  Vali macro F1 0.9626721 
new best score!!!!
Validation loss decreased (0.085309 --> 0.081933).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.250600337982178
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0794385  Vali Loss: 0.0810478 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9762297  Vali macro F1 0.9663485 
new best score!!!!
Validation loss decreased (0.081933 --> 0.081048).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.218348741531372
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0808098  Vali Loss: 0.0883313 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9720418  Vali macro F1 0.9616344 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.235645771026611
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0753978  Vali Loss: 0.0740251 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9792442  Vali macro F1 0.9731113 
new best score!!!!
Validation loss decreased (0.081048 --> 0.074025).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.231163740158081
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0704456  Vali Loss: 0.1059145 Vali Accuracy: 0.9638009  Vali weighted F1: 0.9644260  Vali macro F1 0.9520465 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.23103141784668
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0682012  Vali Loss: 0.0830658 Vali Accuracy: 0.9703369  Vali weighted F1: 0.9703850  Vali macro F1 0.9597426 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.242127180099487
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0617768  Vali Loss: 0.0702677 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9745450  Vali macro F1 0.9641971 
new best score!!!!
Validation loss decreased (0.074025 --> 0.070268).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.251847505569458
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0623822  Vali Loss: 0.0748583 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787943  Vali macro F1 0.9705946 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.251339673995972
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0634885  Vali Loss: 0.0710019 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9766150  Vali macro F1 0.9687979 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.2506043910980225
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0617920  Vali Loss: 0.0699075 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764205  Vali macro F1 0.9690407 
new best score!!!!
Validation loss decreased (0.070268 --> 0.069907).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.237744092941284
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0592330  Vali Loss: 0.0611340 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808024  Vali macro F1 0.9717954 
new best score!!!!
Validation loss decreased (0.069907 --> 0.061134).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.247277021408081
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0612113  Vali Loss: 0.0605029 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9829242  Vali macro F1 0.9764990 
new best score!!!!
Validation loss decreased (0.061134 --> 0.060503).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.236131191253662
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0572370  Vali Loss: 0.0637248 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9764199  Vali macro F1 0.9680252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.240736722946167
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0539506  Vali Loss: 0.0646341 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9778228  Vali macro F1 0.9684513 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.242397785186768
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0495809  Vali Loss: 0.0898150 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9717014  Vali macro F1 0.9376010 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.262644529342651
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0563575  Vali Loss: 0.0657205 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9778659  Vali macro F1 0.9630868 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.266167163848877
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0459939  Vali Loss: 0.0572046 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834345  Vali macro F1 0.9762850 
new best score!!!!
Validation loss decreased (0.060503 --> 0.057205).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.225058317184448
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0476407  Vali Loss: 0.0611545 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787011  Vali macro F1 0.9686027 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.226401329040527
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0447553  Vali Loss: 0.0528067 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858579  Vali macro F1 0.9795053 
new best score!!!!
Validation loss decreased (0.057205 --> 0.052807).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.230675935745239
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0409779  Vali Loss: 0.0630916 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823501  Vali macro F1 0.9739976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.222448348999023
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0397279  Vali Loss: 0.0627061 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824156  Vali macro F1 0.9758166 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.232163190841675
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0387959  Vali Loss: 0.0495532 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849408  Vali macro F1 0.9789544 
new best score!!!!
Validation loss decreased (0.052807 --> 0.049553).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.222665548324585
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0389046  Vali Loss: 0.0475639 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869118  Vali macro F1 0.9820571 
new best score!!!!
Validation loss decreased (0.049553 --> 0.047564).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.244579553604126
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0353491  Vali Loss: 0.0613461 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9822565  Vali macro F1 0.9758637 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.262795448303223
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0347016  Vali Loss: 0.0677480 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9810541  Vali macro F1 0.9740859 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.243412494659424
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0311525  Vali Loss: 0.0553424 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9832964  Vali macro F1 0.9774628 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.240530490875244
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0395875  Vali Loss: 0.0515856 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869116  Vali macro F1 0.9813908 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.231996059417725
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0397394  Vali Loss: 0.0558318 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853876  Vali macro F1 0.9788803 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 53 cost time: 6.2409348487854
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0247800  Vali Loss: 0.0497333 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869013  Vali macro F1 0.9805610 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.244827747344971
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0230083  Vali Loss: 0.0493034 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864158  Vali macro F1 0.9798185 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.29010796546936
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0230828  Vali Loss: 0.0459046 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869058  Vali macro F1 0.9811655 
new best score!!!!
Validation loss decreased (0.047564 --> 0.045905).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.2439656257629395
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0203967  Vali Loss: 0.0451329 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864158  Vali macro F1 0.9798185 
new best score!!!!
Validation loss decreased (0.045905 --> 0.045133).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 6.262162685394287
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0217666  Vali Loss: 0.0455613 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869131  Vali macro F1 0.9803299 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.252894639968872
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0206182  Vali Loss: 0.0445745 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9868867  Vali macro F1 0.9805773 
new best score!!!!
Validation loss decreased (0.045133 --> 0.044574).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 6.23983359336853
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0199641  Vali Loss: 0.0456290 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9868972  Vali macro F1 0.9808918 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.243926286697388
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0205199  Vali Loss: 0.0453844 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874182  Vali macro F1 0.9816917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 6.249231338500977
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0194868  Vali Loss: 0.0449539 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869259  Vali macro F1 0.9809421 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 6.244853258132935
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0196553  Vali Loss: 0.0412501 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884393  Vali macro F1 0.9832599 
new best score!!!!
Validation loss decreased (0.044574 --> 0.041250).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 6.227297306060791
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0188738  Vali Loss: 0.0430900 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874221  Vali macro F1 0.9817368 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 6.221242189407349
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0182670  Vali Loss: 0.0436675 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869427  Vali macro F1 0.9806600 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 6.2446630001068115
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0179855  Vali Loss: 0.0436431 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884384  Vali macro F1 0.9847774 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 6.246937990188599
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0181382  Vali Loss: 0.0458099 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9878953  Vali macro F1 0.9839497 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 6.3451032638549805
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0180325  Vali Loss: 0.0421757 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874330  Vali macro F1 0.9817399 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 68 cost time: 6.226644039154053
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0179335  Vali Loss: 0.0422433 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874295  Vali macro F1 0.9820038 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 6.227763414382935
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0180134  Vali Loss: 0.0424696 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874276  Vali macro F1 0.9819816 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 6.221931457519531
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0174323  Vali Loss: 0.0426040 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874295  Vali macro F1 0.9820038 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 6.212299108505249
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0169161  Vali Loss: 0.0427094 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879284  Vali macro F1 0.9825336 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 6.213468313217163
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0176414  Vali Loss: 0.0428637 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874295  Vali macro F1 0.9820038 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 73 cost time: 6.222721815109253
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0165292  Vali Loss: 0.0428340 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874295  Vali macro F1 0.9820038 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 6.24622106552124
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0171110  Vali Loss: 0.0428467 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874295  Vali macro F1 0.9820038 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 6.223236560821533
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0171339  Vali Loss: 0.0427734 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874295  Vali macro F1 0.9820038 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 6.227013349533081
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0176826  Vali Loss: 0.0427886 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874295  Vali macro F1 0.9820038 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 6.221534490585327
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0164667  Vali Loss: 0.0427727 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874295  Vali macro F1 0.9820038 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8415603  Test weighted F1: 0.8487024  Test macro F1 0.8053067 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.216463088989258
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0188523  Vali Loss: 0.0460131 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874299  Vali macro F1 0.9820542 
Validation loss decreased (inf --> 0.046013).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.193382740020752
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0189168  Vali Loss: 0.0434595 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869156  Vali macro F1 0.9812298 
new best score!!!!
Validation loss decreased (0.046013 --> 0.043459).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.184459209442139
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0187239  Vali Loss: 0.0457993 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869129  Vali macro F1 0.9808728 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.227746248245239
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0178601  Vali Loss: 0.0435050 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889184  Vali macro F1 0.9834991 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.222074747085571
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0177484  Vali Loss: 0.0446567 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889287  Vali macro F1 0.9838136 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.194256782531738
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0177722  Vali Loss: 0.0455798 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879063  Vali macro F1 0.9822153 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.216141939163208
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0174483  Vali Loss: 0.0435777 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9873936  Vali macro F1 0.9814172 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.208553791046143
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0174290  Vali Loss: 0.0459869 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849446  Vali macro F1 0.9780234 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.202990293502808
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0185006  Vali Loss: 0.0446323 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889167  Vali macro F1 0.9835001 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.200562000274658
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0178336  Vali Loss: 0.0451485 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874159  Vali macro F1 0.9816500 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.2111451625823975
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0164410  Vali Loss: 0.0426297 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884316  Vali macro F1 0.9848249 
new best score!!!!
Validation loss decreased (0.043459 --> 0.042630).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.212600469589233
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0168137  Vali Loss: 0.0441535 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889294  Vali macro F1 0.9841287 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.2300331592559814
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0155770  Vali Loss: 0.0425091 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894324  Vali macro F1 0.9857920 
new best score!!!!
Validation loss decreased (0.042630 --> 0.042509).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.224012851715088
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0169699  Vali Loss: 0.0420040 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889254  Vali macro F1 0.9853075 
new best score!!!!
Validation loss decreased (0.042509 --> 0.042004).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.203732013702393
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0157255  Vali Loss: 0.0444751 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879330  Vali macro F1 0.9837176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.198635101318359
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0171728  Vali Loss: 0.0411532 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884191  Vali macro F1 0.9830152 
new best score!!!!
Validation loss decreased (0.042004 --> 0.041153).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.2020347118377686
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0153657  Vali Loss: 0.0397493 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889353  Vali macro F1 0.9838331 
new best score!!!!
Validation loss decreased (0.041153 --> 0.039749).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.214208602905273
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0157697  Vali Loss: 0.0405513 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874253  Vali macro F1 0.9831445 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.205707788467407
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0161919  Vali Loss: 0.0429838 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864600  Vali macro F1 0.9810323 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.213294267654419
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0161643  Vali Loss: 0.0434399 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879103  Vali macro F1 0.9837099 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.214758396148682
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0152545  Vali Loss: 0.0437589 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869061  Vali macro F1 0.9815126 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.236326456069946
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0137367  Vali Loss: 0.0429350 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894410  Vali macro F1 0.9858271 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.214884281158447
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0147783  Vali Loss: 0.0430451 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879103  Vali macro F1 0.9837099 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.2062060832977295
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0146346  Vali Loss: 0.0423493 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889260  Vali macro F1 0.9849945 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.205232858657837
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0139717  Vali Loss: 0.0424765 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889260  Vali macro F1 0.9849945 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.20394492149353
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0136244  Vali Loss: 0.0431172 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884178  Vali macro F1 0.9845084 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.201127529144287
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0125027  Vali Loss: 0.0429352 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889260  Vali macro F1 0.9849945 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 6.214286804199219
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0131436  Vali Loss: 0.0429707 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889260  Vali macro F1 0.9849945 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.223310708999634
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0139673  Vali Loss: 0.0429750 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889260  Vali macro F1 0.9849945 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.228958368301392
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0131303  Vali Loss: 0.0429058 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889260  Vali macro F1 0.9849945 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.201030015945435
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0131135  Vali Loss: 0.0428498 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889260  Vali macro F1 0.9849945 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.190808057785034
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0141254  Vali Loss: 0.0428345 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889260  Vali macro F1 0.9849945 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8465869  Test weighted F1: 0.8523275  Test macro F1 0.8080626 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00015017 0.00018275 0.0010846  0.0013947  0.00050201 0.00062854]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.003429651260376
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.2277022  Vali Loss: 0.7424082 Vali Accuracy: 0.6910316  Vali weighted F1: 0.5837753  Vali macro F1 0.2812086 
Validation loss decreased (inf --> 0.742408).  Saving model ...
Epoch: 2 cost time: 6.017008066177368
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.6794385  Vali Loss: 0.5658620 Vali Accuracy: 0.7843442  Vali weighted F1: 0.7411497  Vali macro F1 0.5362397 
new best score!!!!
Validation loss decreased (0.742408 --> 0.565862).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.008444309234619
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.5401888  Vali Loss: 0.4577025 Vali Accuracy: 0.8335925  Vali weighted F1: 0.8142790  Vali macro F1 0.7136860 
new best score!!!!
Validation loss decreased (0.565862 --> 0.457702).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.002187252044678
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.4208575  Vali Loss: 0.3747683 Vali Accuracy: 0.8672888  Vali weighted F1: 0.8542965  Vali macro F1 0.8118485 
new best score!!!!
Validation loss decreased (0.457702 --> 0.374768).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.033134698867798
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.3236399  Vali Loss: 0.2941451 Vali Accuracy: 0.9025402  Vali weighted F1: 0.8998985  Vali macro F1 0.8722401 
new best score!!!!
Validation loss decreased (0.374768 --> 0.294145).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.041393041610718
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2767453  Vali Loss: 0.2390396 Vali Accuracy: 0.9222395  Vali weighted F1: 0.9221654  Vali macro F1 0.8950651 
new best score!!!!
Validation loss decreased (0.294145 --> 0.239040).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.050888538360596
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.2542818  Vali Loss: 0.2304465 Vali Accuracy: 0.9258683  Vali weighted F1: 0.9264851  Vali macro F1 0.9052411 
new best score!!!!
Validation loss decreased (0.239040 --> 0.230447).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.032537460327148
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.2232831  Vali Loss: 0.1993456 Vali Accuracy: 0.9351996  Vali weighted F1: 0.9358175  Vali macro F1 0.9153917 
new best score!!!!
Validation loss decreased (0.230447 --> 0.199346).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.022017240524292
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.2090484  Vali Loss: 0.1767566 Vali Accuracy: 0.9403836  Vali weighted F1: 0.9398878  Vali macro F1 0.9199857 
new best score!!!!
Validation loss decreased (0.199346 --> 0.176757).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.016195297241211
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1934745  Vali Loss: 0.1894120 Vali Accuracy: 0.9367548  Vali weighted F1: 0.9355652  Vali macro F1 0.9164689 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.007760047912598
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1864605  Vali Loss: 0.1783263 Vali Accuracy: 0.9393468  Vali weighted F1: 0.9377921  Vali macro F1 0.9151228 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.024212598800659
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1759206  Vali Loss: 0.1673913 Vali Accuracy: 0.9450492  Vali weighted F1: 0.9438944  Vali macro F1 0.9264790 
new best score!!!!
Validation loss decreased (0.176757 --> 0.167391).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.027354717254639
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1730829  Vali Loss: 0.1444713 Vali Accuracy: 0.9523069  Vali weighted F1: 0.9514844  Vali macro F1 0.9313715 
new best score!!!!
Validation loss decreased (0.167391 --> 0.144471).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.033083200454712
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1563939  Vali Loss: 0.1406780 Vali Accuracy: 0.9533437  Vali weighted F1: 0.9534357  Vali macro F1 0.9351795 
new best score!!!!
Validation loss decreased (0.144471 --> 0.140678).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.049544334411621
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1420896  Vali Loss: 0.1280935 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9622380  Vali macro F1 0.9441561 
new best score!!!!
Validation loss decreased (0.140678 --> 0.128093).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.043140649795532
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1410443  Vali Loss: 0.1244884 Vali Accuracy: 0.9559357  Vali weighted F1: 0.9563593  Vali macro F1 0.9379181 
new best score!!!!
Validation loss decreased (0.128093 --> 0.124488).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.027397632598877
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.1312849  Vali Loss: 0.1220170 Vali Accuracy: 0.9543805  Vali weighted F1: 0.9544856  Vali macro F1 0.9353583 
new best score!!!!
Validation loss decreased (0.124488 --> 0.122017).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.018323659896851
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.1283695  Vali Loss: 0.1086282 Vali Accuracy: 0.9637118  Vali weighted F1: 0.9638825  Vali macro F1 0.9473962 
new best score!!!!
Validation loss decreased (0.122017 --> 0.108628).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.027112007141113
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.1165578  Vali Loss: 0.1074947 Vali Accuracy: 0.9631934  Vali weighted F1: 0.9631817  Vali macro F1 0.9451003 
new best score!!!!
Validation loss decreased (0.108628 --> 0.107495).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.023430824279785
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.1062758  Vali Loss: 0.1098835 Vali Accuracy: 0.9611198  Vali weighted F1: 0.9613147  Vali macro F1 0.9446124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.024989366531372
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.1078133  Vali Loss: 0.1132106 Vali Accuracy: 0.9574909  Vali weighted F1: 0.9569016  Vali macro F1 0.9367720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.0192646980285645
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0986790  Vali Loss: 0.1021955 Vali Accuracy: 0.9626750  Vali weighted F1: 0.9626264  Vali macro F1 0.9471138 
new best score!!!!
Validation loss decreased (0.107495 --> 0.102195).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.031129360198975
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0959822  Vali Loss: 0.0916714 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9672831  Vali macro F1 0.9496751 
new best score!!!!
Validation loss decreased (0.102195 --> 0.091671).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.0216593742370605
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0906088  Vali Loss: 0.0806553 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9735717  Vali macro F1 0.9630901 
new best score!!!!
Validation loss decreased (0.091671 --> 0.080655).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.035238742828369
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0841000  Vali Loss: 0.0840854 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9669601  Vali macro F1 0.9510518 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.018477439880371
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0821248  Vali Loss: 0.0745396 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757793  Vali macro F1 0.9660690 
new best score!!!!
Validation loss decreased (0.080655 --> 0.074540).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.028191566467285
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0852371  Vali Loss: 0.0769471 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9721412  Vali macro F1 0.9536194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.013318777084351
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0770250  Vali Loss: 0.0854448 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9678327  Vali macro F1 0.9586128 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.0236592292785645
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0687206  Vali Loss: 0.0733175 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9725249  Vali macro F1 0.9611197 
new best score!!!!
Validation loss decreased (0.074540 --> 0.073317).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.029112815856934
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0663547  Vali Loss: 0.0687454 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9746613  Vali macro F1 0.9644299 
new best score!!!!
Validation loss decreased (0.073317 --> 0.068745).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.032483339309692
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0697572  Vali Loss: 0.1005137 Vali Accuracy: 0.9663038  Vali weighted F1: 0.9667654  Vali macro F1 0.9546250 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.036139726638794
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0658424  Vali Loss: 0.0669786 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9793238  Vali macro F1 0.9699334 
new best score!!!!
Validation loss decreased (0.068745 --> 0.066979).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.028902769088745
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0593625  Vali Loss: 0.0855803 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9736216  Vali macro F1 0.9627991 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.065418004989624
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0625355  Vali Loss: 0.0646499 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9779610  Vali macro F1 0.9682289 
new best score!!!!
Validation loss decreased (0.066979 --> 0.064650).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.03435754776001
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0564761  Vali Loss: 0.0658481 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9773407  Vali macro F1 0.9667569 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.028874158859253
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0530018  Vali Loss: 0.0740838 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9743634  Vali macro F1 0.9654365 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.026524066925049
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0565561  Vali Loss: 0.0712554 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9758189  Vali macro F1 0.9655890 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.030274152755737
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0451488  Vali Loss: 0.0654002 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9799188  Vali macro F1 0.9715491 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.026498556137085
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0462108  Vali Loss: 0.0596278 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9789828  Vali macro F1 0.9692698 
new best score!!!!
Validation loss decreased (0.064650 --> 0.059628).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.041587591171265
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0406132  Vali Loss: 0.0619038 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797262  Vali macro F1 0.9694363 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 8.210773944854736
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0468787  Vali Loss: 0.0636534 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9800524  Vali macro F1 0.9703197 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.040341138839722
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0442328  Vali Loss: 0.0688574 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9775118  Vali macro F1 0.9684651 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.0635905265808105
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0398269  Vali Loss: 0.0539407 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9830226  Vali macro F1 0.9752319 
new best score!!!!
Validation loss decreased (0.059628 --> 0.053941).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.033679962158203
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0409218  Vali Loss: 0.0579645 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829424  Vali macro F1 0.9747378 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.0400230884552
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0390080  Vali Loss: 0.0584873 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9825211  Vali macro F1 0.9737712 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.0270233154296875
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0341761  Vali Loss: 0.0649289 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9783920  Vali macro F1 0.9686149 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.017754793167114
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0371398  Vali Loss: 0.0742006 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9759015  Vali macro F1 0.9657334 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.03266716003418
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0379349  Vali Loss: 0.0646760 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9799964  Vali macro F1 0.9693459 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 6.019979953765869
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0256880  Vali Loss: 0.0519542 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9814439  Vali macro F1 0.9717660 
new best score!!!!
Validation loss decreased (0.053941 --> 0.051954).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.027303695678711
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0246114  Vali Loss: 0.0566293 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9799165  Vali macro F1 0.9695853 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.03413200378418
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0232713  Vali Loss: 0.0550659 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819354  Vali macro F1 0.9728333 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.041855335235596
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0231144  Vali Loss: 0.0568388 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824807  Vali macro F1 0.9737176 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.0276710987091064
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0218913  Vali Loss: 0.0571624 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9830058  Vali macro F1 0.9746216 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.031187057495117
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0225666  Vali Loss: 0.0562737 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824813  Vali macro F1 0.9737466 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 55 cost time: 6.035120487213135
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0213095  Vali Loss: 0.0565097 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819805  Vali macro F1 0.9732604 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.017073154449463
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0208969  Vali Loss: 0.0563983 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819805  Vali macro F1 0.9732604 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.0173211097717285
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0208782  Vali Loss: 0.0567768 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819805  Vali macro F1 0.9732604 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.023507356643677
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0216926  Vali Loss: 0.0566672 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819805  Vali macro F1 0.9732604 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.016173839569092
VALI: Epoch: 59, Steps: 68 | Train Loss: 0.0209297  Vali Loss: 0.0568928 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824813  Vali macro F1 0.9737466 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 60 cost time: 6.024533987045288
VALI: Epoch: 60, Steps: 68 | Train Loss: 0.0206099  Vali Loss: 0.0569217 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824813  Vali macro F1 0.9737466 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.035999298095703
VALI: Epoch: 61, Steps: 68 | Train Loss: 0.0202276  Vali Loss: 0.0570096 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824813  Vali macro F1 0.9737466 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.03556489944458
VALI: Epoch: 62, Steps: 68 | Train Loss: 0.0205627  Vali Loss: 0.0569930 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824813  Vali macro F1 0.9737466 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.015767812728882
VALI: Epoch: 63, Steps: 68 | Train Loss: 0.0230493  Vali Loss: 0.0570728 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824813  Vali macro F1 0.9737466 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.015353679656982
VALI: Epoch: 64, Steps: 68 | Train Loss: 0.0195238  Vali Loss: 0.0570164 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824813  Vali macro F1 0.9737466 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9539575  Test weighted F1: 0.9540469  Test macro F1 0.9291479 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.025146245956421
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0247677  Vali Loss: 0.0546528 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9799332  Vali macro F1 0.9702428 
Validation loss decreased (inf --> 0.054653).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.9991302490234375
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0226832  Vali Loss: 0.0560345 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9834979  Vali macro F1 0.9747962 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.015191316604614
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0240763  Vali Loss: 0.0605791 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9804775  Vali macro F1 0.9717048 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.019410848617554
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0219733  Vali Loss: 0.0565274 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9809571  Vali macro F1 0.9712116 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.0230443477630615
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0216118  Vali Loss: 0.0599888 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9820211  Vali macro F1 0.9742640 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.043904781341553
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0206294  Vali Loss: 0.0592156 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9819961  Vali macro F1 0.9736105 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.031698942184448
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0208388  Vali Loss: 0.0575252 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9814874  Vali macro F1 0.9727840 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.0150978565216064
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0219417  Vali Loss: 0.0594594 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9799596  Vali macro F1 0.9714708 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.01955509185791
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0200570  Vali Loss: 0.0577583 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9835319  Vali macro F1 0.9758011 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.982008934020996
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0196131  Vali Loss: 0.0611337 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9835156  Vali macro F1 0.9750748 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 5.983753204345703
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0193740  Vali Loss: 0.0586010 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9814594  Vali macro F1 0.9729813 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 5.990093946456909
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0183616  Vali Loss: 0.0570906 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824716  Vali macro F1 0.9743263 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 5.983966827392578
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0178428  Vali Loss: 0.0582361 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824608  Vali macro F1 0.9739833 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.9898011684417725
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0177269  Vali Loss: 0.0584318 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9814593  Vali macro F1 0.9730099 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.015315294265747
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0186306  Vali Loss: 0.0587271 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9804525  Vali macro F1 0.9717014 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 5.988076686859131
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0181495  Vali Loss: 0.0589222 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9804525  Vali macro F1 0.9717014 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9504158  Test weighted F1: 0.9508356  Test macro F1 0.9257675 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014843 0.00018235 0.00095238 0.00126904 0.00049925 0.00061652]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.0996925830841064
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2037536  Vali Loss: 0.7625976 Vali Accuracy: 0.6758270  Vali weighted F1: 0.5698354  Vali macro F1 0.2779843 
Validation loss decreased (inf --> 0.762598).  Saving model ...
Epoch: 2 cost time: 6.096796274185181
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6460285  Vali Loss: 0.5233421 Vali Accuracy: 0.7882952  Vali weighted F1: 0.7380426  Vali macro F1 0.5248808 
new best score!!!!
Validation loss decreased (0.762598 --> 0.523342).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.106146574020386
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4848113  Vali Loss: 0.4708950 Vali Accuracy: 0.8346056  Vali weighted F1: 0.8101272  Vali macro F1 0.7675577 
new best score!!!!
Validation loss decreased (0.523342 --> 0.470895).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.095961570739746
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3777241  Vali Loss: 0.3229884 Vali Accuracy: 0.8834606  Vali weighted F1: 0.8754258  Vali macro F1 0.8313164 
new best score!!!!
Validation loss decreased (0.470895 --> 0.322988).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.109853506088257
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3197066  Vali Loss: 0.3052223 Vali Accuracy: 0.8961832  Vali weighted F1: 0.8899076  Vali macro F1 0.8545552 
new best score!!!!
Validation loss decreased (0.322988 --> 0.305222).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.145445108413696
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2759960  Vali Loss: 0.2364185 Vali Accuracy: 0.9165394  Vali weighted F1: 0.9132647  Vali macro F1 0.8876827 
new best score!!!!
Validation loss decreased (0.305222 --> 0.236418).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.137514591217041
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2277626  Vali Loss: 0.1848616 Vali Accuracy: 0.9358779  Vali weighted F1: 0.9363640  Vali macro F1 0.9144877 
new best score!!!!
Validation loss decreased (0.236418 --> 0.184862).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.125750541687012
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2034703  Vali Loss: 0.1840315 Vali Accuracy: 0.9394402  Vali weighted F1: 0.9375584  Vali macro F1 0.9153644 
new best score!!!!
Validation loss decreased (0.184862 --> 0.184031).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.104381561279297
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1867256  Vali Loss: 0.1726888 Vali Accuracy: 0.9440204  Vali weighted F1: 0.9426974  Vali macro F1 0.9232597 
new best score!!!!
Validation loss decreased (0.184031 --> 0.172689).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.11568546295166
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1775887  Vali Loss: 0.1437872 Vali Accuracy: 0.9521628  Vali weighted F1: 0.9517624  Vali macro F1 0.9340025 
new best score!!!!
Validation loss decreased (0.172689 --> 0.143787).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.112760782241821
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1682465  Vali Loss: 0.1881466 Vali Accuracy: 0.9348601  Vali weighted F1: 0.9341264  Vali macro F1 0.9118826 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.112507343292236
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1579907  Vali Loss: 0.1278514 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9559477  Vali macro F1 0.9388373 
new best score!!!!
Validation loss decreased (0.143787 --> 0.127851).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.11876106262207
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1494947  Vali Loss: 0.1318754 Vali Accuracy: 0.9562341  Vali weighted F1: 0.9562354  Vali macro F1 0.9405050 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.118489742279053
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1443872  Vali Loss: 0.1158764 Vali Accuracy: 0.9577608  Vali weighted F1: 0.9578275  Vali macro F1 0.9410786 
new best score!!!!
Validation loss decreased (0.127851 --> 0.115876).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.130247116088867
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1294170  Vali Loss: 0.1873482 Vali Accuracy: 0.9368957  Vali weighted F1: 0.9384459  Vali macro F1 0.9269811 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.139172554016113
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1224249  Vali Loss: 0.1180887 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9603368  Vali macro F1 0.9440607 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.118995666503906
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1151591  Vali Loss: 0.1047806 Vali Accuracy: 0.9618321  Vali weighted F1: 0.9619220  Vali macro F1 0.9458859 
new best score!!!!
Validation loss decreased (0.115876 --> 0.104781).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.141555070877075
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1133601  Vali Loss: 0.1124023 Vali Accuracy: 0.9623410  Vali weighted F1: 0.9624173  Vali macro F1 0.9464275 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.114948511123657
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1094610  Vali Loss: 0.1024197 Vali Accuracy: 0.9664122  Vali weighted F1: 0.9663498  Vali macro F1 0.9508342 
new best score!!!!
Validation loss decreased (0.104781 --> 0.102420).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.105525255203247
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1094327  Vali Loss: 0.1168893 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9635373  Vali macro F1 0.9484915 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.107899904251099
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.1001906  Vali Loss: 0.0899111 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9703287  Vali macro F1 0.9571154 
new best score!!!!
Validation loss decreased (0.102420 --> 0.089911).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.118461847305298
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0960333  Vali Loss: 0.0916294 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9681377  Vali macro F1 0.9546310 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.115381240844727
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0865597  Vali Loss: 0.0792354 Vali Accuracy: 0.9709924  Vali weighted F1: 0.9711199  Vali macro F1 0.9574853 
new best score!!!!
Validation loss decreased (0.089911 --> 0.079235).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.148834943771362
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0867554  Vali Loss: 0.0937483 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9680088  Vali macro F1 0.9528755 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.137113332748413
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0837166  Vali Loss: 0.0780009 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9720233  Vali macro F1 0.9594050 
new best score!!!!
Validation loss decreased (0.079235 --> 0.078001).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.130080223083496
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0796150  Vali Loss: 0.0955967 Vali Accuracy: 0.9694656  Vali weighted F1: 0.9694742  Vali macro F1 0.9582058 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.123682975769043
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0864920  Vali Loss: 0.0915822 Vali Accuracy: 0.9669211  Vali weighted F1: 0.9673560  Vali macro F1 0.9598197 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.116687059402466
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0712279  Vali Loss: 0.1428421 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9567833  Vali macro F1 0.9436095 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.118536472320557
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0971072  Vali Loss: 0.0826165 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9724297  Vali macro F1 0.9601597 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.119504928588867
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0678485  Vali Loss: 0.0770511 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9763544  Vali macro F1 0.9698933 
new best score!!!!
Validation loss decreased (0.078001 --> 0.077051).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.112081289291382
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0668896  Vali Loss: 0.0835132 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9719384  Vali macro F1 0.9645679 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.109870433807373
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0636455  Vali Loss: 0.0696648 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9781417  Vali macro F1 0.9732240 
new best score!!!!
Validation loss decreased (0.077051 --> 0.069665).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.13775110244751
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0549533  Vali Loss: 0.0656688 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9807657  Vali macro F1 0.9752551 
new best score!!!!
Validation loss decreased (0.069665 --> 0.065669).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.1305084228515625
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0526187  Vali Loss: 0.0659311 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9780467  Vali macro F1 0.9722263 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.117234468460083
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0653295  Vali Loss: 0.0684575 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9782342  Vali macro F1 0.9718956 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.114863634109497
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0503651  Vali Loss: 0.0668721 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9802301  Vali macro F1 0.9748198 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.116232395172119
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0460816  Vali Loss: 0.0746445 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9764758  Vali macro F1 0.9710612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.124070167541504
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0453539  Vali Loss: 0.0614983 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838412  Vali macro F1 0.9804855 
new best score!!!!
Validation loss decreased (0.065669 --> 0.061498).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.122061252593994
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0463102  Vali Loss: 0.0693887 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9788450  Vali macro F1 0.9733328 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.1101109981536865
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0442080  Vali Loss: 0.0718678 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9789065  Vali macro F1 0.9739256 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.122103214263916
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0484889  Vali Loss: 0.0610272 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9816933  Vali macro F1 0.9779077 
new best score!!!!
Validation loss decreased (0.061498 --> 0.061027).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.141902923583984
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0473277  Vali Loss: 0.0719132 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9806542  Vali macro F1 0.9739877 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.1375250816345215
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0433942  Vali Loss: 0.0659964 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9806445  Vali macro F1 0.9750783 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.131261587142944
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0411289  Vali Loss: 0.1056772 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9671363  Vali macro F1 0.9553053 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.121387958526611
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0402622  Vali Loss: 0.0615073 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9821216  Vali macro F1 0.9785501 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.124462842941284
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0319467  Vali Loss: 0.0533320 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853307  Vali macro F1 0.9824970 
new best score!!!!
Validation loss decreased (0.061027 --> 0.053332).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.115827798843384
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0326672  Vali Loss: 0.0629256 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817332  Vali macro F1 0.9767532 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.127312898635864
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0342027  Vali Loss: 0.0688932 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9813644  Vali macro F1 0.9776435 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.112471342086792
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0313463  Vali Loss: 0.0591631 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858049  Vali macro F1 0.9824450 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.123461484909058
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0318526  Vali Loss: 0.0668989 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833699  Vali macro F1 0.9799637 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.144106864929199
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0297735  Vali Loss: 0.0633602 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823306  Vali macro F1 0.9770886 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 52 cost time: 6.1341166496276855
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0239950  Vali Loss: 0.0555469 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847822  Vali macro F1 0.9813059 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.1260459423065186
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0200416  Vali Loss: 0.0557942 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863601  Vali macro F1 0.9833145 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.116297483444214
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0192246  Vali Loss: 0.0543368 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858473  Vali macro F1 0.9825158 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.1172966957092285
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0204597  Vali Loss: 0.0538030 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873388  Vali macro F1 0.9844498 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.114655494689941
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0188706  Vali Loss: 0.0545396 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868397  Vali macro F1 0.9836455 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 6.109224081039429
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0172264  Vali Loss: 0.0536531 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.117336750030518
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0174228  Vali Loss: 0.0536471 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.112525463104248
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0170158  Vali Loss: 0.0532244 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
new best score!!!!
Validation loss decreased (0.053332 --> 0.053224).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.14336633682251
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0171224  Vali Loss: 0.0533688 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.118359088897705
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0164622  Vali Loss: 0.0530881 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
new best score!!!!
Validation loss decreased (0.053224 --> 0.053088).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 6.1090404987335205
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0175251  Vali Loss: 0.0527745 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873339  Vali macro F1 0.9848817 
new best score!!!!
Validation loss decreased (0.053088 --> 0.052774).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 6.102839231491089
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0180056  Vali Loss: 0.0527813 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873339  Vali macro F1 0.9848817 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 6.097636938095093
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0165934  Vali Loss: 0.0533258 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 6.109682083129883
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0176722  Vali Loss: 0.0534597 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 6.097260475158691
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0173550  Vali Loss: 0.0530982 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 6.098281621932983
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0161499  Vali Loss: 0.0532602 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 68 cost time: 6.106879949569702
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0183267  Vali Loss: 0.0532707 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 6.127608060836792
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0167874  Vali Loss: 0.0531964 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 6.124458074569702
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0179010  Vali Loss: 0.0532425 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 6.129202842712402
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0170967  Vali Loss: 0.0531252 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 6.108251333236694
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0171193  Vali Loss: 0.0529854 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 73 cost time: 6.1157824993133545
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0171378  Vali Loss: 0.0529985 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 6.116334676742554
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0166487  Vali Loss: 0.0530082 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 6.112725257873535
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0175749  Vali Loss: 0.0530107 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 6.119628429412842
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0174078  Vali Loss: 0.0530187 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 6.1175384521484375
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0175952  Vali Loss: 0.0530253 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873502  Vali macro F1 0.9845915 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8445401  Test weighted F1: 0.8531157  Test macro F1 0.8562264 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.144060850143433
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0201831  Vali Loss: 0.0533263 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863336  Vali macro F1 0.9838755 
Validation loss decreased (inf --> 0.053326).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.1202003955841064
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0179384  Vali Loss: 0.0556556 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853594  Vali macro F1 0.9820479 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.104348659515381
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0178570  Vali Loss: 0.0552583 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853430  Vali macro F1 0.9823343 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.10694694519043
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0175293  Vali Loss: 0.0555472 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863480  Vali macro F1 0.9832922 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.1144654750823975
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0183253  Vali Loss: 0.0554189 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858623  Vali macro F1 0.9825125 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.115957021713257
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0194471  Vali Loss: 0.0574837 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863124  Vali macro F1 0.9837758 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.105414628982544
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0161601  Vali Loss: 0.0542059 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863463  Vali macro F1 0.9833195 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.109891176223755
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0154526  Vali Loss: 0.0546718 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863434  Vali macro F1 0.9836306 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.1077492237091064
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0165192  Vali Loss: 0.0570619 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873684  Vali macro F1 0.9842826 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.144148826599121
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0160244  Vali Loss: 0.0543105 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883550  Vali macro F1 0.9859590 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.135622262954712
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0154145  Vali Loss: 0.0550094 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873609  Vali macro F1 0.9846160 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.118634462356567
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0143644  Vali Loss: 0.0551199 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878675  Vali macro F1 0.9850866 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.115167617797852
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0146214  Vali Loss: 0.0559084 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873684  Vali macro F1 0.9842826 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.1171348094940186
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0140587  Vali Loss: 0.0556882 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878675  Vali macro F1 0.9850866 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.1159281730651855
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0144389  Vali Loss: 0.0553914 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873566  Vali macro F1 0.9842561 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.117249488830566
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0147134  Vali Loss: 0.0553062 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873566  Vali macro F1 0.9842561 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8352161  Test weighted F1: 0.8434893  Test macro F1 0.8503508 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014899 0.00018302 0.000998   0.00125313 0.00052329 0.00063052]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.040554046630859
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.2093183  Vali Loss: 0.8041072 Vali Accuracy: 0.6622039  Vali weighted F1: 0.5500614  Vali macro F1 0.2706287 
Validation loss decreased (inf --> 0.804107).  Saving model ...
Epoch: 2 cost time: 6.0237977504730225
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.6763392  Vali Loss: 0.5719122 Vali Accuracy: 0.7842430  Vali weighted F1: 0.7396630  Vali macro F1 0.5443082 
new best score!!!!
Validation loss decreased (0.804107 --> 0.571912).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.040802001953125
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.4888879  Vali Loss: 0.4456214 Vali Accuracy: 0.8491246  Vali weighted F1: 0.8358298  Vali macro F1 0.7957494 
new best score!!!!
Validation loss decreased (0.571912 --> 0.445621).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.030991077423096
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.3743735  Vali Loss: 0.3741969 Vali Accuracy: 0.8645726  Vali weighted F1: 0.8470652  Vali macro F1 0.8119047 
new best score!!!!
Validation loss decreased (0.445621 --> 0.374197).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.024780511856079
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.3010034  Vali Loss: 0.2535944 Vali Accuracy: 0.9109166  Vali weighted F1: 0.9073255  Vali macro F1 0.8823044 
new best score!!!!
Validation loss decreased (0.374197 --> 0.253594).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.026369094848633
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2503683  Vali Loss: 0.2326092 Vali Accuracy: 0.9217302  Vali weighted F1: 0.9173125  Vali macro F1 0.8933740 
new best score!!!!
Validation loss decreased (0.253594 --> 0.232609).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.025978326797485
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.2389066  Vali Loss: 0.2277920 Vali Accuracy: 0.9253347  Vali weighted F1: 0.9210385  Vali macro F1 0.9006816 
new best score!!!!
Validation loss decreased (0.232609 --> 0.227792).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.040210247039795
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.2154121  Vali Loss: 0.1880340 Vali Accuracy: 0.9340886  Vali weighted F1: 0.9333060  Vali macro F1 0.9124652 
new best score!!!!
Validation loss decreased (0.227792 --> 0.188034).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.030055522918701
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1884309  Vali Loss: 0.1713637 Vali Accuracy: 0.9423275  Vali weighted F1: 0.9424502  Vali macro F1 0.9238124 
new best score!!!!
Validation loss decreased (0.188034 --> 0.171364).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.0374064445495605
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1837363  Vali Loss: 0.1689474 Vali Accuracy: 0.9418126  Vali weighted F1: 0.9419163  Vali macro F1 0.9223111 
new best score!!!!
Validation loss decreased (0.171364 --> 0.168947).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.036434888839722
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1736588  Vali Loss: 0.1654106 Vali Accuracy: 0.9402678  Vali weighted F1: 0.9387745  Vali macro F1 0.9179527 
new best score!!!!
Validation loss decreased (0.168947 --> 0.165411).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.055527448654175
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1660418  Vali Loss: 0.1640512 Vali Accuracy: 0.9443872  Vali weighted F1: 0.9428544  Vali macro F1 0.9246844 
new best score!!!!
Validation loss decreased (0.165411 --> 0.164051).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.027910947799683
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1623853  Vali Loss: 0.1488787 Vali Accuracy: 0.9469619  Vali weighted F1: 0.9471362  Vali macro F1 0.9291016 
new best score!!!!
Validation loss decreased (0.164051 --> 0.148879).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.029581069946289
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1543671  Vali Loss: 0.1387135 Vali Accuracy: 0.9552008  Vali weighted F1: 0.9549041  Vali macro F1 0.9402483 
new best score!!!!
Validation loss decreased (0.148879 --> 0.138714).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.0283308029174805
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1406954  Vali Loss: 0.1335852 Vali Accuracy: 0.9552008  Vali weighted F1: 0.9548177  Vali macro F1 0.9369014 
new best score!!!!
Validation loss decreased (0.138714 --> 0.133585).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.024811506271362
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1399476  Vali Loss: 0.1303980 Vali Accuracy: 0.9567456  Vali weighted F1: 0.9566673  Vali macro F1 0.9412860 
new best score!!!!
Validation loss decreased (0.133585 --> 0.130398).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.031969785690308
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1270513  Vali Loss: 0.1259031 Vali Accuracy: 0.9582904  Vali weighted F1: 0.9581454  Vali macro F1 0.9417448 
new best score!!!!
Validation loss decreased (0.130398 --> 0.125903).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.035812616348267
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.1255294  Vali Loss: 0.1273989 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9604399  Vali macro F1 0.9465454 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.033729791641235
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.1217135  Vali Loss: 0.1273633 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9585900  Vali macro F1 0.9417795 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.043829917907715
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.1231061  Vali Loss: 0.1377282 Vali Accuracy: 0.9572606  Vali weighted F1: 0.9573194  Vali macro F1 0.9410382 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.062625408172607
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.1099794  Vali Loss: 0.1153459 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9652494  Vali macro F1 0.9523194 
new best score!!!!
Validation loss decreased (0.125903 --> 0.115346).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.038139581680298
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.1072576  Vali Loss: 0.1070554 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9667361  Vali macro F1 0.9536350 
new best score!!!!
Validation loss decreased (0.115346 --> 0.107055).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.036487579345703
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.1046795  Vali Loss: 0.1155517 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9651578  Vali macro F1 0.9500576 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.0288450717926025
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0988608  Vali Loss: 0.1088633 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9635722  Vali macro F1 0.9470383 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.041287899017334
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0958549  Vali Loss: 0.1014931 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9630544  Vali macro F1 0.9472944 
new best score!!!!
Validation loss decreased (0.107055 --> 0.101493).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.034886121749878
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0886359  Vali Loss: 0.1216251 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9636840  Vali macro F1 0.9487303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.026136159896851
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0942202  Vali Loss: 0.1441213 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9545408  Vali macro F1 0.9401463 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.045931577682495
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0856047  Vali Loss: 0.0985788 Vali Accuracy: 0.9675592  Vali weighted F1: 0.9675003  Vali macro F1 0.9518002 
new best score!!!!
Validation loss decreased (0.101493 --> 0.098579).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.044862270355225
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0792611  Vali Loss: 0.1160000 Vali Accuracy: 0.9654995  Vali weighted F1: 0.9651246  Vali macro F1 0.9514035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.040835380554199
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0944880  Vali Loss: 0.0960071 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9682939  Vali macro F1 0.9545012 
new best score!!!!
Validation loss decreased (0.098579 --> 0.096007).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.039477109909058
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0769626  Vali Loss: 0.0929530 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9695640  Vali macro F1 0.9542849 
new best score!!!!
Validation loss decreased (0.096007 --> 0.092953).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.020291566848755
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0725195  Vali Loss: 0.0908993 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9732496  Vali macro F1 0.9648512 
new best score!!!!
Validation loss decreased (0.092953 --> 0.090899).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.037109851837158
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0688515  Vali Loss: 0.0910835 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9723264  Vali macro F1 0.9615578 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.031970024108887
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0631749  Vali Loss: 0.0829626 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747938  Vali macro F1 0.9670222 
new best score!!!!
Validation loss decreased (0.090899 --> 0.082963).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.0432891845703125
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0647598  Vali Loss: 0.1056111 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9681230  Vali macro F1 0.9604687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.037766695022583
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0601995  Vali Loss: 0.0952467 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9726817  Vali macro F1 0.9657427 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.0368568897247314
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0576466  Vali Loss: 0.0975631 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9694540  Vali macro F1 0.9582361 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.0434184074401855
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0652663  Vali Loss: 0.0839423 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9763481  Vali macro F1 0.9681617 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.0434370040893555
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0602635  Vali Loss: 0.0902014 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9704121  Vali macro F1 0.9633544 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 6.056395769119263
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0445004  Vali Loss: 0.0767099 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773748  Vali macro F1 0.9711261 
new best score!!!!
Validation loss decreased (0.082963 --> 0.076710).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.0406882762908936
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0405092  Vali Loss: 0.0790453 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773292  Vali macro F1 0.9713412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.035858631134033
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0397025  Vali Loss: 0.0762937 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783875  Vali macro F1 0.9723844 
new best score!!!!
Validation loss decreased (0.076710 --> 0.076294).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.046795845031738
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0399797  Vali Loss: 0.0785321 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783723  Vali macro F1 0.9737218 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.052688837051392
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0377905  Vali Loss: 0.0767405 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794341  Vali macro F1 0.9747496 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.055116176605225
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0379007  Vali Loss: 0.0792871 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783740  Vali macro F1 0.9737106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.054104566574097
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0381600  Vali Loss: 0.0771443 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783894  Vali macro F1 0.9734339 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.05115818977356
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0380123  Vali Loss: 0.0759094 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9779384  Vali macro F1 0.9727419 
new best score!!!!
Validation loss decreased (0.076294 --> 0.075909).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.0520946979522705
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0378193  Vali Loss: 0.0748049 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794349  Vali macro F1 0.9747576 
new best score!!!!
Validation loss decreased (0.075909 --> 0.074805).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.054094314575195
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0374587  Vali Loss: 0.0805902 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783745  Vali macro F1 0.9742834 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.039259910583496
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0376420  Vali Loss: 0.0750513 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9778754  Vali macro F1 0.9726385 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.0419862270355225
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0348697  Vali Loss: 0.0743579 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789198  Vali macro F1 0.9739469 
new best score!!!!
Validation loss decreased (0.074805 --> 0.074358).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.035335302352905
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0366331  Vali Loss: 0.0744146 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784038  Vali macro F1 0.9736944 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.031721115112305
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0339126  Vali Loss: 0.0757504 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9788888  Vali macro F1 0.9745143 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.040616750717163
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0330352  Vali Loss: 0.0747780 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773766  Vali macro F1 0.9720976 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.033087968826294
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0335763  Vali Loss: 0.0764631 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783894  Vali macro F1 0.9734339 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.049088954925537
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0361475  Vali Loss: 0.0743872 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789296  Vali macro F1 0.9742595 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 6.042153358459473
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0342750  Vali Loss: 0.0740150 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789027  Vali macro F1 0.9742215 
new best score!!!!
Validation loss decreased (0.074358 --> 0.074015).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 6.067058563232422
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0332311  Vali Loss: 0.0739536 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783888  Vali macro F1 0.9734259 
new best score!!!!
Validation loss decreased (0.074015 --> 0.073954).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 6.0464186668396
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0309987  Vali Loss: 0.0745947 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783888  Vali macro F1 0.9734259 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.0411152839660645
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0327078  Vali Loss: 0.0741548 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783888  Vali macro F1 0.9734259 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 6.030381202697754
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0333516  Vali Loss: 0.0741005 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783888  Vali macro F1 0.9734259 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 6.044019460678101
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0322729  Vali Loss: 0.0743712 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783888  Vali macro F1 0.9734259 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 6.051887273788452
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0329302  Vali Loss: 0.0739769 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783894  Vali macro F1 0.9734339 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 64 cost time: 6.04331374168396
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0317987  Vali Loss: 0.0740887 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 6.048316240310669
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0317625  Vali Loss: 0.0741832 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 6.043851137161255
VALI: Epoch: 66, Steps: 69 | Train Loss: 0.0316028  Vali Loss: 0.0742516 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 6.061675548553467
VALI: Epoch: 67, Steps: 69 | Train Loss: 0.0306948  Vali Loss: 0.0742587 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 6.045986890792847
VALI: Epoch: 68, Steps: 69 | Train Loss: 0.0308964  Vali Loss: 0.0742634 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 69 cost time: 6.203990936279297
VALI: Epoch: 69, Steps: 69 | Train Loss: 0.0315991  Vali Loss: 0.0742515 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.175710916519165
VALI: Epoch: 70, Steps: 69 | Train Loss: 0.0325678  Vali Loss: 0.0742546 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.038837194442749
VALI: Epoch: 71, Steps: 69 | Train Loss: 0.0316835  Vali Loss: 0.0742610 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.042953014373779
VALI: Epoch: 72, Steps: 69 | Train Loss: 0.0326585  Vali Loss: 0.0742584 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.029237985610962
VALI: Epoch: 73, Steps: 69 | Train Loss: 0.0325164  Vali Loss: 0.0742533 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9589898  Test weighted F1: 0.9575689  Test macro F1 0.9425473 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.060088396072388
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0356320  Vali Loss: 0.0762419 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
Validation loss decreased (inf --> 0.076242).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.046090602874756
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0336988  Vali Loss: 0.0732974 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783899  Vali macro F1 0.9733814 
new best score!!!!
Validation loss decreased (0.076242 --> 0.073297).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.040752410888672
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0327483  Vali Loss: 0.0736967 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784151  Vali macro F1 0.9740164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.02383828163147
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0330564  Vali Loss: 0.0773654 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789035  Vali macro F1 0.9742295 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.053513288497925
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0310093  Vali Loss: 0.0748588 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794179  Vali macro F1 0.9750324 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.044024705886841
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0333745  Vali Loss: 0.0772262 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783926  Vali macro F1 0.9736757 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.050276756286621
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0318731  Vali Loss: 0.0760047 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789027  Vali macro F1 0.9742215 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.03992772102356
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0313160  Vali Loss: 0.0738398 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784185  Vali macro F1 0.9734482 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.033144474029541
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0318286  Vali Loss: 0.0739841 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794311  Vali macro F1 0.9752912 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.0432822704315186
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0318570  Vali Loss: 0.0741908 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789145  Vali macro F1 0.9744782 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.047297954559326
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0298625  Vali Loss: 0.0779003 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9768277  Vali macro F1 0.9712565 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.062794923782349
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0296005  Vali Loss: 0.0770903 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9784035  Vali macro F1 0.9737666 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.039961814880371
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0279716  Vali Loss: 0.0739678 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794450  Vali macro F1 0.9750442 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.0387961864471436
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0277987  Vali Loss: 0.0751890 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789016  Vali macro F1 0.9747728 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.034823656082153
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0284501  Vali Loss: 0.0744860 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789016  Vali macro F1 0.9747728 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.0399651527404785
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0286065  Vali Loss: 0.0747429 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789016  Vali macro F1 0.9747728 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.038811445236206
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0294984  Vali Loss: 0.0749544 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789016  Vali macro F1 0.9747728 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9611012  Test weighted F1: 0.9596771  Test macro F1 0.9449603 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014986 0.00018779 0.00137741 0.00144092 0.00052356 0.00064392]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.8404529094696045
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.2159837  Vali Loss: 0.6937544 Vali Accuracy: 0.7148188  Vali weighted F1: 0.6146476  Vali macro F1 0.2853704 
Validation loss decreased (inf --> 0.693754).  Saving model ...
Epoch: 2 cost time: 5.8449578285217285
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.6331805  Vali Loss: 0.5127903 Vali Accuracy: 0.7979744  Vali weighted F1: 0.7596868  Vali macro F1 0.5347569 
new best score!!!!
Validation loss decreased (0.693754 --> 0.512790).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.8481128215789795
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.4866808  Vali Loss: 0.3916774 Vali Accuracy: 0.8400853  Vali weighted F1: 0.8220857  Vali macro F1 0.6229755 
new best score!!!!
Validation loss decreased (0.512790 --> 0.391677).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.810153961181641
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.3794169  Vali Loss: 0.3243324 Vali Accuracy: 0.8928571  Vali weighted F1: 0.8886888  Vali macro F1 0.8585232 
new best score!!!!
Validation loss decreased (0.391677 --> 0.324332).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.830150842666626
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2953701  Vali Loss: 0.2823512 Vali Accuracy: 0.9147122  Vali weighted F1: 0.9085565  Vali macro F1 0.8920837 
new best score!!!!
Validation loss decreased (0.324332 --> 0.282351).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.835504531860352
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.2501810  Vali Loss: 0.2095079 Vali Accuracy: 0.9408316  Vali weighted F1: 0.9409509  Vali macro F1 0.9291170 
new best score!!!!
Validation loss decreased (0.282351 --> 0.209508).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.81967830657959
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.2217406  Vali Loss: 0.1907472 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9476879  Vali macro F1 0.9375026 
new best score!!!!
Validation loss decreased (0.209508 --> 0.190747).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.811386585235596
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.2082647  Vali Loss: 0.1895294 Vali Accuracy: 0.9450959  Vali weighted F1: 0.9438112  Vali macro F1 0.9340486 
new best score!!!!
Validation loss decreased (0.190747 --> 0.189529).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.799149990081787
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1850401  Vali Loss: 0.1716216 Vali Accuracy: 0.9482942  Vali weighted F1: 0.9478476  Vali macro F1 0.9355447 
new best score!!!!
Validation loss decreased (0.189529 --> 0.171622).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.795271873474121
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1868398  Vali Loss: 0.1573451 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9546653  Vali macro F1 0.9460681 
new best score!!!!
Validation loss decreased (0.171622 --> 0.157345).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.80853796005249
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1691583  Vali Loss: 0.1457069 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9579301  Vali macro F1 0.9500696 
new best score!!!!
Validation loss decreased (0.157345 --> 0.145707).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.824034929275513
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1608655  Vali Loss: 0.1437917 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9588995  Vali macro F1 0.9495931 
new best score!!!!
Validation loss decreased (0.145707 --> 0.143792).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.8090291023254395
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1480537  Vali Loss: 0.1346215 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9614471  Vali macro F1 0.9519723 
new best score!!!!
Validation loss decreased (0.143792 --> 0.134621).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.807555675506592
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1398786  Vali Loss: 0.1489065 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9583874  Vali macro F1 0.9503885 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.8015360832214355
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1359122  Vali Loss: 0.1245031 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9652269  Vali macro F1 0.9585192 
new best score!!!!
Validation loss decreased (0.134621 --> 0.124503).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.796802520751953
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1298583  Vali Loss: 0.1231359 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9654606  Vali macro F1 0.9551499 
new best score!!!!
Validation loss decreased (0.124503 --> 0.123136).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.788779258728027
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1198477  Vali Loss: 0.1234410 Vali Accuracy: 0.9632196  Vali weighted F1: 0.9634974  Vali macro F1 0.9508606 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.797262668609619
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.1161010  Vali Loss: 0.1096980 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9687347  Vali macro F1 0.9606436 
new best score!!!!
Validation loss decreased (0.123136 --> 0.109698).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.7958056926727295
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.1107306  Vali Loss: 0.1095179 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9717417  Vali macro F1 0.9642035 
new best score!!!!
Validation loss decreased (0.109698 --> 0.109518).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.792568206787109
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.1013294  Vali Loss: 0.1196544 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9658475  Vali macro F1 0.9578158 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.803176641464233
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0953000  Vali Loss: 0.0958182 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9735909  Vali macro F1 0.9657521 
new best score!!!!
Validation loss decreased (0.109518 --> 0.095818).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.8122711181640625
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0991557  Vali Loss: 0.1089718 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9673243  Vali macro F1 0.9585913 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.804493427276611
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0972527  Vali Loss: 0.1001458 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9733462  Vali macro F1 0.9648878 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.8001556396484375
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0860411  Vali Loss: 0.1075871 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9726919  Vali macro F1 0.9636027 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.792492389678955
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0899492  Vali Loss: 0.0988566 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9710090  Vali macro F1 0.9629021 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.795910835266113
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0823260  Vali Loss: 0.1107844 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9672098  Vali macro F1 0.9561983 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 5.795876502990723
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0689066  Vali Loss: 0.0825323 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777819  Vali macro F1 0.9707271 
new best score!!!!
Validation loss decreased (0.095818 --> 0.082532).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.799084424972534
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0665164  Vali Loss: 0.0885420 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788863  Vali macro F1 0.9722350 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.797363042831421
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0653761  Vali Loss: 0.0822292 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9809727  Vali macro F1 0.9754203 
new best score!!!!
Validation loss decreased (0.082532 --> 0.082229).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.816043138504028
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0629079  Vali Loss: 0.0810613 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9793137  Vali macro F1 0.9737184 
new best score!!!!
Validation loss decreased (0.082229 --> 0.081061).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.828175067901611
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0620576  Vali Loss: 0.0816658 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9770948  Vali macro F1 0.9707322 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.808213710784912
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0609738  Vali Loss: 0.0808314 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9798774  Vali macro F1 0.9738687 
new best score!!!!
Validation loss decreased (0.081061 --> 0.080831).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.803642988204956
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0599668  Vali Loss: 0.0786723 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9803517  Vali macro F1 0.9747794 
new best score!!!!
Validation loss decreased (0.080831 --> 0.078672).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.792912006378174
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0593932  Vali Loss: 0.0804144 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9804168  Vali macro F1 0.9752949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.790096759796143
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0588373  Vali Loss: 0.0821555 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781892  Vali macro F1 0.9723298 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.794836521148682
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0591599  Vali Loss: 0.0808602 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9767003  Vali macro F1 0.9699659 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.791448593139648
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0585348  Vali Loss: 0.0791332 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9766353  Vali macro F1 0.9697907 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.7866363525390625
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0568984  Vali Loss: 0.0801085 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9772727  Vali macro F1 0.9702524 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 5.799384355545044
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0558681  Vali Loss: 0.0789909 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9772028  Vali macro F1 0.9700954 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.806434631347656
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0533453  Vali Loss: 0.0786660 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782763  Vali macro F1 0.9715976 
new best score!!!!
Validation loss decreased (0.078672 --> 0.078666).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.819777250289917
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0555137  Vali Loss: 0.0788537 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777492  Vali macro F1 0.9706443 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.812490224838257
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0556258  Vali Loss: 0.0783928 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782566  Vali macro F1 0.9718639 
new best score!!!!
Validation loss decreased (0.078666 --> 0.078393).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.798027038574219
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0536432  Vali Loss: 0.0788919 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771836  Vali macro F1 0.9704306 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.808014154434204
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0542610  Vali Loss: 0.0782212 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777119  Vali macro F1 0.9713173 
new best score!!!!
Validation loss decreased (0.078393 --> 0.078221).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.812476873397827
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0538168  Vali Loss: 0.0782619 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777119  Vali macro F1 0.9713173 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.807798385620117
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0535689  Vali Loss: 0.0785760 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9761068  Vali macro F1 0.9689915 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.805175304412842
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0546123  Vali Loss: 0.0784161 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9760879  Vali macro F1 0.9692462 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.806966543197632
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0537226  Vali Loss: 0.0778712 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782899  Vali macro F1 0.9719921 
new best score!!!!
Validation loss decreased (0.078221 --> 0.077871).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 5.815292835235596
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0545046  Vali Loss: 0.0778134 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788003  Vali macro F1 0.9724086 
new best score!!!!
Validation loss decreased (0.077871 --> 0.077813).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 5.818878889083862
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0548502  Vali Loss: 0.0779608 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782858  Vali macro F1 0.9719164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.809365272521973
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0544824  Vali Loss: 0.0782528 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9761544  Vali macro F1 0.9693779 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 5.797929286956787
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0558484  Vali Loss: 0.0783708 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771836  Vali macro F1 0.9704306 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 5.798937082290649
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0543560  Vali Loss: 0.0782603 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771836  Vali macro F1 0.9704306 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 5.7953431606292725
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0543823  Vali Loss: 0.0773304 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782652  Vali macro F1 0.9720164 
new best score!!!!
Validation loss decreased (0.077813 --> 0.077330).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 5.798886299133301
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0548346  Vali Loss: 0.0782635 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777312  Vali macro F1 0.9710615 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 5.799378871917725
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0552907  Vali Loss: 0.0778120 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777207  Vali macro F1 0.9714700 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 5.8047895431518555
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0553498  Vali Loss: 0.0786176 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771836  Vali macro F1 0.9704306 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 5.808407783508301
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0546351  Vali Loss: 0.0776265 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9793518  Vali macro F1 0.9731141 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 5.820498704910278
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0533021  Vali Loss: 0.0775510 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771639  Vali macro F1 0.9707353 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 60 cost time: 5.8185834884643555
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0531945  Vali Loss: 0.0776153 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777150  Vali macro F1 0.9713914 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 5.798442840576172
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0539125  Vali Loss: 0.0775690 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777150  Vali macro F1 0.9713914 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 5.793307304382324
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0540810  Vali Loss: 0.0776426 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777150  Vali macro F1 0.9713914 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 5.787671327590942
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0518338  Vali Loss: 0.0777057 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771853  Vali macro F1 0.9705023 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 5.812444686889648
VALI: Epoch: 64, Steps: 66 | Train Loss: 0.0520360  Vali Loss: 0.0777921 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771853  Vali macro F1 0.9705023 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 65 cost time: 5.813442707061768
VALI: Epoch: 65, Steps: 66 | Train Loss: 0.0530672  Vali Loss: 0.0778063 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771853  Vali macro F1 0.9705023 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 5.797786235809326
VALI: Epoch: 66, Steps: 66 | Train Loss: 0.0522118  Vali Loss: 0.0778006 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771853  Vali macro F1 0.9705023 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 5.794618606567383
VALI: Epoch: 67, Steps: 66 | Train Loss: 0.0542950  Vali Loss: 0.0777988 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771853  Vali macro F1 0.9705023 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 5.808310270309448
VALI: Epoch: 68, Steps: 66 | Train Loss: 0.0541841  Vali Loss: 0.0778039 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771853  Vali macro F1 0.9705023 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 5.815244674682617
VALI: Epoch: 69, Steps: 66 | Train Loss: 0.0530782  Vali Loss: 0.0778059 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771853  Vali macro F1 0.9705023 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9032031  Test weighted F1: 0.9071756  Test macro F1 0.8668985 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.8241143226623535
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0539437  Vali Loss: 0.0785181 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788073  Vali macro F1 0.9724410 
Validation loss decreased (inf --> 0.078518).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.803701162338257
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0528069  Vali Loss: 0.0801573 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788326  Vali macro F1 0.9724764 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.797738075256348
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0541049  Vali Loss: 0.0810928 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9750556  Vali macro F1 0.9660976 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 5.803011894226074
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0537690  Vali Loss: 0.0804299 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9766783  Vali macro F1 0.9691280 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 5.817567348480225
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0517909  Vali Loss: 0.0752980 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9776471  Vali macro F1 0.9716257 
new best score!!!!
Validation loss decreased (0.078518 --> 0.075298).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 5.824616193771362
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0518822  Vali Loss: 0.0790551 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9783014  Vali macro F1 0.9723842 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.8141374588012695
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0523682  Vali Loss: 0.0791011 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9772043  Vali macro F1 0.9711803 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.82407808303833
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0498271  Vali Loss: 0.0761736 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9798409  Vali macro F1 0.9738445 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.837117910385132
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0505769  Vali Loss: 0.0813574 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9765753  Vali macro F1 0.9691657 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.815810203552246
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0526031  Vali Loss: 0.0749342 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788179  Vali macro F1 0.9721473 
new best score!!!!
Validation loss decreased (0.075298 --> 0.074934).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 5.812459707260132
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0495778  Vali Loss: 0.0781380 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9794079  Vali macro F1 0.9730864 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 5.810624361038208
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0486988  Vali Loss: 0.0830243 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9772967  Vali macro F1 0.9699332 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 5.820323467254639
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0498529  Vali Loss: 0.0798940 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9767192  Vali macro F1 0.9681413 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.805868864059448
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0469419  Vali Loss: 0.0815656 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9772748  Vali macro F1 0.9683047 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 5.813554525375366
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0494601  Vali Loss: 0.0835849 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9740429  Vali macro F1 0.9652983 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 5.814469814300537
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0488286  Vali Loss: 0.0796676 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9756641  Vali macro F1 0.9687569 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 5.811341762542725
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0464557  Vali Loss: 0.0812661 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9799701  Vali macro F1 0.9743575 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 5.821899652481079
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0448779  Vali Loss: 0.0812632 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9767215  Vali macro F1 0.9698215 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 5.8345372676849365
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0466217  Vali Loss: 0.0792813 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9783055  Vali macro F1 0.9716004 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 5.8246095180511475
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0449088  Vali Loss: 0.0777555 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9766748  Vali macro F1 0.9699200 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 5.804169178009033
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0450522  Vali Loss: 0.0758382 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9804606  Vali macro F1 0.9748934 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 5.821792840957642
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0443049  Vali Loss: 0.0758901 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9804467  Vali macro F1 0.9745477 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 5.813300609588623
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0428607  Vali Loss: 0.0759892 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9798995  Vali macro F1 0.9739191 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 5.808584451675415
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0432920  Vali Loss: 0.0771262 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9772732  Vali macro F1 0.9701824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 5.818475723266602
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0428639  Vali Loss: 0.0758220 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788417  Vali macro F1 0.9728147 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8993594  Test weighted F1: 0.9030917  Test macro F1 0.8625182 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00014229 0.00018477 0.00097087 0.00122549 0.0005322  0.00063735]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.116544961929321
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2013331  Vali Loss: 0.7270120 Vali Accuracy: 0.6996449  Vali weighted F1: 0.5925967  Vali macro F1 0.2822679 
Validation loss decreased (inf --> 0.727012).  Saving model ...
Epoch: 2 cost time: 6.116703510284424
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6540243  Vali Loss: 0.5227145 Vali Accuracy: 0.8021309  Vali weighted F1: 0.7628217  Vali macro F1 0.5449388 
new best score!!!!
Validation loss decreased (0.727012 --> 0.522714).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.089314699172974
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4729808  Vali Loss: 0.3627892 Vali Accuracy: 0.8807712  Vali weighted F1: 0.8688619  Vali macro F1 0.8213453 
new best score!!!!
Validation loss decreased (0.522714 --> 0.362789).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.088162183761597
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3406511  Vali Loss: 0.2663336 Vali Accuracy: 0.9142567  Vali weighted F1: 0.9120563  Vali macro F1 0.8785968 
new best score!!!!
Validation loss decreased (0.362789 --> 0.266334).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.093023777008057
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2675812  Vali Loss: 0.2052947 Vali Accuracy: 0.9325216  Vali weighted F1: 0.9320813  Vali macro F1 0.9036847 
new best score!!!!
Validation loss decreased (0.266334 --> 0.205295).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.110968351364136
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2287094  Vali Loss: 0.2141443 Vali Accuracy: 0.9294774  Vali weighted F1: 0.9262480  Vali macro F1 0.8962274 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.103163003921509
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2014552  Vali Loss: 0.1754693 Vali Accuracy: 0.9462202  Vali weighted F1: 0.9455982  Vali macro F1 0.9237730 
new best score!!!!
Validation loss decreased (0.205295 --> 0.175469).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.107720613479614
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1816396  Vali Loss: 0.1598133 Vali Accuracy: 0.9518011  Vali weighted F1: 0.9513805  Vali macro F1 0.9281550 
new best score!!!!
Validation loss decreased (0.175469 --> 0.159813).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.113059759140015
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1759942  Vali Loss: 0.1658013 Vali Accuracy: 0.9492643  Vali weighted F1: 0.9489398  Vali macro F1 0.9280037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.135232925415039
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1618833  Vali Loss: 0.1423837 Vali Accuracy: 0.9563673  Vali weighted F1: 0.9554000  Vali macro F1 0.9346003 
new best score!!!!
Validation loss decreased (0.159813 --> 0.142384).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.126461029052734
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1549546  Vali Loss: 0.1301527 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9580208  Vali macro F1 0.9374292 
new best score!!!!
Validation loss decreased (0.142384 --> 0.130153).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.10732102394104
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1496537  Vali Loss: 0.1313323 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9603247  Vali macro F1 0.9403875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.091015815734863
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1354455  Vali Loss: 0.1192491 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9608404  Vali macro F1 0.9391776 
new best score!!!!
Validation loss decreased (0.130153 --> 0.119249).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.093719720840454
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1325379  Vali Loss: 0.1129071 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9633918  Vali macro F1 0.9417616 
new best score!!!!
Validation loss decreased (0.119249 --> 0.112907).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.099305152893066
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1251406  Vali Loss: 0.1349545 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9551321  Vali macro F1 0.9339941 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.108160734176636
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1248796  Vali Loss: 0.1119720 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9635096  Vali macro F1 0.9444696 
new best score!!!!
Validation loss decreased (0.112907 --> 0.111972).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.101084470748901
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1146624  Vali Loss: 0.0925792 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9741759  Vali macro F1 0.9583007 
new best score!!!!
Validation loss decreased (0.111972 --> 0.092579).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.120269536972046
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1005031  Vali Loss: 0.0935805 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9703353  Vali macro F1 0.9533002 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.1242146492004395
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1038322  Vali Loss: 0.0970677 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9697473  Vali macro F1 0.9523079 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.121325492858887
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0932737  Vali Loss: 0.0883834 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9716408  Vali macro F1 0.9539581 
new best score!!!!
Validation loss decreased (0.092579 --> 0.088383).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 8.670819520950317
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0912254  Vali Loss: 0.0800540 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772978  Vali macro F1 0.9674359 
new best score!!!!
Validation loss decreased (0.088383 --> 0.080054).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.097114086151123
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0800141  Vali Loss: 0.0828506 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9749432  Vali macro F1 0.9654799 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.108060836791992
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0787669  Vali Loss: 0.1196412 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9625327  Vali macro F1 0.9476776 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.106175899505615
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0768506  Vali Loss: 0.0781230 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777768  Vali macro F1 0.9691712 
new best score!!!!
Validation loss decreased (0.080054 --> 0.078123).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.105139970779419
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0764884  Vali Loss: 0.0822738 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9717594  Vali macro F1 0.9607016 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.104073524475098
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0822702  Vali Loss: 0.0874124 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9709778  Vali macro F1 0.9582888 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.1083080768585205
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0683505  Vali Loss: 0.0753038 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771941  Vali macro F1 0.9672041 
new best score!!!!
Validation loss decreased (0.078123 --> 0.075304).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.105578184127808
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0709154  Vali Loss: 0.0750281 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9765255  Vali macro F1 0.9681203 
new best score!!!!
Validation loss decreased (0.075304 --> 0.075028).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.289856910705566
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0652277  Vali Loss: 0.0806853 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9733622  Vali macro F1 0.9600481 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.10657000541687
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0631551  Vali Loss: 0.0807600 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9773200  Vali macro F1 0.9658050 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.100187063217163
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0589758  Vali Loss: 0.0722763 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9757512  Vali macro F1 0.9666283 
new best score!!!!
Validation loss decreased (0.075028 --> 0.072276).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.113809108734131
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0575660  Vali Loss: 0.0722865 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9770352  Vali macro F1 0.9675662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.100247383117676
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0674677  Vali Loss: 0.0662427 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782662  Vali macro F1 0.9685298 
new best score!!!!
Validation loss decreased (0.072276 --> 0.066243).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.096917152404785
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0497770  Vali Loss: 0.0745471 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772400  Vali macro F1 0.9668941 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.103407859802246
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0490087  Vali Loss: 0.0627182 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817637  Vali macro F1 0.9730099 
new best score!!!!
Validation loss decreased (0.066243 --> 0.062718).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.1107728481292725
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0489729  Vali Loss: 0.0730312 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9783275  Vali macro F1 0.9639445 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.122795820236206
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0473503  Vali Loss: 0.0644100 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822302  Vali macro F1 0.9753023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.124802589416504
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0444085  Vali Loss: 0.0664873 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822598  Vali macro F1 0.9707380 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.102044105529785
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0439761  Vali Loss: 0.0693675 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781588  Vali macro F1 0.9717993 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.104888916015625
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0409771  Vali Loss: 0.0750709 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778647  Vali macro F1 0.9693978 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 6.099374532699585
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0324116  Vali Loss: 0.0617655 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807256  Vali macro F1 0.9727264 
new best score!!!!
Validation loss decreased (0.062718 --> 0.061765).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.092063903808594
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0298828  Vali Loss: 0.0624110 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797086  Vali macro F1 0.9709691 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.106355905532837
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0283659  Vali Loss: 0.0642374 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797271  Vali macro F1 0.9713827 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.095854997634888
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0277108  Vali Loss: 0.0636624 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807275  Vali macro F1 0.9727269 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.09922456741333
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0265924  Vali Loss: 0.0623718 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796984  Vali macro F1 0.9713330 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.11959981918335
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0266156  Vali Loss: 0.0654707 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802352  Vali macro F1 0.9722593 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.106474876403809
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0272913  Vali Loss: 0.0639037 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802183  Vali macro F1 0.9718486 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.098133325576782
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0270397  Vali Loss: 0.0638337 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802183  Vali macro F1 0.9718486 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.107621431350708
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0257874  Vali Loss: 0.0636634 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802183  Vali macro F1 0.9718486 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.100535154342651
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0263336  Vali Loss: 0.0639278 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802183  Vali macro F1 0.9718486 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.104472875595093
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0243238  Vali Loss: 0.0640605 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797271  Vali macro F1 0.9713827 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 6.090274810791016
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0268285  Vali Loss: 0.0638210 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797271  Vali macro F1 0.9713827 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.103004217147827
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0266771  Vali Loss: 0.0639151 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797271  Vali macro F1 0.9713827 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.10038685798645
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0250240  Vali Loss: 0.0639839 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797271  Vali macro F1 0.9713827 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.105798244476318
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0252922  Vali Loss: 0.0639639 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797271  Vali macro F1 0.9713827 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.117985963821411
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0259720  Vali Loss: 0.0639052 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797271  Vali macro F1 0.9713827 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9392352  Test weighted F1: 0.9385101  Test macro F1 0.9405066 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.13758397102356
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0312154  Vali Loss: 0.0631371 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802422  Vali macro F1 0.9722408 
Validation loss decreased (inf --> 0.063137).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.100453615188599
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0303228  Vali Loss: 0.0639603 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802353  Vali macro F1 0.9720928 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.114902496337891
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0265219  Vali Loss: 0.0622659 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807251  Vali macro F1 0.9727583 
new best score!!!!
Validation loss decreased (0.063137 --> 0.062266).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.102515935897827
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0270536  Vali Loss: 0.0627861 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796915  Vali macro F1 0.9712252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.111039400100708
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0277508  Vali Loss: 0.0633883 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792218  Vali macro F1 0.9711586 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.105593919754028
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0261743  Vali Loss: 0.0699025 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802564  Vali macro F1 0.9715588 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.13058876991272
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0258681  Vali Loss: 0.0664961 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812791  Vali macro F1 0.9733380 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.117031812667847
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0254336  Vali Loss: 0.0621291 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802340  Vali macro F1 0.9721739 
new best score!!!!
Validation loss decreased (0.062266 --> 0.062129).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.127499341964722
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0244771  Vali Loss: 0.0676555 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817747  Vali macro F1 0.9742051 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.117976427078247
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0249771  Vali Loss: 0.0625768 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807578  Vali macro F1 0.9709950 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.126444101333618
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0243191  Vali Loss: 0.0652768 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812365  Vali macro F1 0.9739002 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.10346794128418
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0236636  Vali Loss: 0.0693083 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807572  Vali macro F1 0.9715613 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.118679523468018
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0238815  Vali Loss: 0.0675250 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797371  Vali macro F1 0.9699766 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 6.114130973815918
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0244817  Vali Loss: 0.0644516 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812618  Vali macro F1 0.9729622 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.1162073612213135
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0239827  Vali Loss: 0.0655202 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807274  Vali macro F1 0.9726432 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.126816272735596
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0224594  Vali Loss: 0.0682465 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812464  Vali macro F1 0.9732729 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.135918140411377
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0231471  Vali Loss: 0.0660579 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797408  Vali macro F1 0.9699948 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.137961149215698
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0222122  Vali Loss: 0.0650155 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807390  Vali macro F1 0.9712844 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 6.113256931304932
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0227945  Vali Loss: 0.0679586 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792222  Vali macro F1 0.9687311 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.1385498046875
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0221418  Vali Loss: 0.0676550 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792222  Vali macro F1 0.9687311 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.112751245498657
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0220004  Vali Loss: 0.0685850 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792222  Vali macro F1 0.9687311 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.131702899932861
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0208650  Vali Loss: 0.0683135 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797430  Vali macro F1 0.9698771 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.124579429626465
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0212853  Vali Loss: 0.0666826 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802364  Vali macro F1 0.9703463 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9356499  Test weighted F1: 0.9348836  Test macro F1 0.9381202 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014168 0.00017867 0.00095969 0.00122549 0.000481   0.00060643]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.303070306777954
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.1940024  Vali Loss: 0.7380218 Vali Accuracy: 0.6788357  Vali weighted F1: 0.5749005  Vali macro F1 0.2973983 
Validation loss decreased (inf --> 0.738022).  Saving model ...
Epoch: 2 cost time: 6.272205114364624
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.6478408  Vali Loss: 0.5488113 Vali Accuracy: 0.7691169  Vali weighted F1: 0.7232759  Vali macro F1 0.5227895 
new best score!!!!
Validation loss decreased (0.738022 --> 0.548811).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.294724702835083
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.4519925  Vali Loss: 0.3729809 Vali Accuracy: 0.8603848  Vali weighted F1: 0.8489313  Vali macro F1 0.8117363 
new best score!!!!
Validation loss decreased (0.548811 --> 0.372981).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.250057220458984
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.3061723  Vali Loss: 0.3400160 Vali Accuracy: 0.8796251  Vali weighted F1: 0.8819049  Vali macro F1 0.8597087 
new best score!!!!
Validation loss decreased (0.372981 --> 0.340016).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.287706613540649
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2487668  Vali Loss: 0.2320749 Vali Accuracy: 0.9279724  Vali weighted F1: 0.9263781  Vali macro F1 0.9134714 
new best score!!!!
Validation loss decreased (0.340016 --> 0.232075).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.280894756317139
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.2062384  Vali Loss: 0.1889889 Vali Accuracy: 0.9324124  Vali weighted F1: 0.9325070  Vali macro F1 0.9187063 
new best score!!!!
Validation loss decreased (0.232075 --> 0.188989).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.288456201553345
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1837464  Vali Loss: 0.1773016 Vali Accuracy: 0.9412926  Vali weighted F1: 0.9395994  Vali macro F1 0.9271238 
new best score!!!!
Validation loss decreased (0.188989 --> 0.177302).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.284001111984253
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1694198  Vali Loss: 0.1628459 Vali Accuracy: 0.9437593  Vali weighted F1: 0.9440049  Vali macro F1 0.9321755 
new best score!!!!
Validation loss decreased (0.177302 --> 0.162846).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.28900408744812
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1554285  Vali Loss: 0.1475855 Vali Accuracy: 0.9496793  Vali weighted F1: 0.9489974  Vali macro F1 0.9380891 
new best score!!!!
Validation loss decreased (0.162846 --> 0.147586).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.276418924331665
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1529631  Vali Loss: 0.2652274 Vali Accuracy: 0.9052787  Vali weighted F1: 0.9077109  Vali macro F1 0.8840068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.29457688331604
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1550797  Vali Loss: 0.1402253 Vali Accuracy: 0.9516527  Vali weighted F1: 0.9513263  Vali macro F1 0.9400018 
new best score!!!!
Validation loss decreased (0.147586 --> 0.140225).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.287703275680542
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1344824  Vali Loss: 0.1317204 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9588810  Vali macro F1 0.9513167 
new best score!!!!
Validation loss decreased (0.140225 --> 0.131720).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.294432640075684
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1343068  Vali Loss: 0.1289606 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9568292  Vali macro F1 0.9466824 
new best score!!!!
Validation loss decreased (0.131720 --> 0.128961).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.271796464920044
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1222576  Vali Loss: 0.1196780 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9589321  Vali macro F1 0.9503865 
new best score!!!!
Validation loss decreased (0.128961 --> 0.119678).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.288214206695557
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1214488  Vali Loss: 0.1328596 Vali Accuracy: 0.9526394  Vali weighted F1: 0.9526040  Vali macro F1 0.9408487 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.286007881164551
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.1138934  Vali Loss: 0.1174696 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9593262  Vali macro F1 0.9500110 
new best score!!!!
Validation loss decreased (0.119678 --> 0.117470).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.284887790679932
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.1142410  Vali Loss: 0.1323716 Vali Accuracy: 0.9560927  Vali weighted F1: 0.9551889  Vali macro F1 0.9467116 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.291764736175537
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.1086440  Vali Loss: 0.1018220 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9651455  Vali macro F1 0.9578238 
new best score!!!!
Validation loss decreased (0.117470 --> 0.101822).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.287648439407349
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0966440  Vali Loss: 0.1110449 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9632296  Vali macro F1 0.9552198 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.310652017593384
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0965124  Vali Loss: 0.1023401 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9691563  Vali macro F1 0.9611857 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.282322883605957
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0959883  Vali Loss: 0.0988646 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9668536  Vali macro F1 0.9554850 
new best score!!!!
Validation loss decreased (0.101822 --> 0.098865).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.28031325340271
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0934842  Vali Loss: 0.1022785 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9665072  Vali macro F1 0.9562936 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.259445905685425
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0861980  Vali Loss: 0.0908397 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9694372  Vali macro F1 0.9580744 
new best score!!!!
Validation loss decreased (0.098865 --> 0.090840).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.544287919998169
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0827721  Vali Loss: 0.0941972 Vali Accuracy: 0.9629995  Vali weighted F1: 0.9626429  Vali macro F1 0.9515373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.271737337112427
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0794311  Vali Loss: 0.0884162 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9667506  Vali macro F1 0.9568191 
new best score!!!!
Validation loss decreased (0.090840 --> 0.088416).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.276448965072632
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0768097  Vali Loss: 0.0941248 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9681960  Vali macro F1 0.9585631 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.2796831130981445
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0806839  Vali Loss: 0.0849902 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9742326  Vali macro F1 0.9651214 
new best score!!!!
Validation loss decreased (0.088416 --> 0.084990).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.289812326431274
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0698369  Vali Loss: 0.0843754 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9716401  Vali macro F1 0.9632903 
new best score!!!!
Validation loss decreased (0.084990 --> 0.084375).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.300838947296143
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0697632  Vali Loss: 0.0775669 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9728764  Vali macro F1 0.9648524 
new best score!!!!
Validation loss decreased (0.084375 --> 0.077567).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.283477783203125
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0691446  Vali Loss: 0.0990809 Vali Accuracy: 0.9669462  Vali weighted F1: 0.9672572  Vali macro F1 0.9570940 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.279921293258667
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0723454  Vali Loss: 0.0775683 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9741522  Vali macro F1 0.9662260 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.280668258666992
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0611505  Vali Loss: 0.0783784 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9729140  Vali macro F1 0.9643992 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.2836127281188965
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0577514  Vali Loss: 0.0898791 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9712920  Vali macro F1 0.9616924 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.284442901611328
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0638295  Vali Loss: 0.0771967 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9757151  Vali macro F1 0.9686267 
new best score!!!!
Validation loss decreased (0.077567 --> 0.077197).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.281665086746216
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0569786  Vali Loss: 0.0731519 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9753540  Vali macro F1 0.9675902 
new best score!!!!
Validation loss decreased (0.077197 --> 0.073152).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.290648937225342
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0550476  Vali Loss: 0.0970065 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9679303  Vali macro F1 0.9577051 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.284531116485596
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0561990  Vali Loss: 0.0804987 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9721676  Vali macro F1 0.9641480 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.3008692264556885
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0524180  Vali Loss: 0.0725106 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9756925  Vali macro F1 0.9683113 
new best score!!!!
Validation loss decreased (0.073152 --> 0.072511).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.282280683517456
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0480559  Vali Loss: 0.0794140 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9735921  Vali macro F1 0.9656712 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.284266710281372
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0510432  Vali Loss: 0.0966054 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9728413  Vali macro F1 0.9647454 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.291313886642456
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0518848  Vali Loss: 0.0772511 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9747735  Vali macro F1 0.9676614 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.284689664840698
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0447474  Vali Loss: 0.0985922 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9713946  Vali macro F1 0.9636079 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.287986755371094
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0470541  Vali Loss: 0.0777890 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9753529  Vali macro F1 0.9683485 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 6.282012701034546
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0321743  Vali Loss: 0.0691358 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9761902  Vali macro F1 0.9697054 
new best score!!!!
Validation loss decreased (0.072511 --> 0.069136).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.291077136993408
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0318828  Vali Loss: 0.0709294 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9772752  Vali macro F1 0.9710026 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.296600580215454
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0296660  Vali Loss: 0.0685791 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9757924  Vali macro F1 0.9692266 
new best score!!!!
Validation loss decreased (0.069136 --> 0.068579).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.282416582107544
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0302592  Vali Loss: 0.0688918 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9772835  Vali macro F1 0.9709369 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.286385774612427
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0289406  Vali Loss: 0.0673830 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9767752  Vali macro F1 0.9700797 
new best score!!!!
Validation loss decreased (0.068579 --> 0.067383).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.270511150360107
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0292988  Vali Loss: 0.0680212 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777400  Vali macro F1 0.9713779 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.2761054039001465
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0299325  Vali Loss: 0.0666407 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787308  Vali macro F1 0.9725680 
new best score!!!!
Validation loss decreased (0.067383 --> 0.066641).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.279872179031372
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0278798  Vali Loss: 0.0682187 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777863  Vali macro F1 0.9713343 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.276329517364502
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0293863  Vali Loss: 0.0679259 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9771822  Vali macro F1 0.9704797 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.283515691757202
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0283076  Vali Loss: 0.0686734 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9776984  Vali macro F1 0.9709670 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.284148454666138
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0269310  Vali Loss: 0.0663296 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793007  Vali macro F1 0.9734175 
new best score!!!!
Validation loss decreased (0.066641 --> 0.066330).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.306318521499634
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0277514  Vali Loss: 0.0672267 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9772730  Vali macro F1 0.9708517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.2707200050354
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0265476  Vali Loss: 0.0691590 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9771387  Vali macro F1 0.9710267 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.262575387954712
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0282144  Vali Loss: 0.0692643 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783246  Vali macro F1 0.9722632 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.277636528015137
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0269954  Vali Loss: 0.0681611 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9773502  Vali macro F1 0.9710401 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.283674478530884
VALI: Epoch: 59, Steps: 72 | Train Loss: 0.0280494  Vali Loss: 0.0653563 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782300  Vali macro F1 0.9719645 
new best score!!!!
Validation loss decreased (0.066330 --> 0.065356).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.2677977085113525
VALI: Epoch: 60, Steps: 72 | Train Loss: 0.0254750  Vali Loss: 0.0720830 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9773460  Vali macro F1 0.9712769 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.278413534164429
VALI: Epoch: 61, Steps: 72 | Train Loss: 0.0256037  Vali Loss: 0.0713038 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783415  Vali macro F1 0.9720789 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.280004024505615
VALI: Epoch: 62, Steps: 72 | Train Loss: 0.0254981  Vali Loss: 0.0705663 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777854  Vali macro F1 0.9714121 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.289712429046631
VALI: Epoch: 63, Steps: 72 | Train Loss: 0.0256042  Vali Loss: 0.0680373 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788198  Vali macro F1 0.9724829 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.30826997756958
VALI: Epoch: 64, Steps: 72 | Train Loss: 0.0255461  Vali Loss: 0.0668699 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787581  Vali macro F1 0.9721344 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 65 cost time: 6.283447504043579
VALI: Epoch: 65, Steps: 72 | Train Loss: 0.0249293  Vali Loss: 0.0679168 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782984  Vali macro F1 0.9719982 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 6.279984712600708
VALI: Epoch: 66, Steps: 72 | Train Loss: 0.0246910  Vali Loss: 0.0676856 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782984  Vali macro F1 0.9719982 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 6.269892454147339
VALI: Epoch: 67, Steps: 72 | Train Loss: 0.0260209  Vali Loss: 0.0678826 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787962  Vali macro F1 0.9727714 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.280830383300781
VALI: Epoch: 68, Steps: 72 | Train Loss: 0.0225033  Vali Loss: 0.0683298 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787962  Vali macro F1 0.9727714 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.283459424972534
VALI: Epoch: 69, Steps: 72 | Train Loss: 0.0228804  Vali Loss: 0.0673317 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787962  Vali macro F1 0.9727714 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 70 cost time: 6.2876598834991455
VALI: Epoch: 70, Steps: 72 | Train Loss: 0.0243445  Vali Loss: 0.0674502 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787962  Vali macro F1 0.9727714 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 6.280045032501221
VALI: Epoch: 71, Steps: 72 | Train Loss: 0.0243267  Vali Loss: 0.0673770 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787962  Vali macro F1 0.9727714 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 6.279743671417236
VALI: Epoch: 72, Steps: 72 | Train Loss: 0.0240355  Vali Loss: 0.0674629 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787962  Vali macro F1 0.9727714 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 6.282313823699951
VALI: Epoch: 73, Steps: 72 | Train Loss: 0.0229627  Vali Loss: 0.0674862 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782846  Vali macro F1 0.9722680 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 6.273874759674072
VALI: Epoch: 74, Steps: 72 | Train Loss: 0.0243852  Vali Loss: 0.0675396 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787962  Vali macro F1 0.9727714 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8520035  Test weighted F1: 0.8442563  Test macro F1 0.6265504 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.300456523895264
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0277790  Vali Loss: 0.0676251 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9778054  Vali macro F1 0.9715720 
Validation loss decreased (inf --> 0.067625).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.274287462234497
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0281290  Vali Loss: 0.0649065 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9792323  Vali macro F1 0.9732170 
new best score!!!!
Validation loss decreased (0.067625 --> 0.064906).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.277530670166016
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0255793  Vali Loss: 0.0762227 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9762810  Vali macro F1 0.9701793 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.289830207824707
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0268798  Vali Loss: 0.0643399 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802210  Vali macro F1 0.9736512 
new best score!!!!
Validation loss decreased (0.064906 --> 0.064340).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.293002367019653
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0242878  Vali Loss: 0.0713155 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782508  Vali macro F1 0.9723784 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.3125152587890625
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0263494  Vali Loss: 0.0699807 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777563  Vali macro F1 0.9711588 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.317103385925293
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0264428  Vali Loss: 0.0664098 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9786955  Vali macro F1 0.9730228 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.300492286682129
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0238581  Vali Loss: 0.0646035 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9772367  Vali macro F1 0.9706551 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.306377172470093
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0255882  Vali Loss: 0.0695258 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9778063  Vali macro F1 0.9709784 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.286396503448486
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0250175  Vali Loss: 0.0647630 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788061  Vali macro F1 0.9731976 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.295016050338745
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0219865  Vali Loss: 0.0649779 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798033  Vali macro F1 0.9737117 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.295939922332764
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0252368  Vali Loss: 0.0744019 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9779109  Vali macro F1 0.9719335 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.2955546379089355
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0266133  Vali Loss: 0.0667280 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9767345  Vali macro F1 0.9702822 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.297138929367065
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0242922  Vali Loss: 0.0664391 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9778136  Vali macro F1 0.9713845 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.30730414390564
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0233641  Vali Loss: 0.0661349 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788002  Vali macro F1 0.9723123 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.320604562759399
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0227572  Vali Loss: 0.0648756 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802224  Vali macro F1 0.9743615 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.29655647277832
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0211825  Vali Loss: 0.0648558 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797309  Vali macro F1 0.9742031 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.29279088973999
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0220302  Vali Loss: 0.0642474 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9792738  Vali macro F1 0.9734818 
new best score!!!!
Validation loss decreased (0.064340 --> 0.064247).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.295241594314575
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0224852  Vali Loss: 0.0654893 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793050  Vali macro F1 0.9735288 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.290075063705444
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0218306  Vali Loss: 0.0637440 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9796991  Vali macro F1 0.9738499 
new best score!!!!
Validation loss decreased (0.064247 --> 0.063744).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.300478935241699
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0210816  Vali Loss: 0.0653466 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793056  Vali macro F1 0.9735528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.295035123825073
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0206551  Vali Loss: 0.0641543 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802187  Vali macro F1 0.9749711 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.298926115036011
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0226173  Vali Loss: 0.0640938 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802187  Vali macro F1 0.9749711 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.299545049667358
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0216275  Vali Loss: 0.0647178 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787640  Vali macro F1 0.9730040 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.307281970977783
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0208665  Vali Loss: 0.0640343 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797379  Vali macro F1 0.9745383 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.289819002151489
Fine Tuning VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0202728  Vali Loss: 0.0642909 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797379  Vali macro F1 0.9745383 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.544835805892944
Fine Tuning VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0205394  Vali Loss: 0.0642268 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797379  Vali macro F1 0.9745383 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.278616666793823
Fine Tuning VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0214689  Vali Loss: 0.0640893 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797379  Vali macro F1 0.9745383 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.28931999206543
Fine Tuning VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0216514  Vali Loss: 0.0641163 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797379  Vali macro F1 0.9745383 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.283658504486084
Fine Tuning VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0217590  Vali Loss: 0.0646305 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802481  Vali macro F1 0.9750401 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 31 cost time: 6.289069890975952
Fine Tuning VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0209276  Vali Loss: 0.0646587 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802481  Vali macro F1 0.9750401 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.287611722946167
Fine Tuning VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0209822  Vali Loss: 0.0646553 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802481  Vali macro F1 0.9750401 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.2970335483551025
Fine Tuning VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0220722  Vali Loss: 0.0646147 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802481  Vali macro F1 0.9750401 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.314125061035156
Fine Tuning VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0228147  Vali Loss: 0.0646088 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802481  Vali macro F1 0.9750401 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.2816901206970215
Fine Tuning VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0219122  Vali Loss: 0.0646158 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802481  Vali macro F1 0.9750401 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8542364  Test weighted F1: 0.8463217  Test macro F1 0.6281321 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0001452  0.00016892 0.00099305 0.00131234 0.00049875 0.00062893]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.258461236953735
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.1594271  Vali Loss: 0.6791714 Vali Accuracy: 0.7171867  Vali weighted F1: 0.6164325  Vali macro F1 0.2990503 
Validation loss decreased (inf --> 0.679171).  Saving model ...
Epoch: 2 cost time: 6.250866889953613
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.6165555  Vali Loss: 0.4876491 Vali Accuracy: 0.8142645  Vali weighted F1: 0.7848072  Vali macro F1 0.5695452 
new best score!!!!
Validation loss decreased (0.679171 --> 0.487649).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.236297130584717
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4554125  Vali Loss: 0.3307911 Vali Accuracy: 0.8890540  Vali weighted F1: 0.8807376  Vali macro F1 0.8401570 
new best score!!!!
Validation loss decreased (0.487649 --> 0.330791).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.238915920257568
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3281291  Vali Loss: 0.2514297 Vali Accuracy: 0.9157999  Vali weighted F1: 0.9154252  Vali macro F1 0.8814397 
new best score!!!!
Validation loss decreased (0.330791 --> 0.251430).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.255645036697388
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2634106  Vali Loss: 0.2011797 Vali Accuracy: 0.9331352  Vali weighted F1: 0.9329014  Vali macro F1 0.9011319 
new best score!!!!
Validation loss decreased (0.251430 --> 0.201180).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.2798168659210205
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2239114  Vali Loss: 0.1875517 Vali Accuracy: 0.9375929  Vali weighted F1: 0.9370159  Vali macro F1 0.9075547 
new best score!!!!
Validation loss decreased (0.201180 --> 0.187552).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.282449722290039
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1955016  Vali Loss: 0.1657471 Vali Accuracy: 0.9445270  Vali weighted F1: 0.9434216  Vali macro F1 0.9165936 
new best score!!!!
Validation loss decreased (0.187552 --> 0.165747).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.268221616744995
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1845989  Vali Loss: 0.1686763 Vali Accuracy: 0.9430411  Vali weighted F1: 0.9413348  Vali macro F1 0.9150105 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.278106689453125
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1706523  Vali Loss: 0.1461002 Vali Accuracy: 0.9524517  Vali weighted F1: 0.9516375  Vali macro F1 0.9282142 
new best score!!!!
Validation loss decreased (0.165747 --> 0.146100).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2628350257873535
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1559523  Vali Loss: 0.1507232 Vali Accuracy: 0.9489846  Vali weighted F1: 0.9485902  Vali macro F1 0.9233165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.264074325561523
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1486771  Vali Loss: 0.1372294 Vali Accuracy: 0.9564141  Vali weighted F1: 0.9563507  Vali macro F1 0.9339490 
new best score!!!!
Validation loss decreased (0.146100 --> 0.137229).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.255597114562988
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1358746  Vali Loss: 0.1262258 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9574138  Vali macro F1 0.9342780 
new best score!!!!
Validation loss decreased (0.137229 --> 0.126226).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.261709690093994
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1379268  Vali Loss: 0.1349060 Vali Accuracy: 0.9509658  Vali weighted F1: 0.9495306  Vali macro F1 0.9247655 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.273198127746582
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1273863  Vali Loss: 0.1334379 Vali Accuracy: 0.9544329  Vali weighted F1: 0.9548407  Vali macro F1 0.9310066 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.272191762924194
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1198034  Vali Loss: 0.1299853 Vali Accuracy: 0.9554235  Vali weighted F1: 0.9543575  Vali macro F1 0.9324979 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 6.273218631744385
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1091590  Vali Loss: 0.1160956 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9594972  Vali macro F1 0.9368158 
new best score!!!!
Validation loss decreased (0.126226 --> 0.116096).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.252867221832275
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1055206  Vali Loss: 0.1020306 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9647387  Vali macro F1 0.9436005 
new best score!!!!
Validation loss decreased (0.116096 --> 0.102031).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.2468249797821045
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1027864  Vali Loss: 0.1057928 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9635333  Vali macro F1 0.9410129 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.251760244369507
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0933964  Vali Loss: 0.0944436 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9660154  Vali macro F1 0.9436499 
new best score!!!!
Validation loss decreased (0.102031 --> 0.094444).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.25083065032959
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0906582  Vali Loss: 0.1055914 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9648341  Vali macro F1 0.9447863 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.23926043510437
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0888175  Vali Loss: 0.0992122 Vali Accuracy: 0.9673105  Vali weighted F1: 0.9674677  Vali macro F1 0.9479082 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.244168758392334
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0847596  Vali Loss: 0.0779325 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742940  Vali macro F1 0.9568318 
new best score!!!!
Validation loss decreased (0.094444 --> 0.077933).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.273096561431885
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0830815  Vali Loss: 0.0890362 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9686541  Vali macro F1 0.9467630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.28071928024292
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0815927  Vali Loss: 0.0836427 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9682823  Vali macro F1 0.9541833 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.256462335586548
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0755775  Vali Loss: 0.0802398 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9756340  Vali macro F1 0.9650214 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.252402067184448
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0669781  Vali Loss: 0.0692364 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9761506  Vali macro F1 0.9628114 
new best score!!!!
Validation loss decreased (0.077933 --> 0.069236).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.259500980377197
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0695152  Vali Loss: 0.0810116 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9738638  Vali macro F1 0.9564525 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.259995460510254
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0666391  Vali Loss: 0.0663753 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9777332  Vali macro F1 0.9652405 
new best score!!!!
Validation loss decreased (0.069236 --> 0.066375).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.248912572860718
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0669765  Vali Loss: 0.0754628 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9719876  Vali macro F1 0.9599520 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.246022462844849
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0634136  Vali Loss: 0.0677526 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9786525  Vali macro F1 0.9674022 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.248530626296997
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0620382  Vali Loss: 0.0633941 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9811762  Vali macro F1 0.9708443 
new best score!!!!
Validation loss decreased (0.066375 --> 0.063394).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.271121025085449
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0529635  Vali Loss: 0.0699602 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9753505  Vali macro F1 0.9627808 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.249833345413208
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0510480  Vali Loss: 0.0671453 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9771989  Vali macro F1 0.9618585 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.240537881851196
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0457442  Vali Loss: 0.0599493 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807643  Vali macro F1 0.9720184 
new best score!!!!
Validation loss decreased (0.063394 --> 0.059949).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.259451389312744
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0452183  Vali Loss: 0.0587906 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827106  Vali macro F1 0.9735245 
new best score!!!!
Validation loss decreased (0.059949 --> 0.058791).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.251672983169556
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0469060  Vali Loss: 0.0768961 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9704414  Vali macro F1 0.9504091 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.254746198654175
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0404822  Vali Loss: 0.0778123 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9780245  Vali macro F1 0.9667712 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.246328353881836
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0398914  Vali Loss: 0.0753329 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9767951  Vali macro F1 0.9638821 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.249727487564087
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0447421  Vali Loss: 0.0650408 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9811047  Vali macro F1 0.9709639 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.27033257484436
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0448891  Vali Loss: 0.0847960 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9703650  Vali macro F1 0.9517362 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 6.250294208526611
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0331431  Vali Loss: 0.0494051 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817466  Vali macro F1 0.9718842 
new best score!!!!
Validation loss decreased (0.058791 --> 0.049405).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.256105422973633
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0293213  Vali Loss: 0.0493196 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9831326  Vali macro F1 0.9739646 
new best score!!!!
Validation loss decreased (0.049405 --> 0.049320).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.249111652374268
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0271457  Vali Loss: 0.0500409 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.251677989959717
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0261074  Vali Loss: 0.0487104 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9831745  Vali macro F1 0.9743891 
new best score!!!!
Validation loss decreased (0.049320 --> 0.048710).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.2518229484558105
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0263165  Vali Loss: 0.0503653 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826372  Vali macro F1 0.9741222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.249592542648315
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0260662  Vali Loss: 0.0498684 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.24035120010376
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0273607  Vali Loss: 0.0497121 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821637  Vali macro F1 0.9722853 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.256281852722168
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0263207  Vali Loss: 0.0505614 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9816881  Vali macro F1 0.9717298 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.2679362297058105
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0253626  Vali Loss: 0.0500011 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837133  Vali macro F1 0.9756014 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.247326612472534
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0252515  Vali Loss: 0.0490221 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836826  Vali macro F1 0.9749234 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.2432684898376465
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0242912  Vali Loss: 0.0494011 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.249424695968628
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0247179  Vali Loss: 0.0493304 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.246149301528931
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0240219  Vali Loss: 0.0492817 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.241324186325073
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0238652  Vali Loss: 0.0489108 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.2415642738342285
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0247043  Vali Loss: 0.0488931 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.268698453903198
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0242543  Vali Loss: 0.0488804 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.255156755447388
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0257226  Vali Loss: 0.0488341 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.265591621398926
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0241909  Vali Loss: 0.0488454 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.257800579071045
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0244065  Vali Loss: 0.0488355 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826748  Vali macro F1 0.9735239 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8584615  Test weighted F1: 0.8552579  Test macro F1 0.8145891 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.307583332061768
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0289400  Vali Loss: 0.0495559 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851381  Vali macro F1 0.9773923 
Validation loss decreased (inf --> 0.049556).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.284294843673706
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0271987  Vali Loss: 0.0507420 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836266  Vali macro F1 0.9748045 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.292250633239746
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0268123  Vali Loss: 0.0487020 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836767  Vali macro F1 0.9755493 
new best score!!!!
Validation loss decreased (0.049556 --> 0.048702).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.2702391147613525
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0260263  Vali Loss: 0.0498222 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841343  Vali macro F1 0.9756379 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.29690146446228
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0246695  Vali Loss: 0.0528235 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9831206  Vali macro F1 0.9734888 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.3276472091674805
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0247068  Vali Loss: 0.0491010 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851592  Vali macro F1 0.9770389 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.2941248416900635
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0243627  Vali Loss: 0.0493648 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836846  Vali macro F1 0.9751274 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.295750141143799
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0254334  Vali Loss: 0.0497606 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836715  Vali macro F1 0.9744497 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.288444757461548
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0241473  Vali Loss: 0.0504918 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841920  Vali macro F1 0.9760861 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.285300254821777
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0243431  Vali Loss: 0.0503765 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846774  Vali macro F1 0.9759211 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.2859086990356445
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0237606  Vali Loss: 0.0510902 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836770  Vali macro F1 0.9748492 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.283999681472778
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0236061  Vali Loss: 0.0492242 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836554  Vali macro F1 0.9748038 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.295732021331787
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0214469  Vali Loss: 0.0508529 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846608  Vali macro F1 0.9762742 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.294955730438232
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0225871  Vali Loss: 0.0505410 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851525  Vali macro F1 0.9770617 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.296944618225098
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0214828  Vali Loss: 0.0506526 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841628  Vali macro F1 0.9753365 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.2851035594940186
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0225211  Vali Loss: 0.0502059 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851525  Vali macro F1 0.9770617 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.277788877487183
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0214181  Vali Loss: 0.0501774 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851525  Vali macro F1 0.9770617 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.279755353927612
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0203841  Vali Loss: 0.0498213 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856580  Vali macro F1 0.9775910 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8639053  Test weighted F1: 0.8598006  Test macro F1 0.8177267 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014665 0.00017765 0.00108578 0.00135318 0.00049407 0.00062383]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.123830556869507
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2051072  Vali Loss: 0.7785420 Vali Accuracy: 0.6818874  Vali weighted F1: 0.5712095  Vali macro F1 0.2753932 
Validation loss decreased (inf --> 0.778542).  Saving model ...
Epoch: 2 cost time: 6.127947807312012
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6580325  Vali Loss: 0.5562636 Vali Accuracy: 0.7787925  Vali weighted F1: 0.7237976  Vali macro F1 0.5066008 
new best score!!!!
Validation loss decreased (0.778542 --> 0.556264).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.139325857162476
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4961437  Vali Loss: 0.4708439 Vali Accuracy: 0.8467783  Vali weighted F1: 0.8263896  Vali macro F1 0.7617154 
new best score!!!!
Validation loss decreased (0.556264 --> 0.470844).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.137320280075073
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3842409  Vali Loss: 0.3522736 Vali Accuracy: 0.8782344  Vali weighted F1: 0.8701949  Vali macro F1 0.8272729 
new best score!!!!
Validation loss decreased (0.470844 --> 0.352274).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.154388666152954
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3114579  Vali Loss: 0.2541029 Vali Accuracy: 0.9157788  Vali weighted F1: 0.9136287  Vali macro F1 0.8829278 
new best score!!!!
Validation loss decreased (0.352274 --> 0.254103).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.13485860824585
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2442848  Vali Loss: 0.2058582 Vali Accuracy: 0.9320142  Vali weighted F1: 0.9301630  Vali macro F1 0.9081161 
new best score!!!!
Validation loss decreased (0.254103 --> 0.205858).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.125083684921265
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2099465  Vali Loss: 0.2026873 Vali Accuracy: 0.9381025  Vali weighted F1: 0.9360000  Vali macro F1 0.9182868 
new best score!!!!
Validation loss decreased (0.205858 --> 0.202687).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.114126920700073
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1899184  Vali Loss: 0.1687215 Vali Accuracy: 0.9452055  Vali weighted F1: 0.9441833  Vali macro F1 0.9272270 
new best score!!!!
Validation loss decreased (0.202687 --> 0.168721).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.117739677429199
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1821821  Vali Loss: 0.1597369 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9471129  Vali macro F1 0.9324373 
new best score!!!!
Validation loss decreased (0.168721 --> 0.159737).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.11788272857666
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1563222  Vali Loss: 0.1856217 Vali Accuracy: 0.9375951  Vali weighted F1: 0.9373989  Vali macro F1 0.9194912 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.129272937774658
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1600067  Vali Loss: 0.1446688 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9494823  Vali macro F1 0.9355367 
new best score!!!!
Validation loss decreased (0.159737 --> 0.144669).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.110782861709595
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1378148  Vali Loss: 0.1604328 Vali Accuracy: 0.9457128  Vali weighted F1: 0.9442980  Vali macro F1 0.9289028 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.129465579986572
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1356153  Vali Loss: 0.1299615 Vali Accuracy: 0.9543379  Vali weighted F1: 0.9539411  Vali macro F1 0.9416342 
new best score!!!!
Validation loss decreased (0.144669 --> 0.129961).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.132313966751099
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1274610  Vali Loss: 0.1295480 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9578345  Vali macro F1 0.9451901 
new best score!!!!
Validation loss decreased (0.129961 --> 0.129548).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.132695913314819
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1203930  Vali Loss: 0.1551890 Vali Accuracy: 0.9477423  Vali weighted F1: 0.9462456  Vali macro F1 0.9311231 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.155458688735962
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1129105  Vali Loss: 0.1294231 Vali Accuracy: 0.9553526  Vali weighted F1: 0.9555265  Vali macro F1 0.9393736 
new best score!!!!
Validation loss decreased (0.129548 --> 0.129423).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.126347064971924
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1113170  Vali Loss: 0.1273617 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9613690  Vali macro F1 0.9485505 
new best score!!!!
Validation loss decreased (0.129423 --> 0.127362).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.1624979972839355
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0989863  Vali Loss: 0.1106661 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9638825  Vali macro F1 0.9516726 
new best score!!!!
Validation loss decreased (0.127362 --> 0.110666).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.1079277992248535
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0990341  Vali Loss: 0.1050962 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9666564  Vali macro F1 0.9557735 
new best score!!!!
Validation loss decreased (0.110666 --> 0.105096).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.101940631866455
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0965627  Vali Loss: 0.1184040 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9635446  Vali macro F1 0.9503570 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.102559804916382
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0870142  Vali Loss: 0.1097922 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9625459  Vali macro F1 0.9488176 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.110924482345581
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0819928  Vali Loss: 0.1006053 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9693389  Vali macro F1 0.9577178 
new best score!!!!
Validation loss decreased (0.105096 --> 0.100605).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.121242523193359
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0813551  Vali Loss: 0.1088545 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9642242  Vali macro F1 0.9519067 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.088907241821289
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0896200  Vali Loss: 0.1193705 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9636673  Vali macro F1 0.9513207 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.109539985656738
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0725709  Vali Loss: 0.0914345 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9701642  Vali macro F1 0.9573462 
new best score!!!!
Validation loss decreased (0.100605 --> 0.091435).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.090304851531982
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0681727  Vali Loss: 0.0858114 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9723748  Vali macro F1 0.9616596 
new best score!!!!
Validation loss decreased (0.091435 --> 0.085811).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.0817413330078125
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0735360  Vali Loss: 0.0910948 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9678714  Vali macro F1 0.9563929 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.093585252761841
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0607263  Vali Loss: 0.0757695 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9757240  Vali macro F1 0.9679393 
new best score!!!!
Validation loss decreased (0.085811 --> 0.075770).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.1018595695495605
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0600966  Vali Loss: 0.0879488 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9754466  Vali macro F1 0.9669662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.093274831771851
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0589119  Vali Loss: 0.0803794 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9774814  Vali macro F1 0.9699067 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.113532066345215
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0594943  Vali Loss: 0.1538540 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9567840  Vali macro F1 0.9443035 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.108397722244263
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0660075  Vali Loss: 0.0715206 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9763805  Vali macro F1 0.9679103 
new best score!!!!
Validation loss decreased (0.075770 --> 0.071521).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.092463493347168
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0536900  Vali Loss: 0.0794532 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9748751  Vali macro F1 0.9677293 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.0897908210754395
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0503617  Vali Loss: 0.0757349 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787554  Vali macro F1 0.9710564 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.081956624984741
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0512652  Vali Loss: 0.0676579 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798151  Vali macro F1 0.9728944 
new best score!!!!
Validation loss decreased (0.071521 --> 0.067658).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.0889105796813965
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0501570  Vali Loss: 0.0652525 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9778529  Vali macro F1 0.9702831 
new best score!!!!
Validation loss decreased (0.067658 --> 0.065252).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.094022274017334
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0564542  Vali Loss: 0.0712273 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9779330  Vali macro F1 0.9718827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.089430093765259
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0437517  Vali Loss: 0.0675641 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827683  Vali macro F1 0.9765716 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.08866548538208
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0449013  Vali Loss: 0.0790180 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786444  Vali macro F1 0.9720159 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.104002237319946
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0399689  Vali Loss: 0.0885712 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9749806  Vali macro F1 0.9672077 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.112651586532593
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0372856  Vali Loss: 0.0878149 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9763740  Vali macro F1 0.9694494 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 6.08880877494812
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0310698  Vali Loss: 0.0643174 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837868  Vali macro F1 0.9775536 
new best score!!!!
Validation loss decreased (0.065252 --> 0.064317).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.087622165679932
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0268496  Vali Loss: 0.0673472 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827633  Vali macro F1 0.9756661 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.088768720626831
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0271066  Vali Loss: 0.0653147 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817519  Vali macro F1 0.9745756 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.087508678436279
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0263592  Vali Loss: 0.0648644 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822387  Vali macro F1 0.9752814 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.09199857711792
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0264446  Vali Loss: 0.0672251 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822260  Vali macro F1 0.9755157 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.095226526260376
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0259171  Vali Loss: 0.0666230 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827269  Vali macro F1 0.9767466 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 48 cost time: 6.088146209716797
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0259589  Vali Loss: 0.0661842 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837641  Vali macro F1 0.9778687 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.103897571563721
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0250370  Vali Loss: 0.0666977 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837778  Vali macro F1 0.9777946 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.109427452087402
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0246321  Vali Loss: 0.0670851 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832737  Vali macro F1 0.9769477 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.086900949478149
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0245482  Vali Loss: 0.0661066 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832737  Vali macro F1 0.9769477 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.088835954666138
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0246964  Vali Loss: 0.0664751 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832737  Vali macro F1 0.9769477 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 53 cost time: 6.083242654800415
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0251720  Vali Loss: 0.0664995 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832737  Vali macro F1 0.9769477 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.084972143173218
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0253609  Vali Loss: 0.0664816 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832737  Vali macro F1 0.9769477 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.083825349807739
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0249280  Vali Loss: 0.0664696 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832737  Vali macro F1 0.9769477 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.08769965171814
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0250022  Vali Loss: 0.0663385 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832737  Vali macro F1 0.9769477 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.09371542930603
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0257395  Vali Loss: 0.0663072 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832737  Vali macro F1 0.9769477 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9386215  Test weighted F1: 0.9401839  Test macro F1 0.9096200 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.141245126724243
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0280316  Vali Loss: 0.0696643 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812375  Vali macro F1 0.9742228 
Validation loss decreased (inf --> 0.069664).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.117648124694824
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0247307  Vali Loss: 0.0667653 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812662  Vali macro F1 0.9740290 
new best score!!!!
Validation loss decreased (0.069664 --> 0.066765).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.1051647663116455
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0256776  Vali Loss: 0.0647692 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822541  Vali macro F1 0.9752592 
new best score!!!!
Validation loss decreased (0.066765 --> 0.064769).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.1019768714904785
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0252342  Vali Loss: 0.0677825 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812025  Vali macro F1 0.9737478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.117290019989014
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0254386  Vali Loss: 0.0664216 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817662  Vali macro F1 0.9743303 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.117825746536255
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0253092  Vali Loss: 0.0626003 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832731  Vali macro F1 0.9769478 
new best score!!!!
Validation loss decreased (0.064769 --> 0.062600).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.1357421875
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0273595  Vali Loss: 0.0607051 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848185  Vali macro F1 0.9786516 
new best score!!!!
Validation loss decreased (0.062600 --> 0.060705).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.123642444610596
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0256590  Vali Loss: 0.0645941 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837655  Vali macro F1 0.9772635 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.134994983673096
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0245319  Vali Loss: 0.0682999 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827591  Vali macro F1 0.9763393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.1460771560668945
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0241065  Vali Loss: 0.0616304 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812089  Vali macro F1 0.9737935 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.131251573562622
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0234796  Vali Loss: 0.0645005 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827496  Vali macro F1 0.9763408 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.1353771686553955
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0252591  Vali Loss: 0.0617825 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842956  Vali macro F1 0.9770809 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.129005670547485
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0235695  Vali Loss: 0.0709579 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801243  Vali macro F1 0.9726412 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.126471042633057
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0224037  Vali Loss: 0.0654194 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822692  Vali macro F1 0.9745547 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.1311399936676025
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0226047  Vali Loss: 0.0654603 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811942  Vali macro F1 0.9742995 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.126637935638428
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0223948  Vali Loss: 0.0677658 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827536  Vali macro F1 0.9752988 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.1298828125
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0222788  Vali Loss: 0.0651764 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832851  Vali macro F1 0.9761778 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.136851787567139
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0210329  Vali Loss: 0.0660554 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843022  Vali macro F1 0.9772907 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.155031204223633
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0203860  Vali Loss: 0.0638173 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848164  Vali macro F1 0.9778968 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.131396055221558
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0211882  Vali Loss: 0.0654400 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837941  Vali macro F1 0.9770192 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.140764236450195
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0223143  Vali Loss: 0.0648162 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837855  Vali macro F1 0.9766540 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.1713316440582275
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0216266  Vali Loss: 0.0649208 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832740  Vali macro F1 0.9757826 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9400018  Test weighted F1: 0.9415545  Test macro F1 0.9103552 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00014041 0.00018215 0.00102459 0.00129702 0.00049213 0.0005963 ]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.2651896476745605
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.1721840  Vali Loss: 0.7453039 Vali Accuracy: 0.6872510  Vali weighted F1: 0.5787541  Vali macro F1 0.2823604 
Validation loss decreased (inf --> 0.745304).  Saving model ...
Epoch: 2 cost time: 6.249613046646118
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.6535541  Vali Loss: 0.5364425 Vali Accuracy: 0.7948207  Vali weighted F1: 0.7631810  Vali macro F1 0.5674963 
new best score!!!!
Validation loss decreased (0.745304 --> 0.536443).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.2647035121917725
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4974056  Vali Loss: 0.4082011 Vali Accuracy: 0.8610558  Vali weighted F1: 0.8502490  Vali macro F1 0.8025986 
new best score!!!!
Validation loss decreased (0.536443 --> 0.408201).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.269675970077515
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3765909  Vali Loss: 0.3483919 Vali Accuracy: 0.8769920  Vali weighted F1: 0.8651331  Vali macro F1 0.8167670 
new best score!!!!
Validation loss decreased (0.408201 --> 0.348392).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.274364709854126
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2924201  Vali Loss: 0.2634106 Vali Accuracy: 0.9098606  Vali weighted F1: 0.9052190  Vali macro F1 0.8693564 
new best score!!!!
Validation loss decreased (0.348392 --> 0.263411).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.279780149459839
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2525608  Vali Loss: 0.2309475 Vali Accuracy: 0.9218127  Vali weighted F1: 0.9178191  Vali macro F1 0.8930669 
new best score!!!!
Validation loss decreased (0.263411 --> 0.230948).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.274607419967651
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.2225845  Vali Loss: 0.2531294 Vali Accuracy: 0.9148406  Vali weighted F1: 0.9091179  Vali macro F1 0.8767874 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.270827531814575
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.2051230  Vali Loss: 0.1751562 Vali Accuracy: 0.9447211  Vali weighted F1: 0.9446639  Vali macro F1 0.9213768 
new best score!!!!
Validation loss decreased (0.230948 --> 0.175156).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.268357992172241
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1873317  Vali Loss: 0.1741138 Vali Accuracy: 0.9422311  Vali weighted F1: 0.9424119  Vali macro F1 0.9151768 
new best score!!!!
Validation loss decreased (0.175156 --> 0.174114).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2529919147491455
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1788556  Vali Loss: 0.1574802 Vali Accuracy: 0.9452191  Vali weighted F1: 0.9446276  Vali macro F1 0.9244337 
new best score!!!!
Validation loss decreased (0.174114 --> 0.157480).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.26072883605957
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1652038  Vali Loss: 0.1496835 Vali Accuracy: 0.9497012  Vali weighted F1: 0.9491689  Vali macro F1 0.9272235 
new best score!!!!
Validation loss decreased (0.157480 --> 0.149683).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.25621485710144
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1598776  Vali Loss: 0.1424512 Vali Accuracy: 0.9536853  Vali weighted F1: 0.9535640  Vali macro F1 0.9339656 
new best score!!!!
Validation loss decreased (0.149683 --> 0.142451).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.284151315689087
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1518520  Vali Loss: 0.1474249 Vali Accuracy: 0.9531873  Vali weighted F1: 0.9532809  Vali macro F1 0.9363722 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.288566827774048
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1465929  Vali Loss: 0.1436228 Vali Accuracy: 0.9546813  Vali weighted F1: 0.9548801  Vali macro F1 0.9372543 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.267681837081909
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1384626  Vali Loss: 0.1325079 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9600142  Vali macro F1 0.9440855 
new best score!!!!
Validation loss decreased (0.142451 --> 0.132508).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.258775472640991
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1259716  Vali Loss: 0.1327131 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9592848  Vali macro F1 0.9430696 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.271151065826416
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1289502  Vali Loss: 0.1233616 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9632924  Vali macro F1 0.9497988 
new best score!!!!
Validation loss decreased (0.132508 --> 0.123362).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.257831335067749
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.1214979  Vali Loss: 0.1261914 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9647176  Vali macro F1 0.9500215 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.260500431060791
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.1090050  Vali Loss: 0.1183577 Vali Accuracy: 0.9571713  Vali weighted F1: 0.9570288  Vali macro F1 0.9401685 
new best score!!!!
Validation loss decreased (0.123362 --> 0.118358).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.260871171951294
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.1064602  Vali Loss: 0.1268000 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9597177  Vali macro F1 0.9451035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.266967535018921
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.1022261  Vali Loss: 0.1202443 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9639217  Vali macro F1 0.9481629 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.291567802429199
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0992499  Vali Loss: 0.1187783 Vali Accuracy: 0.9646414  Vali weighted F1: 0.9651996  Vali macro F1 0.9519951 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.271961212158203
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0962288  Vali Loss: 0.1067909 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9681940  Vali macro F1 0.9551511 
new best score!!!!
Validation loss decreased (0.118358 --> 0.106791).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.262808799743652
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0937354  Vali Loss: 0.1039436 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9677367  Vali macro F1 0.9540675 
new best score!!!!
Validation loss decreased (0.106791 --> 0.103944).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.25434422492981
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0920417  Vali Loss: 0.1016100 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9691980  Vali macro F1 0.9556428 
new best score!!!!
Validation loss decreased (0.103944 --> 0.101610).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.270068168640137
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0826195  Vali Loss: 0.1270949 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9633268  Vali macro F1 0.9477356 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.2734620571136475
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0844983  Vali Loss: 0.1074766 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9677597  Vali macro F1 0.9529468 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.267584800720215
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0807516  Vali Loss: 0.1252877 Vali Accuracy: 0.9601594  Vali weighted F1: 0.9591062  Vali macro F1 0.9461982 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.277230978012085
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0764191  Vali Loss: 0.1080028 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9695092  Vali macro F1 0.9569078 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.298276901245117
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0765316  Vali Loss: 0.1026147 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9680760  Vali macro F1 0.9558432 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 6.302541017532349
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0627268  Vali Loss: 0.0910245 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737034  Vali macro F1 0.9629245 
new best score!!!!
Validation loss decreased (0.101610 --> 0.091024).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.272144079208374
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0586117  Vali Loss: 0.0910310 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9722744  Vali macro F1 0.9603690 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.273713827133179
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0569502  Vali Loss: 0.0966337 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717296  Vali macro F1 0.9589328 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.276811122894287
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0554928  Vali Loss: 0.0910313 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713646  Vali macro F1 0.9595164 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.278873443603516
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0563368  Vali Loss: 0.0941983 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717634  Vali macro F1 0.9599098 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.279068946838379
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0557694  Vali Loss: 0.0908432 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9717957  Vali macro F1 0.9596532 
new best score!!!!
Validation loss decreased (0.091024 --> 0.090843).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.277692556381226
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0543952  Vali Loss: 0.0920831 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9707852  Vali macro F1 0.9580440 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.285837650299072
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0534750  Vali Loss: 0.0939444 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727009  Vali macro F1 0.9606173 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.29788064956665
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0541707  Vali Loss: 0.0919421 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9722576  Vali macro F1 0.9607582 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.280515193939209
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0528631  Vali Loss: 0.0906793 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9702777  Vali macro F1 0.9576119 
new best score!!!!
Validation loss decreased (0.090843 --> 0.090679).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.269465923309326
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0528079  Vali Loss: 0.0924087 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9722744  Vali macro F1 0.9596701 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.2738213539123535
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0547123  Vali Loss: 0.0896416 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713358  Vali macro F1 0.9587665 
new best score!!!!
Validation loss decreased (0.090679 --> 0.089642).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.27699613571167
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0513357  Vali Loss: 0.0912330 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9736997  Vali macro F1 0.9617274 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.2755162715911865
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0517138  Vali Loss: 0.0892834 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728102  Vali macro F1 0.9612033 
new best score!!!!
Validation loss decreased (0.089642 --> 0.089283).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.267367124557495
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0506824  Vali Loss: 0.0903096 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713032  Vali macro F1 0.9590988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.33342981338501
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0505173  Vali Loss: 0.0916436 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9703554  Vali macro F1 0.9571392 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.313830614089966
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0506453  Vali Loss: 0.0880308 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9708736  Vali macro F1 0.9583248 
new best score!!!!
Validation loss decreased (0.089283 --> 0.088031).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.290595054626465
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0500540  Vali Loss: 0.0912247 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727522  Vali macro F1 0.9618887 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.264650821685791
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0497774  Vali Loss: 0.0899930 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9728076  Vali macro F1 0.9615721 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.274734735488892
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0493870  Vali Loss: 0.0898682 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9703791  Vali macro F1 0.9591919 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.266892433166504
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0487719  Vali Loss: 0.0918596 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727732  Vali macro F1 0.9607665 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.266167163848877
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0490524  Vali Loss: 0.0899371 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742225  Vali macro F1 0.9628385 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 6.264500379562378
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0480989  Vali Loss: 0.0894848 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737270  Vali macro F1 0.9620262 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.275896072387695
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0462690  Vali Loss: 0.0894207 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732647  Vali macro F1 0.9612869 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.297614574432373
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0454777  Vali Loss: 0.0892997 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727926  Vali macro F1 0.9608537 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.26845121383667
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0463174  Vali Loss: 0.0885889 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732787  Vali macro F1 0.9620443 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.26656699180603
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0454954  Vali Loss: 0.0888966 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737195  Vali macro F1 0.9624079 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 6.275582551956177
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0448927  Vali Loss: 0.0888622 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732404  Vali macro F1 0.9619441 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 6.2790207862854
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0465773  Vali Loss: 0.0889544 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737195  Vali macro F1 0.9624079 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 6.281498670578003
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0475310  Vali Loss: 0.0889979 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732396  Vali macro F1 0.9619830 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 6.269439458847046
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0459016  Vali Loss: 0.0889094 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732396  Vali macro F1 0.9619830 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 6.274251461029053
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0456534  Vali Loss: 0.0889613 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732396  Vali macro F1 0.9619830 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9287298  Test weighted F1: 0.9262269  Test macro F1 0.8683123 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3000946044921875
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0498385  Vali Loss: 0.0923585 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9746817  Vali macro F1 0.9629285 
Validation loss decreased (inf --> 0.092359).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.244242906570435
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0491087  Vali Loss: 0.0881869 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9747345  Vali macro F1 0.9634713 
new best score!!!!
Validation loss decreased (0.092359 --> 0.088187).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.241749048233032
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0485651  Vali Loss: 0.0900826 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9699046  Vali macro F1 0.9578468 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.244273662567139
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0474337  Vali Loss: 0.0980380 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697216  Vali macro F1 0.9565164 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.275431156158447
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0480682  Vali Loss: 0.0910317 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9708039  Vali macro F1 0.9589252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.269897937774658
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0488713  Vali Loss: 0.0885974 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727512  Vali macro F1 0.9608298 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.273599624633789
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0469683  Vali Loss: 0.0906523 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9713996  Vali macro F1 0.9601051 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.257522344589233
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0470748  Vali Loss: 0.0878293 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738339  Vali macro F1 0.9623258 
new best score!!!!
Validation loss decreased (0.088187 --> 0.087829).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.269708633422852
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0463541  Vali Loss: 0.0919691 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9727322  Vali macro F1 0.9608718 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.274451732635498
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0468564  Vali Loss: 0.0906976 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9708510  Vali macro F1 0.9586406 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.260966062545776
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0446435  Vali Loss: 0.0870596 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738193  Vali macro F1 0.9624936 
new best score!!!!
Validation loss decreased (0.087829 --> 0.087060).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.266498565673828
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0456946  Vali Loss: 0.0855308 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9733667  Vali macro F1 0.9624839 
new best score!!!!
Validation loss decreased (0.087060 --> 0.085531).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.27063250541687
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0446763  Vali Loss: 0.0876899 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9737575  Vali macro F1 0.9630159 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.268770694732666
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0443124  Vali Loss: 0.0898882 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9736114  Vali macro F1 0.9625313 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.260107517242432
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0445675  Vali Loss: 0.0859893 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9738442  Vali macro F1 0.9635726 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.279639959335327
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0429942  Vali Loss: 0.0878154 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9742820  Vali macro F1 0.9624180 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.258563756942749
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0442316  Vali Loss: 0.0899059 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9732713  Vali macro F1 0.9623570 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.2959067821502686
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0416786  Vali Loss: 0.0870585 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9766898  Vali macro F1 0.9665886 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.262285232543945
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0411485  Vali Loss: 0.0880352 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9766782  Vali macro F1 0.9662074 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.259576320648193
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0418758  Vali Loss: 0.0866943 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9752359  Vali macro F1 0.9645366 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.266602516174316
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0414208  Vali Loss: 0.0875634 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9756824  Vali macro F1 0.9649089 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.250323295593262
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0420232  Vali Loss: 0.0880075 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9761647  Vali macro F1 0.9653378 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.259839296340942
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0393769  Vali Loss: 0.0877234 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9757170  Vali macro F1 0.9649632 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.25041127204895
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0403753  Vali Loss: 0.0876904 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9757170  Vali macro F1 0.9649632 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.27093243598938
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0406753  Vali Loss: 0.0877033 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9752359  Vali macro F1 0.9645366 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.274048328399658
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0415472  Vali Loss: 0.0876144 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9752359  Vali macro F1 0.9645366 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.274328231811523
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0420707  Vali Loss: 0.0876339 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9752359  Vali macro F1 0.9645366 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9277322  Test weighted F1: 0.9256925  Test macro F1 0.8718672 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 63951
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014613 0.00018073 0.00098135 0.00123762 0.00048216 0.00061576]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.229759931564331
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2324771  Vali Loss: 0.7812955 Vali Accuracy: 0.6852690  Vali weighted F1: 0.6086206  Vali macro F1 0.3570798 
Validation loss decreased (inf --> 0.781295).  Saving model ...
Epoch: 2 cost time: 6.225413084030151
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6090307  Vali Loss: 0.4948117 Vali Accuracy: 0.8270488  Vali weighted F1: 0.7975234  Vali macro F1 0.7577223 
new best score!!!!
Validation loss decreased (0.781295 --> 0.494812).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.221081256866455
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4451357  Vali Loss: 0.3774663 Vali Accuracy: 0.8722976  Vali weighted F1: 0.8567998  Vali macro F1 0.8205134 
new best score!!!!
Validation loss decreased (0.494812 --> 0.377466).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.224544048309326
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3280824  Vali Loss: 0.2734851 Vali Accuracy: 0.9110106  Vali weighted F1: 0.9090718  Vali macro F1 0.8850261 
new best score!!!!
Validation loss decreased (0.377466 --> 0.273485).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.232264757156372
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2602336  Vali Loss: 0.2138092 Vali Accuracy: 0.9316239  Vali weighted F1: 0.9319802  Vali macro F1 0.9159862 
new best score!!!!
Validation loss decreased (0.273485 --> 0.213809).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.256706237792969
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2127477  Vali Loss: 0.1680225 Vali Accuracy: 0.9502262  Vali weighted F1: 0.9493623  Vali macro F1 0.9350518 
new best score!!!!
Validation loss decreased (0.213809 --> 0.168022).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.274770021438599
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1847869  Vali Loss: 0.1467916 Vali Accuracy: 0.9552539  Vali weighted F1: 0.9549304  Vali macro F1 0.9391992 
new best score!!!!
Validation loss decreased (0.168022 --> 0.146792).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.244946479797363
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1887912  Vali Loss: 0.1615730 Vali Accuracy: 0.9451986  Vali weighted F1: 0.9437538  Vali macro F1 0.9253089 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.236552000045776
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1563958  Vali Loss: 0.1402796 Vali Accuracy: 0.9542484  Vali weighted F1: 0.9533487  Vali macro F1 0.9384470 
new best score!!!!
Validation loss decreased (0.146792 --> 0.140280).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.245996952056885
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1487767  Vali Loss: 0.1220534 Vali Accuracy: 0.9577677  Vali weighted F1: 0.9574833  Vali macro F1 0.9401159 
new best score!!!!
Validation loss decreased (0.140280 --> 0.122053).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.244974851608276
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1451434  Vali Loss: 0.1318637 Vali Accuracy: 0.9567622  Vali weighted F1: 0.9565408  Vali macro F1 0.9414860 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.251327276229858
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1385841  Vali Loss: 0.1088139 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9619924  Vali macro F1 0.9462653 
new best score!!!!
Validation loss decreased (0.122053 --> 0.108814).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.247945070266724
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1327681  Vali Loss: 0.1065783 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9624341  Vali macro F1 0.9470547 
new best score!!!!
Validation loss decreased (0.108814 --> 0.106578).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.247223377227783
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1206290  Vali Loss: 0.0999918 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9665326  Vali macro F1 0.9566100 
new best score!!!!
Validation loss decreased (0.106578 --> 0.099992).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.253175735473633
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1165895  Vali Loss: 0.1089609 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9625734  Vali macro F1 0.9519845 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.274063587188721
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1111611  Vali Loss: 0.0938976 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9680866  Vali macro F1 0.9528764 
new best score!!!!
Validation loss decreased (0.099992 --> 0.093898).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.240602970123291
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1018438  Vali Loss: 0.0851112 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9696932  Vali macro F1 0.9539446 
new best score!!!!
Validation loss decreased (0.093898 --> 0.085111).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.233888149261475
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0946884  Vali Loss: 0.0747048 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9763609  Vali macro F1 0.9689861 
new best score!!!!
Validation loss decreased (0.085111 --> 0.074705).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.2444188594818115
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0931328  Vali Loss: 0.0778157 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9782205  Vali macro F1 0.9692106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.248786687850952
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0885350  Vali Loss: 0.0770084 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9766290  Vali macro F1 0.9670361 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.273928165435791
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0858542  Vali Loss: 0.0706873 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9798577  Vali macro F1 0.9707339 
new best score!!!!
Validation loss decreased (0.074705 --> 0.070687).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.24684739112854
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0873716  Vali Loss: 0.0797729 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9737947  Vali macro F1 0.9615803 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.249204158782959
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0832817  Vali Loss: 0.0696268 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9786501  Vali macro F1 0.9731215 
new best score!!!!
Validation loss decreased (0.070687 --> 0.069627).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.25394082069397
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0672559  Vali Loss: 0.0714604 Vali Accuracy: 0.9793866  Vali weighted F1: 0.9793077  Vali macro F1 0.9721979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.258882522583008
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0785097  Vali Loss: 0.0779977 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9745327  Vali macro F1 0.9612784 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.2400596141815186
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0717718  Vali Loss: 0.0744923 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9789664  Vali macro F1 0.9729393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.237210750579834
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0668667  Vali Loss: 0.0660643 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9782934  Vali macro F1 0.9709537 
new best score!!!!
Validation loss decreased (0.069627 --> 0.066064).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.241138219833374
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0567490  Vali Loss: 0.0655843 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828628  Vali macro F1 0.9787130 
new best score!!!!
Validation loss decreased (0.066064 --> 0.065584).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.237415313720703
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0589557  Vali Loss: 0.0668398 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802298  Vali macro F1 0.9717630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.232264280319214
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0529675  Vali Loss: 0.0670516 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9778858  Vali macro F1 0.9710595 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.232606410980225
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0541803  Vali Loss: 0.0731263 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9776359  Vali macro F1 0.9680065 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.239218473434448
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0489111  Vali Loss: 0.0875653 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9751053  Vali macro F1 0.9679306 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.251139402389526
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0465914  Vali Loss: 0.0576221 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9822558  Vali macro F1 0.9776991 
new best score!!!!
Validation loss decreased (0.065584 --> 0.057622).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.2626426219940186
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0452069  Vali Loss: 0.0689412 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9796829  Vali macro F1 0.9738321 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.2369561195373535
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0450915  Vali Loss: 0.0867643 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9764990  Vali macro F1 0.9706827 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.242053270339966
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0410899  Vali Loss: 0.0624098 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9817564  Vali macro F1 0.9772619 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.2394325733184814
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0442630  Vali Loss: 0.0922351 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9732379  Vali macro F1 0.9673681 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.243793964385986
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0479820  Vali Loss: 0.0648295 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823730  Vali macro F1 0.9758332 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 6.239204168319702
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0300314  Vali Loss: 0.0557554 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838701  Vali macro F1 0.9775525 
new best score!!!!
Validation loss decreased (0.057622 --> 0.055755).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.235357046127319
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0275666  Vali Loss: 0.0541350 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838487  Vali macro F1 0.9790062 
new best score!!!!
Validation loss decreased (0.055755 --> 0.054135).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.252048015594482
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0264794  Vali Loss: 0.0541452 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848594  Vali macro F1 0.9800029 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.245996713638306
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0260606  Vali Loss: 0.0530469 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848675  Vali macro F1 0.9794456 
new best score!!!!
Validation loss decreased (0.054135 --> 0.053047).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.2652037143707275
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0254199  Vali Loss: 0.0567763 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848127  Vali macro F1 0.9811260 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.240104913711548
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0244244  Vali Loss: 0.0523019 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858877  Vali macro F1 0.9807576 
new best score!!!!
Validation loss decreased (0.053047 --> 0.052302).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.232179403305054
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0243741  Vali Loss: 0.0576342 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9843607  Vali macro F1 0.9789229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.228816509246826
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0241933  Vali Loss: 0.0568185 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838642  Vali macro F1 0.9775961 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.2366862297058105
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0226781  Vali Loss: 0.0543497 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848870  Vali macro F1 0.9791903 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.235472679138184
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0242508  Vali Loss: 0.0555023 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848381  Vali macro F1 0.9808294 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.251628637313843
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0228532  Vali Loss: 0.0572310 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848492  Vali macro F1 0.9808501 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.258833885192871
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0217476  Vali Loss: 0.0538454 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869002  Vali macro F1 0.9829572 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.25112509727478
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0217902  Vali Loss: 0.0537648 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869002  Vali macro F1 0.9829572 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.247553825378418
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0224688  Vali Loss: 0.0537976 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853977  Vali macro F1 0.9803141 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.243095397949219
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0213557  Vali Loss: 0.0534869 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859028  Vali macro F1 0.9810893 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.243672132492065
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0216513  Vali Loss: 0.0538485 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859028  Vali macro F1 0.9810893 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.242980718612671
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0225668  Vali Loss: 0.0538427 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859028  Vali macro F1 0.9810893 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.243013381958008
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0215158  Vali Loss: 0.0538406 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853977  Vali macro F1 0.9803141 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.241757392883301
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0225227  Vali Loss: 0.0538199 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853977  Vali macro F1 0.9803141 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.234043836593628
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0203979  Vali Loss: 0.0538180 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853977  Vali macro F1 0.9803141 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.253927946090698
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0216698  Vali Loss: 0.0538245 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853977  Vali macro F1 0.9803141 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8155223  Test weighted F1: 0.8263393  Test macro F1 0.7609749 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.274780035018921
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0242399  Vali Loss: 0.0544161 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828110  Vali macro F1 0.9771077 
Validation loss decreased (inf --> 0.054416).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.229454517364502
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0250979  Vali Loss: 0.0592067 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9822549  Vali macro F1 0.9762366 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.212744951248169
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0227884  Vali Loss: 0.0594981 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848521  Vali macro F1 0.9794358 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.250751256942749
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0233943  Vali Loss: 0.0561517 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848772  Vali macro F1 0.9803832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.256083011627197
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0228561  Vali Loss: 0.0611614 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828153  Vali macro F1 0.9772905 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.242553472518921
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0228291  Vali Loss: 0.0541934 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863738  Vali macro F1 0.9827659 
new best score!!!!
Validation loss decreased (0.054416 --> 0.054193).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.252682685852051
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0218278  Vali Loss: 0.0618504 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828118  Vali macro F1 0.9784916 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.241082429885864
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0224745  Vali Loss: 0.0539729 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9868927  Vali macro F1 0.9831363 
new best score!!!!
Validation loss decreased (0.054193 --> 0.053973).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.255366802215576
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0208298  Vali Loss: 0.0577668 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849184  Vali macro F1 0.9802062 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.264102458953857
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0204623  Vali Loss: 0.0557803 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864267  Vali macro F1 0.9819253 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.241390705108643
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0210954  Vali Loss: 0.0626780 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833537  Vali macro F1 0.9790807 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.234786033630371
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0196438  Vali Loss: 0.0601071 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9843297  Vali macro F1 0.9803479 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.23990535736084
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0206268  Vali Loss: 0.0603995 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9843606  Vali macro F1 0.9800703 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.235446929931641
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0190624  Vali Loss: 0.0554378 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858910  Vali macro F1 0.9814047 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.237489938735962
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0188928  Vali Loss: 0.0555909 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859028  Vali macro F1 0.9810893 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.225802898406982
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0192678  Vali Loss: 0.0548266 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853999  Vali macro F1 0.9803139 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.259948253631592
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0181578  Vali Loss: 0.0548337 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859028  Vali macro F1 0.9810893 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.252790689468384
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0182961  Vali Loss: 0.0549028 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859049  Vali macro F1 0.9810892 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 19 cost time: 6.256817102432251
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0174185  Vali Loss: 0.0550047 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859049  Vali macro F1 0.9810892 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.241331338882446
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0178506  Vali Loss: 0.0549887 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859049  Vali macro F1 0.9810892 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.24351692199707
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0192633  Vali Loss: 0.0550986 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853999  Vali macro F1 0.9803139 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.235490560531616
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0185565  Vali Loss: 0.0552217 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859028  Vali macro F1 0.9810893 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.243549108505249
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0187202  Vali Loss: 0.0552559 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853999  Vali macro F1 0.9803139 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8264803  Test weighted F1: 0.8347039  Test macro F1 0.7674333 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00015004 0.00018238 0.0010989  0.00140056 0.00050813 0.00061996]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.041928768157959
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.2317780  Vali Loss: 0.7503786 Vali Accuracy: 0.7122862  Vali weighted F1: 0.6299251  Vali macro F1 0.3323709 
Validation loss decreased (inf --> 0.750379).  Saving model ...
Epoch: 2 cost time: 6.043250322341919
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.6352620  Vali Loss: 0.4785261 Vali Accuracy: 0.8460342  Vali weighted F1: 0.8259489  Vali macro F1 0.7533606 
new best score!!!!
Validation loss decreased (0.750379 --> 0.478526).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.051326274871826
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.4210602  Vali Loss: 0.3241728 Vali Accuracy: 0.8916537  Vali weighted F1: 0.8858812  Vali macro F1 0.8427041 
new best score!!!!
Validation loss decreased (0.478526 --> 0.324173).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.044360399246216
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.3135971  Vali Loss: 0.2210797 Vali Accuracy: 0.9237947  Vali weighted F1: 0.9207460  Vali macro F1 0.8825893 
new best score!!!!
Validation loss decreased (0.324173 --> 0.221080).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.03215479850769
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2283012  Vali Loss: 0.1899531 Vali Accuracy: 0.9383100  Vali weighted F1: 0.9380388  Vali macro F1 0.9051714 
new best score!!!!
Validation loss decreased (0.221080 --> 0.189953).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.041030168533325
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2001754  Vali Loss: 0.1806042 Vali Accuracy: 0.9414204  Vali weighted F1: 0.9394812  Vali macro F1 0.9081123 
new best score!!!!
Validation loss decreased (0.189953 --> 0.180604).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.039859771728516
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1713908  Vali Loss: 0.1500558 Vali Accuracy: 0.9481597  Vali weighted F1: 0.9477848  Vali macro F1 0.9235616 
new best score!!!!
Validation loss decreased (0.180604 --> 0.150056).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.035029888153076
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1638069  Vali Loss: 0.1527286 Vali Accuracy: 0.9481597  Vali weighted F1: 0.9476800  Vali macro F1 0.9249919 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.031002044677734
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1473623  Vali Loss: 0.1369089 Vali Accuracy: 0.9512701  Vali weighted F1: 0.9517386  Vali macro F1 0.9326667 
new best score!!!!
Validation loss decreased (0.150056 --> 0.136909).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.0437562465667725
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1416079  Vali Loss: 0.1156740 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9612561  Vali macro F1 0.9444107 
new best score!!!!
Validation loss decreased (0.136909 --> 0.115674).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.038879632949829
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1371408  Vali Loss: 0.1255496 Vali Accuracy: 0.9600829  Vali weighted F1: 0.9594099  Vali macro F1 0.9444949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.0340917110443115
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1230308  Vali Loss: 0.1228767 Vali Accuracy: 0.9574909  Vali weighted F1: 0.9570256  Vali macro F1 0.9416722 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.048551559448242
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.1152137  Vali Loss: 0.1037632 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9670942  Vali macro F1 0.9543281 
new best score!!!!
Validation loss decreased (0.115674 --> 0.103763).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.032867431640625
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.1089294  Vali Loss: 0.1154602 Vali Accuracy: 0.9631934  Vali weighted F1: 0.9624844  Vali macro F1 0.9484008 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.020902633666992
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.1040727  Vali Loss: 0.1134809 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9662074  Vali macro F1 0.9511515 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.022559404373169
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.1004934  Vali Loss: 0.0918547 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9736798  Vali macro F1 0.9615678 
new best score!!!!
Validation loss decreased (0.103763 --> 0.091855).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.027349472045898
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0892895  Vali Loss: 0.1086200 Vali Accuracy: 0.9652670  Vali weighted F1: 0.9646690  Vali macro F1 0.9521679 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.042099237442017
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0892647  Vali Loss: 0.1042743 Vali Accuracy: 0.9663038  Vali weighted F1: 0.9658297  Vali macro F1 0.9503871 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.043523788452148
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0865363  Vali Loss: 0.0863849 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9720055  Vali macro F1 0.9599939 
new best score!!!!
Validation loss decreased (0.091855 --> 0.086385).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.041737079620361
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0820436  Vali Loss: 0.0774418 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9773019  Vali macro F1 0.9675535 
new best score!!!!
Validation loss decreased (0.086385 --> 0.077442).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.055455207824707
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0790860  Vali Loss: 0.0764329 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756000  Vali macro F1 0.9648116 
new best score!!!!
Validation loss decreased (0.077442 --> 0.076433).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.070908546447754
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0766580  Vali Loss: 0.0732424 Vali Accuracy: 0.9745982  Vali weighted F1: 0.9746852  Vali macro F1 0.9634516 
new best score!!!!
Validation loss decreased (0.076433 --> 0.073242).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.040363550186157
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0685949  Vali Loss: 0.0763875 Vali Accuracy: 0.9730430  Vali weighted F1: 0.9730434  Vali macro F1 0.9622870 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.042106628417969
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0734690  Vali Loss: 0.0950610 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9686470  Vali macro F1 0.9536102 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.041562080383301
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0762611  Vali Loss: 0.0866854 Vali Accuracy: 0.9709694  Vali weighted F1: 0.9705876  Vali macro F1 0.9603018 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.03793478012085
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0711293  Vali Loss: 0.0963580 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9662992  Vali macro F1 0.9533026 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 6.043540000915527
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0621453  Vali Loss: 0.0666009 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9753807  Vali macro F1 0.9651434 
new best score!!!!
Validation loss decreased (0.073242 --> 0.066601).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.05426812171936
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0603271  Vali Loss: 0.0687880 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9775289  Vali macro F1 0.9687403 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.044641494750977
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0558631  Vali Loss: 0.0626956 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808122  Vali macro F1 0.9722405 
new best score!!!!
Validation loss decreased (0.066601 --> 0.062696).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.044452667236328
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0597186  Vali Loss: 0.0886117 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9732088  Vali macro F1 0.9625907 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.071500301361084
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0488309  Vali Loss: 0.0684866 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797969  Vali macro F1 0.9722335 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.041783571243286
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0557884  Vali Loss: 0.1012561 Vali Accuracy: 0.9688958  Vali weighted F1: 0.9687622  Vali macro F1 0.9546340 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.041270971298218
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0574813  Vali Loss: 0.0665049 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9769640  Vali macro F1 0.9668370 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.036717891693115
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0454813  Vali Loss: 0.0907712 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9715331  Vali macro F1 0.9609552 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.034573078155518
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0394865  Vali Loss: 0.0603329 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827869  Vali macro F1 0.9746726 
new best score!!!!
Validation loss decreased (0.062696 --> 0.060333).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.038055658340454
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0364987  Vali Loss: 0.0603251 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827869  Vali macro F1 0.9746726 
new best score!!!!
Validation loss decreased (0.060333 --> 0.060325).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.034341812133789
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0357137  Vali Loss: 0.0628266 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9806910  Vali macro F1 0.9722443 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.029996871948242
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0329029  Vali Loss: 0.0618077 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817901  Vali macro F1 0.9735304 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.036317825317383
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0326317  Vali Loss: 0.0597324 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827923  Vali macro F1 0.9746656 
new best score!!!!
Validation loss decreased (0.060325 --> 0.059732).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.045486688613892
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0332941  Vali Loss: 0.0626513 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812257  Vali macro F1 0.9720979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.044587135314941
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0332659  Vali Loss: 0.0623139 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9806945  Vali macro F1 0.9715387 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.026360034942627
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0327635  Vali Loss: 0.0606673 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812451  Vali macro F1 0.9724955 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.032528400421143
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0308054  Vali Loss: 0.0613560 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812147  Vali macro F1 0.9724039 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.025821924209595
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0325184  Vali Loss: 0.0627413 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812527  Vali macro F1 0.9723416 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 6.0256667137146
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0303921  Vali Loss: 0.0629310 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812147  Vali macro F1 0.9724039 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.023513078689575
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0298748  Vali Loss: 0.0631115 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9822535  Vali macro F1 0.9741297 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.030270338058472
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0310896  Vali Loss: 0.0624521 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9822684  Vali macro F1 0.9738121 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.047650337219238
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0295914  Vali Loss: 0.0617951 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827721  Vali macro F1 0.9749903 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.077965974807739
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0308901  Vali Loss: 0.0628659 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827869  Vali macro F1 0.9746726 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 6.042312383651733
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0303839  Vali Loss: 0.0627728 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827869  Vali macro F1 0.9746726 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.03255820274353
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0310996  Vali Loss: 0.0625871 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827869  Vali macro F1 0.9746726 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.036585330963135
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0312381  Vali Loss: 0.0625381 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827721  Vali macro F1 0.9749903 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.033191442489624
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0293701  Vali Loss: 0.0625204 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827721  Vali macro F1 0.9749903 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.03513765335083
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0303927  Vali Loss: 0.0624735 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9827721  Vali macro F1 0.9749903 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9213120  Test weighted F1: 0.9230850  Test macro F1 0.8633548 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.036628007888794
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0352534  Vali Loss: 0.0645278 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817460  Vali macro F1 0.9735982 
Validation loss decreased (inf --> 0.064528).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.033755302429199
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0318975  Vali Loss: 0.0666946 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9806483  Vali macro F1 0.9720586 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.031011343002319
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0336356  Vali Loss: 0.0614130 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812297  Vali macro F1 0.9720867 
new best score!!!!
Validation loss decreased (0.064528 --> 0.061413).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.042867422103882
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0317664  Vali Loss: 0.0647263 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9806632  Vali macro F1 0.9716087 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.0290796756744385
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0321636  Vali Loss: 0.0708282 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9795822  Vali macro F1 0.9704472 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.036047697067261
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0332763  Vali Loss: 0.0674896 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9801530  Vali macro F1 0.9707436 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.037832498550415
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0324068  Vali Loss: 0.0651370 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9811728  Vali macro F1 0.9723891 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.032891750335693
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0325969  Vali Loss: 0.0624005 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9801967  Vali macro F1 0.9711062 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.032984733581543
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0302324  Vali Loss: 0.0638933 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813215  Vali macro F1 0.9723689 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.029123306274414
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0296306  Vali Loss: 0.0637713 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823195  Vali macro F1 0.9741548 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.029839992523193
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0311058  Vali Loss: 0.0665963 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9801789  Vali macro F1 0.9703960 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.062345266342163
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0296957  Vali Loss: 0.0631485 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823082  Vali macro F1 0.9744321 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.0738914012908936
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0296996  Vali Loss: 0.0630877 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812575  Vali macro F1 0.9721915 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.02694296836853
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0280059  Vali Loss: 0.0621186 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817343  Vali macro F1 0.9732675 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.019927978515625
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0269847  Vali Loss: 0.0619300 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9822731  Vali macro F1 0.9738033 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.018133163452148
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0276800  Vali Loss: 0.0625264 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817343  Vali macro F1 0.9732675 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.018486976623535
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0270299  Vali Loss: 0.0631680 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9822535  Vali macro F1 0.9741297 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.023087739944458
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0283827  Vali Loss: 0.0624820 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812147  Vali macro F1 0.9724039 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9246227  Test weighted F1: 0.9256933  Test macro F1 0.8652290 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014912 0.00018123 0.00097087 0.00125    0.00049702 0.00061805]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.145095586776733
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2308624  Vali Loss: 0.7484861 Vali Accuracy: 0.7160305  Vali weighted F1: 0.6538900  Vali macro F1 0.3512491 
Validation loss decreased (inf --> 0.748486).  Saving model ...
Epoch: 2 cost time: 6.147323846817017
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6080324  Vali Loss: 0.4575358 Vali Accuracy: 0.8529262  Vali weighted F1: 0.8345610  Vali macro F1 0.7807076 
new best score!!!!
Validation loss decreased (0.748486 --> 0.457536).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.148195028305054
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4135301  Vali Loss: 0.3357836 Vali Accuracy: 0.8885496  Vali weighted F1: 0.8793031  Vali macro F1 0.8338828 
new best score!!!!
Validation loss decreased (0.457536 --> 0.335784).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.1292924880981445
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3554325  Vali Loss: 0.3166062 Vali Accuracy: 0.8910941  Vali weighted F1: 0.8809784  Vali macro F1 0.8426571 
new best score!!!!
Validation loss decreased (0.335784 --> 0.316606).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.147720575332642
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.3125532  Vali Loss: 0.3188992 Vali Accuracy: 0.8849873  Vali weighted F1: 0.8797960  Vali macro F1 0.8415708 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.135244846343994
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2590766  Vali Loss: 0.2360312 Vali Accuracy: 0.9180662  Vali weighted F1: 0.9150247  Vali macro F1 0.8827966 
new best score!!!!
Validation loss decreased (0.316606 --> 0.236031).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.152023792266846
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2350366  Vali Loss: 0.2768294 Vali Accuracy: 0.9104326  Vali weighted F1: 0.9067804  Vali macro F1 0.8775095 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.1510560512542725
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.2129690  Vali Loss: 0.1960866 Vali Accuracy: 0.9363868  Vali weighted F1: 0.9354904  Vali macro F1 0.9141529 
new best score!!!!
Validation loss decreased (0.236031 --> 0.196087).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.138674259185791
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1938805  Vali Loss: 0.1937693 Vali Accuracy: 0.9389313  Vali weighted F1: 0.9376924  Vali macro F1 0.9127030 
new best score!!!!
Validation loss decreased (0.196087 --> 0.193769).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.144574880599976
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1743772  Vali Loss: 0.1978195 Vali Accuracy: 0.9323155  Vali weighted F1: 0.9296834  Vali macro F1 0.9063202 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.1661481857299805
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1593888  Vali Loss: 0.1815787 Vali Accuracy: 0.9368957  Vali weighted F1: 0.9360733  Vali macro F1 0.9075976 
new best score!!!!
Validation loss decreased (0.193769 --> 0.181579).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.162245035171509
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1563637  Vali Loss: 0.1802365 Vali Accuracy: 0.9363868  Vali weighted F1: 0.9341256  Vali macro F1 0.9099539 
new best score!!!!
Validation loss decreased (0.181579 --> 0.180236).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.142099142074585
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1446884  Vali Loss: 0.1521872 Vali Accuracy: 0.9506361  Vali weighted F1: 0.9503686  Vali macro F1 0.9300089 
new best score!!!!
Validation loss decreased (0.180236 --> 0.152187).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.139279842376709
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1465655  Vali Loss: 0.1649409 Vali Accuracy: 0.9486005  Vali weighted F1: 0.9483723  Vali macro F1 0.9273932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.146876096725464
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1346852  Vali Loss: 0.1328715 Vali Accuracy: 0.9511450  Vali weighted F1: 0.9508886  Vali macro F1 0.9308810 
new best score!!!!
Validation loss decreased (0.152187 --> 0.132872).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.150599718093872
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1234328  Vali Loss: 0.1618695 Vali Accuracy: 0.9419847  Vali weighted F1: 0.9417832  Vali macro F1 0.9197114 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.153384685516357
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1317890  Vali Loss: 0.1378322 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9552170  Vali macro F1 0.9381903 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.145156621932983
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1134897  Vali Loss: 0.1130111 Vali Accuracy: 0.9608142  Vali weighted F1: 0.9604409  Vali macro F1 0.9463497 
new best score!!!!
Validation loss decreased (0.132872 --> 0.113011).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.134124755859375
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.1061636  Vali Loss: 0.1194742 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9634379  Vali macro F1 0.9486006 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.14613676071167
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.1065972  Vali Loss: 0.1151607 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9612059  Vali macro F1 0.9459294 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.164921522140503
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0979980  Vali Loss: 0.1718271 Vali Accuracy: 0.9409669  Vali weighted F1: 0.9398150  Vali macro F1 0.9230690 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.150314807891846
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.1064704  Vali Loss: 0.1080969 Vali Accuracy: 0.9638677  Vali weighted F1: 0.9634875  Vali macro F1 0.9492205 
new best score!!!!
Validation loss decreased (0.113011 --> 0.108097).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.143768787384033
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0974054  Vali Loss: 0.1047502 Vali Accuracy: 0.9628499  Vali weighted F1: 0.9623697  Vali macro F1 0.9484481 
new best score!!!!
Validation loss decreased (0.108097 --> 0.104750).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.147418737411499
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0873532  Vali Loss: 0.1070984 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9644686  Vali macro F1 0.9506387 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.151469469070435
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0915320  Vali Loss: 0.1411374 Vali Accuracy: 0.9470738  Vali weighted F1: 0.9476290  Vali macro F1 0.9292669 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.143527269363403
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0814335  Vali Loss: 0.0993779 Vali Accuracy: 0.9664122  Vali weighted F1: 0.9660318  Vali macro F1 0.9516112 
new best score!!!!
Validation loss decreased (0.104750 --> 0.099378).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.138477087020874
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0822405  Vali Loss: 0.1054573 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9643294  Vali macro F1 0.9509302 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.163378477096558
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0758789  Vali Loss: 0.0903111 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9712647  Vali macro F1 0.9600522 
new best score!!!!
Validation loss decreased (0.099378 --> 0.090311).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.284965515136719
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0746791  Vali Loss: 0.1226622 Vali Accuracy: 0.9603053  Vali weighted F1: 0.9597411  Vali macro F1 0.9480703 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.163517951965332
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0742341  Vali Loss: 0.0918890 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9677904  Vali macro F1 0.9536047 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.137134790420532
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0656432  Vali Loss: 0.0993820 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9671845  Vali macro F1 0.9551194 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.135357618331909
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0650186  Vali Loss: 0.0994527 Vali Accuracy: 0.9674300  Vali weighted F1: 0.9668566  Vali macro F1 0.9539503 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.133470058441162
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0650860  Vali Loss: 0.0935350 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9684513  Vali macro F1 0.9568253 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 6.143330335617065
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0514407  Vali Loss: 0.0844978 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9717194  Vali macro F1 0.9608833 
new best score!!!!
Validation loss decreased (0.090311 --> 0.084498).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.143035888671875
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0507587  Vali Loss: 0.0808779 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9722772  Vali macro F1 0.9611730 
new best score!!!!
Validation loss decreased (0.084498 --> 0.080878).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.147718191146851
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0461093  Vali Loss: 0.0828362 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9721887  Vali macro F1 0.9610796 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.154013633728027
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0494965  Vali Loss: 0.0808776 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9723073  Vali macro F1 0.9605185 
new best score!!!!
Validation loss decreased (0.080878 --> 0.080878).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.153863430023193
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0461464  Vali Loss: 0.0805259 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9737944  Vali macro F1 0.9627406 
new best score!!!!
Validation loss decreased (0.080878 --> 0.080526).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.148910760879517
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0475373  Vali Loss: 0.0813038 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9728107  Vali macro F1 0.9617422 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.128353834152222
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0466377  Vali Loss: 0.0802570 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9722752  Vali macro F1 0.9611388 
new best score!!!!
Validation loss decreased (0.080526 --> 0.080257).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.136702299118042
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0444130  Vali Loss: 0.0796108 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9733203  Vali macro F1 0.9624216 
new best score!!!!
Validation loss decreased (0.080257 --> 0.079611).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.143679857254028
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0446396  Vali Loss: 0.0819885 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9723138  Vali macro F1 0.9611800 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.153083562850952
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0450645  Vali Loss: 0.0801863 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9727683  Vali macro F1 0.9616901 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.146262884140015
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0439782  Vali Loss: 0.0803164 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9722732  Vali macro F1 0.9610342 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.136667490005493
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0426735  Vali Loss: 0.0796239 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9717211  Vali macro F1 0.9608126 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.141014099121094
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0420861  Vali Loss: 0.0794479 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9712407  Vali macro F1 0.9593353 
new best score!!!!
Validation loss decreased (0.079611 --> 0.079448).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.155281066894531
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0428023  Vali Loss: 0.0810733 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9717354  Vali macro F1 0.9614460 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.173689126968384
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0432552  Vali Loss: 0.0790954 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9722702  Vali macro F1 0.9610556 
new best score!!!!
Validation loss decreased (0.079448 --> 0.079095).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.143732786178589
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0417977  Vali Loss: 0.0781295 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9717731  Vali macro F1 0.9599025 
new best score!!!!
Validation loss decreased (0.079095 --> 0.078129).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.12621545791626
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0411923  Vali Loss: 0.0781732 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9733596  Vali macro F1 0.9619998 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.1337854862213135
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0439405  Vali Loss: 0.0817876 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9722445  Vali macro F1 0.9616050 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.1364805698394775
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0416070  Vali Loss: 0.0770352 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758165  Vali macro F1 0.9675163 
new best score!!!!
Validation loss decreased (0.078129 --> 0.077035).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 6.132105350494385
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0414750  Vali Loss: 0.0771533 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9728091  Vali macro F1 0.9616540 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.129270315170288
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0389893  Vali Loss: 0.0794461 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9732813  Vali macro F1 0.9623787 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.131369590759277
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0400950  Vali Loss: 0.0765030 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9759316  Vali macro F1 0.9666882 
new best score!!!!
Validation loss decreased (0.077035 --> 0.076503).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 6.1393702030181885
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0404487  Vali Loss: 0.0774594 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9737972  Vali macro F1 0.9647287 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.16015625
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0383613  Vali Loss: 0.0776301 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9742695  Vali macro F1 0.9655797 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.129589796066284
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0385988  Vali Loss: 0.0774442 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9742827  Vali macro F1 0.9653060 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.113603830337524
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0383193  Vali Loss: 0.0764386 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9749082  Vali macro F1 0.9655894 
new best score!!!!
Validation loss decreased (0.076503 --> 0.076439).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 6.131203889846802
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0382266  Vali Loss: 0.0776826 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748604  Vali macro F1 0.9659340 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.125593662261963
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0377436  Vali Loss: 0.0826696 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9747589  Vali macro F1 0.9660335 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.124674558639526
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0362712  Vali Loss: 0.0768353 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753996  Vali macro F1 0.9663019 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.136020183563232
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0360425  Vali Loss: 0.0791446 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753662  Vali macro F1 0.9661531 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.151519536972046
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0371506  Vali Loss: 0.0785613 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748329  Vali macro F1 0.9654877 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 65 cost time: 6.1530234813690186
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0362038  Vali Loss: 0.0763224 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758844  Vali macro F1 0.9669814 
new best score!!!!
Validation loss decreased (0.076439 --> 0.076322).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 6.168473482131958
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0374153  Vali Loss: 0.0758161 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758828  Vali macro F1 0.9669904 
new best score!!!!
Validation loss decreased (0.076322 --> 0.075816).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 6.138051509857178
VALI: Epoch: 67, Steps: 70 | Train Loss: 0.0364787  Vali Loss: 0.0751983 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753907  Vali macro F1 0.9664567 
new best score!!!!
Validation loss decreased (0.075816 --> 0.075198).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 6.147349119186401
VALI: Epoch: 68, Steps: 70 | Train Loss: 0.0364936  Vali Loss: 0.0744483 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753680  Vali macro F1 0.9661442 
new best score!!!!
Validation loss decreased (0.075198 --> 0.074448).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 6.128468751907349
VALI: Epoch: 69, Steps: 70 | Train Loss: 0.0351156  Vali Loss: 0.0754267 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753907  Vali macro F1 0.9664567 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 6.125644683837891
VALI: Epoch: 70, Steps: 70 | Train Loss: 0.0376957  Vali Loss: 0.0756611 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753727  Vali macro F1 0.9666627 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 6.12882924079895
VALI: Epoch: 71, Steps: 70 | Train Loss: 0.0355377  Vali Loss: 0.0753804 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753907  Vali macro F1 0.9664567 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 6.131012439727783
VALI: Epoch: 72, Steps: 70 | Train Loss: 0.0355185  Vali Loss: 0.0752234 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753680  Vali macro F1 0.9661442 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 6.1228601932525635
VALI: Epoch: 73, Steps: 70 | Train Loss: 0.0352877  Vali Loss: 0.0746828 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753680  Vali macro F1 0.9661442 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 74 cost time: 6.131392955780029
VALI: Epoch: 74, Steps: 70 | Train Loss: 0.0347219  Vali Loss: 0.0749058 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753680  Vali macro F1 0.9661442 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 6.148069381713867
VALI: Epoch: 75, Steps: 70 | Train Loss: 0.0344706  Vali Loss: 0.0749588 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753680  Vali macro F1 0.9661442 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 6.128680467605591
VALI: Epoch: 76, Steps: 70 | Train Loss: 0.0354688  Vali Loss: 0.0751025 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753680  Vali macro F1 0.9661442 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 6.137394905090332
VALI: Epoch: 77, Steps: 70 | Train Loss: 0.0356677  Vali Loss: 0.0752611 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753680  Vali macro F1 0.9661442 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 6.133650302886963
VALI: Epoch: 78, Steps: 70 | Train Loss: 0.0349602  Vali Loss: 0.0754169 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753907  Vali macro F1 0.9664567 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 79 cost time: 6.126297950744629
VALI: Epoch: 79, Steps: 70 | Train Loss: 0.0347317  Vali Loss: 0.0754301 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753907  Vali macro F1 0.9664567 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 6.130542039871216
VALI: Epoch: 80, Steps: 70 | Train Loss: 0.0345459  Vali Loss: 0.0754309 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753907  Vali macro F1 0.9664567 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 6.119610786437988
VALI: Epoch: 81, Steps: 70 | Train Loss: 0.0346350  Vali Loss: 0.0754410 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758844  Vali macro F1 0.9669814 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 6.144418954849243
VALI: Epoch: 82, Steps: 70 | Train Loss: 0.0351398  Vali Loss: 0.0754256 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758844  Vali macro F1 0.9669814 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 6.145585060119629
VALI: Epoch: 83, Steps: 70 | Train Loss: 0.0358037  Vali Loss: 0.0754410 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753907  Vali macro F1 0.9664567 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8578985  Test weighted F1: 0.8670744  Test macro F1 0.8571294 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.166041374206543
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0363205  Vali Loss: 0.0816730 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9731655  Vali macro F1 0.9643247 
Validation loss decreased (inf --> 0.081673).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.143887519836426
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0357712  Vali Loss: 0.0762941 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9743247  Vali macro F1 0.9653132 
new best score!!!!
Validation loss decreased (0.081673 --> 0.076294).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.142396450042725
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0346648  Vali Loss: 0.0816980 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9737399  Vali macro F1 0.9645310 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.139227390289307
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0347574  Vali Loss: 0.0771377 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758226  Vali macro F1 0.9671480 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.147717475891113
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0359671  Vali Loss: 0.0772187 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753849  Vali macro F1 0.9663748 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.167661428451538
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0339493  Vali Loss: 0.0759395 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9754120  Vali macro F1 0.9652944 
new best score!!!!
Validation loss decreased (0.076294 --> 0.075940).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.161457538604736
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0345801  Vali Loss: 0.0779043 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753882  Vali macro F1 0.9663506 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.173985719680786
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0337333  Vali Loss: 0.0775053 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748423  Vali macro F1 0.9661399 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.173034429550171
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0354505  Vali Loss: 0.0750227 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753404  Vali macro F1 0.9665499 
new best score!!!!
Validation loss decreased (0.075940 --> 0.075023).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.144258499145508
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0317169  Vali Loss: 0.0758101 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758789  Vali macro F1 0.9668994 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.1459574699401855
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0320310  Vali Loss: 0.0785477 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9747943  Vali macro F1 0.9661776 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.158459186553955
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0327494  Vali Loss: 0.0769557 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748460  Vali macro F1 0.9652129 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.161846399307251
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0349257  Vali Loss: 0.0746901 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748413  Vali macro F1 0.9664385 
new best score!!!!
Validation loss decreased (0.075023 --> 0.074690).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.1545844078063965
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0353347  Vali Loss: 0.0773634 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758488  Vali macro F1 0.9674464 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.1608874797821045
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0324491  Vali Loss: 0.0726543 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753752  Vali macro F1 0.9657336 
new best score!!!!
Validation loss decreased (0.074690 --> 0.072654).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.160058498382568
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0322551  Vali Loss: 0.0746388 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758982  Vali macro F1 0.9666544 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.169834136962891
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0335919  Vali Loss: 0.0791594 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9768889  Vali macro F1 0.9682508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.169442653656006
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0323311  Vali Loss: 0.0719540 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748982  Vali macro F1 0.9658861 
new best score!!!!
Validation loss decreased (0.072654 --> 0.071954).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.1654276847839355
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0324084  Vali Loss: 0.0775984 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9737335  Vali macro F1 0.9649421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.168716907501221
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0303462  Vali Loss: 0.0742153 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753596  Vali macro F1 0.9669785 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.1583311557769775
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0304234  Vali Loss: 0.0717306 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9769415  Vali macro F1 0.9681135 
new best score!!!!
Validation loss decreased (0.071954 --> 0.071731).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.155182600021362
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0305896  Vali Loss: 0.0728900 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753630  Vali macro F1 0.9662009 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.142434120178223
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0288595  Vali Loss: 0.0747679 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758977  Vali macro F1 0.9667064 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.145852088928223
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0318662  Vali Loss: 0.0776988 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9752390  Vali macro F1 0.9667123 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.14258885383606
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0297571  Vali Loss: 0.0758475 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9758456  Vali macro F1 0.9674880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.154024600982666
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0318933  Vali Loss: 0.0767167 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9763935  Vali macro F1 0.9680457 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 27 cost time: 6.16900110244751
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0306136  Vali Loss: 0.0761011 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9743221  Vali macro F1 0.9647735 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.163029909133911
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0332282  Vali Loss: 0.0740876 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9759069  Vali macro F1 0.9672473 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.160989999771118
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0286577  Vali Loss: 0.0799135 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9757815  Vali macro F1 0.9678869 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.156705379486084
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0286851  Vali Loss: 0.0695245 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9774781  Vali macro F1 0.9693130 
new best score!!!!
Validation loss decreased (0.071731 --> 0.069524).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.166484832763672
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0294729  Vali Loss: 0.0763794 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753258  Vali macro F1 0.9677451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.1402587890625
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0275622  Vali Loss: 0.0710627 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9774625  Vali macro F1 0.9695533 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.165415525436401
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0274415  Vali Loss: 0.0804654 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9737139  Vali macro F1 0.9654814 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.1623992919921875
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0277494  Vali Loss: 0.0723601 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9774787  Vali macro F1 0.9674283 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.167189359664917
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0263612  Vali Loss: 0.0700623 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9754464  Vali macro F1 0.9662018 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 36 cost time: 6.177427291870117
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0240207  Vali Loss: 0.0738480 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748986  Vali macro F1 0.9659472 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.1517908573150635
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0278982  Vali Loss: 0.0722845 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9759578  Vali macro F1 0.9670307 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.157018661499023
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0262806  Vali Loss: 0.0708115 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9759021  Vali macro F1 0.9672771 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.14247465133667
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0253579  Vali Loss: 0.0734794 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753407  Vali macro F1 0.9671739 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.152256727218628
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0263289  Vali Loss: 0.0733128 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748222  Vali macro F1 0.9663633 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 41 cost time: 6.156775712966919
Fine Tuning VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0247676  Vali Loss: 0.0733827 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9753149  Vali macro F1 0.9668859 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 6.136949062347412
Fine Tuning VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0259730  Vali Loss: 0.0733749 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748228  Vali macro F1 0.9663231 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 6.145884037017822
Fine Tuning VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0256120  Vali Loss: 0.0732181 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748228  Vali macro F1 0.9663231 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 6.168564796447754
Fine Tuning VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0250422  Vali Loss: 0.0732315 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748228  Vali macro F1 0.9663231 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 6.16677188873291
Fine Tuning VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0247182  Vali Loss: 0.0733383 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9748228  Vali macro F1 0.9663231 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8524296  Test weighted F1: 0.8618941  Test macro F1 0.8514627 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014928 0.00018298 0.000999   0.0012837  0.00052329 0.00061805]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.047727823257446
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.2304495  Vali Loss: 0.7560468 Vali Accuracy: 0.7868177  Vali weighted F1: 0.7323140  Vali macro F1 0.6444205 
Validation loss decreased (inf --> 0.756047).  Saving model ...
Epoch: 2 cost time: 6.036652088165283
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.6106150  Vali Loss: 0.4728600 Vali Accuracy: 0.8347065  Vali weighted F1: 0.8191639  Vali macro F1 0.7694685 
new best score!!!!
Validation loss decreased (0.756047 --> 0.472860).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.0441734790802
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.4328492  Vali Loss: 0.3423802 Vali Accuracy: 0.8789907  Vali weighted F1: 0.8716799  Vali macro F1 0.8360453 
new best score!!!!
Validation loss decreased (0.472860 --> 0.342380).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.042181730270386
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.3229701  Vali Loss: 0.2980258 Vali Accuracy: 0.8995881  Vali weighted F1: 0.8918250  Vali macro F1 0.8623013 
new best score!!!!
Validation loss decreased (0.342380 --> 0.298026).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.054835081100464
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2507667  Vali Loss: 0.2165017 Vali Accuracy: 0.9273944  Vali weighted F1: 0.9251174  Vali macro F1 0.9008986 
new best score!!!!
Validation loss decreased (0.298026 --> 0.216502).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.0589892864227295
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2085131  Vali Loss: 0.1877253 Vali Accuracy: 0.9325438  Vali weighted F1: 0.9312361  Vali macro F1 0.9068700 
new best score!!!!
Validation loss decreased (0.216502 --> 0.187725).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.061963319778442
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1982851  Vali Loss: 0.1684193 Vali Accuracy: 0.9438723  Vali weighted F1: 0.9436610  Vali macro F1 0.9244738 
new best score!!!!
Validation loss decreased (0.187725 --> 0.168419).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.08034348487854
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1750236  Vali Loss: 0.1670873 Vali Accuracy: 0.9392379  Vali weighted F1: 0.9393867  Vali macro F1 0.9155286 
new best score!!!!
Validation loss decreased (0.168419 --> 0.167087).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.091632843017578
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1611864  Vali Loss: 0.1508636 Vali Accuracy: 0.9454171  Vali weighted F1: 0.9457848  Vali macro F1 0.9236307 
new best score!!!!
Validation loss decreased (0.167087 --> 0.150864).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.064768075942993
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1505298  Vali Loss: 0.1428836 Vali Accuracy: 0.9474768  Vali weighted F1: 0.9478291  Vali macro F1 0.9260429 
new best score!!!!
Validation loss decreased (0.150864 --> 0.142884).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.057387113571167
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1506882  Vali Loss: 0.1475410 Vali Accuracy: 0.9485067  Vali weighted F1: 0.9479221  Vali macro F1 0.9318480 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.052799940109253
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1410412  Vali Loss: 0.1349102 Vali Accuracy: 0.9495366  Vali weighted F1: 0.9497289  Vali macro F1 0.9318914 
new best score!!!!
Validation loss decreased (0.142884 --> 0.134910).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.047098398208618
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1294650  Vali Loss: 0.1337423 Vali Accuracy: 0.9485067  Vali weighted F1: 0.9488313  Vali macro F1 0.9345583 
new best score!!!!
Validation loss decreased (0.134910 --> 0.133742).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.056389808654785
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.1213165  Vali Loss: 0.1243611 Vali Accuracy: 0.9526262  Vali weighted F1: 0.9528958  Vali macro F1 0.9367905 
new best score!!!!
Validation loss decreased (0.133742 --> 0.124361).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.0608229637146
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.1138358  Vali Loss: 0.1255063 Vali Accuracy: 0.9515963  Vali weighted F1: 0.9511828  Vali macro F1 0.9319957 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.074429512023926
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.1103425  Vali Loss: 0.1243750 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9543645  Vali macro F1 0.9356672 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.0823304653167725
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.1101034  Vali Loss: 0.1220587 Vali Accuracy: 0.9557158  Vali weighted F1: 0.9557520  Vali macro F1 0.9388554 
new best score!!!!
Validation loss decreased (0.124361 --> 0.122059).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.059928894042969
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.1023987  Vali Loss: 0.1056647 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9634395  Vali macro F1 0.9474961 
new best score!!!!
Validation loss decreased (0.122059 --> 0.105665).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.044131517410278
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.1009497  Vali Loss: 0.1029781 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9634753  Vali macro F1 0.9494872 
new best score!!!!
Validation loss decreased (0.105665 --> 0.102978).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.049146890640259
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0944627  Vali Loss: 0.1180544 Vali Accuracy: 0.9546859  Vali weighted F1: 0.9538603  Vali macro F1 0.9396900 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.038140296936035
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0882782  Vali Loss: 0.1085003 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9609681  Vali macro F1 0.9458333 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.049480676651001
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0830948  Vali Loss: 0.0978452 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9645731  Vali macro F1 0.9520567 
new best score!!!!
Validation loss decreased (0.102978 --> 0.097845).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.062234163284302
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0837453  Vali Loss: 0.1052620 Vali Accuracy: 0.9629248  Vali weighted F1: 0.9634466  Vali macro F1 0.9478204 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.054078578948975
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0837695  Vali Loss: 0.0965064 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9662758  Vali macro F1 0.9562867 
new best score!!!!
Validation loss decreased (0.097845 --> 0.096506).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.0626890659332275
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0753230  Vali Loss: 0.0917376 Vali Accuracy: 0.9649846  Vali weighted F1: 0.9651609  Vali macro F1 0.9511031 
new best score!!!!
Validation loss decreased (0.096506 --> 0.091738).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.0752854347229
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0710747  Vali Loss: 0.1326781 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9584905  Vali macro F1 0.9453015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.047115325927734
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0744546  Vali Loss: 0.0961208 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9676817  Vali macro F1 0.9574869 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.063544988632202
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0641470  Vali Loss: 0.1051441 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9645488  Vali macro F1 0.9514676 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.057218313217163
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0623868  Vali Loss: 0.1035167 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9700598  Vali macro F1 0.9621936 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.057591915130615
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0654031  Vali Loss: 0.0822409 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9680697  Vali macro F1 0.9538135 
new best score!!!!
Validation loss decreased (0.091738 --> 0.082241).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.062875986099243
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0590430  Vali Loss: 0.0844984 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9731781  Vali macro F1 0.9634386 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.0514140129089355
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0575084  Vali Loss: 0.0805377 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747662  Vali macro F1 0.9677404 
new best score!!!!
Validation loss decreased (0.082241 --> 0.080538).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.058874130249023
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0584102  Vali Loss: 0.0801554 Vali Accuracy: 0.9742533  Vali weighted F1: 0.9740748  Vali macro F1 0.9666641 
new best score!!!!
Validation loss decreased (0.080538 --> 0.080155).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.068256378173828
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0537200  Vali Loss: 0.0904490 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9693354  Vali macro F1 0.9593910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.070818185806274
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0558826  Vali Loss: 0.0746266 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9769835  Vali macro F1 0.9689353 
new best score!!!!
Validation loss decreased (0.080155 --> 0.074627).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.0531322956085205
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0466007  Vali Loss: 0.0764151 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9758413  Vali macro F1 0.9682327 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.059493780136108
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0537611  Vali Loss: 0.0744914 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9758322  Vali macro F1 0.9682275 
new best score!!!!
Validation loss decreased (0.074627 --> 0.074491).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.058853626251221
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0458752  Vali Loss: 0.1195064 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9634144  Vali macro F1 0.9541733 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.047288656234741
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0597974  Vali Loss: 0.0887858 Vali Accuracy: 0.9691040  Vali weighted F1: 0.9687783  Vali macro F1 0.9607601 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.042555570602417
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0427619  Vali Loss: 0.0768389 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9721454  Vali macro F1 0.9638593 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.061153173446655
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0459242  Vali Loss: 0.0761769 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724908  Vali macro F1 0.9637342 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.0497400760650635
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0513868  Vali Loss: 0.0719267 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9759129  Vali macro F1 0.9690899 
new best score!!!!
Validation loss decreased (0.074491 --> 0.071927).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.085286617279053
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0404428  Vali Loss: 0.0804925 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9748682  Vali macro F1 0.9645485 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.056223630905151
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0362461  Vali Loss: 0.0761900 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9730969  Vali macro F1 0.9661519 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.056187152862549
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0342301  Vali Loss: 0.0875213 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9759996  Vali macro F1 0.9698799 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.056811809539795
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0359636  Vali Loss: 0.0704112 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9785031  Vali macro F1 0.9721243 
new best score!!!!
Validation loss decreased (0.071927 --> 0.070411).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.054404020309448
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0353375  Vali Loss: 0.0640347 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825959  Vali macro F1 0.9764742 
new best score!!!!
Validation loss decreased (0.070411 --> 0.064035).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.048149347305298
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0305868  Vali Loss: 0.0759856 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9752090  Vali macro F1 0.9682582 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.058255910873413
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0315935  Vali Loss: 0.0689245 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9752609  Vali macro F1 0.9659752 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.064001560211182
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0288939  Vali Loss: 0.0796894 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753894  Vali macro F1 0.9669300 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.07749080657959
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0336769  Vali Loss: 0.0696081 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799147  Vali macro F1 0.9736617 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.080065727233887
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0332910  Vali Loss: 0.0846596 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9763119  Vali macro F1 0.9690004 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 53 cost time: 6.037356376647949
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0225755  Vali Loss: 0.0664992 Vali Accuracy: 0.9788877  Vali weighted F1: 0.9789162  Vali macro F1 0.9725536 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.053484201431274
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0193884  Vali Loss: 0.0622601 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815535  Vali macro F1 0.9762046 
new best score!!!!
Validation loss decreased (0.064035 --> 0.062260).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 6.067056179046631
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0190409  Vali Loss: 0.0625832 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820778  Vali macro F1 0.9767359 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.053133010864258
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0179598  Vali Loss: 0.0634980 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815535  Vali macro F1 0.9762046 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.053042888641357
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0170804  Vali Loss: 0.0641792 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9805164  Vali macro F1 0.9732968 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.058861494064331
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0174595  Vali Loss: 0.0649526 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810803  Vali macro F1 0.9755931 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.062824487686157
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0180965  Vali Loss: 0.0657404 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9826194  Vali macro F1 0.9769554 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 6.077263593673706
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0162394  Vali Loss: 0.0664376 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9826194  Vali macro F1 0.9769554 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 6.049921989440918
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0169250  Vali Loss: 0.0655321 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9826229  Vali macro F1 0.9770495 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 6.045576572418213
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0160086  Vali Loss: 0.0656858 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9821225  Vali macro F1 0.9764668 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 6.043144702911377
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0169760  Vali Loss: 0.0663725 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9816045  Vali macro F1 0.9762152 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 6.057816743850708
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0182579  Vali Loss: 0.0659017 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9821086  Vali macro F1 0.9760703 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 65 cost time: 6.049494743347168
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0166704  Vali Loss: 0.0659493 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9821086  Vali macro F1 0.9760703 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 6.069884538650513
VALI: Epoch: 66, Steps: 69 | Train Loss: 0.0165346  Vali Loss: 0.0657220 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9821086  Vali macro F1 0.9760703 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 6.055875539779663
VALI: Epoch: 67, Steps: 69 | Train Loss: 0.0165506  Vali Loss: 0.0657219 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9821086  Vali macro F1 0.9760703 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 6.070186614990234
VALI: Epoch: 68, Steps: 69 | Train Loss: 0.0156533  Vali Loss: 0.0657400 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9821086  Vali macro F1 0.9760703 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 6.088180065155029
VALI: Epoch: 69, Steps: 69 | Train Loss: 0.0150193  Vali Loss: 0.0656884 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9821086  Vali macro F1 0.9760703 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9620757  Test weighted F1: 0.9612164  Test macro F1 0.9462564 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.063222885131836
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0184220  Vali Loss: 0.0680292 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9793863  Vali macro F1 0.9731258 
Validation loss decreased (inf --> 0.068029).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.045064449310303
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0187886  Vali Loss: 0.0680832 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9800234  Vali macro F1 0.9735179 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.038649082183838
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0185097  Vali Loss: 0.0670461 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9831067  Vali macro F1 0.9781297 
new best score!!!!
Validation loss decreased (0.068029 --> 0.067046).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.033179044723511
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0174211  Vali Loss: 0.0640937 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810409  Vali macro F1 0.9750698 
new best score!!!!
Validation loss decreased (0.067046 --> 0.064094).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.050621747970581
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0168932  Vali Loss: 0.0662079 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815218  Vali macro F1 0.9760140 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.0505030155181885
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0180950  Vali Loss: 0.0630422 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835881  Vali macro F1 0.9767843 
new best score!!!!
Validation loss decreased (0.064094 --> 0.063042).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.0625317096710205
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0174643  Vali Loss: 0.0655724 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9831198  Vali macro F1 0.9775381 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.067633152008057
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0159968  Vali Loss: 0.0738147 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794928  Vali macro F1 0.9719123 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.062333345413208
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0166635  Vali Loss: 0.0704011 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815382  Vali macro F1 0.9746656 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.047520160675049
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0141605  Vali Loss: 0.0664614 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825740  Vali macro F1 0.9760335 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.060525417327881
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0158725  Vali Loss: 0.0633897 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9836280  Vali macro F1 0.9783532 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.055585861206055
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0153536  Vali Loss: 0.0611319 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825756  Vali macro F1 0.9760339 
new best score!!!!
Validation loss decreased (0.063042 --> 0.061132).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.054345607757568
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0146019  Vali Loss: 0.0687780 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804408  Vali macro F1 0.9737274 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.0472846031188965
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0146662  Vali Loss: 0.0650200 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9841251  Vali macro F1 0.9788420 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.048750162124634
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0153847  Vali Loss: 0.0655721 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9836015  Vali macro F1 0.9781880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.073478937149048
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0144759  Vali Loss: 0.0702118 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810158  Vali macro F1 0.9738425 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.06779146194458
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0138872  Vali Loss: 0.0672784 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810467  Vali macro F1 0.9740326 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.053049802780151
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0131705  Vali Loss: 0.0656499 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9836248  Vali macro F1 0.9779721 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.0505406856536865
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0125665  Vali Loss: 0.0660135 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830844  Vali macro F1 0.9768677 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.04695200920105
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0127416  Vali Loss: 0.0644562 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830844  Vali macro F1 0.9768677 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.054954528808594
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0123354  Vali Loss: 0.0655012 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830971  Vali macro F1 0.9772960 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.052881240844727
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0132346  Vali Loss: 0.0646512 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9831235  Vali macro F1 0.9775101 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.064416408538818
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0123917  Vali Loss: 0.0649148 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825958  Vali macro F1 0.9768340 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.072258234024048
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0137455  Vali Loss: 0.0651550 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825958  Vali macro F1 0.9768340 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.086262941360474
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0128704  Vali Loss: 0.0653765 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825958  Vali macro F1 0.9768340 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.064435958862305
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0134351  Vali Loss: 0.0655734 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825834  Vali macro F1 0.9764059 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.060663461685181
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0124613  Vali Loss: 0.0657330 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825834  Vali macro F1 0.9764059 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9613448  Test weighted F1: 0.9605967  Test macro F1 0.9451154 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014959 0.00018678 0.00138313 0.00145985 0.00052882 0.00064809]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.847173690795898
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.2400291  Vali Loss: 0.7760466 Vali Accuracy: 0.6908316  Vali weighted F1: 0.5891158  Vali macro F1 0.2915576 
Validation loss decreased (inf --> 0.776047).  Saving model ...
Epoch: 2 cost time: 5.84604811668396
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.6408586  Vali Loss: 0.5389872 Vali Accuracy: 0.7787846  Vali weighted F1: 0.7298552  Vali macro F1 0.5127638 
new best score!!!!
Validation loss decreased (0.776047 --> 0.538987).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.849026203155518
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.4699105  Vali Loss: 0.3970826 Vali Accuracy: 0.8608742  Vali weighted F1: 0.8415837  Vali macro F1 0.7935175 
new best score!!!!
Validation loss decreased (0.538987 --> 0.397083).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.85579776763916
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.3595539  Vali Loss: 0.3517422 Vali Accuracy: 0.8880597  Vali weighted F1: 0.8796378  Vali macro F1 0.8535205 
new best score!!!!
Validation loss decreased (0.397083 --> 0.351742).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.878549575805664
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2974428  Vali Loss: 0.2938558 Vali Accuracy: 0.8965885  Vali weighted F1: 0.8946815  Vali macro F1 0.8637337 
new best score!!!!
Validation loss decreased (0.351742 --> 0.293856).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.8808348178863525
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.2677483  Vali Loss: 0.2853887 Vali Accuracy: 0.9099147  Vali weighted F1: 0.9058977  Vali macro F1 0.8857700 
new best score!!!!
Validation loss decreased (0.293856 --> 0.285389).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.854146718978882
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.2281859  Vali Loss: 0.2249314 Vali Accuracy: 0.9280384  Vali weighted F1: 0.9271309  Vali macro F1 0.9112375 
new best score!!!!
Validation loss decreased (0.285389 --> 0.224931).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.849833965301514
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1919973  Vali Loss: 0.1879766 Vali Accuracy: 0.9418977  Vali weighted F1: 0.9419088  Vali macro F1 0.9249411 
new best score!!!!
Validation loss decreased (0.224931 --> 0.187977).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.849964618682861
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1684266  Vali Loss: 0.1889005 Vali Accuracy: 0.9376333  Vali weighted F1: 0.9372784  Vali macro F1 0.9177504 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.8509862422943115
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1546603  Vali Loss: 0.1657315 Vali Accuracy: 0.9445629  Vali weighted F1: 0.9437208  Vali macro F1 0.9282693 
new best score!!!!
Validation loss decreased (0.187977 --> 0.165731).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.8590545654296875
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1532117  Vali Loss: 0.1756981 Vali Accuracy: 0.9392324  Vali weighted F1: 0.9391347  Vali macro F1 0.9145785 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.857672929763794
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1326032  Vali Loss: 0.1481034 Vali Accuracy: 0.9552239  Vali weighted F1: 0.9545644  Vali macro F1 0.9472317 
new best score!!!!
Validation loss decreased (0.165731 --> 0.148103).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.8531763553619385
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1234063  Vali Loss: 0.1383322 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9589051  Vali macro F1 0.9488616 
new best score!!!!
Validation loss decreased (0.148103 --> 0.138332).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.875176191329956
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1173579  Vali Loss: 0.1119329 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9668621  Vali macro F1 0.9593238 
new best score!!!!
Validation loss decreased (0.138332 --> 0.111933).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.883417367935181
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1137978  Vali Loss: 0.1152689 Vali Accuracy: 0.9626866  Vali weighted F1: 0.9623757  Vali macro F1 0.9562461 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.856859445571899
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.1122188  Vali Loss: 0.1692864 Vali Accuracy: 0.9456290  Vali weighted F1: 0.9438878  Vali macro F1 0.9293327 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.865339756011963
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.1023684  Vali Loss: 0.1118569 Vali Accuracy: 0.9685501  Vali weighted F1: 0.9681576  Vali macro F1 0.9606058 
new best score!!!!
Validation loss decreased (0.111933 --> 0.111857).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.866722583770752
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0969239  Vali Loss: 0.1046797 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9673624  Vali macro F1 0.9539099 
new best score!!!!
Validation loss decreased (0.111857 --> 0.104680).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.870119094848633
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0901615  Vali Loss: 0.1100536 Vali Accuracy: 0.9632196  Vali weighted F1: 0.9631173  Vali macro F1 0.9518971 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.860999345779419
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0867769  Vali Loss: 0.1157238 Vali Accuracy: 0.9621535  Vali weighted F1: 0.9622838  Vali macro F1 0.9501786 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.856523513793945
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0882971  Vali Loss: 0.0810021 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9758208  Vali macro F1 0.9722295 
new best score!!!!
Validation loss decreased (0.104680 --> 0.081002).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.8741490840911865
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0750935  Vali Loss: 0.0976953 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9724569  Vali macro F1 0.9669598 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.879945278167725
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0737214  Vali Loss: 0.0903257 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9720819  Vali macro F1 0.9615293 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.8984081745147705
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0687033  Vali Loss: 0.0879099 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9727640  Vali macro F1 0.9641947 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.867312908172607
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0629538  Vali Loss: 0.0795844 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9757999  Vali macro F1 0.9706992 
new best score!!!!
Validation loss decreased (0.081002 --> 0.079584).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.856253147125244
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0601410  Vali Loss: 0.1551444 Vali Accuracy: 0.9589552  Vali weighted F1: 0.9572273  Vali macro F1 0.9521665 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.849881887435913
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0669345  Vali Loss: 0.0765533 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9766770  Vali macro F1 0.9717004 
new best score!!!!
Validation loss decreased (0.079584 --> 0.076553).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.8529932498931885
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0566174  Vali Loss: 0.1158426 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9665672  Vali macro F1 0.9592662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.844027996063232
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0552907  Vali Loss: 0.0664921 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781794  Vali macro F1 0.9738869 
new best score!!!!
Validation loss decreased (0.076553 --> 0.066492).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.855759859085083
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0623934  Vali Loss: 0.0702943 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9770290  Vali macro F1 0.9686076 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.853410005569458
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0538706  Vali Loss: 0.0741203 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9775077  Vali macro F1 0.9733810 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.855433225631714
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0546315  Vali Loss: 0.0849597 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9707854  Vali macro F1 0.9637305 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.860122919082642
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0468396  Vali Loss: 0.0693822 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9775367  Vali macro F1 0.9731006 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 5.850714206695557
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0408044  Vali Loss: 0.0853064 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9789482  Vali macro F1 0.9751841 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 5.97480845451355
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0359755  Vali Loss: 0.0619085 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801718  Vali macro F1 0.9762967 
new best score!!!!
Validation loss decreased (0.066492 --> 0.061908).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.858747720718384
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0307409  Vali Loss: 0.0623421 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9795664  Vali macro F1 0.9754519 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 7.189298391342163
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0305870  Vali Loss: 0.0618473 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9790736  Vali macro F1 0.9749502 
new best score!!!!
Validation loss decreased (0.061908 --> 0.061847).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.778258562088013
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0295235  Vali Loss: 0.0608070 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812798  Vali macro F1 0.9771447 
new best score!!!!
Validation loss decreased (0.061847 --> 0.060807).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.890320062637329
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0286045  Vali Loss: 0.0606852 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812890  Vali macro F1 0.9770962 
new best score!!!!
Validation loss decreased (0.060807 --> 0.060685).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.8679869174957275
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0308852  Vali Loss: 0.0600267 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812492  Vali macro F1 0.9770698 
new best score!!!!
Validation loss decreased (0.060685 --> 0.060027).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.859755754470825
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0290754  Vali Loss: 0.0596644 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807375  Vali macro F1 0.9766030 
new best score!!!!
Validation loss decreased (0.060027 --> 0.059664).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.882331371307373
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0288216  Vali Loss: 0.0599094 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796639  Vali macro F1 0.9735666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.904268264770508
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0284708  Vali Loss: 0.0586572 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818628  Vali macro F1 0.9760435 
new best score!!!!
Validation loss decreased (0.059664 --> 0.058657).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.877041339874268
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0287874  Vali Loss: 0.0573271 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813010  Vali macro F1 0.9770947 
new best score!!!!
Validation loss decreased (0.058657 --> 0.057327).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.884220123291016
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0286702  Vali Loss: 0.0591292 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812890  Vali macro F1 0.9770962 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.873950242996216
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0284247  Vali Loss: 0.0570766 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812798  Vali macro F1 0.9771447 
new best score!!!!
Validation loss decreased (0.057327 --> 0.057077).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.878415584564209
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0280709  Vali Loss: 0.0565358 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801970  Vali macro F1 0.9757597 
new best score!!!!
Validation loss decreased (0.057077 --> 0.056536).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 5.866262197494507
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0275982  Vali Loss: 0.0588408 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807269  Vali macro F1 0.9769008 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.851452827453613
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0269926  Vali Loss: 0.0581387 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796610  Vali macro F1 0.9751643 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.871367692947388
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0270845  Vali Loss: 0.0578404 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829325  Vali macro F1 0.9790496 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.871760606765747
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0268199  Vali Loss: 0.0621329 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807133  Vali macro F1 0.9771933 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 5.888434171676636
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0281075  Vali Loss: 0.0603517 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813456  Vali macro F1 0.9754879 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 5.8730950355529785
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0253169  Vali Loss: 0.0587459 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818568  Vali macro F1 0.9760439 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 5.872488021850586
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0259088  Vali Loss: 0.0589162 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813262  Vali macro F1 0.9752055 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 5.865948438644409
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0246375  Vali Loss: 0.0584649 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818568  Vali macro F1 0.9760439 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 5.870208501815796
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0250958  Vali Loss: 0.0582668 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813262  Vali macro F1 0.9752055 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 5.852439641952515
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0248650  Vali Loss: 0.0582378 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818628  Vali macro F1 0.9760435 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 5.857523202896118
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0236327  Vali Loss: 0.0582853 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813262  Vali macro F1 0.9752055 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 5.870840549468994
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0247883  Vali Loss: 0.0583450 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818628  Vali macro F1 0.9760435 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 5.887806177139282
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0256048  Vali Loss: 0.0584024 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813262  Vali macro F1 0.9752055 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 5.8781139850616455
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0253164  Vali Loss: 0.0583648 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813262  Vali macro F1 0.9752055 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 5.901869058609009
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0250081  Vali Loss: 0.0583058 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818628  Vali macro F1 0.9760435 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8930814  Test weighted F1: 0.8969847  Test macro F1 0.8597576 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.888671159744263
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0287894  Vali Loss: 0.0603115 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797221  Vali macro F1 0.9746300 
Validation loss decreased (inf --> 0.060312).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.861490726470947
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0270149  Vali Loss: 0.0568452 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818909  Vali macro F1 0.9774466 
new best score!!!!
Validation loss decreased (0.060312 --> 0.056845).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.862523555755615
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0246797  Vali Loss: 0.0615512 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823890  Vali macro F1 0.9768303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.856046915054321
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0274037  Vali Loss: 0.0604821 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818382  Vali macro F1 0.9765834 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.876192808151245
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0268441  Vali Loss: 0.0604659 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807561  Vali macro F1 0.9749562 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 5.874156475067139
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0249119  Vali Loss: 0.0604108 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807575  Vali macro F1 0.9762565 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 5.884734392166138
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0256564  Vali Loss: 0.0600621 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818178  Vali macro F1 0.9765793 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 5.891267776489258
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0253128  Vali Loss: 0.0566256 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823852  Vali macro F1 0.9785360 
new best score!!!!
Validation loss decreased (0.056845 --> 0.056626).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 5.886683940887451
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0242038  Vali Loss: 0.0584165 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823695  Vali macro F1 0.9790804 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 5.860980272293091
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0249205  Vali Loss: 0.0578716 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829493  Vali macro F1 0.9793549 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 5.86875581741333
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0248752  Vali Loss: 0.0542642 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818593  Vali macro F1 0.9773730 
new best score!!!!
Validation loss decreased (0.056626 --> 0.054264).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 5.882710218429565
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0230478  Vali Loss: 0.0566673 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829186  Vali macro F1 0.9793159 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 5.89132833480835
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0242611  Vali Loss: 0.0574618 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840037  Vali macro F1 0.9806875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 5.8864521980285645
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0244237  Vali Loss: 0.0568218 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818532  Vali macro F1 0.9773992 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 5.87324070930481
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0240512  Vali Loss: 0.0633916 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818994  Vali macro F1 0.9777328 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 5.866702556610107
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0243072  Vali Loss: 0.0579387 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818370  Vali macro F1 0.9763381 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 5.871938705444336
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0228249  Vali Loss: 0.0572269 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823935  Vali macro F1 0.9768822 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 5.870970726013184
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0210868  Vali Loss: 0.0575525 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812939  Vali macro F1 0.9757428 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.992167711257935
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0208099  Vali Loss: 0.0565877 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829303  Vali macro F1 0.9777210 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 5.877193450927734
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0222651  Vali Loss: 0.0564770 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813069  Vali macro F1 0.9755008 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 5.868635177612305
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0211523  Vali Loss: 0.0575222 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807623  Vali macro F1 0.9749029 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 5.85722804069519
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0217584  Vali Loss: 0.0575765 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807623  Vali macro F1 0.9749029 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 5.866786003112793
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0199346  Vali Loss: 0.0575175 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807623  Vali macro F1 0.9749029 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 5.858739614486694
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0213494  Vali Loss: 0.0575203 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807623  Vali macro F1 0.9749029 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 5.8682873249053955
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0213968  Vali Loss: 0.0575403 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807623  Vali macro F1 0.9749029 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 5.891520738601685
Fine Tuning VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0212736  Vali Loss: 0.0574292 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807623  Vali macro F1 0.9749029 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8923767  Test weighted F1: 0.8971161  Test macro F1 0.8595147 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001419  0.00018467 0.00096712 0.00125    0.0005291  0.00064599]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.224347829818726
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2206829  Vali Loss: 0.7289348 Vali Accuracy: 0.7610350  Vali weighted F1: 0.7050099  Vali macro F1 0.5237301 
Validation loss decreased (inf --> 0.728935).  Saving model ...
Epoch: 2 cost time: 6.182597875595093
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5931867  Vali Loss: 0.4325936 Vali Accuracy: 0.8493151  Vali weighted F1: 0.8312873  Vali macro F1 0.7808203 
new best score!!!!
Validation loss decreased (0.728935 --> 0.432594).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.176949501037598
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4112176  Vali Loss: 0.3151824 Vali Accuracy: 0.8934551  Vali weighted F1: 0.8882697  Vali macro F1 0.8547733 
new best score!!!!
Validation loss decreased (0.432594 --> 0.315182).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.165003538131714
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3200639  Vali Loss: 0.2342277 Vali Accuracy: 0.9249112  Vali weighted F1: 0.9238111  Vali macro F1 0.8927927 
new best score!!!!
Validation loss decreased (0.315182 --> 0.234228).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.167207479476929
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2458746  Vali Loss: 0.1834882 Vali Accuracy: 0.9426687  Vali weighted F1: 0.9420255  Vali macro F1 0.9152189 
new best score!!!!
Validation loss decreased (0.234228 --> 0.183488).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.166679382324219
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2081576  Vali Loss: 0.1770589 Vali Accuracy: 0.9396246  Vali weighted F1: 0.9383210  Vali macro F1 0.9097962 
new best score!!!!
Validation loss decreased (0.183488 --> 0.177059).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.165897846221924
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1917211  Vali Loss: 0.1714595 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9404153  Vali macro F1 0.9140890 
new best score!!!!
Validation loss decreased (0.177059 --> 0.171460).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.187252759933472
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1674741  Vali Loss: 0.1725740 Vali Accuracy: 0.9396246  Vali weighted F1: 0.9383706  Vali macro F1 0.9067482 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.188807725906372
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1552311  Vali Loss: 0.1473478 Vali Accuracy: 0.9487570  Vali weighted F1: 0.9492009  Vali macro F1 0.9236436 
new best score!!!!
Validation loss decreased (0.171460 --> 0.147348).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.176249265670776
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1452251  Vali Loss: 0.1512897 Vali Accuracy: 0.9477423  Vali weighted F1: 0.9468824  Vali macro F1 0.9194655 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.170308828353882
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1364984  Vali Loss: 0.1334615 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9528359  Vali macro F1 0.9279970 
new best score!!!!
Validation loss decreased (0.147348 --> 0.133462).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.17832612991333
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1304640  Vali Loss: 0.1335566 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9504142  Vali macro F1 0.9234048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.17345118522644
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1267358  Vali Loss: 0.1260304 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9562906  Vali macro F1 0.9388251 
new best score!!!!
Validation loss decreased (0.133462 --> 0.126030).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.170087575912476
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1144095  Vali Loss: 0.1112403 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9630571  Vali macro F1 0.9475077 
new best score!!!!
Validation loss decreased (0.126030 --> 0.111240).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.168043375015259
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1135367  Vali Loss: 0.1148409 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9623010  Vali macro F1 0.9421576 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.172133445739746
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1002223  Vali Loss: 0.1163474 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9612788  Vali macro F1 0.9431206 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.180115461349487
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1104941  Vali Loss: 0.1075658 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9635857  Vali macro F1 0.9487292 
new best score!!!!
Validation loss decreased (0.111240 --> 0.107566).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.189197540283203
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0975686  Vali Loss: 0.1146689 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9654039  Vali macro F1 0.9516460 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.167330741882324
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0916198  Vali Loss: 0.1237530 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9565486  Vali macro F1 0.9385838 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.170674562454224
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0908265  Vali Loss: 0.0977274 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9691206  Vali macro F1 0.9563576 
new best score!!!!
Validation loss decreased (0.107566 --> 0.097727).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.163661003112793
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0799269  Vali Loss: 0.0895422 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9679653  Vali macro F1 0.9550981 
new best score!!!!
Validation loss decreased (0.097727 --> 0.089542).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.174372673034668
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0752501  Vali Loss: 0.1265757 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9629451  Vali macro F1 0.9496480 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.167170524597168
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0741887  Vali Loss: 0.1091747 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9598840  Vali macro F1 0.9404852 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.166871070861816
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0737179  Vali Loss: 0.0947270 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9667908  Vali macro F1 0.9546897 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.170386075973511
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0719131  Vali Loss: 0.0988488 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9646298  Vali macro F1 0.9522521 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.178164958953857
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0681579  Vali Loss: 0.0767862 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9740216  Vali macro F1 0.9641782 
new best score!!!!
Validation loss decreased (0.089542 --> 0.076786).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.199020862579346
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0583780  Vali Loss: 0.0860402 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9740930  Vali macro F1 0.9646770 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.182255506515503
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0618170  Vali Loss: 0.0796003 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9680829  Vali macro F1 0.9556372 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.16660737991333
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0570723  Vali Loss: 0.0886348 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9740494  Vali macro F1 0.9657368 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.169666290283203
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0584204  Vali Loss: 0.1071275 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9654638  Vali macro F1 0.9559467 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.1714372634887695
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0517213  Vali Loss: 0.0935859 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9758471  Vali macro F1 0.9668699 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.173198223114014
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0429982  Vali Loss: 0.0767200 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775577  Vali macro F1 0.9678973 
new best score!!!!
Validation loss decreased (0.076786 --> 0.076720).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.164135932922363
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0381972  Vali Loss: 0.0754053 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9770073  Vali macro F1 0.9682372 
new best score!!!!
Validation loss decreased (0.076720 --> 0.075405).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.164931058883667
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0373872  Vali Loss: 0.0770038 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775476  Vali macro F1 0.9685420 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.179444313049316
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0354954  Vali Loss: 0.0751051 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9750014  Vali macro F1 0.9652108 
new best score!!!!
Validation loss decreased (0.075405 --> 0.075105).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.181967496871948
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0370348  Vali Loss: 0.0744400 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9770683  Vali macro F1 0.9685990 
new best score!!!!
Validation loss decreased (0.075105 --> 0.074440).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.164653301239014
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0350027  Vali Loss: 0.0766852 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775546  Vali macro F1 0.9685517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.172291040420532
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0348499  Vali Loss: 0.0753990 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785767  Vali macro F1 0.9696466 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.165975332260132
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0353456  Vali Loss: 0.0752251 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775697  Vali macro F1 0.9685576 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.166353940963745
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0345050  Vali Loss: 0.0776197 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780306  Vali macro F1 0.9693167 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.178573131561279
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0324140  Vali Loss: 0.0734842 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9770793  Vali macro F1 0.9674589 
new best score!!!!
Validation loss decreased (0.074440 --> 0.073484).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.1658241748809814
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0346337  Vali Loss: 0.0775771 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9765381  Vali macro F1 0.9671362 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.1756272315979
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0359753  Vali Loss: 0.0776550 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780409  Vali macro F1 0.9693312 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.188469409942627
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0346295  Vali Loss: 0.0796599 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9770107  Vali macro F1 0.9679277 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.182068586349487
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0349187  Vali Loss: 0.0790735 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9759565  Vali macro F1 0.9667889 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.177853107452393
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0329963  Vali Loss: 0.0764125 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775986  Vali macro F1 0.9682803 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.159829139709473
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0310299  Vali Loss: 0.0753786 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775919  Vali macro F1 0.9682719 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.167635440826416
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0312967  Vali Loss: 0.0757437 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785855  Vali macro F1 0.9696429 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.174599885940552
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0321298  Vali Loss: 0.0752232 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775521  Vali macro F1 0.9688292 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.167235851287842
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0313985  Vali Loss: 0.0758917 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780990  Vali macro F1 0.9685169 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.160014390945435
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0301201  Vali Loss: 0.0752077 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785869  Vali macro F1 0.9696269 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 6.167634010314941
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0310290  Vali Loss: 0.0752787 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785869  Vali macro F1 0.9696269 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.180481910705566
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0323980  Vali Loss: 0.0753546 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785869  Vali macro F1 0.9696269 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.17138409614563
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0302943  Vali Loss: 0.0752640 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780586  Vali macro F1 0.9690739 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.168413162231445
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0314155  Vali Loss: 0.0753211 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780586  Vali macro F1 0.9690739 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.1598286628723145
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0302391  Vali Loss: 0.0753804 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780586  Vali macro F1 0.9690739 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9288472  Test weighted F1: 0.9277589  Test macro F1 0.9253359 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.223393201828003
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0336615  Vali Loss: 0.0719092 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781220  Vali macro F1 0.9692086 
Validation loss decreased (inf --> 0.071909).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.16929292678833
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0340157  Vali Loss: 0.0758927 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9795917  Vali macro F1 0.9713258 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.168700456619263
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0318020  Vali Loss: 0.0797304 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9765345  Vali macro F1 0.9674587 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.181665420532227
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0336236  Vali Loss: 0.0744745 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775156  Vali macro F1 0.9688092 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.1869237422943115
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0324314  Vali Loss: 0.0761793 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775357  Vali macro F1 0.9685091 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.203722238540649
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0319735  Vali Loss: 0.0748958 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776244  Vali macro F1 0.9683437 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.1764795780181885
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0322021  Vali Loss: 0.0737333 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9769993  Vali macro F1 0.9679576 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.174504280090332
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0309423  Vali Loss: 0.0741875 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785844  Vali macro F1 0.9696366 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.176305294036865
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0306494  Vali Loss: 0.0775957 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780758  Vali macro F1 0.9682077 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.179434537887573
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0326983  Vali Loss: 0.0749483 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780627  Vali macro F1 0.9691119 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.173529863357544
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0286851  Vali Loss: 0.0753521 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785716  Vali macro F1 0.9699537 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.172236442565918
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0308228  Vali Loss: 0.0744936 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9790970  Vali macro F1 0.9699279 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.1810290813446045
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0309079  Vali Loss: 0.0748335 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9790778  Vali macro F1 0.9701983 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.196498870849609
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0285774  Vali Loss: 0.0738588 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786091  Vali macro F1 0.9693934 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.199796438217163
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0292566  Vali Loss: 0.0743877 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780551  Vali macro F1 0.9691019 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.190037488937378
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0275922  Vali Loss: 0.0744905 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780551  Vali macro F1 0.9691019 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9309616  Test weighted F1: 0.9296717  Test macro F1 0.9252786 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014207 0.00017835 0.00097371 0.0011976  0.0004817  0.0006035 ]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.358248949050903
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.2083617  Vali Loss: 0.7224635 Vali Accuracy: 0.7079428  Vali weighted F1: 0.6434922  Vali macro F1 0.3692766 
Validation loss decreased (inf --> 0.722464).  Saving model ...
Epoch: 2 cost time: 6.3297765254974365
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.5783745  Vali Loss: 0.4400653 Vali Accuracy: 0.8490380  Vali weighted F1: 0.8257554  Vali macro F1 0.7721923 
new best score!!!!
Validation loss decreased (0.722464 --> 0.440065).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.3182806968688965
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3914889  Vali Loss: 0.3471676 Vali Accuracy: 0.8776517  Vali weighted F1: 0.8720072  Vali macro F1 0.8372180 
new best score!!!!
Validation loss decreased (0.440065 --> 0.347168).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.317799091339111
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.3274935  Vali Loss: 0.2641463 Vali Accuracy: 0.9057721  Vali weighted F1: 0.9010472  Vali macro F1 0.8693182 
new best score!!!!
Validation loss decreased (0.347168 --> 0.264146).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.346763372421265
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2744143  Vali Loss: 0.2578944 Vali Accuracy: 0.9121855  Vali weighted F1: 0.9087533  Vali macro F1 0.8835685 
new best score!!!!
Validation loss decreased (0.264146 --> 0.257894).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.357834339141846
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.2284226  Vali Loss: 0.1860527 Vali Accuracy: 0.9388259  Vali weighted F1: 0.9386992  Vali macro F1 0.9162514 
new best score!!!!
Validation loss decreased (0.257894 --> 0.186053).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.356191635131836
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1900553  Vali Loss: 0.1628190 Vali Accuracy: 0.9422792  Vali weighted F1: 0.9407970  Vali macro F1 0.9191789 
new best score!!!!
Validation loss decreased (0.186053 --> 0.162819).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.343783617019653
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1692788  Vali Loss: 0.1477807 Vali Accuracy: 0.9467193  Vali weighted F1: 0.9456341  Vali macro F1 0.9215525 
new best score!!!!
Validation loss decreased (0.162819 --> 0.147781).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.338197708129883
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1588873  Vali Loss: 0.1301118 Vali Accuracy: 0.9555994  Vali weighted F1: 0.9551976  Vali macro F1 0.9347674 
new best score!!!!
Validation loss decreased (0.147781 --> 0.130112).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.341274976730347
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1506290  Vali Loss: 0.1399535 Vali Accuracy: 0.9536260  Vali weighted F1: 0.9539380  Vali macro F1 0.9348384 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.346240997314453
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1337546  Vali Loss: 0.1117161 Vali Accuracy: 0.9585594  Vali weighted F1: 0.9583811  Vali macro F1 0.9390619 
new best score!!!!
Validation loss decreased (0.130112 --> 0.111716).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.322744607925415
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1218348  Vali Loss: 0.1343522 Vali Accuracy: 0.9501727  Vali weighted F1: 0.9490878  Vali macro F1 0.9287701 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.334841251373291
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.1369698  Vali Loss: 0.1189254 Vali Accuracy: 0.9560927  Vali weighted F1: 0.9554613  Vali macro F1 0.9338636 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.332953214645386
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.1195763  Vali Loss: 0.1092533 Vali Accuracy: 0.9580661  Vali weighted F1: 0.9582723  Vali macro F1 0.9338024 
new best score!!!!
Validation loss decreased (0.111716 --> 0.109253).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.360567569732666
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.1057356  Vali Loss: 0.1075624 Vali Accuracy: 0.9625062  Vali weighted F1: 0.9621150  Vali macro F1 0.9470280 
new best score!!!!
Validation loss decreased (0.109253 --> 0.107562).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.345237970352173
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0967700  Vali Loss: 0.0931812 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9685292  Vali macro F1 0.9525919 
new best score!!!!
Validation loss decreased (0.107562 --> 0.093181).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.339156866073608
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0962190  Vali Loss: 0.1151020 Vali Accuracy: 0.9600395  Vali weighted F1: 0.9599325  Vali macro F1 0.9427866 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.337817430496216
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.1085232  Vali Loss: 0.0866191 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9679924  Vali macro F1 0.9513732 
new best score!!!!
Validation loss decreased (0.093181 --> 0.086619).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.345435619354248
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0926358  Vali Loss: 0.0862596 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9723968  Vali macro F1 0.9577391 
new best score!!!!
Validation loss decreased (0.086619 --> 0.086260).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.331135272979736
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0842041  Vali Loss: 0.0856052 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9693025  Vali macro F1 0.9546539 
new best score!!!!
Validation loss decreased (0.086260 --> 0.085605).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.343381643295288
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0792635  Vali Loss: 0.0856528 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9715193  Vali macro F1 0.9599394 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.3555521965026855
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0792713  Vali Loss: 0.0962586 Vali Accuracy: 0.9654662  Vali weighted F1: 0.9651146  Vali macro F1 0.9492210 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.356870889663696
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0698179  Vali Loss: 0.0823583 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9744180  Vali macro F1 0.9605884 
new best score!!!!
Validation loss decreased (0.085605 --> 0.082358).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.34510612487793
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0714522  Vali Loss: 0.0991379 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9678912  Vali macro F1 0.9536168 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.324326276779175
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0790720  Vali Loss: 0.0900352 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9698647  Vali macro F1 0.9578033 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.326207876205444
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0719709  Vali Loss: 0.0942104 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9643004  Vali macro F1 0.9504290 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.333683013916016
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0622853  Vali Loss: 0.0842024 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9685671  Vali macro F1 0.9551158 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.408351421356201
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0592771  Vali Loss: 0.0785026 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9714349  Vali macro F1 0.9569246 
new best score!!!!
Validation loss decreased (0.082358 --> 0.078503).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.339291572570801
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0597022  Vali Loss: 0.0738861 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9750082  Vali macro F1 0.9614023 
new best score!!!!
Validation loss decreased (0.078503 --> 0.073886).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.340029954910278
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0579433  Vali Loss: 0.0917911 Vali Accuracy: 0.9713863  Vali weighted F1: 0.9712064  Vali macro F1 0.9566396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.353376150131226
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0593568  Vali Loss: 0.0720225 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9728179  Vali macro F1 0.9616376 
new best score!!!!
Validation loss decreased (0.073886 --> 0.072022).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.366886377334595
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0508783  Vali Loss: 0.0826008 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9702753  Vali macro F1 0.9582222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.333400011062622
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0498031  Vali Loss: 0.0793419 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9768627  Vali macro F1 0.9680670 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.34215521812439
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0515895  Vali Loss: 0.0750166 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9758787  Vali macro F1 0.9654805 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.338902235031128
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0544074  Vali Loss: 0.0765082 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9764488  Vali macro F1 0.9658067 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.340050220489502
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0468014  Vali Loss: 0.0690815 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9773839  Vali macro F1 0.9681799 
new best score!!!!
Validation loss decreased (0.072022 --> 0.069082).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.343143939971924
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0464415  Vali Loss: 0.0728831 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9773458  Vali macro F1 0.9682227 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.342933654785156
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0462372  Vali Loss: 0.0771587 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9722533  Vali macro F1 0.9630598 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.34322714805603
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0437867  Vali Loss: 0.0866714 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9693598  Vali macro F1 0.9583028 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.364661455154419
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0397386  Vali Loss: 0.0662326 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9773787  Vali macro F1 0.9672992 
new best score!!!!
Validation loss decreased (0.069082 --> 0.066233).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.335862874984741
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0377271  Vali Loss: 0.0703171 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777775  Vali macro F1 0.9672791 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.33728289604187
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0360003  Vali Loss: 0.0752784 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802924  Vali macro F1 0.9712116 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.342145919799805
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0404687  Vali Loss: 0.0651587 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9791234  Vali macro F1 0.9711660 
new best score!!!!
Validation loss decreased (0.066233 --> 0.065159).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.349241733551025
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0336137  Vali Loss: 0.0717960 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803774  Vali macro F1 0.9718277 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.329023122787476
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0355968  Vali Loss: 0.0720346 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9779051  Vali macro F1 0.9678767 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.330193281173706
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0355332  Vali Loss: 0.0845442 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9734285  Vali macro F1 0.9626394 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.343882322311401
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0348963  Vali Loss: 0.0797515 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808983  Vali macro F1 0.9726399 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.356610536575317
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0348112  Vali Loss: 0.0616944 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9789429  Vali macro F1 0.9695003 
new best score!!!!
Validation loss decreased (0.065159 --> 0.061694).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.344095706939697
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0311581  Vali Loss: 0.0718745 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9768424  Vali macro F1 0.9663698 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.336375713348389
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0311858  Vali Loss: 0.1496923 Vali Accuracy: 0.9486926  Vali weighted F1: 0.9506299  Vali macro F1 0.9396490 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.33618688583374
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0379175  Vali Loss: 0.0646188 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9811763  Vali macro F1 0.9733394 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.332498550415039
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0322302  Vali Loss: 0.0694422 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9806957  Vali macro F1 0.9696872 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.340647459030151
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0320015  Vali Loss: 0.0641957 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9821915  Vali macro F1 0.9739608 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 6.347687244415283
VALI: Epoch: 54, Steps: 72 | Train Loss: 0.0205920  Vali Loss: 0.0625257 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837167  Vali macro F1 0.9754511 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.359003782272339
VALI: Epoch: 55, Steps: 72 | Train Loss: 0.0178558  Vali Loss: 0.0635445 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818093  Vali macro F1 0.9731289 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.369927406311035
VALI: Epoch: 56, Steps: 72 | Train Loss: 0.0171232  Vali Loss: 0.0642370 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812986  Vali macro F1 0.9724970 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.345899820327759
VALI: Epoch: 57, Steps: 72 | Train Loss: 0.0170841  Vali Loss: 0.0638497 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812900  Vali macro F1 0.9731221 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.333082437515259
VALI: Epoch: 58, Steps: 72 | Train Loss: 0.0163753  Vali Loss: 0.0632668 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827389  Vali macro F1 0.9748070 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 59 cost time: 6.331794261932373
VALI: Epoch: 59, Steps: 72 | Train Loss: 0.0158835  Vali Loss: 0.0633158 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827744  Vali macro F1 0.9743060 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.337076187133789
VALI: Epoch: 60, Steps: 72 | Train Loss: 0.0154524  Vali Loss: 0.0635342 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827744  Vali macro F1 0.9743060 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 6.338666677474976
VALI: Epoch: 61, Steps: 72 | Train Loss: 0.0151899  Vali Loss: 0.0636045 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832626  Vali macro F1 0.9750779 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 6.339008808135986
VALI: Epoch: 62, Steps: 72 | Train Loss: 0.0157437  Vali Loss: 0.0634526 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827744  Vali macro F1 0.9743060 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 6.355621099472046
VALI: Epoch: 63, Steps: 72 | Train Loss: 0.0151239  Vali Loss: 0.0635220 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827744  Vali macro F1 0.9743060 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8235951  Test weighted F1: 0.8178631  Test macro F1 0.5975469 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3914079666137695
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0223365  Vali Loss: 0.0631801 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808451  Vali macro F1 0.9722264 
Validation loss decreased (inf --> 0.063180).  Saving model ...
Fine Tuning Epoch: 2 cost time: 10.104172468185425
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0224360  Vali Loss: 0.0631242 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817553  Vali macro F1 0.9737381 
new best score!!!!
Validation loss decreased (0.063180 --> 0.063124).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.362749099731445
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0212084  Vali Loss: 0.0662059 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803678  Vali macro F1 0.9718205 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.36306095123291
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0203131  Vali Loss: 0.0703219 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9789025  Vali macro F1 0.9695414 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.365973949432373
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0187334  Vali Loss: 0.0654295 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818143  Vali macro F1 0.9737769 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.366536378860474
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0196030  Vali Loss: 0.0643622 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803163  Vali macro F1 0.9715990 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.3685736656188965
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0188816  Vali Loss: 0.0661564 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803381  Vali macro F1 0.9718072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.375182390213013
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0188311  Vali Loss: 0.0672780 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808529  Vali macro F1 0.9725726 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.39666748046875
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0186420  Vali Loss: 0.0641159 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808044  Vali macro F1 0.9721265 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.442185640335083
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0172153  Vali Loss: 0.0679412 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803413  Vali macro F1 0.9718408 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.365246295928955
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0178002  Vali Loss: 0.0681903 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798710  Vali macro F1 0.9707354 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.352776050567627
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0167244  Vali Loss: 0.0677712 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798674  Vali macro F1 0.9707146 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.365044593811035
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0148621  Vali Loss: 0.0676597 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808426  Vali macro F1 0.9722541 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.363286256790161
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0159425  Vali Loss: 0.0682552 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808426  Vali macro F1 0.9722541 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.363358974456787
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0159528  Vali Loss: 0.0674276 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808426  Vali macro F1 0.9722541 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.378498315811157
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0148143  Vali Loss: 0.0674027 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808426  Vali macro F1 0.9722541 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.4000914096832275
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0160580  Vali Loss: 0.0671319 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808426  Vali macro F1 0.9722541 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8408386  Test weighted F1: 0.8303684  Test macro F1 0.6045665 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014443 0.00016863 0.00100908 0.00133333 0.00050075 0.00063331]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.311293840408325
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.2069894  Vali Loss: 0.7277330 Vali Accuracy: 0.7102526  Vali weighted F1: 0.6387778  Vali macro F1 0.3325569 
Validation loss decreased (inf --> 0.727733).  Saving model ...
Epoch: 2 cost time: 6.308772563934326
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5850033  Vali Loss: 0.4577172 Vali Accuracy: 0.8375433  Vali weighted F1: 0.8140319  Vali macro F1 0.7496097 
new best score!!!!
Validation loss decreased (0.727733 --> 0.457717).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.3082897663116455
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4084054  Vali Loss: 0.3435533 Vali Accuracy: 0.8841010  Vali weighted F1: 0.8739273  Vali macro F1 0.8279181 
new best score!!!!
Validation loss decreased (0.457717 --> 0.343553).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.306225776672363
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3001760  Vali Loss: 0.2401603 Vali Accuracy: 0.9262011  Vali weighted F1: 0.9238215  Vali macro F1 0.8908677 
new best score!!!!
Validation loss decreased (0.343553 --> 0.240160).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.313976049423218
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2339967  Vali Loss: 0.1951535 Vali Accuracy: 0.9380882  Vali weighted F1: 0.9369643  Vali macro F1 0.9115900 
new best score!!!!
Validation loss decreased (0.240160 --> 0.195153).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.327389478683472
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2096435  Vali Loss: 0.1940578 Vali Accuracy: 0.9375929  Vali weighted F1: 0.9353709  Vali macro F1 0.9123934 
new best score!!!!
Validation loss decreased (0.195153 --> 0.194058).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.34672474861145
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1818614  Vali Loss: 0.1669729 Vali Accuracy: 0.9474988  Vali weighted F1: 0.9463984  Vali macro F1 0.9263171 
new best score!!!!
Validation loss decreased (0.194058 --> 0.166973).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.344496250152588
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1647967  Vali Loss: 0.1432181 Vali Accuracy: 0.9509658  Vali weighted F1: 0.9506175  Vali macro F1 0.9300526 
new best score!!!!
Validation loss decreased (0.166973 --> 0.143218).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.322300434112549
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1533704  Vali Loss: 0.1578321 Vali Accuracy: 0.9470035  Vali weighted F1: 0.9454925  Vali macro F1 0.9238260 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.3187196254730225
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1443480  Vali Loss: 0.1295106 Vali Accuracy: 0.9544329  Vali weighted F1: 0.9544215  Vali macro F1 0.9330554 
new best score!!!!
Validation loss decreased (0.143218 --> 0.129511).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.326974153518677
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1394368  Vali Loss: 0.1277454 Vali Accuracy: 0.9534423  Vali weighted F1: 0.9528362  Vali macro F1 0.9325508 
new best score!!!!
Validation loss decreased (0.129511 --> 0.127745).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.3251330852508545
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1293399  Vali Loss: 0.1316457 Vali Accuracy: 0.9524517  Vali weighted F1: 0.9516138  Vali macro F1 0.9321988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.317707777023315
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1268864  Vali Loss: 0.1217977 Vali Accuracy: 0.9554235  Vali weighted F1: 0.9553654  Vali macro F1 0.9346706 
new best score!!!!
Validation loss decreased (0.127745 --> 0.121798).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.324625730514526
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1182634  Vali Loss: 0.1152154 Vali Accuracy: 0.9603764  Vali weighted F1: 0.9600232  Vali macro F1 0.9425295 
new best score!!!!
Validation loss decreased (0.121798 --> 0.115215).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.325733661651611
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1116928  Vali Loss: 0.1505651 Vali Accuracy: 0.9470035  Vali weighted F1: 0.9452275  Vali macro F1 0.9246287 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.33888053894043
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1176597  Vali Loss: 0.1056884 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9619684  Vali macro F1 0.9488673 
new best score!!!!
Validation loss decreased (0.115215 --> 0.105688).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.338742017745972
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0996314  Vali Loss: 0.1083497 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9639149  Vali macro F1 0.9516167 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.322031259536743
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0977930  Vali Loss: 0.1010204 Vali Accuracy: 0.9648341  Vali weighted F1: 0.9646662  Vali macro F1 0.9496971 
new best score!!!!
Validation loss decreased (0.105688 --> 0.101020).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.320501327514648
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0867731  Vali Loss: 0.0938662 Vali Accuracy: 0.9643388  Vali weighted F1: 0.9641781  Vali macro F1 0.9452116 
new best score!!!!
Validation loss decreased (0.101020 --> 0.093866).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.325333833694458
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0833070  Vali Loss: 0.0919284 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9702407  Vali macro F1 0.9579739 
new best score!!!!
Validation loss decreased (0.093866 --> 0.091928).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.31299614906311
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0814229  Vali Loss: 0.0907031 Vali Accuracy: 0.9702823  Vali weighted F1: 0.9702425  Vali macro F1 0.9577837 
new best score!!!!
Validation loss decreased (0.091928 --> 0.090703).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.318578004837036
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0780905  Vali Loss: 0.0978188 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9660109  Vali macro F1 0.9508936 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.325956344604492
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0757333  Vali Loss: 0.0930120 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9682651  Vali macro F1 0.9549567 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.343038320541382
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0827929  Vali Loss: 0.0828702 Vali Accuracy: 0.9707776  Vali weighted F1: 0.9710682  Vali macro F1 0.9561312 
new best score!!!!
Validation loss decreased (0.090703 --> 0.082870).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.344891548156738
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0667014  Vali Loss: 0.0796779 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9738761  Vali macro F1 0.9593505 
new best score!!!!
Validation loss decreased (0.082870 --> 0.079678).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.316451549530029
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0652496  Vali Loss: 0.0923884 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9684570  Vali macro F1 0.9553577 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.312894582748413
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0642119  Vali Loss: 0.0713935 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9778720  Vali macro F1 0.9683065 
new best score!!!!
Validation loss decreased (0.079678 --> 0.071393).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.31543755531311
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0575081  Vali Loss: 0.0747196 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9771834  Vali macro F1 0.9668842 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.310939311981201
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0560606  Vali Loss: 0.0836066 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9749895  Vali macro F1 0.9646127 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.314359664916992
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0523899  Vali Loss: 0.0736608 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787814  Vali macro F1 0.9694334 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.311424255371094
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0525255  Vali Loss: 0.0762341 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9737277  Vali macro F1 0.9622163 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.316632509231567
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0479894  Vali Loss: 0.0751600 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9768262  Vali macro F1 0.9658416 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 6.319728374481201
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0406262  Vali Loss: 0.0660163 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807507  Vali macro F1 0.9721495 
new best score!!!!
Validation loss decreased (0.071393 --> 0.066016).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.336739540100098
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0359769  Vali Loss: 0.0676528 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802387  Vali macro F1 0.9716227 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.307622909545898
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0364788  Vali Loss: 0.0700570 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792610  Vali macro F1 0.9698877 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.303730726242065
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0361924  Vali Loss: 0.0714107 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802666  Vali macro F1 0.9712587 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.325307130813599
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0347868  Vali Loss: 0.0715450 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793018  Vali macro F1 0.9703114 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.32087254524231
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0353316  Vali Loss: 0.0710068 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9787797  Vali macro F1 0.9699542 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.317528009414673
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0344539  Vali Loss: 0.0699916 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807571  Vali macro F1 0.9720548 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.317890644073486
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0334562  Vali Loss: 0.0700335 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802747  Vali macro F1 0.9715966 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.321662664413452
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0344981  Vali Loss: 0.0695003 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807571  Vali macro F1 0.9720548 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.336953639984131
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0323258  Vali Loss: 0.0692773 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802747  Vali macro F1 0.9715966 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.33980131149292
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0328458  Vali Loss: 0.0693227 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807571  Vali macro F1 0.9720548 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.317216634750366
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0338164  Vali Loss: 0.0693292 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807571  Vali macro F1 0.9720548 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.319023370742798
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0349525  Vali Loss: 0.0693015 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807571  Vali macro F1 0.9720548 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.387511968612671
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0330793  Vali Loss: 0.0692927 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802747  Vali macro F1 0.9715966 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.313495397567749
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0339722  Vali Loss: 0.0692723 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807571  Vali macro F1 0.9720548 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.313738584518433
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0331108  Vali Loss: 0.0692200 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807571  Vali macro F1 0.9720548 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7816568  Test weighted F1: 0.7881933  Test macro F1 0.7764337 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.373886823654175
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0378767  Vali Loss: 0.0682874 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802830  Vali macro F1 0.9719357 
Validation loss decreased (inf --> 0.068287).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.345502614974976
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0377834  Vali Loss: 0.0688835 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792783  Vali macro F1 0.9701998 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.444259405136108
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0337214  Vali Loss: 0.0682385 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802820  Vali macro F1 0.9719982 
new best score!!!!
Validation loss decreased (0.068287 --> 0.068238).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.33650279045105
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0355159  Vali Loss: 0.0684333 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807210  Vali macro F1 0.9717023 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.3351075649261475
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0342763  Vali Loss: 0.0672652 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807520  Vali macro F1 0.9721414 
new best score!!!!
Validation loss decreased (0.068238 --> 0.067265).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.335414171218872
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0335173  Vali Loss: 0.0687123 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793023  Vali macro F1 0.9702904 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.347080945968628
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0335217  Vali Loss: 0.0696580 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807628  Vali macro F1 0.9714983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.333495855331421
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0344645  Vali Loss: 0.0697451 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812534  Vali macro F1 0.9727044 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.344580411911011
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0324426  Vali Loss: 0.0704549 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807753  Vali macro F1 0.9721890 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.350407838821411
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0325161  Vali Loss: 0.0681929 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817517  Vali macro F1 0.9734791 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.368339538574219
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0337736  Vali Loss: 0.0686063 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798085  Vali macro F1 0.9709032 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.373429536819458
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0319992  Vali Loss: 0.0678085 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807698  Vali macro F1 0.9718551 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.361937761306763
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0301354  Vali Loss: 0.0695670 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812303  Vali macro F1 0.9726673 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.35396146774292
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0306370  Vali Loss: 0.0701856 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802490  Vali macro F1 0.9711769 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.354205131530762
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0303841  Vali Loss: 0.0677234 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812613  Vali macro F1 0.9726630 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.340958833694458
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0297842  Vali Loss: 0.0680001 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812613  Vali macro F1 0.9726630 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.329877614974976
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0290643  Vali Loss: 0.0677143 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812613  Vali macro F1 0.9726630 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.340582370758057
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0291158  Vali Loss: 0.0680412 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812613  Vali macro F1 0.9726630 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.349754571914673
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0286833  Vali Loss: 0.0687909 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802943  Vali macro F1 0.9717032 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.349408149719238
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0292195  Vali Loss: 0.0678979 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807774  Vali macro F1 0.9721824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7927811  Test weighted F1: 0.7981305  Test macro F1 0.7834784 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014624 0.00017832 0.00108342 0.00132979 0.00049529 0.00062696]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.162429571151733
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.2296104  Vali Loss: 0.7624771 Vali Accuracy: 0.6976154  Vali weighted F1: 0.6043069  Vali macro F1 0.3088547 
Validation loss decreased (inf --> 0.762477).  Saving model ...
Epoch: 2 cost time: 6.138392686843872
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.6446262  Vali Loss: 0.5315322 Vali Accuracy: 0.8203957  Vali weighted F1: 0.7776004  Vali macro F1 0.7073824 
new best score!!!!
Validation loss decreased (0.762477 --> 0.531532).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.145677328109741
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4505603  Vali Loss: 0.3734860 Vali Accuracy: 0.8838153  Vali weighted F1: 0.8760853  Vali macro F1 0.8414328 
new best score!!!!
Validation loss decreased (0.531532 --> 0.373486).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.1412270069122314
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3574054  Vali Loss: 0.3201861 Vali Accuracy: 0.8919330  Vali weighted F1: 0.8882099  Vali macro F1 0.8602681 
new best score!!!!
Validation loss decreased (0.373486 --> 0.320186).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.15128231048584
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2895626  Vali Loss: 0.2592843 Vali Accuracy: 0.9183156  Vali weighted F1: 0.9179645  Vali macro F1 0.8951641 
new best score!!!!
Validation loss decreased (0.320186 --> 0.259284).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.160626649856567
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2436788  Vali Loss: 0.1956593 Vali Accuracy: 0.9381025  Vali weighted F1: 0.9370306  Vali macro F1 0.9189190 
new best score!!!!
Validation loss decreased (0.259284 --> 0.195659).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.1915364265441895
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2079756  Vali Loss: 0.1852708 Vali Accuracy: 0.9416540  Vali weighted F1: 0.9402460  Vali macro F1 0.9248226 
new best score!!!!
Validation loss decreased (0.195659 --> 0.185271).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.191837787628174
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1894744  Vali Loss: 0.1617279 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9464233  Vali macro F1 0.9318351 
new best score!!!!
Validation loss decreased (0.185271 --> 0.161728).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.179200887680054
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1743248  Vali Loss: 0.1541678 Vali Accuracy: 0.9482496  Vali weighted F1: 0.9476847  Vali macro F1 0.9327382 
new best score!!!!
Validation loss decreased (0.161728 --> 0.154168).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.160048961639404
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1619002  Vali Loss: 0.1382462 Vali Accuracy: 0.9538305  Vali weighted F1: 0.9535037  Vali macro F1 0.9388202 
new best score!!!!
Validation loss decreased (0.154168 --> 0.138246).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.166149616241455
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1475523  Vali Loss: 0.1384936 Vali Accuracy: 0.9512938  Vali weighted F1: 0.9509490  Vali macro F1 0.9345440 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.158459663391113
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1423687  Vali Loss: 0.1431260 Vali Accuracy: 0.9553526  Vali weighted F1: 0.9545820  Vali macro F1 0.9449818 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.163986921310425
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1293134  Vali Loss: 0.1239227 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9567821  Vali macro F1 0.9482000 
new best score!!!!
Validation loss decreased (0.138246 --> 0.123923).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.158596515655518
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.1233676  Vali Loss: 0.1168069 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9600347  Vali macro F1 0.9492850 
new best score!!!!
Validation loss decreased (0.123923 --> 0.116807).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.1623711585998535
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.1210694  Vali Loss: 0.1089797 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9636106  Vali macro F1 0.9556493 
new best score!!!!
Validation loss decreased (0.116807 --> 0.108980).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.1822404861450195
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.1165109  Vali Loss: 0.1302336 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9514245  Vali macro F1 0.9405784 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.183982849121094
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.1092409  Vali Loss: 0.1116691 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9636481  Vali macro F1 0.9553090 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.174971342086792
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.1040518  Vali Loss: 0.1060131 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9630023  Vali macro F1 0.9547826 
new best score!!!!
Validation loss decreased (0.108980 --> 0.106013).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.160977602005005
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0989898  Vali Loss: 0.0961239 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9694380  Vali macro F1 0.9586174 
new best score!!!!
Validation loss decreased (0.106013 --> 0.096124).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.169469833374023
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0937229  Vali Loss: 0.0885112 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9700388  Vali macro F1 0.9612804 
new best score!!!!
Validation loss decreased (0.096124 --> 0.088511).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.173746824264526
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0868343  Vali Loss: 0.1146275 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9586169  Vali macro F1 0.9500893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.173757076263428
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0887766  Vali Loss: 0.0832103 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9710847  Vali macro F1 0.9617051 
new best score!!!!
Validation loss decreased (0.088511 --> 0.083210).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.175341844558716
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0781251  Vali Loss: 0.0874683 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9687871  Vali macro F1 0.9616870 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.179056406021118
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0802748  Vali Loss: 0.0727483 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732024  Vali macro F1 0.9667530 
new best score!!!!
Validation loss decreased (0.083210 --> 0.072748).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.178295135498047
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0772414  Vali Loss: 0.0833421 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9716671  Vali macro F1 0.9637485 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.1785969734191895
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0761805  Vali Loss: 0.0904069 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9707213  Vali macro F1 0.9668920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.169344663619995
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0718505  Vali Loss: 0.0786834 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9728967  Vali macro F1 0.9686044 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.17527961730957
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0731005  Vali Loss: 0.0888894 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9693873  Vali macro F1 0.9608476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.167649745941162
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0698531  Vali Loss: 0.0758050 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9727631  Vali macro F1 0.9659123 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.162856101989746
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0552963  Vali Loss: 0.0642735 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9752580  Vali macro F1 0.9690461 
new best score!!!!
Validation loss decreased (0.072748 --> 0.064273).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.157643556594849
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0521648  Vali Loss: 0.0620972 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782772  Vali macro F1 0.9736340 
new best score!!!!
Validation loss decreased (0.064273 --> 0.062097).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.155143737792969
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0500409  Vali Loss: 0.0592758 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798752  Vali macro F1 0.9746865 
new best score!!!!
Validation loss decreased (0.062097 --> 0.059276).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.159404754638672
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0473865  Vali Loss: 0.0615724 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802675  Vali macro F1 0.9754511 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.174219608306885
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0483230  Vali Loss: 0.0583663 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9793233  Vali macro F1 0.9736953 
new best score!!!!
Validation loss decreased (0.059276 --> 0.058366).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.1878275871276855
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0497314  Vali Loss: 0.0608673 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772079  Vali macro F1 0.9718057 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.16959810256958
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0478145  Vali Loss: 0.0578082 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776650  Vali macro F1 0.9723837 
new best score!!!!
Validation loss decreased (0.058366 --> 0.057808).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.160737752914429
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0475369  Vali Loss: 0.0579671 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9803394  Vali macro F1 0.9753726 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.162903785705566
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0470839  Vali Loss: 0.0586511 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792897  Vali macro F1 0.9742481 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.168431758880615
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0466018  Vali Loss: 0.0561327 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798307  Vali macro F1 0.9745433 
new best score!!!!
Validation loss decreased (0.057808 --> 0.056133).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.166966915130615
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0458165  Vali Loss: 0.0565671 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9788626  Vali macro F1 0.9727937 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.177902936935425
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0462693  Vali Loss: 0.0568677 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9793156  Vali macro F1 0.9746537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.171056270599365
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0464992  Vali Loss: 0.0575342 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792373  Vali macro F1 0.9738548 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.186676740646362
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0456669  Vali Loss: 0.0563495 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798478  Vali macro F1 0.9745141 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.203980207443237
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0460451  Vali Loss: 0.0560024 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798453  Vali macro F1 0.9748144 
new best score!!!!
Validation loss decreased (0.056133 --> 0.056002).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.1685779094696045
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0434549  Vali Loss: 0.0587855 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9793278  Vali macro F1 0.9743036 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.1628875732421875
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0431701  Vali Loss: 0.0591207 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787674  Vali macro F1 0.9733616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.164007186889648
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0440277  Vali Loss: 0.0574827 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9799004  Vali macro F1 0.9749228 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.17148494720459
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0423927  Vali Loss: 0.0575905 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9788960  Vali macro F1 0.9732738 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.17261815071106
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0429746  Vali Loss: 0.0604309 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9781724  Vali macro F1 0.9735596 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.174504518508911
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0419287  Vali Loss: 0.0583360 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807818  Vali macro F1 0.9762904 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.174926996231079
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0415085  Vali Loss: 0.0583294 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787057  Vali macro F1 0.9738373 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.180729627609253
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0417991  Vali Loss: 0.0580775 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802528  Vali macro F1 0.9756884 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.196950435638428
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0410699  Vali Loss: 0.0576572 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792548  Vali macro F1 0.9743883 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.184490919113159
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0406466  Vali Loss: 0.0575739 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797440  Vali macro F1 0.9748595 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.172109842300415
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0406063  Vali Loss: 0.0576481 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792354  Vali macro F1 0.9740313 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.176360845565796
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0394373  Vali Loss: 0.0576195 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792575  Vali macro F1 0.9744100 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.177990674972534
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0409348  Vali Loss: 0.0575357 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797750  Vali macro F1 0.9749085 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.180830001831055
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0403194  Vali Loss: 0.0574589 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9808075  Vali macro F1 0.9763418 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.168256759643555
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0411618  Vali Loss: 0.0574606 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802999  Vali macro F1 0.9755145 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9299715  Test weighted F1: 0.9305402  Test macro F1 0.8787146 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.193308591842651
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0454300  Vali Loss: 0.0575717 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792277  Vali macro F1 0.9739348 
Validation loss decreased (inf --> 0.057572).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.178206205368042
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0439992  Vali Loss: 0.0569584 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787382  Vali macro F1 0.9734931 
new best score!!!!
Validation loss decreased (0.057572 --> 0.056958).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.191227912902832
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0419003  Vali Loss: 0.0567776 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792575  Vali macro F1 0.9744100 
new best score!!!!
Validation loss decreased (0.056958 --> 0.056778).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.1785888671875
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0430476  Vali Loss: 0.0597067 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9783026  Vali macro F1 0.9732927 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.184302568435669
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0427105  Vali Loss: 0.0581142 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792144  Vali macro F1 0.9740805 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.180498123168945
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0410254  Vali Loss: 0.0575785 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796495  Vali macro F1 0.9746393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.180687427520752
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0415302  Vali Loss: 0.0601253 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807156  Vali macro F1 0.9759607 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.1943957805633545
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0414531  Vali Loss: 0.0556454 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797330  Vali macro F1 0.9751954 
new best score!!!!
Validation loss decreased (0.056778 --> 0.055645).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.201166152954102
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0411847  Vali Loss: 0.0609163 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791205  Vali macro F1 0.9741265 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.205046892166138
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0412685  Vali Loss: 0.0595610 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812602  Vali macro F1 0.9765126 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.213199615478516
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0412532  Vali Loss: 0.0564594 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792665  Vali macro F1 0.9745510 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.208175897598267
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0390010  Vali Loss: 0.0551658 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817987  Vali macro F1 0.9780622 
new best score!!!!
Validation loss decreased (0.055645 --> 0.055166).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.197866201400757
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0402495  Vali Loss: 0.0553386 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798283  Vali macro F1 0.9752159 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.194912672042847
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0399887  Vali Loss: 0.0565377 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798351  Vali macro F1 0.9751522 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.186090707778931
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0364493  Vali Loss: 0.0574661 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792142  Vali macro F1 0.9742687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.1921257972717285
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0385400  Vali Loss: 0.0571225 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792923  Vali macro F1 0.9744580 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.204492568969727
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0397225  Vali Loss: 0.0578531 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797799  Vali macro F1 0.9754507 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 6.206536531448364
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0358010  Vali Loss: 0.0567785 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9792855  Vali macro F1 0.9744459 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.198472261428833
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0360424  Vali Loss: 0.0565925 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782446  Vali macro F1 0.9737722 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.208422660827637
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0365553  Vali Loss: 0.0585650 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802258  Vali macro F1 0.9761022 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.209325075149536
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0361377  Vali Loss: 0.0530776 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828229  Vali macro F1 0.9790533 
new best score!!!!
Validation loss decreased (0.055166 --> 0.053078).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.177499294281006
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0378758  Vali Loss: 0.0543593 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802854  Vali macro F1 0.9758267 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.194626092910767
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0368693  Vali Loss: 0.0562255 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9796852  Vali macro F1 0.9751518 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.196867227554321
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0342849  Vali Loss: 0.0584412 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801862  Vali macro F1 0.9749401 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.195095062255859
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0359772  Vali Loss: 0.0557789 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817698  Vali macro F1 0.9777844 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.178213119506836
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0357724  Vali Loss: 0.0566746 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807895  Vali macro F1 0.9761460 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.196813583374023
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0324311  Vali Loss: 0.0556839 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807488  Vali macro F1 0.9767054 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.2063164710998535
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0346980  Vali Loss: 0.0549014 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802490  Vali macro F1 0.9761502 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.213534116744995
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0330040  Vali Loss: 0.0545647 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802490  Vali macro F1 0.9761502 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.196089267730713
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0332472  Vali Loss: 0.0543947 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797541  Vali macro F1 0.9753810 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.189716815948486
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0335497  Vali Loss: 0.0548078 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802328  Vali macro F1 0.9757691 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 6.19489598274231
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0321514  Vali Loss: 0.0547253 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802328  Vali macro F1 0.9757691 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.187753200531006
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0313188  Vali Loss: 0.0546457 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807616  Vali macro F1 0.9763522 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.1864049434661865
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0306301  Vali Loss: 0.0546832 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802328  Vali macro F1 0.9757691 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.192152500152588
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0323172  Vali Loss: 0.0546735 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802638  Vali macro F1 0.9758184 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.198561906814575
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0326442  Vali Loss: 0.0547231 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802328  Vali macro F1 0.9757691 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9278550  Test weighted F1: 0.9286141  Test macro F1 0.8743385 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013998 0.00018225 0.00103093 0.00127065 0.00049751 0.0005988 ]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.28542423248291
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.2293596  Vali Loss: 0.7822673 Vali Accuracy: 0.6887450  Vali weighted F1: 0.5891312  Vali macro F1 0.3072454 
Validation loss decreased (inf --> 0.782267).  Saving model ...
Epoch: 2 cost time: 6.295162916183472
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.6324379  Vali Loss: 0.5262311 Vali Accuracy: 0.8187251  Vali weighted F1: 0.7876414  Vali macro F1 0.7169638 
new best score!!!!
Validation loss decreased (0.782267 --> 0.526231).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.270905256271362
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.4535787  Vali Loss: 0.3636302 Vali Accuracy: 0.8720120  Vali weighted F1: 0.8600578  Vali macro F1 0.8231099 
new best score!!!!
Validation loss decreased (0.526231 --> 0.363630).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2641706466674805
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.3459899  Vali Loss: 0.3014074 Vali Accuracy: 0.8959163  Vali weighted F1: 0.8891033  Vali macro F1 0.8567882 
new best score!!!!
Validation loss decreased (0.363630 --> 0.301407).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.282901287078857
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2809755  Vali Loss: 0.2680760 Vali Accuracy: 0.9073705  Vali weighted F1: 0.9047059  Vali macro F1 0.8769215 
new best score!!!!
Validation loss decreased (0.301407 --> 0.268076).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.283141613006592
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2345342  Vali Loss: 0.2170610 Vali Accuracy: 0.9307769  Vali weighted F1: 0.9290927  Vali macro F1 0.9062310 
new best score!!!!
Validation loss decreased (0.268076 --> 0.217061).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.278186559677124
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.2026544  Vali Loss: 0.2045653 Vali Accuracy: 0.9337649  Vali weighted F1: 0.9340745  Vali macro F1 0.9178259 
new best score!!!!
Validation loss decreased (0.217061 --> 0.204565).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.2698259353637695
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1843689  Vali Loss: 0.1857705 Vali Accuracy: 0.9407371  Vali weighted F1: 0.9404398  Vali macro F1 0.9255057 
new best score!!!!
Validation loss decreased (0.204565 --> 0.185770).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.291828393936157
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1736707  Vali Loss: 0.1810497 Vali Accuracy: 0.9387450  Vali weighted F1: 0.9391843  Vali macro F1 0.9280994 
new best score!!!!
Validation loss decreased (0.185770 --> 0.181050).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.330138206481934
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1573855  Vali Loss: 0.1916537 Vali Accuracy: 0.9342629  Vali weighted F1: 0.9313959  Vali macro F1 0.9084402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.2909369468688965
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1529861  Vali Loss: 0.1506737 Vali Accuracy: 0.9501992  Vali weighted F1: 0.9494789  Vali macro F1 0.9396995 
new best score!!!!
Validation loss decreased (0.181050 --> 0.150674).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.290130138397217
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1377284  Vali Loss: 0.1457359 Vali Accuracy: 0.9546813  Vali weighted F1: 0.9537451  Vali macro F1 0.9448820 
new best score!!!!
Validation loss decreased (0.150674 --> 0.145736).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.285957336425781
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.1314332  Vali Loss: 0.1481460 Vali Accuracy: 0.9526892  Vali weighted F1: 0.9516984  Vali macro F1 0.9423223 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.285457611083984
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.1206255  Vali Loss: 0.1349615 Vali Accuracy: 0.9581673  Vali weighted F1: 0.9577194  Vali macro F1 0.9436231 
new best score!!!!
Validation loss decreased (0.145736 --> 0.134961).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.285782814025879
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.1248883  Vali Loss: 0.1357620 Vali Accuracy: 0.9566733  Vali weighted F1: 0.9560096  Vali macro F1 0.9477115 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.2759387493133545
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.1080415  Vali Loss: 0.1344279 Vali Accuracy: 0.9556773  Vali weighted F1: 0.9552724  Vali macro F1 0.9447754 
new best score!!!!
Validation loss decreased (0.134961 --> 0.134428).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.29065728187561
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.1095792  Vali Loss: 0.1198861 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9613608  Vali macro F1 0.9541696 
new best score!!!!
Validation loss decreased (0.134428 --> 0.119886).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.301776170730591
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0945350  Vali Loss: 0.1277993 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9594988  Vali macro F1 0.9509179 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.2909204959869385
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0940059  Vali Loss: 0.1048785 Vali Accuracy: 0.9676295  Vali weighted F1: 0.9678754  Vali macro F1 0.9606208 
new best score!!!!
Validation loss decreased (0.119886 --> 0.104878).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.292044162750244
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0983282  Vali Loss: 0.1150372 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9673399  Vali macro F1 0.9601124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.29990291595459
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0921903  Vali Loss: 0.1345135 Vali Accuracy: 0.9571713  Vali weighted F1: 0.9568862  Vali macro F1 0.9495797 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.28885293006897
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0938153  Vali Loss: 0.0989095 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9697477  Vali macro F1 0.9625492 
new best score!!!!
Validation loss decreased (0.104878 --> 0.098909).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.291319847106934
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0822495  Vali Loss: 0.1131576 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9640371  Vali macro F1 0.9551628 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.290218114852905
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0769031  Vali Loss: 0.0963834 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9706327  Vali macro F1 0.9650615 
new best score!!!!
Validation loss decreased (0.098909 --> 0.096383).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.303364515304565
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0726533  Vali Loss: 0.0926657 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9701784  Vali macro F1 0.9648178 
new best score!!!!
Validation loss decreased (0.096383 --> 0.092666).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.309140682220459
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0739075  Vali Loss: 0.0966020 Vali Accuracy: 0.9681275  Vali weighted F1: 0.9681833  Vali macro F1 0.9605123 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.313971757888794
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0718242  Vali Loss: 0.1115645 Vali Accuracy: 0.9636454  Vali weighted F1: 0.9634869  Vali macro F1 0.9563974 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.292186975479126
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0644699  Vali Loss: 0.0974107 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9684698  Vali macro F1 0.9618199 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.290375232696533
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0633459  Vali Loss: 0.0956289 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9741846  Vali macro F1 0.9682810 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.297663927078247
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0647150  Vali Loss: 0.0924315 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9760009  Vali macro F1 0.9703169 
new best score!!!!
Validation loss decreased (0.092666 --> 0.092431).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.293386936187744
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0611962  Vali Loss: 0.0825914 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9764849  Vali macro F1 0.9709775 
new best score!!!!
Validation loss decreased (0.092431 --> 0.082591).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.29060435295105
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0607032  Vali Loss: 0.0889270 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9720728  Vali macro F1 0.9644909 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.283639192581177
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0562003  Vali Loss: 0.0964611 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9697905  Vali macro F1 0.9636921 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.287604331970215
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0498640  Vali Loss: 0.0851735 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9748640  Vali macro F1 0.9687871 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.31237006187439
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0479902  Vali Loss: 0.0731350 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811177  Vali macro F1 0.9781744 
new best score!!!!
Validation loss decreased (0.082591 --> 0.073135).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.289496898651123
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0503059  Vali Loss: 0.0885042 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9735611  Vali macro F1 0.9689727 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.298610687255859
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0479008  Vali Loss: 0.0786792 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9780856  Vali macro F1 0.9738613 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.285078287124634
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0461241  Vali Loss: 0.0739566 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805120  Vali macro F1 0.9758819 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.287650108337402
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0424625  Vali Loss: 0.0802043 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9776447  Vali macro F1 0.9744387 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.286590099334717
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0526876  Vali Loss: 0.0877310 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9747638  Vali macro F1 0.9695605 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 6.287477970123291
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0343857  Vali Loss: 0.0744821 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801200  Vali macro F1 0.9755890 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.308226823806763
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0300828  Vali Loss: 0.0690781 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790540  Vali macro F1 0.9749234 
new best score!!!!
Validation loss decreased (0.073135 --> 0.069078).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.327390909194946
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0295938  Vali Loss: 0.0694351 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810688  Vali macro F1 0.9770926 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.292828559875488
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0288567  Vali Loss: 0.0697811 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805796  Vali macro F1 0.9766793 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.28806209564209
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0281843  Vali Loss: 0.0706403 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825380  Vali macro F1 0.9793815 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.2909910678863525
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0284265  Vali Loss: 0.0675271 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810927  Vali macro F1 0.9776661 
new best score!!!!
Validation loss decreased (0.069078 --> 0.067527).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.293030023574829
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0269407  Vali Loss: 0.0697445 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810600  Vali macro F1 0.9772963 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.283897161483765
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0274348  Vali Loss: 0.0705567 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800539  Vali macro F1 0.9758900 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.29331111907959
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0257015  Vali Loss: 0.0716633 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820905  Vali macro F1 0.9782501 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.300534725189209
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0257200  Vali Loss: 0.0728154 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805571  Vali macro F1 0.9761792 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.312725067138672
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0263333  Vali Loss: 0.0690985 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820950  Vali macro F1 0.9785307 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 6.300722360610962
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0252611  Vali Loss: 0.0701910 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820780  Vali macro F1 0.9783958 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.288864374160767
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0267273  Vali Loss: 0.0718104 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820673  Vali macro F1 0.9782173 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.289488792419434
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0252835  Vali Loss: 0.0704985 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815644  Vali macro F1 0.9779114 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.289776563644409
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0255623  Vali Loss: 0.0703261 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810672  Vali macro F1 0.9771274 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.294771432876587
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0253078  Vali Loss: 0.0702224 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815644  Vali macro F1 0.9779114 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 57 cost time: 6.292808532714844
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0256022  Vali Loss: 0.0703477 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815644  Vali macro F1 0.9779114 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.298145294189453
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0250776  Vali Loss: 0.0704037 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815644  Vali macro F1 0.9779114 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.3092124462127686
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0246402  Vali Loss: 0.0704672 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815644  Vali macro F1 0.9779114 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.312551259994507
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0257496  Vali Loss: 0.0705321 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815644  Vali macro F1 0.9779114 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.286325216293335
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0250934  Vali Loss: 0.0705678 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815644  Vali macro F1 0.9779114 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9270672  Test weighted F1: 0.9246704  Test macro F1 0.8672821 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 63951
pruned model Parameter : 67790
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3283514976501465
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0278753  Vali Loss: 0.0749077 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806092  Vali macro F1 0.9760756 
Validation loss decreased (inf --> 0.074908).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.284965753555298
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0261744  Vali Loss: 0.0709182 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820865  Vali macro F1 0.9788038 
new best score!!!!
Validation loss decreased (0.074908 --> 0.070918).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.29546594619751
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0265768  Vali Loss: 0.0721732 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805677  Vali macro F1 0.9768455 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.287214040756226
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0250780  Vali Loss: 0.0756107 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801491  Vali macro F1 0.9750409 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.2990522384643555
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0268840  Vali Loss: 0.0769635 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810738  Vali macro F1 0.9772071 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.312374591827393
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0258597  Vali Loss: 0.0714308 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821014  Vali macro F1 0.9784654 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.315968990325928
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0247567  Vali Loss: 0.0788962 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9779845  Vali macro F1 0.9738754 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.309256553649902
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0246145  Vali Loss: 0.0750216 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800679  Vali macro F1 0.9762511 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.30689811706543
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0253553  Vali Loss: 0.0736255 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816262  Vali macro F1 0.9774589 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.302055835723877
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0244499  Vali Loss: 0.0731426 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801378  Vali macro F1 0.9756321 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.310550928115845
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0230755  Vali Loss: 0.0716264 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821082  Vali macro F1 0.9780059 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.296716690063477
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0242357  Vali Loss: 0.0712220 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810985  Vali macro F1 0.9770639 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.299590826034546
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0227633  Vali Loss: 0.0736574 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800582  Vali macro F1 0.9759684 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.343459606170654
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0226221  Vali Loss: 0.0738280 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815803  Vali macro F1 0.9773582 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.339998483657837
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0230137  Vali Loss: 0.0743658 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805372  Vali macro F1 0.9764928 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.315675735473633
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0229863  Vali Loss: 0.0735497 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810883  Vali macro F1 0.9769412 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.32214093208313
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0212706  Vali Loss: 0.0734589 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810883  Vali macro F1 0.9769412 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9286189  Test weighted F1: 0.9261835  Test macro F1 0.8675549 

============================= JOB FEEDBACK =============================

NodeName=uc2n561
Job ID: 20948442
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 08:38:47
CPU Efficiency: 4.98% of 7-05:35:40 core-walltime
Job Wall-clock time: 08:40:47
Memory Utilized: 5.01 GB
Memory Efficiency: 0.00% of 0.00 MB
