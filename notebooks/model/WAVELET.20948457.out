Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1618428
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 9.621280908584595
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6878336  Vali Loss: 0.4413006 Vali Accuracy: 0.9210526  Vali weighted F1: 0.9163664  Vali macro F1 0.9140274 
Validation loss decreased (inf --> 0.441301).  Saving model ...
Epoch: 2 cost time: 5.462880373001099
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3054354  Vali Loss: 0.1468632 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809496  Vali macro F1 0.9799594 
new best score!!!!
Validation loss decreased (0.441301 --> 0.146863).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.456671953201294
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1284498  Vali Loss: 0.0713328 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847754  Vali macro F1 0.9840601 
new best score!!!!
Validation loss decreased (0.146863 --> 0.071333).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.460566520690918
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0705543  Vali Loss: 0.0501527 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
new best score!!!!
Validation loss decreased (0.071333 --> 0.050153).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.464720249176025
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0528581  Vali Loss: 0.0379346 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
new best score!!!!
Validation loss decreased (0.050153 --> 0.037935).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.469661474227905
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0432109  Vali Loss: 0.0373778 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860806  Vali macro F1 0.9854027 
new best score!!!!
Validation loss decreased (0.037935 --> 0.037378).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.475298643112183
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0436079  Vali Loss: 0.0313970 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.037378 --> 0.031397).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.4745166301727295
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0321784  Vali Loss: 0.0274123 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.031397 --> 0.027412).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.48619818687439
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0234896  Vali Loss: 0.0176619 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.027412 --> 0.017662).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.478428602218628
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0187502  Vali Loss: 0.0234013 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.496201038360596
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0145648  Vali Loss: 0.0234118 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.504160165786743
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0129039  Vali Loss: 0.0172864 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.017662 --> 0.017286).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.503682374954224
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0114812  Vali Loss: 0.0239860 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.512922763824463
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0135584  Vali Loss: 0.0167824 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.017286 --> 0.016782).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.518018007278442
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0106833  Vali Loss: 0.0120856 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9947947 
new best score!!!!
Validation loss decreased (0.016782 --> 0.012086).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.523129940032959
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0096018  Vali Loss: 0.0155653 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.5244739055633545
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0099833  Vali Loss: 0.0198676 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.522271156311035
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0125782  Vali Loss: 0.0224787 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862155  Vali macro F1 0.9857050 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.523311138153076
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0203010  Vali Loss: 0.0195159 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.521746635437012
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0102269  Vali Loss: 0.0100349 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.012086 --> 0.010035).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.533411026000977
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0089825  Vali Loss: 0.0210998 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.532118558883667
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0104180  Vali Loss: 0.0271587 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9833815  Vali macro F1 0.9828444 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.538642883300781
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0440168  Vali Loss: 0.0290021 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899613  Vali macro F1 0.9893936 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.540690660476685
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0179534  Vali Loss: 0.0178848 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.542778491973877
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0103624  Vali Loss: 0.0155760 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.545521259307861
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0075468  Vali Loss: 0.0174244 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.549241542816162
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0065466  Vali Loss: 0.0117981 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.552448987960815
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0061011  Vali Loss: 0.0108626 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.548957586288452
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0055259  Vali Loss: 0.0107701 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.5549399852752686
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0052090  Vali Loss: 0.0103754 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 5.571408033370972
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0052302  Vali Loss: 0.0108198 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.558043956756592
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0053741  Vali Loss: 0.0115411 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.560565710067749
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0050529  Vali Loss: 0.0110810 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.565370559692383
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0051750  Vali Loss: 0.0108422 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.560614109039307
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0049128  Vali Loss: 0.0107053 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8728070  Test weighted F1: 0.8492554  Test macro F1 0.8492554 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.203531265258789
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0067448  Vali Loss: 0.0104213 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
Validation loss decreased (inf --> 0.010421).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.192014694213867
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0049819  Vali Loss: 0.0087126 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.010421 --> 0.008713).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.201670408248901
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0046100  Vali Loss: 0.0063284 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.008713 --> 0.006328).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.194936990737915
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0037273  Vali Loss: 0.0082710 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.1996729373931885
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0035424  Vali Loss: 0.0080866 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 7.2004475593566895
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0033416  Vali Loss: 0.0093412 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 7.200700283050537
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0031679  Vali Loss: 0.0060376 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.006328 --> 0.006038).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.193194150924683
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0025803  Vali Loss: 0.0047423 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
new best score!!!!
Validation loss decreased (0.006038 --> 0.004742).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.209025859832764
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0025068  Vali Loss: 0.0056838 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.197148561477661
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0024120  Vali Loss: 0.0062031 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974899  Vali macro F1 0.9973910 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.194570064544678
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0028521  Vali Loss: 0.0178163 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 7.186224699020386
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0032988  Vali Loss: 0.0133172 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 7.194464683532715
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0024282  Vali Loss: 0.0103069 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912307  Vali macro F1 0.9908976 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 7.2101829051971436
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0022249  Vali Loss: 0.0069325 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9947947 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.199056148529053
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0022127  Vali Loss: 0.0149240 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.192379474639893
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0024833  Vali Loss: 0.0096304 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.195147752761841
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0018542  Vali Loss: 0.0092954 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9947947 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.193688869476318
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0021640  Vali Loss: 0.0089967 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9960918 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 7.193923711776733
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0021773  Vali Loss: 0.0093026 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9960918 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.197744369506836
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0015634  Vali Loss: 0.0097736 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9960918 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 7.192467212677002
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0015228  Vali Loss: 0.0099001 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9960918 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 7.192675590515137
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0013515  Vali Loss: 0.0105689 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9947947 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 7.189167737960815
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0015752  Vali Loss: 0.0110045 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937362  Vali macro F1 0.9934983 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9122807  Test weighted F1: 0.8917129  Test macro F1 0.8917129 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.626388072967529
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.7103787  Vali Loss: 0.4440250 Vali Accuracy: 0.9323308  Vali weighted F1: 0.9293023  Vali macro F1 0.9269549 
Validation loss decreased (inf --> 0.444025).  Saving model ...
Epoch: 2 cost time: 5.56218957901001
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3078728  Vali Loss: 0.1479439 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9709300  Vali macro F1 0.9703065 
new best score!!!!
Validation loss decreased (0.444025 --> 0.147944).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.560916423797607
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1245798  Vali Loss: 0.0792885 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847118  Vali macro F1 0.9842105 
new best score!!!!
Validation loss decreased (0.147944 --> 0.079289).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.5624706745147705
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0733013  Vali Loss: 0.0483046 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860288  Vali macro F1 0.9855642 
new best score!!!!
Validation loss decreased (0.079289 --> 0.048305).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.560791015625
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0497858  Vali Loss: 0.0358918 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.048305 --> 0.035892).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.574582576751709
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0415115  Vali Loss: 0.0268817 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
new best score!!!!
Validation loss decreased (0.035892 --> 0.026882).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.56818962097168
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0315463  Vali Loss: 0.0266760 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.026882 --> 0.026676).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.573981523513794
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0237858  Vali Loss: 0.0244361 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.026676 --> 0.024436).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.568548917770386
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0239017  Vali Loss: 0.0211878 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.024436 --> 0.021188).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.575490474700928
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0190482  Vali Loss: 0.0216901 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.5663745403289795
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0144608  Vali Loss: 0.0182377 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.021188 --> 0.018238).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.565608024597168
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0200352  Vali Loss: 0.0198699 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.561754941940308
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0157100  Vali Loss: 0.0222703 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899613  Vali macro F1 0.9893936 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.561713933944702
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0164186  Vali Loss: 0.0166798 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.018238 --> 0.016680).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.5625622272491455
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0165479  Vali Loss: 0.0152107 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.016680 --> 0.015211).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.563780069351196
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0090307  Vali Loss: 0.0140086 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.015211 --> 0.014009).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.572662115097046
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0094057  Vali Loss: 0.0132274 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.014009 --> 0.013227).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.564144134521484
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0091181  Vali Loss: 0.0153979 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.566935777664185
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0085806  Vali Loss: 0.0146330 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.562923192977905
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0064435  Vali Loss: 0.0095302 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.013227 --> 0.009530).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.559981822967529
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0073447  Vali Loss: 0.0149299 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.55879282951355
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0099832  Vali Loss: 0.0228818 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.560579299926758
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0102367  Vali Loss: 0.0198335 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.558520078659058
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0121804  Vali Loss: 0.0154949 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.566182374954224
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0078349  Vali Loss: 0.0145494 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.557163953781128
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0073604  Vali Loss: 0.0138140 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.564676761627197
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0058229  Vali Loss: 0.0132200 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.557333946228027
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0050535  Vali Loss: 0.0131037 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.557482481002808
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0048815  Vali Loss: 0.0125253 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.556274890899658
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0044195  Vali Loss: 0.0121490 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 5.554771423339844
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0040051  Vali Loss: 0.0120918 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.55421781539917
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0041810  Vali Loss: 0.0120338 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.552316188812256
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0040737  Vali Loss: 0.0119575 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.547198295593262
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0040841  Vali Loss: 0.0119074 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.548048973083496
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0040944  Vali Loss: 0.0119284 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8982456  Test weighted F1: 0.8782706  Test macro F1 0.8782706 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.152705907821655
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0054430  Vali Loss: 0.0147927 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
Validation loss decreased (inf --> 0.014793).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.151973485946655
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0039069  Vali Loss: 0.0144085 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.014793 --> 0.014409).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.151510000228882
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0036166  Vali Loss: 0.0130809 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.014409 --> 0.013081).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.144343852996826
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0033877  Vali Loss: 0.0131609 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.146501064300537
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0031430  Vali Loss: 0.0120538 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.013081 --> 0.012054).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.156494617462158
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0043835  Vali Loss: 0.0134182 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.15021014213562
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0038597  Vali Loss: 0.0089782 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.012054 --> 0.008978).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.15736722946167
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0027495  Vali Loss: 0.0102834 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.162185430526733
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0024811  Vali Loss: 0.0118706 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 7.165184020996094
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0022178  Vali Loss: 0.0104654 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 7.159408092498779
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0021029  Vali Loss: 0.0071765 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.008978 --> 0.007176).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.160630941390991
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0022046  Vali Loss: 0.0135453 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.159286022186279
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0021567  Vali Loss: 0.0091493 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 7.161176443099976
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0021682  Vali Loss: 0.0107616 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 7.159363031387329
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0019013  Vali Loss: 0.0081547 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 7.158767938613892
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0018758  Vali Loss: 0.0106430 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 7.158266544342041
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0021827  Vali Loss: 0.0139779 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.158641338348389
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0065416  Vali Loss: 0.0088152 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937362  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.161299228668213
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0032678  Vali Loss: 0.0143110 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.168514013290405
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0029197  Vali Loss: 0.0085009 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937305  Vali macro F1 0.9934864 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.162806272506714
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0022692  Vali Loss: 0.0095737 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 7.155121564865112
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0018513  Vali Loss: 0.0099178 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.1653971672058105
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0031069  Vali Loss: 0.0101872 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.158079385757446
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0017627  Vali Loss: 0.0108836 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.161181688308716
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0017984  Vali Loss: 0.0104633 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.1722328662872314
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0015877  Vali Loss: 0.0103366 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8622807  Test weighted F1: 0.8387795  Test macro F1 0.8387795 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.649104356765747
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6928459  Vali Loss: 0.4267698 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9472814  Vali macro F1 0.9458218 
Validation loss decreased (inf --> 0.426770).  Saving model ...
Epoch: 2 cost time: 5.575434684753418
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2999779  Vali Loss: 0.1279309 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873177  Vali macro F1 0.9868623 
new best score!!!!
Validation loss decreased (0.426770 --> 0.127931).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.569603204727173
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1258753  Vali Loss: 0.0642813 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
new best score!!!!
Validation loss decreased (0.127931 --> 0.064281).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.579107046127319
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0659001  Vali Loss: 0.0415376 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911349  Vali macro F1 0.9910793 
new best score!!!!
Validation loss decreased (0.064281 --> 0.041538).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.577247619628906
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0445488  Vali Loss: 0.0326149 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.041538 --> 0.032615).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.574622631072998
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0353397  Vali Loss: 0.0320270 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
new best score!!!!
Validation loss decreased (0.032615 --> 0.032027).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.573846817016602
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0318722  Vali Loss: 0.0205163 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.032027 --> 0.020516).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.572640419006348
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0245854  Vali Loss: 0.0185295 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.020516 --> 0.018530).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.573575496673584
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0183508  Vali Loss: 0.0144664 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.018530 --> 0.014466).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.570845365524292
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0156378  Vali Loss: 0.0147794 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.575653314590454
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0240620  Vali Loss: 0.0231081 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937341  Vali macro F1 0.9936411 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.572244644165039
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0253268  Vali Loss: 0.0164370 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 13 cost time: 5.569134712219238
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0163839  Vali Loss: 0.0149325 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 14 cost time: 5.561905860900879
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0132825  Vali Loss: 0.0088825 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.014466 --> 0.008882).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.570244073867798
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0138051  Vali Loss: 0.0112241 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9962393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.566347122192383
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0112485  Vali Loss: 0.0078003 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.008882 --> 0.007800).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.572697401046753
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0109436  Vali Loss: 0.0081425 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974928  Vali macro F1 0.9974584 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.562499761581421
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0137155  Vali Loss: 0.0110899 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.563433885574341
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0149209  Vali Loss: 0.0075260 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.007800 --> 0.007526).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.570364475250244
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0096437  Vali Loss: 0.0103132 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.560762643814087
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0078700  Vali Loss: 0.0049061 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.007526 --> 0.004906).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.568759202957153
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0065385  Vali Loss: 0.0051257 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.566349029541016
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0056851  Vali Loss: 0.0037681 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004906 --> 0.003768).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.564448833465576
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0065037  Vali Loss: 0.0238371 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911330  Vali macro F1 0.9907624 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.567884683609009
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0128324  Vali Loss: 0.0176753 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962407  Vali macro F1 0.9963007 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.5668785572052
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0104294  Vali Loss: 0.0068490 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.567676067352295
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0087193  Vali Loss: 0.0037410 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.003768 --> 0.003741).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.5666587352752686
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0068535  Vali Loss: 0.0066562 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.564274787902832
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0071146  Vali Loss: 0.0056296 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.557847499847412
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0095521  Vali Loss: 0.0107741 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.558750152587891
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0067816  Vali Loss: 0.0059568 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.560106039047241
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0052144  Vali Loss: 0.0046376 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 5.5596349239349365
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0051262  Vali Loss: 0.0042713 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.56345272064209
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0034456  Vali Loss: 0.0037441 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.559583902359009
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0029842  Vali Loss: 0.0036332 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
new best score!!!!
Validation loss decreased (0.003741 --> 0.003633).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.555447340011597
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0029342  Vali Loss: 0.0037633 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.559952974319458
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0026463  Vali Loss: 0.0029689 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003633 --> 0.002969).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.561400890350342
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0024917  Vali Loss: 0.0028154 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002969 --> 0.002815).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.557627201080322
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0025038  Vali Loss: 0.0030407 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.558929920196533
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0022944  Vali Loss: 0.0030837 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.563251495361328
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0028097  Vali Loss: 0.0032473 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.560649633407593
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0020823  Vali Loss: 0.0028092 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
new best score!!!!
Validation loss decreased (0.002815 --> 0.002809).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.5584917068481445
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0020881  Vali Loss: 0.0024838 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002809 --> 0.002484).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.5570807456970215
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0020159  Vali Loss: 0.0030395 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.554776668548584
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0020964  Vali Loss: 0.0030648 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.553269624710083
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0021322  Vali Loss: 0.0042206 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.552153825759888
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0018441  Vali Loss: 0.0031123 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.549436092376709
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0021367  Vali Loss: 0.0040571 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 5.550832986831665
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0019536  Vali Loss: 0.0042465 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.554361343383789
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0019055  Vali Loss: 0.0041233 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.559474945068359
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0019189  Vali Loss: 0.0041027 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.552493333816528
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0019174  Vali Loss: 0.0041065 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.549738168716431
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0018971  Vali Loss: 0.0040805 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 5.552284240722656
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0018036  Vali Loss: 0.0040757 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.559459924697876
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0019315  Vali Loss: 0.0040685 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 5.553281307220459
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0018988  Vali Loss: 0.0040649 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 5.562455892562866
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0019206  Vali Loss: 0.0040375 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 5.564401865005493
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0017742  Vali Loss: 0.0040254 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9236842  Test weighted F1: 0.9179772  Test macro F1 0.9179772 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.159863471984863
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0029105  Vali Loss: 0.0038108 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
Validation loss decreased (inf --> 0.003811).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.145776748657227
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0024824  Vali Loss: 0.0019899 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003811 --> 0.001990).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.1419456005096436
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0019079  Vali Loss: 0.0020187 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.146744251251221
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0016547  Vali Loss: 0.0021628 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 7.150897026062012
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0010681  Vali Loss: 0.0035828 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 7.15088415145874
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0011378  Vali Loss: 0.0042162 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 7.1420838832855225
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0013801  Vali Loss: 0.0047549 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 7.142796516418457
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0015095  Vali Loss: 0.0046350 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.147995471954346
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0010811  Vali Loss: 0.0038757 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 7.146652698516846
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0010689  Vali Loss: 0.0043929 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 7.144270896911621
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0013363  Vali Loss: 0.0011188 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001990 --> 0.001119).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.147083520889282
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0020545  Vali Loss: 0.0033745 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9989034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.148773193359375
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0017768  Vali Loss: 0.0024625 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 7.144498348236084
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0012553  Vali Loss: 0.0027606 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 7.1516430377960205
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0009230  Vali Loss: 0.0035996 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 7.144553184509277
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0017355  Vali Loss: 0.0032396 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 7.154261827468872
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0009367  Vali Loss: 0.0032497 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.14961314201355
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0007283  Vali Loss: 0.0032748 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.141911506652832
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0008246  Vali Loss: 0.0032347 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.145128965377808
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0007036  Vali Loss: 0.0032158 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.149418830871582
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0006443  Vali Loss: 0.0031764 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 7.141474723815918
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0010100  Vali Loss: 0.0031653 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.153546571731567
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0009794  Vali Loss: 0.0031732 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.1496617794036865
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0008372  Vali Loss: 0.0031704 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.148356676101685
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0008375  Vali Loss: 0.0031755 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.1548426151275635
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0006092  Vali Loss: 0.0031751 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9078947  Test weighted F1: 0.8956789  Test macro F1 0.8956789 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.648362398147583
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6947006  Vali Loss: 0.4794039 Vali Accuracy: 0.9185464  Vali weighted F1: 0.9156631  Vali macro F1 0.9135581 
Validation loss decreased (inf --> 0.479404).  Saving model ...
Epoch: 2 cost time: 5.550671577453613
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3098983  Vali Loss: 0.1447405 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811316  Vali macro F1 0.9806110 
new best score!!!!
Validation loss decreased (0.479404 --> 0.144741).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.5603814125061035
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1223046  Vali Loss: 0.0732974 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860288  Vali macro F1 0.9855642 
new best score!!!!
Validation loss decreased (0.144741 --> 0.073297).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.559518337249756
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0710593  Vali Loss: 0.0514361 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859785  Vali macro F1 0.9855558 
new best score!!!!
Validation loss decreased (0.073297 --> 0.051436).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.571474075317383
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0499734  Vali Loss: 0.0345431 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.051436 --> 0.034543).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.5588836669921875
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0409035  Vali Loss: 0.0337802 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.034543 --> 0.033780).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.566001653671265
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0304076  Vali Loss: 0.0355739 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.5570173263549805
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0292541  Vali Loss: 0.0326780 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.033780 --> 0.032678).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.571421146392822
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0243772  Vali Loss: 0.0228243 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.032678 --> 0.022824).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.5595643520355225
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0199381  Vali Loss: 0.0222737 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.022824 --> 0.022274).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.565630674362183
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0148998  Vali Loss: 0.0222739 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.553211688995361
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0132164  Vali Loss: 0.0134174 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.022274 --> 0.013417).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.562622785568237
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0105155  Vali Loss: 0.0237253 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.559818267822266
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0138634  Vali Loss: 0.0177367 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.559936046600342
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0098970  Vali Loss: 0.0135546 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 5.557363510131836
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0097607  Vali Loss: 0.0160266 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873920  Vali macro F1 0.9869548 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 17 cost time: 5.562740325927734
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0193099  Vali Loss: 0.0240463 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 18 cost time: 5.555354118347168
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0149068  Vali Loss: 0.0193262 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.559086084365845
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0099773  Vali Loss: 0.0161608 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.5502893924713135
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0083509  Vali Loss: 0.0157082 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.560646057128906
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0073848  Vali Loss: 0.0154957 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.562242269515991
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0069268  Vali Loss: 0.0149968 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 23 cost time: 5.563682317733765
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0066921  Vali Loss: 0.0147134 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.555789470672607
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0067103  Vali Loss: 0.0145264 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.566870450973511
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0066674  Vali Loss: 0.0144766 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.553887367248535
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0065703  Vali Loss: 0.0144855 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.566413402557373
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0065535  Vali Loss: 0.0142676 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8008772  Test weighted F1: 0.7589071  Test macro F1 0.7589071 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.158020257949829
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0092595  Vali Loss: 0.0123161 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
Validation loss decreased (inf --> 0.012316).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.162261962890625
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0078802  Vali Loss: 0.0129977 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.1534271240234375
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0072569  Vali Loss: 0.0130969 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.161766052246094
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0067199  Vali Loss: 0.0108490 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.012316 --> 0.010849).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.156875848770142
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0078250  Vali Loss: 0.0153641 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 7.1585612297058105
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0060514  Vali Loss: 0.0128330 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 7.149447441101074
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0058183  Vali Loss: 0.0088593 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.010849 --> 0.008859).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.153818368911743
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0057003  Vali Loss: 0.0110327 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.155461311340332
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0052837  Vali Loss: 0.0104373 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 7.156876087188721
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0059530  Vali Loss: 0.0088871 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 7.150731086730957
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0049498  Vali Loss: 0.0084677 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.008859 --> 0.008468).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.152649879455566
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0043530  Vali Loss: 0.0087594 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.1590576171875
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0041450  Vali Loss: 0.0082642 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.008468 --> 0.008264).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 7.156625747680664
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0039694  Vali Loss: 0.0081533 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.008264 --> 0.008153).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 7.157577037811279
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0040309  Vali Loss: 0.0099568 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 7.153456211090088
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0040719  Vali Loss: 0.0084808 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 7.158823013305664
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0036332  Vali Loss: 0.0086904 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 7.162653207778931
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0035001  Vali Loss: 0.0074785 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
new best score!!!!
Validation loss decreased (0.008153 --> 0.007479).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 7.159467458724976
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0033721  Vali Loss: 0.0073772 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.007479 --> 0.007377).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 7.158617734909058
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0038333  Vali Loss: 0.0102943 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 7.162007093429565
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0036778  Vali Loss: 0.0088963 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 7.164518356323242
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0030608  Vali Loss: 0.0070273 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.007377 --> 0.007027).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 7.161128520965576
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0032320  Vali Loss: 0.0110491 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 7.170253038406372
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0030217  Vali Loss: 0.0074594 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 7.166604280471802
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0036733  Vali Loss: 0.0085461 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 7.170769691467285
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0089962  Vali Loss: 0.0077908 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 7.169842958450317
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0045045  Vali Loss: 0.0105865 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 28 cost time: 7.160203456878662
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0035115  Vali Loss: 0.0080239 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 7.172910690307617
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0039368  Vali Loss: 0.0068865 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
new best score!!!!
Validation loss decreased (0.007027 --> 0.006887).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 7.16527247428894
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0049148  Vali Loss: 0.0121598 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 7.166372776031494
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0039140  Vali Loss: 0.0075357 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 7.160734176635742
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0027558  Vali Loss: 0.0091262 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 7.154607772827148
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0024287  Vali Loss: 0.0077414 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 7.161492586135864
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0025097  Vali Loss: 0.0061631 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.006887 --> 0.006163).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 7.160824298858643
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0024877  Vali Loss: 0.0072985 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 7.163492441177368
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0024530  Vali Loss: 0.0069994 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 7.153912305831909
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0020958  Vali Loss: 0.0066393 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 7.161729097366333
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0019812  Vali Loss: 0.0104139 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 7.1555421352386475
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0020479  Vali Loss: 0.0058799 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
new best score!!!!
Validation loss decreased (0.006163 --> 0.005880).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 40 cost time: 7.159767389297485
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0018547  Vali Loss: 0.0069727 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 7.164143800735474
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0018988  Vali Loss: 0.0073449 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 7.155964612960815
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0035548  Vali Loss: 0.0063041 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9960918 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 7.160284757614136
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0024300  Vali Loss: 0.0067743 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 7.1656410694122314
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0022499  Vali Loss: 0.0066502 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 45 cost time: 7.174226522445679
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0025397  Vali Loss: 0.0067202 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 46 cost time: 7.172951698303223
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0017565  Vali Loss: 0.0069350 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 47 cost time: 7.159229040145874
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0019027  Vali Loss: 0.0069091 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 48 cost time: 7.1587278842926025
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0018807  Vali Loss: 0.0071145 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 49 cost time: 7.161705493927002
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0016521  Vali Loss: 0.0071883 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 50 cost time: 7.162684440612793
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0016943  Vali Loss: 0.0071837 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 51 cost time: 7.162501811981201
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0021607  Vali Loss: 0.0071778 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 52 cost time: 7.165616512298584
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0017412  Vali Loss: 0.0072073 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 53 cost time: 7.157419919967651
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0018637  Vali Loss: 0.0072172 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 54 cost time: 7.165936470031738
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0016516  Vali Loss: 0.0072151 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8201754  Test weighted F1: 0.7850237  Test macro F1 0.7850237 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.603456497192383
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.7153369  Vali Loss: 0.4560338 Vali Accuracy: 0.9260652  Vali weighted F1: 0.9227005  Vali macro F1 0.9212340 
Validation loss decreased (inf --> 0.456034).  Saving model ...
Epoch: 2 cost time: 5.5496580600738525
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2954575  Vali Loss: 0.1383818 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9818462  Vali macro F1 0.9810511 
new best score!!!!
Validation loss decreased (0.456034 --> 0.138382).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.5496580600738525
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1197336  Vali Loss: 0.0674661 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872125  Vali macro F1 0.9868380 
new best score!!!!
Validation loss decreased (0.138382 --> 0.067466).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.547051429748535
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0677275  Vali Loss: 0.0511866 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.067466 --> 0.051187).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.546934127807617
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0530396  Vali Loss: 0.0415156 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.051187 --> 0.041516).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.554217576980591
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0369836  Vali Loss: 0.0284362 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.041516 --> 0.028436).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.555429220199585
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0239083  Vali Loss: 0.0249962 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.028436 --> 0.024996).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.547771453857422
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0206182  Vali Loss: 0.0229466 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
new best score!!!!
Validation loss decreased (0.024996 --> 0.022947).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.5486180782318115
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0168973  Vali Loss: 0.0187593 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.022947 --> 0.018759).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.5484230518341064
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0146689  Vali Loss: 0.0190080 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.545713186264038
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0128732  Vali Loss: 0.0211110 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.546927452087402
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0105729  Vali Loss: 0.0175760 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.018759 --> 0.017576).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.549484968185425
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0105491  Vali Loss: 0.0274317 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885177  Vali macro F1 0.9882566 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.552312135696411
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0143599  Vali Loss: 0.0164150 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.017576 --> 0.016415).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.549743175506592
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0101972  Vali Loss: 0.0134099 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924156  Vali macro F1 0.9922721 
new best score!!!!
Validation loss decreased (0.016415 --> 0.013410).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.554584741592407
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0094047  Vali Loss: 0.0163672 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.537755012512207
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0199695  Vali Loss: 0.0236870 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.544057846069336
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0118966  Vali Loss: 0.0164084 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.5464067459106445
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0082189  Vali Loss: 0.0181266 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.554748773574829
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0068003  Vali Loss: 0.0109270 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
new best score!!!!
Validation loss decreased (0.013410 --> 0.010927).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.544901371002197
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0205006  Vali Loss: 0.0311273 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.544721364974976
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0144991  Vali Loss: 0.0177951 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.54526948928833
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0132408  Vali Loss: 0.0215421 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.537735223770142
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0110668  Vali Loss: 0.0127078 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9960918 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.54267692565918
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0077449  Vali Loss: 0.0193669 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.542436122894287
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0079570  Vali Loss: 0.0157563 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911402  Vali macro F1 0.9909537 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.53746771812439
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0049150  Vali Loss: 0.0122233 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.533447742462158
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0046132  Vali Loss: 0.0119818 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.54073691368103
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0042407  Vali Loss: 0.0126433 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.538113594055176
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0036615  Vali Loss: 0.0119985 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 5.540670394897461
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0038228  Vali Loss: 0.0119684 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.535409688949585
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0037800  Vali Loss: 0.0120527 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.534038543701172
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0036858  Vali Loss: 0.0121080 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.530125856399536
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0039211  Vali Loss: 0.0121345 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.531529188156128
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0037385  Vali Loss: 0.0121381 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8254386  Test weighted F1: 0.7814669  Test macro F1 0.7814669 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.162558317184448
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0046191  Vali Loss: 0.0177809 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
Validation loss decreased (inf --> 0.017781).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.1573076248168945
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0037504  Vali Loss: 0.0181810 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.15522837638855
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0049965  Vali Loss: 0.0158249 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923879  Vali macro F1 0.9921759 
new best score!!!!
Validation loss decreased (0.017781 --> 0.015825).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.1495373249053955
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0035597  Vali Loss: 0.0151582 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923879  Vali macro F1 0.9921759 
new best score!!!!
Validation loss decreased (0.015825 --> 0.015158).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.151973724365234
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0029970  Vali Loss: 0.0144864 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.015158 --> 0.014486).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.153567790985107
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0027347  Vali Loss: 0.0148092 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.149089813232422
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0026233  Vali Loss: 0.0119229 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
new best score!!!!
Validation loss decreased (0.014486 --> 0.011923).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.1575281620025635
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0025663  Vali Loss: 0.0153055 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.152514457702637
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0022582  Vali Loss: 0.0131718 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 7.161795377731323
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0020863  Vali Loss: 0.0148876 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 7.164247751235962
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0023482  Vali Loss: 0.0128602 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 7.159015655517578
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0023334  Vali Loss: 0.0200631 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 7.158830642700195
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0024858  Vali Loss: 0.0132200 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.163905143737793
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0039914  Vali Loss: 0.0149592 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 7.164082050323486
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0025026  Vali Loss: 0.0125963 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 7.1665358543396
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0021458  Vali Loss: 0.0122919 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 7.160181522369385
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0021312  Vali Loss: 0.0109537 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
new best score!!!!
Validation loss decreased (0.011923 --> 0.010954).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 7.170836925506592
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0069178  Vali Loss: 0.0116423 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 7.166468858718872
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0043282  Vali Loss: 0.0203979 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 7.172410011291504
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0042514  Vali Loss: 0.0212020 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 7.166555404663086
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0024186  Vali Loss: 0.0158148 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 7.1680519580841064
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024710  Vali Loss: 0.0147666 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 7.164483070373535
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0034544  Vali Loss: 0.0148610 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 7.162789583206177
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0020752  Vali Loss: 0.0152293 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 7.169355869293213
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0021196  Vali Loss: 0.0153874 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 7.168222188949585
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018268  Vali Loss: 0.0154205 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 7.168162822723389
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0021305  Vali Loss: 0.0154233 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 7.172415256500244
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0021110  Vali Loss: 0.0154053 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 7.1652140617370605
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0019215  Vali Loss: 0.0154210 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 7.172361135482788
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0019100  Vali Loss: 0.0154355 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 7.172049045562744
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0020008  Vali Loss: 0.0154387 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 7.164679050445557
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0020428  Vali Loss: 0.0154604 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8350877  Test weighted F1: 0.7912070  Test macro F1 0.7912070 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.626657485961914
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.7080177  Vali Loss: 0.4488651 Vali Accuracy: 0.9348371  Vali weighted F1: 0.9307886  Vali macro F1 0.9291687 
Validation loss decreased (inf --> 0.448865).  Saving model ...
Epoch: 2 cost time: 5.543870210647583
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3049685  Vali Loss: 0.1339564 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9844264  Vali macro F1 0.9842382 
new best score!!!!
Validation loss decreased (0.448865 --> 0.133956).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.553116083145142
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1234887  Vali Loss: 0.0693521 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872666  Vali macro F1 0.9870066 
new best score!!!!
Validation loss decreased (0.133956 --> 0.069352).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.560409307479858
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0727093  Vali Loss: 0.0506647 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911349  Vali macro F1 0.9910793 
new best score!!!!
Validation loss decreased (0.069352 --> 0.050665).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.558612108230591
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0481758  Vali Loss: 0.0394174 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885627  Vali macro F1 0.9884239 
new best score!!!!
Validation loss decreased (0.050665 --> 0.039417).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.553518056869507
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0360254  Vali Loss: 0.0269339 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936864  Vali macro F1 0.9936802 
new best score!!!!
Validation loss decreased (0.039417 --> 0.026934).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.555471181869507
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0277173  Vali Loss: 0.0215867 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949880  Vali macro F1 0.9949674 
new best score!!!!
Validation loss decreased (0.026934 --> 0.021587).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.5505149364471436
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0296848  Vali Loss: 0.0227724 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911354  Vali macro F1 0.9910419 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.546879768371582
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0250018  Vali Loss: 0.0304286 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885186  Vali macro F1 0.9881833 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 10 cost time: 5.545101642608643
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0441567  Vali Loss: 0.0272842 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949584  Vali macro F1 0.9949693 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 11 cost time: 5.541304588317871
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0288659  Vali Loss: 0.0249775 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949570  Vali macro F1 0.9949960 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 12 cost time: 5.542888641357422
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0222467  Vali Loss: 0.0199178 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936860  Vali macro F1 0.9937175 
new best score!!!!
Validation loss decreased (0.021587 --> 0.019918).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.542864799499512
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0173617  Vali Loss: 0.0199737 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924130  Vali macro F1 0.9923626 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.539477348327637
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0238566  Vali Loss: 0.0198009 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962253  Vali macro F1 0.9963485 
new best score!!!!
Validation loss decreased (0.019918 --> 0.019801).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.543872117996216
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0238810  Vali Loss: 0.0214801 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924130  Vali macro F1 0.9923626 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.5423054695129395
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0168282  Vali Loss: 0.0157077 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
new best score!!!!
Validation loss decreased (0.019801 --> 0.015708).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.541837930679321
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0147731  Vali Loss: 0.0187164 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949570  Vali macro F1 0.9949960 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.537307024002075
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0151231  Vali Loss: 0.0237158 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899307  Vali macro F1 0.9897589 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.539320468902588
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0243270  Vali Loss: 0.0208296 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937053  Vali macro F1 0.9936555 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.540818452835083
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0162742  Vali Loss: 0.0136923 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949570  Vali macro F1 0.9949960 
new best score!!!!
Validation loss decreased (0.015708 --> 0.013692).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.5388572216033936
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0100980  Vali Loss: 0.0076904 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
new best score!!!!
Validation loss decreased (0.013692 --> 0.007690).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.54237174987793
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0087165  Vali Loss: 0.0084520 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949570  Vali macro F1 0.9949960 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.538011312484741
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0078345  Vali Loss: 0.0083797 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962412  Vali macro F1 0.9962634 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.5416224002838135
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0125937  Vali Loss: 0.0272508 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911684  Vali macro F1 0.9908695 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.5403056144714355
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0107972  Vali Loss: 0.0088693 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.5395543575286865
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0079016  Vali Loss: 0.0108662 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 5.537698268890381
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0058832  Vali Loss: 0.0106979 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.538036823272705
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0052117  Vali Loss: 0.0103444 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.539683818817139
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0049975  Vali Loss: 0.0105812 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 5.538887023925781
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0050834  Vali Loss: 0.0101412 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 5.532876491546631
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0044632  Vali Loss: 0.0094986 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 32 cost time: 5.532857418060303
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0043416  Vali Loss: 0.0094841 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.534320831298828
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0043505  Vali Loss: 0.0094962 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.541485548019409
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0046073  Vali Loss: 0.0094578 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.533806800842285
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0044772  Vali Loss: 0.0094332 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.535288095474243
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0041621  Vali Loss: 0.0094411 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9359649  Test weighted F1: 0.9341980  Test macro F1 0.9341980 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.191189765930176
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0074585  Vali Loss: 0.0075179 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
Validation loss decreased (inf --> 0.007518).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.190143823623657
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0056835  Vali Loss: 0.0066019 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
new best score!!!!
Validation loss decreased (0.007518 --> 0.006602).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.187304735183716
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0048187  Vali Loss: 0.0060935 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
new best score!!!!
Validation loss decreased (0.006602 --> 0.006093).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.196452379226685
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0048842  Vali Loss: 0.0056962 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
new best score!!!!
Validation loss decreased (0.006093 --> 0.005696).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.190472602844238
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0043218  Vali Loss: 0.0066920 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 7.201961040496826
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0036924  Vali Loss: 0.0062185 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 7.196280002593994
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0032450  Vali Loss: 0.0065283 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 7.19913649559021
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0038800  Vali Loss: 0.0071284 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 7.195729970932007
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0036313  Vali Loss: 0.0055335 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962412  Vali macro F1 0.9962634 
new best score!!!!
Validation loss decreased (0.005696 --> 0.005533).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 7.196445941925049
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0027594  Vali Loss: 0.0046354 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
new best score!!!!
Validation loss decreased (0.005533 --> 0.004635).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 7.191680431365967
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0026300  Vali Loss: 0.0049161 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.181989431381226
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0027465  Vali Loss: 0.0053402 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 7.187028408050537
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0028375  Vali Loss: 0.0050257 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962412  Vali macro F1 0.9962634 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 7.183735370635986
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0022938  Vali Loss: 0.0044015 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962412  Vali macro F1 0.9962634 
new best score!!!!
Validation loss decreased (0.004635 --> 0.004401).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 7.191864252090454
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0020954  Vali Loss: 0.0064752 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9962570 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 7.191900014877319
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0021855  Vali Loss: 0.0048922 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962407  Vali macro F1 0.9963007 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 7.194544315338135
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0018200  Vali Loss: 0.0042494 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
new best score!!!!
Validation loss decreased (0.004401 --> 0.004249).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 7.18257999420166
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0018914  Vali Loss: 0.0040471 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
new best score!!!!
Validation loss decreased (0.004249 --> 0.004047).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 7.192371129989624
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0015680  Vali Loss: 0.0036570 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
new best score!!!!
Validation loss decreased (0.004047 --> 0.003657).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 7.19102668762207
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0018211  Vali Loss: 0.0046541 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962412  Vali macro F1 0.9962634 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 7.188973426818848
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0030114  Vali Loss: 0.0057599 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961432 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 7.191409349441528
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024424  Vali Loss: 0.0056808 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 7.195192337036133
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0022920  Vali Loss: 0.0055161 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961432 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 7.1959779262542725
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0018497  Vali Loss: 0.0058097 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961432 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 25 cost time: 7.205050945281982
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0018203  Vali Loss: 0.0056255 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949726  Vali macro F1 0.9950092 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 7.204181432723999
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0016046  Vali Loss: 0.0041642 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 7.207228422164917
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0017353  Vali Loss: 0.0037337 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 7.202835559844971
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0019298  Vali Loss: 0.0060704 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963244 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 7.1968255043029785
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0012776  Vali Loss: 0.0058431 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963244 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 30 cost time: 7.203663349151611
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0013969  Vali Loss: 0.0060379 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963244 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 7.198772668838501
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0011941  Vali Loss: 0.0061080 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963244 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 7.211076974868774
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0014005  Vali Loss: 0.0060813 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963244 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 7.207740783691406
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0011346  Vali Loss: 0.0059945 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963244 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 7.20419979095459
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0012050  Vali Loss: 0.0055027 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9975633 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9377193  Test weighted F1: 0.9363766  Test macro F1 0.9363766 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.634695768356323
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.7014074  Vali Loss: 0.4603938 Vali Accuracy: 0.9110276  Vali weighted F1: 0.9002262  Vali macro F1 0.8995535 
Validation loss decreased (inf --> 0.460394).  Saving model ...
Epoch: 2 cost time: 5.570817470550537
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2921884  Vali Loss: 0.1524265 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9819670  Vali macro F1 0.9813223 
new best score!!!!
Validation loss decreased (0.460394 --> 0.152426).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.572520971298218
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1159303  Vali Loss: 0.0732422 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860288  Vali macro F1 0.9855642 
new best score!!!!
Validation loss decreased (0.152426 --> 0.073242).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.5680012702941895
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0683719  Vali Loss: 0.0492549 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9833815  Vali macro F1 0.9828444 
new best score!!!!
Validation loss decreased (0.073242 --> 0.049255).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.569120645523071
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0487835  Vali Loss: 0.0397372 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887046  Vali macro F1 0.9882970 
new best score!!!!
Validation loss decreased (0.049255 --> 0.039737).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.5640504360198975
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0410062  Vali Loss: 0.0312566 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.039737 --> 0.031257).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.571323394775391
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0297945  Vali Loss: 0.0348227 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.566730976104736
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0253789  Vali Loss: 0.0265684 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885177  Vali macro F1 0.9882566 
new best score!!!!
Validation loss decreased (0.031257 --> 0.026568).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.565830230712891
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0204234  Vali Loss: 0.0194268 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.026568 --> 0.019427).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.5701305866241455
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0165605  Vali Loss: 0.0234377 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.56329345703125
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0159312  Vali Loss: 0.0208670 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.566625356674194
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0155426  Vali Loss: 0.0194119 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.019427 --> 0.019412).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.572729110717773
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0174730  Vali Loss: 0.0239183 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.565692663192749
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0144545  Vali Loss: 0.0134956 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.019412 --> 0.013496).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.557636260986328
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0204166  Vali Loss: 0.0194339 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.554121971130371
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0124462  Vali Loss: 0.0220364 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.561589002609253
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0118727  Vali Loss: 0.0202435 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 5.554219007492065
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0111542  Vali Loss: 0.0149825 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 19 cost time: 5.562990665435791
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0097119  Vali Loss: 0.0171762 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 20 cost time: 5.56533670425415
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0078890  Vali Loss: 0.0119635 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.013496 --> 0.011963).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.560046195983887
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0069896  Vali Loss: 0.0118071 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.011963 --> 0.011807).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.557528495788574
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0064479  Vali Loss: 0.0128189 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.552173137664795
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0062604  Vali Loss: 0.0117096 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.011807 --> 0.011710).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.556094408035278
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0053994  Vali Loss: 0.0122576 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.551478147506714
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0053957  Vali Loss: 0.0101439 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.011710 --> 0.010144).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.5542237758636475
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0051667  Vali Loss: 0.0110940 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.553603649139404
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0048864  Vali Loss: 0.0097571 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.010144 --> 0.009757).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.553143262863159
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0048475  Vali Loss: 0.0126870 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.5517799854278564
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0047162  Vali Loss: 0.0103848 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.551706314086914
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0042904  Vali Loss: 0.0096875 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.009757 --> 0.009687).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.554287433624268
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0039854  Vali Loss: 0.0101260 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.5561816692352295
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0038735  Vali Loss: 0.0101577 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.553778886795044
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0039354  Vali Loss: 0.0104873 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.551243305206299
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0039361  Vali Loss: 0.0114079 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.550704717636108
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0035878  Vali Loss: 0.0117876 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 36 cost time: 5.550405025482178
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0035168  Vali Loss: 0.0115488 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.555024147033691
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0034769  Vali Loss: 0.0114746 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.5577661991119385
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0035453  Vali Loss: 0.0110820 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.560647487640381
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0034952  Vali Loss: 0.0108900 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 5.566473960876465
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0035868  Vali Loss: 0.0109493 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 41 cost time: 5.567267894744873
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0035183  Vali Loss: 0.0109250 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.558193922042847
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0032849  Vali Loss: 0.0108960 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.559651613235474
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0034044  Vali Loss: 0.0108833 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.5662925243377686
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0035093  Vali Loss: 0.0108470 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 5.560323715209961
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0033887  Vali Loss: 0.0108587 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9298246  Test weighted F1: 0.9108279  Test macro F1 0.9108279 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.221516370773315
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0045827  Vali Loss: 0.0086436 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
Validation loss decreased (inf --> 0.008644).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.207506418228149
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0040902  Vali Loss: 0.0094429 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.20831561088562
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0034696  Vali Loss: 0.0099515 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.207990884780884
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0031700  Vali Loss: 0.0106698 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 7.201657772064209
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0032694  Vali Loss: 0.0143344 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 7.200762748718262
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0029285  Vali Loss: 0.0114397 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.208192348480225
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0028685  Vali Loss: 0.0074383 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.008644 --> 0.007438).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.215582609176636
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0079122  Vali Loss: 0.0103784 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.207690238952637
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0041734  Vali Loss: 0.0140094 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 7.210540056228638
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0034107  Vali Loss: 0.0119069 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 7.2061851024627686
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0028653  Vali Loss: 0.0138949 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 7.20378565788269
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0040368  Vali Loss: 0.0169745 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 7.2072882652282715
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0044233  Vali Loss: 0.0165089 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.200739145278931
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0026528  Vali Loss: 0.0159060 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 7.205299377441406
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0027012  Vali Loss: 0.0149744 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 7.199609994888306
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0025003  Vali Loss: 0.0140390 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 7.205344200134277
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0024286  Vali Loss: 0.0123356 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 18 cost time: 7.200606822967529
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0022610  Vali Loss: 0.0122824 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 7.1968159675598145
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0021934  Vali Loss: 0.0122557 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 7.204938650131226
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0021279  Vali Loss: 0.0121620 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 7.201215028762817
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0022229  Vali Loss: 0.0121925 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 7.204737424850464
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0021113  Vali Loss: 0.0121494 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9333333  Test weighted F1: 0.9123957  Test macro F1 0.9123957 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.62623405456543
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6905904  Vali Loss: 0.4320975 Vali Accuracy: 0.9423559  Vali weighted F1: 0.9398118  Vali macro F1 0.9374445 
Validation loss decreased (inf --> 0.432098).  Saving model ...
Epoch: 2 cost time: 5.545777082443237
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2978123  Vali Loss: 0.1395788 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885380  Vali macro F1 0.9883912 
new best score!!!!
Validation loss decreased (0.432098 --> 0.139579).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.549131870269775
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1215906  Vali Loss: 0.0717482 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859273  Vali macro F1 0.9854216 
new best score!!!!
Validation loss decreased (0.139579 --> 0.071748).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.555901050567627
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0679177  Vali Loss: 0.0418342 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949399  Vali macro F1 0.9949465 
new best score!!!!
Validation loss decreased (0.071748 --> 0.041834).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.557903051376343
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0455078  Vali Loss: 0.0291729 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936655  Vali macro F1 0.9934965 
new best score!!!!
Validation loss decreased (0.041834 --> 0.029173).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.559277772903442
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0350887  Vali Loss: 0.0224070 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.029173 --> 0.022407).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.557871103286743
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0232596  Vali Loss: 0.0170084 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.022407 --> 0.017008).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.561564207077026
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0203422  Vali Loss: 0.0139544 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.017008 --> 0.013954).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.559842824935913
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0167450  Vali Loss: 0.0104457 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.013954 --> 0.010446).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.557550668716431
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0145661  Vali Loss: 0.0121836 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.563420295715332
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0112185  Vali Loss: 0.0068311 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010446 --> 0.006831).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.554758787155151
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0101077  Vali Loss: 0.0109739 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962369  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.555424690246582
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0104535  Vali Loss: 0.0127144 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.553721189498901
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0175418  Vali Loss: 0.0162764 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911330  Vali macro F1 0.9907624 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.559208631515503
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0262959  Vali Loss: 0.0124850 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 16 cost time: 5.557241201400757
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0118922  Vali Loss: 0.0077092 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 17 cost time: 5.55797553062439
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0077133  Vali Loss: 0.0064609 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.006831 --> 0.006461).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.559952259063721
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0072621  Vali Loss: 0.0064693 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.557163953781128
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0062642  Vali Loss: 0.0061722 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.006461 --> 0.006172).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.564218997955322
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0055008  Vali Loss: 0.0071183 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.5598602294921875
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0052538  Vali Loss: 0.0067951 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.553961277008057
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0053122  Vali Loss: 0.0068625 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.554729700088501
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0051532  Vali Loss: 0.0070082 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.549836874008179
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0048113  Vali Loss: 0.0080383 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 25 cost time: 5.5579493045806885
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0044642  Vali Loss: 0.0080119 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.562938928604126
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0043516  Vali Loss: 0.0079487 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.554434537887573
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0043628  Vali Loss: 0.0077654 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.551252126693726
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0040715  Vali Loss: 0.0076381 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.548926591873169
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0042206  Vali Loss: 0.0076230 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 30 cost time: 5.553515672683716
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0044132  Vali Loss: 0.0076323 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.546812295913696
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0042050  Vali Loss: 0.0076354 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.549522876739502
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0043141  Vali Loss: 0.0076241 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.555673599243164
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0041284  Vali Loss: 0.0076071 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 5.54397988319397
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0043800  Vali Loss: 0.0076230 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8543860  Test weighted F1: 0.8289866  Test macro F1 0.8289866 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.1989946365356445
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0053911  Vali Loss: 0.0059407 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
Validation loss decreased (inf --> 0.005941).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.209913730621338
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0049243  Vali Loss: 0.0038906 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.005941 --> 0.003891).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.207897663116455
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0050261  Vali Loss: 0.0070999 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.2008216381073
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0030074  Vali Loss: 0.0074934 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 7.211139440536499
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0029353  Vali Loss: 0.0057402 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 7.206207036972046
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0025326  Vali Loss: 0.0048794 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 7.213044166564941
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0028573  Vali Loss: 0.0032919 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.003891 --> 0.003292).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.210901737213135
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0019935  Vali Loss: 0.0020644 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003292 --> 0.002064).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.210910320281982
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0016289  Vali Loss: 0.0035679 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.210981369018555
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0015166  Vali Loss: 0.0035157 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.215784549713135
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0015902  Vali Loss: 0.0055509 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974928  Vali macro F1 0.9974584 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 7.207046747207642
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0015564  Vali Loss: 0.0057150 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 7.212096452713013
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0011566  Vali Loss: 0.0045582 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 7.206484079360962
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0010848  Vali Loss: 0.0052690 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.2115161418914795
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0007461  Vali Loss: 0.0036263 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.209719657897949
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0007086  Vali Loss: 0.0036744 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.2312233448028564
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0008118  Vali Loss: 0.0095333 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962369  Vali macro F1 0.9961524 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.207316160202026
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0011327  Vali Loss: 0.0010483 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002064 --> 0.001048).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 7.2102861404418945
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0008850  Vali Loss: 0.0014937 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.212218284606934
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0007174  Vali Loss: 0.0004985 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001048 --> 0.000498).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 7.209527254104614
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0006687  Vali Loss: 0.0010362 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 7.216634511947632
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0006083  Vali Loss: 0.0007534 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 7.211495399475098
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0005226  Vali Loss: 0.0022529 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 7.207760572433472
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0004889  Vali Loss: 0.0008191 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 7.2185447216033936
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0004353  Vali Loss: 0.0003104 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000498 --> 0.000310).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 7.208336591720581
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0003547  Vali Loss: 0.0003257 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 8.670780181884766
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0049380  Vali Loss: 0.0046300 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 7.238649606704712
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0019041  Vali Loss: 0.0036147 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 7.20475959777832
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0008965  Vali Loss: 0.0054249 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 7.198955059051514
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0008605  Vali Loss: 0.0027678 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 7.197427272796631
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0005188  Vali Loss: 0.0029762 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 7.201566696166992
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0005768  Vali Loss: 0.0029086 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 7.242315292358398
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0005063  Vali Loss: 0.0028761 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 7.3749284744262695
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0005874  Vali Loss: 0.0028085 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 7.208577871322632
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0004798  Vali Loss: 0.0027775 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 36 cost time: 7.19510293006897
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0005159  Vali Loss: 0.0027787 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 7.1913440227508545
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0005040  Vali Loss: 0.0027756 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 7.185409069061279
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0004657  Vali Loss: 0.0027780 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 7.200314283370972
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0005965  Vali Loss: 0.0027710 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 7.196128845214844
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0005319  Vali Loss: 0.0027793 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8447368  Test weighted F1: 0.8229915  Test macro F1 0.8229915 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1618428
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 8.517734289169312
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6325533  Vali Loss: 0.4939711 Vali Accuracy: 0.9223058  Vali weighted F1: 0.9175452  Vali macro F1 0.9150467 
Validation loss decreased (inf --> 0.493971).  Saving model ...
Epoch: 2 cost time: 5.4732325077056885
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3133928  Vali Loss: 0.1882851 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9729330  Vali macro F1 0.9727035 
new best score!!!!
Validation loss decreased (0.493971 --> 0.188285).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.480209112167358
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1395816  Vali Loss: 0.0940616 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9870530  Vali macro F1 0.9870066 
new best score!!!!
Validation loss decreased (0.188285 --> 0.094062).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.491862058639526
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0879642  Vali Loss: 0.0653489 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886684  Vali macro F1 0.9888895 
new best score!!!!
Validation loss decreased (0.094062 --> 0.065349).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.4937074184417725
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0617842  Vali Loss: 0.0501917 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910739  Vali macro F1 0.9912058 
new best score!!!!
Validation loss decreased (0.065349 --> 0.050192).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.490984201431274
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0451495  Vali Loss: 0.0437705 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875205  Vali macro F1 0.9877850 
new best score!!!!
Validation loss decreased (0.050192 --> 0.043771).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.5046067237854
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0397270  Vali Loss: 0.0313097 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937204  Vali macro F1 0.9937981 
new best score!!!!
Validation loss decreased (0.043771 --> 0.031310).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.505626678466797
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0315223  Vali Loss: 0.0301664 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
new best score!!!!
Validation loss decreased (0.031310 --> 0.030166).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.512311220169067
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0266784  Vali Loss: 0.0326947 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861370  Vali macro F1 0.9862968 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.51064658164978
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0248577  Vali Loss: 0.0370585 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874068  Vali macro F1 0.9875684 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.5285422801971436
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0273550  Vali Loss: 0.0225528 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911915  Vali macro F1 0.9911757 
new best score!!!!
Validation loss decreased (0.030166 --> 0.022553).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.529148817062378
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0196933  Vali Loss: 0.0186209 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.022553 --> 0.018621).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.537621974945068
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0192798  Vali Loss: 0.0146095 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
new best score!!!!
Validation loss decreased (0.018621 --> 0.014609).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.54229211807251
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0173924  Vali Loss: 0.0121681 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.014609 --> 0.012168).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.546569347381592
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0143419  Vali Loss: 0.0119419 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
new best score!!!!
Validation loss decreased (0.012168 --> 0.011942).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.5450499057769775
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0137076  Vali Loss: 0.0149475 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.549574613571167
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0129180  Vali Loss: 0.0189061 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974937 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.548877716064453
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0141381  Vali Loss: 0.0198225 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924556  Vali macro F1 0.9924641 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.551332950592041
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0149561  Vali Loss: 0.0085595 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.011942 --> 0.008559).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.554271936416626
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0104690  Vali Loss: 0.0084709 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.008559 --> 0.008471).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.554670572280884
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0088184  Vali Loss: 0.0104219 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.55701470375061
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0085061  Vali Loss: 0.0094497 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9949761 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.561577796936035
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0081993  Vali Loss: 0.0113302 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.55886435508728
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0071426  Vali Loss: 0.0093817 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.553499698638916
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0078561  Vali Loss: 0.0066280 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.008471 --> 0.006628).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.556685924530029
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0109202  Vali Loss: 0.0283962 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898596  Vali macro F1 0.9898308 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.559715986251831
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0157943  Vali Loss: 0.0125103 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.553107500076294
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0137949  Vali Loss: 0.0122390 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.682729482650757
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0105077  Vali Loss: 0.0095337 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.5555195808410645
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0077159  Vali Loss: 0.0059214 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006628 --> 0.005921).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.556422472000122
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0055366  Vali Loss: 0.0058817 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.005921 --> 0.005882).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.553881645202637
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0046066  Vali Loss: 0.0038107 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005882 --> 0.003811).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.563464879989624
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0079683  Vali Loss: 0.0063279 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.554934024810791
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0072519  Vali Loss: 0.0105485 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.5518882274627686
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0065985  Vali Loss: 0.0049284 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.5540735721588135
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0051383  Vali Loss: 0.0045424 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.562265634536743
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0067717  Vali Loss: 0.0127471 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949880  Vali macro F1 0.9950172 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 5.550204277038574
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0076983  Vali Loss: 0.0049401 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.5526745319366455
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0048523  Vali Loss: 0.0039691 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.54670262336731
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0053959  Vali Loss: 0.0037062 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003811 --> 0.003706).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.555519342422485
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0038142  Vali Loss: 0.0041079 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.54521632194519
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0034720  Vali Loss: 0.0036830 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003706 --> 0.003683).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.549870729446411
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0035939  Vali Loss: 0.0032727 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003683 --> 0.003273).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.554462671279907
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0031853  Vali Loss: 0.0030511 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003273 --> 0.003051).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.559205055236816
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0030314  Vali Loss: 0.0031558 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.5521416664123535
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0030298  Vali Loss: 0.0030631 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.562110424041748
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0030182  Vali Loss: 0.0030296 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003051 --> 0.003030).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 5.562553882598877
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0026664  Vali Loss: 0.0031947 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.560612916946411
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0031496  Vali Loss: 0.0032753 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.55845308303833
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0028470  Vali Loss: 0.0033867 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.557388782501221
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0026457  Vali Loss: 0.0032137 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 5.556821823120117
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0027570  Vali Loss: 0.0026947 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003030 --> 0.002695).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 5.553002119064331
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0025564  Vali Loss: 0.0030013 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 5.554895877838135
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0024800  Vali Loss: 0.0031579 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 5.5536603927612305
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0023800  Vali Loss: 0.0030334 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 5.5552659034729
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0025736  Vali Loss: 0.0030918 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 5.553568601608276
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0025593  Vali Loss: 0.0028815 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 58 cost time: 5.551481485366821
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0022318  Vali Loss: 0.0028566 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 5.547042608261108
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0024255  Vali Loss: 0.0028900 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 5.547259569168091
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0023832  Vali Loss: 0.0028492 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 5.5527284145355225
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0021341  Vali Loss: 0.0028508 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 5.554986476898193
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0023711  Vali Loss: 0.0028560 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 63 cost time: 5.557313680648804
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0023768  Vali Loss: 0.0028610 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 5.556988000869751
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0021984  Vali Loss: 0.0028629 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 5.55647349357605
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0021966  Vali Loss: 0.0028635 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 5.557184934616089
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0022956  Vali Loss: 0.0028629 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 5.553156137466431
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0022778  Vali Loss: 0.0028602 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8526316  Test weighted F1: 0.8359371  Test macro F1 0.8359371 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.221404552459717
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0024538  Vali Loss: 0.0018470 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.001847).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.173090219497681
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0024130  Vali Loss: 0.0021653 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.171969890594482
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0022926  Vali Loss: 0.0039143 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.174171209335327
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0022451  Vali Loss: 0.0040800 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 7.161426305770874
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0031665  Vali Loss: 0.0020513 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 7.164089918136597
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0018899  Vali Loss: 0.0013319 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001847 --> 0.001332).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.1786134243011475
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0019409  Vali Loss: 0.0019894 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.173710823059082
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0018048  Vali Loss: 0.0029823 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 7.1746697425842285
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031066  Vali Loss: 0.0019551 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 7.181541204452515
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0020282  Vali Loss: 0.0044534 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 7.183439254760742
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0020737  Vali Loss: 0.0025047 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 12 cost time: 7.186059951782227
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0020853  Vali Loss: 0.0023070 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.179877996444702
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0014001  Vali Loss: 0.0022339 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 7.185319900512695
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0014300  Vali Loss: 0.0021037 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 7.174795150756836
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0015181  Vali Loss: 0.0020971 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 7.187408685684204
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0015789  Vali Loss: 0.0018868 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 17 cost time: 7.18252420425415
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0015343  Vali Loss: 0.0018765 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.180726051330566
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0014342  Vali Loss: 0.0018766 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.175652742385864
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0013091  Vali Loss: 0.0018710 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.181678533554077
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0014289  Vali Loss: 0.0018671 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.178426504135132
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0018314  Vali Loss: 0.0018463 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8517544  Test weighted F1: 0.8343688  Test macro F1 0.8343688 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.632436513900757
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6291435  Vali Loss: 0.4757346 Vali Accuracy: 0.9223058  Vali weighted F1: 0.9171082  Vali macro F1 0.9156940 
Validation loss decreased (inf --> 0.475735).  Saving model ...
Epoch: 2 cost time: 5.578825950622559
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3214225  Vali Loss: 0.1748977 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9731133  Vali macro F1 0.9729671 
new best score!!!!
Validation loss decreased (0.475735 --> 0.174898).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.580796241760254
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1444737  Vali Loss: 0.0969663 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9765395  Vali macro F1 0.9764350 
new best score!!!!
Validation loss decreased (0.174898 --> 0.096966).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.574224472045898
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0937986  Vali Loss: 0.0680969 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860483  Vali macro F1 0.9862735 
new best score!!!!
Validation loss decreased (0.096966 --> 0.068097).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.5797483921051025
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0665700  Vali Loss: 0.0501574 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911901  Vali macro F1 0.9915111 
new best score!!!!
Validation loss decreased (0.068097 --> 0.050157).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.578428745269775
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0438878  Vali Loss: 0.0325123 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923998  Vali macro F1 0.9925381 
new best score!!!!
Validation loss decreased (0.050157 --> 0.032512).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.58149528503418
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0337262  Vali Loss: 0.0280832 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
new best score!!!!
Validation loss decreased (0.032512 --> 0.028083).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.575311183929443
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0285823  Vali Loss: 0.0278372 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923629  Vali macro F1 0.9924214 
new best score!!!!
Validation loss decreased (0.028083 --> 0.027837).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.574738264083862
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0251721  Vali Loss: 0.0249050 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937020  Vali macro F1 0.9937715 
new best score!!!!
Validation loss decreased (0.027837 --> 0.024905).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.580456495285034
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0248078  Vali Loss: 0.0184015 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936486  Vali macro F1 0.9937116 
new best score!!!!
Validation loss decreased (0.024905 --> 0.018402).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.575644254684448
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0190751  Vali Loss: 0.0184034 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923629  Vali macro F1 0.9924214 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.572248458862305
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0178423  Vali Loss: 0.0170000 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974937 
new best score!!!!
Validation loss decreased (0.018402 --> 0.017000).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.571812152862549
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0175706  Vali Loss: 0.0172870 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937020  Vali macro F1 0.9937715 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.570179224014282
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0176617  Vali Loss: 0.0142843 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.017000 --> 0.014284).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.568357706069946
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0170372  Vali Loss: 0.0133483 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
new best score!!!!
Validation loss decreased (0.014284 --> 0.013348).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.569959402084351
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0128952  Vali Loss: 0.0196292 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.572110891342163
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0132064  Vali Loss: 0.0124405 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937210  Vali macro F1 0.9937121 
new best score!!!!
Validation loss decreased (0.013348 --> 0.012441).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.570055723190308
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0134999  Vali Loss: 0.0182611 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937111  Vali macro F1 0.9938959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.572113037109375
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0147994  Vali Loss: 0.0130139 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.5715250968933105
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0111005  Vali Loss: 0.0071995 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.012441 --> 0.007200).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.575085878372192
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0108581  Vali Loss: 0.0125236 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949846 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.572639465332031
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0122171  Vali Loss: 0.0150480 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.5745439529418945
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0115253  Vali Loss: 0.0101111 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949846 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.567296504974365
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0145602  Vali Loss: 0.0120828 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.566432952880859
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0090162  Vali Loss: 0.0077450 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.568416357040405
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0062658  Vali Loss: 0.0069823 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.007200 --> 0.006982).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.566213607788086
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0060490  Vali Loss: 0.0065915 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.006982 --> 0.006592).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.5730695724487305
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0055390  Vali Loss: 0.0067485 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.567485809326172
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0053969  Vali Loss: 0.0071142 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.563856840133667
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0055030  Vali Loss: 0.0067266 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.568288564682007
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0050483  Vali Loss: 0.0068495 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.573276519775391
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0047465  Vali Loss: 0.0067425 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 5.573400259017944
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0047155  Vali Loss: 0.0067783 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.5781049728393555
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0046472  Vali Loss: 0.0066671 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.571776866912842
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0045210  Vali Loss: 0.0067047 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.57158899307251
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0046977  Vali Loss: 0.0066019 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.570701360702515
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0044688  Vali Loss: 0.0065362 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.006592 --> 0.006536).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.570837736129761
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0043499  Vali Loss: 0.0065110 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.006536 --> 0.006511).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.5699732303619385
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0049083  Vali Loss: 0.0064632 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.006511 --> 0.006463).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.5745155811309814
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0053922  Vali Loss: 0.0066517 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.569227695465088
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0051329  Vali Loss: 0.0066537 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.573894739151001
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0046465  Vali Loss: 0.0065781 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.575202941894531
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0067647  Vali Loss: 0.0066739 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.566967010498047
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0044809  Vali Loss: 0.0064273 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.006463 --> 0.006427).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.572763919830322
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0044593  Vali Loss: 0.0065092 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.565999746322632
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0046366  Vali Loss: 0.0065047 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.567494869232178
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0046277  Vali Loss: 0.0064537 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.570224761962891
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0043944  Vali Loss: 0.0064980 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.572821378707886
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0054151  Vali Loss: 0.0067600 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 5.564370155334473
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0044416  Vali Loss: 0.0067715 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.564411878585815
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0045421  Vali Loss: 0.0067710 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 5.565706253051758
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0046059  Vali Loss: 0.0067650 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 5.561176061630249
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0044088  Vali Loss: 0.0067701 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 5.566134691238403
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0046283  Vali Loss: 0.0067726 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 55 cost time: 5.5620644092559814
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0045781  Vali Loss: 0.0067728 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 5.566687822341919
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0043596  Vali Loss: 0.0067717 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 5.5684826374053955
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0044576  Vali Loss: 0.0067719 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 5.565966606140137
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0043263  Vali Loss: 0.0067712 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 5.559371709823608
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0045321  Vali Loss: 0.0067713 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9342105  Test weighted F1: 0.9166408  Test macro F1 0.9166408 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.241223573684692
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0044898  Vali Loss: 0.0077024 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
Validation loss decreased (inf --> 0.007702).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.190887689590454
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0049173  Vali Loss: 0.0064700 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.007702 --> 0.006470).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.234619379043579
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0037208  Vali Loss: 0.0057339 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.006470 --> 0.005734).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.201295852661133
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0034102  Vali Loss: 0.0047663 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.005734 --> 0.004766).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.237626314163208
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0035087  Vali Loss: 0.0046454 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.004766 --> 0.004645).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.1992528438568115
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0031547  Vali Loss: 0.0056589 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.2406532764434814
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0045196  Vali Loss: 0.0060921 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 7.195836782455444
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0045105  Vali Loss: 0.0075652 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 7.241250038146973
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0071524  Vali Loss: 0.0033253 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004645 --> 0.003325).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 7.200389623641968
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0034858  Vali Loss: 0.0041127 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 7.243656873703003
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0034854  Vali Loss: 0.0043556 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 7.205779552459717
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0028413  Vali Loss: 0.0037942 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 7.245797395706177
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0024594  Vali Loss: 0.0040063 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 7.200632572174072
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0024033  Vali Loss: 0.0034810 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 7.242125511169434
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0021699  Vali Loss: 0.0044997 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 7.194544315338135
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0022428  Vali Loss: 0.0040428 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 7.236583471298218
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0041968  Vali Loss: 0.0043293 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 7.212846517562866
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0053288  Vali Loss: 0.0176150 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912272  Vali macro F1 0.9913163 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 7.240833044052124
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0044305  Vali Loss: 0.0047691 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 7.1954264640808105
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0026757  Vali Loss: 0.0045997 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 7.246626377105713
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0025036  Vali Loss: 0.0045731 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 7.195833921432495
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0026306  Vali Loss: 0.0043176 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 7.236036062240601
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0023564  Vali Loss: 0.0043944 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 7.193339586257935
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0024163  Vali Loss: 0.0042782 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9219298  Test weighted F1: 0.9035897  Test macro F1 0.9035897 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.620282411575317
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6367501  Vali Loss: 0.4867420 Vali Accuracy: 0.9110276  Vali weighted F1: 0.9046474  Vali macro F1 0.9034719 
Validation loss decreased (inf --> 0.486742).  Saving model ...
Epoch: 2 cost time: 5.54170560836792
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3206433  Vali Loss: 0.1813586 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9719307  Vali macro F1 0.9716006 
new best score!!!!
Validation loss decreased (0.486742 --> 0.181359).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.545945644378662
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1426442  Vali Loss: 0.0938646 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9820112  Vali macro F1 0.9820572 
new best score!!!!
Validation loss decreased (0.181359 --> 0.093865).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.537129878997803
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0913699  Vali Loss: 0.0591086 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859772  Vali macro F1 0.9857561 
new best score!!!!
Validation loss decreased (0.093865 --> 0.059109).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.547235727310181
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0598662  Vali Loss: 0.0472795 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937376  Vali macro F1 0.9936433 
new best score!!!!
Validation loss decreased (0.059109 --> 0.047280).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.5470640659332275
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0458589  Vali Loss: 0.0336463 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950186  Vali macro F1 0.9950936 
new best score!!!!
Validation loss decreased (0.047280 --> 0.033646).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.544381618499756
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0409879  Vali Loss: 0.0365717 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9949761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.542591571807861
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0376837  Vali Loss: 0.0334709 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898979  Vali macro F1 0.9899033 
new best score!!!!
Validation loss decreased (0.033646 --> 0.033471).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.544084310531616
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0311458  Vali Loss: 0.0254876 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924555  Vali macro F1 0.9924426 
new best score!!!!
Validation loss decreased (0.033471 --> 0.025488).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.5390784740448
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0237611  Vali Loss: 0.0223107 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936787  Vali macro F1 0.9937449 
new best score!!!!
Validation loss decreased (0.025488 --> 0.022311).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.541788578033447
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0216175  Vali Loss: 0.0199647 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924555  Vali macro F1 0.9924426 
new best score!!!!
Validation loss decreased (0.022311 --> 0.019965).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.5409862995147705
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0195545  Vali Loss: 0.0203177 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912260  Vali macro F1 0.9914504 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.5406341552734375
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0172915  Vali Loss: 0.0133449 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
new best score!!!!
Validation loss decreased (0.019965 --> 0.013345).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.542676210403442
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0163007  Vali Loss: 0.0115550 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.013345 --> 0.011555).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.544316053390503
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0136488  Vali Loss: 0.0098998 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.011555 --> 0.009900).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.550814867019653
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0138576  Vali Loss: 0.0164160 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.537263870239258
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0183811  Vali Loss: 0.0145592 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962411  Vali macro F1 0.9961467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.532053709030151
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0190447  Vali Loss: 0.0131116 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949846 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.536437273025513
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0127804  Vali Loss: 0.0100873 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.537903308868408
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0123808  Vali Loss: 0.0361720 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860120  Vali macro F1 0.9860442 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 5.532736778259277
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0160534  Vali Loss: 0.0115529 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.53265905380249
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0095103  Vali Loss: 0.0077292 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.009900 --> 0.007729).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.536584377288818
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0078519  Vali Loss: 0.0067813 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007729 --> 0.006781).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.540514945983887
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0078449  Vali Loss: 0.0062637 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006781 --> 0.006264).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.535416841506958
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0074131  Vali Loss: 0.0059297 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006264 --> 0.005930).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.53507661819458
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0070291  Vali Loss: 0.0054517 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005930 --> 0.005452).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.539275646209717
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0082332  Vali Loss: 0.0052010 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005452 --> 0.005201).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.540285110473633
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0078561  Vali Loss: 0.0066009 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.545687437057495
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0066666  Vali Loss: 0.0064364 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.544096946716309
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0063254  Vali Loss: 0.0059731 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.550537347793579
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0060629  Vali Loss: 0.0059423 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.547096490859985
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0059131  Vali Loss: 0.0060613 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 5.549772024154663
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0057997  Vali Loss: 0.0058867 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.546928644180298
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0054719  Vali Loss: 0.0057682 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.543255805969238
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0060873  Vali Loss: 0.0057455 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.547961473464966
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0055797  Vali Loss: 0.0057054 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.5430989265441895
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0055527  Vali Loss: 0.0057002 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 38 cost time: 5.546018600463867
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0052637  Vali Loss: 0.0056871 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.540517807006836
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0083909  Vali Loss: 0.0056835 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.541761875152588
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0057143  Vali Loss: 0.0056866 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.538155794143677
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0056589  Vali Loss: 0.0056549 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.539876937866211
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0055139  Vali Loss: 0.0056406 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9385965  Test weighted F1: 0.9371419  Test macro F1 0.9371419 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.1758644580841064
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0065184  Vali Loss: 0.0046871 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
Validation loss decreased (inf --> 0.004687).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.174433946609497
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0053722  Vali Loss: 0.0039532 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004687 --> 0.003953).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.1775572299957275
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0052576  Vali Loss: 0.0039385 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003953 --> 0.003938).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.179769515991211
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0050385  Vali Loss: 0.0033949 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003938 --> 0.003395).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.171455144882202
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0058049  Vali Loss: 0.0048887 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 7.169098615646362
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0045084  Vali Loss: 0.0028896 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003395 --> 0.002890).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.170790672302246
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0042580  Vali Loss: 0.0025495 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.002890 --> 0.002549).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.1717517375946045
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0040520  Vali Loss: 0.0046926 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.174865961074829
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0035340  Vali Loss: 0.0023684 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002549 --> 0.002368).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 7.1711745262146
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0080260  Vali Loss: 0.0049385 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 7.168149471282959
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0066411  Vali Loss: 0.0036180 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 7.177484512329102
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0051182  Vali Loss: 0.0029358 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 7.173213005065918
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0053830  Vali Loss: 0.0033149 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 7.171866416931152
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0041439  Vali Loss: 0.0029372 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 7.162590742111206
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0034682  Vali Loss: 0.0040583 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 7.171250343322754
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0031598  Vali Loss: 0.0040749 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 7.173634767532349
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0030317  Vali Loss: 0.0030707 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 7.185994625091553
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0028361  Vali Loss: 0.0043449 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 7.177737474441528
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0034391  Vali Loss: 0.0018211 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002368 --> 0.001821).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 7.174250841140747
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0024482  Vali Loss: 0.0018992 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 7.176836252212524
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0026661  Vali Loss: 0.0019898 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 7.171023368835449
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024490  Vali Loss: 0.0021000 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 7.17193078994751
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0063638  Vali Loss: 0.0018308 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 7.170102119445801
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0032094  Vali Loss: 0.0060085 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 7.169636964797974
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0030415  Vali Loss: 0.0056411 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 7.169244289398193
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0032818  Vali Loss: 0.0051143 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 7.172004222869873
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0029952  Vali Loss: 0.0043812 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 7.170894384384155
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0028321  Vali Loss: 0.0039640 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 7.172023057937622
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0027296  Vali Loss: 0.0037374 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 7.172773122787476
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0027684  Vali Loss: 0.0037235 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 7.172684907913208
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0026107  Vali Loss: 0.0037114 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 7.169585466384888
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0029156  Vali Loss: 0.0036870 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 7.1765077114105225
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0024984  Vali Loss: 0.0036903 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 7.172086715698242
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0025929  Vali Loss: 0.0036896 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9543860  Test weighted F1: 0.9526860  Test macro F1 0.9526860 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.638157606124878
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6376896  Vali Loss: 0.5121469 Vali Accuracy: 0.8997494  Vali weighted F1: 0.8945233  Vali macro F1 0.8918649 
Validation loss decreased (inf --> 0.512147).  Saving model ...
Epoch: 2 cost time: 5.567434549331665
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3229261  Vali Loss: 0.1778479 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9671251  Vali macro F1 0.9667710 
new best score!!!!
Validation loss decreased (0.512147 --> 0.177848).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.5655012130737305
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1350087  Vali Loss: 0.0987136 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808749  Vali macro F1 0.9810591 
new best score!!!!
Validation loss decreased (0.177848 --> 0.098714).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.571106433868408
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0866760  Vali Loss: 0.0648453 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886935  Vali macro F1 0.9889095 
new best score!!!!
Validation loss decreased (0.098714 --> 0.064845).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.563202857971191
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0676890  Vali Loss: 0.0480310 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898706  Vali macro F1 0.9900823 
new best score!!!!
Validation loss decreased (0.064845 --> 0.048031).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.564613342285156
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0423745  Vali Loss: 0.0375442 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887650  Vali macro F1 0.9884794 
new best score!!!!
Validation loss decreased (0.048031 --> 0.037544).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.566803455352783
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0321000  Vali Loss: 0.0299767 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912075  Vali macro F1 0.9913481 
new best score!!!!
Validation loss decreased (0.037544 --> 0.029977).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.57036566734314
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0302054  Vali Loss: 0.0262520 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
new best score!!!!
Validation loss decreased (0.029977 --> 0.026252).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.564648151397705
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0248815  Vali Loss: 0.0198780 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
new best score!!!!
Validation loss decreased (0.026252 --> 0.019878).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.565101861953735
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0221873  Vali Loss: 0.0217763 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949527  Vali macro F1 0.9950219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.562049865722656
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0183851  Vali Loss: 0.0153793 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.019878 --> 0.015379).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.566086053848267
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0162880  Vali Loss: 0.0163460 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937809  Vali macro F1 0.9939403 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.562153100967407
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0179408  Vali Loss: 0.0144974 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
new best score!!!!
Validation loss decreased (0.015379 --> 0.014497).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.5649635791778564
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0123935  Vali Loss: 0.0165667 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937352  Vali macro F1 0.9937334 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.561645746231079
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0146790  Vali Loss: 0.0146305 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923629  Vali macro F1 0.9924214 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.5656585693359375
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0132509  Vali Loss: 0.0169029 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 5.557208061218262
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0106256  Vali Loss: 0.0107057 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.014497 --> 0.010706).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.565808296203613
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0138992  Vali Loss: 0.0318414 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837372  Vali macro F1 0.9838414 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.55492901802063
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0199468  Vali Loss: 0.0281583 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887455  Vali macro F1 0.9886290 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.5575549602508545
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0240493  Vali Loss: 0.0150737 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.553632497787476
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0126693  Vali Loss: 0.0134617 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949846 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.552034139633179
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0114052  Vali Loss: 0.0146619 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911996  Vali macro F1 0.9913053 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 5.555717706680298
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0089082  Vali Loss: 0.0073261 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.010706 --> 0.007326).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.553461074829102
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0075067  Vali Loss: 0.0077414 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.551998138427734
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0064555  Vali Loss: 0.0078186 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.551035404205322
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0064129  Vali Loss: 0.0072125 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.007326 --> 0.007213).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.557498216629028
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0058925  Vali Loss: 0.0072229 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.559169769287109
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0055045  Vali Loss: 0.0068004 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
new best score!!!!
Validation loss decreased (0.007213 --> 0.006800).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.559181213378906
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0054692  Vali Loss: 0.0060914 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974910  Vali macro F1 0.9972759 
new best score!!!!
Validation loss decreased (0.006800 --> 0.006091).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.554242372512817
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0056569  Vali Loss: 0.0074630 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.555028915405273
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0053067  Vali Loss: 0.0067046 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.551019191741943
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0051125  Vali Loss: 0.0061495 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.553476333618164
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0047806  Vali Loss: 0.0077335 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 5.549228191375732
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0046146  Vali Loss: 0.0065863 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 5.5507519245147705
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0044987  Vali Loss: 0.0068419 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.550883054733276
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0046970  Vali Loss: 0.0067056 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.550204038619995
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0045394  Vali Loss: 0.0066249 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 5.5548179149627686
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0043498  Vali Loss: 0.0066691 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 5.5553131103515625
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0046677  Vali Loss: 0.0063470 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 40 cost time: 5.547250270843506
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0051120  Vali Loss: 0.0063544 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.550110578536987
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0043748  Vali Loss: 0.0064106 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.550391674041748
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0042409  Vali Loss: 0.0064312 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.549999952316284
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0060992  Vali Loss: 0.0064227 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.55211615562439
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0044797  Vali Loss: 0.0063028 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7912281  Test weighted F1: 0.7317342  Test macro F1 0.7317342 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.13594651222229
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0054450  Vali Loss: 0.0083399 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
Validation loss decreased (inf --> 0.008340).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.1296141147613525
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0051085  Vali Loss: 0.0055015 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
new best score!!!!
Validation loss decreased (0.008340 --> 0.005501).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.126457214355469
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0042024  Vali Loss: 0.0045110 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005501 --> 0.004511).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.129793882369995
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0040424  Vali Loss: 0.0082529 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.128205060958862
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0037766  Vali Loss: 0.0076448 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 7.12763237953186
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0041519  Vali Loss: 0.0091848 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 7.126271486282349
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0037820  Vali Loss: 0.0080376 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949823  Vali macro F1 0.9949752 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 7.1231396198272705
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0031059  Vali Loss: 0.0087639 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949823  Vali macro F1 0.9949752 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 7.127761602401733
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031701  Vali Loss: 0.0088767 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.127629280090332
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0041695  Vali Loss: 0.0082298 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.129322052001953
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0030547  Vali Loss: 0.0043489 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004511 --> 0.004349).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.126763343811035
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0023595  Vali Loss: 0.0053479 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.131750822067261
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0034838  Vali Loss: 0.0116547 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949790  Vali macro F1 0.9951834 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 7.12414288520813
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0052223  Vali Loss: 0.0063696 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 7.1279520988464355
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0026111  Vali Loss: 0.0049212 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962533  Vali macro F1 0.9960382 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 7.124883651733398
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0023650  Vali Loss: 0.0048888 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 7.127924919128418
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0026658  Vali Loss: 0.0048505 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.133114337921143
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0025949  Vali Loss: 0.0046600 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.134577035903931
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0022723  Vali Loss: 0.0045001 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.135869264602661
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0021426  Vali Loss: 0.0044328 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.129555940628052
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0022947  Vali Loss: 0.0041662 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004349 --> 0.004166).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 7.1394922733306885
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0025395  Vali Loss: 0.0039417 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
new best score!!!!
Validation loss decreased (0.004166 --> 0.003942).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 7.13457727432251
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0020375  Vali Loss: 0.0040487 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 7.128359317779541
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0022042  Vali Loss: 0.0039369 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
new best score!!!!
Validation loss decreased (0.003942 --> 0.003937).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 7.135801076889038
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0019626  Vali Loss: 0.0042813 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 7.136002779006958
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0023570  Vali Loss: 0.0040494 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 7.132848501205444
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0019594  Vali Loss: 0.0039325 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
new best score!!!!
Validation loss decreased (0.003937 --> 0.003932).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 7.134601593017578
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0020619  Vali Loss: 0.0040164 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 7.1316938400268555
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0022480  Vali Loss: 0.0041239 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 7.14183783531189
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0020913  Vali Loss: 0.0043018 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 7.1367151737213135
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0020793  Vali Loss: 0.0041151 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 7.1444666385650635
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0025713  Vali Loss: 0.0041032 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 7.13678765296936
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0021878  Vali Loss: 0.0041703 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 7.140977144241333
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0021430  Vali Loss: 0.0041398 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 7.135471343994141
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0019944  Vali Loss: 0.0041024 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 7.129662990570068
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0021583  Vali Loss: 0.0041377 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 7.128304719924927
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0020437  Vali Loss: 0.0040848 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 38 cost time: 7.130993127822876
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0020833  Vali Loss: 0.0040876 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 7.136823415756226
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0021314  Vali Loss: 0.0040864 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 7.131784915924072
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0020785  Vali Loss: 0.0040878 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 7.1409125328063965
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0022156  Vali Loss: 0.0040891 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 7.135127782821655
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0021396  Vali Loss: 0.0040841 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7885965  Test weighted F1: 0.7237824  Test macro F1 0.7237824 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.633358955383301
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6317479  Vali Loss: 0.4984395 Vali Accuracy: 0.9160401  Vali weighted F1: 0.9124047  Vali macro F1 0.9117910 
Validation loss decreased (inf --> 0.498439).  Saving model ...
Epoch: 2 cost time: 5.572645902633667
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3224480  Vali Loss: 0.1860562 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9612104  Vali macro F1 0.9597081 
new best score!!!!
Validation loss decreased (0.498439 --> 0.186056).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.565256118774414
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1440786  Vali Loss: 0.0960537 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873784  Vali macro F1 0.9872428 
new best score!!!!
Validation loss decreased (0.186056 --> 0.096054).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.57009220123291
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0856477  Vali Loss: 0.0546236 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
new best score!!!!
Validation loss decreased (0.096054 --> 0.054624).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.568151235580444
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0554803  Vali Loss: 0.0409133 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925254  Vali macro F1 0.9926823 
new best score!!!!
Validation loss decreased (0.054624 --> 0.040913).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.568008661270142
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0400597  Vali Loss: 0.0314782 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
new best score!!!!
Validation loss decreased (0.040913 --> 0.031478).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.5662925243377686
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0313528  Vali Loss: 0.0273005 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949828  Vali macro F1 0.9948859 
new best score!!!!
Validation loss decreased (0.031478 --> 0.027301).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.574517011642456
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0271510  Vali Loss: 0.0231832 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.027301 --> 0.023183).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.5653932094573975
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0220990  Vali Loss: 0.0159399 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.023183 --> 0.015940).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.571885585784912
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0182817  Vali Loss: 0.0176615 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.568316459655762
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0212498  Vali Loss: 0.0173877 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.566488742828369
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0216999  Vali Loss: 0.0189241 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 13 cost time: 5.570104598999023
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0197544  Vali Loss: 0.0145854 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.015940 --> 0.014585).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.563621759414673
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0146211  Vali Loss: 0.0143557 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.014585 --> 0.014356).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.5676422119140625
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0162608  Vali Loss: 0.0176723 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937342  Vali macro F1 0.9937896 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.561073064804077
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0160238  Vali Loss: 0.0129363 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.014356 --> 0.012936).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.564831018447876
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0124078  Vali Loss: 0.0121022 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937387  Vali macro F1 0.9935582 
new best score!!!!
Validation loss decreased (0.012936 --> 0.012102).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.558745622634888
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0096493  Vali Loss: 0.0093333 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.012102 --> 0.009333).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.556209325790405
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0090590  Vali Loss: 0.0097237 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.555976867675781
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0127653  Vali Loss: 0.0123881 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.555354833602905
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0123335  Vali Loss: 0.0127375 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 5.553545236587524
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0097987  Vali Loss: 0.0113386 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949790  Vali macro F1 0.9951834 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 5.556803941726685
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0079692  Vali Loss: 0.0089150 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.009333 --> 0.008915).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.559551000595093
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0070754  Vali Loss: 0.0102985 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.564429998397827
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0065042  Vali Loss: 0.0069113 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.008915 --> 0.006911).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.569433927536011
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0061254  Vali Loss: 0.0051973 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.006911 --> 0.005197).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.563753604888916
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0056957  Vali Loss: 0.0062582 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.556833982467651
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0045792  Vali Loss: 0.0051576 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.005197 --> 0.005158).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.55880069732666
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0065837  Vali Loss: 0.0066614 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.551300525665283
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0077958  Vali Loss: 0.0089835 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.558332920074463
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0054046  Vali Loss: 0.0053863 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.550646543502808
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0044323  Vali Loss: 0.0044438 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005158 --> 0.004444).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.558588266372681
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0044339  Vali Loss: 0.0057479 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.549436092376709
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0058035  Vali Loss: 0.0158131 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937411  Vali macro F1 0.9938742 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.556031227111816
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0228632  Vali Loss: 0.0126682 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974934  Vali macro F1 0.9977028 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.54904842376709
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0094747  Vali Loss: 0.0238378 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887655  Vali macro F1 0.9892073 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.550894498825073
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0144067  Vali Loss: 0.0114870 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9964786 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 5.546435356140137
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0066336  Vali Loss: 0.0082440 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.54517674446106
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0049810  Vali Loss: 0.0076117 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.539655923843384
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0049996  Vali Loss: 0.0074866 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.542116165161133
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0049339  Vali Loss: 0.0061843 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.546678304672241
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0046373  Vali Loss: 0.0062368 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 5.5500781536102295
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0051773  Vali Loss: 0.0062132 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.552201986312866
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0038795  Vali Loss: 0.0060368 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 5.5503458976745605
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0039501  Vali Loss: 0.0060197 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 5.552270889282227
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0040807  Vali Loss: 0.0059805 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 5.548407554626465
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0040598  Vali Loss: 0.0058726 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987464  Vali macro F1 0.9989562 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8421053  Test weighted F1: 0.7992041  Test macro F1 0.7992041 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.181154251098633
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0034745  Vali Loss: 0.0050451 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962373  Vali macro F1 0.9964442 
Validation loss decreased (inf --> 0.005045).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.185999393463135
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0032202  Vali Loss: 0.0043086 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.005045 --> 0.004309).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.182608604431152
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0030658  Vali Loss: 0.0044015 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.182408332824707
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0027947  Vali Loss: 0.0042739 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.004309 --> 0.004274).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.184759616851807
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0023553  Vali Loss: 0.0032939 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
new best score!!!!
Validation loss decreased (0.004274 --> 0.003294).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.182651042938232
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0023431  Vali Loss: 0.0026760 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003294 --> 0.002676).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.190927982330322
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0026071  Vali Loss: 0.0036518 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.187766075134277
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0023586  Vali Loss: 0.0033632 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 7.181484222412109
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0019897  Vali Loss: 0.0033235 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 7.184753656387329
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0034729  Vali Loss: 0.0020791 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.002676 --> 0.002079).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 7.186202764511108
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0032462  Vali Loss: 0.0036068 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.182591915130615
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0021138  Vali Loss: 0.0039279 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987445  Vali macro F1 0.9985305 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 7.182905435562134
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0017385  Vali Loss: 0.0033199 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974910  Vali macro F1 0.9972759 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 7.193137168884277
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0025655  Vali Loss: 0.0011488 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002079 --> 0.001149).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 7.187889814376831
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0022446  Vali Loss: 0.0011443 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001149 --> 0.001144).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 7.18363094329834
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0017742  Vali Loss: 0.0015223 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 7.18156099319458
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0019469  Vali Loss: 0.0012665 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 7.188482284545898
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0017003  Vali Loss: 0.0010082 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001144 --> 0.001008).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 7.180548667907715
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0018470  Vali Loss: 0.0014826 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.1762471199035645
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0015782  Vali Loss: 0.0016212 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 7.181265592575073
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0011750  Vali Loss: 0.0014667 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 7.177180290222168
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0016367  Vali Loss: 0.0013294 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 7.194756031036377
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0017300  Vali Loss: 0.0013092 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 24 cost time: 7.182077169418335
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0013016  Vali Loss: 0.0041193 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 7.178732395172119
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0022003  Vali Loss: 0.0041588 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 7.176717519760132
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0030466  Vali Loss: 0.0014299 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 7.177367210388184
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0017361  Vali Loss: 0.0021122 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987464  Vali macro F1 0.9989562 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 7.189846754074097
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0017558  Vali Loss: 0.0087491 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 29 cost time: 7.187018394470215
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0058769  Vali Loss: 0.0021793 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 7.182461261749268
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0021196  Vali Loss: 0.0021922 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 7.192666530609131
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0016195  Vali Loss: 0.0021600 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977014 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 7.180643558502197
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0014331  Vali Loss: 0.0020441 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987464  Vali macro F1 0.9989562 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 7.179008722305298
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0013069  Vali Loss: 0.0020318 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987464  Vali macro F1 0.9989562 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8631579  Test weighted F1: 0.8308811  Test macro F1 0.8308811 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.668730974197388
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6448246  Vali Loss: 0.4934365 Vali Accuracy: 0.9097744  Vali weighted F1: 0.9045390  Vali macro F1 0.9034449 
Validation loss decreased (inf --> 0.493436).  Saving model ...
Epoch: 2 cost time: 5.570672035217285
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3129926  Vali Loss: 0.1704116 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9600651  Vali macro F1 0.9598860 
new best score!!!!
Validation loss decreased (0.493436 --> 0.170412).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.562851428985596
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1380282  Vali Loss: 0.0931394 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9780288  Vali macro F1 0.9779951 
new best score!!!!
Validation loss decreased (0.170412 --> 0.093139).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.573009729385376
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0823391  Vali Loss: 0.0504912 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923629  Vali macro F1 0.9924214 
new best score!!!!
Validation loss decreased (0.093139 --> 0.050491).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.579187631607056
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0574290  Vali Loss: 0.0432386 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899281  Vali macro F1 0.9899270 
new best score!!!!
Validation loss decreased (0.050491 --> 0.043239).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.57507586479187
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0434238  Vali Loss: 0.0317330 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924555  Vali macro F1 0.9924426 
new best score!!!!
Validation loss decreased (0.043239 --> 0.031733).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.582751512527466
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0353351  Vali Loss: 0.0339928 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923036  Vali macro F1 0.9925075 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.575937747955322
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0284528  Vali Loss: 0.0273937 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898181  Vali macro F1 0.9898026 
new best score!!!!
Validation loss decreased (0.031733 --> 0.027394).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.579094171524048
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0249383  Vali Loss: 0.0238264 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962416  Vali macro F1 0.9961714 
new best score!!!!
Validation loss decreased (0.027394 --> 0.023826).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.575328826904297
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0228327  Vali Loss: 0.0223404 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899749  Vali macro F1 0.9899749 
new best score!!!!
Validation loss decreased (0.023826 --> 0.022340).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.5738396644592285
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0269378  Vali Loss: 0.0237346 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912094  Vali macro F1 0.9912169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.570636987686157
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0252242  Vali Loss: 0.0211178 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911488  Vali macro F1 0.9911262 
new best score!!!!
Validation loss decreased (0.022340 --> 0.021118).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.576066255569458
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0202692  Vali Loss: 0.0172642 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
new best score!!!!
Validation loss decreased (0.021118 --> 0.017264).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.572246551513672
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0168578  Vali Loss: 0.0114444 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.017264 --> 0.011444).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.5659942626953125
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0137008  Vali Loss: 0.0098337 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.011444 --> 0.009834).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.5684449672698975
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0168247  Vali Loss: 0.0101861 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.573368072509766
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0224714  Vali Loss: 0.0250420 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910159  Vali macro F1 0.9911432 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.5755250453948975
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0233668  Vali Loss: 0.0197671 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949716  Vali macro F1 0.9949741 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.567239284515381
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0186579  Vali Loss: 0.0118497 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.568205118179321
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0234154  Vali Loss: 0.0124683 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 5.567895174026489
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0145249  Vali Loss: 0.0104055 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.5735766887664795
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0123332  Vali Loss: 0.0098506 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.5688793659210205
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0113309  Vali Loss: 0.0087278 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.009834 --> 0.008728).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.5742576122283936
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0111840  Vali Loss: 0.0081977 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008728 --> 0.008198).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.559351205825806
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0106654  Vali Loss: 0.0080272 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008198 --> 0.008027).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.5599589347839355
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0100477  Vali Loss: 0.0077468 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008027 --> 0.007747).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.566978216171265
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0136564  Vali Loss: 0.0071923 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007747 --> 0.007192).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.56348180770874
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0094357  Vali Loss: 0.0069883 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007192 --> 0.006988).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.563920259475708
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0089590  Vali Loss: 0.0069590 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006988 --> 0.006959).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.56114649772644
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0082129  Vali Loss: 0.0072442 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.56095290184021
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0083587  Vali Loss: 0.0070053 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.562689781188965
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0083561  Vali Loss: 0.0065043 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006959 --> 0.006504).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.569828033447266
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0079376  Vali Loss: 0.0063978 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006504 --> 0.006398).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.565386772155762
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0072135  Vali Loss: 0.0063081 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006398 --> 0.006308).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.568582057952881
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0070868  Vali Loss: 0.0059269 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006308 --> 0.005927).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.563766956329346
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0070104  Vali Loss: 0.0056764 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005927 --> 0.005676).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.561453580856323
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0065848  Vali Loss: 0.0055959 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005676 --> 0.005596).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.562272787094116
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0068154  Vali Loss: 0.0051829 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005596 --> 0.005183).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.561084032058716
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0125129  Vali Loss: 0.0052013 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.55164647102356
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0068607  Vali Loss: 0.0065578 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.554428339004517
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0072910  Vali Loss: 0.0059498 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.553334712982178
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0064676  Vali Loss: 0.0063895 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.555734872817993
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0065962  Vali Loss: 0.0059585 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 5.5522027015686035
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0060057  Vali Loss: 0.0059014 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.560120582580566
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0058348  Vali Loss: 0.0058909 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.55413818359375
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0054131  Vali Loss: 0.0059092 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.559046268463135
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0057584  Vali Loss: 0.0057793 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.55623459815979
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0061482  Vali Loss: 0.0056790 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 5.5550947189331055
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0050117  Vali Loss: 0.0056868 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.567687034606934
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0056230  Vali Loss: 0.0056833 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.562291860580444
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0060178  Vali Loss: 0.0056773 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.558833837509155
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0054509  Vali Loss: 0.0056853 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.557543992996216
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0060492  Vali Loss: 0.0056746 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9675439  Test weighted F1: 0.9663838  Test macro F1 0.9663838 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.160624265670776
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0085914  Vali Loss: 0.0054334 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
Validation loss decreased (inf --> 0.005433).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.158839464187622
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0079680  Vali Loss: 0.0048254 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
new best score!!!!
Validation loss decreased (0.005433 --> 0.004825).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.145505905151367
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0054732  Vali Loss: 0.0036252 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004825 --> 0.003625).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.1512110233306885
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0048777  Vali Loss: 0.0042301 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.1420252323150635
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0047785  Vali Loss: 0.0040723 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 7.143877029418945
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0050003  Vali Loss: 0.0034655 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
new best score!!!!
Validation loss decreased (0.003625 --> 0.003466).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.1508800983428955
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0045128  Vali Loss: 0.0045050 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.1479315757751465
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0044305  Vali Loss: 0.0034273 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
new best score!!!!
Validation loss decreased (0.003466 --> 0.003427).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.158432722091675
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0039093  Vali Loss: 0.0032848 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
new best score!!!!
Validation loss decreased (0.003427 --> 0.003285).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 7.151289939880371
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0037657  Vali Loss: 0.0032324 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003285 --> 0.003232).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 7.150682210922241
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0038626  Vali Loss: 0.0035757 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.145319938659668
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0053947  Vali Loss: 0.0062089 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 7.1532957553863525
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0040523  Vali Loss: 0.0046280 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 7.148015260696411
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0034031  Vali Loss: 0.0041932 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 7.156675815582275
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0049879  Vali Loss: 0.0034424 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 7.152384042739868
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0037261  Vali Loss: 0.0021164 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003232 --> 0.002116).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 7.159396648406982
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0033520  Vali Loss: 0.0061995 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.153767824172974
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0041887  Vali Loss: 0.0037549 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.153274059295654
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0038009  Vali Loss: 0.0032861 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.15643835067749
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0035611  Vali Loss: 0.0029334 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.158431529998779
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0031638  Vali Loss: 0.0035443 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 7.160144090652466
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0027522  Vali Loss: 0.0035069 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.16435170173645
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0027950  Vali Loss: 0.0034300 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.1613476276397705
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0025326  Vali Loss: 0.0034638 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.160006523132324
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0026228  Vali Loss: 0.0033767 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.151932001113892
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025806  Vali Loss: 0.0033104 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 7.1534435749053955
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0026875  Vali Loss: 0.0033261 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 7.15627908706665
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0027208  Vali Loss: 0.0033205 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 7.1624860763549805
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0025180  Vali Loss: 0.0033260 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 7.1491920948028564
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0027474  Vali Loss: 0.0032949 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 7.154582500457764
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0028682  Vali Loss: 0.0032847 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9447368  Test weighted F1: 0.9431556  Test macro F1 0.9431556 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.653254985809326
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6409340  Vali Loss: 0.5036946 Vali Accuracy: 0.9085213  Vali weighted F1: 0.9050222  Vali macro F1 0.9017161 
Validation loss decreased (inf --> 0.503695).  Saving model ...
Epoch: 2 cost time: 5.5542120933532715
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3070525  Vali Loss: 0.1613097 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9757556  Vali macro F1 0.9751272 
new best score!!!!
Validation loss decreased (0.503695 --> 0.161310).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.5541160106658936
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1277524  Vali Loss: 0.0915332 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809463  Vali macro F1 0.9805654 
new best score!!!!
Validation loss decreased (0.161310 --> 0.091533).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.560600996017456
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0808144  Vali Loss: 0.0553409 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885167  Vali macro F1 0.9886269 
new best score!!!!
Validation loss decreased (0.091533 --> 0.055341).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.56298041343689
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0592452  Vali Loss: 0.0534369 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887327  Vali macro F1 0.9891241 
new best score!!!!
Validation loss decreased (0.055341 --> 0.053437).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.564050912857056
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0423358  Vali Loss: 0.0379060 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924864  Vali macro F1 0.9925532 
new best score!!!!
Validation loss decreased (0.053437 --> 0.037906).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.562297344207764
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0346837  Vali Loss: 0.0299855 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912299  Vali macro F1 0.9913326 
new best score!!!!
Validation loss decreased (0.037906 --> 0.029986).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.5614423751831055
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0293917  Vali Loss: 0.0256133 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
new best score!!!!
Validation loss decreased (0.029986 --> 0.025613).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.564393758773804
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0248174  Vali Loss: 0.0261132 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937426  Vali macro F1 0.9935990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.574417352676392
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0231727  Vali Loss: 0.0230352 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924858  Vali macro F1 0.9926392 
new best score!!!!
Validation loss decreased (0.025613 --> 0.023035).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.566290855407715
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0178847  Vali Loss: 0.0169577 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.023035 --> 0.016958).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.5672736167907715
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0185010  Vali Loss: 0.0170340 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.566657543182373
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0259048  Vali Loss: 0.0198691 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924822  Vali macro F1 0.9923354 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.564637184143066
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0162228  Vali Loss: 0.0209337 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.5662548542022705
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0139276  Vali Loss: 0.0138659 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9949761 
new best score!!!!
Validation loss decreased (0.016958 --> 0.013866).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.562760591506958
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0124286  Vali Loss: 0.0151478 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.560720682144165
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0139661  Vali Loss: 0.0170989 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912530  Vali macro F1 0.9913314 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.555540084838867
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0121826  Vali Loss: 0.0177627 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.563009738922119
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0109049  Vali Loss: 0.0127789 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950027  Vali macro F1 0.9950861 
new best score!!!!
Validation loss decreased (0.013866 --> 0.012779).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.54996657371521
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0174975  Vali Loss: 0.0187828 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924542  Vali macro F1 0.9925279 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.553662061691284
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0172495  Vali Loss: 0.0175909 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912173  Vali macro F1 0.9912115 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.560007095336914
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0122164  Vali Loss: 0.0114583 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.012779 --> 0.011458).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.547680377960205
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0092272  Vali Loss: 0.0104409 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.011458 --> 0.010441).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.55126953125
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0095055  Vali Loss: 0.0128662 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9949761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.548420667648315
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0078865  Vali Loss: 0.0109412 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.5506720542907715
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0074244  Vali Loss: 0.0116224 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.556551218032837
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0060197  Vali Loss: 0.0143953 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937168  Vali macro F1 0.9934943 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.963469982147217
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0063922  Vali Loss: 0.0190782 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925239  Vali macro F1 0.9923092 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 5.549711227416992
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0068943  Vali Loss: 0.0118458 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.545507431030273
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0050885  Vali Loss: 0.0099907 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.010441 --> 0.009991).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.550684213638306
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0046797  Vali Loss: 0.0088415 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.009991 --> 0.008842).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.560448408126831
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0042469  Vali Loss: 0.0111115 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.562424182891846
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0040134  Vali Loss: 0.0114169 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.560271501541138
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0038397  Vali Loss: 0.0115604 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.541399240493774
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0036115  Vali Loss: 0.0113431 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937205  Vali macro F1 0.9936204 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.5449583530426025
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0035022  Vali Loss: 0.0102379 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 5.539520978927612
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0035148  Vali Loss: 0.0105349 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.53413462638855
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0034838  Vali Loss: 0.0105726 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.540874481201172
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0034537  Vali Loss: 0.0106157 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.538767576217651
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0039678  Vali Loss: 0.0105549 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.528136730194092
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0033911  Vali Loss: 0.0108371 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 42 cost time: 5.5386412143707275
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0034955  Vali Loss: 0.0108491 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.537357568740845
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0048102  Vali Loss: 0.0108366 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.5355541706085205
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0031921  Vali Loss: 0.0107869 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 5.539111614227295
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0033814  Vali Loss: 0.0108076 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 5.532724857330322
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0035651  Vali Loss: 0.0108022 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9315789  Test weighted F1: 0.9131457  Test macro F1 0.9131457 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.184530973434448
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0041911  Vali Loss: 0.0117541 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937168  Vali macro F1 0.9934943 
Validation loss decreased (inf --> 0.011754).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.181904077529907
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0035533  Vali Loss: 0.0095126 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.011754 --> 0.009513).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.172679424285889
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0034465  Vali Loss: 0.0138450 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937168  Vali macro F1 0.9934943 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.176823854446411
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0029100  Vali Loss: 0.0126732 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937168  Vali macro F1 0.9934943 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 7.170436859130859
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0028243  Vali Loss: 0.0131360 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937168  Vali macro F1 0.9934943 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 7.170574188232422
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0026698  Vali Loss: 0.0131964 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937168  Vali macro F1 0.9934943 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 7.174800634384155
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0023452  Vali Loss: 0.0135257 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937168  Vali macro F1 0.9934943 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 7.171510934829712
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0026164  Vali Loss: 0.0144181 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937168  Vali macro F1 0.9934943 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.173963785171509
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0026560  Vali Loss: 0.0151557 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937287  Vali macro F1 0.9934180 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 7.173536777496338
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0020106  Vali Loss: 0.0187753 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924673  Vali macro F1 0.9921533 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 7.174328804016113
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0069946  Vali Loss: 0.0153730 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 7.176568269729614
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0030288  Vali Loss: 0.0097291 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 7.170529127120972
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0023272  Vali Loss: 0.0103707 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.170901536941528
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0022124  Vali Loss: 0.0107441 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 7.1721625328063965
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0030692  Vali Loss: 0.0114262 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 7.179427623748779
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0024152  Vali Loss: 0.0134021 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 7.185485363006592
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0024535  Vali Loss: 0.0133387 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949782  Vali macro F1 0.9947589 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9289474  Test weighted F1: 0.9100681  Test macro F1 0.9100681 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.656148672103882
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6619166  Vali Loss: 0.4815113 Vali Accuracy: 0.9448622  Vali weighted F1: 0.9392172  Vali macro F1 0.9387564 
Validation loss decreased (inf --> 0.481511).  Saving model ...
Epoch: 2 cost time: 5.56006121635437
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2963987  Vali Loss: 0.1459465 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9758684  Vali macro F1 0.9760446 
new best score!!!!
Validation loss decreased (0.481511 --> 0.145946).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.562067031860352
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1186874  Vali Loss: 0.0799099 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9804973  Vali macro F1 0.9806783 
new best score!!!!
Validation loss decreased (0.145946 --> 0.079910).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.5615856647491455
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0805354  Vali Loss: 0.0601864 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886531  Vali macro F1 0.9886144 
new best score!!!!
Validation loss decreased (0.079910 --> 0.060186).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.569167852401733
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0590933  Vali Loss: 0.0496915 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9951345 
new best score!!!!
Validation loss decreased (0.060186 --> 0.049692).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.566044569015503
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0391855  Vali Loss: 0.0361579 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974937 
new best score!!!!
Validation loss decreased (0.049692 --> 0.036158).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.565995216369629
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0320227  Vali Loss: 0.0262642 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.036158 --> 0.026264).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.566425085067749
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0262770  Vali Loss: 0.0215703 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.026264 --> 0.021570).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.564664125442505
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0197775  Vali Loss: 0.0210306 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.021570 --> 0.021031).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.5672924518585205
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0176875  Vali Loss: 0.0190964 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937039  Vali macro F1 0.9940128 
new best score!!!!
Validation loss decreased (0.021031 --> 0.019096).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.564339637756348
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0136586  Vali Loss: 0.0128945 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.019096 --> 0.012895).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.561877489089966
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0154947  Vali Loss: 0.0250107 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936777  Vali macro F1 0.9937440 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.560879707336426
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0173863  Vali Loss: 0.0212777 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949808  Vali macro F1 0.9949751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.559834957122803
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0132485  Vali Loss: 0.0145437 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949499  Vali macro F1 0.9950918 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.556792497634888
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0118496  Vali Loss: 0.0188266 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9909859  Vali macro F1 0.9911852 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 16 cost time: 5.559953927993774
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0113216  Vali Loss: 0.0133222 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 17 cost time: 5.558953523635864
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0085184  Vali Loss: 0.0099482 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.012895 --> 0.009948).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.563401937484741
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0077424  Vali Loss: 0.0087797 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962237  Vali macro F1 0.9962951 
new best score!!!!
Validation loss decreased (0.009948 --> 0.008780).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.564528226852417
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0072804  Vali Loss: 0.0080640 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.008780 --> 0.008064).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.624463796615601
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0070504  Vali Loss: 0.0093638 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962237  Vali macro F1 0.9962951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.565207004547119
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0065163  Vali Loss: 0.0076662 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.008064 --> 0.007666).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.562678575515747
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0060709  Vali Loss: 0.0072670 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.007666 --> 0.007267).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.558537006378174
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0056779  Vali Loss: 0.0071394 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.007267 --> 0.007139).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.558349609375
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0053937  Vali Loss: 0.0071604 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.5575995445251465
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0053122  Vali Loss: 0.0072774 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.555082559585571
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0050779  Vali Loss: 0.0083262 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9975655 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.559806823730469
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0046121  Vali Loss: 0.0069310 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.007139 --> 0.006931).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.810029983520508
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0044741  Vali Loss: 0.0064307 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.006931 --> 0.006431).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 11.289352655410767
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0043355  Vali Loss: 0.0069393 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.538024425506592
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0043787  Vali Loss: 0.0084991 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962237  Vali macro F1 0.9962951 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.550543308258057
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0041606  Vali Loss: 0.0056377 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.006431 --> 0.005638).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.557406902313232
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0040206  Vali Loss: 0.0062308 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.556920051574707
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0044748  Vali Loss: 0.0057260 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.558385133743286
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0036474  Vali Loss: 0.0059016 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.561790704727173
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0034594  Vali Loss: 0.0058479 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.577390670776367
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0037035  Vali Loss: 0.0057442 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 5.575972318649292
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0034719  Vali Loss: 0.0058399 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.578326940536499
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0032442  Vali Loss: 0.0057973 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.5628602504730225
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0053183  Vali Loss: 0.0057651 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.564711809158325
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0032097  Vali Loss: 0.0059318 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.562822580337524
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0033422  Vali Loss: 0.0058990 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 42 cost time: 5.565495014190674
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0033833  Vali Loss: 0.0058870 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.5614142417907715
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0031517  Vali Loss: 0.0058837 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.560839414596558
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0032528  Vali Loss: 0.0058736 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 5.551855802536011
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0032172  Vali Loss: 0.0058575 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 5.553879022598267
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0031748  Vali Loss: 0.0058540 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8201754  Test weighted F1: 0.7859601  Test macro F1 0.7859601 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.313519477844238
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0043632  Vali Loss: 0.0054969 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
Validation loss decreased (inf --> 0.005497).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.195336103439331
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0034829  Vali Loss: 0.0065998 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.194604158401489
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0030872  Vali Loss: 0.0062182 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.191181182861328
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0031439  Vali Loss: 0.0053275 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.005497 --> 0.005327).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.196728467941284
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0027260  Vali Loss: 0.0059159 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 7.202175855636597
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0033997  Vali Loss: 0.0037113 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005327 --> 0.003711).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.181304931640625
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0036394  Vali Loss: 0.0040979 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.2061381340026855
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0030199  Vali Loss: 0.0045313 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 7.195193290710449
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0026746  Vali Loss: 0.0043523 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 7.190198183059692
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0020334  Vali Loss: 0.0047798 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 7.195013761520386
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0018506  Vali Loss: 0.0043702 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 7.188032865524292
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0017376  Vali Loss: 0.0064669 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.179529190063477
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0018707  Vali Loss: 0.0042116 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 7.1882007122039795
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0014835  Vali Loss: 0.0063312 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 7.197154998779297
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0018143  Vali Loss: 0.0047664 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 7.185477256774902
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0013840  Vali Loss: 0.0027917 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003711 --> 0.002792).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 7.189295053482056
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0011067  Vali Loss: 0.0040742 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.195275545120239
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0011602  Vali Loss: 0.0044275 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974937 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.181271076202393
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0020376  Vali Loss: 0.0029520 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.181044101715088
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0012012  Vali Loss: 0.0051037 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.1848814487457275
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0009613  Vali Loss: 0.0042841 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 7.176300287246704
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0009026  Vali Loss: 0.0040871 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.1817307472229
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0007538  Vali Loss: 0.0043936 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.198224067687988
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0007231  Vali Loss: 0.0046563 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.188286542892456
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0009092  Vali Loss: 0.0029263 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.1900200843811035
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0015825  Vali Loss: 0.0031854 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 7.188105821609497
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0007679  Vali Loss: 0.0031954 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 7.182188987731934
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0006952  Vali Loss: 0.0031942 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 7.192805290222168
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0007184  Vali Loss: 0.0031846 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 7.182375907897949
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0007438  Vali Loss: 0.0031886 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 7.182337999343872
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0007196  Vali Loss: 0.0032003 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8096491  Test weighted F1: 0.7797633  Test macro F1 0.7797633 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1618428
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.538288593292236
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6502771  Vali Loss: 0.4254273 Vali Accuracy: 0.9010025  Vali weighted F1: 0.8924524  Vali macro F1 0.8898538 
Validation loss decreased (inf --> 0.425427).  Saving model ...
Epoch: 2 cost time: 5.476655006408691
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3036600  Vali Loss: 0.1643617 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9671661  Vali macro F1 0.9657340 
new best score!!!!
Validation loss decreased (0.425427 --> 0.164362).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.473790645599365
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1538702  Vali Loss: 0.0859099 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899046  Vali macro F1 0.9894096 
new best score!!!!
Validation loss decreased (0.164362 --> 0.085910).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.492717504501343
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0825556  Vali Loss: 0.0571370 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
new best score!!!!
Validation loss decreased (0.085910 --> 0.057137).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.491393327713013
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0556221  Vali Loss: 0.0466650 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861045  Vali macro F1 0.9852136 
new best score!!!!
Validation loss decreased (0.057137 --> 0.046665).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.493194341659546
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0418952  Vali Loss: 0.0369926 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886739  Vali macro F1 0.9877766 
new best score!!!!
Validation loss decreased (0.046665 --> 0.036993).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.508740663528442
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0330259  Vali Loss: 0.0318865 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899572  Vali macro F1 0.9892581 
new best score!!!!
Validation loss decreased (0.036993 --> 0.031886).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.509117841720581
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0265017  Vali Loss: 0.0271772 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924457  Vali macro F1 0.9919006 
new best score!!!!
Validation loss decreased (0.031886 --> 0.027177).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.51297926902771
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0219152  Vali Loss: 0.0249382 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
new best score!!!!
Validation loss decreased (0.027177 --> 0.024938).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.519974231719971
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0204358  Vali Loss: 0.0239429 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912046  Vali macro F1 0.9905397 
new best score!!!!
Validation loss decreased (0.024938 --> 0.023943).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.525875091552734
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0186374  Vali Loss: 0.0294888 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899601  Vali macro F1 0.9891767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.5274200439453125
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0170382  Vali Loss: 0.0198808 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.023943 --> 0.019881).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.534312009811401
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0151101  Vali Loss: 0.0231194 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924531  Vali macro F1 0.9918930 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.534420728683472
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0174574  Vali Loss: 0.0224014 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911761  Vali macro F1 0.9905289 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.538599014282227
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0157305  Vali Loss: 0.0193304 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924858  Vali macro F1 0.9919386 
new best score!!!!
Validation loss decreased (0.019881 --> 0.019330).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.547621726989746
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0131158  Vali Loss: 0.0213781 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.54483962059021
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0112757  Vali Loss: 0.0177672 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.019330 --> 0.017767).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.552839517593384
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0087586  Vali Loss: 0.0180023 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925137  Vali macro F1 0.9919637 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.554082870483398
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0085249  Vali Loss: 0.0167130 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937408  Vali macro F1 0.9933025 
new best score!!!!
Validation loss decreased (0.017767 --> 0.016713).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.556373119354248
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0075767  Vali Loss: 0.0167457 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911797  Vali macro F1 0.9905728 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.5657124519348145
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0066572  Vali Loss: 0.0190024 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923994  Vali macro F1 0.9918815 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.560353994369507
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0067424  Vali Loss: 0.0245092 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911797  Vali macro F1 0.9905728 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.566054821014404
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0059971  Vali Loss: 0.0144263 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.016713 --> 0.014426).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.558913469314575
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0070051  Vali Loss: 0.0199241 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937464  Vali macro F1 0.9933207 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.562846660614014
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0112587  Vali Loss: 0.0205896 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.556892156600952
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0214881  Vali Loss: 0.0233767 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937011  Vali macro F1 0.9932262 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.559518337249756
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0100705  Vali Loss: 0.0151739 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.555958032608032
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0077179  Vali Loss: 0.0132973 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.014426 --> 0.013297).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.562044620513916
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0094550  Vali Loss: 0.0165744 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.566755771636963
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0060451  Vali Loss: 0.0194036 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.55543327331543
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0070288  Vali Loss: 0.0441890 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821167  Vali macro F1 0.9809723 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.555726766586304
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0631418  Vali Loss: 0.0296971 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911921  Vali macro F1 0.9908001 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 5.552616119384766
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0225053  Vali Loss: 0.0206414 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949884  Vali macro F1 0.9947272 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 5.5470404624938965
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0141122  Vali Loss: 0.0183331 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949895  Vali macro F1 0.9946332 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.544973373413086
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0121782  Vali Loss: 0.0165306 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.555413722991943
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0112323  Vali Loss: 0.0167646 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.552537202835083
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0101368  Vali Loss: 0.0159402 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9959678 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.557635545730591
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0096525  Vali Loss: 0.0160601 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 5.553701877593994
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0092085  Vali Loss: 0.0161503 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.555166482925415
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0098463  Vali Loss: 0.0160503 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.557282209396362
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0092378  Vali Loss: 0.0160324 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.551960468292236
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0088576  Vali Loss: 0.0159854 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.552220344543457
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0088681  Vali Loss: 0.0159954 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9043860  Test weighted F1: 0.8879361  Test macro F1 0.8879361 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.184986114501953
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0055713  Vali Loss: 0.0154030 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
Validation loss decreased (inf --> 0.015403).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.183984756469727
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0038187  Vali Loss: 0.0159777 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.177255153656006
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0031872  Vali Loss: 0.0162423 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.186522483825684
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0029172  Vali Loss: 0.0158050 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 7.203933954238892
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0025601  Vali Loss: 0.0178974 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 7.1867663860321045
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0028221  Vali Loss: 0.0161295 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.187138557434082
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0030490  Vali Loss: 0.0171520 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 7.188132286071777
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0022537  Vali Loss: 0.0175809 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 7.193358659744263
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0026807  Vali Loss: 0.0172286 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 7.188939332962036
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0027792  Vali Loss: 0.0165128 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 7.19039511680603
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0021189  Vali Loss: 0.0165976 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.184952974319458
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0018575  Vali Loss: 0.0168208 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 7.196168422698975
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0016697  Vali Loss: 0.0170759 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 7.1923627853393555
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0019195  Vali Loss: 0.0172714 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 7.190668344497681
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0018085  Vali Loss: 0.0172798 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 7.183661460876465
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0032413  Vali Loss: 0.0173207 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8956140  Test weighted F1: 0.8849073  Test macro F1 0.8849073 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.654261589050293
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6622865  Vali Loss: 0.4316714 Vali Accuracy: 0.9185464  Vali weighted F1: 0.9088395  Vali macro F1 0.9076607 
Validation loss decreased (inf --> 0.431671).  Saving model ...
Epoch: 2 cost time: 5.590850591659546
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2721772  Vali Loss: 0.1380520 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9654779  Vali macro F1 0.9640796 
new best score!!!!
Validation loss decreased (0.431671 --> 0.138052).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.578868865966797
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1206965  Vali Loss: 0.0796485 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898032  Vali macro F1 0.9895275 
new best score!!!!
Validation loss decreased (0.138052 --> 0.079648).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.579426288604736
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0715243  Vali Loss: 0.0566123 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874547  Vali macro F1 0.9867180 
new best score!!!!
Validation loss decreased (0.079648 --> 0.056612).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.585112810134888
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0530842  Vali Loss: 0.0395271 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912586  Vali macro F1 0.9906648 
new best score!!!!
Validation loss decreased (0.056612 --> 0.039527).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.574115753173828
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0367983  Vali Loss: 0.0311332 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936727  Vali macro F1 0.9931804 
new best score!!!!
Validation loss decreased (0.039527 --> 0.031133).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.577005624771118
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0291078  Vali Loss: 0.0288579 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
new best score!!!!
Validation loss decreased (0.031133 --> 0.028858).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.56927752494812
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0262298  Vali Loss: 0.0264001 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925009  Vali macro F1 0.9919333 
new best score!!!!
Validation loss decreased (0.028858 --> 0.026400).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.573698282241821
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0214110  Vali Loss: 0.0243267 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
new best score!!!!
Validation loss decreased (0.026400 --> 0.024327).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.570034980773926
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0182462  Vali Loss: 0.0198107 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937073  Vali macro F1 0.9932467 
new best score!!!!
Validation loss decreased (0.024327 --> 0.019811).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.568445920944214
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0154072  Vali Loss: 0.0173978 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975046  Vali macro F1 0.9973212 
new best score!!!!
Validation loss decreased (0.019811 --> 0.017398).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.5718042850494385
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0123398  Vali Loss: 0.0191180 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.5692973136901855
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0161881  Vali Loss: 0.0197551 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937011  Vali macro F1 0.9932262 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.566998720169067
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0162469  Vali Loss: 0.0184425 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.566128969192505
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0121860  Vali Loss: 0.0218676 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924435  Vali macro F1 0.9918980 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 16 cost time: 5.565848350524902
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0178253  Vali Loss: 0.0270388 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925339  Vali macro F1 0.9922207 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 17 cost time: 5.572219133377075
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0168947  Vali Loss: 0.0211190 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924317  Vali macro F1 0.9919192 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.576544284820557
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0119574  Vali Loss: 0.0179290 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937464  Vali macro F1 0.9933207 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.574608325958252
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0098218  Vali Loss: 0.0176904 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937464  Vali macro F1 0.9933207 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.580285310745239
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0086377  Vali Loss: 0.0170567 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949955  Vali macro F1 0.9946488 
new best score!!!!
Validation loss decreased (0.017398 --> 0.017057).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.585643768310547
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0081806  Vali Loss: 0.0165896 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
new best score!!!!
Validation loss decreased (0.017057 --> 0.016590).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.590608596801758
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0073920  Vali Loss: 0.0168400 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.59153151512146
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0071767  Vali Loss: 0.0172239 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.595149040222168
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0066188  Vali Loss: 0.0165916 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.597916603088379
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0070156  Vali Loss: 0.0156187 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.016590 --> 0.015619).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.595781564712524
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0063291  Vali Loss: 0.0155772 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.015619 --> 0.015577).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.592833757400513
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0058661  Vali Loss: 0.0151119 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.015577 --> 0.015112).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.592393398284912
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0058010  Vali Loss: 0.0150897 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.015112 --> 0.015090).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.592235565185547
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0053170  Vali Loss: 0.0149962 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.015090 --> 0.014996).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.589210033416748
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0053094  Vali Loss: 0.0147804 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.014996 --> 0.014780).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.5916361808776855
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0050976  Vali Loss: 0.0143876 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.014780 --> 0.014388).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.590588569641113
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0053225  Vali Loss: 0.0141546 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.014388 --> 0.014155).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.590385437011719
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0052631  Vali Loss: 0.0155486 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.586313962936401
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0043872  Vali Loss: 0.0162608 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.5861897468566895
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0045690  Vali Loss: 0.0161025 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.582000732421875
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0042204  Vali Loss: 0.0168400 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.586068153381348
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0040107  Vali Loss: 0.0189364 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 5.587533950805664
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0040432  Vali Loss: 0.0183087 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.591723918914795
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0037943  Vali Loss: 0.0175657 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.589413166046143
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0038201  Vali Loss: 0.0163909 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.590679168701172
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0042743  Vali Loss: 0.0165632 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.586421251296997
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0038107  Vali Loss: 0.0165169 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 43 cost time: 5.58599066734314
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0036028  Vali Loss: 0.0165910 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.5801050662994385
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0040262  Vali Loss: 0.0167639 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 5.580517292022705
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0034875  Vali Loss: 0.0167990 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 5.587273836135864
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0036285  Vali Loss: 0.0167554 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 5.590811252593994
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0037852  Vali Loss: 0.0167077 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9070175  Test weighted F1: 0.8876909  Test macro F1 0.8876909 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.161674976348877
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0051905  Vali Loss: 0.0164395 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
Validation loss decreased (inf --> 0.016440).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.150360822677612
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0050874  Vali Loss: 0.0145891 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.016440 --> 0.014589).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.15018630027771
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0039700  Vali Loss: 0.0178758 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.148585319519043
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0034418  Vali Loss: 0.0174943 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 7.146280765533447
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0034204  Vali Loss: 0.0165418 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 7.145346164703369
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0033456  Vali Loss: 0.0191542 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 7.150212049484253
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0030361  Vali Loss: 0.0187418 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 7.145136833190918
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0029489  Vali Loss: 0.0201400 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.148451805114746
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0029955  Vali Loss: 0.0182192 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 7.147590160369873
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0028259  Vali Loss: 0.0190475 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 7.149754524230957
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0025908  Vali Loss: 0.0183696 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 7.146131753921509
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0061973  Vali Loss: 0.0194933 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924256  Vali macro F1 0.9918941 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 7.144676208496094
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0024267  Vali Loss: 0.0186197 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924256  Vali macro F1 0.9918941 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.146878957748413
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0024395  Vali Loss: 0.0184285 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 7.152106285095215
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0024660  Vali Loss: 0.0188814 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 7.145937919616699
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0021757  Vali Loss: 0.0186352 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 7.149549245834351
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0028458  Vali Loss: 0.0187333 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9114035  Test weighted F1: 0.8928196  Test macro F1 0.8928196 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.647746324539185
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6707865  Vali Loss: 0.4547354 Vali Accuracy: 0.9122807  Vali weighted F1: 0.9062030  Vali macro F1 0.9042705 
Validation loss decreased (inf --> 0.454735).  Saving model ...
Epoch: 2 cost time: 5.555152416229248
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2991979  Vali Loss: 0.1658220 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9689113  Vali macro F1 0.9677301 
new best score!!!!
Validation loss decreased (0.454735 --> 0.165822).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.551069736480713
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1346294  Vali Loss: 0.0803596 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9857692  Vali macro F1 0.9852114 
new best score!!!!
Validation loss decreased (0.165822 --> 0.080360).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.552748203277588
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0805377  Vali Loss: 0.0585523 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862592  Vali macro F1 0.9856881 
new best score!!!!
Validation loss decreased (0.080360 --> 0.058552).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.555203199386597
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0554540  Vali Loss: 0.0404492 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885108  Vali macro F1 0.9880502 
new best score!!!!
Validation loss decreased (0.058552 --> 0.040449).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.555057525634766
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0409739  Vali Loss: 0.0324101 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900777  Vali macro F1 0.9899982 
new best score!!!!
Validation loss decreased (0.040449 --> 0.032410).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.561134099960327
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0346264  Vali Loss: 0.0315301 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924276  Vali macro F1 0.9919889 
new best score!!!!
Validation loss decreased (0.032410 --> 0.031530).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.555330514907837
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0316001  Vali Loss: 0.0289223 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937011  Vali macro F1 0.9932262 
new best score!!!!
Validation loss decreased (0.031530 --> 0.028922).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.5629236698150635
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0242241  Vali Loss: 0.0223681 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911850  Vali macro F1 0.9910175 
new best score!!!!
Validation loss decreased (0.028922 --> 0.022368).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.555788278579712
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0207972  Vali Loss: 0.0171723 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9961995  Vali macro F1 0.9958460 
new best score!!!!
Validation loss decreased (0.022368 --> 0.017172).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.55560040473938
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0205871  Vali Loss: 0.0175636 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.557380199432373
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0175323  Vali Loss: 0.0161155 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936814  Vali macro F1 0.9932601 
new best score!!!!
Validation loss decreased (0.017172 --> 0.016115).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.552270889282227
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0145037  Vali Loss: 0.0163942 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936814  Vali macro F1 0.9932601 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.558108806610107
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0135443  Vali Loss: 0.0188981 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936814  Vali macro F1 0.9932601 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.557840347290039
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0123190  Vali Loss: 0.0103802 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.016115 --> 0.010380).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.560237169265747
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0135751  Vali Loss: 0.0183904 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924504  Vali macro F1 0.9923617 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.547579288482666
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0111432  Vali Loss: 0.0090522 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949640  Vali macro F1 0.9948292 
new best score!!!!
Validation loss decreased (0.010380 --> 0.009052).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.552063703536987
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0101880  Vali Loss: 0.0116016 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.546967029571533
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0087512  Vali Loss: 0.0087606 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
new best score!!!!
Validation loss decreased (0.009052 --> 0.008761).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.551332235336304
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0083002  Vali Loss: 0.0132617 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.546896457672119
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0137024  Vali Loss: 0.0127350 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962305  Vali macro F1 0.9960906 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.545678377151489
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0104727  Vali Loss: 0.0222767 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923458  Vali macro F1 0.9920506 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.543163299560547
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0172717  Vali Loss: 0.0096682 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.54423713684082
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0077463  Vali Loss: 0.0113436 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949490  Vali macro F1 0.9946064 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 5.538070201873779
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0062860  Vali Loss: 0.0055417 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.008761 --> 0.005542).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.543725252151489
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0050200  Vali Loss: 0.0052055 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.005542 --> 0.005205).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.548279762268066
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0047986  Vali Loss: 0.0051564 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.005205 --> 0.005156).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.5455193519592285
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0047460  Vali Loss: 0.0053209 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.538326740264893
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0045144  Vali Loss: 0.0054029 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.547300815582275
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0042229  Vali Loss: 0.0053665 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.552077531814575
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0043206  Vali Loss: 0.0071278 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.547401666641235
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0042684  Vali Loss: 0.0062870 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 5.553516387939453
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0042333  Vali Loss: 0.0061395 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.53906774520874
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0039670  Vali Loss: 0.0060575 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.543456792831421
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0039410  Vali Loss: 0.0059996 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.536136865615845
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0040307  Vali Loss: 0.0060276 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.544328212738037
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0040279  Vali Loss: 0.0060996 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 38 cost time: 5.543198108673096
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0038637  Vali Loss: 0.0061024 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.541891813278198
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0039516  Vali Loss: 0.0061035 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.539186239242554
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0040030  Vali Loss: 0.0060970 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.542479753494263
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0038187  Vali Loss: 0.0061007 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.545391321182251
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0044128  Vali Loss: 0.0060970 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9421053  Test weighted F1: 0.9390201  Test macro F1 0.9390201 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.159179925918579
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0055430  Vali Loss: 0.0070259 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
Validation loss decreased (inf --> 0.007026).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.157260894775391
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0043018  Vali Loss: 0.0052633 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
new best score!!!!
Validation loss decreased (0.007026 --> 0.005263).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.1560375690460205
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0034768  Vali Loss: 0.0036497 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.005263 --> 0.003650).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.158327341079712
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0031195  Vali Loss: 0.0062416 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.157798528671265
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0028259  Vali Loss: 0.0046877 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 7.162065267562866
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0028729  Vali Loss: 0.0080427 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 7.1567158699035645
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0033259  Vali Loss: 0.0045537 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962151  Vali macro F1 0.9959542 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 7.162679195404053
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0028939  Vali Loss: 0.0062202 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 7.154989957809448
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0034880  Vali Loss: 0.0176045 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936308  Vali macro F1 0.9934139 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.155641317367554
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0049305  Vali Loss: 0.0058364 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.155889272689819
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0033823  Vali Loss: 0.0089203 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949490  Vali macro F1 0.9946064 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 7.154985189437866
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0023110  Vali Loss: 0.0074495 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 7.163555383682251
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0025584  Vali Loss: 0.0077635 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 7.159296751022339
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0020876  Vali Loss: 0.0077265 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.155853509902954
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0017839  Vali Loss: 0.0078122 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.162161588668823
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0021389  Vali Loss: 0.0078359 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.165914058685303
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0020395  Vali Loss: 0.0079265 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.173509359359741
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0019142  Vali Loss: 0.0080631 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974811  Vali macro F1 0.9973049 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9412281  Test weighted F1: 0.9384386  Test macro F1 0.9384386 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.618874788284302
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6526247  Vali Loss: 0.4091208 Vali Accuracy: 0.9185464  Vali weighted F1: 0.9149360  Vali macro F1 0.9113271 
Validation loss decreased (inf --> 0.409121).  Saving model ...
Epoch: 2 cost time: 5.560517311096191
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2885410  Vali Loss: 0.1572456 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9708663  Vali macro F1 0.9692981 
new best score!!!!
Validation loss decreased (0.409121 --> 0.157246).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.558635234832764
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1244291  Vali Loss: 0.0717556 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911469  Vali macro F1 0.9904445 
new best score!!!!
Validation loss decreased (0.157246 --> 0.071756).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.561041593551636
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0698301  Vali Loss: 0.0523485 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899623  Vali macro F1 0.9891297 
new best score!!!!
Validation loss decreased (0.071756 --> 0.052349).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.564414024353027
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0480237  Vali Loss: 0.0367425 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911469  Vali macro F1 0.9904445 
new best score!!!!
Validation loss decreased (0.052349 --> 0.036742).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.564896583557129
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0348705  Vali Loss: 0.0369358 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885775  Vali macro F1 0.9875960 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 5.566378355026245
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0315934  Vali Loss: 0.0272851 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923838  Vali macro F1 0.9917733 
new best score!!!!
Validation loss decreased (0.036742 --> 0.027285).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.566156625747681
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0255557  Vali Loss: 0.0281029 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937084  Vali macro F1 0.9931580 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.566230058670044
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0204120  Vali Loss: 0.0227279 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949810  Vali macro F1 0.9946150 
new best score!!!!
Validation loss decreased (0.027285 --> 0.022728).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.5725390911102295
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0179927  Vali Loss: 0.0225114 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937447  Vali macro F1 0.9932003 
new best score!!!!
Validation loss decreased (0.022728 --> 0.022511).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.571028709411621
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0280214  Vali Loss: 0.0252393 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949514  Vali macro F1 0.9945648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.564687967300415
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0211253  Vali Loss: 0.0208729 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9958707 
new best score!!!!
Validation loss decreased (0.022511 --> 0.020873).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.56710958480835
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0159119  Vali Loss: 0.0215399 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.563899993896484
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0172982  Vali Loss: 0.0204205 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
new best score!!!!
Validation loss decreased (0.020873 --> 0.020420).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.5652008056640625
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0137413  Vali Loss: 0.0197522 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949699  Vali macro F1 0.9945176 
new best score!!!!
Validation loss decreased (0.020420 --> 0.019752).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.5569422245025635
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0101602  Vali Loss: 0.0163693 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9972250 
new best score!!!!
Validation loss decreased (0.019752 --> 0.016369).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.5580503940582275
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0087377  Vali Loss: 0.0135729 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.016369 --> 0.013573).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.556103229522705
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0076797  Vali Loss: 0.0177088 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.5526204109191895
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0072927  Vali Loss: 0.0145075 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.551042079925537
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0077198  Vali Loss: 0.0144760 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.5551841259002686
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0079149  Vali Loss: 0.0154970 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.550792455673218
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0060198  Vali Loss: 0.0144538 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 5.55223822593689
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0049403  Vali Loss: 0.0129157 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.013573 --> 0.012916).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.550041913986206
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0042510  Vali Loss: 0.0127439 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.012916 --> 0.012744).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.562027931213379
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0042063  Vali Loss: 0.0136840 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.55234694480896
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0040627  Vali Loss: 0.0127245 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.012744 --> 0.012724).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.558866262435913
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0036743  Vali Loss: 0.0126785 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.012724 --> 0.012678).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.559587001800537
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0038423  Vali Loss: 0.0120528 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.012678 --> 0.012053).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.5678184032440186
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0036645  Vali Loss: 0.0123604 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.556957721710205
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0034281  Vali Loss: 0.0122157 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.554316759109497
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0032793  Vali Loss: 0.0125873 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.552897214889526
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0036826  Vali Loss: 0.0122835 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 5.552073240280151
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0033494  Vali Loss: 0.0123600 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 5.547313690185547
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0030939  Vali Loss: 0.0123481 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.547250509262085
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0031385  Vali Loss: 0.0122556 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.548107385635376
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0031282  Vali Loss: 0.0121746 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.5471110343933105
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0031569  Vali Loss: 0.0121622 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.549156427383423
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0031491  Vali Loss: 0.0120824 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 39 cost time: 5.552652597427368
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0031804  Vali Loss: 0.0120758 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.551311254501343
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0030022  Vali Loss: 0.0120717 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.549163579940796
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0032472  Vali Loss: 0.0120712 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.5524609088897705
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0032075  Vali Loss: 0.0120665 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.5472893714904785
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0029796  Vali Loss: 0.0120557 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7824561  Test weighted F1: 0.7394547  Test macro F1 0.7394547 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.221771001815796
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0039736  Vali Loss: 0.0116968 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
Validation loss decreased (inf --> 0.011697).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.1486334800720215
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0032219  Vali Loss: 0.0126485 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.14484429359436
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0029826  Vali Loss: 0.0124890 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.150086402893066
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0035580  Vali Loss: 0.0119165 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 7.150167465209961
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0026534  Vali Loss: 0.0118824 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 7.158432245254517
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0027143  Vali Loss: 0.0128745 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.161924839019775
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0024138  Vali Loss: 0.0121504 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 7.170109033584595
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0020860  Vali Loss: 0.0127009 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 7.167532682418823
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0024244  Vali Loss: 0.0127779 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 7.170897960662842
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0022283  Vali Loss: 0.0176261 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 7.165711879730225
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0023374  Vali Loss: 0.0168990 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.17106556892395
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0019887  Vali Loss: 0.0167225 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 7.16963791847229
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0016248  Vali Loss: 0.0165385 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 7.169024467468262
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0020208  Vali Loss: 0.0158906 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 7.163354873657227
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0017948  Vali Loss: 0.0153886 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 7.162604331970215
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0034779  Vali Loss: 0.0153095 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7543860  Test weighted F1: 0.6980240  Test macro F1 0.6980240 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.614387273788452
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6239461  Vali Loss: 0.4198785 Vali Accuracy: 0.9210526  Vali weighted F1: 0.9112486  Vali macro F1 0.9108566 
Validation loss decreased (inf --> 0.419878).  Saving model ...
Epoch: 2 cost time: 5.5463573932647705
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2800989  Vali Loss: 0.1480893 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9720543  Vali macro F1 0.9711951 
new best score!!!!
Validation loss decreased (0.419878 --> 0.148089).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.5353827476501465
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1133097  Vali Loss: 0.0735780 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847563  Vali macro F1 0.9837470 
new best score!!!!
Validation loss decreased (0.148089 --> 0.073578).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.535974740982056
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0648380  Vali Loss: 0.0544577 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911141  Vali macro F1 0.9905574 
new best score!!!!
Validation loss decreased (0.073578 --> 0.054458).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.530794858932495
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0443273  Vali Loss: 0.0378740 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911638  Vali macro F1 0.9905755 
new best score!!!!
Validation loss decreased (0.054458 --> 0.037874).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.531876087188721
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0318361  Vali Loss: 0.0332454 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.037874 --> 0.033245).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.529690742492676
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0290029  Vali Loss: 0.0336735 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923838  Vali macro F1 0.9917733 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.527827024459839
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0290787  Vali Loss: 0.0241009 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
new best score!!!!
Validation loss decreased (0.033245 --> 0.024101).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.532877683639526
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0188989  Vali Loss: 0.0202009 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.024101 --> 0.020201).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.534461975097656
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0167648  Vali Loss: 0.0212860 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937073  Vali macro F1 0.9932467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.527129888534546
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0142313  Vali Loss: 0.0230553 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899067  Vali macro F1 0.9891549 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.532152414321899
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0121197  Vali Loss: 0.0143316 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
new best score!!!!
Validation loss decreased (0.020201 --> 0.014332).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.534821271896362
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0144136  Vali Loss: 0.0216727 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949713  Vali macro F1 0.9945983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.533499002456665
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0207919  Vali Loss: 0.0169209 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.538084268569946
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0133889  Vali Loss: 0.0162978 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 5.532947301864624
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0139636  Vali Loss: 0.0201476 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925082  Vali macro F1 0.9919905 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 17 cost time: 5.539279460906982
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0120630  Vali Loss: 0.0144549 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 18 cost time: 5.539313793182373
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0087989  Vali Loss: 0.0151048 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.5351433753967285
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0082561  Vali Loss: 0.0133335 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.014332 --> 0.013333).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.538590431213379
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0077830  Vali Loss: 0.0131015 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.013333 --> 0.013102).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.535421371459961
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0075382  Vali Loss: 0.0124538 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
new best score!!!!
Validation loss decreased (0.013102 --> 0.012454).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.541362762451172
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0071935  Vali Loss: 0.0122246 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
new best score!!!!
Validation loss decreased (0.012454 --> 0.012225).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.540940523147583
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0068346  Vali Loss: 0.0119530 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
new best score!!!!
Validation loss decreased (0.012225 --> 0.011953).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.539886474609375
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0066140  Vali Loss: 0.0113689 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.011953 --> 0.011369).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.53946590423584
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0063619  Vali Loss: 0.0110826 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.011369 --> 0.011083).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.537440538406372
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0065238  Vali Loss: 0.0105467 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.011083 --> 0.010547).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.5364885330200195
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0058769  Vali Loss: 0.0113305 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.538146734237671
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0058495  Vali Loss: 0.0099973 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.010547 --> 0.009997).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.5373382568359375
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0057599  Vali Loss: 0.0107943 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.537648677825928
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0054951  Vali Loss: 0.0102901 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.533877611160278
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0058214  Vali Loss: 0.0100994 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.5341973304748535
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0055802  Vali Loss: 0.0115036 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 5.5385582447052
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0053278  Vali Loss: 0.0103443 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 5.532061338424683
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0051580  Vali Loss: 0.0104079 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.535803318023682
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0051580  Vali Loss: 0.0103451 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.532918214797974
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0048256  Vali Loss: 0.0102627 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.537571668624878
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0048173  Vali Loss: 0.0102412 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.539360523223877
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0048442  Vali Loss: 0.0101622 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 39 cost time: 5.538526773452759
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0046699  Vali Loss: 0.0101587 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.539400339126587
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0051834  Vali Loss: 0.0101427 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.5332417488098145
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0046993  Vali Loss: 0.0101407 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.540307998657227
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0047509  Vali Loss: 0.0101403 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.543892860412598
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0047861  Vali Loss: 0.0101351 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8122807  Test weighted F1: 0.7663071  Test macro F1 0.7663071 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.184901714324951
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0061483  Vali Loss: 0.0114033 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
Validation loss decreased (inf --> 0.011403).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.197490453720093
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0051874  Vali Loss: 0.0112140 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
new best score!!!!
Validation loss decreased (0.011403 --> 0.011214).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.183302164077759
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0046240  Vali Loss: 0.0114907 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949713  Vali macro F1 0.9945983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.192967176437378
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0058458  Vali Loss: 0.0107436 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
new best score!!!!
Validation loss decreased (0.011214 --> 0.010744).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.191580533981323
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0053567  Vali Loss: 0.0103566 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.010744 --> 0.010357).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.190731048583984
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0048602  Vali Loss: 0.0097152 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.010357 --> 0.009715).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.193004608154297
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0037723  Vali Loss: 0.0100641 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.185712575912476
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0032552  Vali Loss: 0.0112475 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 7.1867592334747314
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0034340  Vali Loss: 0.0099022 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 7.187226057052612
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0029667  Vali Loss: 0.0107887 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 7.188595294952393
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0032598  Vali Loss: 0.0100243 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 7.196144104003906
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0028857  Vali Loss: 0.0112446 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.1925952434539795
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0027648  Vali Loss: 0.0092849 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.009715 --> 0.009285).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 7.19676947593689
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0027480  Vali Loss: 0.0096776 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.191831111907959
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0032294  Vali Loss: 0.0104675 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.200312376022339
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0041639  Vali Loss: 0.0095351 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.192477226257324
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0023728  Vali Loss: 0.0098761 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.1880457401275635
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0026850  Vali Loss: 0.0100052 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 7.1836419105529785
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0020987  Vali Loss: 0.0098812 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.193233966827393
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0019982  Vali Loss: 0.0099053 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 7.192479133605957
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0019998  Vali Loss: 0.0098433 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 7.186692714691162
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0019689  Vali Loss: 0.0098126 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 7.193396806716919
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0020387  Vali Loss: 0.0097475 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 7.195688247680664
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0019054  Vali Loss: 0.0097450 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 7.197676181793213
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0023256  Vali Loss: 0.0097355 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 7.191951513290405
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0020817  Vali Loss: 0.0097215 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 7.187157392501831
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0020622  Vali Loss: 0.0097144 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 7.199990510940552
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0021119  Vali Loss: 0.0097744 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8131579  Test weighted F1: 0.7679578  Test macro F1 0.7679578 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.644468545913696
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6597196  Vali Loss: 0.4183186 Vali Accuracy: 0.9360902  Vali weighted F1: 0.9306687  Vali macro F1 0.9301378 
Validation loss decreased (inf --> 0.418319).  Saving model ...
Epoch: 2 cost time: 5.559856653213501
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2927617  Vali Loss: 0.1648020 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9735299  Vali macro F1 0.9724432 
new best score!!!!
Validation loss decreased (0.418319 --> 0.164802).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.563058614730835
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1376288  Vali Loss: 0.0865379 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886806  Vali macro F1 0.9882749 
new best score!!!!
Validation loss decreased (0.164802 --> 0.086538).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.568653106689453
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0856552  Vali Loss: 0.0551912 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937581  Vali macro F1 0.9936651 
new best score!!!!
Validation loss decreased (0.086538 --> 0.055191).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.567608833312988
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0611965  Vali Loss: 0.0398640 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924407  Vali macro F1 0.9921247 
new best score!!!!
Validation loss decreased (0.055191 --> 0.039864).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.569278955459595
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0435412  Vali Loss: 0.0372470 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873096  Vali macro F1 0.9864776 
new best score!!!!
Validation loss decreased (0.039864 --> 0.037247).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.571121692657471
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0381054  Vali Loss: 0.0300202 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925463  Vali macro F1 0.9923592 
new best score!!!!
Validation loss decreased (0.037247 --> 0.030020).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.564577579498291
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0299230  Vali Loss: 0.0270616 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899230  Vali macro F1 0.9893316 
new best score!!!!
Validation loss decreased (0.030020 --> 0.027062).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.568759202957153
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0283139  Vali Loss: 0.0222057 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950118  Vali macro F1 0.9948627 
new best score!!!!
Validation loss decreased (0.027062 --> 0.022206).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.569361448287964
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0271868  Vali Loss: 0.0150293 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
new best score!!!!
Validation loss decreased (0.022206 --> 0.015029).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.566075563430786
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0273169  Vali Loss: 0.0192563 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.568887710571289
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0227444  Vali Loss: 0.0200675 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949465  Vali macro F1 0.9948164 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.568454027175903
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0187474  Vali Loss: 0.0138708 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
new best score!!!!
Validation loss decreased (0.015029 --> 0.013871).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.56453013420105
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0141462  Vali Loss: 0.0091231 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
new best score!!!!
Validation loss decreased (0.013871 --> 0.009123).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.566986799240112
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0125528  Vali Loss: 0.0120936 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.5572545528411865
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0119960  Vali Loss: 0.0093339 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.552886724472046
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0144559  Vali Loss: 0.0182985 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925059  Vali macro F1 0.9921562 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 5.552150011062622
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0135014  Vali Loss: 0.0120072 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975072  Vali macro F1 0.9975414 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 19 cost time: 5.550590753555298
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0096983  Vali Loss: 0.0089094 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
new best score!!!!
Validation loss decreased (0.009123 --> 0.008909).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.556480884552002
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0082686  Vali Loss: 0.0090659 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.554354906082153
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0083387  Vali Loss: 0.0065465 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008909 --> 0.006547).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.556057691574097
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0076696  Vali Loss: 0.0056369 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.006547 --> 0.005637).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.556970834732056
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0079065  Vali Loss: 0.0065879 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.553293228149414
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0080979  Vali Loss: 0.0070034 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.557969570159912
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0070069  Vali Loss: 0.0059951 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.549749851226807
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0062568  Vali Loss: 0.0073506 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975072  Vali macro F1 0.9975414 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.549565553665161
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0099281  Vali Loss: 0.0056096 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005637 --> 0.005610).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.551228284835815
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0063996  Vali Loss: 0.0062641 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.552661418914795
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0069271  Vali Loss: 0.0114476 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962620  Vali macro F1 0.9962010 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.5514280796051025
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0083103  Vali Loss: 0.0119188 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.554333925247192
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0071134  Vali Loss: 0.0083004 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.555653095245361
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0046249  Vali Loss: 0.0083508 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 5.550033807754517
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0039101  Vali Loss: 0.0050515 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.005610 --> 0.005051).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.558149576187134
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0030397  Vali Loss: 0.0056356 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.5545690059661865
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0033391  Vali Loss: 0.0058807 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.561378717422485
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0031720  Vali Loss: 0.0065855 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.5514726638793945
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0030457  Vali Loss: 0.0067650 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.5537896156311035
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0028456  Vali Loss: 0.0064348 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 5.554476499557495
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0029237  Vali Loss: 0.0064240 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.547194719314575
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0028352  Vali Loss: 0.0063706 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.546767473220825
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0027643  Vali Loss: 0.0063703 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.551237344741821
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0027818  Vali Loss: 0.0063828 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.558440208435059
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0027364  Vali Loss: 0.0063025 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 5.5534985065460205
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0028764  Vali Loss: 0.0063030 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.557580947875977
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0027000  Vali Loss: 0.0063094 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.557666063308716
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0026700  Vali Loss: 0.0063070 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.548188209533691
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0028954  Vali Loss: 0.0063097 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.5483314990997314
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0034626  Vali Loss: 0.0063124 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9482456  Test weighted F1: 0.9474277  Test macro F1 0.9474277 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.168604373931885
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0037604  Vali Loss: 0.0055581 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
Validation loss decreased (inf --> 0.005558).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.157122611999512
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0028278  Vali Loss: 0.0079017 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.157872676849365
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0029126  Vali Loss: 0.0071581 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.158208608627319
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0022776  Vali Loss: 0.0072307 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 7.163712978363037
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0021583  Vali Loss: 0.0080337 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 7.170931577682495
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0021523  Vali Loss: 0.0078945 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.1746697425842285
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0020973  Vali Loss: 0.0100847 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 7.168954133987427
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0032079  Vali Loss: 0.0055034 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.005558 --> 0.005503).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.170360803604126
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0024299  Vali Loss: 0.0060887 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.169087171554565
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0020794  Vali Loss: 0.0066257 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.173786640167236
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0020525  Vali Loss: 0.0068205 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 7.175678491592407
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0020129  Vali Loss: 0.0064358 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 7.1742894649505615
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0019227  Vali Loss: 0.0077252 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975072  Vali macro F1 0.9975414 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 7.176584005355835
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0015029  Vali Loss: 0.0078270 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975072  Vali macro F1 0.9975414 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.180463552474976
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0019016  Vali Loss: 0.0078205 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.175374269485474
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0017144  Vali Loss: 0.0081219 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.173893928527832
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0016666  Vali Loss: 0.0085274 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.171163082122803
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0016395  Vali Loss: 0.0087119 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 19 cost time: 7.17534327507019
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0013838  Vali Loss: 0.0087256 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.167188882827759
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0016971  Vali Loss: 0.0087515 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 7.170924186706543
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0015527  Vali Loss: 0.0087922 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 7.166907787322998
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0015518  Vali Loss: 0.0088035 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 7.166383504867554
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0015542  Vali Loss: 0.0088048 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9184211  Test weighted F1: 0.9071305  Test macro F1 0.9071305 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.672582149505615
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6468850  Vali Loss: 0.4342778 Vali Accuracy: 0.9223058  Vali weighted F1: 0.9162269  Vali macro F1 0.9122882 
Validation loss decreased (inf --> 0.434278).  Saving model ...
Epoch: 2 cost time: 5.566572666168213
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2947503  Vali Loss: 0.1478213 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9675546  Vali macro F1 0.9657820 
new best score!!!!
Validation loss decreased (0.434278 --> 0.147821).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.557635307312012
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1301831  Vali Loss: 0.0788982 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872631  Vali macro F1 0.9866012 
new best score!!!!
Validation loss decreased (0.147821 --> 0.078898).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.563049077987671
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0741187  Vali Loss: 0.0480339 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872631  Vali macro F1 0.9866012 
new best score!!!!
Validation loss decreased (0.078898 --> 0.048034).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.561028003692627
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0510294  Vali Loss: 0.0464550 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861758  Vali macro F1 0.9853337 
new best score!!!!
Validation loss decreased (0.048034 --> 0.046455).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.576016426086426
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0413221  Vali Loss: 0.0335200 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924365  Vali macro F1 0.9920866 
new best score!!!!
Validation loss decreased (0.046455 --> 0.033520).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.5690436363220215
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0316468  Vali Loss: 0.0320414 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886163  Vali macro F1 0.9878849 
new best score!!!!
Validation loss decreased (0.033520 --> 0.032041).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.560619115829468
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0283531  Vali Loss: 0.0305388 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910650  Vali macro F1 0.9906732 
new best score!!!!
Validation loss decreased (0.032041 --> 0.030539).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.5635764598846436
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0233552  Vali Loss: 0.0239332 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949607  Vali macro F1 0.9947258 
new best score!!!!
Validation loss decreased (0.030539 --> 0.023933).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.559322118759155
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0205606  Vali Loss: 0.0198694 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.023933 --> 0.019869).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.560723781585693
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0160065  Vali Loss: 0.0246667 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911760  Vali macro F1 0.9905102 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.857910394668579
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0146019  Vali Loss: 0.0176525 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
new best score!!!!
Validation loss decreased (0.019869 --> 0.017653).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.563673973083496
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0147830  Vali Loss: 0.0206846 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949713  Vali macro F1 0.9945983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.563204765319824
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0161054  Vali Loss: 0.0155911 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
new best score!!!!
Validation loss decreased (0.017653 --> 0.015591).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.5689287185668945
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0133542  Vali Loss: 0.0154229 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
new best score!!!!
Validation loss decreased (0.015591 --> 0.015423).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.583818197250366
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0098020  Vali Loss: 0.0165378 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.583872318267822
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0122892  Vali Loss: 0.0204530 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936967  Vali macro F1 0.9932186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.578564167022705
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0134043  Vali Loss: 0.0164785 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937049  Vali macro F1 0.9932577 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.565715551376343
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0102332  Vali Loss: 0.0164908 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.574896812438965
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0079445  Vali Loss: 0.0166042 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 5.578305721282959
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0061752  Vali Loss: 0.0142009 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
new best score!!!!
Validation loss decreased (0.015423 --> 0.014201).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.576366186141968
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0052654  Vali Loss: 0.0143129 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9973137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.570276260375977
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0051526  Vali Loss: 0.0148297 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.570952415466309
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0042915  Vali Loss: 0.0142434 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.5736985206604
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0043965  Vali Loss: 0.0151488 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949713  Vali macro F1 0.9945983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.570962905883789
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0042508  Vali Loss: 0.0156017 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 27 cost time: 5.56798243522644
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0039848  Vali Loss: 0.0155446 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.5652406215667725
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0038911  Vali Loss: 0.0153299 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.563025951385498
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0039759  Vali Loss: 0.0152611 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 5.561786651611328
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0038173  Vali Loss: 0.0151801 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 5.5679004192352295
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0039886  Vali Loss: 0.0151578 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 32 cost time: 5.56739354133606
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0041331  Vali Loss: 0.0150966 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.571583986282349
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0038438  Vali Loss: 0.0150880 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.566232442855835
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0039732  Vali Loss: 0.0150898 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.567505121231079
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0041651  Vali Loss: 0.0150810 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.565963983535767
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0039950  Vali Loss: 0.0150747 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9280702  Test weighted F1: 0.9085263  Test macro F1 0.9085263 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.145205497741699
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0052864  Vali Loss: 0.0163802 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
Validation loss decreased (inf --> 0.016380).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.150904178619385
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0044784  Vali Loss: 0.0142118 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.016380 --> 0.014212).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.1493566036224365
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0038403  Vali Loss: 0.0137338 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
new best score!!!!
Validation loss decreased (0.014212 --> 0.013734).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.151873826980591
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0033646  Vali Loss: 0.0146761 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.153100490570068
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0032583  Vali Loss: 0.0158842 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 7.152407646179199
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0026306  Vali Loss: 0.0175894 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 7.148305177688599
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0027053  Vali Loss: 0.0162289 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 7.153939962387085
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0030171  Vali Loss: 0.0161415 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 7.158095598220825
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0030337  Vali Loss: 0.0164651 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.153757572174072
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0022157  Vali Loss: 0.0177706 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.153791189193726
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0019507  Vali Loss: 0.0189777 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 7.1506187915802
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0018278  Vali Loss: 0.0200118 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 7.149611473083496
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0020316  Vali Loss: 0.0188505 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 7.151817321777344
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0020670  Vali Loss: 0.0188502 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.155628204345703
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0020645  Vali Loss: 0.0186713 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.153747797012329
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0015995  Vali Loss: 0.0186813 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.1553380489349365
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0018902  Vali Loss: 0.0187266 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.150882959365845
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0014635  Vali Loss: 0.0188046 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9298246  Test weighted F1: 0.9089928  Test macro F1 0.9089928 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.6320481300354
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6704730  Vali Loss: 0.4471206 Vali Accuracy: 0.9260652  Vali weighted F1: 0.9172917  Vali macro F1 0.9157725 
Validation loss decreased (inf --> 0.447121).  Saving model ...
Epoch: 2 cost time: 5.552182197570801
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2833648  Vali Loss: 0.1575301 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9629978  Vali macro F1 0.9626567 
new best score!!!!
Validation loss decreased (0.447121 --> 0.157530).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.554747581481934
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1250729  Vali Loss: 0.0743586 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936844  Vali macro F1 0.9929538 
new best score!!!!
Validation loss decreased (0.157530 --> 0.074359).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.554125547409058
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0705319  Vali Loss: 0.0449560 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.074359 --> 0.044956).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.565301895141602
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0479932  Vali Loss: 0.0298183 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.044956 --> 0.029818).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.567978620529175
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0372493  Vali Loss: 0.0257673 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937037  Vali macro F1 0.9932293 
new best score!!!!
Validation loss decreased (0.029818 --> 0.025767).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.567007303237915
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0269298  Vali Loss: 0.0217880 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949500  Vali macro F1 0.9945176 
new best score!!!!
Validation loss decreased (0.025767 --> 0.021788).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.5574727058410645
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0258288  Vali Loss: 0.0168696 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.021788 --> 0.016870).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.5556676387786865
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0186808  Vali Loss: 0.0112208 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.016870 --> 0.011221).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.554689407348633
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0149229  Vali Loss: 0.0089103 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.011221 --> 0.008910).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.561959505081177
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0108638  Vali Loss: 0.0095644 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.566437005996704
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0085421  Vali Loss: 0.0072474 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
new best score!!!!
Validation loss decreased (0.008910 --> 0.007247).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.562333583831787
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0113690  Vali Loss: 0.0062977 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007247 --> 0.006298).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.559638500213623
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0122322  Vali Loss: 0.0130063 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937084  Vali macro F1 0.9931580 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.560060977935791
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0102679  Vali Loss: 0.0092857 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.560263395309448
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0072043  Vali Loss: 0.0052363 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
new best score!!!!
Validation loss decreased (0.006298 --> 0.005236).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.558529615402222
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0063277  Vali Loss: 0.0122260 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.559077501296997
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0189862  Vali Loss: 0.0256091 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937033  Vali macro F1 0.9934549 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.555464029312134
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0092412  Vali Loss: 0.0072656 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 7.599326133728027
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0048547  Vali Loss: 0.0032831 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005236 --> 0.003283).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.650295257568359
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0076152  Vali Loss: 0.0075718 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.546679496765137
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0080923  Vali Loss: 0.0060704 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.545216083526611
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0032186  Vali Loss: 0.0020161 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003283 --> 0.002016).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.555338382720947
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0037001  Vali Loss: 0.0049194 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987452  Vali macro F1 0.9986537 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.545582294464111
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0045869  Vali Loss: 0.0165001 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924999  Vali macro F1 0.9922947 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.549060583114624
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0178735  Vali Loss: 0.0088025 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.546289682388306
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0087160  Vali Loss: 0.0056388 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.54681658744812
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0046129  Vali Loss: 0.0040409 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 5.544642448425293
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0030389  Vali Loss: 0.0037962 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.54109787940979
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0023190  Vali Loss: 0.0039893 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.542467355728149
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0022207  Vali Loss: 0.0040306 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.541101455688477
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0021220  Vali Loss: 0.0038294 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 5.551518678665161
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0017587  Vali Loss: 0.0035402 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 5.545785665512085
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0017300  Vali Loss: 0.0035560 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.544305801391602
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0017691  Vali Loss: 0.0035692 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.546639442443848
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0018555  Vali Loss: 0.0035436 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.543478012084961
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0017208  Vali Loss: 0.0035607 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.542433977127075
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0015914  Vali Loss: 0.0036172 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8333333  Test weighted F1: 0.8145576  Test macro F1 0.8145576 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.2390007972717285
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0023228  Vali Loss: 0.0020786 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.002079).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.137279033660889
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0019402  Vali Loss: 0.0019358 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002079 --> 0.001936).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.13685154914856
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0018677  Vali Loss: 0.0020822 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.143933296203613
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0011640  Vali Loss: 0.0018177 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.001936 --> 0.001818).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.152229309082031
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0009428  Vali Loss: 0.0023302 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 7.151654481887817
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0008060  Vali Loss: 0.0021673 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 7.156387805938721
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0008005  Vali Loss: 0.0017729 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001818 --> 0.001773).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.1592934131622314
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0008196  Vali Loss: 0.0016934 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.001773 --> 0.001693).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.151731491088867
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0006595  Vali Loss: 0.0020209 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.150171995162964
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0004670  Vali Loss: 0.0019654 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.144697189331055
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0004126  Vali Loss: 0.0015948 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.001693 --> 0.001595).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.1598219871521
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0004335  Vali Loss: 0.0013973 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.001595 --> 0.001397).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 7.148942232131958
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0003577  Vali Loss: 0.0012955 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.001397 --> 0.001295).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 7.147557973861694
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0003466  Vali Loss: 0.0008947 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001295 --> 0.000895).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 7.14787483215332
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0003016  Vali Loss: 0.0006733 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000895 --> 0.000673).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 7.154715061187744
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0002931  Vali Loss: 0.0010932 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 7.1490819454193115
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0002433  Vali Loss: 0.0015375 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 7.1449949741363525
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0018384  Vali Loss: 0.0024331 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 7.153447151184082
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0007778  Vali Loss: 0.0018593 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9986598 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 7.151947259902954
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0008887  Vali Loss: 0.0049044 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 21 cost time: 7.146774768829346
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0016529  Vali Loss: 0.0023873 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 7.146943092346191
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0007291  Vali Loss: 0.0030222 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 7.147897005081177
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0003765  Vali Loss: 0.0035179 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 7.149497985839844
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0002692  Vali Loss: 0.0037777 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 7.149678468704224
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0002296  Vali Loss: 0.0021927 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 7.144040822982788
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0002051  Vali Loss: 0.0021632 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 7.146231651306152
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0003016  Vali Loss: 0.0017093 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 7.146799564361572
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0002327  Vali Loss: 0.0017330 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 7.1456520557403564
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0002385  Vali Loss: 0.0017511 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 7.151352643966675
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0003064  Vali Loss: 0.0017689 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987479  Vali macro F1 0.9988739 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8385965  Test weighted F1: 0.8153830  Test macro F1 0.8153830 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1618428
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.604775428771973
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6346608  Vali Loss: 0.4817291 Vali Accuracy: 0.8997494  Vali weighted F1: 0.8925969  Vali macro F1 0.8844183 
Validation loss decreased (inf --> 0.481729).  Saving model ...
Epoch: 2 cost time: 5.521763324737549
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2871805  Vali Loss: 0.1663460 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9677667  Vali macro F1 0.9681527 
new best score!!!!
Validation loss decreased (0.481729 --> 0.166346).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.527762174606323
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1314324  Vali Loss: 0.0917797 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835662  Vali macro F1 0.9841246 
new best score!!!!
Validation loss decreased (0.166346 --> 0.091780).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.526636838912964
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0763794  Vali Loss: 0.0576331 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911895  Vali macro F1 0.9912799 
new best score!!!!
Validation loss decreased (0.091780 --> 0.057633).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.535946607589722
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0553369  Vali Loss: 0.0425112 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899642  Vali macro F1 0.9903245 
new best score!!!!
Validation loss decreased (0.057633 --> 0.042511).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.542404890060425
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0476839  Vali Loss: 0.0399074 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924823  Vali macro F1 0.9928220 
new best score!!!!
Validation loss decreased (0.042511 --> 0.039907).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.553369045257568
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0431986  Vali Loss: 0.0300119 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937088  Vali macro F1 0.9938278 
new best score!!!!
Validation loss decreased (0.039907 --> 0.030012).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.554475784301758
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0306751  Vali Loss: 0.0215279 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9976266 
new best score!!!!
Validation loss decreased (0.030012 --> 0.021528).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.5578718185424805
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0262121  Vali Loss: 0.0212005 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.021528 --> 0.021200).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.563428640365601
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0223656  Vali Loss: 0.0316180 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860948  Vali macro F1 0.9866273 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.558527708053589
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0236688  Vali Loss: 0.0161545 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9976266 
new best score!!!!
Validation loss decreased (0.021200 --> 0.016154).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.5660388469696045
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0237164  Vali Loss: 0.0198218 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937393  Vali macro F1 0.9939472 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.573758363723755
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0235920  Vali Loss: 0.0184221 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962431  Vali macro F1 0.9964145 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.57317852973938
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0171940  Vali Loss: 0.0129220 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.016154 --> 0.012922).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.577820777893066
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0149190  Vali Loss: 0.0154494 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975090  Vali macro F1 0.9975187 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.575934171676636
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0118799  Vali Loss: 0.0123487 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974912  Vali macro F1 0.9977272 
new best score!!!!
Validation loss decreased (0.012922 --> 0.012349).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.581786870956421
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0090276  Vali Loss: 0.0225939 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925497  Vali macro F1 0.9927369 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.579288005828857
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0255248  Vali Loss: 0.0129516 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962351  Vali macro F1 0.9963362 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.57584547996521
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0162987  Vali Loss: 0.0169190 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.581761837005615
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0157521  Vali Loss: 0.0208017 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924797  Vali macro F1 0.9928933 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 5.585793733596802
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0190304  Vali Loss: 0.0121411 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974912  Vali macro F1 0.9977272 
new best score!!!!
Validation loss decreased (0.012349 --> 0.012141).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.583900451660156
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0114873  Vali Loss: 0.0146433 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962346  Vali macro F1 0.9962209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.5784666538238525
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0153325  Vali Loss: 0.0149186 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974912  Vali macro F1 0.9977272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.578420639038086
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0136334  Vali Loss: 0.0108059 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.012141 --> 0.010806).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.463136196136475
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0111722  Vali Loss: 0.0144620 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 7.601634979248047
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0181432  Vali Loss: 0.0123086 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.560851812362671
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0142005  Vali Loss: 0.0091005 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987494  Vali macro F1 0.9988423 
new best score!!!!
Validation loss decreased (0.010806 --> 0.009100).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.566930294036865
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0087516  Vali Loss: 0.0074352 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987447  Vali macro F1 0.9988845 
new best score!!!!
Validation loss decreased (0.009100 --> 0.007435).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.573935031890869
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0088463  Vali Loss: 0.0058169 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007435 --> 0.005817).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.579911947250366
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0062464  Vali Loss: 0.0049918 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005817 --> 0.004992).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.5836944580078125
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0053197  Vali Loss: 0.0052960 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.579376459121704
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0053527  Vali Loss: 0.0066129 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.568048715591431
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0056770  Vali Loss: 0.0043571 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004992 --> 0.004357).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.576253414154053
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0192136  Vali Loss: 0.0154461 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.5769078731536865
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0126640  Vali Loss: 0.0093914 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987447  Vali macro F1 0.9988845 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.573696136474609
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0210774  Vali Loss: 0.0160482 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.571614503860474
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0115453  Vali Loss: 0.0095668 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.5694899559021
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0065100  Vali Loss: 0.0058560 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 5.5686118602752686
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0046407  Vali Loss: 0.0059930 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.5666985511779785
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0040935  Vali Loss: 0.0056091 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.564528465270996
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0040507  Vali Loss: 0.0052607 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.567026853561401
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0039292  Vali Loss: 0.0051783 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.568495512008667
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0037876  Vali Loss: 0.0050448 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 5.562061548233032
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0035154  Vali Loss: 0.0050388 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.565652370452881
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0035234  Vali Loss: 0.0050443 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.570714235305786
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0034051  Vali Loss: 0.0050854 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.565337181091309
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0036228  Vali Loss: 0.0051724 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.570703029632568
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0033953  Vali Loss: 0.0052188 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8438596  Test weighted F1: 0.8230829  Test macro F1 0.8230829 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.216046094894409
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0032599  Vali Loss: 0.0031685 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.003169).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.147496223449707
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0030912  Vali Loss: 0.0036669 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.150960683822632
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0033514  Vali Loss: 0.0031511 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003169 --> 0.003151).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.154773950576782
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0028667  Vali Loss: 0.0030675 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003151 --> 0.003067).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.161965608596802
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0026967  Vali Loss: 0.0027869 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003067 --> 0.002787).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.153533220291138
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0024038  Vali Loss: 0.0026249 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002787 --> 0.002625).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.15770149230957
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0018751  Vali Loss: 0.0033517 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.156136989593506
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0018502  Vali Loss: 0.0023253 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002625 --> 0.002325).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.164335489273071
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0022458  Vali Loss: 0.0027880 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.153880834579468
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0018643  Vali Loss: 0.0027259 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.155484676361084
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0018878  Vali Loss: 0.0020943 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002325 --> 0.002094).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.153789281845093
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0016134  Vali Loss: 0.0020535 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002094 --> 0.002054).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 7.157789468765259
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0015930  Vali Loss: 0.0021144 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.160334825515747
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0021580  Vali Loss: 0.0032723 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 8.813570261001587
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0022063  Vali Loss: 0.0027258 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 7.15166711807251
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0016972  Vali Loss: 0.0018405 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002054 --> 0.001841).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 7.159866571426392
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0015281  Vali Loss: 0.0028877 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.161712884902954
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0016050  Vali Loss: 0.0028968 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.154523134231567
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0014012  Vali Loss: 0.0026307 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.157404899597168
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0018263  Vali Loss: 0.0033736 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.160886287689209
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0014534  Vali Loss: 0.0057850 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 22 cost time: 7.156329870223999
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0022690  Vali Loss: 0.0033526 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.164888858795166
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0015897  Vali Loss: 0.0048498 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.150556564331055
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0038254  Vali Loss: 0.0082304 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.154342412948608
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0021459  Vali Loss: 0.0061814 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.155458927154541
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018851  Vali Loss: 0.0026605 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 7.161970138549805
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0017050  Vali Loss: 0.0032805 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 7.149961709976196
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0015483  Vali Loss: 0.0033482 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 7.158582925796509
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0027776  Vali Loss: 0.0029692 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 7.154388427734375
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0014055  Vali Loss: 0.0032244 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 7.157725811004639
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0017559  Vali Loss: 0.0031664 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8535088  Test weighted F1: 0.8319892  Test macro F1 0.8319892 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.61870551109314
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6543730  Vali Loss: 0.4425214 Vali Accuracy: 0.9235589  Vali weighted F1: 0.9184210  Vali macro F1 0.9160420 
Validation loss decreased (inf --> 0.442521).  Saving model ...
Epoch: 2 cost time: 5.557034730911255
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2859653  Vali Loss: 0.1587580 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9694021  Vali macro F1 0.9695886 
new best score!!!!
Validation loss decreased (0.442521 --> 0.158758).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.5548014640808105
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1289486  Vali Loss: 0.0809237 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9834732  Vali macro F1 0.9839544 
new best score!!!!
Validation loss decreased (0.158758 --> 0.080924).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.557950496673584
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0783421  Vali Loss: 0.0509869 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886430  Vali macro F1 0.9891699 
new best score!!!!
Validation loss decreased (0.080924 --> 0.050987).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.557767629623413
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0528610  Vali Loss: 0.0408403 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876531  Vali macro F1 0.9882991 
new best score!!!!
Validation loss decreased (0.050987 --> 0.040840).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.560347080230713
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0412961  Vali Loss: 0.0467598 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873856  Vali macro F1 0.9878607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 5.5622193813323975
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0450860  Vali Loss: 0.0289002 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924146  Vali macro F1 0.9926225 
new best score!!!!
Validation loss decreased (0.040840 --> 0.028900).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.55746603012085
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0305751  Vali Loss: 0.0217960 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.028900 --> 0.021796).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.5599353313446045
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0247097  Vali Loss: 0.0192540 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974912  Vali macro F1 0.9977272 
new best score!!!!
Validation loss decreased (0.021796 --> 0.019254).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.556215524673462
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0217270  Vali Loss: 0.0201657 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9975721 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.5559868812561035
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0181547  Vali Loss: 0.0143006 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.019254 --> 0.014301).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.559576511383057
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0210243  Vali Loss: 0.0131854 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014301 --> 0.013185).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.55897068977356
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0145103  Vali Loss: 0.0135140 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.559290170669556
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0160804  Vali Loss: 0.0123037 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.013185 --> 0.012304).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.553252458572388
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0148322  Vali Loss: 0.0132579 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.5559186935424805
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0104386  Vali Loss: 0.0075914 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012304 --> 0.007591).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.554460763931274
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0091648  Vali Loss: 0.0098339 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.551404714584351
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0118608  Vali Loss: 0.0127958 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.548479795455933
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0149523  Vali Loss: 0.0101251 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987467  Vali macro F1 0.9987161 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.551296234130859
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0162292  Vali Loss: 0.0764653 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9724751  Vali macro F1 0.9737022 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 5.545419692993164
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0577368  Vali Loss: 0.0319684 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898405  Vali macro F1 0.9901858 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 5.546003818511963
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0296001  Vali Loss: 0.0254999 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911633  Vali macro F1 0.9915143 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.552098751068115
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0248551  Vali Loss: 0.0224364 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924412  Vali macro F1 0.9927611 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.549806833267212
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0205457  Vali Loss: 0.0208404 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.550625801086426
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0197792  Vali Loss: 0.0179719 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.546260595321655
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0209978  Vali Loss: 0.0151800 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 27 cost time: 5.551959991455078
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0158485  Vali Loss: 0.0150187 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.542928457260132
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0158363  Vali Loss: 0.0148514 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.542912006378174
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0154635  Vali Loss: 0.0147389 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 5.543546676635742
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0152975  Vali Loss: 0.0145570 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 5.546356916427612
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0152224  Vali Loss: 0.0144066 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9429825  Test weighted F1: 0.9274659  Test macro F1 0.9274659 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.235441207885742
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0072010  Vali Loss: 0.0060503 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
Validation loss decreased (inf --> 0.006050).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.173473358154297
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0061309  Vali Loss: 0.0048075 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006050 --> 0.004807).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.179076194763184
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0052851  Vali Loss: 0.0037644 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004807 --> 0.003764).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.178739547729492
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0047734  Vali Loss: 0.0056796 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.18700385093689
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0038524  Vali Loss: 0.0035866 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.003764 --> 0.003587).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.180174350738525
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0041094  Vali Loss: 0.0043935 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.182957410812378
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0036105  Vali Loss: 0.0043125 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 7.185589551925659
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0035662  Vali Loss: 0.0042002 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 7.181609392166138
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0030925  Vali Loss: 0.0039777 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 7.181517601013184
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0032105  Vali Loss: 0.0033529 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.003587 --> 0.003353).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 7.1856584548950195
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0030658  Vali Loss: 0.0051791 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.1873228549957275
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0042852  Vali Loss: 0.0039941 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 7.188094615936279
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0027391  Vali Loss: 0.0032998 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.003353 --> 0.003300).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 7.199904441833496
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0028742  Vali Loss: 0.0068058 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.192489862442017
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0023929  Vali Loss: 0.0047786 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.18539023399353
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0022790  Vali Loss: 0.0039734 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.185261011123657
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0021189  Vali Loss: 0.0045155 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.190279483795166
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0019571  Vali Loss: 0.0039127 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 7.185055732727051
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0019123  Vali Loss: 0.0036222 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.1915154457092285
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0025203  Vali Loss: 0.0049864 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9975721 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 7.18523383140564
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0052593  Vali Loss: 0.0027801 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003300 --> 0.002780).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 7.1892266273498535
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0046731  Vali Loss: 0.0044830 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.191273212432861
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0028259  Vali Loss: 0.0041850 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.1853392124176025
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0020581  Vali Loss: 0.0043500 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.186280012130737
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0021088  Vali Loss: 0.0040754 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.188988924026489
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0020998  Vali Loss: 0.0049913 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 7.18350887298584
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0020214  Vali Loss: 0.0045175 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 7.189275026321411
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0019421  Vali Loss: 0.0042474 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 7.193218946456909
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0017940  Vali Loss: 0.0041696 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 7.18786358833313
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0017155  Vali Loss: 0.0041045 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 7.188692092895508
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0015915  Vali Loss: 0.0041092 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 7.182019948959351
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0020106  Vali Loss: 0.0041249 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 7.185264825820923
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0017991  Vali Loss: 0.0041246 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 7.187551021575928
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0015220  Vali Loss: 0.0041407 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 7.180706739425659
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0019438  Vali Loss: 0.0041454 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 7.189219236373901
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0018141  Vali Loss: 0.0041588 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9105263  Test weighted F1: 0.8903041  Test macro F1 0.8903041 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.675347328186035
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6634995  Vali Loss: 0.4623782 Vali Accuracy: 0.9085213  Vali weighted F1: 0.9076817  Vali macro F1 0.9077251 
Validation loss decreased (inf --> 0.462378).  Saving model ...
Epoch: 2 cost time: 5.573954343795776
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2815914  Vali Loss: 0.1442278 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9743239  Vali macro F1 0.9741744 
new best score!!!!
Validation loss decreased (0.462378 --> 0.144228).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.578132390975952
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1246517  Vali Loss: 0.0869211 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846879  Vali macro F1 0.9848354 
new best score!!!!
Validation loss decreased (0.144228 --> 0.086921).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.5791826248168945
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0849034  Vali Loss: 0.0548797 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873457  Vali macro F1 0.9873401 
new best score!!!!
Validation loss decreased (0.086921 --> 0.054880).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.573726654052734
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0487439  Vali Loss: 0.0371277 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924376  Vali macro F1 0.9922856 
new best score!!!!
Validation loss decreased (0.054880 --> 0.037128).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.580270051956177
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0442294  Vali Loss: 0.0320367 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924376  Vali macro F1 0.9922856 
new best score!!!!
Validation loss decreased (0.037128 --> 0.032037).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.575939893722534
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0318343  Vali Loss: 0.0365628 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885794  Vali macro F1 0.9890424 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.577467441558838
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0294298  Vali Loss: 0.0221097 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.032037 --> 0.022110).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.579802513122559
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0226236  Vali Loss: 0.0201829 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.022110 --> 0.020183).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.575604438781738
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0185400  Vali Loss: 0.0464744 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9785624  Vali macro F1 0.9795200 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.5732362270355225
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0201709  Vali Loss: 0.0204809 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.577544927597046
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0140906  Vali Loss: 0.0172069 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.020183 --> 0.017207).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.57896089553833
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0112026  Vali Loss: 0.0183068 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.575523853302002
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0221430  Vali Loss: 0.0249391 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911008  Vali macro F1 0.9914758 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.576304197311401
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0150535  Vali Loss: 0.0175470 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 5.571690320968628
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0145748  Vali Loss: 0.0213654 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 17 cost time: 5.569529294967651
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0109626  Vali Loss: 0.0158764 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
new best score!!!!
Validation loss decreased (0.017207 --> 0.015876).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.571950435638428
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0100057  Vali Loss: 0.0127009 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.015876 --> 0.012701).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.573904037475586
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0145525  Vali Loss: 0.0161212 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.57488489151001
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0125070  Vali Loss: 0.0172832 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924597  Vali macro F1 0.9928417 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.572239875793457
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0103802  Vali Loss: 0.0116502 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.012701 --> 0.011650).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.5698628425598145
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0068877  Vali Loss: 0.0125228 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.576959848403931
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0111960  Vali Loss: 0.0174741 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924146  Vali macro F1 0.9926225 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.572410821914673
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0176146  Vali Loss: 0.0155910 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.571493625640869
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0088957  Vali Loss: 0.0168096 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924451  Vali macro F1 0.9926619 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.56575345993042
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0126951  Vali Loss: 0.0196246 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899749  Vali macro F1 0.9902886 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 5.565387010574341
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0089047  Vali Loss: 0.0142554 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.565705299377441
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0066771  Vali Loss: 0.0119783 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.556566953659058
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0059231  Vali Loss: 0.0114678 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.011650 --> 0.011468).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.567325830459595
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0056517  Vali Loss: 0.0110903 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.011468 --> 0.011090).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.563668727874756
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0052113  Vali Loss: 0.0114799 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.563075542449951
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0046567  Vali Loss: 0.0107685 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.011090 --> 0.010768).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.566078186035156
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0045836  Vali Loss: 0.0112812 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.565967798233032
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0050731  Vali Loss: 0.0103451 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.010768 --> 0.010345).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.56524658203125
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0043481  Vali Loss: 0.0121773 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.56934118270874
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0041245  Vali Loss: 0.0111690 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.565479755401611
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0040843  Vali Loss: 0.0128664 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 5.563882827758789
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0038721  Vali Loss: 0.0117220 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 5.564209699630737
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0037647  Vali Loss: 0.0114955 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 5.560636520385742
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0034960  Vali Loss: 0.0115584 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.5623908042907715
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0036451  Vali Loss: 0.0117994 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.5671422481536865
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0037390  Vali Loss: 0.0116818 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.567767381668091
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0038095  Vali Loss: 0.0118004 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.565506219863892
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0037679  Vali Loss: 0.0121776 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 5.570801734924316
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0035769  Vali Loss: 0.0121537 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.566091775894165
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0037217  Vali Loss: 0.0121580 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.567062139511108
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0033775  Vali Loss: 0.0121728 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.568670988082886
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0033801  Vali Loss: 0.0121343 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.571786165237427
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0031725  Vali Loss: 0.0120908 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8561404  Test weighted F1: 0.8354648  Test macro F1 0.8354648 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.148597240447998
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0043610  Vali Loss: 0.0110201 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
Validation loss decreased (inf --> 0.011020).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.147801160812378
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0038441  Vali Loss: 0.0104521 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.011020 --> 0.010452).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.298324108123779
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0039926  Vali Loss: 0.0121419 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.14103889465332
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0028311  Vali Loss: 0.0112019 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 7.149561882019043
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0025487  Vali Loss: 0.0104088 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.010452 --> 0.010409).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.1521570682525635
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0033366  Vali Loss: 0.0139125 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.152320861816406
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0036677  Vali Loss: 0.0106452 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 7.148063659667969
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0030067  Vali Loss: 0.0097242 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.010409 --> 0.009724).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.152343511581421
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0026699  Vali Loss: 0.0094965 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.009724 --> 0.009496).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 7.1577887535095215
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0026173  Vali Loss: 0.0095012 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 7.145402431488037
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0043574  Vali Loss: 0.0099854 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 7.150224208831787
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0023987  Vali Loss: 0.0115871 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 7.148029804229736
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0020951  Vali Loss: 0.0096182 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 7.1472108364105225
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0022436  Vali Loss: 0.0093986 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.009496 --> 0.009399).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 7.156842947006226
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0018721  Vali Loss: 0.0089159 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.009399 --> 0.008916).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 7.153504848480225
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0018149  Vali Loss: 0.0106198 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 7.1526453495025635
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0020442  Vali Loss: 0.0091348 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 7.14399790763855
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0019282  Vali Loss: 0.0103640 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 7.15386176109314
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0016834  Vali Loss: 0.0088694 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.008916 --> 0.008869).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 7.1525657176971436
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0015686  Vali Loss: 0.0112708 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 7.146315336227417
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0015498  Vali Loss: 0.0088961 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 7.15203332901001
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0022720  Vali Loss: 0.0160377 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 7.152156829833984
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0051233  Vali Loss: 0.0114125 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 7.153944969177246
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0037619  Vali Loss: 0.0128843 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 25 cost time: 7.148218393325806
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0032163  Vali Loss: 0.0086982 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.008869 --> 0.008698).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 7.151997327804565
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0024290  Vali Loss: 0.0108662 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949738  Vali macro F1 0.9947555 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 7.143333196640015
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0017330  Vali Loss: 0.0120443 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 7.148867845535278
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0022602  Vali Loss: 0.0094416 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 7.147943735122681
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0018852  Vali Loss: 0.0121766 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 7.145279169082642
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0021386  Vali Loss: 0.0117022 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 7.148355722427368
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0017697  Vali Loss: 0.0115433 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 7.141870975494385
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0015539  Vali Loss: 0.0115053 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 7.1506125926971436
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0017009  Vali Loss: 0.0112751 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 7.1404078006744385
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0014471  Vali Loss: 0.0110582 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 7.143973350524902
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0015764  Vali Loss: 0.0109362 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 36 cost time: 7.1466286182403564
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0016073  Vali Loss: 0.0109473 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 7.15232253074646
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0015364  Vali Loss: 0.0109465 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 7.146228790283203
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0016098  Vali Loss: 0.0109405 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 7.1402294635772705
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0016096  Vali Loss: 0.0109460 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 7.142045259475708
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0016373  Vali Loss: 0.0109414 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8394737  Test weighted F1: 0.8018628  Test macro F1 0.8018628 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.6436607837677
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6442959  Vali Loss: 0.4910741 Vali Accuracy: 0.9097744  Vali weighted F1: 0.9078903  Vali macro F1 0.9074010 
Validation loss decreased (inf --> 0.491074).  Saving model ...
Epoch: 2 cost time: 5.556145906448364
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3000574  Vali Loss: 0.1775956 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9679796  Vali macro F1 0.9680809 
new best score!!!!
Validation loss decreased (0.491074 --> 0.177596).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.555010557174683
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1249675  Vali Loss: 0.0838356 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846743  Vali macro F1 0.9855452 
new best score!!!!
Validation loss decreased (0.177596 --> 0.083836).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.556593894958496
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0711541  Vali Loss: 0.0611736 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823260  Vali macro F1 0.9833932 
new best score!!!!
Validation loss decreased (0.083836 --> 0.061174).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.562841892242432
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0498349  Vali Loss: 0.0466772 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925392  Vali macro F1 0.9930942 
new best score!!!!
Validation loss decreased (0.061174 --> 0.046677).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.566277742385864
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0447621  Vali Loss: 0.0427333 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924405  Vali macro F1 0.9928731 
new best score!!!!
Validation loss decreased (0.046677 --> 0.042733).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.566815376281738
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0422724  Vali Loss: 0.0368713 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848316  Vali macro F1 0.9856004 
new best score!!!!
Validation loss decreased (0.042733 --> 0.036871).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.571192979812622
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0286959  Vali Loss: 0.0294707 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937370  Vali macro F1 0.9942989 
new best score!!!!
Validation loss decreased (0.036871 --> 0.029471).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.567253351211548
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0224887  Vali Loss: 0.0269666 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899051  Vali macro F1 0.9904019 
new best score!!!!
Validation loss decreased (0.029471 --> 0.026967).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.560230255126953
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0219076  Vali Loss: 0.0219312 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.026967 --> 0.021931).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.566722393035889
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0196527  Vali Loss: 0.0152109 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987460  Vali macro F1 0.9987719 
new best score!!!!
Validation loss decreased (0.021931 --> 0.015211).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.566279172897339
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0243824  Vali Loss: 0.0165896 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.5577006340026855
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0147182  Vali Loss: 0.0136957 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.015211 --> 0.013696).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.561890125274658
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0111423  Vali Loss: 0.0117094 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
new best score!!!!
Validation loss decreased (0.013696 --> 0.011709).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.564497470855713
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0114099  Vali Loss: 0.0112545 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
new best score!!!!
Validation loss decreased (0.011709 --> 0.011255).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 7.117456674575806
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0132044  Vali Loss: 0.0206621 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.558839321136475
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0108797  Vali Loss: 0.0119346 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.560585021972656
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0194637  Vali Loss: 0.0122709 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.554338693618774
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0198343  Vali Loss: 0.0184268 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962337  Vali macro F1 0.9964489 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.5497050285339355
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0186363  Vali Loss: 0.0210343 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9939504 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 5.552169322967529
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0132784  Vali Loss: 0.0130624 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975110  Vali macro F1 0.9976943 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.54488205909729
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0090167  Vali Loss: 0.0098931 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
new best score!!!!
Validation loss decreased (0.011255 --> 0.009893).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.54034686088562
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0078061  Vali Loss: 0.0092504 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.009893 --> 0.009250).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.546249151229858
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0071816  Vali Loss: 0.0085802 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.009250 --> 0.008580).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.5531885623931885
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0073503  Vali Loss: 0.0082973 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.008580 --> 0.008297).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.545519113540649
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0068022  Vali Loss: 0.0078532 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.008297 --> 0.007853).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.546285390853882
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0062073  Vali Loss: 0.0074284 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.007853 --> 0.007428).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.546461343765259
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0060282  Vali Loss: 0.0068889 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.007428 --> 0.006889).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.542524099349976
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0057167  Vali Loss: 0.0068180 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006889 --> 0.006818).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.552630186080933
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0053148  Vali Loss: 0.0063368 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006818 --> 0.006337).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.548354387283325
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0053403  Vali Loss: 0.0059630 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006337 --> 0.005963).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.547921419143677
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0050467  Vali Loss: 0.0058312 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.005963 --> 0.005831).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.553978204727173
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0048676  Vali Loss: 0.0056048 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005831 --> 0.005605).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.546093225479126
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0049063  Vali Loss: 0.0054447 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005605 --> 0.005445).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.54550313949585
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0045096  Vali Loss: 0.0051802 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.005445 --> 0.005180).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.547316312789917
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0045429  Vali Loss: 0.0050390 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.005180 --> 0.005039).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.554120063781738
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0049204  Vali Loss: 0.0048292 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.005039 --> 0.004829).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.542631387710571
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0050412  Vali Loss: 0.0044185 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004829 --> 0.004418).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.54712438583374
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0043930  Vali Loss: 0.0042553 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004418 --> 0.004255).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.551292419433594
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0039127  Vali Loss: 0.0042664 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.544146537780762
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0038929  Vali Loss: 0.0051720 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.545673608779907
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0043562  Vali Loss: 0.0054268 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.541007995605469
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0040728  Vali Loss: 0.0050241 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.540801048278809
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0043256  Vali Loss: 0.0048407 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 5.54664158821106
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0035841  Vali Loss: 0.0055551 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.548800468444824
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0035935  Vali Loss: 0.0054666 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.550013065338135
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0038154  Vali Loss: 0.0054524 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.551522731781006
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0037647  Vali Loss: 0.0053854 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.555208683013916
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0040392  Vali Loss: 0.0052576 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 5.553172826766968
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0085784  Vali Loss: 0.0052531 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.5482707023620605
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0035809  Vali Loss: 0.0052212 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 5.547858953475952
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0037105  Vali Loss: 0.0051999 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 5.5448572635650635
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0035811  Vali Loss: 0.0051621 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 5.548267364501953
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0036320  Vali Loss: 0.0050989 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7991228  Test weighted F1: 0.7491733  Test macro F1 0.7491733 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.250908851623535
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0045405  Vali Loss: 0.0059438 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
Validation loss decreased (inf --> 0.005944).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.151337385177612
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0033726  Vali Loss: 0.0034205 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005944 --> 0.003420).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.15561056137085
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0030254  Vali Loss: 0.0037943 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.159520864486694
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0034570  Vali Loss: 0.0037950 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 7.154064655303955
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0038577  Vali Loss: 0.0072944 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 7.149247884750366
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0031027  Vali Loss: 0.0038339 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 7.152345657348633
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0028874  Vali Loss: 0.0053290 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 7.15619421005249
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0025523  Vali Loss: 0.0034422 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.155494451522827
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0025297  Vali Loss: 0.0033389 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.003420 --> 0.003339).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 7.156702041625977
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0025214  Vali Loss: 0.0040817 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 7.153120040893555
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0023451  Vali Loss: 0.0032730 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.003339 --> 0.003273).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.156527996063232
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0020989  Vali Loss: 0.0030656 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.003273 --> 0.003066).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 7.157764434814453
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0019511  Vali Loss: 0.0030239 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003066 --> 0.003024).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 7.1588146686553955
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0040048  Vali Loss: 0.0166776 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937221  Vali macro F1 0.9939728 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.161872625350952
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0023570  Vali Loss: 0.0049761 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.163748025894165
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0020505  Vali Loss: 0.0043472 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.160026550292969
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0024931  Vali Loss: 0.0036152 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.156693935394287
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0022016  Vali Loss: 0.0049892 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 7.157974004745483
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0017705  Vali Loss: 0.0046232 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.156321048736572
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0017247  Vali Loss: 0.0043569 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 7.1557841300964355
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0017196  Vali Loss: 0.0041788 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 7.152369260787964
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0017571  Vali Loss: 0.0038551 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 7.154809474945068
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0038530  Vali Loss: 0.0038473 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 7.160051107406616
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0014529  Vali Loss: 0.0038149 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 7.160321235656738
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0019912  Vali Loss: 0.0038050 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 7.161264657974243
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0016509  Vali Loss: 0.0037770 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 7.157928943634033
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0016539  Vali Loss: 0.0037681 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 7.157258987426758
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0015255  Vali Loss: 0.0037534 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7903509  Test weighted F1: 0.7311914  Test macro F1 0.7311914 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.662338972091675
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6716821  Vali Loss: 0.5021903 Vali Accuracy: 0.9060150  Vali weighted F1: 0.9024709  Vali macro F1 0.9007226 
Validation loss decreased (inf --> 0.502190).  Saving model ...
Epoch: 2 cost time: 5.5815229415893555
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3027587  Vali Loss: 0.1773876 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9706420  Vali macro F1 0.9713588 
new best score!!!!
Validation loss decreased (0.502190 --> 0.177388).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.578675031661987
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1277860  Vali Loss: 0.1037512 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9783525  Vali macro F1 0.9780724 
new best score!!!!
Validation loss decreased (0.177388 --> 0.103751).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.582600116729736
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0712596  Vali Loss: 0.0604992 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836031  Vali macro F1 0.9844074 
new best score!!!!
Validation loss decreased (0.103751 --> 0.060499).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.577871322631836
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0482535  Vali Loss: 0.0429836 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873695  Vali macro F1 0.9879573 
new best score!!!!
Validation loss decreased (0.060499 --> 0.042984).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.577452182769775
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0373053  Vali Loss: 0.0546008 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861310  Vali macro F1 0.9868036 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 5.587069272994995
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0434342  Vali Loss: 0.0331315 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924621  Vali macro F1 0.9924250 
new best score!!!!
Validation loss decreased (0.042984 --> 0.033131).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.5820581912994385
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0264087  Vali Loss: 0.0265178 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962426  Vali macro F1 0.9963625 
new best score!!!!
Validation loss decreased (0.033131 --> 0.026518).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.577827215194702
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0266106  Vali Loss: 0.0263746 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962437  Vali macro F1 0.9960006 
new best score!!!!
Validation loss decreased (0.026518 --> 0.026375).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.584974527359009
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0240905  Vali Loss: 0.0235266 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937255  Vali macro F1 0.9938901 
new best score!!!!
Validation loss decreased (0.026375 --> 0.023527).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.578756093978882
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0206536  Vali Loss: 0.0227143 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962243  Vali macro F1 0.9963281 
new best score!!!!
Validation loss decreased (0.023527 --> 0.022714).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.58207106590271
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0206550  Vali Loss: 0.0199142 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.022714 --> 0.019914).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.58322286605835
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0171847  Vali Loss: 0.0149323 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9959954 
new best score!!!!
Validation loss decreased (0.019914 --> 0.014932).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.583220481872559
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0134814  Vali Loss: 0.0180901 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949914  Vali macro F1 0.9951546 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.578003406524658
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0123692  Vali Loss: 0.0092433 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014932 --> 0.009243).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.577208757400513
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0122298  Vali Loss: 0.0181746 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.579061031341553
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0117035  Vali Loss: 0.0115238 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962371  Vali macro F1 0.9959877 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.579945802688599
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0141912  Vali Loss: 0.0100298 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.578724145889282
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0108494  Vali Loss: 0.0130159 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949913  Vali macro F1 0.9953558 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.573805809020996
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0113204  Vali Loss: 0.0105154 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 5.573025703430176
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0089921  Vali Loss: 0.0111612 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.578529119491577
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0068762  Vali Loss: 0.0087548 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
new best score!!!!
Validation loss decreased (0.009243 --> 0.008755).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.577996730804443
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0061917  Vali Loss: 0.0085444 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008755 --> 0.008544).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.577514410018921
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0062055  Vali Loss: 0.0081362 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008544 --> 0.008136).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.578689336776733
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0059320  Vali Loss: 0.0076303 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008136 --> 0.007630).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.583747148513794
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0059052  Vali Loss: 0.0072130 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007630 --> 0.007213).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.577607154846191
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0051411  Vali Loss: 0.0070247 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007213 --> 0.007025).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.575567007064819
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0052101  Vali Loss: 0.0062944 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007025 --> 0.006294).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.568289279937744
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0052948  Vali Loss: 0.0069093 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.573614597320557
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0049226  Vali Loss: 0.0060943 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006294 --> 0.006094).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.5716376304626465
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0047976  Vali Loss: 0.0057946 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006094 --> 0.005795).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.570101499557495
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0045339  Vali Loss: 0.0057804 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005795 --> 0.005780).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.567984580993652
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0047100  Vali Loss: 0.0053479 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005780 --> 0.005348).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.566423177719116
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0048571  Vali Loss: 0.0060765 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.570920705795288
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0043497  Vali Loss: 0.0052422 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005348 --> 0.005242).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.571669816970825
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0040000  Vali Loss: 0.0048111 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005242 --> 0.004811).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.574608087539673
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0041661  Vali Loss: 0.0054396 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.573386192321777
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0037813  Vali Loss: 0.0046067 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004811 --> 0.004607).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.568325519561768
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0044447  Vali Loss: 0.0051465 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.57204008102417
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0037242  Vali Loss: 0.0045776 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004607 --> 0.004578).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.5712504386901855
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0037094  Vali Loss: 0.0047115 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.570781230926514
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0037990  Vali Loss: 0.0047044 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.571659564971924
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0035032  Vali Loss: 0.0050407 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.571822166442871
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0036597  Vali Loss: 0.0052289 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 5.571977376937866
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0034186  Vali Loss: 0.0051822 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 5.56559944152832
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0032075  Vali Loss: 0.0050939 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.575843572616577
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0034736  Vali Loss: 0.0050707 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.563885927200317
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0031589  Vali Loss: 0.0050775 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 5.564837455749512
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0037691  Vali Loss: 0.0052041 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 5.568692684173584
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0081371  Vali Loss: 0.0058839 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 5.56905198097229
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0035593  Vali Loss: 0.0058962 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 5.575088739395142
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0034131  Vali Loss: 0.0058683 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 5.572189569473267
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0035980  Vali Loss: 0.0058475 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 5.58097243309021
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0034257  Vali Loss: 0.0058147 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 5.573477506637573
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0032052  Vali Loss: 0.0057943 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8526316  Test weighted F1: 0.8182659  Test macro F1 0.8182659 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.163298845291138
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0040088  Vali Loss: 0.0069455 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
Validation loss decreased (inf --> 0.006946).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.148282289505005
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0031498  Vali Loss: 0.0059583 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.006946 --> 0.005958).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.155327320098877
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0040558  Vali Loss: 0.0042817 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.005958 --> 0.004282).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.153380632400513
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0029405  Vali Loss: 0.0033948 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.004282 --> 0.003395).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.149426460266113
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0029700  Vali Loss: 0.0048095 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 7.151803016662598
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0034549  Vali Loss: 0.0086637 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975773 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 7.1516807079315186
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0035599  Vali Loss: 0.0039454 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 7.14664626121521
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0029911  Vali Loss: 0.0050361 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 7.149659156799316
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031764  Vali Loss: 0.0045061 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 7.150712490081787
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0028491  Vali Loss: 0.0043741 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 7.154035568237305
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0022953  Vali Loss: 0.0031502 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.003395 --> 0.003150).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.157582521438599
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0023520  Vali Loss: 0.0034460 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.156777620315552
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0024300  Vali Loss: 0.0054072 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 7.15479850769043
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0020929  Vali Loss: 0.0041398 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 7.152358770370483
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0044215  Vali Loss: 0.0053341 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 7.147882699966431
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0029915  Vali Loss: 0.0044582 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 7.148190975189209
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0033138  Vali Loss: 0.0041018 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.153338670730591
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0023049  Vali Loss: 0.0038070 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.149370193481445
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0030113  Vali Loss: 0.0035085 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.1559898853302
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0023118  Vali Loss: 0.0036519 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.154715538024902
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0020441  Vali Loss: 0.0036415 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 7.156275033950806
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0038441  Vali Loss: 0.0036347 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.1604204177856445
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0018931  Vali Loss: 0.0036581 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.161764144897461
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0023044  Vali Loss: 0.0036499 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.1544575691223145
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0019968  Vali Loss: 0.0036489 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.157179594039917
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018967  Vali Loss: 0.0036698 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8903509  Test weighted F1: 0.8537786  Test macro F1 0.8537786 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.610285758972168
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6571319  Vali Loss: 0.4714546 Vali Accuracy: 0.9197995  Vali weighted F1: 0.9175490  Vali macro F1 0.9156866 
Validation loss decreased (inf --> 0.471455).  Saving model ...
Epoch: 2 cost time: 5.562850713729858
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2800547  Vali Loss: 0.1553847 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9709147  Vali macro F1 0.9717922 
new best score!!!!
Validation loss decreased (0.471455 --> 0.155385).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.557989120483398
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1248993  Vali Loss: 0.0933439 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9703274  Vali macro F1 0.9708546 
new best score!!!!
Validation loss decreased (0.155385 --> 0.093344).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.564426422119141
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0745556  Vali Loss: 0.0539433 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885820  Vali macro F1 0.9889487 
new best score!!!!
Validation loss decreased (0.093344 --> 0.053943).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.562477350234985
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0496743  Vali Loss: 0.0448844 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899563  Vali macro F1 0.9902576 
new best score!!!!
Validation loss decreased (0.053943 --> 0.044884).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.564836740493774
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0476614  Vali Loss: 0.0343195 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887278  Vali macro F1 0.9890876 
new best score!!!!
Validation loss decreased (0.044884 --> 0.034319).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.561991214752197
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0349348  Vali Loss: 0.0362450 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885291  Vali macro F1 0.9888212 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.561406135559082
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0278635  Vali Loss: 0.0236906 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.034319 --> 0.023691).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.558801651000977
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0231631  Vali Loss: 0.0352558 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874136  Vali macro F1 0.9877978 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.560298681259155
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0194317  Vali Loss: 0.0289387 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874453  Vali macro F1 0.9878219 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.556786298751831
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0195995  Vali Loss: 0.0167575 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949781  Vali macro F1 0.9951288 
new best score!!!!
Validation loss decreased (0.023691 --> 0.016757).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.551383018493652
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0163049  Vali Loss: 0.0180365 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.550952196121216
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0170115  Vali Loss: 0.0168643 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.550213575363159
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0141231  Vali Loss: 0.0144271 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924672  Vali macro F1 0.9926932 
new best score!!!!
Validation loss decreased (0.016757 --> 0.014427).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.564642906188965
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0125596  Vali Loss: 0.0160637 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949781  Vali macro F1 0.9951288 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.556124925613403
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0142271  Vali Loss: 0.0169025 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.561305046081543
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0110647  Vali Loss: 0.0194827 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 5.559051513671875
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0135843  Vali Loss: 0.0254543 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886263  Vali macro F1 0.9870735 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 19 cost time: 5.558153390884399
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0159269  Vali Loss: 0.0212688 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936409  Vali macro F1 0.9939236 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 20 cost time: 5.552587270736694
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0108597  Vali Loss: 0.0218306 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936409  Vali macro F1 0.9939236 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.546468496322632
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0089668  Vali Loss: 0.0193006 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936409  Vali macro F1 0.9939236 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.548288822174072
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0081568  Vali Loss: 0.0183651 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936409  Vali macro F1 0.9939236 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.54800820350647
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0073141  Vali Loss: 0.0172470 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.548907041549683
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0068786  Vali Loss: 0.0168192 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 25 cost time: 5.539624929428101
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0064975  Vali Loss: 0.0166686 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.548407077789307
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0071644  Vali Loss: 0.0165831 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.549105167388916
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0064070  Vali Loss: 0.0161905 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.552496671676636
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0064086  Vali Loss: 0.0162155 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.543576002120972
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0064986  Vali Loss: 0.0161611 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9508772  Test weighted F1: 0.9498645  Test macro F1 0.9498645 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.1728575229644775
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0103747  Vali Loss: 0.0146261 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
Validation loss decreased (inf --> 0.014626).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.161978721618652
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0089300  Vali Loss: 0.0140952 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.014626 --> 0.014095).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.1687867641448975
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0079680  Vali Loss: 0.0137762 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.014095 --> 0.013776).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.1648268699646
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0080200  Vali Loss: 0.0127742 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.013776 --> 0.012774).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.161652565002441
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0066570  Vali Loss: 0.0145276 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 7.16353178024292
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0069476  Vali Loss: 0.0140522 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 7.158512353897095
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0063253  Vali Loss: 0.0116066 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.012774 --> 0.011607).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.1640379428863525
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0058071  Vali Loss: 0.0124989 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 7.155518531799316
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0051111  Vali Loss: 0.0134471 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 7.161909341812134
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0050813  Vali Loss: 0.0114793 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.011607 --> 0.011479).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 7.161659479141235
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0048875  Vali Loss: 0.0130699 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.163139343261719
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0047899  Vali Loss: 0.0103499 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.011479 --> 0.010350).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 7.167310953140259
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0055660  Vali Loss: 0.0121647 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.162167072296143
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0045723  Vali Loss: 0.0105196 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 7.1554412841796875
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0047707  Vali Loss: 0.0128892 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 7.156046152114868
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0041787  Vali Loss: 0.0133176 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 7.169161319732666
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0053586  Vali Loss: 0.0098615 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.010350 --> 0.009861).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 7.159679412841797
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0039547  Vali Loss: 0.0139774 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 7.169999599456787
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0036678  Vali Loss: 0.0102087 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 7.168931007385254
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0033627  Vali Loss: 0.0111268 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 7.178040981292725
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0029519  Vali Loss: 0.0102755 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 7.170389890670776
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0043015  Vali Loss: 0.0093190 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937377  Vali macro F1 0.9939376 
new best score!!!!
Validation loss decreased (0.009861 --> 0.009319).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 7.174388885498047
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0054650  Vali Loss: 0.0095656 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 7.1746556758880615
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0046386  Vali Loss: 0.0119372 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 7.173165559768677
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0028493  Vali Loss: 0.0105451 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 7.176120758056641
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0034796  Vali Loss: 0.0134569 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 7.171771764755249
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0032449  Vali Loss: 0.0154122 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962376  Vali macro F1 0.9963529 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 28 cost time: 7.17531156539917
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0033153  Vali Loss: 0.0087011 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.009319 --> 0.008701).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 7.1761415004730225
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0030120  Vali Loss: 0.0093824 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 7.171964406967163
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0029226  Vali Loss: 0.0102165 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 7.172744274139404
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0054955  Vali Loss: 0.0102058 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962376  Vali macro F1 0.9963529 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 7.168213605880737
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0039710  Vali Loss: 0.0123531 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 7.170056343078613
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0035344  Vali Loss: 0.0091881 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 34 cost time: 7.170190095901489
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0028818  Vali Loss: 0.0091897 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 7.177323818206787
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0027600  Vali Loss: 0.0093285 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 7.174209833145142
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0028960  Vali Loss: 0.0095457 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 7.175705194473267
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0027368  Vali Loss: 0.0093448 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 7.170422077178955
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0026514  Vali Loss: 0.0091601 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 39 cost time: 7.174272537231445
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0025585  Vali Loss: 0.0091494 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 7.1775407791137695
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0025911  Vali Loss: 0.0091444 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 7.16921329498291
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0025238  Vali Loss: 0.0091411 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 7.169946908950806
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0039893  Vali Loss: 0.0091506 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 7.17057466506958
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0025354  Vali Loss: 0.0090937 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9412281  Test weighted F1: 0.9394380  Test macro F1 0.9394380 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.636518239974976
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6626876  Vali Loss: 0.4914045 Vali Accuracy: 0.9122807  Vali weighted F1: 0.9062117  Vali macro F1 0.9083266 
Validation loss decreased (inf --> 0.491405).  Saving model ...
Epoch: 2 cost time: 5.552493095397949
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2855558  Vali Loss: 0.1970153 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9734304  Vali macro F1 0.9741784 
new best score!!!!
Validation loss decreased (0.491405 --> 0.197015).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.550715208053589
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1192293  Vali Loss: 0.0806804 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873108  Vali macro F1 0.9873657 
new best score!!!!
Validation loss decreased (0.197015 --> 0.080680).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.545410394668579
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0643739  Vali Loss: 0.0565010 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886531  Vali macro F1 0.9890956 
new best score!!!!
Validation loss decreased (0.080680 --> 0.056501).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.5485618114471436
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0492906  Vali Loss: 0.0417943 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949751  Vali macro F1 0.9952477 
new best score!!!!
Validation loss decreased (0.056501 --> 0.041794).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.553344488143921
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0379234  Vali Loss: 0.0435284 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887090  Vali macro F1 0.9888385 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 5.5454699993133545
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0344521  Vali Loss: 0.0277009 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937279  Vali macro F1 0.9938610 
new best score!!!!
Validation loss decreased (0.041794 --> 0.027701).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.548747777938843
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0262946  Vali Loss: 0.0326401 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900557  Vali macro F1 0.9904908 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.550022602081299
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0215735  Vali Loss: 0.0197421 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.027701 --> 0.019742).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.552891969680786
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0176462  Vali Loss: 0.0254318 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925485  Vali macro F1 0.9925478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.557991981506348
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0166887  Vali Loss: 0.0233652 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949785  Vali macro F1 0.9952322 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.550344228744507
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0187314  Vali Loss: 0.0132575 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.019742 --> 0.013257).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.550682067871094
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0149764  Vali Loss: 0.0217104 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911500  Vali macro F1 0.9916082 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.547612190246582
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0147964  Vali Loss: 0.0111828 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.013257 --> 0.011183).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.551105737686157
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0114929  Vali Loss: 0.0109433 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
new best score!!!!
Validation loss decreased (0.011183 --> 0.010943).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.550616979598999
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0100977  Vali Loss: 0.0087045 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.010943 --> 0.008704).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.547539234161377
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0110929  Vali Loss: 0.0163595 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.544513463973999
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0205520  Vali Loss: 0.0175674 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949338  Vali macro F1 0.9954979 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.541765451431274
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0166597  Vali Loss: 0.0141257 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.539913177490234
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0132254  Vali Loss: 0.0183242 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937830  Vali macro F1 0.9937271 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 5.539732933044434
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0160902  Vali Loss: 0.0246898 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9964793 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 5.544632434844971
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0104757  Vali Loss: 0.0137248 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.534985542297363
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0079750  Vali Loss: 0.0129888 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.537550926208496
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0074277  Vali Loss: 0.0115973 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.543074369430542
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0069952  Vali Loss: 0.0109308 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.541885137557983
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0065379  Vali Loss: 0.0110656 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 27 cost time: 5.539884567260742
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0058551  Vali Loss: 0.0111484 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.5410377979278564
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0056249  Vali Loss: 0.0111905 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.535650014877319
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0054265  Vali Loss: 0.0111651 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 5.540297985076904
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0058124  Vali Loss: 0.0111165 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 5.541677951812744
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0051477  Vali Loss: 0.0110638 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9298246  Test weighted F1: 0.9091249  Test macro F1 0.9091249 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.193392753601074
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0073376  Vali Loss: 0.0088097 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
Validation loss decreased (inf --> 0.008810).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.18555474281311
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0058264  Vali Loss: 0.0057733 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008810 --> 0.005773).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.194063425064087
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0052252  Vali Loss: 0.0087436 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975110  Vali macro F1 0.9976943 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.186530351638794
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0040022  Vali Loss: 0.0073238 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 7.187808275222778
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0036117  Vali Loss: 0.0038547 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005773 --> 0.003855).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.187796592712402
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0038354  Vali Loss: 0.0062250 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.179387092590332
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0032675  Vali Loss: 0.0045819 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 7.18229079246521
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0038993  Vali Loss: 0.0042950 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 7.189263820648193
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0034967  Vali Loss: 0.0045557 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 7.183799505233765
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0038414  Vali Loss: 0.0099619 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 7.195980787277222
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0029793  Vali Loss: 0.0039038 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.182864427566528
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0027018  Vali Loss: 0.0044048 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 7.196081638336182
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0026244  Vali Loss: 0.0050879 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 7.203731060028076
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0024123  Vali Loss: 0.0032231 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003855 --> 0.003223).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 7.200002670288086
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0022415  Vali Loss: 0.0069010 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 7.203012704849243
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0023293  Vali Loss: 0.0034594 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 7.197085380554199
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0023428  Vali Loss: 0.0034650 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 7.205851793289185
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0020914  Vali Loss: 0.0056965 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 7.187841176986694
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0022181  Vali Loss: 0.0037061 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 7.194679021835327
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0020106  Vali Loss: 0.0039029 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 7.197187662124634
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0015936  Vali Loss: 0.0039762 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 7.190445899963379
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0017710  Vali Loss: 0.0037465 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 7.180902481079102
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0017108  Vali Loss: 0.0035449 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 7.203027248382568
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0016338  Vali Loss: 0.0032537 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 7.191845893859863
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0015854  Vali Loss: 0.0032623 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 7.201778411865234
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0016944  Vali Loss: 0.0032749 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 7.196166038513184
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0016842  Vali Loss: 0.0032724 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 7.187244653701782
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0017309  Vali Loss: 0.0032774 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 7.201762676239014
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0016984  Vali Loss: 0.0032886 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9359649  Test weighted F1: 0.9191238  Test macro F1 0.9191238 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.669286012649536
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6533544  Vali Loss: 0.4529970 Vali Accuracy: 0.9248120  Vali weighted F1: 0.9223016  Vali macro F1 0.9209422 
Validation loss decreased (inf --> 0.452997).  Saving model ...
Epoch: 2 cost time: 5.589183568954468
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2784576  Vali Loss: 0.1328698 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885355  Vali macro F1 0.9891264 
new best score!!!!
Validation loss decreased (0.452997 --> 0.132870).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.572497844696045
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1106338  Vali Loss: 0.0663340 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885472  Vali macro F1 0.9891238 
new best score!!!!
Validation loss decreased (0.132870 --> 0.066334).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.580471515655518
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0593129  Vali Loss: 0.0442111 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886270  Vali macro F1 0.9890315 
new best score!!!!
Validation loss decreased (0.066334 --> 0.044211).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 8.136876821517944
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0417241  Vali Loss: 0.0331638 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912350  Vali macro F1 0.9915261 
new best score!!!!
Validation loss decreased (0.044211 --> 0.033164).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.6067657470703125
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0374473  Vali Loss: 0.0323345 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949843  Vali macro F1 0.9950690 
new best score!!!!
Validation loss decreased (0.033164 --> 0.032335).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.580533742904663
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0296370  Vali Loss: 0.0209858 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949252  Vali macro F1 0.9950605 
new best score!!!!
Validation loss decreased (0.032335 --> 0.020986).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.578226804733276
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0212212  Vali Loss: 0.0157392 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.020986 --> 0.015739).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.5807154178619385
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0178506  Vali Loss: 0.0178743 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962351  Vali macro F1 0.9963362 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.576733350753784
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0160732  Vali Loss: 0.0412546 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9797501  Vali macro F1 0.9806800 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.583994626998901
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0202205  Vali Loss: 0.0121192 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.015739 --> 0.012119).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.582147836685181
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0094973  Vali Loss: 0.0137406 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950008  Vali macro F1 0.9951889 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.580552101135254
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0100981  Vali Loss: 0.0122057 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.573326349258423
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0135253  Vali Loss: 0.0123220 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.578021764755249
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0105989  Vali Loss: 0.0081439 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.012119 --> 0.008144).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.579161167144775
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0068016  Vali Loss: 0.0115861 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962426  Vali macro F1 0.9963625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.578389406204224
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0065867  Vali Loss: 0.0085895 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.575744867324829
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0101315  Vali Loss: 0.0110980 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.577456712722778
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0138462  Vali Loss: 0.0116541 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.574082136154175
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0067713  Vali Loss: 0.0208304 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886926  Vali macro F1 0.9865487 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 5.576226234436035
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0070693  Vali Loss: 0.0098095 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.569621801376343
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0038449  Vali Loss: 0.0095742 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.574816703796387
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0032505  Vali Loss: 0.0099020 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.570644378662109
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0037091  Vali Loss: 0.0084327 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.569994688034058
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0035959  Vali Loss: 0.0083534 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 26 cost time: 5.568959712982178
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0033126  Vali Loss: 0.0083177 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.570686340332031
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0027350  Vali Loss: 0.0082607 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.573247671127319
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0030312  Vali Loss: 0.0082854 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.570076942443848
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0027306  Vali Loss: 0.0083194 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.575276136398315
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0026694  Vali Loss: 0.0083074 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8307018  Test weighted F1: 0.8086237  Test macro F1 0.8086237 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.237673997879028
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0057598  Vali Loss: 0.0082715 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
Validation loss decreased (inf --> 0.008272).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.1644532680511475
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0050277  Vali Loss: 0.0066753 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.008272 --> 0.006675).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.162336111068726
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0041501  Vali Loss: 0.0066038 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.006675 --> 0.006604).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.164276361465454
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0032902  Vali Loss: 0.0066956 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.1622583866119385
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0024162  Vali Loss: 0.0065467 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.006604 --> 0.006547).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.172359943389893
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0021199  Vali Loss: 0.0051817 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.006547 --> 0.005182).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.171628713607788
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0021584  Vali Loss: 0.0070816 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.165224313735962
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0022020  Vali Loss: 0.0077228 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 7.169020891189575
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0017827  Vali Loss: 0.0075055 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 7.172562599182129
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0013318  Vali Loss: 0.0064242 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 7.162199974060059
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0015604  Vali Loss: 0.0092679 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 7.170673131942749
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0014967  Vali Loss: 0.0042502 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.005182 --> 0.004250).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 7.275202512741089
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0012223  Vali Loss: 0.0064939 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.164257287979126
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0013499  Vali Loss: 0.0066353 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 12.769607067108154
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0010725  Vali Loss: 0.0098491 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 7.177289247512817
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0008905  Vali Loss: 0.0074831 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 7.156472682952881
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0008460  Vali Loss: 0.0080502 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 7.165750741958618
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0007516  Vali Loss: 0.0082777 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 7.164562463760376
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0007517  Vali Loss: 0.0082197 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 7.1564366817474365
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0007380  Vali Loss: 0.0080739 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 7.162873029708862
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0008434  Vali Loss: 0.0078258 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 7.163344144821167
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0007294  Vali Loss: 0.0076489 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 7.166186094284058
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0007005  Vali Loss: 0.0076669 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 7.169825553894043
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0007049  Vali Loss: 0.0076673 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 7.173303127288818
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0007364  Vali Loss: 0.0076638 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 7.167978525161743
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0006927  Vali Loss: 0.0076782 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 7.170150995254517
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0007070  Vali Loss: 0.0076974 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8350877  Test weighted F1: 0.8077779  Test macro F1 0.8077779 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1618428
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.549735069274902
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6099612  Vali Loss: 0.4483618 Vali Accuracy: 0.9110276  Vali weighted F1: 0.9100808  Vali macro F1 0.9108457 
Validation loss decreased (inf --> 0.448362).  Saving model ...
Epoch: 2 cost time: 5.4817116260528564
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3026143  Vali Loss: 0.1658352 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9574682  Vali macro F1 0.9573448 
new best score!!!!
Validation loss decreased (0.448362 --> 0.165835).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.48778510093689
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1363076  Vali Loss: 0.0953446 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9826345  Vali macro F1 0.9813682 
new best score!!!!
Validation loss decreased (0.165835 --> 0.095345).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.499035358428955
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0804590  Vali Loss: 0.0717364 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863337  Vali macro F1 0.9847345 
new best score!!!!
Validation loss decreased (0.095345 --> 0.071736).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.4963226318359375
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0546471  Vali Loss: 0.0452183 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888740  Vali macro F1 0.9876904 
new best score!!!!
Validation loss decreased (0.071736 --> 0.045218).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.509161472320557
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0372823  Vali Loss: 0.0455847 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888740  Vali macro F1 0.9876904 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 5.512390851974487
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0327029  Vali Loss: 0.0439421 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912245  Vali macro F1 0.9905303 
new best score!!!!
Validation loss decreased (0.045218 --> 0.043942).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.521038293838501
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0293184  Vali Loss: 0.0277129 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
new best score!!!!
Validation loss decreased (0.043942 --> 0.027713).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.521469593048096
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0307748  Vali Loss: 0.0446543 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9866234  Vali macro F1 0.9850919 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.524426221847534
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0273520  Vali Loss: 0.0271022 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.027713 --> 0.027102).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.528299331665039
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0196739  Vali Loss: 0.0264544 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.027102 --> 0.026454).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.533629417419434
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0160568  Vali Loss: 0.0415955 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851414  Vali macro F1 0.9837093 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.539766788482666
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0151965  Vali Loss: 0.0437325 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876352  Vali macro F1 0.9863613 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.292504787445068
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0149112  Vali Loss: 0.0312179 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863914  Vali macro F1 0.9850347 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.562606334686279
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0172096  Vali Loss: 0.0163780 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937825  Vali macro F1 0.9929932 
new best score!!!!
Validation loss decreased (0.026454 --> 0.016378).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.552029371261597
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0124426  Vali Loss: 0.0298995 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.559760332107544
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0145013  Vali Loss: 0.0260413 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913182  Vali macro F1 0.9903856 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.5601747035980225
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0505140  Vali Loss: 0.0551554 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9786766  Vali macro F1 0.9774885 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.5644371509552
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0267675  Vali Loss: 0.0500558 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876352  Vali macro F1 0.9863613 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.566253423690796
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0237423  Vali Loss: 0.0312900 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925300  Vali macro F1 0.9918702 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 5.566265106201172
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0182607  Vali Loss: 0.0235591 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925508  Vali macro F1 0.9919366 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.5689857006073
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0158644  Vali Loss: 0.0215888 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.564148426055908
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0171936  Vali Loss: 0.0220471 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937836  Vali macro F1 0.9933492 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.563310384750366
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0152333  Vali Loss: 0.0209758 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.563936948776245
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0138790  Vali Loss: 0.0217941 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937836  Vali macro F1 0.9933492 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 26 cost time: 5.564220190048218
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0121593  Vali Loss: 0.0217603 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937836  Vali macro F1 0.9933492 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.563715219497681
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0123817  Vali Loss: 0.0216277 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937836  Vali macro F1 0.9933492 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.567537546157837
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0121956  Vali Loss: 0.0212380 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937836  Vali macro F1 0.9933492 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.572004795074463
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0122811  Vali Loss: 0.0211007 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937836  Vali macro F1 0.9933492 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.568230867385864
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0114074  Vali Loss: 0.0206525 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937836  Vali macro F1 0.9933492 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8894737  Test weighted F1: 0.8762200  Test macro F1 0.8762200 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.2574357986450195
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0101125  Vali Loss: 0.0110195 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
Validation loss decreased (inf --> 0.011020).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.176995277404785
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0098236  Vali Loss: 0.0119762 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.181459188461304
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0075858  Vali Loss: 0.0085641 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.011020 --> 0.008564).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.170705080032349
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0064303  Vali Loss: 0.0088667 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.164386987686157
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0079940  Vali Loss: 0.0096791 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 7.1790149211883545
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0071761  Vali Loss: 0.0095996 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 7.178062915802002
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0053583  Vali Loss: 0.0085214 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.008564 --> 0.008521).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.171875476837158
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0048765  Vali Loss: 0.0074651 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.008521 --> 0.007465).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.180095672607422
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0046760  Vali Loss: 0.0079101 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.174752235412598
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0044168  Vali Loss: 0.0070917 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.007465 --> 0.007092).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 7.169058561325073
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0042724  Vali Loss: 0.0068486 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.007092 --> 0.006849).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.16933536529541
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0044456  Vali Loss: 0.0098881 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.1715476512908936
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0044334  Vali Loss: 0.0075686 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 7.17576265335083
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0041441  Vali Loss: 0.0083227 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 7.176288366317749
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0047303  Vali Loss: 0.0069076 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 7.1760008335113525
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0039036  Vali Loss: 0.0063854 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006849 --> 0.006385).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 7.169405937194824
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0035871  Vali Loss: 0.0059022 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006385 --> 0.005902).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 7.168564558029175
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0033469  Vali Loss: 0.0051566 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005902 --> 0.005157).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 7.174844741821289
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0031388  Vali Loss: 0.0069431 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.166622638702393
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0032691  Vali Loss: 0.0048469 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005157 --> 0.004847).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 7.164907455444336
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0029383  Vali Loss: 0.0054137 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 7.175716161727905
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0029439  Vali Loss: 0.0059044 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 7.177531480789185
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0040418  Vali Loss: 0.0061989 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 7.176935911178589
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0040407  Vali Loss: 0.0056415 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 7.1665544509887695
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0026959  Vali Loss: 0.0047602 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.004847 --> 0.004760).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 7.174288034439087
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025394  Vali Loss: 0.0045913 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004760 --> 0.004591).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 7.162835359573364
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0031771  Vali Loss: 0.0050235 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 7.167290925979614
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0027252  Vali Loss: 0.0046071 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 7.172431707382202
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0021662  Vali Loss: 0.0051977 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 7.170351982116699
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0023533  Vali Loss: 0.0052170 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 7.165197849273682
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0025049  Vali Loss: 0.0076069 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 32 cost time: 7.162862539291382
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0027861  Vali Loss: 0.0036658 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004591 --> 0.003666).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 7.1670567989349365
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0027817  Vali Loss: 0.0036488 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003666 --> 0.003649).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 7.170661211013794
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0020037  Vali Loss: 0.0049404 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 7.172117710113525
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0021999  Vali Loss: 0.0036816 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 7.169327974319458
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0022527  Vali Loss: 0.0043200 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 7.16955828666687
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0019285  Vali Loss: 0.0036277 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003649 --> 0.003628).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 38 cost time: 7.164413213729858
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0023309  Vali Loss: 0.0042052 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 7.171436548233032
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0022760  Vali Loss: 0.0040397 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 7.167702674865723
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0028366  Vali Loss: 0.0089409 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 7.167403221130371
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0022037  Vali Loss: 0.0037244 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 7.171835660934448
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0027987  Vali Loss: 0.0090223 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 43 cost time: 7.166590452194214
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0043175  Vali Loss: 0.0071537 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 7.167542457580566
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0032284  Vali Loss: 0.0053054 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 7.1727135181427
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0021839  Vali Loss: 0.0046771 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 46 cost time: 7.168521881103516
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0019551  Vali Loss: 0.0044105 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 47 cost time: 7.168635368347168
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0026924  Vali Loss: 0.0044651 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 48 cost time: 7.1687233448028564
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0018670  Vali Loss: 0.0044627 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 49 cost time: 7.162185907363892
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0020893  Vali Loss: 0.0044373 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 50 cost time: 7.1712868213653564
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0017865  Vali Loss: 0.0044110 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 51 cost time: 7.166810512542725
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0019460  Vali Loss: 0.0043940 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 52 cost time: 7.168620586395264
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0017802  Vali Loss: 0.0043823 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9122807  Test weighted F1: 0.9051914  Test macro F1 0.9051914 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.61368203163147
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6203185  Vali Loss: 0.4603305 Vali Accuracy: 0.9072682  Vali weighted F1: 0.9056906  Vali macro F1 0.9037427 
Validation loss decreased (inf --> 0.460331).  Saving model ...
Epoch: 2 cost time: 5.540717601776123
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3000367  Vali Loss: 0.1646258 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9691510  Vali macro F1 0.9682010 
new best score!!!!
Validation loss decreased (0.460331 --> 0.164626).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.546543121337891
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1366416  Vali Loss: 0.0912974 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862068  Vali macro F1 0.9852055 
new best score!!!!
Validation loss decreased (0.164626 --> 0.091297).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.547836780548096
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0844804  Vali Loss: 0.0714181 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888674  Vali macro F1 0.9876078 
new best score!!!!
Validation loss decreased (0.091297 --> 0.071418).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.546968460083008
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0528829  Vali Loss: 0.0481380 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900965  Vali macro F1 0.9889421 
new best score!!!!
Validation loss decreased (0.071418 --> 0.048138).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.553892135620117
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0382549  Vali Loss: 0.0417485 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
new best score!!!!
Validation loss decreased (0.048138 --> 0.041749).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.558074235916138
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0339519  Vali Loss: 0.0449480 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.551834583282471
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0315803  Vali Loss: 0.0310918 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
new best score!!!!
Validation loss decreased (0.041749 --> 0.031092).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.550772190093994
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0368117  Vali Loss: 0.0307536 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937810  Vali macro F1 0.9931012 
new best score!!!!
Validation loss decreased (0.031092 --> 0.030754).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.549059152603149
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0264729  Vali Loss: 0.0337088 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913245  Vali macro F1 0.9902834 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.544825077056885
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0233285  Vali Loss: 0.0329869 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.545734167098999
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0203295  Vali Loss: 0.0260765 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887323  Vali macro F1 0.9879370 
new best score!!!!
Validation loss decreased (0.030754 --> 0.026077).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.545223712921143
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0160262  Vali Loss: 0.0232428 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.026077 --> 0.023243).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.546542644500732
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0161086  Vali Loss: 0.0289412 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.54422926902771
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0181679  Vali Loss: 0.0271657 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.5430588722229
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0174575  Vali Loss: 0.0392698 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888740  Vali macro F1 0.9876904 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 5.543426990509033
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0142892  Vali Loss: 0.0162533 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924986  Vali macro F1 0.9915949 
new best score!!!!
Validation loss decreased (0.023243 --> 0.016253).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.546372652053833
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0099379  Vali Loss: 0.0292929 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.550394773483276
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0091233  Vali Loss: 0.0225407 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900918  Vali macro F1 0.9892179 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.548283815383911
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0096238  Vali Loss: 0.0112452 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.016253 --> 0.011245).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.546366214752197
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0072075  Vali Loss: 0.0253031 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.5449864864349365
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0063764  Vali Loss: 0.0155099 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.544557332992554
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0072243  Vali Loss: 0.0280742 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900022  Vali macro F1 0.9886559 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.541484117507935
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0114278  Vali Loss: 0.0233096 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900872  Vali macro F1 0.9890407 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.53257155418396
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0104907  Vali Loss: 0.0137778 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.525435447692871
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0063550  Vali Loss: 0.0162677 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.533043384552002
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0059589  Vali Loss: 0.0152172 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.536200046539307
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0057277  Vali Loss: 0.0154521 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.531466007232666
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0052099  Vali Loss: 0.0133278 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.533570289611816
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0050775  Vali Loss: 0.0123789 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 5.535923957824707
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0047559  Vali Loss: 0.0124694 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.537250280380249
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0048789  Vali Loss: 0.0124900 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.539398908615112
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0085753  Vali Loss: 0.0125394 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.537794589996338
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0047260  Vali Loss: 0.0123529 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.539743423461914
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0046347  Vali Loss: 0.0122655 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9315789  Test weighted F1: 0.9159103  Test macro F1 0.9159103 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.196562767028809
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0067198  Vali Loss: 0.0108080 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
Validation loss decreased (inf --> 0.010808).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.20304012298584
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0056722  Vali Loss: 0.0120275 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.208447217941284
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0045868  Vali Loss: 0.0116515 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.195684909820557
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0044109  Vali Loss: 0.0151136 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 7.202208042144775
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0040494  Vali Loss: 0.0114918 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 7.204208135604858
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0039684  Vali Loss: 0.0097399 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.010808 --> 0.009740).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.19893479347229
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0033790  Vali Loss: 0.0098367 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.194002866744995
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0036400  Vali Loss: 0.0091131 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.009740 --> 0.009113).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.197831630706787
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0033449  Vali Loss: 0.0088091 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.009113 --> 0.008809).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 7.2015252113342285
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0032376  Vali Loss: 0.0090436 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 7.202847957611084
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0029640  Vali Loss: 0.0073919 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.008809 --> 0.007392).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.198070049285889
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0051660  Vali Loss: 0.0090301 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 7.209343433380127
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0029334  Vali Loss: 0.0093680 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 7.204335927963257
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0026931  Vali Loss: 0.0090193 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 7.211639404296875
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0026495  Vali Loss: 0.0088335 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 7.2095887660980225
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0025416  Vali Loss: 0.0105295 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 7.210019826889038
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0025128  Vali Loss: 0.0105746 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.209368944168091
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0025007  Vali Loss: 0.0105673 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.209292650222778
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0023602  Vali Loss: 0.0104740 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.20895528793335
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0021820  Vali Loss: 0.0105802 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.211320877075195
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0022122  Vali Loss: 0.0105029 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 7.212128639221191
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0023807  Vali Loss: 0.0104539 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.211221933364868
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0021701  Vali Loss: 0.0104617 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.216419219970703
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0021520  Vali Loss: 0.0104525 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.210263967514038
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0025523  Vali Loss: 0.0104061 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.217716693878174
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0022023  Vali Loss: 0.0103746 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9447368  Test weighted F1: 0.9318594  Test macro F1 0.9318594 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.581458568572998
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6034903  Vali Loss: 0.4277345 Vali Accuracy: 0.9285714  Vali weighted F1: 0.9255040  Vali macro F1 0.9244100 
Validation loss decreased (inf --> 0.427735).  Saving model ...
Epoch: 2 cost time: 5.526154041290283
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2808756  Vali Loss: 0.1597896 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9694646  Vali macro F1 0.9679758 
new best score!!!!
Validation loss decreased (0.427735 --> 0.159790).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.520129442214966
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1257043  Vali Loss: 0.0872709 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9795320  Vali macro F1 0.9792025 
new best score!!!!
Validation loss decreased (0.159790 --> 0.087271).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.513544082641602
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0755899  Vali Loss: 0.0639174 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899476  Vali macro F1 0.9888618 
new best score!!!!
Validation loss decreased (0.087271 --> 0.063917).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.5124831199646
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0493257  Vali Loss: 0.0398695 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936932  Vali macro F1 0.9933579 
new best score!!!!
Validation loss decreased (0.063917 --> 0.039870).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.51007866859436
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0366873  Vali Loss: 0.0288573 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.039870 --> 0.028857).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.510117292404175
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0316269  Vali Loss: 0.0305976 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912202  Vali macro F1 0.9903742 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.510958433151245
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0280558  Vali Loss: 0.0272782 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911532  Vali macro F1 0.9905879 
new best score!!!!
Validation loss decreased (0.028857 --> 0.027278).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.505802631378174
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0215734  Vali Loss: 0.0206132 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899756  Vali macro F1 0.9889732 
new best score!!!!
Validation loss decreased (0.027278 --> 0.020613).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.504605770111084
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0195388  Vali Loss: 0.0155144 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936661  Vali macro F1 0.9933913 
new best score!!!!
Validation loss decreased (0.020613 --> 0.015514).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.508793830871582
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0187626  Vali Loss: 0.0157303 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.515188455581665
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0181274  Vali Loss: 0.0172340 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.50951361656189
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0175076  Vali Loss: 0.0181999 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 5.510599851608276
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0160337  Vali Loss: 0.0171900 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 15 cost time: 5.51134729385376
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0172844  Vali Loss: 0.0179115 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924743  Vali macro F1 0.9917712 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 16 cost time: 5.5156471729278564
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0129268  Vali Loss: 0.0115331 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974847  Vali macro F1 0.9973982 
new best score!!!!
Validation loss decreased (0.015514 --> 0.011533).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.5203940868377686
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0118560  Vali Loss: 0.0089762 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
new best score!!!!
Validation loss decreased (0.011533 --> 0.008976).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.516901254653931
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0099503  Vali Loss: 0.0084407 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008976 --> 0.008441).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.518141984939575
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0088872  Vali Loss: 0.0076806 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.008441 --> 0.007681).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.519802093505859
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0080507  Vali Loss: 0.0068035 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007681 --> 0.006803).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.527057409286499
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0075543  Vali Loss: 0.0076258 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.522273778915405
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0075000  Vali Loss: 0.0062539 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006803 --> 0.006254).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.521729469299316
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0068907  Vali Loss: 0.0075181 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.517401456832886
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0075141  Vali Loss: 0.0072014 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.522055625915527
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0072236  Vali Loss: 0.0061599 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006254 --> 0.006160).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.524765253067017
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0079140  Vali Loss: 0.0077364 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.523477792739868
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0066439  Vali Loss: 0.0058004 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006160 --> 0.005800).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.528282880783081
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0062510  Vali Loss: 0.0057593 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.005800 --> 0.005759).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.527930498123169
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0077333  Vali Loss: 0.0054342 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005759 --> 0.005434).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.531943321228027
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0062386  Vali Loss: 0.0083554 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.530715465545654
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0076536  Vali Loss: 0.0072134 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.5322747230529785
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0059282  Vali Loss: 0.0060719 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.531487941741943
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0057559  Vali Loss: 0.0054150 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005434 --> 0.005415).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.531310319900513
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0059122  Vali Loss: 0.0055258 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.5274834632873535
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0052763  Vali Loss: 0.0053464 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005415 --> 0.005346).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.525826454162598
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0051356  Vali Loss: 0.0055216 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.529571533203125
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0053398  Vali Loss: 0.0047099 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005346 --> 0.004710).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.535402297973633
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0049404  Vali Loss: 0.0053313 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.533278942108154
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0047648  Vali Loss: 0.0049292 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.535218000411987
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0042677  Vali Loss: 0.0045474 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004710 --> 0.004547).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.522960662841797
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0049014  Vali Loss: 0.0053636 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.523857831954956
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0048160  Vali Loss: 0.0050150 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.526892900466919
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0051784  Vali Loss: 0.0052509 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.522564888000488
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0045378  Vali Loss: 0.0041565 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004547 --> 0.004156).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.523597717285156
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0041192  Vali Loss: 0.0059793 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.519932270050049
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0043331  Vali Loss: 0.0045301 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.530060052871704
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0061971  Vali Loss: 0.0033750 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004156 --> 0.003375).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 5.52411150932312
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0052776  Vali Loss: 0.0040475 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.522047758102417
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0039536  Vali Loss: 0.0037833 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.523746013641357
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0038549  Vali Loss: 0.0043147 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.523870229721069
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0039453  Vali Loss: 0.0036147 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 5.522415399551392
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0035667  Vali Loss: 0.0036729 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 5.520235300064087
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0033816  Vali Loss: 0.0037865 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 5.517818212509155
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0042541  Vali Loss: 0.0037514 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 5.516046524047852
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0052703  Vali Loss: 0.0037853 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 5.520686864852905
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0034920  Vali Loss: 0.0032361 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003375 --> 0.003236).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 5.519282579421997
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0035846  Vali Loss: 0.0032207 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003236 --> 0.003221).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 5.536736965179443
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0033302  Vali Loss: 0.0033276 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 5.526294946670532
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0033301  Vali Loss: 0.0034090 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 5.523395776748657
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0037602  Vali Loss: 0.0034577 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 5.527241945266724
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0035977  Vali Loss: 0.0034919 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 5.524091482162476
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0034616  Vali Loss: 0.0035798 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 63 cost time: 5.52204704284668
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0034910  Vali Loss: 0.0035537 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 5.52476692199707
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0032647  Vali Loss: 0.0035615 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 5.527796268463135
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0032003  Vali Loss: 0.0035482 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 5.517556667327881
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0035143  Vali Loss: 0.0035583 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 5.522899150848389
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0036255  Vali Loss: 0.0035450 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 68 cost time: 5.52290415763855
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0033380  Vali Loss: 0.0035424 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 5.531434059143066
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0032806  Vali Loss: 0.0035396 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 5.518866777420044
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0036912  Vali Loss: 0.0035392 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 5.519704341888428
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0034403  Vali Loss: 0.0035413 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 5.52043080329895
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0032101  Vali Loss: 0.0035401 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9245614  Test weighted F1: 0.9121551  Test macro F1 0.9121551 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.211764335632324
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0042189  Vali Loss: 0.0044352 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
Validation loss decreased (inf --> 0.004435).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.202148675918579
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0045158  Vali Loss: 0.0069896 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.2007529735565186
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0051865  Vali Loss: 0.0030723 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004435 --> 0.003072).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.2057106494903564
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0034517  Vali Loss: 0.0020361 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003072 --> 0.002036).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.210364580154419
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0031385  Vali Loss: 0.0034594 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 7.215278387069702
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0030536  Vali Loss: 0.0033479 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 7.217517852783203
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0029482  Vali Loss: 0.0033728 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 7.214277744293213
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0028894  Vali Loss: 0.0033130 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 7.21425461769104
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0028822  Vali Loss: 0.0024044 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 7.212375164031982
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0021262  Vali Loss: 0.0026268 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 7.211792945861816
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0022732  Vali Loss: 0.0024554 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 7.210457801818848
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0027274  Vali Loss: 0.0021090 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 7.212470293045044
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0022747  Vali Loss: 0.0019917 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002036 --> 0.001992).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 7.196674585342407
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0027131  Vali Loss: 0.0020073 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.209012269973755
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0030943  Vali Loss: 0.0021391 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.2094502449035645
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0023726  Vali Loss: 0.0018800 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001992 --> 0.001880).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 7.216214895248413
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022500  Vali Loss: 0.0018508 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001880 --> 0.001851).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 7.2148356437683105
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0019179  Vali Loss: 0.0019394 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 7.208509683609009
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0019055  Vali Loss: 0.0019561 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 7.210639476776123
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0021327  Vali Loss: 0.0018107 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001851 --> 0.001811).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 7.212433099746704
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0016750  Vali Loss: 0.0015236 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001811 --> 0.001524).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 7.215046167373657
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0019900  Vali Loss: 0.0015813 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.207811594009399
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0017658  Vali Loss: 0.0039544 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.209899663925171
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0020417  Vali Loss: 0.0016003 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.211347579956055
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0016457  Vali Loss: 0.0034215 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.199838876724243
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0019164  Vali Loss: 0.0020278 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 7.221155405044556
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0017391  Vali Loss: 0.0018778 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 7.205991506576538
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0016136  Vali Loss: 0.0018638 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 7.217486143112183
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0013771  Vali Loss: 0.0017504 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 7.224606990814209
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0014740  Vali Loss: 0.0017822 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 7.225404500961304
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0018301  Vali Loss: 0.0019317 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 7.224900007247925
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0016208  Vali Loss: 0.0019401 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 7.208893060684204
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0014519  Vali Loss: 0.0019247 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 7.217283010482788
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0017476  Vali Loss: 0.0019187 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 7.211313247680664
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0013716  Vali Loss: 0.0019074 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 7.2097837924957275
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0013938  Vali Loss: 0.0019021 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9254386  Test weighted F1: 0.9116877  Test macro F1 0.9116877 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.654234170913696
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6160904  Vali Loss: 0.4475465 Vali Accuracy: 0.9160401  Vali weighted F1: 0.9133555  Vali macro F1 0.9139152 
Validation loss decreased (inf --> 0.447547).  Saving model ...
Epoch: 2 cost time: 5.559710741043091
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3029884  Vali Loss: 0.1591738 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9747119  Vali macro F1 0.9735242 
new best score!!!!
Validation loss decreased (0.447547 --> 0.159174).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 7.329572677612305
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1261088  Vali Loss: 0.0926439 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836893  Vali macro F1 0.9827488 
new best score!!!!
Validation loss decreased (0.159174 --> 0.092644).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.559849262237549
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0716205  Vali Loss: 0.0641308 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861270  Vali macro F1 0.9853497 
new best score!!!!
Validation loss decreased (0.092644 --> 0.064131).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.557958126068115
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0516679  Vali Loss: 0.0531246 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848613  Vali macro F1 0.9840725 
new best score!!!!
Validation loss decreased (0.064131 --> 0.053125).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.5618815422058105
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0359749  Vali Loss: 0.0432213 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874827  Vali macro F1 0.9866116 
new best score!!!!
Validation loss decreased (0.053125 --> 0.043221).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.568835020065308
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0358814  Vali Loss: 0.0459005 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876262  Vali macro F1 0.9864524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.562508583068848
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0358060  Vali Loss: 0.0399317 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912937  Vali macro F1 0.9905674 
new best score!!!!
Validation loss decreased (0.043221 --> 0.039932).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.567256212234497
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0365799  Vali Loss: 0.0284368 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.039932 --> 0.028437).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.575493812561035
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0265916  Vali Loss: 0.0268749 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
new best score!!!!
Validation loss decreased (0.028437 --> 0.026875).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.570860862731934
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0211552  Vali Loss: 0.0271653 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.567638635635376
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0174090  Vali Loss: 0.0188716 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.026875 --> 0.018872).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.562165975570679
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0126445  Vali Loss: 0.0171083 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.018872 --> 0.017108).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.563308000564575
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0134739  Vali Loss: 0.0375566 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9826314  Vali macro F1 0.9814840 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.557719469070435
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0186229  Vali Loss: 0.0275567 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900898  Vali macro F1 0.9891241 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.564163684844971
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0152698  Vali Loss: 0.0225885 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925516  Vali macro F1 0.9918220 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 5.565903425216675
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0113541  Vali Loss: 0.0239239 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924106  Vali macro F1 0.9913002 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 18 cost time: 5.55449104309082
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0111466  Vali Loss: 0.0193934 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 19 cost time: 5.5540125370025635
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0107491  Vali Loss: 0.0136793 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.017108 --> 0.013679).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.562765836715698
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0085951  Vali Loss: 0.0129661 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.013679 --> 0.012966).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.569843769073486
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0078542  Vali Loss: 0.0108069 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.012966 --> 0.010807).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.56927490234375
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0073710  Vali Loss: 0.0104056 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.010807 --> 0.010406).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.561648368835449
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0068891  Vali Loss: 0.0102942 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.010406 --> 0.010294).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.557124853134155
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0072707  Vali Loss: 0.0102073 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.010294 --> 0.010207).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.561662673950195
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0068765  Vali Loss: 0.0107158 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.5528247356414795
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0063901  Vali Loss: 0.0108413 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.557420969009399
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0064807  Vali Loss: 0.0100371 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.010207 --> 0.010037).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.5550925731658936
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0065331  Vali Loss: 0.0093572 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010037 --> 0.009357).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.553050518035889
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0060647  Vali Loss: 0.0089867 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.009357 --> 0.008987).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.555956602096558
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0060751  Vali Loss: 0.0089659 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9956960 
new best score!!!!
Validation loss decreased (0.008987 --> 0.008966).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.55217432975769
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0059996  Vali Loss: 0.0086426 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008966 --> 0.008643).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.556476593017578
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0056016  Vali Loss: 0.0083673 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008643 --> 0.008367).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.55233907699585
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0079878  Vali Loss: 0.0081772 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9956960 
new best score!!!!
Validation loss decreased (0.008367 --> 0.008177).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.552521228790283
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0078084  Vali Loss: 0.0101723 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9956960 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.549252510070801
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0060137  Vali Loss: 0.0097207 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9956960 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.5471577644348145
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0057191  Vali Loss: 0.0087789 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.553325891494751
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0055248  Vali Loss: 0.0087802 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.5516932010650635
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0053917  Vali Loss: 0.0084738 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 5.660026788711548
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0070428  Vali Loss: 0.0085117 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.551677227020264
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0050876  Vali Loss: 0.0084210 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.55255126953125
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0051193  Vali Loss: 0.0084508 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.557460308074951
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0050883  Vali Loss: 0.0084436 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.5620341300964355
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0050557  Vali Loss: 0.0084762 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 5.563816785812378
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0051129  Vali Loss: 0.0084753 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.5572099685668945
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0052333  Vali Loss: 0.0084720 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.559985637664795
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0050830  Vali Loss: 0.0084668 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.563498020172119
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0053557  Vali Loss: 0.0084551 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.558482646942139
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0048742  Vali Loss: 0.0084550 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8298246  Test weighted F1: 0.7877427  Test macro F1 0.7877427 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.248127222061157
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0059729  Vali Loss: 0.0090579 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
Validation loss decreased (inf --> 0.009058).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.185759544372559
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0049804  Vali Loss: 0.0082691 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.009058 --> 0.008269).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.189198732376099
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0042628  Vali Loss: 0.0073057 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008269 --> 0.007306).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.191450595855713
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0040037  Vali Loss: 0.0069568 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.007306 --> 0.006957).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 7.194641590118408
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0039727  Vali Loss: 0.0060512 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006957 --> 0.006051).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.193814754486084
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0037573  Vali Loss: 0.0064981 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.195049285888672
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0031596  Vali Loss: 0.0052321 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006051 --> 0.005232).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.187155723571777
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0028985  Vali Loss: 0.0046035 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005232 --> 0.004604).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.1933653354644775
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0029151  Vali Loss: 0.0055267 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.185664892196655
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0027110  Vali Loss: 0.0052021 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.190392017364502
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0029603  Vali Loss: 0.0046487 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 7.188309669494629
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0028148  Vali Loss: 0.0056200 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 7.183175802230835
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0042839  Vali Loss: 0.0077513 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 7.183990478515625
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0046909  Vali Loss: 0.0056241 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.190149545669556
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0037418  Vali Loss: 0.0036485 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004604 --> 0.003648).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 7.191632032394409
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0029535  Vali Loss: 0.0045580 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 7.184866428375244
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0026277  Vali Loss: 0.0036976 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 7.189594268798828
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0023329  Vali Loss: 0.0036785 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 7.184300661087036
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0023219  Vali Loss: 0.0033182 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003648 --> 0.003318).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 7.186902761459351
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0022375  Vali Loss: 0.0034935 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 7.1890528202056885
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0022611  Vali Loss: 0.0053381 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 7.183879613876343
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0025252  Vali Loss: 0.0033193 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 7.187788009643555
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0018634  Vali Loss: 0.0028676 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003318 --> 0.002868).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 7.184856414794922
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0018951  Vali Loss: 0.0027795 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002868 --> 0.002780).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 7.191181898117065
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0025904  Vali Loss: 0.0040085 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974761  Vali macro F1 0.9971110 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 7.1844072341918945
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018385  Vali Loss: 0.0031310 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 7.179279327392578
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0019545  Vali Loss: 0.0040076 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 7.187549352645874
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0017193  Vali Loss: 0.0036817 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 7.184564113616943
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0018497  Vali Loss: 0.0034984 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 30 cost time: 7.183651924133301
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0014413  Vali Loss: 0.0033243 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 7.186455965042114
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0014980  Vali Loss: 0.0032654 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 7.1814866065979
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0016020  Vali Loss: 0.0032303 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 7.183115482330322
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0013407  Vali Loss: 0.0032331 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 7.18403434753418
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0014868  Vali Loss: 0.0032192 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 35 cost time: 7.189626455307007
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0013228  Vali Loss: 0.0032094 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 7.182901859283447
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0017256  Vali Loss: 0.0032061 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 7.185712814331055
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0013840  Vali Loss: 0.0031919 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 7.183952569961548
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0012456  Vali Loss: 0.0031883 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 7.181258916854858
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0029091  Vali Loss: 0.0031889 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8061404  Test weighted F1: 0.7547185  Test macro F1 0.7547185 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.626533031463623
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6328788  Vali Loss: 0.4668847 Vali Accuracy: 0.9122807  Vali weighted F1: 0.9109680  Vali macro F1 0.9112238 
Validation loss decreased (inf --> 0.466885).  Saving model ...
Epoch: 2 cost time: 5.564606666564941
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.3004486  Vali Loss: 0.1533591 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9735587  Vali macro F1 0.9729707 
new best score!!!!
Validation loss decreased (0.466885 --> 0.153359).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.563210725784302
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1249481  Vali Loss: 0.0866146 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861932  Vali macro F1 0.9852797 
new best score!!!!
Validation loss decreased (0.153359 --> 0.086615).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.576582193374634
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0753881  Vali Loss: 0.0612409 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875543  Vali macro F1 0.9864565 
new best score!!!!
Validation loss decreased (0.086615 --> 0.061241).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.5739219188690186
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0525241  Vali Loss: 0.0523196 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863095  Vali macro F1 0.9847653 
new best score!!!!
Validation loss decreased (0.061241 --> 0.052320).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.576767444610596
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0401898  Vali Loss: 0.0376157 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913205  Vali macro F1 0.9904650 
new best score!!!!
Validation loss decreased (0.052320 --> 0.037616).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.577613353729248
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0301026  Vali Loss: 0.0314326 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900906  Vali macro F1 0.9891211 
new best score!!!!
Validation loss decreased (0.037616 --> 0.031433).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.576138257980347
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0220233  Vali Loss: 0.0279336 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
new best score!!!!
Validation loss decreased (0.031433 --> 0.027934).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.565974712371826
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0259825  Vali Loss: 0.0285314 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.56286883354187
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0268562  Vali Loss: 0.0286608 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.561858654022217
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0273120  Vali Loss: 0.0231438 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925527  Vali macro F1 0.9916333 
new best score!!!!
Validation loss decreased (0.027934 --> 0.023144).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.569096565246582
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0186628  Vali Loss: 0.0162648 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.023144 --> 0.016265).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.569395542144775
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0145094  Vali Loss: 0.0139766 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.016265 --> 0.013977).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.570480108261108
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0112681  Vali Loss: 0.0174007 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.5705530643463135
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0225338  Vali Loss: 0.0153544 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9942982 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.558534383773804
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0129719  Vali Loss: 0.0127103 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.013977 --> 0.012710).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.565569639205933
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0093201  Vali Loss: 0.0112923 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937827  Vali macro F1 0.9932992 
new best score!!!!
Validation loss decreased (0.012710 --> 0.011292).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.5680530071258545
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0088922  Vali Loss: 0.0104318 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.011292 --> 0.010432).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.567677021026611
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0079960  Vali Loss: 0.0119653 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.563952207565308
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0077356  Vali Loss: 0.0082431 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.010432 --> 0.008243).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.567434072494507
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0061844  Vali Loss: 0.0105912 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.569931983947754
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0091527  Vali Loss: 0.0112032 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.568434476852417
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0174672  Vali Loss: 0.0218059 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.5653297901153564
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0135524  Vali Loss: 0.0108945 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.5645551681518555
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0095303  Vali Loss: 0.0158091 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.566506624221802
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0078824  Vali Loss: 0.0143247 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.573462724685669
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0069136  Vali Loss: 0.0124645 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.561577558517456
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0063824  Vali Loss: 0.0111082 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.563863039016724
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0057251  Vali Loss: 0.0110704 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.559131860733032
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0058845  Vali Loss: 0.0100501 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 5.561266660690308
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0055692  Vali Loss: 0.0099499 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.5535924434661865
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0055804  Vali Loss: 0.0098654 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.561563014984131
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0092379  Vali Loss: 0.0097874 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.550178050994873
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0055886  Vali Loss: 0.0094182 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.5538413524627686
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0053642  Vali Loss: 0.0093628 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8491228  Test weighted F1: 0.8102477  Test macro F1 0.8102477 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.166468143463135
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0056727  Vali Loss: 0.0083381 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
Validation loss decreased (inf --> 0.008338).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.160228729248047
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0051615  Vali Loss: 0.0074308 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.008338 --> 0.007431).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.155418157577515
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0045786  Vali Loss: 0.0072654 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.007431 --> 0.007265).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.159912347793579
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0044106  Vali Loss: 0.0078739 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.153331756591797
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0039946  Vali Loss: 0.0069705 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.007265 --> 0.006970).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.160719633102417
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0035135  Vali Loss: 0.0065244 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006970 --> 0.006524).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.158359527587891
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0031365  Vali Loss: 0.0064945 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.006524 --> 0.006494).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 7.161138296127319
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0031015  Vali Loss: 0.0056541 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.006494 --> 0.005654).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 7.1573474407196045
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0028132  Vali Loss: 0.0057799 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.159962892532349
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0028922  Vali Loss: 0.0043588 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005654 --> 0.004359).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 7.158142805099487
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0027663  Vali Loss: 0.0047660 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.159883975982666
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0029268  Vali Loss: 0.0042102 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004359 --> 0.004210).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 7.164918661117554
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0047195  Vali Loss: 0.0074265 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.16144323348999
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0024278  Vali Loss: 0.0057826 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 7.16546106338501
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0029204  Vali Loss: 0.0039498 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004210 --> 0.003950).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 7.166524410247803
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0022830  Vali Loss: 0.0041939 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 7.166300296783447
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022341  Vali Loss: 0.0035197 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003950 --> 0.003520).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 7.164514780044556
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0024097  Vali Loss: 0.0027662 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003520 --> 0.002766).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 7.157255411148071
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0018669  Vali Loss: 0.0030682 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 7.174022436141968
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0018951  Vali Loss: 0.0031862 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 7.166917562484741
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0019701  Vali Loss: 0.0033434 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 7.161762237548828
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0017929  Vali Loss: 0.0027770 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 7.166334867477417
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0024225  Vali Loss: 0.0026550 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002766 --> 0.002655).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 7.17521333694458
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0037387  Vali Loss: 0.0108862 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924607  Vali macro F1 0.9916429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 7.165706157684326
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0047843  Vali Loss: 0.0053288 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 7.172661066055298
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0034413  Vali Loss: 0.0056136 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 7.166783809661865
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0027142  Vali Loss: 0.0031888 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 7.177227020263672
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0020359  Vali Loss: 0.0031778 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 29 cost time: 7.175555944442749
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0017628  Vali Loss: 0.0046234 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 7.171945571899414
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0018167  Vali Loss: 0.0037094 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 7.173492908477783
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0015549  Vali Loss: 0.0033597 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 7.1715288162231445
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0019826  Vali Loss: 0.0034871 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 7.1660685539245605
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0016204  Vali Loss: 0.0044092 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 34 cost time: 7.167943954467773
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0014194  Vali Loss: 0.0042778 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 7.169987916946411
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0014637  Vali Loss: 0.0041671 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 7.171958684921265
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0015023  Vali Loss: 0.0040790 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 7.177906513214111
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0014828  Vali Loss: 0.0038738 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 7.175968647003174
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0014373  Vali Loss: 0.0037111 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8605263  Test weighted F1: 0.8215588  Test macro F1 0.8215588 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.669209241867065
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6193656  Vali Loss: 0.4382417 Vali Accuracy: 0.9235589  Vali weighted F1: 0.9215803  Vali macro F1 0.9225889 
Validation loss decreased (inf --> 0.438242).  Saving model ...
Epoch: 2 cost time: 5.564357757568359
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2954525  Vali Loss: 0.1713994 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9771508  Vali macro F1 0.9770644 
new best score!!!!
Validation loss decreased (0.438242 --> 0.171399).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.568100214004517
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1379680  Vali Loss: 0.0879492 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887236  Vali macro F1 0.9878710 
new best score!!!!
Validation loss decreased (0.171399 --> 0.087949).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.565309762954712
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0743551  Vali Loss: 0.0577560 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887279  Vali macro F1 0.9877914 
new best score!!!!
Validation loss decreased (0.087949 --> 0.057756).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.570486783981323
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0517456  Vali Loss: 0.0464176 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887317  Vali macro F1 0.9876096 
new best score!!!!
Validation loss decreased (0.057756 --> 0.046418).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.57131028175354
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0372124  Vali Loss: 0.0294642 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.046418 --> 0.029464).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.576150178909302
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0301897  Vali Loss: 0.0440409 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836940  Vali macro F1 0.9823654 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.57034707069397
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0514558  Vali Loss: 0.0404583 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876033  Vali macro F1 0.9867206 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 9 cost time: 5.567573547363281
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0319423  Vali Loss: 0.0216396 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950165  Vali macro F1 0.9946491 
new best score!!!!
Validation loss decreased (0.029464 --> 0.021640).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.5720295906066895
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0248797  Vali Loss: 0.0201224 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.021640 --> 0.020122).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.569748163223267
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0208700  Vali Loss: 0.0209451 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.568812608718872
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0220230  Vali Loss: 0.0196095 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937259  Vali macro F1 0.9932273 
new best score!!!!
Validation loss decreased (0.020122 --> 0.019610).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.56733512878418
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0212457  Vali Loss: 0.0180136 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.019610 --> 0.018014).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.56243109703064
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0164626  Vali Loss: 0.0171223 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.018014 --> 0.017122).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.560428857803345
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0154053  Vali Loss: 0.0164095 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.017122 --> 0.016409).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.560959815979004
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0149235  Vali Loss: 0.0137045 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.016409 --> 0.013704).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.5670859813690186
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0111760  Vali Loss: 0.0110559 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.013704 --> 0.011056).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.5618016719818115
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0091320  Vali Loss: 0.0105223 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.011056 --> 0.010522).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.5686304569244385
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0101842  Vali Loss: 0.0191063 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.5627617835998535
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0106458  Vali Loss: 0.0085540 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010522 --> 0.008554).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.560195684432983
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0077458  Vali Loss: 0.0079369 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.008554 --> 0.007937).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.558199167251587
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0065389  Vali Loss: 0.0115180 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.560097694396973
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0100870  Vali Loss: 0.0068842 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.007937 --> 0.006884).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.562366247177124
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0097159  Vali Loss: 0.0111458 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.557162761688232
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0086863  Vali Loss: 0.0157433 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.555866956710815
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0190572  Vali Loss: 0.0082289 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.556806802749634
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0084308  Vali Loss: 0.0080852 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.555410146713257
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0070232  Vali Loss: 0.0083403 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 5.552795171737671
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0075229  Vali Loss: 0.0090024 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.555740594863892
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0052666  Vali Loss: 0.0057877 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006884 --> 0.005788).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.55445122718811
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0047782  Vali Loss: 0.0053925 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.005788 --> 0.005393).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.55391526222229
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0045399  Vali Loss: 0.0052686 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.005393 --> 0.005269).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.552568435668945
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0042008  Vali Loss: 0.0048875 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.005269 --> 0.004887).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.55284857749939
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0037949  Vali Loss: 0.0049977 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.549095153808594
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0039907  Vali Loss: 0.0048832 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.004887 --> 0.004883).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.547901630401611
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0037763  Vali Loss: 0.0050764 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.549768924713135
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0036531  Vali Loss: 0.0044026 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.004883 --> 0.004403).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.54987359046936
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0036462  Vali Loss: 0.0048258 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.5469748973846436
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0037204  Vali Loss: 0.0047704 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.547526597976685
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0036585  Vali Loss: 0.0043152 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.004403 --> 0.004315).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.549997568130493
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0035517  Vali Loss: 0.0040106 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004315 --> 0.004011).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.552376985549927
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0035447  Vali Loss: 0.0042725 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.555156230926514
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0034649  Vali Loss: 0.0048916 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.559201240539551
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0034887  Vali Loss: 0.0040422 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 5.557516098022461
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0031864  Vali Loss: 0.0041667 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 5.550835609436035
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0033647  Vali Loss: 0.0054228 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 5.563902378082275
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0028775  Vali Loss: 0.0054462 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.551113843917847
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0031855  Vali Loss: 0.0048450 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 5.551276206970215
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0031230  Vali Loss: 0.0047552 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 5.550238132476807
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0032001  Vali Loss: 0.0046302 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 5.554057359695435
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0031352  Vali Loss: 0.0044455 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 5.551834344863892
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0027599  Vali Loss: 0.0044017 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 5.553879737854004
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0030280  Vali Loss: 0.0044121 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 5.556915521621704
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0035191  Vali Loss: 0.0044022 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 5.558506727218628
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0060083  Vali Loss: 0.0044607 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 5.555257320404053
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0030352  Vali Loss: 0.0044374 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9157895  Test weighted F1: 0.8986196  Test macro F1 0.8986196 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.176904678344727
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0042535  Vali Loss: 0.0045555 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
Validation loss decreased (inf --> 0.004555).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.169238805770874
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0027730  Vali Loss: 0.0072298 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.174450874328613
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0030567  Vali Loss: 0.0025774 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004555 --> 0.002577).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 7.167967319488525
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0035784  Vali Loss: 0.0067317 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 7.166484832763672
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0028854  Vali Loss: 0.0040743 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 7.170431613922119
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0020983  Vali Loss: 0.0029771 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 7.171503305435181
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0024028  Vali Loss: 0.0032037 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 7.168677091598511
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0019752  Vali Loss: 0.0028459 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 7.169105052947998
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0020368  Vali Loss: 0.0039128 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 7.167932748794556
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0022555  Vali Loss: 0.0033423 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 7.163438081741333
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0026299  Vali Loss: 0.0031957 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 7.173459768295288
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0024755  Vali Loss: 0.0084447 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 7.162856578826904
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0027558  Vali Loss: 0.0083400 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 7.158405780792236
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0020179  Vali Loss: 0.0076625 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.16638445854187
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0018359  Vali Loss: 0.0076869 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.170832633972168
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0016948  Vali Loss: 0.0076109 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 7.17592453956604
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0018594  Vali Loss: 0.0073196 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 7.175524711608887
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0017820  Vali Loss: 0.0069454 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9087719  Test weighted F1: 0.8918227  Test macro F1 0.8918227 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.652741193771362
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6246169  Vali Loss: 0.4753006 Vali Accuracy: 0.9210526  Vali weighted F1: 0.9193473  Vali macro F1 0.9184273 
Validation loss decreased (inf --> 0.475301).  Saving model ...
Epoch: 2 cost time: 5.577062606811523
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2994090  Vali Loss: 0.1515527 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9696682  Vali macro F1 0.9682410 
new best score!!!!
Validation loss decreased (0.475301 --> 0.151553).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.573335886001587
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1219509  Vali Loss: 0.0859606 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9850897  Vali macro F1 0.9835031 
new best score!!!!
Validation loss decreased (0.151553 --> 0.085961).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.573622703552246
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0714167  Vali Loss: 0.0695742 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888363  Vali macro F1 0.9878734 
new best score!!!!
Validation loss decreased (0.085961 --> 0.069574).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.576480388641357
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0572201  Vali Loss: 0.0580613 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862512  Vali macro F1 0.9850353 
new best score!!!!
Validation loss decreased (0.069574 --> 0.058061).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.579361438751221
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0390562  Vali Loss: 0.0459390 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874990  Vali macro F1 0.9863870 
new best score!!!!
Validation loss decreased (0.058061 --> 0.045939).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.584754467010498
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0331286  Vali Loss: 0.0390824 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874816  Vali macro F1 0.9864612 
new best score!!!!
Validation loss decreased (0.045939 --> 0.039082).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.5781028270721436
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0296250  Vali Loss: 0.0338313 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912884  Vali macro F1 0.9903371 
new best score!!!!
Validation loss decreased (0.039082 --> 0.033831).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.577245712280273
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0351082  Vali Loss: 0.0381259 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913132  Vali macro F1 0.9904025 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.576427459716797
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0314007  Vali Loss: 0.0324593 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.033831 --> 0.032459).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.584953546524048
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0220578  Vali Loss: 0.0446388 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898626  Vali macro F1 0.9885487 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.584161996841431
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0188649  Vali Loss: 0.0268667 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
new best score!!!!
Validation loss decreased (0.032459 --> 0.026867).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.576196670532227
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0158037  Vali Loss: 0.0423890 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851376  Vali macro F1 0.9836098 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.579095363616943
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0302902  Vali Loss: 0.0311485 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913212  Vali macro F1 0.9904315 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.574663877487183
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0204315  Vali Loss: 0.0212954 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.026867 --> 0.021295).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.571742534637451
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0150187  Vali Loss: 0.0210999 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.021295 --> 0.021100).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.570233106613159
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0141600  Vali Loss: 0.0179903 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949978  Vali macro F1 0.9943247 
new best score!!!!
Validation loss decreased (0.021100 --> 0.017990).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.570534944534302
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0115908  Vali Loss: 0.0234501 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900875  Vali macro F1 0.9889368 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.564043283462524
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0095997  Vali Loss: 0.0187970 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.5658111572265625
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0081422  Vali Loss: 0.0759537 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9833154  Vali macro F1 0.9806873 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.571413278579712
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0152798  Vali Loss: 0.0230085 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912687  Vali macro F1 0.9901223 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.5635621547698975
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0100639  Vali Loss: 0.0266542 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925527  Vali macro F1 0.9916333 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 5.569511413574219
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0132260  Vali Loss: 0.0146108 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.017990 --> 0.014611).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.564939022064209
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0089261  Vali Loss: 0.0115812 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.014611 --> 0.011581).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.571721076965332
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0071723  Vali Loss: 0.0118899 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.5721588134765625
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0059149  Vali Loss: 0.0120162 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937595  Vali macro F1 0.9929427 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.561311960220337
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0059208  Vali Loss: 0.0115903 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937595  Vali macro F1 0.9929427 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.562539577484131
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0057252  Vali Loss: 0.0113252 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937595  Vali macro F1 0.9929427 
new best score!!!!
Validation loss decreased (0.011581 --> 0.011325).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.569010972976685
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0052916  Vali Loss: 0.0117235 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937595  Vali macro F1 0.9929427 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.562368631362915
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0057032  Vali Loss: 0.0107462 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
new best score!!!!
Validation loss decreased (0.011325 --> 0.010746).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.5644917488098145
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0051618  Vali Loss: 0.0100106 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
new best score!!!!
Validation loss decreased (0.010746 --> 0.010011).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.566675186157227
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0048648  Vali Loss: 0.0097945 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
new best score!!!!
Validation loss decreased (0.010011 --> 0.009795).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.5743608474731445
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0074761  Vali Loss: 0.0089311 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
new best score!!!!
Validation loss decreased (0.009795 --> 0.008931).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.575003147125244
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0054467  Vali Loss: 0.0090403 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949743  Vali macro F1 0.9942712 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.565207004547119
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0047679  Vali Loss: 0.0092695 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.567320108413696
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0046233  Vali Loss: 0.0087014 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
new best score!!!!
Validation loss decreased (0.008931 --> 0.008701).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.569681644439697
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0044654  Vali Loss: 0.0082511 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.008701 --> 0.008251).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.565272569656372
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0042992  Vali Loss: 0.0081816 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.008251 --> 0.008182).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.560981273651123
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0073068  Vali Loss: 0.0082537 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.569884538650513
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0045248  Vali Loss: 0.0076937 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9956960 
new best score!!!!
Validation loss decreased (0.008182 --> 0.007694).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.567097425460815
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0041787  Vali Loss: 0.0080128 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.5678863525390625
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0039341  Vali Loss: 0.0080254 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.560879468917847
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0037880  Vali Loss: 0.0080224 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.564184665679932
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0038249  Vali Loss: 0.0073303 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.007694 --> 0.007330).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.56507420539856
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0039301  Vali Loss: 0.0069380 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.007330 --> 0.006938).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 5.561362028121948
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0039026  Vali Loss: 0.0075715 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.564063787460327
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0036446  Vali Loss: 0.0079537 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.560457944869995
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0035278  Vali Loss: 0.0077489 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 10.342348337173462
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0037112  Vali Loss: 0.0068704 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.006938 --> 0.006870).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 5.606526613235474
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0036183  Vali Loss: 0.0067387 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.006870 --> 0.006739).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 5.565176725387573
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0035251  Vali Loss: 0.0060861 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006739 --> 0.006086).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 5.569573640823364
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0033291  Vali Loss: 0.0066034 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 5.574054002761841
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0034196  Vali Loss: 0.0064952 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 5.577214956283569
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0040089  Vali Loss: 0.0113548 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 5.582329988479614
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0071990  Vali Loss: 0.0158137 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912274  Vali macro F1 0.9900226 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 5.577545166015625
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0039245  Vali Loss: 0.0064565 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 5.586027145385742
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0034327  Vali Loss: 0.0061756 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 5.5803749561309814
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0030639  Vali Loss: 0.0061230 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 5.5768256187438965
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0030632  Vali Loss: 0.0061197 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 5.57005500793457
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0032576  Vali Loss: 0.0061577 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 5.572652101516724
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0031335  Vali Loss: 0.0061828 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 5.584211587905884
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0029278  Vali Loss: 0.0061814 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 5.582631826400757
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0031760  Vali Loss: 0.0061778 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 5.569474697113037
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0029096  Vali Loss: 0.0061770 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 5.569533109664917
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0031951  Vali Loss: 0.0061764 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 5.564231634140015
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0030941  Vali Loss: 0.0061757 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9333333  Test weighted F1: 0.9163608  Test macro F1 0.9163608 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.317637920379639
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0038565  Vali Loss: 0.0080599 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
Validation loss decreased (inf --> 0.008060).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.247152328491211
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0034705  Vali Loss: 0.0071496 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
new best score!!!!
Validation loss decreased (0.008060 --> 0.007150).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 7.2438719272613525
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0037751  Vali Loss: 0.0095540 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 7.223848342895508
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0037502  Vali Loss: 0.0073106 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 7.23285984992981
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0032712  Vali Loss: 0.0045457 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007150 --> 0.004546).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 7.231259107589722
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0027152  Vali Loss: 0.0078987 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 7.23589825630188
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0027541  Vali Loss: 0.0069113 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 7.235018253326416
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0025668  Vali Loss: 0.0050184 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 7.23837423324585
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0023311  Vali Loss: 0.0041689 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004546 --> 0.004169).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 7.235218048095703
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0023500  Vali Loss: 0.0046631 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 7.230422258377075
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0025932  Vali Loss: 0.0050236 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 7.241330623626709
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0021343  Vali Loss: 0.0037099 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
new best score!!!!
Validation loss decreased (0.004169 --> 0.003710).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 7.2472639083862305
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0025920  Vali Loss: 0.0041598 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 7.247106552124023
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0023290  Vali Loss: 0.0077384 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937212  Vali macro F1 0.9931892 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 7.249981641769409
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0023363  Vali Loss: 0.0125834 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949743  Vali macro F1 0.9942712 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 7.2525434494018555
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0021448  Vali Loss: 0.0043812 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 7.2487218379974365
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0019817  Vali Loss: 0.0048306 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 7.25417423248291
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0020685  Vali Loss: 0.0038548 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 7.250823974609375
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0021777  Vali Loss: 0.0048017 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 7.247751712799072
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0033869  Vali Loss: 0.0180458 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936644  Vali macro F1 0.9927250 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 7.254453659057617
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0031252  Vali Loss: 0.0059223 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 7.251993656158447
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0029156  Vali Loss: 0.0069077 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 7.247372627258301
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0021248  Vali Loss: 0.0064296 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 7.249952554702759
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0028098  Vali Loss: 0.0059544 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 7.247059345245361
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0018398  Vali Loss: 0.0056881 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 7.246081352233887
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0021212  Vali Loss: 0.0053633 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 7.243923902511597
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0018882  Vali Loss: 0.0050474 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9263158  Test weighted F1: 0.9086574  Test macro F1 0.9086574 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.6204516887664795
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.6215074  Vali Loss: 0.4275362 Vali Accuracy: 0.9385965  Vali weighted F1: 0.9359165  Vali macro F1 0.9339442 
Validation loss decreased (inf --> 0.427536).  Saving model ...
Epoch: 2 cost time: 5.562398433685303
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.2722221  Vali Loss: 0.1379429 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9759195  Vali macro F1 0.9750557 
new best score!!!!
Validation loss decreased (0.427536 --> 0.137943).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.562759637832642
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1117378  Vali Loss: 0.0770823 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861401  Vali macro F1 0.9855575 
new best score!!!!
Validation loss decreased (0.137943 --> 0.077082).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.568116903305054
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0649824  Vali Loss: 0.0477807 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924415  Vali macro F1 0.9921260 
new best score!!!!
Validation loss decreased (0.077082 --> 0.047781).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.576087951660156
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0412025  Vali Loss: 0.0355787 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912127  Vali macro F1 0.9904938 
new best score!!!!
Validation loss decreased (0.047781 --> 0.035579).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.575570583343506
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0288515  Vali Loss: 0.0298961 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937637  Vali macro F1 0.9934101 
new best score!!!!
Validation loss decreased (0.035579 --> 0.029896).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.591040372848511
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0274276  Vali Loss: 0.0265240 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937827  Vali macro F1 0.9932759 
new best score!!!!
Validation loss decreased (0.029896 --> 0.026524).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.583877801895142
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0240608  Vali Loss: 0.0207130 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962540  Vali macro F1 0.9960352 
new best score!!!!
Validation loss decreased (0.026524 --> 0.020713).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.57259464263916
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0184744  Vali Loss: 0.0217464 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912767  Vali macro F1 0.9906630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.5641844272613525
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0166578  Vali Loss: 0.0238212 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913136  Vali macro F1 0.9904147 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.564709901809692
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0212911  Vali Loss: 0.0305753 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949871  Vali macro F1 0.9944852 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 12 cost time: 5.568378925323486
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0126175  Vali Loss: 0.0167626 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937626  Vali macro F1 0.9932243 
new best score!!!!
Validation loss decreased (0.020713 --> 0.016763).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.560708522796631
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0113597  Vali Loss: 0.0141724 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937626  Vali macro F1 0.9932243 
new best score!!!!
Validation loss decreased (0.016763 --> 0.014172).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.563279628753662
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0087562  Vali Loss: 0.0183050 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950002  Vali macro F1 0.9946104 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.5674402713775635
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0146889  Vali Loss: 0.0161543 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950165  Vali macro F1 0.9946491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.56416654586792
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0105470  Vali Loss: 0.0164836 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950165  Vali macro F1 0.9946491 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 5.566060304641724
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0079619  Vali Loss: 0.0114380 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937209  Vali macro F1 0.9934136 
new best score!!!!
Validation loss decreased (0.014172 --> 0.011438).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.565802812576294
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0070631  Vali Loss: 0.0114016 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011438 --> 0.011402).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.562428951263428
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0039277  Vali Loss: 0.0056790 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
new best score!!!!
Validation loss decreased (0.011402 --> 0.005679).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.5538856983184814
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0042782  Vali Loss: 0.0056723 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9985752 
new best score!!!!
Validation loss decreased (0.005679 --> 0.005672).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.551731586456299
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0030008  Vali Loss: 0.0050755 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973441 
new best score!!!!
Validation loss decreased (0.005672 --> 0.005076).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.553931951522827
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0026658  Vali Loss: 0.0430871 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962377  Vali macro F1 0.9961381 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.5573015213012695
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0071982  Vali Loss: 0.0113507 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962427  Vali macro F1 0.9963996 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.56310510635376
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0094077  Vali Loss: 0.0066395 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.554502248764038
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0040425  Vali Loss: 0.0049984 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9988739 
new best score!!!!
Validation loss decreased (0.005076 --> 0.004998).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.552086591720581
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0082945  Vali Loss: 0.0105101 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9985752 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.557208776473999
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0056676  Vali Loss: 0.0083044 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962439  Vali macro F1 0.9959193 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.5536322593688965
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0026477  Vali Loss: 0.0057778 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.558711528778076
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0036592  Vali Loss: 0.0114948 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974899  Vali macro F1 0.9973263 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.548820972442627
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0073745  Vali Loss: 0.0134380 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949530  Vali macro F1 0.9948976 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 8.390411138534546
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0038544  Vali Loss: 0.0084751 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974949  Vali macro F1 0.9975877 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.33246374130249
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0030193  Vali Loss: 0.0080362 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974949  Vali macro F1 0.9975877 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.576230525970459
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0024491  Vali Loss: 0.0071398 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974949  Vali macro F1 0.9975877 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.554066896438599
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0020739  Vali Loss: 0.0072585 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962319  Vali macro F1 0.9961591 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.558968782424927
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0017860  Vali Loss: 0.0072464 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962319  Vali macro F1 0.9961591 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 36 cost time: 5.564798593521118
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0017087  Vali Loss: 0.0072239 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962319  Vali macro F1 0.9961591 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.562182664871216
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0020340  Vali Loss: 0.0072482 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962319  Vali macro F1 0.9961591 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.562533617019653
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0017462  Vali Loss: 0.0072839 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962319  Vali macro F1 0.9961591 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.569873809814453
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0019649  Vali Loss: 0.0072709 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962319  Vali macro F1 0.9961591 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 5.564900636672974
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0017625  Vali Loss: 0.0072559 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962319  Vali macro F1 0.9961591 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8219298  Test weighted F1: 0.7916048  Test macro F1 0.7916048 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1618428
pruned model Parameter : 1623107
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.247997760772705
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0023410  Vali Loss: 0.0036659 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
Validation loss decreased (inf --> 0.003666).  Saving model ...
Fine Tuning Epoch: 2 cost time: 7.161837816238403
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0015994  Vali Loss: 0.0046873 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974934  Vali macro F1 0.9973361 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 7.170774936676025
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0016112  Vali Loss: 0.0038765 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 7.164395093917847
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0008709  Vali Loss: 0.0037788 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 7.168292045593262
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0006903  Vali Loss: 0.0037098 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 7.1755664348602295
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0005687  Vali Loss: 0.0032369 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.003666 --> 0.003237).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 7.170335292816162
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0005559  Vali Loss: 0.0032930 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 7.166907787322998
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0005054  Vali Loss: 0.0040264 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962412  Vali macro F1 0.9961480 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 7.177893161773682
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0004642  Vali Loss: 0.0032898 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 7.171069622039795
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0003688  Vali Loss: 0.0030535 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.003237 --> 0.003053).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 7.1671271324157715
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0003561  Vali Loss: 0.0035265 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 7.170976400375366
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0003617  Vali Loss: 0.0030598 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 7.180483341217041
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0005470  Vali Loss: 0.0030175 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.003053 --> 0.003017).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 7.168880939483643
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0007113  Vali Loss: 0.0045534 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973441 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 7.161322116851807
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0022876  Vali Loss: 0.0060850 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962319  Vali macro F1 0.9961591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 7.166571855545044
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0008209  Vali Loss: 0.0021831 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.003017 --> 0.002183).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 7.17077374458313
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0003852  Vali Loss: 0.0026654 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 7.171665668487549
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0002831  Vali Loss: 0.0023329 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.17068886756897
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0004097  Vali Loss: 0.0040157 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974934  Vali macro F1 0.9973361 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 7.158265829086304
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0007229  Vali Loss: 0.0027159 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 7.167095899581909
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0002295  Vali Loss: 0.0020282 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.002183 --> 0.002028).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 7.176391363143921
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0002050  Vali Loss: 0.0022721 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 7.161736488342285
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0001953  Vali Loss: 0.0022539 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 7.165403604507446
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0001715  Vali Loss: 0.0026993 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 7.165668964385986
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0001585  Vali Loss: 0.0026924 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 7.161405801773071
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0001495  Vali Loss: 0.0027068 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 7.171877384185791
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0001506  Vali Loss: 0.0027101 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 7.171480894088745
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0001738  Vali Loss: 0.0027147 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 7.177942514419556
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0001501  Vali Loss: 0.0027115 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 7.168642520904541
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0001442  Vali Loss: 0.0027164 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 7.173686981201172
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0001452  Vali Loss: 0.0027192 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 7.169180631637573
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0001402  Vali Loss: 0.0027198 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 7.164907693862915
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0001490  Vali Loss: 0.0027184 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 7.1706178188323975
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0001420  Vali Loss: 0.0027160 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 7.177079916000366
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0001446  Vali Loss: 0.0027153 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 7.171361207962036
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0001440  Vali Loss: 0.0027148 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9987609 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8184211  Test weighted F1: 0.7867045  Test macro F1 0.7867045 

============================= JOB FEEDBACK =============================

NodeName=uc2n566
Job ID: 20948457
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 05:32:50
CPU Efficiency: 4.86% of 4-18:15:00 core-walltime
Job Wall-clock time: 05:42:45
Memory Utilized: 6.38 GB
Memory Efficiency: 0.00% of 0.00 MB
