Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 913548
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.330179214477539
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0400472  Vali Loss: 0.6484490 Vali Accuracy: 0.9022556  Vali weighted F1: 0.8936588  Vali macro F1 0.8899684 
Validation loss decreased (inf --> 0.648449).  Saving model ...
Epoch: 2 cost time: 5.167794942855835
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4559719  Vali Loss: 0.2265342 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9658871  Vali macro F1 0.9651625 
new best score!!!!
Validation loss decreased (0.648449 --> 0.226534).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.175891160964966
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.2027910  Vali Loss: 0.1147266 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9796168  Vali macro F1 0.9783803 
new best score!!!!
Validation loss decreased (0.226534 --> 0.114727).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.177562952041626
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1119540  Vali Loss: 0.0738895 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874654  Vali macro F1 0.9868499 
new best score!!!!
Validation loss decreased (0.114727 --> 0.073890).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.1759912967681885
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0785741  Vali Loss: 0.0610221 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860288  Vali macro F1 0.9855642 
new best score!!!!
Validation loss decreased (0.073890 --> 0.061022).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.185048580169678
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0602206  Vali Loss: 0.0453943 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874719  Vali macro F1 0.9867929 
new best score!!!!
Validation loss decreased (0.061022 --> 0.045394).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.188818693161011
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0469733  Vali Loss: 0.0393248 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
new best score!!!!
Validation loss decreased (0.045394 --> 0.039325).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.187181711196899
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0395698  Vali Loss: 0.0384827 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
new best score!!!!
Validation loss decreased (0.039325 --> 0.038483).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.200289964675903
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0325128  Vali Loss: 0.0303689 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873721  Vali macro F1 0.9867854 
new best score!!!!
Validation loss decreased (0.038483 --> 0.030369).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.191100358963013
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0264747  Vali Loss: 0.0292420 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.030369 --> 0.029242).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.209900140762329
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0216585  Vali Loss: 0.0266739 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.029242 --> 0.026674).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.205195903778076
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0200471  Vali Loss: 0.0414786 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9834584  Vali macro F1 0.9827065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.205339670181274
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0360777  Vali Loss: 0.0267621 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.211017847061157
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0244998  Vali Loss: 0.0244359 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.026674 --> 0.024436).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.211891412734985
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0168073  Vali Loss: 0.0201092 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.024436 --> 0.020109).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.211100339889526
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0257190  Vali Loss: 0.0219909 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.214751958847046
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0174945  Vali Loss: 0.0204017 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.212141752243042
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0153099  Vali Loss: 0.0205885 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.212270259857178
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0121220  Vali Loss: 0.0192621 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.020109 --> 0.019262).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.221124649047852
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0117758  Vali Loss: 0.0239925 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.221219301223755
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0114975  Vali Loss: 0.0226767 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.220925807952881
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0167266  Vali Loss: 0.0282040 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.225794792175293
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0140882  Vali Loss: 0.0129108 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
new best score!!!!
Validation loss decreased (0.019262 --> 0.012911).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.223720073699951
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0096994  Vali Loss: 0.0208711 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.226608037948608
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0094520  Vali Loss: 0.0276051 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.228980302810669
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0105172  Vali Loss: 0.0156559 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.2271974086761475
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0074839  Vali Loss: 0.0189143 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.2275710105896
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0058551  Vali Loss: 0.0165789 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899372  Vali macro F1 0.9893769 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 5.229632377624512
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0059866  Vali Loss: 0.0164016 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.2311694622039795
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0047746  Vali Loss: 0.0179106 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.233238458633423
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0048294  Vali Loss: 0.0168412 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.238894939422607
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0044692  Vali Loss: 0.0163871 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 5.2369537353515625
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0045548  Vali Loss: 0.0162868 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 5.239910125732422
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0044559  Vali Loss: 0.0163515 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.239109516143799
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0044362  Vali Loss: 0.0164607 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.237512111663818
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0045700  Vali Loss: 0.0162132 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.242666244506836
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0043925  Vali Loss: 0.0159948 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.2399773597717285
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0043967  Vali Loss: 0.0161249 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8307018  Test weighted F1: 0.8075407  Test macro F1 0.8075407 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.868734121322632
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0080722  Vali Loss: 0.0154720 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
Validation loss decreased (inf --> 0.015472).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.848139047622681
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0100464  Vali Loss: 0.0143180 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.015472 --> 0.014318).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.852293491363525
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0064701  Vali Loss: 0.0181941 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.854079961776733
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0064923  Vali Loss: 0.0158339 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.852960586547852
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0053352  Vali Loss: 0.0149385 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.855008840560913
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0054332  Vali Loss: 0.0165875 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.854051113128662
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0052059  Vali Loss: 0.0155825 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.857936382293701
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0051377  Vali Loss: 0.0152101 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.852635145187378
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0046114  Vali Loss: 0.0143439 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924696  Vali macro F1 0.9921442 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.865865468978882
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0046385  Vali Loss: 0.0152296 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.894009828567505
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0041974  Vali Loss: 0.0149855 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.882175922393799
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0041113  Vali Loss: 0.0162926 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.874654531478882
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0041025  Vali Loss: 0.0160146 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.874532461166382
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0038600  Vali Loss: 0.0157760 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.872844696044922
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0036803  Vali Loss: 0.0154337 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.875319004058838
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0040419  Vali Loss: 0.0151831 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.869878053665161
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0036976  Vali Loss: 0.0150846 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8385965  Test weighted F1: 0.8138336  Test macro F1 0.8138336 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.338868618011475
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0337794  Vali Loss: 0.6515119 Vali Accuracy: 0.8997494  Vali weighted F1: 0.8929411  Vali macro F1 0.8891611 
Validation loss decreased (inf --> 0.651512).  Saving model ...
Epoch: 2 cost time: 5.269556760787964
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4828622  Vali Loss: 0.2280132 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9649049  Vali macro F1 0.9632507 
new best score!!!!
Validation loss decreased (0.651512 --> 0.228013).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.269800424575806
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.2034520  Vali Loss: 0.1187257 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9795625  Vali macro F1 0.9787144 
new best score!!!!
Validation loss decreased (0.228013 --> 0.118726).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.273934602737427
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1145325  Vali Loss: 0.0788441 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861224  Vali macro F1 0.9857120 
new best score!!!!
Validation loss decreased (0.118726 --> 0.078844).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.2782886028289795
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0750886  Vali Loss: 0.0518766 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874628  Vali macro F1 0.9870745 
new best score!!!!
Validation loss decreased (0.078844 --> 0.051877).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.276801347732544
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0571636  Vali Loss: 0.0461815 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823772  Vali macro F1 0.9821148 
new best score!!!!
Validation loss decreased (0.051877 --> 0.046181).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.279725551605225
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0522735  Vali Loss: 0.0388931 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873751  Vali macro F1 0.9867355 
new best score!!!!
Validation loss decreased (0.046181 --> 0.038893).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.28194785118103
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0351506  Vali Loss: 0.0334351 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.038893 --> 0.033435).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.282985210418701
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0300174  Vali Loss: 0.0391689 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.278298616409302
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0350416  Vali Loss: 0.0275606 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.033435 --> 0.027561).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.279053449630737
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0255091  Vali Loss: 0.0274187 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886913  Vali macro F1 0.9883121 
new best score!!!!
Validation loss decreased (0.027561 --> 0.027419).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.281876087188721
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0290944  Vali Loss: 0.0251861 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.027419 --> 0.025186).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.284860849380493
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0241666  Vali Loss: 0.0233806 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899372  Vali macro F1 0.9893769 
new best score!!!!
Validation loss decreased (0.025186 --> 0.023381).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.27982759475708
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0247618  Vali Loss: 0.0250770 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.277099847793579
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0170950  Vali Loss: 0.0161249 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912307  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.023381 --> 0.016125).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.2834389209747314
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0120550  Vali Loss: 0.0220162 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.281740188598633
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0096529  Vali Loss: 0.0205074 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899372  Vali macro F1 0.9893769 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.283409118652344
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0100662  Vali Loss: 0.0188253 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.280207633972168
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0108213  Vali Loss: 0.0287159 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823325  Vali macro F1 0.9813605 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 5.282184362411499
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0184787  Vali Loss: 0.0262304 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 5.280023097991943
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0119476  Vali Loss: 0.0209091 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.281152963638306
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0086294  Vali Loss: 0.0195099 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.278519153594971
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0084977  Vali Loss: 0.0190628 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.278605699539185
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0072668  Vali Loss: 0.0199408 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.282098054885864
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0074292  Vali Loss: 0.0187593 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 26 cost time: 5.280794143676758
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0064644  Vali Loss: 0.0191621 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.281734943389893
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0071523  Vali Loss: 0.0192078 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.282505512237549
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0067298  Vali Loss: 0.0191670 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.280837535858154
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0065141  Vali Loss: 0.0192132 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.281189680099487
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0063543  Vali Loss: 0.0183744 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8359649  Test weighted F1: 0.7942593  Test macro F1 0.7942593 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.877910852432251
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0120165  Vali Loss: 0.0198648 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
Validation loss decreased (inf --> 0.019865).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.878323316574097
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0106768  Vali Loss: 0.0161779 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.019865 --> 0.016178).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.881678819656372
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0089511  Vali Loss: 0.0160838 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.016178 --> 0.016084).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.881731033325195
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0070824  Vali Loss: 0.0153306 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.016084 --> 0.015331).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.871288061141968
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0071000  Vali Loss: 0.0141849 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.015331 --> 0.014185).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.872596025466919
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0064885  Vali Loss: 0.0175410 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.876075744628906
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0081155  Vali Loss: 0.0106579 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.014185 --> 0.010658).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.8752121925354
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0065002  Vali Loss: 0.0158331 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.875428676605225
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0054291  Vali Loss: 0.0157809 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.884375810623169
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0052138  Vali Loss: 0.0139012 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.875094890594482
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0057436  Vali Loss: 0.0135416 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.869298696517944
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0058535  Vali Loss: 0.0120572 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.870623588562012
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0050761  Vali Loss: 0.0142577 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.86580491065979
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0046553  Vali Loss: 0.0127533 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.8716723918914795
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0041425  Vali Loss: 0.0144067 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.871318340301514
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0040198  Vali Loss: 0.0172107 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.881688117980957
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0038541  Vali Loss: 0.0124601 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.875240325927734
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0038720  Vali Loss: 0.0128214 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.87714958190918
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0034266  Vali Loss: 0.0129918 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.87597393989563
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0036182  Vali Loss: 0.0132368 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.875220537185669
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0034461  Vali Loss: 0.0133961 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.877047061920166
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0036655  Vali Loss: 0.0143260 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8368421  Test weighted F1: 0.7939797  Test macro F1 0.7939797 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.38347864151001
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0492912  Vali Loss: 0.6862867 Vali Accuracy: 0.9110276  Vali weighted F1: 0.9051638  Vali macro F1 0.9042870 
Validation loss decreased (inf --> 0.686287).  Saving model ...
Epoch: 2 cost time: 5.289055109024048
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4685144  Vali Loss: 0.2104939 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9812308  Vali macro F1 0.9805213 
new best score!!!!
Validation loss decreased (0.686287 --> 0.210494).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.287250280380249
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1982840  Vali Loss: 0.1056640 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859605  Vali macro F1 0.9856613 
new best score!!!!
Validation loss decreased (0.210494 --> 0.105664).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.291910171508789
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1120209  Vali Loss: 0.0662827 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861462  Vali macro F1 0.9859401 
new best score!!!!
Validation loss decreased (0.105664 --> 0.066283).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.290449857711792
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0811093  Vali Loss: 0.0498849 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949890  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.066283 --> 0.049885).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.291518449783325
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0622823  Vali Loss: 0.0415170 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924364  Vali macro F1 0.9922128 
new best score!!!!
Validation loss decreased (0.049885 --> 0.041517).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.293564796447754
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0468045  Vali Loss: 0.0391075 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860091  Vali macro F1 0.9859945 
new best score!!!!
Validation loss decreased (0.041517 --> 0.039108).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.291920185089111
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0389867  Vali Loss: 0.0295713 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
new best score!!!!
Validation loss decreased (0.039108 --> 0.029571).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.292037487030029
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0335759  Vali Loss: 0.0234940 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949573  Vali macro F1 0.9948290 
new best score!!!!
Validation loss decreased (0.029571 --> 0.023494).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.291759967803955
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0265543  Vali Loss: 0.0228604 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924477  Vali macro F1 0.9922180 
new best score!!!!
Validation loss decreased (0.023494 --> 0.022860).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.294686317443848
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0406430  Vali Loss: 0.0282480 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924317  Vali macro F1 0.9922846 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.292022228240967
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0395360  Vali Loss: 0.0250096 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936884  Vali macro F1 0.9936309 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.294785499572754
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0292621  Vali Loss: 0.0239338 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 5.29590368270874
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0241330  Vali Loss: 0.0242130 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861214  Vali macro F1 0.9858287 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 15 cost time: 5.296924829483032
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0202477  Vali Loss: 0.0161149 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.022860 --> 0.016115).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.294470548629761
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0145941  Vali Loss: 0.0095391 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.016115 --> 0.009539).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.295727252960205
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0150703  Vali Loss: 0.0168252 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9960918 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.297616481781006
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0157763  Vali Loss: 0.0120092 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.295861005783081
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0120149  Vali Loss: 0.0106057 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.299290657043457
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0158735  Vali Loss: 0.0113467 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 5.295464277267456
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0183921  Vali Loss: 0.0212196 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962249  Vali macro F1 0.9959411 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 5.29290246963501
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0128931  Vali Loss: 0.0091311 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.009539 --> 0.009131).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.2983717918396
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0103835  Vali Loss: 0.0088026 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.009131 --> 0.008803).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.299382448196411
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0097160  Vali Loss: 0.0087876 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.008803 --> 0.008788).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.300614356994629
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0090096  Vali Loss: 0.0094086 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.300390958786011
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0087459  Vali Loss: 0.0085726 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
new best score!!!!
Validation loss decreased (0.008788 --> 0.008573).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.298237085342407
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0087209  Vali Loss: 0.0090800 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.2998456954956055
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0077347  Vali Loss: 0.0082649 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.008573 --> 0.008265).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.298673868179321
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0073731  Vali Loss: 0.0081942 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.008265 --> 0.008194).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.298799753189087
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0073521  Vali Loss: 0.0076101 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.008194 --> 0.007610).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.295689105987549
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0066733  Vali Loss: 0.0077905 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.291769742965698
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0065379  Vali Loss: 0.0079902 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.2914488315582275
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0069175  Vali Loss: 0.0075752 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.007610 --> 0.007575).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.291921377182007
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0066064  Vali Loss: 0.0079828 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.292700290679932
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0069516  Vali Loss: 0.0076286 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.2870073318481445
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0069190  Vali Loss: 0.0092396 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.288580656051636
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0069743  Vali Loss: 0.0072659 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.007575 --> 0.007266).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.294438600540161
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0069922  Vali Loss: 0.0076217 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.289982795715332
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0105615  Vali Loss: 0.0080226 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.2903664112091064
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0068185  Vali Loss: 0.0077115 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.2931623458862305
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0063849  Vali Loss: 0.0078110 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.293700695037842
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0057474  Vali Loss: 0.0077330 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 5.292795896530151
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0056324  Vali Loss: 0.0076831 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.290582895278931
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0052371  Vali Loss: 0.0076056 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 5.291346788406372
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0053100  Vali Loss: 0.0075237 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 5.294987678527832
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0052033  Vali Loss: 0.0075080 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 5.291161775588989
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0054968  Vali Loss: 0.0074662 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 48 cost time: 5.298189640045166
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0050474  Vali Loss: 0.0074658 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.2965497970581055
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0056142  Vali Loss: 0.0074601 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.303175449371338
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0052628  Vali Loss: 0.0074570 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.300606727600098
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0056918  Vali Loss: 0.0074561 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 5.297145128250122
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0051214  Vali Loss: 0.0074525 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8956140  Test weighted F1: 0.8807806  Test macro F1 0.8807806 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.911402463912964
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0072237  Vali Loss: 0.0096065 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
Validation loss decreased (inf --> 0.009607).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.912274360656738
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0058742  Vali Loss: 0.0071601 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.009607 --> 0.007160).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.905850172042847
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0055372  Vali Loss: 0.0063923 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.007160 --> 0.006392).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.90834641456604
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0049868  Vali Loss: 0.0069736 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.921963930130005
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0052072  Vali Loss: 0.0054713 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.006392 --> 0.005471).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.9036338329315186
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0053397  Vali Loss: 0.0052822 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.005471 --> 0.005282).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.911608457565308
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0042020  Vali Loss: 0.0061212 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.915200710296631
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0036884  Vali Loss: 0.0057061 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.896694898605347
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0051735  Vali Loss: 0.0061270 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.907009124755859
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0046786  Vali Loss: 0.0065793 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.913152694702148
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0032432  Vali Loss: 0.0064851 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.899488925933838
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0049892  Vali Loss: 0.0047189 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
new best score!!!!
Validation loss decreased (0.005282 --> 0.004719).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.908034086227417
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0036607  Vali Loss: 0.0056602 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.906184911727905
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0033600  Vali Loss: 0.0059556 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.900084972381592
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0035931  Vali Loss: 0.0060569 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.911678075790405
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0027779  Vali Loss: 0.0057408 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.899784088134766
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0025035  Vali Loss: 0.0052855 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.901816368103027
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0024082  Vali Loss: 0.0052649 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.897440433502197
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0059734  Vali Loss: 0.0051936 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.904757022857666
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0026984  Vali Loss: 0.0049345 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.902607202529907
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0026952  Vali Loss: 0.0049901 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.90033483505249
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0086384  Vali Loss: 0.0050783 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.90593409538269
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0026233  Vali Loss: 0.0050748 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.905456781387329
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0024490  Vali Loss: 0.0050735 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.9059624671936035
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0025310  Vali Loss: 0.0050770 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.900914192199707
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025837  Vali Loss: 0.0050753 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.901361465454102
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0023957  Vali Loss: 0.0050621 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9035088  Test weighted F1: 0.8907689  Test macro F1 0.8907689 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.341286659240723
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0399208  Vali Loss: 0.6759992 Vali Accuracy: 0.8859649  Vali weighted F1: 0.8822101  Vali macro F1 0.8780146 
Validation loss decreased (inf --> 0.675999).  Saving model ...
Epoch: 2 cost time: 5.2611083984375
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4800669  Vali Loss: 0.2241959 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9760590  Vali macro F1 0.9758229 
new best score!!!!
Validation loss decreased (0.675999 --> 0.224196).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.266373872756958
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1910917  Vali Loss: 0.1100393 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835191  Vali macro F1 0.9826059 
new best score!!!!
Validation loss decreased (0.224196 --> 0.110039).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.260880947113037
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1061745  Vali Loss: 0.0709740 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9833111  Vali macro F1 0.9827372 
new best score!!!!
Validation loss decreased (0.110039 --> 0.070974).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.2629640102386475
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0696565  Vali Loss: 0.0556536 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
new best score!!!!
Validation loss decreased (0.070974 --> 0.055654).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.269368886947632
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0542354  Vali Loss: 0.0485374 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886626  Vali macro F1 0.9883554 
new best score!!!!
Validation loss decreased (0.055654 --> 0.048537).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.264698266983032
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0540579  Vali Loss: 0.0431720 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
new best score!!!!
Validation loss decreased (0.048537 --> 0.043172).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.268189907073975
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0361959  Vali Loss: 0.0329886 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
new best score!!!!
Validation loss decreased (0.043172 --> 0.032989).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.268396854400635
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0274153  Vali Loss: 0.0315414 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860288  Vali macro F1 0.9855642 
new best score!!!!
Validation loss decreased (0.032989 --> 0.031541).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.27047061920166
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0253526  Vali Loss: 0.0331388 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848008  Vali macro F1 0.9842881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.275814056396484
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0238366  Vali Loss: 0.0293129 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
new best score!!!!
Validation loss decreased (0.031541 --> 0.029313).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.273902416229248
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0291507  Vali Loss: 0.0227249 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.029313 --> 0.022725).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.274453163146973
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0211706  Vali Loss: 0.0263071 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.271730184555054
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0232580  Vali Loss: 0.0310538 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899522  Vali macro F1 0.9891820 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.269007921218872
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0276419  Vali Loss: 0.0190321 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.022725 --> 0.019032).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.270929336547852
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0152477  Vali Loss: 0.0188832 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.019032 --> 0.018883).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.274518966674805
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0144225  Vali Loss: 0.0193578 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.2680439949035645
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0143237  Vali Loss: 0.0200040 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.280200958251953
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0132339  Vali Loss: 0.0195187 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899613  Vali macro F1 0.9893936 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.277429580688477
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0141968  Vali Loss: 0.0187698 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.018883 --> 0.018770).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.27579665184021
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0144284  Vali Loss: 0.0253005 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848371  Vali macro F1 0.9842105 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.268361330032349
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0328839  Vali Loss: 0.0273362 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.268386125564575
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0162050  Vali Loss: 0.0232364 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.2693586349487305
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0159824  Vali Loss: 0.0206668 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.266335487365723
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0110038  Vali Loss: 0.0206993 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.266193389892578
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0089464  Vali Loss: 0.0188829 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.270185232162476
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0084295  Vali Loss: 0.0186132 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.018770 --> 0.018613).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.262978792190552
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0073437  Vali Loss: 0.0168481 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.018613 --> 0.016848).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.26112174987793
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0069281  Vali Loss: 0.0161876 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.016848 --> 0.016188).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.262943506240845
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0073573  Vali Loss: 0.0161837 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.016188 --> 0.016184).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.265243291854858
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0068002  Vali Loss: 0.0173211 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.261221170425415
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0060209  Vali Loss: 0.0142776 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.016184 --> 0.014278).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.261892795562744
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0059556  Vali Loss: 0.0141970 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.014278 --> 0.014197).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.268901348114014
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0063071  Vali Loss: 0.0176984 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.267054796218872
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0062541  Vali Loss: 0.0161633 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.2709479331970215
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0057994  Vali Loss: 0.0157955 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.270056247711182
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0060898  Vali Loss: 0.0174502 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.269655466079712
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0055936  Vali Loss: 0.0176396 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 5.268135070800781
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0103390  Vali Loss: 0.0176064 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.271528005599976
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0057017  Vali Loss: 0.0176195 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.267140626907349
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0055955  Vali Loss: 0.0172097 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.271021604537964
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0055668  Vali Loss: 0.0172748 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.2752015590667725
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0056994  Vali Loss: 0.0173715 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 5.273432970046997
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0052848  Vali Loss: 0.0173758 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.2748448848724365
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0054270  Vali Loss: 0.0173856 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.273455858230591
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0054005  Vali Loss: 0.0173949 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.2791454792022705
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0056432  Vali Loss: 0.0173975 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.278183221817017
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0053311  Vali Loss: 0.0174019 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8070175  Test weighted F1: 0.7598770  Test macro F1 0.7598770 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.938599586486816
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0062673  Vali Loss: 0.0159178 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
Validation loss decreased (inf --> 0.015918).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.924593210220337
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0057609  Vali Loss: 0.0151813 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.015918 --> 0.015181).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.938239812850952
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0054800  Vali Loss: 0.0239962 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873920  Vali macro F1 0.9869548 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.930290937423706
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0051644  Vali Loss: 0.0130619 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.015181 --> 0.013062).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.926092624664307
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0046362  Vali Loss: 0.0209449 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.923994302749634
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0044186  Vali Loss: 0.0137740 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937362  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.925471305847168
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0040040  Vali Loss: 0.0151115 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.922292947769165
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0037643  Vali Loss: 0.0157230 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899688  Vali macro F1 0.9896021 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.92339563369751
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0037328  Vali Loss: 0.0152828 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.9293482303619385
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0040877  Vali Loss: 0.0194277 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.925537824630737
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0040718  Vali Loss: 0.0178376 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.921541929244995
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0036829  Vali Loss: 0.0137759 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.929008483886719
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0031099  Vali Loss: 0.0152083 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.925793170928955
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0067736  Vali Loss: 0.0146204 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.928516387939453
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0028674  Vali Loss: 0.0135076 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.92466926574707
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0027697  Vali Loss: 0.0138645 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.921646356582642
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0029411  Vali Loss: 0.0143872 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.923477649688721
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0027337  Vali Loss: 0.0145996 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.922531604766846
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0028514  Vali Loss: 0.0144769 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8105263  Test weighted F1: 0.7632971  Test macro F1 0.7632971 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.359158992767334
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0243599  Vali Loss: 0.7015774 Vali Accuracy: 0.9122807  Vali weighted F1: 0.9042950  Vali macro F1 0.9002139 
Validation loss decreased (inf --> 0.701577).  Saving model ...
Epoch: 2 cost time: 5.27634072303772
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4665196  Vali Loss: 0.2291627 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9667620  Vali macro F1 0.9647599 
new best score!!!!
Validation loss decreased (0.701577 --> 0.229163).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.273568868637085
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.2017678  Vali Loss: 0.1228403 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9793478  Vali macro F1 0.9784968 
new best score!!!!
Validation loss decreased (0.229163 --> 0.122840).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.269865989685059
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1189134  Vali Loss: 0.0821159 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808993  Vali macro F1 0.9801280 
new best score!!!!
Validation loss decreased (0.122840 --> 0.082116).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.270216226577759
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0750183  Vali Loss: 0.0565688 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873721  Vali macro F1 0.9867854 
new best score!!!!
Validation loss decreased (0.082116 --> 0.056569).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.267970561981201
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0514379  Vali Loss: 0.0547348 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9797430  Vali macro F1 0.9787509 
new best score!!!!
Validation loss decreased (0.056569 --> 0.054735).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.2727649211883545
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0518938  Vali Loss: 0.0428674 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873721  Vali macro F1 0.9867854 
new best score!!!!
Validation loss decreased (0.054735 --> 0.042867).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.271573066711426
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0382215  Vali Loss: 0.0443909 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860776  Vali macro F1 0.9854526 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.273241758346558
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0322657  Vali Loss: 0.0350653 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874937  Vali macro F1 0.9868405 
new best score!!!!
Validation loss decreased (0.042867 --> 0.035065).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.279484510421753
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0273097  Vali Loss: 0.0322448 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886602  Vali macro F1 0.9880598 
new best score!!!!
Validation loss decreased (0.035065 --> 0.032245).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.271141290664673
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0240564  Vali Loss: 0.0264738 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899372  Vali macro F1 0.9893769 
new best score!!!!
Validation loss decreased (0.032245 --> 0.026474).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.276057004928589
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0171772  Vali Loss: 0.0252431 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886572  Vali macro F1 0.9881097 
new best score!!!!
Validation loss decreased (0.026474 --> 0.025243).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.270428657531738
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0148327  Vali Loss: 0.0555591 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861187  Vali macro F1 0.9852813 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.270644903182983
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0172091  Vali Loss: 0.0300963 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.272472381591797
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0142034  Vali Loss: 0.0233487 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899342  Vali macro F1 0.9894268 
new best score!!!!
Validation loss decreased (0.025243 --> 0.023349).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.274338960647583
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0112691  Vali Loss: 0.0239939 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.272003650665283
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0100981  Vali Loss: 0.0383470 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860776  Vali macro F1 0.9854526 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.277891159057617
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0141567  Vali Loss: 0.0184147 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912203  Vali macro F1 0.9907474 
new best score!!!!
Validation loss decreased (0.023349 --> 0.018415).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.273470878601074
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0110022  Vali Loss: 0.0288172 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.2716591358184814
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0085695  Vali Loss: 0.0254607 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.275501728057861
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0107317  Vali Loss: 0.0261475 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886572  Vali macro F1 0.9881097 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 5.272893905639648
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0149356  Vali Loss: 0.0497048 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9772564  Vali macro F1 0.9774041 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 5.2772417068481445
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0198595  Vali Loss: 0.0153418 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.018415 --> 0.015342).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.278185606002808
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0120484  Vali Loss: 0.0219478 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.272817850112915
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0080087  Vali Loss: 0.0241849 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.274456739425659
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0060690  Vali Loss: 0.0185911 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.27281379699707
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0058668  Vali Loss: 0.0243240 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.276987314224243
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0059533  Vali Loss: 0.0195620 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898933  Vali macro F1 0.9896344 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 5.272894382476807
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0053033  Vali Loss: 0.0209258 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885738  Vali macro F1 0.9882817 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.278324842453003
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0045061  Vali Loss: 0.0215276 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885738  Vali macro F1 0.9882817 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.274317741394043
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0041876  Vali Loss: 0.0202490 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885738  Vali macro F1 0.9882817 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.274487257003784
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0038990  Vali Loss: 0.0210650 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885738  Vali macro F1 0.9882817 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 5.276784658432007
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0037637  Vali Loss: 0.0201887 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886160  Vali macro F1 0.9883152 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 5.278303623199463
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0035491  Vali Loss: 0.0200060 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886160  Vali macro F1 0.9883152 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.274160146713257
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0036750  Vali Loss: 0.0200778 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886160  Vali macro F1 0.9883152 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.275635242462158
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0040060  Vali Loss: 0.0201570 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886160  Vali macro F1 0.9883152 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.273358345031738
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0034440  Vali Loss: 0.0200993 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886160  Vali macro F1 0.9883152 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.274436950683594
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0034488  Vali Loss: 0.0200884 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886160  Vali macro F1 0.9883152 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8078947  Test weighted F1: 0.7643532  Test macro F1 0.7643532 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.852269887924194
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0081698  Vali Loss: 0.0186747 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
Validation loss decreased (inf --> 0.018675).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.846091270446777
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0064341  Vali Loss: 0.0183440 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.018675 --> 0.018344).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.851999759674072
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0057444  Vali Loss: 0.0189849 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.845260858535767
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0049086  Vali Loss: 0.0163692 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.018344 --> 0.016369).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.850212097167969
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0045373  Vali Loss: 0.0171201 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.850615501403809
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0039764  Vali Loss: 0.0167226 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.845064640045166
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0037420  Vali Loss: 0.0182078 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.850704193115234
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0036317  Vali Loss: 0.0174079 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.854967832565308
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0033846  Vali Loss: 0.0157928 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.016369 --> 0.015793).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.845644474029541
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0041142  Vali Loss: 0.0169744 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.846311092376709
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0042434  Vali Loss: 0.0165899 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.851897478103638
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0033772  Vali Loss: 0.0165406 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.850810289382935
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0032790  Vali Loss: 0.0154860 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.015793 --> 0.015486).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.848015308380127
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0029856  Vali Loss: 0.0148167 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.015486 --> 0.014817).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.857655048370361
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0030368  Vali Loss: 0.0184438 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.852504730224609
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0025432  Vali Loss: 0.0183471 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.853344678878784
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022803  Vali Loss: 0.0208546 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.8552086353302
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0035344  Vali Loss: 0.0138297 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.014817 --> 0.013830).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.844531774520874
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0028981  Vali Loss: 0.0127068 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
new best score!!!!
Validation loss decreased (0.013830 --> 0.012707).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.848364353179932
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0026893  Vali Loss: 0.0164282 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.842540264129639
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0019663  Vali Loss: 0.0149489 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.845003366470337
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024023  Vali Loss: 0.0133133 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.845721960067749
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0022280  Vali Loss: 0.0153657 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.847103595733643
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0035569  Vali Loss: 0.0138099 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 25 cost time: 6.844957113265991
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0046678  Vali Loss: 0.0154232 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.848994493484497
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0028492  Vali Loss: 0.0079798 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9947947 
new best score!!!!
Validation loss decreased (0.012707 --> 0.007980).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.85028862953186
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0028267  Vali Loss: 0.0158165 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.8482232093811035
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0020111  Vali Loss: 0.0137307 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.8450398445129395
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0018321  Vali Loss: 0.0129141 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.841815948486328
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0017419  Vali Loss: 0.0143664 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.84656286239624
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0022432  Vali Loss: 0.0140904 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 32 cost time: 6.844102144241333
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0015318  Vali Loss: 0.0131542 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.846233367919922
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0015659  Vali Loss: 0.0130464 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.8467488288879395
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0015200  Vali Loss: 0.0131166 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.846736192703247
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0015651  Vali Loss: 0.0131379 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.84870457649231
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0018227  Vali Loss: 0.0131727 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 37 cost time: 6.838996648788452
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0015100  Vali Loss: 0.0131389 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.840943336486816
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0015681  Vali Loss: 0.0131319 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.844874382019043
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0018619  Vali Loss: 0.0131638 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.846853017807007
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0020295  Vali Loss: 0.0130757 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.846832513809204
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0016982  Vali Loss: 0.0130769 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8359649  Test weighted F1: 0.7922744  Test macro F1 0.7922744 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.376134634017944
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0691294  Vali Loss: 0.7015072 Vali Accuracy: 0.8734336  Vali weighted F1: 0.8619965  Vali macro F1 0.8577222 
Validation loss decreased (inf --> 0.701507).  Saving model ...
Epoch: 2 cost time: 5.258621692657471
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4833581  Vali Loss: 0.2279709 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9755680  Vali macro F1 0.9746794 
new best score!!!!
Validation loss decreased (0.701507 --> 0.227971).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.258846998214722
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.2010296  Vali Loss: 0.1144199 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9802583  Vali macro F1 0.9799781 
new best score!!!!
Validation loss decreased (0.227971 --> 0.114420).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.26018762588501
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1169450  Vali Loss: 0.0802256 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886413  Vali macro F1 0.9885600 
new best score!!!!
Validation loss decreased (0.114420 --> 0.080226).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.262680530548096
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0834377  Vali Loss: 0.0503605 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911411  Vali macro F1 0.9908804 
new best score!!!!
Validation loss decreased (0.080226 --> 0.050361).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.262334108352661
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0611468  Vali Loss: 0.0404293 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885637  Vali macro F1 0.9883438 
new best score!!!!
Validation loss decreased (0.050361 --> 0.040429).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.25750207901001
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0492025  Vali Loss: 0.0369429 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898530  Vali macro F1 0.9896742 
new best score!!!!
Validation loss decreased (0.040429 --> 0.036943).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.263091087341309
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0387011  Vali Loss: 0.0304085 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
new best score!!!!
Validation loss decreased (0.036943 --> 0.030409).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.258517742156982
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0330326  Vali Loss: 0.0260398 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
new best score!!!!
Validation loss decreased (0.030409 --> 0.026040).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.2612996101379395
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0290986  Vali Loss: 0.0241160 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924130  Vali macro F1 0.9923626 
new best score!!!!
Validation loss decreased (0.026040 --> 0.024116).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.26559591293335
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0287420  Vali Loss: 0.0246123 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.259403705596924
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0339320  Vali Loss: 0.0213320 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936655  Vali macro F1 0.9934965 
new best score!!!!
Validation loss decreased (0.024116 --> 0.021332).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.26758599281311
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0213545  Vali Loss: 0.0199960 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962258  Vali macro F1 0.9963112 
new best score!!!!
Validation loss decreased (0.021332 --> 0.019996).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.263341426849365
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0226701  Vali Loss: 0.0189855 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924135  Vali macro F1 0.9923198 
new best score!!!!
Validation loss decreased (0.019996 --> 0.018986).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.262302875518799
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0204155  Vali Loss: 0.0160783 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.018986 --> 0.016078).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.265413522720337
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0157426  Vali Loss: 0.0262352 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.264235973358154
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0205688  Vali Loss: 0.0199479 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936882  Vali macro F1 0.9935146 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.26669454574585
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0159979  Vali Loss: 0.0173452 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.265660047531128
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0169709  Vali Loss: 0.0148877 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949390  Vali macro F1 0.9948141 
new best score!!!!
Validation loss decreased (0.016078 --> 0.014888).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.269572019577026
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0130204  Vali Loss: 0.0194569 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924140  Vali macro F1 0.9921503 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.2657177448272705
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0257394  Vali Loss: 0.0180707 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937319  Vali macro F1 0.9936671 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.269819259643555
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0157283  Vali Loss: 0.0140295 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
new best score!!!!
Validation loss decreased (0.014888 --> 0.014029).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.272704601287842
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0163546  Vali Loss: 0.0129564 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
new best score!!!!
Validation loss decreased (0.014029 --> 0.012956).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.274974822998047
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0126491  Vali Loss: 0.0102522 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949070  Vali macro F1 0.9949160 
new best score!!!!
Validation loss decreased (0.012956 --> 0.010252).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.271268367767334
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0128873  Vali Loss: 0.0130267 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.2681498527526855
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0110632  Vali Loss: 0.0100309 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.010252 --> 0.010031).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.263674259185791
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0079704  Vali Loss: 0.0074162 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.010031 --> 0.007416).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.262102365493774
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0091616  Vali Loss: 0.0087647 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.259727239608765
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0094440  Vali Loss: 0.0117789 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.25596022605896
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0085107  Vali Loss: 0.0064898 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.007416 --> 0.006490).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.255431652069092
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0056589  Vali Loss: 0.0072622 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.250654935836792
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0067732  Vali Loss: 0.0130070 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937314  Vali macro F1 0.9937044 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.252644777297974
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0079207  Vali Loss: 0.0064558 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.006490 --> 0.006456).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.251689910888672
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0119100  Vali Loss: 0.0101458 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.251099586486816
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0087648  Vali Loss: 0.0093722 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.252116680145264
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0063736  Vali Loss: 0.0051906 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.006456 --> 0.005191).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.254143714904785
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0065062  Vali Loss: 0.0222666 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924489  Vali macro F1 0.9921441 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.255095720291138
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0130465  Vali Loss: 0.0152131 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949880  Vali macro F1 0.9949674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.257526159286499
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0178414  Vali Loss: 0.0078176 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.2594335079193115
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0135935  Vali Loss: 0.0142157 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.261373519897461
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0126563  Vali Loss: 0.0065392 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 5.256608247756958
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0072187  Vali Loss: 0.0060547 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.261132001876831
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0069335  Vali Loss: 0.0052619 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.258377313613892
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0062350  Vali Loss: 0.0049393 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.005191 --> 0.004939).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.263237476348877
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0060024  Vali Loss: 0.0051606 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.264586448669434
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0058219  Vali Loss: 0.0071792 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.268132925033569
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0053607  Vali Loss: 0.0071440 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.272452116012573
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0054578  Vali Loss: 0.0057385 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.26922607421875
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0046724  Vali Loss: 0.0071460 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 5.27147912979126
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0045542  Vali Loss: 0.0071883 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.269694089889526
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0048325  Vali Loss: 0.0071727 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 5.268073081970215
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0042513  Vali Loss: 0.0071936 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 5.2708094120025635
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0045025  Vali Loss: 0.0071860 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 5.269306182861328
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0042394  Vali Loss: 0.0071995 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 5.267186164855957
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0047317  Vali Loss: 0.0071994 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 5.266512870788574
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0045361  Vali Loss: 0.0071999 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 5.271198272705078
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0046827  Vali Loss: 0.0072024 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 5.273233652114868
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0044805  Vali Loss: 0.0072101 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 5.269710540771484
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0044909  Vali Loss: 0.0072122 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9342105  Test weighted F1: 0.9316249  Test macro F1 0.9316249 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.89447283744812
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0056814  Vali Loss: 0.0074063 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
Validation loss decreased (inf --> 0.007406).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.8915934562683105
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0044627  Vali Loss: 0.0074903 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.888361215591431
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0044140  Vali Loss: 0.0076938 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.8837971687316895
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0035488  Vali Loss: 0.0068678 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.007406 --> 0.006868).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.894207954406738
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0037624  Vali Loss: 0.0069729 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.880319356918335
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0038732  Vali Loss: 0.0069112 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.89456844329834
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0029101  Vali Loss: 0.0062137 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.006868 --> 0.006214).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.888165712356567
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0039099  Vali Loss: 0.0071500 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.8840110301971436
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0029730  Vali Loss: 0.0073731 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.8815107345581055
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0025448  Vali Loss: 0.0075616 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.876950979232788
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0025153  Vali Loss: 0.0076910 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.891083002090454
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0066415  Vali Loss: 0.0074373 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.885274410247803
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0039632  Vali Loss: 0.0072609 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.882970809936523
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0025541  Vali Loss: 0.0069740 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.8814239501953125
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0064614  Vali Loss: 0.0068702 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.884479284286499
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0039536  Vali Loss: 0.0072627 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.884040832519531
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0029966  Vali Loss: 0.0079822 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.880737781524658
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0027398  Vali Loss: 0.0079694 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.878110647201538
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0025444  Vali Loss: 0.0077679 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.874799013137817
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0028645  Vali Loss: 0.0075639 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.876082181930542
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0024182  Vali Loss: 0.0074779 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.89435338973999
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024852  Vali Loss: 0.0075107 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9960990 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9385965  Test weighted F1: 0.9359784  Test macro F1 0.9359784 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.38137149810791
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0433931  Vali Loss: 0.6774033 Vali Accuracy: 0.8934837  Vali weighted F1: 0.8830639  Vali macro F1 0.8795079 
Validation loss decreased (inf --> 0.677403).  Saving model ...
Epoch: 2 cost time: 5.278224229812622
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4776645  Vali Loss: 0.2495714 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9568992  Vali macro F1 0.9556058 
new best score!!!!
Validation loss decreased (0.677403 --> 0.249571).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.280547857284546
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.2041688  Vali Loss: 0.1288626 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9770459  Vali macro F1 0.9758648 
new best score!!!!
Validation loss decreased (0.249571 --> 0.128863).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.276737928390503
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1283150  Vali Loss: 0.0852184 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860288  Vali macro F1 0.9855642 
new best score!!!!
Validation loss decreased (0.128863 --> 0.085218).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.282498598098755
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0792781  Vali Loss: 0.0591935 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872116  Vali macro F1 0.9869113 
new best score!!!!
Validation loss decreased (0.085218 --> 0.059194).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.281614065170288
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0570413  Vali Loss: 0.0444672 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
new best score!!!!
Validation loss decreased (0.059194 --> 0.044467).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.283316612243652
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0465130  Vali Loss: 0.0455126 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9806183  Vali macro F1 0.9799192 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.287393093109131
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0395381  Vali Loss: 0.0373341 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873340  Vali macro F1 0.9869068 
new best score!!!!
Validation loss decreased (0.044467 --> 0.037334).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.282891750335693
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0290894  Vali Loss: 0.0315755 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885177  Vali macro F1 0.9882566 
new best score!!!!
Validation loss decreased (0.037334 --> 0.031575).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.290515661239624
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0242814  Vali Loss: 0.0304107 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860288  Vali macro F1 0.9855642 
new best score!!!!
Validation loss decreased (0.031575 --> 0.030411).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.282127857208252
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0208749  Vali Loss: 0.0239554 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.030411 --> 0.023955).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.287114143371582
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0250837  Vali Loss: 0.0238800 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886736  Vali macro F1 0.9882755 
new best score!!!!
Validation loss decreased (0.023955 --> 0.023880).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.283284664154053
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0190719  Vali Loss: 0.0259252 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.289794921875
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0152515  Vali Loss: 0.0261668 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.286714315414429
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0207959  Vali Loss: 0.0317091 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860940  Vali macro F1 0.9857572 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 5.288657903671265
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0193129  Vali Loss: 0.0177119 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.023880 --> 0.017712).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.292449712753296
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0124320  Vali Loss: 0.0176025 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.017712 --> 0.017602).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.293436765670776
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0142980  Vali Loss: 0.0276868 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847118  Vali macro F1 0.9842105 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.289637565612793
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0143297  Vali Loss: 0.0153393 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
new best score!!!!
Validation loss decreased (0.017602 --> 0.015339).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.290966749191284
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0102940  Vali Loss: 0.0188432 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.289654493331909
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0113965  Vali Loss: 0.0180537 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.288027286529541
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0097817  Vali Loss: 0.0216799 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.287346839904785
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0142846  Vali Loss: 0.0235210 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.2864990234375
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0212936  Vali Loss: 0.0362097 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847118  Vali macro F1 0.9842105 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 5.284003496170044
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0172014  Vali Loss: 0.0212664 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.292185306549072
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0111243  Vali Loss: 0.0214268 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.284823656082153
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0094821  Vali Loss: 0.0203826 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.286761999130249
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0088586  Vali Loss: 0.0207273 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.287909984588623
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0079929  Vali Loss: 0.0192737 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 30 cost time: 5.285598516464233
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0079802  Vali Loss: 0.0189825 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.287932634353638
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0077084  Vali Loss: 0.0188465 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.291663885116577
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0075992  Vali Loss: 0.0186617 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.288283824920654
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0078723  Vali Loss: 0.0183151 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 5.289461851119995
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0075985  Vali Loss: 0.0180925 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9315789  Test weighted F1: 0.9137422  Test macro F1 0.9137422 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.856515884399414
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0098013  Vali Loss: 0.0166868 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
Validation loss decreased (inf --> 0.016687).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.857434988021851
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0074496  Vali Loss: 0.0141476 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.016687 --> 0.014148).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.85030460357666
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0096376  Vali Loss: 0.0131438 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.014148 --> 0.013144).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.850810766220093
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0064119  Vali Loss: 0.0174576 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.858743667602539
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0066160  Vali Loss: 0.0127913 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.013144 --> 0.012791).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.861294269561768
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0054347  Vali Loss: 0.0125930 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.012791 --> 0.012593).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.848945617675781
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0049446  Vali Loss: 0.0118872 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.012593 --> 0.011887).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.851640939712524
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0056944  Vali Loss: 0.0122176 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.851803541183472
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0044393  Vali Loss: 0.0225001 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.848633766174316
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0071431  Vali Loss: 0.0142196 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.846808671951294
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0042450  Vali Loss: 0.0128695 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.84982442855835
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0044152  Vali Loss: 0.0139282 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.850974082946777
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0040087  Vali Loss: 0.0106077 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.011887 --> 0.010608).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.846129894256592
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0038664  Vali Loss: 0.0105007 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.010608 --> 0.010501).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.849088430404663
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0034649  Vali Loss: 0.0144618 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.843813419342041
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0035155  Vali Loss: 0.0110997 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.8470282554626465
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0034755  Vali Loss: 0.0191749 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899474  Vali macro F1 0.9895894 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.847618103027344
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0037657  Vali Loss: 0.0116537 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.843527317047119
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0030335  Vali Loss: 0.0148744 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.84409236907959
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0031159  Vali Loss: 0.0143251 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.842995882034302
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0033690  Vali Loss: 0.0132822 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.843717575073242
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0031834  Vali Loss: 0.0126935 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.838291168212891
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0034337  Vali Loss: 0.0135370 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.845787048339844
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0032682  Vali Loss: 0.0125929 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 6.85016393661499
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0029114  Vali Loss: 0.0123169 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.842160701751709
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0028353  Vali Loss: 0.0122476 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.843219995498657
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0030302  Vali Loss: 0.0122188 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.84330677986145
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0043494  Vali Loss: 0.0122046 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.843080282211304
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0028433  Vali Loss: 0.0119806 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9245614  Test weighted F1: 0.9064893  Test macro F1 0.9064893 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.362444877624512
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0626297  Vali Loss: 0.7060134 Vali Accuracy: 0.8934837  Vali weighted F1: 0.8834787  Vali macro F1 0.8796046 
Validation loss decreased (inf --> 0.706013).  Saving model ...
Epoch: 2 cost time: 5.258803606033325
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4894896  Vali Loss: 0.2325743 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9756900  Vali macro F1 0.9741898 
new best score!!!!
Validation loss decreased (0.706013 --> 0.232574).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.281110048294067
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1989511  Vali Loss: 0.1181763 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847042  Vali macro F1 0.9838280 
new best score!!!!
Validation loss decreased (0.232574 --> 0.118176).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.258899688720703
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1105406  Vali Loss: 0.0687101 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924329  Vali macro F1 0.9922866 
new best score!!!!
Validation loss decreased (0.118176 --> 0.068710).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.2818756103515625
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0728442  Vali Loss: 0.0428002 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949561  Vali macro F1 0.9946259 
new best score!!!!
Validation loss decreased (0.068710 --> 0.042800).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.261038303375244
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0491546  Vali Loss: 0.0324716 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937035  Vali macro F1 0.9936023 
new best score!!!!
Validation loss decreased (0.042800 --> 0.032472).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.285452365875244
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0385620  Vali Loss: 0.0292385 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898517  Vali macro F1 0.9893469 
new best score!!!!
Validation loss decreased (0.032472 --> 0.029239).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.263392448425293
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0343925  Vali Loss: 0.0211462 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974931  Vali macro F1 0.9972569 
new best score!!!!
Validation loss decreased (0.029239 --> 0.021146).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.28970742225647
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0271945  Vali Loss: 0.0198944 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
new best score!!!!
Validation loss decreased (0.021146 --> 0.019894).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.272010564804077
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0235598  Vali Loss: 0.0163249 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949569  Vali macro F1 0.9951064 
new best score!!!!
Validation loss decreased (0.019894 --> 0.016325).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.292860269546509
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0183646  Vali Loss: 0.0120977 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987465  Vali macro F1 0.9987609 
new best score!!!!
Validation loss decreased (0.016325 --> 0.012098).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.274089336395264
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0206734  Vali Loss: 0.0134958 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962418  Vali macro F1 0.9960340 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.2962517738342285
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0221645  Vali Loss: 0.0097505 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.012098 --> 0.009750).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.276037693023682
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0200136  Vali Loss: 0.0161748 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949584  Vali macro F1 0.9949693 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.297085285186768
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0133786  Vali Loss: 0.0103275 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.27346396446228
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0090382  Vali Loss: 0.0111419 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 5.298353672027588
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0224723  Vali Loss: 0.0133146 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9977355 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 18 cost time: 5.285153865814209
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0134260  Vali Loss: 0.0087282 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.009750 --> 0.008728).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.3013200759887695
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0081550  Vali Loss: 0.0058436 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974899  Vali macro F1 0.9973910 
new best score!!!!
Validation loss decreased (0.008728 --> 0.005844).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.280970573425293
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0137474  Vali Loss: 0.0153821 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.307333946228027
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0152013  Vali Loss: 0.0085904 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987466  Vali macro F1 0.9984959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.282377243041992
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0089038  Vali Loss: 0.0042671 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005844 --> 0.004267).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.3097522258758545
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0057704  Vali Loss: 0.0033228 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004267 --> 0.003323).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.283696889877319
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0042916  Vali Loss: 0.0026834 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003323 --> 0.002683).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.308813571929932
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0065311  Vali Loss: 0.0059780 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.288919448852539
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0059238  Vali Loss: 0.0064153 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.304115056991577
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0077194  Vali Loss: 0.0045102 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.282714366912842
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0045604  Vali Loss: 0.0048407 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.308660507202148
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0031164  Vali Loss: 0.0028687 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 5.287743091583252
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0024548  Vali Loss: 0.0025670 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002683 --> 0.002567).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.309646844863892
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0021323  Vali Loss: 0.0024131 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002567 --> 0.002413).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.286414623260498
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0021282  Vali Loss: 0.0021290 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002413 --> 0.002129).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.304070949554443
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0020550  Vali Loss: 0.0018077 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002129 --> 0.001808).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.274596691131592
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0018602  Vali Loss: 0.0018212 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 5.301713943481445
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0018282  Vali Loss: 0.0019012 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 5.2756028175354
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0017709  Vali Loss: 0.0021975 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 5.300055027008057
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0017724  Vali Loss: 0.0020089 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 5.270630121231079
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0017032  Vali Loss: 0.0017930 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001808 --> 0.001793).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.302751779556274
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0028216  Vali Loss: 0.0025457 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.277053356170654
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0020185  Vali Loss: 0.0016400 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001793 --> 0.001640).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.3041605949401855
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0017204  Vali Loss: 0.0016707 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.288338899612427
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0026669  Vali Loss: 0.0045647 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.304607152938843
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0037689  Vali Loss: 0.0038555 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.28153395652771
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0026196  Vali Loss: 0.0043436 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 5.307695627212524
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0021479  Vali Loss: 0.0035891 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 5.287383794784546
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0019581  Vali Loss: 0.0036412 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.306640625
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0018767  Vali Loss: 0.0036262 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.282099723815918
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0017373  Vali Loss: 0.0036258 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 5.306725263595581
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0018270  Vali Loss: 0.0036007 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 5.282768964767456
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0017227  Vali Loss: 0.0036231 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 5.308667421340942
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0018865  Vali Loss: 0.0036167 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 5.281729221343994
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0017184  Vali Loss: 0.0036173 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 5.310034990310669
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0018074  Vali Loss: 0.0036153 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 5.283613681793213
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0016600  Vali Loss: 0.0036106 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 5.301765441894531
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0017244  Vali Loss: 0.0036092 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8447368  Test weighted F1: 0.8236953  Test macro F1 0.8236953 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.8680925369262695
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0015228  Vali Loss: 0.0016354 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.001635).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.869907855987549
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0011751  Vali Loss: 0.0013235 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001635 --> 0.001323).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.860953330993652
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0012278  Vali Loss: 0.0010496 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001323 --> 0.001050).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.861711740493774
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0008750  Vali Loss: 0.0041795 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.863418817520142
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0025521  Vali Loss: 0.0012797 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.865817546844482
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0009104  Vali Loss: 0.0016159 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.863855838775635
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0010053  Vali Loss: 0.0023274 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.860940456390381
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0007688  Vali Loss: 0.0008099 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001050 --> 0.000810).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.873371601104736
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0005815  Vali Loss: 0.0008346 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.865473985671997
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0005022  Vali Loss: 0.0009150 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.869645595550537
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0005095  Vali Loss: 0.0006793 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000810 --> 0.000679).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.867092132568359
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0004737  Vali Loss: 0.0009069 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.868127822875977
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0004141  Vali Loss: 0.0008296 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.862628698348999
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0003891  Vali Loss: 0.0012180 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.8667683601379395
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0003481  Vali Loss: 0.0009185 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.869762182235718
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0003367  Vali Loss: 0.0008995 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 6.870018482208252
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0003201  Vali Loss: 0.0004904 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000679 --> 0.000490).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.868795156478882
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0010311  Vali Loss: 0.0007117 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.868353843688965
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0005646  Vali Loss: 0.0004469 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000490 --> 0.000447).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.8677403926849365
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0010594  Vali Loss: 0.0019574 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.875263452529907
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0007644  Vali Loss: 0.0056872 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962302  Vali macro F1 0.9960799 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.867879629135132
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0004991  Vali Loss: 0.0002988 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000447 --> 0.000299).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.872354745864868
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0012691  Vali Loss: 0.0005963 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.874289035797119
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0005211  Vali Loss: 0.0004930 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.8725221157073975
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0003196  Vali Loss: 0.0002419 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000299 --> 0.000242).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.881229639053345
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0002599  Vali Loss: 0.0002709 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.8810296058654785
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0002198  Vali Loss: 0.0004926 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.872191667556763
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0002277  Vali Loss: 0.0004262 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.868065118789673
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0001885  Vali Loss: 0.0004329 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.87050461769104
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0001959  Vali Loss: 0.0002648 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 6.864355564117432
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0001868  Vali Loss: 0.0002625 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.864483594894409
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0001819  Vali Loss: 0.0002650 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.8636438846588135
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0001740  Vali Loss: 0.0002668 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.864105939865112
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0001831  Vali Loss: 0.0002826 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.8617236614227295
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0001749  Vali Loss: 0.0002842 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 36 cost time: 6.865905284881592
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0001823  Vali Loss: 0.0002845 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.8683860301971436
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0001820  Vali Loss: 0.0002847 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.863325834274292
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0001923  Vali Loss: 0.0002856 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.86556601524353
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0001745  Vali Loss: 0.0002856 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.866130590438843
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0001671  Vali Loss: 0.0002854 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8429825  Test weighted F1: 0.8229056  Test macro F1 0.8229056 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 913548
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.321813344955444
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8515205  Vali Loss: 0.6372174 Vali Accuracy: 0.8884712  Vali weighted F1: 0.8814637  Vali macro F1 0.8762290 
Validation loss decreased (inf --> 0.637217).  Saving model ...
Epoch: 2 cost time: 5.252330303192139
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4176870  Vali Loss: 0.2494246 Vali Accuracy: 0.9498747  Vali weighted F1: 0.9460028  Vali macro F1 0.9450178 
new best score!!!!
Validation loss decreased (0.637217 --> 0.249425).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.253809452056885
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1968566  Vali Loss: 0.1394106 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9755466  Vali macro F1 0.9752506 
new best score!!!!
Validation loss decreased (0.249425 --> 0.139411).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.258922338485718
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1173624  Vali Loss: 0.0936715 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810703  Vali macro F1 0.9808937 
new best score!!!!
Validation loss decreased (0.139411 --> 0.093671).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.259539604187012
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0794035  Vali Loss: 0.0605049 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899370  Vali macro F1 0.9900729 
new best score!!!!
Validation loss decreased (0.093671 --> 0.060505).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.271475315093994
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0591488  Vali Loss: 0.0453531 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886596  Vali macro F1 0.9887902 
new best score!!!!
Validation loss decreased (0.060505 --> 0.045353).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.272543668746948
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0477000  Vali Loss: 0.0438880 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836079  Vali macro F1 0.9838884 
new best score!!!!
Validation loss decreased (0.045353 --> 0.043888).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.280142545700073
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0368455  Vali Loss: 0.0277926 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
new best score!!!!
Validation loss decreased (0.043888 --> 0.027793).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.278723478317261
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0321236  Vali Loss: 0.0270167 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924725  Vali macro F1 0.9926170 
new best score!!!!
Validation loss decreased (0.027793 --> 0.027017).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.283320426940918
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0304303  Vali Loss: 0.0217409 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
new best score!!!!
Validation loss decreased (0.027017 --> 0.021741).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.282591819763184
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0234671  Vali Loss: 0.0241103 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937296  Vali macro F1 0.9937308 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.284578561782837
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0254721  Vali Loss: 0.0272384 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898285  Vali macro F1 0.9899834 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.287934303283691
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0234810  Vali Loss: 0.0236721 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912043  Vali macro F1 0.9911756 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 5.291855335235596
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0214180  Vali Loss: 0.0249943 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924532  Vali macro F1 0.9923492 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 15 cost time: 5.29407000541687
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0216184  Vali Loss: 0.0165742 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962353  Vali macro F1 0.9962561 
new best score!!!!
Validation loss decreased (0.021741 --> 0.016574).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.304487943649292
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0278136  Vali Loss: 0.0202130 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.292370319366455
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0216348  Vali Loss: 0.0190438 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937463  Vali macro F1 0.9938272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.294315814971924
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0189149  Vali Loss: 0.0116886 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962237  Vali macro F1 0.9962951 
new best score!!!!
Validation loss decreased (0.016574 --> 0.011689).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.291144371032715
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0149195  Vali Loss: 0.0211165 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912075  Vali macro F1 0.9913481 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.287734031677246
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0193226  Vali Loss: 0.0159167 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936787  Vali macro F1 0.9937449 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.29006028175354
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0140363  Vali Loss: 0.0181663 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 5.28936767578125
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0126938  Vali Loss: 0.0105876 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
new best score!!!!
Validation loss decreased (0.011689 --> 0.010588).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.29343581199646
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0094664  Vali Loss: 0.0140129 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937528  Vali macro F1 0.9937338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.291627645492554
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0117437  Vali Loss: 0.0137706 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949846 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.290266275405884
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0151548  Vali Loss: 0.0186918 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949835  Vali macro F1 0.9949787 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.289823055267334
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0178423  Vali Loss: 0.0181130 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936486  Vali macro F1 0.9937116 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.289076566696167
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0158257  Vali Loss: 0.0152103 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924509  Vali macro F1 0.9923696 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 5.289919376373291
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0107890  Vali Loss: 0.0119975 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.290021896362305
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0096031  Vali Loss: 0.0100073 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
new best score!!!!
Validation loss decreased (0.010588 --> 0.010007).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.283150672912598
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0087986  Vali Loss: 0.0093825 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962387  Vali macro F1 0.9961671 
new best score!!!!
Validation loss decreased (0.010007 --> 0.009383).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.285431385040283
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0088890  Vali Loss: 0.0101578 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.287992000579834
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0126485  Vali Loss: 0.0099392 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.287045955657959
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0078996  Vali Loss: 0.0094787 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.292003393173218
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0074179  Vali Loss: 0.0093707 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
new best score!!!!
Validation loss decreased (0.009383 --> 0.009371).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.293404579162598
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0071193  Vali Loss: 0.0100810 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.287611246109009
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0072884  Vali Loss: 0.0094826 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.287959575653076
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0068329  Vali Loss: 0.0095955 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 5.290818691253662
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0066181  Vali Loss: 0.0096764 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 5.291043996810913
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0065722  Vali Loss: 0.0095674 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 5.2870402336120605
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0065225  Vali Loss: 0.0095331 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.28438925743103
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0064115  Vali Loss: 0.0094574 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.287560701370239
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0063521  Vali Loss: 0.0094549 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.288977861404419
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0066898  Vali Loss: 0.0097365 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.289971351623535
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0064056  Vali Loss: 0.0097527 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 5.289788722991943
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0063066  Vali Loss: 0.0097497 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.291788578033447
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0087074  Vali Loss: 0.0097472 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.289728403091431
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0065399  Vali Loss: 0.0097367 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.288627862930298
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0062034  Vali Loss: 0.0097328 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.285393476486206
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0062372  Vali Loss: 0.0097305 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949804  Vali macro F1 0.9949063 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8543860  Test weighted F1: 0.8390966  Test macro F1 0.8390966 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.90658712387085
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0081563  Vali Loss: 0.0094522 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
Validation loss decreased (inf --> 0.009452).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.8973612785339355
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0068694  Vali Loss: 0.0096156 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.906000852584839
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0069467  Vali Loss: 0.0067898 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.009452 --> 0.006790).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.909519672393799
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0056620  Vali Loss: 0.0069639 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.922282695770264
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0055630  Vali Loss: 0.0077546 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.909666538238525
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0055532  Vali Loss: 0.0074366 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.907435178756714
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0050631  Vali Loss: 0.0077871 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.915316104888916
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0044026  Vali Loss: 0.0074488 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.898502588272095
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0045200  Vali Loss: 0.0085162 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.906879901885986
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0043565  Vali Loss: 0.0090078 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.9009130001068115
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0044883  Vali Loss: 0.0085072 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.915541172027588
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0040060  Vali Loss: 0.0088969 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.9048011302948
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0043312  Vali Loss: 0.0084801 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.92464804649353
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0037349  Vali Loss: 0.0084876 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.910412788391113
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0037220  Vali Loss: 0.0084561 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.907094240188599
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0035748  Vali Loss: 0.0084247 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.913890361785889
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0041405  Vali Loss: 0.0084223 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.915813446044922
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0036663  Vali Loss: 0.0087218 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8701754  Test weighted F1: 0.8562381  Test macro F1 0.8562381 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.401402711868286
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8498662  Vali Loss: 0.6538451 Vali Accuracy: 0.8984962  Vali weighted F1: 0.8852443  Vali macro F1 0.8853693 
Validation loss decreased (inf --> 0.653845).  Saving model ...
Epoch: 2 cost time: 5.299163579940796
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4342204  Vali Loss: 0.2465745 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9549772  Vali macro F1 0.9543996 
new best score!!!!
Validation loss decreased (0.653845 --> 0.246575).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.307366371154785
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1889085  Vali Loss: 0.1255166 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9777154  Vali macro F1 0.9776363 
new best score!!!!
Validation loss decreased (0.246575 --> 0.125517).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.304868221282959
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1105324  Vali Loss: 0.0818240 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9806238  Vali macro F1 0.9807221 
new best score!!!!
Validation loss decreased (0.125517 --> 0.081824).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.310058116912842
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0764933  Vali Loss: 0.0587491 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9832289  Vali macro F1 0.9833206 
new best score!!!!
Validation loss decreased (0.081824 --> 0.058749).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.3085222244262695
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0551231  Vali Loss: 0.0394138 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.058749 --> 0.039414).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.322111368179321
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0442451  Vali Loss: 0.0347494 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898850  Vali macro F1 0.9900190 
new best score!!!!
Validation loss decreased (0.039414 --> 0.034749).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.316128730773926
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0399182  Vali Loss: 0.0333900 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
new best score!!!!
Validation loss decreased (0.034749 --> 0.033390).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.316192865371704
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0313696  Vali Loss: 0.0289824 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912376  Vali macro F1 0.9915475 
new best score!!!!
Validation loss decreased (0.033390 --> 0.028982).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.318578004837036
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0275563  Vali Loss: 0.0246353 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911154  Vali macro F1 0.9912494 
new best score!!!!
Validation loss decreased (0.028982 --> 0.024635).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.314544439315796
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0242709  Vali Loss: 0.0296532 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886935  Vali macro F1 0.9889095 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.318519353866577
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0254847  Vali Loss: 0.0252286 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859000  Vali macro F1 0.9860090 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.315248966217041
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0195125  Vali Loss: 0.0175447 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937203  Vali macro F1 0.9937871 
new best score!!!!
Validation loss decreased (0.024635 --> 0.017545).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.311392068862915
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0180520  Vali Loss: 0.0178905 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923998  Vali macro F1 0.9925381 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.315954208374023
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0161079  Vali Loss: 0.0180653 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923930  Vali macro F1 0.9924796 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.319905996322632
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0256038  Vali Loss: 0.0267500 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912260  Vali macro F1 0.9914504 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 17 cost time: 5.314823627471924
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0198779  Vali Loss: 0.0188768 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937303  Vali macro F1 0.9937500 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 18 cost time: 5.313966751098633
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0239144  Vali Loss: 0.0146153 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962396  Vali macro F1 0.9962437 
new best score!!!!
Validation loss decreased (0.017545 --> 0.014615).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.315715789794922
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0197225  Vali Loss: 0.0113359 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.014615 --> 0.011336).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.311919450759888
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0329865  Vali Loss: 0.0197888 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.315086126327515
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0173458  Vali Loss: 0.0132880 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.313392877578735
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0120648  Vali Loss: 0.0085212 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.011336 --> 0.008521).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.314178943634033
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0087178  Vali Loss: 0.0109136 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937788  Vali macro F1 0.9938552 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.317611217498779
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0090327  Vali Loss: 0.0064390 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008521 --> 0.006439).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.310565233230591
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0094175  Vali Loss: 0.0096654 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949786  Vali macro F1 0.9950906 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.3077614307403564
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0093223  Vali Loss: 0.0077252 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.306674480438232
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0068265  Vali Loss: 0.0051944 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006439 --> 0.005194).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.309961557388306
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0274508  Vali Loss: 0.0129520 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.305604696273804
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0113401  Vali Loss: 0.0099312 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962369  Vali macro F1 0.9963514 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.305286645889282
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0081826  Vali Loss: 0.0053689 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.311941862106323
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0060493  Vali Loss: 0.0089822 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950029  Vali macro F1 0.9951946 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.31279730796814
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0425111  Vali Loss: 0.0184796 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962358 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 5.307274580001831
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0151429  Vali Loss: 0.0093416 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.305810213088989
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0101474  Vali Loss: 0.0093871 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962355  Vali macro F1 0.9962354 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.305673837661743
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0086779  Vali Loss: 0.0079534 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.307306528091431
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0077659  Vali Loss: 0.0066551 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.301978826522827
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0074538  Vali Loss: 0.0061725 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 5.303989887237549
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0071076  Vali Loss: 0.0061163 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.310689687728882
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0070299  Vali Loss: 0.0060825 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.312733888626099
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0068700  Vali Loss: 0.0060258 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.309907674789429
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0068905  Vali Loss: 0.0059690 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.310640335083008
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0067755  Vali Loss: 0.0059585 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9359649  Test weighted F1: 0.9232112  Test macro F1 0.9232112 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.961548805236816
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0057556  Vali Loss: 0.0041566 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
Validation loss decreased (inf --> 0.004157).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.95991325378418
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0041638  Vali Loss: 0.0061557 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.963291168212891
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0042511  Vali Loss: 0.0026447 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004157 --> 0.002645).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.96139121055603
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0033916  Vali Loss: 0.0027317 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.964903354644775
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0042970  Vali Loss: 0.0023022 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002645 --> 0.002302).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.957185506820679
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0042396  Vali Loss: 0.0023328 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.953129053115845
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0030984  Vali Loss: 0.0021004 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002302 --> 0.002100).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.958251953125
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0041817  Vali Loss: 0.0017533 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002100 --> 0.001753).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.969752073287964
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0038068  Vali Loss: 0.0034467 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.959656000137329
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0030682  Vali Loss: 0.0021563 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.9624011516571045
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0026392  Vali Loss: 0.0019825 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.9651265144348145
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0027097  Vali Loss: 0.0019409 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.961279392242432
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0026079  Vali Loss: 0.0027712 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 6.964972496032715
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0021548  Vali Loss: 0.0015118 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001753 --> 0.001512).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.961163759231567
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0028194  Vali Loss: 0.0011035 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001512 --> 0.001104).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.962784767150879
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0024116  Vali Loss: 0.0011999 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.960057735443115
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0026145  Vali Loss: 0.0025143 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.965696811676025
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0028241  Vali Loss: 0.0021234 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.963814735412598
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0022720  Vali Loss: 0.0014884 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.961054086685181
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0022099  Vali Loss: 0.0016189 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.96142578125
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0019459  Vali Loss: 0.0013638 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.958786964416504
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0017877  Vali Loss: 0.0012054 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.966156482696533
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0018859  Vali Loss: 0.0011819 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.959739923477173
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0019154  Vali Loss: 0.0011889 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.967825174331665
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0018058  Vali Loss: 0.0012210 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.962831258773804
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0017183  Vali Loss: 0.0012197 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.956689119338989
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0018901  Vali Loss: 0.0012193 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.966578722000122
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0018619  Vali Loss: 0.0012181 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.963980674743652
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0016760  Vali Loss: 0.0012161 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.962008237838745
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0017361  Vali Loss: 0.0012170 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8929825  Test weighted F1: 0.8761420  Test macro F1 0.8761420 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.400396108627319
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8584908  Vali Loss: 0.6716714 Vali Accuracy: 0.8897243  Vali weighted F1: 0.8777728  Vali macro F1 0.8750988 
Validation loss decreased (inf --> 0.671671).  Saving model ...
Epoch: 2 cost time: 5.295544385910034
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4426992  Vali Loss: 0.2289027 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9673581  Vali macro F1 0.9666143 
new best score!!!!
Validation loss decreased (0.671671 --> 0.228903).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.2922093868255615
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1855105  Vali Loss: 0.1233198 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845589  Vali macro F1 0.9843203 
new best score!!!!
Validation loss decreased (0.228903 --> 0.123320).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.293260812759399
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1046511  Vali Loss: 0.0693285 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886199  Vali macro F1 0.9885908 
new best score!!!!
Validation loss decreased (0.123320 --> 0.069329).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.282226085662842
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0694795  Vali Loss: 0.0514069 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885608  Vali macro F1 0.9885250 
new best score!!!!
Validation loss decreased (0.069329 --> 0.051407).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.286423683166504
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0563616  Vali Loss: 0.0416422 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898596  Vali macro F1 0.9898308 
new best score!!!!
Validation loss decreased (0.051407 --> 0.041642).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.288466930389404
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0458856  Vali Loss: 0.0377068 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898990  Vali macro F1 0.9897849 
new best score!!!!
Validation loss decreased (0.041642 --> 0.037707).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.279852628707886
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0362342  Vali Loss: 0.0260117 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924532  Vali macro F1 0.9923492 
new best score!!!!
Validation loss decreased (0.037707 --> 0.026012).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.2813239097595215
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0289633  Vali Loss: 0.0254099 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
new best score!!!!
Validation loss decreased (0.026012 --> 0.025410).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.274724721908569
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0270365  Vali Loss: 0.0284373 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899061  Vali macro F1 0.9898832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.274571657180786
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0259922  Vali Loss: 0.0236405 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
new best score!!!!
Validation loss decreased (0.025410 --> 0.023641).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.277050733566284
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0257015  Vali Loss: 0.0184502 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.023641 --> 0.018450).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.282016038894653
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0199883  Vali Loss: 0.0195821 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.278062105178833
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0199128  Vali Loss: 0.0250929 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9883712  Vali macro F1 0.9883345 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.281538724899292
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0196845  Vali Loss: 0.0163305 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937352  Vali macro F1 0.9937334 
new best score!!!!
Validation loss decreased (0.018450 --> 0.016331).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.282684564590454
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0185692  Vali Loss: 0.0105963 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.016331 --> 0.010596).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.283196449279785
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0132739  Vali Loss: 0.0098726 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.010596 --> 0.009873).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.289184808731079
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0169700  Vali Loss: 0.0163147 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9949875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.289261102676392
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0199661  Vali Loss: 0.0110672 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.292213201522827
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0152867  Vali Loss: 0.0083545 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.009873 --> 0.008355).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.294501781463623
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0127659  Vali Loss: 0.0151061 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.2966086864471436
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0137436  Vali Loss: 0.0120675 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937020  Vali macro F1 0.9937715 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.297060966491699
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0113002  Vali Loss: 0.0069038 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008355 --> 0.006904).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.297740459442139
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0274716  Vali Loss: 0.1201873 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9548064  Vali macro F1 0.9535957 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.299670696258545
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0464654  Vali Loss: 0.0209635 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962487  Vali macro F1 0.9963090 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.294555187225342
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0221417  Vali Loss: 0.0125692 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962411  Vali macro F1 0.9962401 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.294084548950195
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0187258  Vali Loss: 0.0136586 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.292104959487915
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0111096  Vali Loss: 0.0090645 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962397  Vali macro F1 0.9963129 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 5.293873310089111
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0082820  Vali Loss: 0.0068154 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
new best score!!!!
Validation loss decreased (0.006904 --> 0.006815).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.3013598918914795
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0084710  Vali Loss: 0.0069210 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.295443058013916
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0064062  Vali Loss: 0.0058600 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
new best score!!!!
Validation loss decreased (0.006815 --> 0.005860).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.300596237182617
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0058368  Vali Loss: 0.0058575 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
new best score!!!!
Validation loss decreased (0.005860 --> 0.005857).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.296754360198975
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0061488  Vali Loss: 0.0047492 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005857 --> 0.004749).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.29338812828064
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0056566  Vali Loss: 0.0046911 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
new best score!!!!
Validation loss decreased (0.004749 --> 0.004691).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.289963006973267
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0053656  Vali Loss: 0.0040389 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004691 --> 0.004039).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.295758247375488
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0051262  Vali Loss: 0.0037828 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004039 --> 0.003783).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.294469833374023
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0051430  Vali Loss: 0.0038764 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.296722650527954
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0048319  Vali Loss: 0.0036483 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003783 --> 0.003648).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.295298099517822
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0049199  Vali Loss: 0.0034255 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003648 --> 0.003425).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.293013095855713
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0054462  Vali Loss: 0.0034504 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.292669057846069
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0054602  Vali Loss: 0.0035984 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.288737058639526
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0044613  Vali Loss: 0.0034251 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003425 --> 0.003425).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.291553974151611
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0049643  Vali Loss: 0.0037153 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.292692184448242
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0041765  Vali Loss: 0.0032476 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003425 --> 0.003248).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.294955015182495
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0047858  Vali Loss: 0.0032407 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003248 --> 0.003241).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 5.302004098892212
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0048297  Vali Loss: 0.0078286 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974937 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.294818162918091
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0050254  Vali Loss: 0.0034595 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.29179048538208
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0046512  Vali Loss: 0.0034814 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 5.292056322097778
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0043655  Vali Loss: 0.0030322 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003241 --> 0.003032).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 5.291635751724243
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0044790  Vali Loss: 0.0030188 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003032 --> 0.003019).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 5.2916646003723145
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0038768  Vali Loss: 0.0029276 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003019 --> 0.002928).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 5.287631511688232
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0036267  Vali Loss: 0.0027264 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002928 --> 0.002726).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 5.291064023971558
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0038646  Vali Loss: 0.0026918 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002726 --> 0.002692).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 5.291250705718994
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0041059  Vali Loss: 0.0028045 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.28975510597229
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0037272  Vali Loss: 0.0027599 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 5.289326906204224
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0036153  Vali Loss: 0.0024825 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002692 --> 0.002483).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 5.2908775806427
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0033288  Vali Loss: 0.0022936 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002483 --> 0.002294).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 5.290333986282349
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0039447  Vali Loss: 0.0026165 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 5.288810968399048
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0029575  Vali Loss: 0.0024163 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 5.291935920715332
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0033282  Vali Loss: 0.0023659 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 5.290443181991577
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0036321  Vali Loss: 0.0025660 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 5.2937541007995605
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0032342  Vali Loss: 0.0024422 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 63 cost time: 5.290733337402344
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0032011  Vali Loss: 0.0023868 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 5.29208517074585
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0029147  Vali Loss: 0.0023387 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 5.2935631275177
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0030089  Vali Loss: 0.0023121 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 5.293146371841431
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0029988  Vali Loss: 0.0023332 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 5.296308755874634
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0028417  Vali Loss: 0.0022956 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 68 cost time: 5.2938432693481445
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0033434  Vali Loss: 0.0022938 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 5.301668882369995
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0030434  Vali Loss: 0.0022929 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002294 --> 0.002293).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 5.296474456787109
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0028710  Vali Loss: 0.0022921 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002293 --> 0.002292).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 5.293460845947266
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0027999  Vali Loss: 0.0022904 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002292 --> 0.002290).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 5.293485641479492
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0029555  Vali Loss: 0.0022910 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 5.292523384094238
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0027231  Vali Loss: 0.0022899 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002290 --> 0.002290).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 5.297491550445557
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0030762  Vali Loss: 0.0022859 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002290 --> 0.002286).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 5.292516469955444
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0029008  Vali Loss: 0.0022844 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002286 --> 0.002284).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 5.291002988815308
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0030029  Vali Loss: 0.0022814 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002284 --> 0.002281).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 5.294144153594971
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0027997  Vali Loss: 0.0022819 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 5.293097734451294
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0027455  Vali Loss: 0.0022815 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 5.29391622543335
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0027437  Vali Loss: 0.0022779 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002281 --> 0.002278).  Saving model ...
new best score!!!!
Epoch: 80 cost time: 5.293615818023682
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0027885  Vali Loss: 0.0022760 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002278 --> 0.002276).  Saving model ...
new best score!!!!
Epoch: 81 cost time: 5.292322158813477
VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0030574  Vali Loss: 0.0022746 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002276 --> 0.002275).  Saving model ...
new best score!!!!
Epoch: 82 cost time: 5.292564868927002
VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0030973  Vali Loss: 0.0022736 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002275 --> 0.002274).  Saving model ...
new best score!!!!
Epoch: 83 cost time: 5.294470548629761
VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0028055  Vali Loss: 0.0022701 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002274 --> 0.002270).  Saving model ...
new best score!!!!
Epoch: 84 cost time: 5.295392990112305
VALI: Epoch: 84, Steps: 29 | Train Loss: 0.0029725  Vali Loss: 0.0022685 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002270 --> 0.002268).  Saving model ...
new best score!!!!
Epoch: 85 cost time: 5.290209770202637
VALI: Epoch: 85, Steps: 29 | Train Loss: 0.0028054  Vali Loss: 0.0022653 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002268 --> 0.002265).  Saving model ...
new best score!!!!
Epoch: 86 cost time: 5.293067693710327
VALI: Epoch: 86, Steps: 29 | Train Loss: 0.0029805  Vali Loss: 0.0022625 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002265 --> 0.002262).  Saving model ...
new best score!!!!
Epoch: 87 cost time: 5.289234161376953
VALI: Epoch: 87, Steps: 29 | Train Loss: 0.0029300  Vali Loss: 0.0022597 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002262 --> 0.002260).  Saving model ...
new best score!!!!
Epoch: 88 cost time: 5.292064905166626
VALI: Epoch: 88, Steps: 29 | Train Loss: 0.0029570  Vali Loss: 0.0022591 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002260 --> 0.002259).  Saving model ...
new best score!!!!
Epoch: 89 cost time: 5.287138938903809
VALI: Epoch: 89, Steps: 29 | Train Loss: 0.0029037  Vali Loss: 0.0022570 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002259 --> 0.002257).  Saving model ...
new best score!!!!
Epoch: 90 cost time: 5.292798042297363
VALI: Epoch: 90, Steps: 29 | Train Loss: 0.0029330  Vali Loss: 0.0022536 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002257 --> 0.002254).  Saving model ...
new best score!!!!
Epoch: 91 cost time: 5.28982138633728
VALI: Epoch: 91, Steps: 29 | Train Loss: 0.0030963  Vali Loss: 0.0022501 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002254 --> 0.002250).  Saving model ...
new best score!!!!
Epoch: 92 cost time: 5.292504072189331
VALI: Epoch: 92, Steps: 29 | Train Loss: 0.0030201  Vali Loss: 0.0022486 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002250 --> 0.002249).  Saving model ...
new best score!!!!
Epoch: 93 cost time: 5.29434871673584
VALI: Epoch: 93, Steps: 29 | Train Loss: 0.0029155  Vali Loss: 0.0022470 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002249 --> 0.002247).  Saving model ...
new best score!!!!
Epoch: 94 cost time: 5.293625354766846
VALI: Epoch: 94, Steps: 29 | Train Loss: 0.0029565  Vali Loss: 0.0022436 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002247 --> 0.002244).  Saving model ...
new best score!!!!
Epoch: 95 cost time: 5.297897815704346
VALI: Epoch: 95, Steps: 29 | Train Loss: 0.0048298  Vali Loss: 0.0022448 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 96 cost time: 5.292289733886719
VALI: Epoch: 96, Steps: 29 | Train Loss: 0.0029669  Vali Loss: 0.0022582 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 97 cost time: 5.288945913314819
VALI: Epoch: 97, Steps: 29 | Train Loss: 0.0027641  Vali Loss: 0.0022569 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 98 cost time: 5.290458679199219
VALI: Epoch: 98, Steps: 29 | Train Loss: 0.0028254  Vali Loss: 0.0022553 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 99 cost time: 5.288222551345825
VALI: Epoch: 99, Steps: 29 | Train Loss: 0.0027190  Vali Loss: 0.0022540 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 100 cost time: 5.288213491439819
VALI: Epoch: 100, Steps: 29 | Train Loss: 0.0027469  Vali Loss: 0.0022540 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 101 cost time: 5.2914745807647705
VALI: Epoch: 101, Steps: 29 | Train Loss: 0.0028775  Vali Loss: 0.0022534 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 102 cost time: 5.291778564453125
VALI: Epoch: 102, Steps: 29 | Train Loss: 0.0029002  Vali Loss: 0.0022530 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 103 cost time: 5.293505430221558
VALI: Epoch: 103, Steps: 29 | Train Loss: 0.0029967  Vali Loss: 0.0022526 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 104 cost time: 5.290069103240967
VALI: Epoch: 104, Steps: 29 | Train Loss: 0.0029966  Vali Loss: 0.0022522 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000004e-08
Epoch: 105 cost time: 5.290892124176025
VALI: Epoch: 105, Steps: 29 | Train Loss: 0.0029271  Vali Loss: 0.0022522 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 106 cost time: 5.288900852203369
VALI: Epoch: 106, Steps: 29 | Train Loss: 0.0030600  Vali Loss: 0.0022522 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 107 cost time: 5.292273283004761
VALI: Epoch: 107, Steps: 29 | Train Loss: 0.0027599  Vali Loss: 0.0022522 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 108 cost time: 5.293054819107056
VALI: Epoch: 108, Steps: 29 | Train Loss: 0.0029941  Vali Loss: 0.0022521 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 109 cost time: 5.294630289077759
VALI: Epoch: 109, Steps: 29 | Train Loss: 0.0031891  Vali Loss: 0.0022521 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9447368  Test weighted F1: 0.9441758  Test macro F1 0.9441758 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.893902540206909
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0030805  Vali Loss: 0.0030486 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
Validation loss decreased (inf --> 0.003049).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.90126371383667
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0037660  Vali Loss: 0.0061125 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.885047435760498
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0027594  Vali Loss: 0.0030195 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003049 --> 0.003019).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.889015197753906
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0022490  Vali Loss: 0.0020905 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003019 --> 0.002090).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.88441801071167
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0022960  Vali Loss: 0.0018538 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002090 --> 0.001854).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.888416290283203
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0022331  Vali Loss: 0.0012534 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001854 --> 0.001253).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.8797454833984375
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0017585  Vali Loss: 0.0011020 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001253 --> 0.001102).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.886833429336548
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0031194  Vali Loss: 0.0014935 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.888556241989136
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0023861  Vali Loss: 0.0034254 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.895592927932739
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0027531  Vali Loss: 0.0015454 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.891941547393799
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0020161  Vali Loss: 0.0015446 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.886797666549683
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0019812  Vali Loss: 0.0013970 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.892854452133179
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0019446  Vali Loss: 0.0010730 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001102 --> 0.001073).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.898067474365234
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0013333  Vali Loss: 0.0012736 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.885984182357788
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0032529  Vali Loss: 0.0015351 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.901011943817139
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0023829  Vali Loss: 0.0011219 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.882858514785767
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0017398  Vali Loss: 0.0009051 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001073 --> 0.000905).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.907539367675781
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0020685  Vali Loss: 0.0011245 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.888965845108032
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0018310  Vali Loss: 0.0012911 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.893950462341309
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0016336  Vali Loss: 0.0009679 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.886211395263672
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0029600  Vali Loss: 0.0056982 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.891817569732666
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0047876  Vali Loss: 0.0031288 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.901858568191528
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0024375  Vali Loss: 0.0017081 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.89037561416626
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0020938  Vali Loss: 0.0016197 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.901227712631226
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0015157  Vali Loss: 0.0015779 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.887970924377441
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0016302  Vali Loss: 0.0015439 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.901784181594849
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0015731  Vali Loss: 0.0015068 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 6.8976969718933105
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0014527  Vali Loss: 0.0015045 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.900421857833862
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0017297  Vali Loss: 0.0015029 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.904964447021484
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0013078  Vali Loss: 0.0015008 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.899409294128418
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0017408  Vali Loss: 0.0015068 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.902447938919067
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0015785  Vali Loss: 0.0015016 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9543860  Test weighted F1: 0.9538268  Test macro F1 0.9538268 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.3546741008758545
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8603134  Vali Loss: 0.6344408 Vali Accuracy: 0.8822055  Vali weighted F1: 0.8754490  Vali macro F1 0.8721133 
Validation loss decreased (inf --> 0.634441).  Saving model ...
Epoch: 2 cost time: 5.2899329662323
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4059509  Vali Loss: 0.2300480 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9678476  Vali macro F1 0.9672669 
new best score!!!!
Validation loss decreased (0.634441 --> 0.230048).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.2923054695129395
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1724385  Vali Loss: 0.1114553 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9871925  Vali macro F1 0.9873304 
new best score!!!!
Validation loss decreased (0.230048 --> 0.111455).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.294613599777222
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0953231  Vali Loss: 0.0717700 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848275  Vali macro F1 0.9848887 
new best score!!!!
Validation loss decreased (0.111455 --> 0.071770).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.298328161239624
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0654454  Vali Loss: 0.0556060 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886103  Vali macro F1 0.9888685 
new best score!!!!
Validation loss decreased (0.071770 --> 0.055606).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.2953040599823
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0554688  Vali Loss: 0.0445750 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860676  Vali macro F1 0.9862024 
new best score!!!!
Validation loss decreased (0.055606 --> 0.044575).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.298212766647339
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0395082  Vali Loss: 0.0353457 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848265  Vali macro F1 0.9850413 
new best score!!!!
Validation loss decreased (0.044575 --> 0.035346).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.302202463150024
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0372783  Vali Loss: 0.0342719 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862807  Vali macro F1 0.9862810 
new best score!!!!
Validation loss decreased (0.035346 --> 0.034272).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.2977588176727295
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0293319  Vali Loss: 0.0242502 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937035  Vali macro F1 0.9937568 
new best score!!!!
Validation loss decreased (0.034272 --> 0.024250).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.295591831207275
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0293044  Vali Loss: 0.0276874 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911798  Vali macro F1 0.9910710 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.296103000640869
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0256930  Vali Loss: 0.0220280 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937493  Vali macro F1 0.9940257 
new best score!!!!
Validation loss decreased (0.024250 --> 0.022028).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.298096179962158
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0214269  Vali Loss: 0.0336170 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900118  Vali macro F1 0.9900054 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.295594692230225
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0230553  Vali Loss: 0.0242999 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887586  Vali macro F1 0.9890665 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.297593832015991
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0193169  Vali Loss: 0.0192284 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937560  Vali macro F1 0.9937523 
new best score!!!!
Validation loss decreased (0.022028 --> 0.019228).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.2949559688568115
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0250046  Vali Loss: 0.0217659 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924651  Vali macro F1 0.9925739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.293748617172241
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0346978  Vali Loss: 0.0237240 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937029  Vali macro F1 0.9936806 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.286946773529053
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0182606  Vali Loss: 0.0179896 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912399  Vali macro F1 0.9915011 
new best score!!!!
Validation loss decreased (0.019228 --> 0.017990).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.29082465171814
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0159428  Vali Loss: 0.0172739 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937242  Vali macro F1 0.9936223 
new best score!!!!
Validation loss decreased (0.017990 --> 0.017274).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.292194604873657
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0194238  Vali Loss: 0.0123402 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.017274 --> 0.012340).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.291810035705566
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0115969  Vali Loss: 0.0155323 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937656  Vali macro F1 0.9938388 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.296671628952026
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0097839  Vali Loss: 0.0099970 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.012340 --> 0.009997).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.292449712753296
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0089229  Vali Loss: 0.0103610 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.294525384902954
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0133577  Vali Loss: 0.0163944 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937071  Vali macro F1 0.9935269 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.287986755371094
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0113109  Vali Loss: 0.0109383 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962395  Vali macro F1 0.9963229 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.284769535064697
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0127612  Vali Loss: 0.0159048 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962381  Vali macro F1 0.9962603 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 5.286522388458252
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0330832  Vali Loss: 0.0145884 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 5.28878378868103
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0157779  Vali Loss: 0.0125943 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962411  Vali macro F1 0.9961467 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.28478479385376
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0125106  Vali Loss: 0.0129145 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949896  Vali macro F1 0.9949706 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.290142059326172
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0111462  Vali Loss: 0.0119039 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 5.285016059875488
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0104226  Vali Loss: 0.0119431 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9951399 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 5.2845587730407715
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0096804  Vali Loss: 0.0119008 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 32 cost time: 5.287967205047607
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0140518  Vali Loss: 0.0118481 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.281404972076416
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0090755  Vali Loss: 0.0113052 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.287630081176758
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0090381  Vali Loss: 0.0113728 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.288189649581909
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0088479  Vali Loss: 0.0116222 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.282524108886719
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0088373  Vali Loss: 0.0117579 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7912281  Test weighted F1: 0.7318276  Test macro F1 0.7318276 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.928218126296997
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0077629  Vali Loss: 0.0083746 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962411  Vali macro F1 0.9961467 
Validation loss decreased (inf --> 0.008375).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.874889373779297
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0072177  Vali Loss: 0.0071543 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.008375 --> 0.007154).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.851267099380493
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0058960  Vali Loss: 0.0058448 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007154 --> 0.005845).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.881488561630249
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0055925  Vali Loss: 0.0058530 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.852441072463989
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0057594  Vali Loss: 0.0050617 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005845 --> 0.005062).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.882139205932617
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0056801  Vali Loss: 0.0046856 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005062 --> 0.004686).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.860055208206177
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0049425  Vali Loss: 0.0049803 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.885622978210449
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0039356  Vali Loss: 0.0055046 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.852527141571045
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0040130  Vali Loss: 0.0046648 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004686 --> 0.004665).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.887936115264893
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0039610  Vali Loss: 0.0070427 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.856761693954468
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0044177  Vali Loss: 0.0059512 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.88932204246521
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0039155  Vali Loss: 0.0042028 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.004665 --> 0.004203).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.863211393356323
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0045774  Vali Loss: 0.0073080 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962411  Vali macro F1 0.9962401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.882644891738892
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0052738  Vali Loss: 0.0050689 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974965  Vali macro F1 0.9974039 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.8579301834106445
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0068616  Vali Loss: 0.0115937 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950094  Vali macro F1 0.9947428 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.881677150726318
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0054436  Vali Loss: 0.0063394 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.853704452514648
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0043402  Vali Loss: 0.0057668 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 6.880785703659058
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0037684  Vali Loss: 0.0049029 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.85583758354187
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0034418  Vali Loss: 0.0041822 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.004203 --> 0.004182).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.883028984069824
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0033461  Vali Loss: 0.0039749 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.004182 --> 0.003975).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.858753442764282
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0032387  Vali Loss: 0.0037854 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003975 --> 0.003785).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.883663177490234
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0029605  Vali Loss: 0.0035884 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003785 --> 0.003588).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.857920169830322
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0032329  Vali Loss: 0.0040771 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.891645431518555
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0028563  Vali Loss: 0.0037307 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.855899095535278
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0025879  Vali Loss: 0.0036643 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.881918668746948
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025668  Vali Loss: 0.0039153 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.852801561355591
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0028929  Vali Loss: 0.0033087 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
new best score!!!!
Validation loss decreased (0.003588 --> 0.003309).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 6.883095026016235
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0023627  Vali Loss: 0.0028091 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.003309 --> 0.002809).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.852755546569824
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0024341  Vali Loss: 0.0025400 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002809 --> 0.002540).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 6.8877012729644775
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0023054  Vali Loss: 0.0031651 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.856586933135986
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0032465  Vali Loss: 0.0032000 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.8847832679748535
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0026227  Vali Loss: 0.0044823 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975037  Vali macro F1 0.9976784 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.857471704483032
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0026531  Vali Loss: 0.0027661 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.876862525939941
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0021998  Vali Loss: 0.0025100 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002540 --> 0.002510).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 6.856287002563477
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0022589  Vali Loss: 0.0032258 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 6.878480911254883
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0019971  Vali Loss: 0.0028026 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 6.859299898147583
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0016329  Vali Loss: 0.0066101 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 6.877122163772583
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0037649  Vali Loss: 0.0030841 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975180  Vali macro F1 0.9972543 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 6.852365970611572
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0022288  Vali Loss: 0.0026898 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 40 cost time: 6.877863168716431
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0018341  Vali Loss: 0.0025491 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 6.852781772613525
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0023409  Vali Loss: 0.0024751 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002510 --> 0.002475).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 42 cost time: 6.875255107879639
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0019249  Vali Loss: 0.0023995 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002475 --> 0.002399).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 43 cost time: 6.852734565734863
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0017448  Vali Loss: 0.0023634 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002399 --> 0.002363).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 44 cost time: 6.871982574462891
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0020883  Vali Loss: 0.0023316 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002363 --> 0.002332).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 45 cost time: 6.85501766204834
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0016949  Vali Loss: 0.0022913 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002332 --> 0.002291).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 6.88268780708313
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0020633  Vali Loss: 0.0022787 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002291 --> 0.002279).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 47 cost time: 6.85378098487854
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0017568  Vali Loss: 0.0022478 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002279 --> 0.002248).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 48 cost time: 6.888378620147705
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0019928  Vali Loss: 0.0022766 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 49 cost time: 6.858250617980957
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0015407  Vali Loss: 0.0022147 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002248 --> 0.002215).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 6.886017084121704
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0016795  Vali Loss: 0.0021560 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002215 --> 0.002156).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 6.857617139816284
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0020101  Vali Loss: 0.0021875 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 52 cost time: 6.879936933517456
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0018637  Vali Loss: 0.0021378 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002156 --> 0.002138).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 53 cost time: 6.865833044052124
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0018920  Vali Loss: 0.0020774 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002138 --> 0.002077).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 54 cost time: 6.878676176071167
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0017052  Vali Loss: 0.0020143 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002077 --> 0.002014).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 55 cost time: 6.858517169952393
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0017562  Vali Loss: 0.0020080 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002014 --> 0.002008).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 56 cost time: 6.884315013885498
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0019517  Vali Loss: 0.0020046 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002008 --> 0.002005).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 57 cost time: 6.862606763839722
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0019295  Vali Loss: 0.0019723 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002005 --> 0.001972).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 58 cost time: 6.889696836471558
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0015946  Vali Loss: 0.0019455 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001972 --> 0.001946).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 59 cost time: 6.863178491592407
Fine Tuning VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0021795  Vali Loss: 0.0020736 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 60 cost time: 6.882997035980225
Fine Tuning VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0024780  Vali Loss: 0.0019378 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001946 --> 0.001938).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 61 cost time: 6.858306884765625
Fine Tuning VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0016496  Vali Loss: 0.0019521 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 62 cost time: 6.8785364627838135
Fine Tuning VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0019745  Vali Loss: 0.0019324 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001938 --> 0.001932).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 63 cost time: 6.854225397109985
Fine Tuning VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0014178  Vali Loss: 0.0019287 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001932 --> 0.001929).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 64 cost time: 6.881265878677368
Fine Tuning VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0015995  Vali Loss: 0.0018952 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001929 --> 0.001895).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 65 cost time: 7.897489309310913
Fine Tuning VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0016935  Vali Loss: 0.0018704 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001895 --> 0.001870).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 66 cost time: 6.888363599777222
Fine Tuning VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0017336  Vali Loss: 0.0021352 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 67 cost time: 6.858848810195923
Fine Tuning VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0016088  Vali Loss: 0.0021693 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 68 cost time: 6.8904869556427
Fine Tuning VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0015920  Vali Loss: 0.0021721 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 69 cost time: 6.855369567871094
Fine Tuning VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0018290  Vali Loss: 0.0021613 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 70 cost time: 6.884896278381348
Fine Tuning VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0017017  Vali Loss: 0.0021719 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 71 cost time: 6.8583574295043945
Fine Tuning VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0016880  Vali Loss: 0.0021763 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 72 cost time: 6.877923250198364
Fine Tuning VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0016629  Vali Loss: 0.0021747 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 73 cost time: 6.857223033905029
Fine Tuning VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0016049  Vali Loss: 0.0021804 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 74 cost time: 6.881607294082642
Fine Tuning VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0014120  Vali Loss: 0.0021796 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 75 cost time: 6.8596436977386475
Fine Tuning VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0014532  Vali Loss: 0.0021804 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 76 cost time: 6.895311594009399
Fine Tuning VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0016758  Vali Loss: 0.0021795 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 77 cost time: 6.861910820007324
Fine Tuning VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0017704  Vali Loss: 0.0021788 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 78 cost time: 6.893530607223511
Fine Tuning VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0016592  Vali Loss: 0.0021775 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 79 cost time: 6.85660457611084
Fine Tuning VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0014078  Vali Loss: 0.0021772 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 80 cost time: 6.885452032089233
Fine Tuning VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0015835  Vali Loss: 0.0021775 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7912281  Test weighted F1: 0.7327164  Test macro F1 0.7327164 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.393289804458618
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8399662  Vali Loss: 0.6329515 Vali Accuracy: 0.8984962  Vali weighted F1: 0.8941559  Vali macro F1 0.8920311 
Validation loss decreased (inf --> 0.632951).  Saving model ...
Epoch: 2 cost time: 5.294229507446289
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4171966  Vali Loss: 0.2382586 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9662710  Vali macro F1 0.9662173 
new best score!!!!
Validation loss decreased (0.632951 --> 0.238259).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.288716554641724
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1895897  Vali Loss: 0.1236725 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823819  Vali macro F1 0.9823284 
new best score!!!!
Validation loss decreased (0.238259 --> 0.123672).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.2942633628845215
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1055512  Vali Loss: 0.0756750 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887586  Vali macro F1 0.9890665 
new best score!!!!
Validation loss decreased (0.123672 --> 0.075675).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.289951324462891
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0717137  Vali Loss: 0.0593940 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9889239  Vali macro F1 0.9891678 
new best score!!!!
Validation loss decreased (0.075675 --> 0.059394).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.299071311950684
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0533847  Vali Loss: 0.0404988 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9927128 
new best score!!!!
Validation loss decreased (0.059394 --> 0.040499).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.301664113998413
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0416909  Vali Loss: 0.0337821 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9927128 
new best score!!!!
Validation loss decreased (0.040499 --> 0.033782).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.301926851272583
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0407248  Vali Loss: 0.0325431 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912786  Vali macro F1 0.9915934 
new best score!!!!
Validation loss decreased (0.033782 --> 0.032543).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.299054384231567
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0309017  Vali Loss: 0.0450839 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912869  Vali macro F1 0.9913636 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.300073862075806
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0343184  Vali Loss: 0.0226068 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
new best score!!!!
Validation loss decreased (0.032543 --> 0.022607).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.299544334411621
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0264203  Vali Loss: 0.0244444 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925121  Vali macro F1 0.9927467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.367146253585815
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0194816  Vali Loss: 0.0205408 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925121  Vali macro F1 0.9927467 
new best score!!!!
Validation loss decreased (0.022607 --> 0.020541).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.29891562461853
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0216374  Vali Loss: 0.0245890 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924541  Vali macro F1 0.9925170 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.301861763000488
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0220560  Vali Loss: 0.0160597 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
new best score!!!!
Validation loss decreased (0.020541 --> 0.016060).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.297054767608643
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0179113  Vali Loss: 0.0181977 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.294070482254028
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0217253  Vali Loss: 0.0168256 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.298950433731079
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0171678  Vali Loss: 0.0273435 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887096  Vali macro F1 0.9888327 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 5.299189329147339
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0160738  Vali Loss: 0.0148470 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937156  Vali macro F1 0.9937531 
new best score!!!!
Validation loss decreased (0.016060 --> 0.014847).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.297638893127441
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0249878  Vali Loss: 0.0177036 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937427  Vali macro F1 0.9936100 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.29517388343811
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0244671  Vali Loss: 0.0147489 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937346  Vali macro F1 0.9939526 
new best score!!!!
Validation loss decreased (0.014847 --> 0.014749).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.291955232620239
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0137652  Vali Loss: 0.0092094 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.014749 --> 0.009209).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.294864177703857
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0103503  Vali Loss: 0.0080368 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.009209 --> 0.008037).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.291414737701416
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0153078  Vali Loss: 0.0211588 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901136  Vali macro F1 0.9903012 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.294928073883057
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0118719  Vali Loss: 0.0088103 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.295856475830078
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0121895  Vali Loss: 0.0344443 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860199  Vali macro F1 0.9860555 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.295698404312134
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0145724  Vali Loss: 0.0117200 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9950627 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.294276475906372
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0083755  Vali Loss: 0.0090006 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 5.288166761398315
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0087006  Vali Loss: 0.0085060 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.291090488433838
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0070192  Vali Loss: 0.0081988 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.293071746826172
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0072545  Vali Loss: 0.0091183 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.291672468185425
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0070501  Vali Loss: 0.0071608 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.008037 --> 0.007161).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.289740562438965
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0109582  Vali Loss: 0.0073136 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.286214590072632
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0064932  Vali Loss: 0.0057741 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007161 --> 0.005774).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.293887376785278
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0060359  Vali Loss: 0.0054771 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.005774 --> 0.005477).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.288264751434326
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0057105  Vali Loss: 0.0076031 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.290364027023315
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0054359  Vali Loss: 0.0065147 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.289717197418213
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0052219  Vali Loss: 0.0056323 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 5.291114091873169
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0053573  Vali Loss: 0.0069016 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 5.291207551956177
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0054734  Vali Loss: 0.0089691 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 7.1023712158203125
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0051846  Vali Loss: 0.0088484 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.31925630569458
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0052530  Vali Loss: 0.0083972 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.293183326721191
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0052070  Vali Loss: 0.0078925 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.294975757598877
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0047657  Vali Loss: 0.0077541 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.2871994972229
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0047741  Vali Loss: 0.0074548 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 5.2897961139678955
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0049692  Vali Loss: 0.0074484 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.2912702560424805
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0069214  Vali Loss: 0.0074592 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.291750431060791
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0051560  Vali Loss: 0.0073341 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.289982080459595
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0047466  Vali Loss: 0.0072811 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.289788722991943
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0049595  Vali Loss: 0.0072807 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8026316  Test weighted F1: 0.7588538  Test macro F1 0.7588538 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.96387791633606
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0057978  Vali Loss: 0.0061572 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
Validation loss decreased (inf --> 0.006157).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.900324583053589
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0053897  Vali Loss: 0.0036281 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006157 --> 0.003628).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.895563364028931
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0041118  Vali Loss: 0.0043412 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987502  Vali macro F1 0.9986587 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.9100024700164795
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0043472  Vali Loss: 0.0057446 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.9031007289886475
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0047877  Vali Loss: 0.0043953 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.887162446975708
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0037928  Vali Loss: 0.0047911 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.898508787155151
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0037951  Vali Loss: 0.0027813 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003628 --> 0.002781).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.901339769363403
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0033195  Vali Loss: 0.0031527 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.905821323394775
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031332  Vali Loss: 0.0035694 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987502  Vali macro F1 0.9986587 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.898085832595825
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0045727  Vali Loss: 0.0034930 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.895514726638794
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0043016  Vali Loss: 0.0047503 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974965  Vali macro F1 0.9974039 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.90245246887207
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0033995  Vali Loss: 0.0031430 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.905602693557739
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0032479  Vali Loss: 0.0068411 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937191  Vali macro F1 0.9937105 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.90464448928833
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0033523  Vali Loss: 0.0037596 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987502  Vali macro F1 0.9986587 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.893639326095581
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0028820  Vali Loss: 0.0037959 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987502  Vali macro F1 0.9986587 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.90299391746521
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0027958  Vali Loss: 0.0034322 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987502  Vali macro F1 0.9986587 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.895136117935181
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0028004  Vali Loss: 0.0041481 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974853  Vali macro F1 0.9974821 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.892530679702759
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0028971  Vali Loss: 0.0034810 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9988343 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.900580883026123
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0024010  Vali Loss: 0.0031981 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9988343 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.899670124053955
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0027474  Vali Loss: 0.0028429 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9988343 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.883443593978882
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0022568  Vali Loss: 0.0026507 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9988343 
new best score!!!!
Validation loss decreased (0.002781 --> 0.002651).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.883316516876221
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024968  Vali Loss: 0.0025916 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9988343 
new best score!!!!
Validation loss decreased (0.002651 --> 0.002592).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.888169050216675
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0020799  Vali Loss: 0.0024194 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002592 --> 0.002419).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.90953803062439
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0022714  Vali Loss: 0.0023857 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002419 --> 0.002386).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.893808126449585
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0023792  Vali Loss: 0.0022052 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002386 --> 0.002205).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.8976781368255615
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0022788  Vali Loss: 0.0021375 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002205 --> 0.002138).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.893697261810303
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0020007  Vali Loss: 0.0020924 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002138 --> 0.002092).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 6.892870903015137
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0027070  Vali Loss: 0.0020390 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002092 --> 0.002039).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.886200189590454
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0023646  Vali Loss: 0.0019917 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002039 --> 0.001992).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 6.902150630950928
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0019708  Vali Loss: 0.0020643 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.888803005218506
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0025238  Vali Loss: 0.0020807 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.898632049560547
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0019103  Vali Loss: 0.0020869 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.898212432861328
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0022712  Vali Loss: 0.0020733 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.897520542144775
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0021804  Vali Loss: 0.0020366 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 35 cost time: 6.901925802230835
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0019552  Vali Loss: 0.0020517 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 6.890416860580444
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0020353  Vali Loss: 0.0020620 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 6.88677453994751
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0019690  Vali Loss: 0.0020565 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 6.896439552307129
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0021330  Vali Loss: 0.0020578 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 6.898916959762573
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0020668  Vali Loss: 0.0020627 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 40 cost time: 6.892673015594482
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0025428  Vali Loss: 0.0020589 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 6.891589641571045
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0019452  Vali Loss: 0.0020565 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 6.886541843414307
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0020874  Vali Loss: 0.0020557 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 6.886718034744263
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0023176  Vali Loss: 0.0020559 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 6.900454521179199
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0022009  Vali Loss: 0.0020554 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8026316  Test weighted F1: 0.7593568  Test macro F1 0.7593568 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.368997812271118
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8509909  Vali Loss: 0.6442570 Vali Accuracy: 0.9072682  Vali weighted F1: 0.8980858  Vali macro F1 0.8966510 
Validation loss decreased (inf --> 0.644257).  Saving model ...
Epoch: 2 cost time: 5.299734354019165
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4269743  Vali Loss: 0.2263595 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9689092  Vali macro F1 0.9692982 
new best score!!!!
Validation loss decreased (0.644257 --> 0.226360).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.303600311279297
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1835939  Vali Loss: 0.1289394 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810724  Vali macro F1 0.9811119 
new best score!!!!
Validation loss decreased (0.226360 --> 0.128939).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.308665990829468
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1172341  Vali Loss: 0.0787401 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9819584  Vali macro F1 0.9818068 
new best score!!!!
Validation loss decreased (0.128939 --> 0.078740).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.311933279037476
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0822599  Vali Loss: 0.0592966 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9856964  Vali macro F1 0.9856445 
new best score!!!!
Validation loss decreased (0.078740 --> 0.059297).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.31174898147583
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0559002  Vali Loss: 0.0454936 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9846332  Vali macro F1 0.9847723 
new best score!!!!
Validation loss decreased (0.059297 --> 0.045494).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.317223072052002
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0435052  Vali Loss: 0.0343574 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884595  Vali macro F1 0.9885003 
new best score!!!!
Validation loss decreased (0.045494 --> 0.034357).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.309096574783325
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0374820  Vali Loss: 0.0366009 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874480  Vali macro F1 0.9873661 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.312445163726807
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0302628  Vali Loss: 0.0221985 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
new best score!!!!
Validation loss decreased (0.034357 --> 0.022198).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.3154332637786865
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0279418  Vali Loss: 0.0269938 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911488  Vali macro F1 0.9911262 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.31378436088562
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0247748  Vali Loss: 0.0167978 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.022198 --> 0.016798).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.313901901245117
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0248936  Vali Loss: 0.0181830 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.305513858795166
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0210904  Vali Loss: 0.0181703 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962411  Vali macro F1 0.9961467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.311919927597046
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0204259  Vali Loss: 0.0377940 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860013  Vali macro F1 0.9858663 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.308349132537842
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0227887  Vali Loss: 0.0225963 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899745  Vali macro F1 0.9898755 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 16 cost time: 5.307919025421143
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0204703  Vali Loss: 0.0131026 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.016798 --> 0.013103).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.315560340881348
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0139019  Vali Loss: 0.0169720 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.313290357589722
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0183076  Vali Loss: 0.0280971 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822817  Vali macro F1 0.9823388 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.313583135604858
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0328216  Vali Loss: 0.0220861 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899749  Vali macro F1 0.9899749 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.303302049636841
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0178201  Vali Loss: 0.0111083 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.013103 --> 0.011108).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.305299997329712
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0145762  Vali Loss: 0.0128427 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.3028950691223145
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0120393  Vali Loss: 0.0123432 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937317  Vali macro F1 0.9937334 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.305210590362549
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0100848  Vali Loss: 0.0087264 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.011108 --> 0.008726).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.302149057388306
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0094324  Vali Loss: 0.0221122 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924727  Vali macro F1 0.9924769 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.300004720687866
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0156810  Vali Loss: 0.0130937 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.304088354110718
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0114924  Vali Loss: 0.0097786 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.304940462112427
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0085869  Vali Loss: 0.0047882 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008726 --> 0.004788).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.305928468704224
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0089794  Vali Loss: 0.0081429 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.305257081985474
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0090211  Vali Loss: 0.0107317 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949818  Vali macro F1 0.9949846 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.305021286010742
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0137338  Vali Loss: 0.0224037 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898863  Vali macro F1 0.9899539 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.305129051208496
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0190006  Vali Loss: 0.0110781 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962399  Vali macro F1 0.9962245 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.3032145500183105
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0137253  Vali Loss: 0.0270817 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886086  Vali macro F1 0.9885672 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 5.305750370025635
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0267632  Vali Loss: 0.0089684 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962399  Vali macro F1 0.9962245 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.303970575332642
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0112365  Vali Loss: 0.0061703 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.307015419006348
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0074295  Vali Loss: 0.0056278 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.308593511581421
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0062627  Vali Loss: 0.0052630 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.306129455566406
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0059510  Vali Loss: 0.0050292 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 5.304613351821899
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0055694  Vali Loss: 0.0050170 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.301861524581909
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0056192  Vali Loss: 0.0050011 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.3066112995147705
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0057833  Vali Loss: 0.0049733 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.303951025009155
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0054144  Vali Loss: 0.0049440 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.304777383804321
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0057570  Vali Loss: 0.0049818 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987490  Vali macro F1 0.9987364 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9666667  Test weighted F1: 0.9654674  Test macro F1 0.9654674 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.877302646636963
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0074071  Vali Loss: 0.0058515 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
Validation loss decreased (inf --> 0.005852).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.877127647399902
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0060866  Vali Loss: 0.0047230 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005852 --> 0.004723).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.876001358032227
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0060950  Vali Loss: 0.0038841 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004723 --> 0.003884).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.876642227172852
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0053646  Vali Loss: 0.0027796 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003884 --> 0.002780).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.875483989715576
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0051210  Vali Loss: 0.0041406 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.8785459995269775
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0053372  Vali Loss: 0.0042487 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.877762317657471
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0052327  Vali Loss: 0.0028632 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.881178140640259
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0041233  Vali Loss: 0.0027274 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002780 --> 0.002727).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.878295183181763
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0040857  Vali Loss: 0.0066802 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.879610776901245
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0048277  Vali Loss: 0.0023963 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002727 --> 0.002396).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.876236438751221
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0040108  Vali Loss: 0.0059704 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.874685287475586
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0046888  Vali Loss: 0.0056209 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.871700048446655
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0038964  Vali Loss: 0.0043880 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.873678207397461
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0035289  Vali Loss: 0.0061677 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.869292736053467
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0033429  Vali Loss: 0.0038741 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 6.857564687728882
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0030744  Vali Loss: 0.0037661 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.854325294494629
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0026723  Vali Loss: 0.0055595 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.856547117233276
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0027912  Vali Loss: 0.0017859 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002396 --> 0.001786).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.8504838943481445
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0028701  Vali Loss: 0.0065422 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.853193998336792
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0030558  Vali Loss: 0.0058148 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.85892128944397
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0028865  Vali Loss: 0.0064239 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.855487823486328
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0030650  Vali Loss: 0.0062371 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.854422330856323
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0030307  Vali Loss: 0.0061243 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.85737419128418
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0032552  Vali Loss: 0.0073545 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.864182472229004
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0023707  Vali Loss: 0.0074799 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.861318111419678
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025341  Vali Loss: 0.0074986 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.872320652008057
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0022006  Vali Loss: 0.0073883 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.871499061584473
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0023170  Vali Loss: 0.0069617 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 6.873123407363892
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0023517  Vali Loss: 0.0069355 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.876364707946777
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0021567  Vali Loss: 0.0069483 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.884112119674683
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0024257  Vali Loss: 0.0069843 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.877758264541626
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0021976  Vali Loss: 0.0069989 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.876616954803467
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0024090  Vali Loss: 0.0069641 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9622807  Test weighted F1: 0.9614533  Test macro F1 0.9614533 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.3864946365356445
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8473933  Vali Loss: 0.6532619 Vali Accuracy: 0.8897243  Vali weighted F1: 0.8822852  Vali macro F1 0.8775180 
Validation loss decreased (inf --> 0.653262).  Saving model ...
Epoch: 2 cost time: 5.286179542541504
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4335131  Vali Loss: 0.2442662 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9647644  Vali macro F1 0.9634380 
new best score!!!!
Validation loss decreased (0.653262 --> 0.244266).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.294034004211426
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1857510  Vali Loss: 0.1211841 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874915  Vali macro F1 0.9877949 
new best score!!!!
Validation loss decreased (0.244266 --> 0.121184).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.288515090942383
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1094024  Vali Loss: 0.0736390 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886703  Vali macro F1 0.9887192 
new best score!!!!
Validation loss decreased (0.121184 --> 0.073639).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.288348913192749
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0722758  Vali Loss: 0.0531252 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912319  Vali macro F1 0.9915027 
new best score!!!!
Validation loss decreased (0.073639 --> 0.053125).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.285784959793091
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0557212  Vali Loss: 0.0441120 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887176  Vali macro F1 0.9891755 
new best score!!!!
Validation loss decreased (0.053125 --> 0.044112).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.2880613803863525
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0448752  Vali Loss: 0.0310232 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.044112 --> 0.031023).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.2880964279174805
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0406009  Vali Loss: 0.0441534 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862848  Vali macro F1 0.9866065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.287557601928711
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0360366  Vali Loss: 0.0497773 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9838829  Vali macro F1 0.9840033 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 10 cost time: 5.291263580322266
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0403416  Vali Loss: 0.0362615 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900118  Vali macro F1 0.9901381 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 11 cost time: 5.288006544113159
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0291165  Vali Loss: 0.0220280 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937163  Vali macro F1 0.9938252 
new best score!!!!
Validation loss decreased (0.031023 --> 0.022028).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.285452842712402
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0241653  Vali Loss: 0.0184545 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.022028 --> 0.018454).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.289134979248047
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0194320  Vali Loss: 0.0233386 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899661  Vali macro F1 0.9898332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.286820650100708
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0169499  Vali Loss: 0.0169386 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.018454 --> 0.016939).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.288516521453857
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0164533  Vali Loss: 0.0155121 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937242  Vali macro F1 0.9936223 
new best score!!!!
Validation loss decreased (0.016939 --> 0.015512).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.28268837928772
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0142615  Vali Loss: 0.0121358 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924822  Vali macro F1 0.9923354 
new best score!!!!
Validation loss decreased (0.015512 --> 0.012136).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.277627229690552
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0130632  Vali Loss: 0.0208109 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937645  Vali macro F1 0.9937013 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.277885437011719
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0129994  Vali Loss: 0.0175567 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912680  Vali macro F1 0.9913287 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.276874780654907
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0206108  Vali Loss: 0.0299414 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888514  Vali macro F1 0.9888710 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.276878356933594
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0209930  Vali Loss: 0.0189058 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912475  Vali macro F1 0.9908500 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 5.282804250717163
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0125053  Vali Loss: 0.0115673 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
new best score!!!!
Validation loss decreased (0.012136 --> 0.011567).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.280860662460327
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0120277  Vali Loss: 0.0126214 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962326  Vali macro F1 0.9962272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.2788872718811035
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0101976  Vali Loss: 0.0131722 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949995  Vali macro F1 0.9948584 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.282871961593628
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0086984  Vali Loss: 0.0133406 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937191  Vali macro F1 0.9937174 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.2805867195129395
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0085812  Vali Loss: 0.0091168 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
new best score!!!!
Validation loss decreased (0.011567 --> 0.009117).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.283518314361572
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0082825  Vali Loss: 0.0094267 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949819  Vali macro F1 0.9948825 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.281491041183472
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0134184  Vali Loss: 0.0123681 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937222  Vali macro F1 0.9939506 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.279622316360474
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0111784  Vali Loss: 0.0204713 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900106  Vali macro F1 0.9901119 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.280511379241943
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0078983  Vali Loss: 0.0141302 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924731  Vali macro F1 0.9923781 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.283556938171387
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0092444  Vali Loss: 0.0146182 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950298  Vali macro F1 0.9948151 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 5.282781362533569
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0091216  Vali Loss: 0.0122143 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.284409523010254
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0098190  Vali Loss: 0.0122509 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.280442476272583
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0067298  Vali Loss: 0.0109942 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962531  Vali macro F1 0.9960381 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.283763647079468
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0064670  Vali Loss: 0.0118361 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.284178256988525
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0059599  Vali Loss: 0.0118990 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 36 cost time: 5.285248279571533
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0056397  Vali Loss: 0.0118677 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.281586408615112
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0056640  Vali Loss: 0.0118154 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.2817702293396
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0057333  Vali Loss: 0.0117652 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.2806806564331055
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0056368  Vali Loss: 0.0118175 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 5.280921936035156
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0056183  Vali Loss: 0.0117816 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949986  Vali macro F1 0.9947818 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9368421  Test weighted F1: 0.9190742  Test macro F1 0.9190742 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.9097700119018555
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0070775  Vali Loss: 0.0088149 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949995  Vali macro F1 0.9948584 
Validation loss decreased (inf --> 0.008815).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.917694330215454
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0064723  Vali Loss: 0.0080727 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
new best score!!!!
Validation loss decreased (0.008815 --> 0.008073).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.913930416107178
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0059342  Vali Loss: 0.0074553 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
new best score!!!!
Validation loss decreased (0.008073 --> 0.007455).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.9206013679504395
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0044919  Vali Loss: 0.0080282 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.9112770557403564
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0046260  Vali Loss: 0.0078226 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.917217254638672
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0050845  Vali Loss: 0.0070962 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
new best score!!!!
Validation loss decreased (0.007455 --> 0.007096).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.920802354812622
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0047434  Vali Loss: 0.0082290 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.91127872467041
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0047230  Vali Loss: 0.0102882 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949995  Vali macro F1 0.9948584 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.923654556274414
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0034409  Vali Loss: 0.0074830 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.9159321784973145
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0050674  Vali Loss: 0.0081110 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.9210288524627686
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0046627  Vali Loss: 0.0108000 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949995  Vali macro F1 0.9948584 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.928486585617065
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0054819  Vali Loss: 0.0059394 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974910  Vali macro F1 0.9972759 
new best score!!!!
Validation loss decreased (0.007096 --> 0.005939).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.919493675231934
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0036075  Vali Loss: 0.0053038 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
new best score!!!!
Validation loss decreased (0.005939 --> 0.005304).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.915059804916382
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0034300  Vali Loss: 0.0064057 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974910  Vali macro F1 0.9972759 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.9186060428619385
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0030906  Vali Loss: 0.0047778 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987445  Vali macro F1 0.9985305 
new best score!!!!
Validation loss decreased (0.005304 --> 0.004778).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.918581485748291
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0029526  Vali Loss: 0.0051098 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962540  Vali macro F1 0.9961147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.912677049636841
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022519  Vali Loss: 0.0056000 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962540  Vali macro F1 0.9961147 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.9118616580963135
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0028090  Vali Loss: 0.0047306 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975072  Vali macro F1 0.9973689 
new best score!!!!
Validation loss decreased (0.004778 --> 0.004731).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.91514778137207
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0032767  Vali Loss: 0.0118584 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950307  Vali macro F1 0.9948917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.922798156738281
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0036376  Vali Loss: 0.0074507 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.918549060821533
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0030889  Vali Loss: 0.0062886 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.9134132862091064
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0042447  Vali Loss: 0.0089766 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949995  Vali macro F1 0.9948584 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.9252026081085205
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0036243  Vali Loss: 0.0054029 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962533  Vali macro F1 0.9960382 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.9201648235321045
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0041987  Vali Loss: 0.0061172 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974910  Vali macro F1 0.9972759 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.913913249969482
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0025493  Vali Loss: 0.0062224 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.917827844619751
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0024634  Vali Loss: 0.0060510 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.917331695556641
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0022570  Vali Loss: 0.0058578 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.910968542098999
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0024307  Vali Loss: 0.0058012 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 6.910635471343994
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0026510  Vali Loss: 0.0058017 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.920870065689087
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0024298  Vali Loss: 0.0058688 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.914982318878174
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0025470  Vali Loss: 0.0058214 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.914705038070679
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0022679  Vali Loss: 0.0057902 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.9158241748809814
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0026422  Vali Loss: 0.0057513 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962359  Vali macro F1 0.9960191 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9342105  Test weighted F1: 0.9183540  Test macro F1 0.9183540 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.358433485031128
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8599286  Vali Loss: 0.6511066 Vali Accuracy: 0.9110276  Vali weighted F1: 0.8984055  Vali macro F1 0.8967818 
Validation loss decreased (inf --> 0.651107).  Saving model ...
Epoch: 2 cost time: 5.283109188079834
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4115682  Vali Loss: 0.2297381 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9670489  Vali macro F1 0.9665592 
new best score!!!!
Validation loss decreased (0.651107 --> 0.229738).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.281297206878662
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1761369  Vali Loss: 0.1076575 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9796522  Vali macro F1 0.9797283 
new best score!!!!
Validation loss decreased (0.229738 --> 0.107657).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.285836458206177
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1035801  Vali Loss: 0.0856752 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9857170  Vali macro F1 0.9854495 
new best score!!!!
Validation loss decreased (0.107657 --> 0.085675).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.289169073104858
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0681079  Vali Loss: 0.0541225 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860058  Vali macro F1 0.9863289 
new best score!!!!
Validation loss decreased (0.085675 --> 0.054122).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.286662578582764
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0469527  Vali Loss: 0.0393570 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912441  Vali macro F1 0.9913911 
new best score!!!!
Validation loss decreased (0.054122 --> 0.039357).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.287429332733154
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0376547  Vali Loss: 0.0323929 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9949618 
new best score!!!!
Validation loss decreased (0.039357 --> 0.032393).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.291221857070923
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0307700  Vali Loss: 0.0240554 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962383  Vali macro F1 0.9963541 
new best score!!!!
Validation loss decreased (0.032393 --> 0.024055).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.289861440658569
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0232991  Vali Loss: 0.0213047 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924604  Vali macro F1 0.9926456 
new best score!!!!
Validation loss decreased (0.024055 --> 0.021305).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.288614273071289
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0198789  Vali Loss: 0.0268954 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.288419723510742
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0209209  Vali Loss: 0.0282387 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911820  Vali macro F1 0.9912402 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 5.291118860244751
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0201736  Vali Loss: 0.0181419 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949624  Vali macro F1 0.9951476 
new best score!!!!
Validation loss decreased (0.021305 --> 0.018142).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.2917258739471436
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0158080  Vali Loss: 0.0188624 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924296  Vali macro F1 0.9924124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.293099403381348
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0156451  Vali Loss: 0.0217888 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924668  Vali macro F1 0.9927662 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.289170742034912
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0159347  Vali Loss: 0.0258454 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899629  Vali macro F1 0.9901603 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 5.287605047225952
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0135474  Vali Loss: 0.0146891 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911486  Vali macro F1 0.9911655 
new best score!!!!
Validation loss decreased (0.018142 --> 0.014689).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.287180662155151
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0127026  Vali Loss: 0.0150506 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937205  Vali macro F1 0.9936204 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.288010597229004
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0121418  Vali Loss: 0.0077156 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014689 --> 0.007716).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.286348581314087
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0101274  Vali Loss: 0.0087936 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.283313274383545
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0082394  Vali Loss: 0.0080688 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.289794921875
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0075606  Vali Loss: 0.0610760 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9735700  Vali macro F1 0.9745419 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 5.288088798522949
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0137779  Vali Loss: 0.0080776 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 5.2824928760528564
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0092700  Vali Loss: 0.0142209 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949827  Vali macro F1 0.9951268 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 24 cost time: 5.283475637435913
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0075193  Vali Loss: 0.0082846 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.282198190689087
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0056669  Vali Loss: 0.0060048 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.007716 --> 0.006005).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.283938407897949
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0051209  Vali Loss: 0.0074773 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962390  Vali macro F1 0.9962401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.284766912460327
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0046703  Vali Loss: 0.0051643 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.006005 --> 0.005164).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.283844947814941
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0036229  Vali Loss: 0.0047980 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.005164 --> 0.004798).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.285543203353882
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0040685  Vali Loss: 0.0043835 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.004798 --> 0.004383).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.284900188446045
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0033715  Vali Loss: 0.0043875 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.284672975540161
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0030853  Vali Loss: 0.0041040 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.004383 --> 0.004104).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.2845070362091064
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0031704  Vali Loss: 0.0040831 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.004104 --> 0.004083).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.282040596008301
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0028472  Vali Loss: 0.0042586 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.282433271408081
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0029025  Vali Loss: 0.0038650 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.004083 --> 0.003865).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.283786296844482
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0027593  Vali Loss: 0.0038142 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.003865 --> 0.003814).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.285752058029175
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0026417  Vali Loss: 0.0038302 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.285109281539917
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0025889  Vali Loss: 0.0036634 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.003814 --> 0.003663).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.286059617996216
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0028683  Vali Loss: 0.0037294 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.287835597991943
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0024249  Vali Loss: 0.0042668 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974875  Vali macro F1 0.9976316 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.288662672042847
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0034340  Vali Loss: 0.0066274 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962015  Vali macro F1 0.9963437 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.2827887535095215
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0030658  Vali Loss: 0.0040560 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.282938003540039
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0035097  Vali Loss: 0.0044285 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 5.283695459365845
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0031664  Vali Loss: 0.0042069 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.282437086105347
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0025829  Vali Loss: 0.0040413 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 5.280412673950195
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0028089  Vali Loss: 0.0040892 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 5.280632734298706
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0025486  Vali Loss: 0.0039933 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 5.283650875091553
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0026620  Vali Loss: 0.0038810 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 48 cost time: 5.281374454498291
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0024859  Vali Loss: 0.0038781 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.279856443405151
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0029068  Vali Loss: 0.0038712 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.283170700073242
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0025677  Vali Loss: 0.0038675 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.281634569168091
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0024958  Vali Loss: 0.0038660 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 5.277676105499268
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0025785  Vali Loss: 0.0038662 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8552632  Test weighted F1: 0.8314623  Test macro F1 0.8314623 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.878796815872192
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0028340  Vali Loss: 0.0035850 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974875  Vali macro F1 0.9976316 
Validation loss decreased (inf --> 0.003585).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.871916770935059
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0025711  Vali Loss: 0.0061102 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962015  Vali macro F1 0.9963437 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.871797561645508
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0022154  Vali Loss: 0.0028999 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003585 --> 0.002900).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.874484539031982
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0026532  Vali Loss: 0.0035279 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974875  Vali macro F1 0.9976316 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.8802196979522705
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0016776  Vali Loss: 0.0028441 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.002900 --> 0.002844).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.880627632141113
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0014873  Vali Loss: 0.0029285 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974875  Vali macro F1 0.9976316 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.879651308059692
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0020032  Vali Loss: 0.0023600 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002844 --> 0.002360).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.874217748641968
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0011833  Vali Loss: 0.0024231 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.872317790985107
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0010355  Vali Loss: 0.0029685 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974875  Vali macro F1 0.9976316 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.872140645980835
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0012760  Vali Loss: 0.0025128 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.870542764663696
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0008965  Vali Loss: 0.0026232 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.879236221313477
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0008700  Vali Loss: 0.0020526 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002360 --> 0.002053).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.8817458152771
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0019371  Vali Loss: 0.0045502 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974927  Vali macro F1 0.9975655 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.872228384017944
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0014182  Vali Loss: 0.0018437 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.002053 --> 0.001844).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.87426233291626
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0008098  Vali Loss: 0.0025811 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.879934310913086
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0007095  Vali Loss: 0.0020937 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.875746011734009
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0006184  Vali Loss: 0.0030713 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.8777899742126465
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0005846  Vali Loss: 0.0022097 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.873120546340942
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0005576  Vali Loss: 0.0014464 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.001844 --> 0.001446).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.881733417510986
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0005295  Vali Loss: 0.0017972 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.880763292312622
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0005017  Vali Loss: 0.0007297 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001446 --> 0.000730).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.878000020980835
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0004408  Vali Loss: 0.0010055 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.877014398574829
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0004235  Vali Loss: 0.0014182 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.87650203704834
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0004002  Vali Loss: 0.0016854 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.884220600128174
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0003741  Vali Loss: 0.0013096 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.881679534912109
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0004193  Vali Loss: 0.0019210 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 27 cost time: 6.879689693450928
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0003543  Vali Loss: 0.0015173 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.879929780960083
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0003271  Vali Loss: 0.0018515 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.872109413146973
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0002996  Vali Loss: 0.0015526 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.8741724491119385
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0019818  Vali Loss: 0.0167732 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924466  Vali macro F1 0.9925900 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.871835708618164
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0054220  Vali Loss: 0.0109243 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 32 cost time: 6.876223564147949
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0037739  Vali Loss: 0.0068258 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.876676559448242
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0009683  Vali Loss: 0.0052712 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.875378608703613
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0012822  Vali Loss: 0.0038740 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.8853466510772705
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0012770  Vali Loss: 0.0030769 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.870113134384155
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0008243  Vali Loss: 0.0032905 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8473684  Test weighted F1: 0.8217196  Test macro F1 0.8217196 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 913548
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.324779987335205
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8428616  Vali Loss: 0.6451828 Vali Accuracy: 0.9010025  Vali weighted F1: 0.9009656  Vali macro F1 0.9004648 
Validation loss decreased (inf --> 0.645183).  Saving model ...
Epoch: 2 cost time: 5.211137533187866
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4390196  Vali Loss: 0.2228415 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9666641  Vali macro F1 0.9653651 
new best score!!!!
Validation loss decreased (0.645183 --> 0.222842).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.221944332122803
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1958047  Vali Loss: 0.1218025 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9772389  Vali macro F1 0.9761701 
new best score!!!!
Validation loss decreased (0.222842 --> 0.121802).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.22261905670166
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1126888  Vali Loss: 0.0741647 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9820710  Vali macro F1 0.9811789 
new best score!!!!
Validation loss decreased (0.121802 --> 0.074165).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.231541872024536
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0739403  Vali Loss: 0.0506404 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886038  Vali macro F1 0.9880346 
new best score!!!!
Validation loss decreased (0.074165 --> 0.050640).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.22500467300415
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0537970  Vali Loss: 0.0425358 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886492  Vali macro F1 0.9879321 
new best score!!!!
Validation loss decreased (0.050640 --> 0.042536).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.237300395965576
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0467515  Vali Loss: 0.0363995 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873985  Vali macro F1 0.9863701 
new best score!!!!
Validation loss decreased (0.042536 --> 0.036399).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.239659547805786
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0384374  Vali Loss: 0.0309651 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
new best score!!!!
Validation loss decreased (0.036399 --> 0.030965).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.241028785705566
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0305366  Vali Loss: 0.0292191 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925082  Vali macro F1 0.9919905 
new best score!!!!
Validation loss decreased (0.030965 --> 0.029219).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.247554540634155
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0267079  Vali Loss: 0.0256909 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
new best score!!!!
Validation loss decreased (0.029219 --> 0.025691).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.417433738708496
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0256307  Vali Loss: 0.0254923 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912597  Vali macro F1 0.9906079 
new best score!!!!
Validation loss decreased (0.025691 --> 0.025492).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.260312557220459
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0245668  Vali Loss: 0.0217440 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925082  Vali macro F1 0.9919905 
new best score!!!!
Validation loss decreased (0.025492 --> 0.021744).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.251938581466675
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0187585  Vali Loss: 0.0281330 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925082  Vali macro F1 0.9919905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.25800895690918
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0171416  Vali Loss: 0.0194037 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
new best score!!!!
Validation loss decreased (0.021744 --> 0.019404).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.25810432434082
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0152031  Vali Loss: 0.0205184 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925082  Vali macro F1 0.9919905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.253037929534912
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0189986  Vali Loss: 0.0300788 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910973  Vali macro F1 0.9907109 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.261959075927734
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0372904  Vali Loss: 0.0280042 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899291  Vali macro F1 0.9891591 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 5.258443117141724
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0176091  Vali Loss: 0.0221802 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898626  Vali macro F1 0.9892944 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 19 cost time: 5.2588951587677
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0173263  Vali Loss: 0.0225491 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899277  Vali macro F1 0.9890464 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 20 cost time: 5.252369403839111
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0125702  Vali Loss: 0.0213617 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.253632068634033
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0105234  Vali Loss: 0.0227430 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.252887725830078
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0117273  Vali Loss: 0.0231493 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.254759073257446
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0116904  Vali Loss: 0.0239668 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912202  Vali macro F1 0.9905097 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.254191160202026
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0096466  Vali Loss: 0.0227254 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 25 cost time: 5.253720998764038
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0091602  Vali Loss: 0.0224811 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.256096601486206
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0090286  Vali Loss: 0.0221299 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.253754615783691
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0093813  Vali Loss: 0.0219085 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.253499984741211
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0088642  Vali Loss: 0.0216960 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.252195119857788
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0092346  Vali Loss: 0.0215918 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9035088  Test weighted F1: 0.8889852  Test macro F1 0.8889852 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.842728614807129
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0171691  Vali Loss: 0.0177880 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
Validation loss decreased (inf --> 0.017788).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.833013296127319
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0105746  Vali Loss: 0.0171500 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
new best score!!!!
Validation loss decreased (0.017788 --> 0.017150).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.835196495056152
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0102457  Vali Loss: 0.0166250 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
new best score!!!!
Validation loss decreased (0.017150 --> 0.016625).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.837168455123901
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0096317  Vali Loss: 0.0174315 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.833975791931152
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0085618  Vali Loss: 0.0178015 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.83855676651001
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0077660  Vali Loss: 0.0186194 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925082  Vali macro F1 0.9919905 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.839730262756348
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0077819  Vali Loss: 0.0169657 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.836589574813843
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0069956  Vali Loss: 0.0183052 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.836879730224609
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0068315  Vali Loss: 0.0224964 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925082  Vali macro F1 0.9919905 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.836796998977661
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0084324  Vali Loss: 0.0158000 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
new best score!!!!
Validation loss decreased (0.016625 --> 0.015800).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.83835506439209
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0068921  Vali Loss: 0.0171770 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925137  Vali macro F1 0.9919637 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.836153507232666
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0069462  Vali Loss: 0.0164923 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.84097695350647
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0057272  Vali Loss: 0.0172916 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.837612867355347
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0057276  Vali Loss: 0.0173157 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.848043203353882
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0052452  Vali Loss: 0.0147470 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937595  Vali macro F1 0.9932944 
new best score!!!!
Validation loss decreased (0.015800 --> 0.014747).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.840814113616943
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0056170  Vali Loss: 0.0153131 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.836291074752808
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0051030  Vali Loss: 0.0163991 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.8397462368011475
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0049572  Vali Loss: 0.0158198 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.835008382797241
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0048612  Vali Loss: 0.0168609 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.839303731918335
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0047118  Vali Loss: 0.0154378 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937595  Vali macro F1 0.9932944 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.841921091079712
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0044677  Vali Loss: 0.0155841 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.842474937438965
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0041321  Vali Loss: 0.0161099 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.844720125198364
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0038410  Vali Loss: 0.0162737 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.836727619171143
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0039038  Vali Loss: 0.0168060 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.837618827819824
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0038704  Vali Loss: 0.0170864 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.841214179992676
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0040819  Vali Loss: 0.0170924 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.840167760848999
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0042703  Vali Loss: 0.0170672 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.840620279312134
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0045594  Vali Loss: 0.0169204 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.841458797454834
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0038549  Vali Loss: 0.0169321 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.8408122062683105
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0036987  Vali Loss: 0.0169862 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8991228  Test weighted F1: 0.8848880  Test macro F1 0.8848880 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.3444225788116455
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8586398  Vali Loss: 0.6422249 Vali Accuracy: 0.9185464  Vali weighted F1: 0.9163447  Vali macro F1 0.9128684 
Validation loss decreased (inf --> 0.642225).  Saving model ...
Epoch: 2 cost time: 5.282644033432007
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4217612  Vali Loss: 0.2073707 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9629225  Vali macro F1 0.9617387 
new best score!!!!
Validation loss decreased (0.642225 --> 0.207371).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.286245584487915
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1837308  Vali Loss: 0.1096167 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810203  Vali macro F1 0.9799666 
new best score!!!!
Validation loss decreased (0.207371 --> 0.109617).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.29034423828125
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1070103  Vali Loss: 0.0682780 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9824410  Vali macro F1 0.9815328 
new best score!!!!
Validation loss decreased (0.109617 --> 0.068278).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.292949199676514
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0708268  Vali Loss: 0.0481573 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899225  Vali macro F1 0.9894365 
new best score!!!!
Validation loss decreased (0.068278 --> 0.048157).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.2945520877838135
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0505468  Vali Loss: 0.0395362 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912409  Vali macro F1 0.9906475 
new best score!!!!
Validation loss decreased (0.048157 --> 0.039536).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.290076732635498
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0384091  Vali Loss: 0.0307286 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
new best score!!!!
Validation loss decreased (0.039536 --> 0.030729).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.293002605438232
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0293267  Vali Loss: 0.0270105 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
new best score!!!!
Validation loss decreased (0.030729 --> 0.027010).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.29016637802124
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0303735  Vali Loss: 0.0259939 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912693  Vali macro F1 0.9906569 
new best score!!!!
Validation loss decreased (0.027010 --> 0.025994).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.295154094696045
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0267576  Vali Loss: 0.0254497 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900615  Vali macro F1 0.9895742 
new best score!!!!
Validation loss decreased (0.025994 --> 0.025450).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.2946693897247314
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0267161  Vali Loss: 0.0542161 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9789335  Vali macro F1 0.9770599 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.293179035186768
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0282476  Vali Loss: 0.0265758 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925082  Vali macro F1 0.9919905 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.294027328491211
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0186515  Vali Loss: 0.0224971 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912697  Vali macro F1 0.9906380 
new best score!!!!
Validation loss decreased (0.025450 --> 0.022497).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.295989036560059
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0167713  Vali Loss: 0.0221956 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913168  Vali macro F1 0.9908916 
new best score!!!!
Validation loss decreased (0.022497 --> 0.022196).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.292721748352051
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0128359  Vali Loss: 0.0201694 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900183  Vali macro F1 0.9892850 
new best score!!!!
Validation loss decreased (0.022196 --> 0.020169).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.292796850204468
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0107010  Vali Loss: 0.0206033 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.293408393859863
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0156078  Vali Loss: 0.0210079 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900738  Vali macro F1 0.9895670 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.289188385009766
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0147940  Vali Loss: 0.0217769 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937984  Vali macro F1 0.9935569 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 5.288607597351074
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0136478  Vali Loss: 0.0198674 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
new best score!!!!
Validation loss decreased (0.020169 --> 0.019867).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.290496826171875
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0105893  Vali Loss: 0.0259669 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872224  Vali macro F1 0.9871750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.289449214935303
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0134307  Vali Loss: 0.0207220 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912344  Vali macro F1 0.9905968 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.288814306259155
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0199565  Vali Loss: 0.0632250 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9650931  Vali macro F1 0.9647223 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.288894176483154
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0550645  Vali Loss: 0.0302192 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911770  Vali macro F1 0.9905868 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.28974175453186
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0237588  Vali Loss: 0.0222272 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912065  Vali macro F1 0.9907373 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 5.2871787548065186
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0156090  Vali Loss: 0.0190839 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937564  Vali macro F1 0.9933178 
new best score!!!!
Validation loss decreased (0.019867 --> 0.019084).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.289604425430298
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0135554  Vali Loss: 0.0187723 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
new best score!!!!
Validation loss decreased (0.019084 --> 0.018772).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.286214351654053
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0126345  Vali Loss: 0.0181609 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
new best score!!!!
Validation loss decreased (0.018772 --> 0.018161).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.283027410507202
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0118021  Vali Loss: 0.0182077 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.286219835281372
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0114090  Vali Loss: 0.0183339 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937232  Vali macro F1 0.9932791 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.282822608947754
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0107670  Vali Loss: 0.0179316 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924594  Vali macro F1 0.9919337 
new best score!!!!
Validation loss decreased (0.018161 --> 0.017932).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.292904376983643
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0110638  Vali Loss: 0.0183057 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937232  Vali macro F1 0.9932791 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.282970666885376
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0101990  Vali Loss: 0.0182962 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912194  Vali macro F1 0.9905987 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.286053657531738
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0098448  Vali Loss: 0.0174024 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9919421 
new best score!!!!
Validation loss decreased (0.017932 --> 0.017402).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 5.28817892074585
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0094384  Vali Loss: 0.0166874 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
new best score!!!!
Validation loss decreased (0.017402 --> 0.016687).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.2873101234436035
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0085218  Vali Loss: 0.0171197 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9919421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.284676790237427
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0084538  Vali Loss: 0.0172977 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9919421 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.287826299667358
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0083638  Vali Loss: 0.0163382 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
new best score!!!!
Validation loss decreased (0.016687 --> 0.016338).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.288059711456299
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0074550  Vali Loss: 0.0161197 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937232  Vali macro F1 0.9932791 
new best score!!!!
Validation loss decreased (0.016338 --> 0.016120).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.285008192062378
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0072279  Vali Loss: 0.0152767 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
new best score!!!!
Validation loss decreased (0.016120 --> 0.015277).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.28168797492981
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0068643  Vali Loss: 0.0164342 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.282675743103027
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0075658  Vali Loss: 0.0162010 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.28216028213501
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0066074  Vali Loss: 0.0160408 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.27981162071228
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0067024  Vali Loss: 0.0150172 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
new best score!!!!
Validation loss decreased (0.015277 --> 0.015017).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.280195713043213
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0065423  Vali Loss: 0.0150785 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.283973932266235
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0068159  Vali Loss: 0.0153631 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.28092360496521
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0061435  Vali Loss: 0.0154806 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.28030252456665
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0072312  Vali Loss: 0.0151231 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.28147029876709
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0108701  Vali Loss: 0.0156889 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 5.278874635696411
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0074352  Vali Loss: 0.0159245 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.28273868560791
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0077144  Vali Loss: 0.0161022 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.287079811096191
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0071556  Vali Loss: 0.0162479 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.2890636920928955
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0074505  Vali Loss: 0.0163113 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.283984899520874
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0067315  Vali Loss: 0.0165289 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 5.291046142578125
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0068322  Vali Loss: 0.0164986 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.287225961685181
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0065319  Vali Loss: 0.0165049 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 5.288218021392822
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0068466  Vali Loss: 0.0165223 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 5.290390729904175
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0069352  Vali Loss: 0.0165183 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 5.286514759063721
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0069894  Vali Loss: 0.0164483 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8903509  Test weighted F1: 0.8707223  Test macro F1 0.8707223 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.854777812957764
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0070600  Vali Loss: 0.0151438 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
Validation loss decreased (inf --> 0.015144).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.852663040161133
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0058590  Vali Loss: 0.0135543 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
new best score!!!!
Validation loss decreased (0.015144 --> 0.013554).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.85574746131897
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0052508  Vali Loss: 0.0135297 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
new best score!!!!
Validation loss decreased (0.013554 --> 0.013530).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.853278875350952
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0052816  Vali Loss: 0.0154570 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.852075099945068
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0052060  Vali Loss: 0.0130253 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950077  Vali macro F1 0.9946964 
new best score!!!!
Validation loss decreased (0.013530 --> 0.013025).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.853298902511597
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0041844  Vali Loss: 0.0141164 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.851907730102539
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0037702  Vali Loss: 0.0143612 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.851516246795654
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0040375  Vali Loss: 0.0123673 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.013025 --> 0.012367).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.84840726852417
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0042841  Vali Loss: 0.0137867 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.846864223480225
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0032746  Vali Loss: 0.0127902 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.856417655944824
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0032168  Vali Loss: 0.0129737 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.853066444396973
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0029378  Vali Loss: 0.0120708 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
new best score!!!!
Validation loss decreased (0.012367 --> 0.012071).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.854978084564209
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0029232  Vali Loss: 0.0133902 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.848540782928467
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0038646  Vali Loss: 0.0127456 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.854620695114136
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0033160  Vali Loss: 0.0149084 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925137  Vali macro F1 0.9919637 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.8520238399505615
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0026471  Vali Loss: 0.0143803 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.85446310043335
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0026826  Vali Loss: 0.0143127 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 6.863599538803101
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0031412  Vali Loss: 0.0132742 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.863693714141846
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0029037  Vali Loss: 0.0135941 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.858670473098755
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0027269  Vali Loss: 0.0139169 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937615  Vali macro F1 0.9933099 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.8559253215789795
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0023973  Vali Loss: 0.0158354 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.857600212097168
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0027522  Vali Loss: 0.0157562 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.857774972915649
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0023997  Vali Loss: 0.0154787 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.857067108154297
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0021917  Vali Loss: 0.0153542 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.856024503707886
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0022875  Vali Loss: 0.0151781 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.856173753738403
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025450  Vali Loss: 0.0150517 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.854459762573242
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0027140  Vali Loss: 0.0151210 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9919818 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8473684  Test weighted F1: 0.8042680  Test macro F1 0.8042680 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.334444046020508
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8653210  Vali Loss: 0.6758088 Vali Accuracy: 0.9047619  Vali weighted F1: 0.9006774  Vali macro F1 0.9004844 
Validation loss decreased (inf --> 0.675809).  Saving model ...
Epoch: 2 cost time: 5.261389493942261
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4298761  Vali Loss: 0.2324704 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9609788  Vali macro F1 0.9603134 
new best score!!!!
Validation loss decreased (0.675809 --> 0.232470).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.266658782958984
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1782877  Vali Loss: 0.1105867 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887274  Vali macro F1 0.9882946 
new best score!!!!
Validation loss decreased (0.232470 --> 0.110587).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.263908624649048
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0989595  Vali Loss: 0.0669642 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899067  Vali macro F1 0.9897444 
new best score!!!!
Validation loss decreased (0.110587 --> 0.066964).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.26668643951416
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0655332  Vali Loss: 0.0451433 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
new best score!!!!
Validation loss decreased (0.066964 --> 0.045143).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.269161939620972
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0457321  Vali Loss: 0.0358765 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949971  Vali macro F1 0.9946625 
new best score!!!!
Validation loss decreased (0.045143 --> 0.035877).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.268110752105713
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0518976  Vali Loss: 0.0354288 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
new best score!!!!
Validation loss decreased (0.035877 --> 0.035429).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.269630432128906
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0362303  Vali Loss: 0.0275017 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
new best score!!!!
Validation loss decreased (0.035429 --> 0.027502).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.264939308166504
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0307071  Vali Loss: 0.0354824 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863119  Vali macro F1 0.9857812 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.265390872955322
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0354212  Vali Loss: 0.0244339 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925108  Vali macro F1 0.9922107 
new best score!!!!
Validation loss decreased (0.027502 --> 0.024434).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.258321523666382
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0373129  Vali Loss: 0.0246968 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.258637428283691
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0245105  Vali Loss: 0.0165141 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949971  Vali macro F1 0.9946625 
new best score!!!!
Validation loss decreased (0.024434 --> 0.016514).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.258358955383301
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0173279  Vali Loss: 0.0189029 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950109  Vali macro F1 0.9948514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.256774663925171
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0181190  Vali Loss: 0.0186863 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9950930 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 7.89823579788208
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0139625  Vali Loss: 0.0165078 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937710  Vali macro F1 0.9937596 
new best score!!!!
Validation loss decreased (0.016514 --> 0.016508).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.248494863510132
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0109333  Vali Loss: 0.0131725 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962126  Vali macro F1 0.9961642 
new best score!!!!
Validation loss decreased (0.016508 --> 0.013172).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.2507641315460205
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0107987  Vali Loss: 0.0215509 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936789  Vali macro F1 0.9934701 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.248564720153809
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0138008  Vali Loss: 0.0225958 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936789  Vali macro F1 0.9934701 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.2465198040008545
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0158078  Vali Loss: 0.0161993 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949971  Vali macro F1 0.9946625 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 5.249868631362915
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0165737  Vali Loss: 0.0191953 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949500  Vali macro F1 0.9945176 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 5.247040510177612
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0103282  Vali Loss: 0.0131538 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
new best score!!!!
Validation loss decreased (0.013172 --> 0.013154).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.251107215881348
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0122027  Vali Loss: 0.0092993 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.013154 --> 0.009299).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.250223875045776
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0179571  Vali Loss: 0.0247469 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9869850  Vali macro F1 0.9873807 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.254833698272705
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0132468  Vali Loss: 0.0151815 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.255054950714111
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0091998  Vali Loss: 0.0120710 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.253103017807007
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0080257  Vali Loss: 0.0194799 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936789  Vali macro F1 0.9934701 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.255497932434082
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0092245  Vali Loss: 0.0134863 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937590  Vali macro F1 0.9935380 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 5.256758689880371
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0062213  Vali Loss: 0.0121108 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.256909370422363
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0050943  Vali Loss: 0.0109385 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.254222869873047
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0049674  Vali Loss: 0.0105797 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.262084245681763
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0046453  Vali Loss: 0.0109557 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.256609916687012
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0042817  Vali Loss: 0.0104649 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 5.2590649127960205
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0046608  Vali Loss: 0.0104682 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.258208513259888
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0041379  Vali Loss: 0.0104565 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.2610063552856445
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0040658  Vali Loss: 0.0105307 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.263474941253662
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0042721  Vali Loss: 0.0106017 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.258845090866089
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0041091  Vali Loss: 0.0106552 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8912281  Test weighted F1: 0.8779941  Test macro F1 0.8779941 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.904796123504639
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0074300  Vali Loss: 0.0099528 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
Validation loss decreased (inf --> 0.009953).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.905822277069092
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0056076  Vali Loss: 0.0089147 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.009953 --> 0.008915).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.906682968139648
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0049385  Vali Loss: 0.0089729 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.901092767715454
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0044102  Vali Loss: 0.0092887 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.902580738067627
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0042462  Vali Loss: 0.0197199 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924985  Vali macro F1 0.9924179 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.90536642074585
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0050162  Vali Loss: 0.0142891 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925108  Vali macro F1 0.9922107 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.891417741775513
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0038360  Vali Loss: 0.0190046 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.897038698196411
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0032756  Vali Loss: 0.0152820 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.898331880569458
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031699  Vali Loss: 0.0128059 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.908413648605347
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0025671  Vali Loss: 0.0115058 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.904412269592285
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0032349  Vali Loss: 0.0105955 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.903838872909546
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0027803  Vali Loss: 0.0138653 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.90441632270813
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0025247  Vali Loss: 0.0137395 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.903318405151367
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0025752  Vali Loss: 0.0131351 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.9081432819366455
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0022116  Vali Loss: 0.0129959 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.892256021499634
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0024630  Vali Loss: 0.0125122 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.905418634414673
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022563  Vali Loss: 0.0127732 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9052632  Test weighted F1: 0.8905502  Test macro F1 0.8905502 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.389533996582031
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8578141  Vali Loss: 0.6447738 Vali Accuracy: 0.9172932  Vali weighted F1: 0.9139953  Vali macro F1 0.9124632 
Validation loss decreased (inf --> 0.644774).  Saving model ...
Epoch: 2 cost time: 5.287266254425049
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4288333  Vali Loss: 0.2110511 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9731198  Vali macro F1 0.9713252 
new best score!!!!
Validation loss decreased (0.644774 --> 0.211051).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.292384624481201
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1849309  Vali Loss: 0.1061834 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823792  Vali macro F1 0.9811371 
new best score!!!!
Validation loss decreased (0.211051 --> 0.106183).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.292891979217529
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1030560  Vali Loss: 0.0674686 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887285  Vali macro F1 0.9880470 
new best score!!!!
Validation loss decreased (0.106183 --> 0.067469).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.29197883605957
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0709941  Vali Loss: 0.0474154 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911861  Vali macro F1 0.9904700 
new best score!!!!
Validation loss decreased (0.067469 --> 0.047415).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.295077085494995
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0499572  Vali Loss: 0.0394168 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912697  Vali macro F1 0.9906380 
new best score!!!!
Validation loss decreased (0.047415 --> 0.039417).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.296640634536743
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0399045  Vali Loss: 0.0349982 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899456  Vali macro F1 0.9892003 
new best score!!!!
Validation loss decreased (0.039417 --> 0.034998).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.299702405929565
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0327971  Vali Loss: 0.0264963 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.034998 --> 0.026496).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.294260025024414
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0278509  Vali Loss: 0.0243048 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9919421 
new best score!!!!
Validation loss decreased (0.026496 --> 0.024305).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.294053554534912
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0218459  Vali Loss: 0.0201321 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
new best score!!!!
Validation loss decreased (0.024305 --> 0.020132).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.2979772090911865
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0222415  Vali Loss: 0.0422160 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887687  Vali macro F1 0.9880834 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.291412591934204
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0265528  Vali Loss: 0.0220961 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912366  Vali macro F1 0.9906188 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.296359300613403
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0198246  Vali Loss: 0.0198989 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.020132 --> 0.019899).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.292611598968506
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0147607  Vali Loss: 0.0172160 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949514  Vali macro F1 0.9945648 
new best score!!!!
Validation loss decreased (0.019899 --> 0.017216).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.294130086898804
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0137689  Vali Loss: 0.0199845 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924435  Vali macro F1 0.9918980 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.296413898468018
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0165701  Vali Loss: 0.0220493 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962408  Vali macro F1 0.9961177 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.296899080276489
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0152783  Vali Loss: 0.0167828 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.017216 --> 0.016783).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.296146392822266
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0133224  Vali Loss: 0.0281438 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897570  Vali macro F1 0.9894949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.29569935798645
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0184726  Vali Loss: 0.0238975 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911921  Vali macro F1 0.9908001 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.295937538146973
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0112454  Vali Loss: 0.0177104 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.288896560668945
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0092183  Vali Loss: 0.0188002 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937205  Vali macro F1 0.9934888 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.289316654205322
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0097141  Vali Loss: 0.0214549 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936892  Vali macro F1 0.9931495 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 5.290421724319458
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0074121  Vali Loss: 0.0205978 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924099  Vali macro F1 0.9917859 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.2938148975372314
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0066480  Vali Loss: 0.0196661 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936651  Vali macro F1 0.9931358 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.29425048828125
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0061602  Vali Loss: 0.0188098 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936651  Vali macro F1 0.9931358 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.291636228561401
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0058669  Vali Loss: 0.0190003 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924099  Vali macro F1 0.9917859 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.294721603393555
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0057088  Vali Loss: 0.0187824 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 28 cost time: 5.289198160171509
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0053602  Vali Loss: 0.0187426 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.294251918792725
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0058404  Vali Loss: 0.0187275 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.293102025985718
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0053331  Vali Loss: 0.0186048 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.287509441375732
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0057706  Vali Loss: 0.0186748 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.2864766120910645
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0052821  Vali Loss: 0.0187726 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924064  Vali macro F1 0.9920847 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8368421  Test weighted F1: 0.7907928  Test macro F1 0.7907928 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.925976276397705
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0108690  Vali Loss: 0.0154266 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
Validation loss decreased (inf --> 0.015427).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.858379364013672
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0082671  Vali Loss: 0.0150027 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.015427 --> 0.015003).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.857184410095215
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0069313  Vali Loss: 0.0146836 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.015003 --> 0.014684).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.858474254608154
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0065242  Vali Loss: 0.0140077 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.014684 --> 0.014008).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.864240884780884
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0059418  Vali Loss: 0.0148505 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.87320613861084
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0053135  Vali Loss: 0.0155297 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9932687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.86612868309021
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0055200  Vali Loss: 0.0193347 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.865622043609619
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0055981  Vali Loss: 0.0135260 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
new best score!!!!
Validation loss decreased (0.014008 --> 0.013526).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.859201192855835
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0055033  Vali Loss: 0.0137023 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.8572611808776855
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0058192  Vali Loss: 0.0173735 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.858567476272583
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0051236  Vali Loss: 0.0127656 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
new best score!!!!
Validation loss decreased (0.013526 --> 0.012766).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.861865997314453
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0040107  Vali Loss: 0.0117994 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
new best score!!!!
Validation loss decreased (0.012766 --> 0.011799).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.8608386516571045
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0039324  Vali Loss: 0.0121032 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.862992525100708
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0040607  Vali Loss: 0.0112668 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973140 
new best score!!!!
Validation loss decreased (0.011799 --> 0.011267).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.8629469871521
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0037637  Vali Loss: 0.0123137 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.8699517250061035
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0038853  Vali Loss: 0.0128023 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.861584424972534
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0038174  Vali Loss: 0.0122631 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.861019849777222
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0035127  Vali Loss: 0.0120836 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.862326383590698
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0032681  Vali Loss: 0.0118898 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 20 cost time: 6.860506057739258
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0035463  Vali Loss: 0.0149333 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.856761455535889
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0031608  Vali Loss: 0.0148302 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.86483907699585
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0031499  Vali Loss: 0.0138521 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.868391752243042
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0033202  Vali Loss: 0.0127279 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.863584756851196
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0026735  Vali Loss: 0.0135882 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.868647336959839
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0029334  Vali Loss: 0.0135339 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.86799693107605
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0027063  Vali Loss: 0.0130982 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.87003493309021
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0023627  Vali Loss: 0.0131882 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.8646769523620605
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0022469  Vali Loss: 0.0133509 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.866626977920532
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0029191  Vali Loss: 0.0141177 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7947368  Test weighted F1: 0.7375223  Test macro F1 0.7375223 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.343616962432861
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8383490  Vali Loss: 0.6504131 Vali Accuracy: 0.9047619  Vali weighted F1: 0.9009637  Vali macro F1 0.8983373 
Validation loss decreased (inf --> 0.650413).  Saving model ...
Epoch: 2 cost time: 5.30035400390625
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4071441  Vali Loss: 0.2155509 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9570593  Vali macro F1 0.9559625 
new best score!!!!
Validation loss decreased (0.650413 --> 0.215551).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.2987799644470215
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1726516  Vali Loss: 0.1115163 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9748809  Vali macro F1 0.9739133 
new best score!!!!
Validation loss decreased (0.215551 --> 0.111516).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.300340175628662
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1088912  Vali Loss: 0.0752177 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837259  Vali macro F1 0.9825872 
new best score!!!!
Validation loss decreased (0.111516 --> 0.075218).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.301862001419067
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0674937  Vali Loss: 0.0504605 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925329  Vali macro F1 0.9921368 
new best score!!!!
Validation loss decreased (0.075218 --> 0.050460).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.308796405792236
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0480361  Vali Loss: 0.0493571 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874216  Vali macro F1 0.9864376 
new best score!!!!
Validation loss decreased (0.050460 --> 0.049357).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.304992198944092
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0438436  Vali Loss: 0.0430800 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886347  Vali macro F1 0.9878630 
new best score!!!!
Validation loss decreased (0.049357 --> 0.043080).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.305316209793091
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0374130  Vali Loss: 0.0300685 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937205  Vali macro F1 0.9934888 
new best score!!!!
Validation loss decreased (0.043080 --> 0.030068).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.303118467330933
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0337608  Vali Loss: 0.0268889 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937240  Vali macro F1 0.9931901 
new best score!!!!
Validation loss decreased (0.030068 --> 0.026889).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.3025734424591064
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0222436  Vali Loss: 0.0209511 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
new best score!!!!
Validation loss decreased (0.026889 --> 0.020951).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.303046941757202
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0173000  Vali Loss: 0.0220543 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937502  Vali macro F1 0.9932709 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.302828550338745
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0173962  Vali Loss: 0.0190334 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.020951 --> 0.019033).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.301119327545166
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0167252  Vali Loss: 0.0180590 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
new best score!!!!
Validation loss decreased (0.019033 --> 0.018059).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.301297903060913
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0137144  Vali Loss: 0.0190430 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937502  Vali macro F1 0.9932709 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.296490669250488
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0127769  Vali Loss: 0.0163796 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
new best score!!!!
Validation loss decreased (0.018059 --> 0.016380).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.30095911026001
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0118337  Vali Loss: 0.0149950 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949514  Vali macro F1 0.9945648 
new best score!!!!
Validation loss decreased (0.016380 --> 0.014995).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.292713642120361
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0127853  Vali Loss: 0.0138416 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
new best score!!!!
Validation loss decreased (0.014995 --> 0.013842).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.299257755279541
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0100563  Vali Loss: 0.0165683 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.296448469161987
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0157841  Vali Loss: 0.0256573 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912586  Vali macro F1 0.9906648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.294196367263794
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0142044  Vali Loss: 0.0201513 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924703  Vali macro F1 0.9920165 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.293078899383545
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0098622  Vali Loss: 0.0147723 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.290992021560669
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0083504  Vali Loss: 0.0153202 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 5.293606758117676
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0066412  Vali Loss: 0.0124117 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
new best score!!!!
Validation loss decreased (0.013842 --> 0.012412).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.295312404632568
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0061441  Vali Loss: 0.0139054 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.2962048053741455
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0054915  Vali Loss: 0.0127375 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.293052911758423
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0057789  Vali Loss: 0.0122453 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
new best score!!!!
Validation loss decreased (0.012412 --> 0.012245).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.297389507293701
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0055074  Vali Loss: 0.0126236 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.293677806854248
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0052449  Vali Loss: 0.0123756 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.296493053436279
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0055055  Vali Loss: 0.0126851 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 5.301631689071655
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0050795  Vali Loss: 0.0128197 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 5.293537616729736
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0051430  Vali Loss: 0.0131102 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 32 cost time: 5.29541540145874
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0047391  Vali Loss: 0.0130430 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.2923994064331055
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0049490  Vali Loss: 0.0129632 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.29557466506958
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0052554  Vali Loss: 0.0129577 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.2946858406066895
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0052072  Vali Loss: 0.0129462 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.291333913803101
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0045188  Vali Loss: 0.0128895 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 37 cost time: 5.2960591316223145
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0050383  Vali Loss: 0.0128889 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.29472541809082
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0046628  Vali Loss: 0.0128796 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.294373989105225
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0050270  Vali Loss: 0.0128756 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.2909228801727295
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0045711  Vali Loss: 0.0128693 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.291745901107788
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0051106  Vali Loss: 0.0128667 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8877193  Test weighted F1: 0.8535514  Test macro F1 0.8535514 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.8863139152526855
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0059629  Vali Loss: 0.0137105 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937582  Vali macro F1 0.9932929 
Validation loss decreased (inf --> 0.013710).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.90247654914856
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0051406  Vali Loss: 0.0145879 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.887176990509033
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0044259  Vali Loss: 0.0117914 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
new best score!!!!
Validation loss decreased (0.013710 --> 0.011791).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.889920473098755
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0042813  Vali Loss: 0.0119574 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975046  Vali macro F1 0.9973212 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.8875133991241455
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0040330  Vali Loss: 0.0125213 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.883371829986572
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0039550  Vali Loss: 0.0137917 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.884968519210815
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0035677  Vali Loss: 0.0127279 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.882631301879883
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0031469  Vali Loss: 0.0115029 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
new best score!!!!
Validation loss decreased (0.011791 --> 0.011503).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.886990070343018
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0031779  Vali Loss: 0.0122947 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.898677587509155
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0029152  Vali Loss: 0.0109170 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
new best score!!!!
Validation loss decreased (0.011503 --> 0.010917).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.894392967224121
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0030400  Vali Loss: 0.0115323 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.895117998123169
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0028448  Vali Loss: 0.0117938 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.891343593597412
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0025179  Vali Loss: 0.0110154 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959604 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.8849265575408936
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0025482  Vali Loss: 0.0137564 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.896979808807373
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0032535  Vali Loss: 0.0189078 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911568  Vali macro F1 0.9907007 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 8.747453212738037
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0044274  Vali Loss: 0.0109603 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.885079383850098
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0035003  Vali Loss: 0.0118434 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.900237560272217
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0027240  Vali Loss: 0.0127064 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.901520013809204
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0024907  Vali Loss: 0.0146886 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.902734279632568
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0028581  Vali Loss: 0.0132267 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950091  Vali macro F1 0.9946425 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.900503396987915
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0023523  Vali Loss: 0.0133699 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.892519474029541
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0018662  Vali Loss: 0.0131736 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950086  Vali macro F1 0.9946419 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.891180992126465
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0024251  Vali Loss: 0.0128271 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.895488739013672
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0023750  Vali Loss: 0.0125297 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.889380216598511
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0022810  Vali Loss: 0.0135297 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937439  Vali macro F1 0.9932893 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8394737  Test weighted F1: 0.7988579  Test macro F1 0.7988579 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.347323417663574
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8739076  Vali Loss: 0.7037923 Vali Accuracy: 0.8897243  Vali weighted F1: 0.8853528  Vali macro F1 0.8834406 
Validation loss decreased (inf --> 0.703792).  Saving model ...
Epoch: 2 cost time: 5.269651174545288
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4451533  Vali Loss: 0.2260211 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9604433  Vali macro F1 0.9594458 
new best score!!!!
Validation loss decreased (0.703792 --> 0.226021).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.273931980133057
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1868434  Vali Loss: 0.1099634 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822772  Vali macro F1 0.9818560 
new best score!!!!
Validation loss decreased (0.226021 --> 0.109963).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.274182081222534
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1045814  Vali Loss: 0.0646727 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9950378 
new best score!!!!
Validation loss decreased (0.109963 --> 0.064673).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.273141384124756
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0670389  Vali Loss: 0.0484443 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
new best score!!!!
Validation loss decreased (0.064673 --> 0.048444).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.270052671432495
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0468782  Vali Loss: 0.0361097 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912616  Vali macro F1 0.9909866 
new best score!!!!
Validation loss decreased (0.048444 --> 0.036110).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.278203725814819
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0394473  Vali Loss: 0.0349191 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
new best score!!!!
Validation loss decreased (0.036110 --> 0.034919).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.275636911392212
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0316333  Vali Loss: 0.0265755 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
new best score!!!!
Validation loss decreased (0.034919 --> 0.026576).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.282479524612427
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0252025  Vali Loss: 0.0212437 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.026576 --> 0.021244).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.281862258911133
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0236677  Vali Loss: 0.0195885 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937641  Vali macro F1 0.9935301 
new best score!!!!
Validation loss decreased (0.021244 --> 0.019589).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.278591632843018
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0231807  Vali Loss: 0.0177017 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950118  Vali macro F1 0.9948627 
new best score!!!!
Validation loss decreased (0.019589 --> 0.017702).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.283750057220459
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0214450  Vali Loss: 0.0220777 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950118  Vali macro F1 0.9948627 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.278270721435547
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0236382  Vali Loss: 0.0186170 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.2819132804870605
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0218289  Vali Loss: 0.0198857 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962126  Vali macro F1 0.9961642 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.275666952133179
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0188396  Vali Loss: 0.0213040 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 16 cost time: 5.278376579284668
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0127407  Vali Loss: 0.0202771 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 17 cost time: 5.274445295333862
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0123316  Vali Loss: 0.0178593 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.279357194900513
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0098896  Vali Loss: 0.0175318 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.017702 --> 0.017532).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.280271530151367
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0094116  Vali Loss: 0.0171287 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.017532 --> 0.017129).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.277726650238037
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0092773  Vali Loss: 0.0163808 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.017129 --> 0.016381).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.27677845954895
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0090102  Vali Loss: 0.0164988 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.27497673034668
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0093580  Vali Loss: 0.0164470 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.279428720474243
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0091284  Vali Loss: 0.0143387 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.016381 --> 0.014339).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.275986194610596
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0082102  Vali Loss: 0.0165434 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.273090362548828
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0081097  Vali Loss: 0.0161882 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.274512052536011
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0085192  Vali Loss: 0.0215988 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.274948358535767
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0093716  Vali Loss: 0.0142487 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.014339 --> 0.014249).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.274017333984375
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0079575  Vali Loss: 0.0148838 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.270565032958984
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0073667  Vali Loss: 0.0150539 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.272505521774292
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0074040  Vali Loss: 0.0153336 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.270991325378418
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0076850  Vali Loss: 0.0156689 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.272388935089111
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0072915  Vali Loss: 0.0149833 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 5.267598628997803
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0072532  Vali Loss: 0.0150700 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.267803430557251
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0067546  Vali Loss: 0.0150734 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.270493745803833
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0065408  Vali Loss: 0.0151253 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.266316652297974
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0068654  Vali Loss: 0.0151380 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.268483638763428
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0068282  Vali Loss: 0.0152486 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 38 cost time: 5.266790151596069
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0068163  Vali Loss: 0.0152366 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.266435623168945
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0069375  Vali Loss: 0.0152371 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.2651121616363525
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0063147  Vali Loss: 0.0152265 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.26464581489563
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0065984  Vali Loss: 0.0152235 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.267637014389038
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0069656  Vali Loss: 0.0152236 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9657895  Test weighted F1: 0.9644303  Test macro F1 0.9644303 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.881840705871582
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0077862  Vali Loss: 0.0153846 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
Validation loss decreased (inf --> 0.015385).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.881591081619263
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0066632  Vali Loss: 0.0148737 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.015385 --> 0.014874).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.880030393600464
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0063501  Vali Loss: 0.0137496 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
new best score!!!!
Validation loss decreased (0.014874 --> 0.013750).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.880399227142334
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0058933  Vali Loss: 0.0131450 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.013750 --> 0.013145).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.8813676834106445
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0059005  Vali Loss: 0.0149295 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937641  Vali macro F1 0.9935301 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.895441055297852
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0060191  Vali Loss: 0.0122849 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
new best score!!!!
Validation loss decreased (0.013145 --> 0.012285).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.889376878738403
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0054150  Vali Loss: 0.0123877 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.902681589126587
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0059361  Vali Loss: 0.0152791 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.894523620605469
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0062582  Vali Loss: 0.0124635 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.889137268066406
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0046644  Vali Loss: 0.0138386 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.8877081871032715
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0046492  Vali Loss: 0.0145464 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.885247468948364
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0045402  Vali Loss: 0.0132866 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.886660814285278
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0046901  Vali Loss: 0.0134382 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.888636827468872
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0054391  Vali Loss: 0.0179346 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962478  Vali macro F1 0.9959924 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.899176359176636
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0047220  Vali Loss: 0.0164033 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937399  Vali macro F1 0.9938065 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.881703853607178
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0057906  Vali Loss: 0.0121806 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.012285 --> 0.012181).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.890830993652344
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0043494  Vali Loss: 0.0123364 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.886223077774048
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0038599  Vali Loss: 0.0124588 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.884168863296509
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0042747  Vali Loss: 0.0126145 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.8899085521698
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0037863  Vali Loss: 0.0115189 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
new best score!!!!
Validation loss decreased (0.012181 --> 0.011519).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.881141424179077
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0037514  Vali Loss: 0.0126399 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.8840250968933105
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0036804  Vali Loss: 0.0156855 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.8813745975494385
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0035897  Vali Loss: 0.0130015 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.8977813720703125
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0036697  Vali Loss: 0.0141635 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.895698070526123
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0035572  Vali Loss: 0.0130653 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 6.894942283630371
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0029547  Vali Loss: 0.0136077 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.885805368423462
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0031784  Vali Loss: 0.0134961 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.889481544494629
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0028324  Vali Loss: 0.0133616 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.886433839797974
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0028788  Vali Loss: 0.0135792 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.889071226119995
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0033008  Vali Loss: 0.0138407 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 6.8871660232543945
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0031632  Vali Loss: 0.0138465 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.890017986297607
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0031258  Vali Loss: 0.0138464 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.892047643661499
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0029192  Vali Loss: 0.0138747 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.883693218231201
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0033640  Vali Loss: 0.0138266 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.898581027984619
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0029386  Vali Loss: 0.0138620 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9666667  Test weighted F1: 0.9656204  Test macro F1 0.9656204 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.3913679122924805
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8574029  Vali Loss: 0.6724297 Vali Accuracy: 0.8934837  Vali weighted F1: 0.8920435  Vali macro F1 0.8903326 
Validation loss decreased (inf --> 0.672430).  Saving model ...
Epoch: 2 cost time: 5.271298408508301
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4324177  Vali Loss: 0.2255241 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9553521  Vali macro F1 0.9523130 
new best score!!!!
Validation loss decreased (0.672430 --> 0.225524).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.279783487319946
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1797936  Vali Loss: 0.1198454 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9760743  Vali macro F1 0.9747585 
new best score!!!!
Validation loss decreased (0.225524 --> 0.119845).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.276750087738037
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1014789  Vali Loss: 0.0738796 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9813607  Vali macro F1 0.9802931 
new best score!!!!
Validation loss decreased (0.119845 --> 0.073880).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.277773141860962
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0705591  Vali Loss: 0.0557455 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900080  Vali macro F1 0.9894756 
new best score!!!!
Validation loss decreased (0.073880 --> 0.055746).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.27573561668396
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0488523  Vali Loss: 0.0417739 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887169  Vali macro F1 0.9880544 
new best score!!!!
Validation loss decreased (0.055746 --> 0.041774).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.275723934173584
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0384325  Vali Loss: 0.0338387 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899710  Vali macro F1 0.9896215 
new best score!!!!
Validation loss decreased (0.041774 --> 0.033839).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.267321586608887
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0317884  Vali Loss: 0.0303946 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937631  Vali macro F1 0.9934463 
new best score!!!!
Validation loss decreased (0.033839 --> 0.030395).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.272563219070435
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0306801  Vali Loss: 0.0278447 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925329  Vali macro F1 0.9921368 
new best score!!!!
Validation loss decreased (0.030395 --> 0.027845).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.269138336181641
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0257179  Vali Loss: 0.0273573 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912602  Vali macro F1 0.9908011 
new best score!!!!
Validation loss decreased (0.027845 --> 0.027357).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.2728893756866455
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0268339  Vali Loss: 0.0276972 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888249  Vali macro F1 0.9881090 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.265653371810913
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0207384  Vali Loss: 0.0232618 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925153  Vali macro F1 0.9921001 
new best score!!!!
Validation loss decreased (0.027357 --> 0.023262).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.275646209716797
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0182712  Vali Loss: 0.0258077 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912401  Vali macro F1 0.9909283 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.266899824142456
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0210665  Vali Loss: 0.0248403 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912204  Vali macro F1 0.9901819 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.273412704467773
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0186164  Vali Loss: 0.0199262 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
new best score!!!!
Validation loss decreased (0.023262 --> 0.019926).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.26559591293335
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0131790  Vali Loss: 0.0189611 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949514  Vali macro F1 0.9945648 
new best score!!!!
Validation loss decreased (0.019926 --> 0.018961).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.275840759277344
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0122349  Vali Loss: 0.0168330 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
new best score!!!!
Validation loss decreased (0.018961 --> 0.016833).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.267425298690796
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0093203  Vali Loss: 0.0160520 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.016833 --> 0.016052).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.270719528198242
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0192803  Vali Loss: 0.0229598 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925098  Vali macro F1 0.9921269 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.267946481704712
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0140852  Vali Loss: 0.0186711 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937631  Vali macro F1 0.9934463 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.270952463150024
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0106774  Vali Loss: 0.0158356 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.016052 --> 0.015836).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.2701637744903564
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0098554  Vali Loss: 0.0208771 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924390  Vali macro F1 0.9918766 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.273226499557495
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0239184  Vali Loss: 0.0200378 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.272626161575317
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0123532  Vali Loss: 0.0151561 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950044  Vali macro F1 0.9946478 
new best score!!!!
Validation loss decreased (0.015836 --> 0.015156).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.273016929626465
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0087575  Vali Loss: 0.0161740 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.269343614578247
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0074762  Vali Loss: 0.0149446 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.015156 --> 0.014945).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.272506475448608
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0058437  Vali Loss: 0.0175886 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924231  Vali macro F1 0.9918425 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.269068956375122
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0064938  Vali Loss: 0.0172763 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.279961347579956
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0062285  Vali Loss: 0.0144499 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.014945 --> 0.014450).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.270995616912842
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0053831  Vali Loss: 0.0130706 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
new best score!!!!
Validation loss decreased (0.014450 --> 0.013071).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.2757344245910645
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0052590  Vali Loss: 0.0135424 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.270690441131592
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0047771  Vali Loss: 0.0139700 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.279213190078735
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0038528  Vali Loss: 0.0156276 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.269462585449219
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0041348  Vali Loss: 0.0137129 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.276417016983032
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0037796  Vali Loss: 0.0112891 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962593  Vali macro F1 0.9959809 
new best score!!!!
Validation loss decreased (0.013071 --> 0.011289).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.272472858428955
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0035684  Vali Loss: 0.0114316 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975046  Vali macro F1 0.9973212 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.276782274246216
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0110886  Vali Loss: 0.0249403 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937166  Vali macro F1 0.9934108 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.26823616027832
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0166419  Vali Loss: 0.0243866 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924390  Vali macro F1 0.9918766 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.27204704284668
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0097407  Vali Loss: 0.0149503 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962534  Vali macro F1 0.9959818 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 5.26805567741394
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0059227  Vali Loss: 0.0166844 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 5.27393102645874
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0038812  Vali Loss: 0.0158955 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.2666237354278564
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0030903  Vali Loss: 0.0158169 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937631  Vali macro F1 0.9934463 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 5.273796558380127
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0027578  Vali Loss: 0.0152544 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937631  Vali macro F1 0.9934463 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 5.273984432220459
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0029754  Vali Loss: 0.0140573 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962610  Vali macro F1 0.9961172 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 5.2689619064331055
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0027965  Vali Loss: 0.0138599 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962610  Vali macro F1 0.9961172 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 5.266806364059448
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0023866  Vali Loss: 0.0137995 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962610  Vali macro F1 0.9961172 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.278216600418091
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0033299  Vali Loss: 0.0138037 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962610  Vali macro F1 0.9961172 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.264620065689087
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0028249  Vali Loss: 0.0137940 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962610  Vali macro F1 0.9961172 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 5.266702890396118
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0026036  Vali Loss: 0.0138868 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962610  Vali macro F1 0.9961172 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 5.265888690948486
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0024464  Vali Loss: 0.0139485 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962610  Vali macro F1 0.9961172 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9394737  Test weighted F1: 0.9218188  Test macro F1 0.9218188 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.86073112487793
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0029229  Vali Loss: 0.0119435 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
Validation loss decreased (inf --> 0.011943).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.857700824737549
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0027751  Vali Loss: 0.0119021 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.011943 --> 0.011902).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.855156898498535
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0021957  Vali Loss: 0.0147769 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.861364841461182
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0019384  Vali Loss: 0.0132791 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.8590216636657715
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0022680  Vali Loss: 0.0161142 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.8553876876831055
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0018284  Vali Loss: 0.0110124 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.011902 --> 0.011012).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.859501838684082
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0016549  Vali Loss: 0.0137015 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.858794450759888
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0024430  Vali Loss: 0.0194217 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.8647565841674805
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0019169  Vali Loss: 0.0191261 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.8582398891448975
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0019472  Vali Loss: 0.0150003 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.856459379196167
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0012984  Vali Loss: 0.0136938 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.862486124038696
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0014441  Vali Loss: 0.0178103 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.865490674972534
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0038542  Vali Loss: 0.0130173 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.862613677978516
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0015346  Vali Loss: 0.0157045 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.861925840377808
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0015716  Vali Loss: 0.0155586 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.863536357879639
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0013210  Vali Loss: 0.0138599 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.860732793807983
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0014951  Vali Loss: 0.0137380 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.8606696128845215
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0011037  Vali Loss: 0.0139205 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.861581563949585
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0010572  Vali Loss: 0.0140195 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.864124059677124
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0009729  Vali Loss: 0.0141915 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.860421657562256
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0009019  Vali Loss: 0.0140969 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9385965  Test weighted F1: 0.9206772  Test macro F1 0.9206772 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.329408407211304
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8535525  Vali Loss: 0.6752622 Vali Accuracy: 0.9135338  Vali weighted F1: 0.9045453  Vali macro F1 0.9059165 
Validation loss decreased (inf --> 0.675262).  Saving model ...
Epoch: 2 cost time: 5.264332294464111
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4211491  Vali Loss: 0.2172306 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9560700  Vali macro F1 0.9560263 
new best score!!!!
Validation loss decreased (0.675262 --> 0.217231).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.258042812347412
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1692154  Vali Loss: 0.1084595 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9831678  Vali macro F1 0.9824883 
new best score!!!!
Validation loss decreased (0.217231 --> 0.108459).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.255577087402344
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0936539  Vali Loss: 0.0581871 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898210  Vali macro F1 0.9895696 
new best score!!!!
Validation loss decreased (0.108459 --> 0.058187).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.251761198043823
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0593006  Vali Loss: 0.0423656 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899228  Vali macro F1 0.9891053 
new best score!!!!
Validation loss decreased (0.058187 --> 0.042366).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.252443790435791
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0427989  Vali Loss: 0.0391618 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862238  Vali macro F1 0.9861831 
new best score!!!!
Validation loss decreased (0.042366 --> 0.039162).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.245657920837402
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0354660  Vali Loss: 0.0319648 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900288  Vali macro F1 0.9895361 
new best score!!!!
Validation loss decreased (0.039162 --> 0.031965).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.24936842918396
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0311702  Vali Loss: 0.0262971 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925163  Vali macro F1 0.9921839 
new best score!!!!
Validation loss decreased (0.031965 --> 0.026297).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.249497175216675
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0286695  Vali Loss: 0.0309940 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886282  Vali macro F1 0.9882726 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.24500584602356
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0272993  Vali Loss: 0.0192910 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924836  Vali macro F1 0.9921620 
new best score!!!!
Validation loss decreased (0.026297 --> 0.019291).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.248373508453369
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0202406  Vali Loss: 0.0199615 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936727  Vali macro F1 0.9931804 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.24901819229126
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0216613  Vali Loss: 0.0146691 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.019291 --> 0.014669).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.252370357513428
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0127159  Vali Loss: 0.0165453 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937037  Vali macro F1 0.9932293 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.252779245376587
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0171276  Vali Loss: 0.0143120 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950118  Vali macro F1 0.9948627 
new best score!!!!
Validation loss decreased (0.014669 --> 0.014312).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.2587058544158936
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0124484  Vali Loss: 0.0196637 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912421  Vali macro F1 0.9908045 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.2583208084106445
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0150864  Vali Loss: 0.0392221 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9896969  Vali macro F1 0.9894511 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.263641357421875
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0719339  Vali Loss: 0.0395932 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9869153  Vali macro F1 0.9864128 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 5.269608736038208
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0306374  Vali Loss: 0.0274798 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911797  Vali macro F1 0.9905728 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 19 cost time: 5.265817642211914
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0188533  Vali Loss: 0.0196782 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936789  Vali macro F1 0.9934701 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 20 cost time: 5.264232158660889
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0164219  Vali Loss: 0.0182139 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.2664878368377686
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0131597  Vali Loss: 0.0170705 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.2706992626190186
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0120785  Vali Loss: 0.0183285 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.2712461948394775
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0110034  Vali Loss: 0.0179387 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.274240255355835
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0110620  Vali Loss: 0.0166028 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 25 cost time: 5.273271560668945
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0105268  Vali Loss: 0.0168180 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.273052453994751
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0100634  Vali Loss: 0.0169885 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.2704017162323
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0103740  Vali Loss: 0.0169647 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.269486665725708
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0097616  Vali Loss: 0.0170189 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.272501230239868
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0102806  Vali Loss: 0.0168865 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8403509  Test weighted F1: 0.8159033  Test macro F1 0.8159033 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.899542570114136
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0098261  Vali Loss: 0.0142336 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937641  Vali macro F1 0.9935301 
Validation loss decreased (inf --> 0.014234).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.905386924743652
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0082384  Vali Loss: 0.0150302 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.90171480178833
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0065362  Vali Loss: 0.0118048 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925163  Vali macro F1 0.9921839 
new best score!!!!
Validation loss decreased (0.014234 --> 0.011805).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.894597053527832
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0062713  Vali Loss: 0.0124833 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924836  Vali macro F1 0.9921620 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.896116018295288
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0054474  Vali Loss: 0.0118258 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.900339126586914
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0044074  Vali Loss: 0.0109250 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.011805 --> 0.010925).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.909660339355469
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0044631  Vali Loss: 0.0123373 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924974  Vali macro F1 0.9921619 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.901999235153198
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0037911  Vali Loss: 0.0109397 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.901336908340454
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0034408  Vali Loss: 0.0126704 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.902655124664307
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0070592  Vali Loss: 0.0121569 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912367  Vali macro F1 0.9908167 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.906992435455322
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0118717  Vali Loss: 0.0189864 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 7.71798300743103
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0089505  Vali Loss: 0.0167512 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911972  Vali macro F1 0.9908103 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.899493455886841
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0056567  Vali Loss: 0.0132403 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.899597644805908
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0043205  Vali Loss: 0.0112165 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.907156467437744
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0033222  Vali Loss: 0.0111515 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.898537874221802
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0036597  Vali Loss: 0.0098657 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.010925 --> 0.009866).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.901447772979736
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0027670  Vali Loss: 0.0102654 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.89824366569519
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0028929  Vali Loss: 0.0101347 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.90046763420105
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0028024  Vali Loss: 0.0098581 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.009866 --> 0.009858).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.8950958251953125
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0026934  Vali Loss: 0.0103513 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.904927730560303
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0021701  Vali Loss: 0.0098613 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.8951733112335205
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024269  Vali Loss: 0.0103833 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936974  Vali macro F1 0.9932635 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.89772629737854
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0020725  Vali Loss: 0.0098548 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.009858 --> 0.009855).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.889598608016968
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0021488  Vali Loss: 0.0097765 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
new best score!!!!
Validation loss decreased (0.009855 --> 0.009776).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.898871183395386
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0018121  Vali Loss: 0.0099512 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.899292945861816
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0019542  Vali Loss: 0.0095821 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
new best score!!!!
Validation loss decreased (0.009776 --> 0.009582).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.904289484024048
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0017671  Vali Loss: 0.0095310 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
new best score!!!!
Validation loss decreased (0.009582 --> 0.009531).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 6.890026330947876
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0015479  Vali Loss: 0.0097700 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.901449680328369
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0016213  Vali Loss: 0.0097146 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.889581203460693
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0016357  Vali Loss: 0.0098549 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949621  Vali macro F1 0.9946098 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.902423620223999
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0015352  Vali Loss: 0.0101542 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.898467302322388
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0014247  Vali Loss: 0.0099490 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 33 cost time: 6.894419431686401
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0015154  Vali Loss: 0.0098801 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.897644996643066
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0014301  Vali Loss: 0.0099160 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.898358345031738
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0014169  Vali Loss: 0.0099372 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.902856826782227
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0016758  Vali Loss: 0.0098001 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.900835037231445
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0013191  Vali Loss: 0.0098451 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 38 cost time: 6.89507269859314
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0012370  Vali Loss: 0.0098476 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 6.9005396366119385
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0012959  Vali Loss: 0.0098491 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 6.8985419273376465
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0016897  Vali Loss: 0.0098470 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 6.896524429321289
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0014117  Vali Loss: 0.0098487 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 6.900390625
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0014413  Vali Loss: 0.0098470 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8245614  Test weighted F1: 0.7858688  Test macro F1 0.7858688 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 913548
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.345637798309326
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0555705  Vali Loss: 0.7532396 Vali Accuracy: 0.8771930  Vali weighted F1: 0.8632377  Vali macro F1 0.8612705 
Validation loss decreased (inf --> 0.753240).  Saving model ...
Epoch: 2 cost time: 5.216326951980591
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4539155  Vali Loss: 0.2476560 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9535147  Vali macro F1 0.9532697 
new best score!!!!
Validation loss decreased (0.753240 --> 0.247656).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.25785756111145
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1818348  Vali Loss: 0.1358636 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9781597  Vali macro F1 0.9788637 
new best score!!!!
Validation loss decreased (0.247656 --> 0.135864).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.263239622116089
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1094277  Vali Loss: 0.0901057 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847870  Vali macro F1 0.9855752 
new best score!!!!
Validation loss decreased (0.135864 --> 0.090106).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.264082193374634
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0720660  Vali Loss: 0.0612264 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9820583  Vali macro F1 0.9823310 
new best score!!!!
Validation loss decreased (0.090106 --> 0.061226).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.27297830581665
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0539335  Vali Loss: 0.0451349 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
new best score!!!!
Validation loss decreased (0.061226 --> 0.045135).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.27475118637085
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0429312  Vali Loss: 0.0314217 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937142  Vali macro F1 0.9940017 
new best score!!!!
Validation loss decreased (0.045135 --> 0.031422).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.284000873565674
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0341556  Vali Loss: 0.0370043 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872882  Vali macro F1 0.9877235 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.278574228286743
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0341502  Vali Loss: 0.0356213 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847199  Vali macro F1 0.9853780 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 10 cost time: 5.281095027923584
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0337338  Vali Loss: 0.0273252 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937160  Vali macro F1 0.9940997 
new best score!!!!
Validation loss decreased (0.031422 --> 0.027325).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.287287950515747
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0252511  Vali Loss: 0.0236112 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949838  Vali macro F1 0.9951766 
new best score!!!!
Validation loss decreased (0.027325 --> 0.023611).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.286369800567627
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0271764  Vali Loss: 0.0170354 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.023611 --> 0.017035).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.288690805435181
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0206396  Vali Loss: 0.0149423 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.017035 --> 0.014942).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.290968894958496
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0174153  Vali Loss: 0.0143197 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975110  Vali macro F1 0.9976943 
new best score!!!!
Validation loss decreased (0.014942 --> 0.014320).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.296264886856079
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0189326  Vali Loss: 0.0148605 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.29764461517334
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0214652  Vali Loss: 0.0135257 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
new best score!!!!
Validation loss decreased (0.014320 --> 0.013526).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.301225423812866
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0142128  Vali Loss: 0.0190587 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911809  Vali macro F1 0.9917031 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.301628589630127
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0166986  Vali Loss: 0.0098791 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013526 --> 0.009879).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.295694351196289
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0120671  Vali Loss: 0.0059881 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009879 --> 0.005988).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.297824382781982
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0129598  Vali Loss: 0.0103414 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.296475172042847
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0132538  Vali Loss: 0.0112867 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.299257278442383
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0087032  Vali Loss: 0.0061246 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.2962305545806885
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0083339  Vali Loss: 0.0102756 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9978121 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.301055192947388
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0079611  Vali Loss: 0.0061243 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 5.2931578159332275
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0080413  Vali Loss: 0.0048030 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005988 --> 0.004803).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.288907527923584
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0059547  Vali Loss: 0.0045701 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004803 --> 0.004570).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.291081666946411
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0062259  Vali Loss: 0.0041132 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004570 --> 0.004113).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.293720722198486
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0056197  Vali Loss: 0.0036922 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004113 --> 0.003692).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.29833984375
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0050874  Vali Loss: 0.0037263 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.290681600570679
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0055920  Vali Loss: 0.0036520 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003692 --> 0.003652).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.2955641746521
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0048179  Vali Loss: 0.0036032 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003652 --> 0.003603).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.301313400268555
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0053556  Vali Loss: 0.0035898 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003603 --> 0.003590).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.290430068969727
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0068719  Vali Loss: 0.0065063 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9990246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.292825937271118
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0048853  Vali Loss: 0.0036735 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.297030448913574
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0046331  Vali Loss: 0.0032088 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003590 --> 0.003209).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.292377233505249
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0051904  Vali Loss: 0.0035441 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.288814067840576
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0043283  Vali Loss: 0.0029879 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003209 --> 0.002988).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.29487681388855
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0046280  Vali Loss: 0.0029423 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002988 --> 0.002942).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.294989824295044
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0042051  Vali Loss: 0.0030475 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.290620565414429
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0043719  Vali Loss: 0.0029925 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.291283130645752
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0044318  Vali Loss: 0.0029254 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002942 --> 0.002925).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.290663242340088
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0042524  Vali Loss: 0.0030161 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.289975643157959
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0037816  Vali Loss: 0.0030599 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.287075757980347
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0041807  Vali Loss: 0.0031376 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 5.2923583984375
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0040393  Vali Loss: 0.0027667 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002925 --> 0.002767).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 5.290910005569458
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0039231  Vali Loss: 0.0027289 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002767 --> 0.002729).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.290473222732544
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0044021  Vali Loss: 0.0029813 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.292972803115845
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0043528  Vali Loss: 0.0030463 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 5.289306640625
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0039392  Vali Loss: 0.0029895 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 5.2955522537231445
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0036779  Vali Loss: 0.0025214 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002729 --> 0.002521).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 5.291237831115723
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0046990  Vali Loss: 0.0028380 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 5.296519041061401
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0039645  Vali Loss: 0.0027291 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 5.291942834854126
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0037703  Vali Loss: 0.0026202 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 5.294633150100708
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0032790  Vali Loss: 0.0024419 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002521 --> 0.002442).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 5.670418739318848
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0035084  Vali Loss: 0.0028307 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 5.296255588531494
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0036027  Vali Loss: 0.0022455 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002442 --> 0.002246).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 5.300212860107422
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0038281  Vali Loss: 0.0022898 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 5.295687913894653
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0035905  Vali Loss: 0.0027976 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 5.294621229171753
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0038065  Vali Loss: 0.0028745 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 5.290109395980835
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0032130  Vali Loss: 0.0024547 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 5.295895338058472
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0036846  Vali Loss: 0.0022503 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 62 cost time: 5.293422698974609
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0030077  Vali Loss: 0.0022512 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 5.289910316467285
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0035102  Vali Loss: 0.0022459 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 5.293281555175781
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0031085  Vali Loss: 0.0022386 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002246 --> 0.002239).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 5.295938014984131
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0030365  Vali Loss: 0.0022353 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002239 --> 0.002235).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 5.292264938354492
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0027137  Vali Loss: 0.0022249 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002235 --> 0.002225).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 5.291137933731079
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0028391  Vali Loss: 0.0021937 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002225 --> 0.002194).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 5.2914862632751465
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0030775  Vali Loss: 0.0022030 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 5.285462856292725
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0031981  Vali Loss: 0.0021917 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002194 --> 0.002192).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 5.288425445556641
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0030678  Vali Loss: 0.0022017 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 5.291757106781006
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0029019  Vali Loss: 0.0021609 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002192 --> 0.002161).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 5.28859806060791
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0031512  Vali Loss: 0.0021463 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002161 --> 0.002146).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 5.293208837509155
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0024915  Vali Loss: 0.0021533 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 5.291076183319092
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0031289  Vali Loss: 0.0021563 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 5.290081739425659
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0029974  Vali Loss: 0.0021691 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 5.292506456375122
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0028067  Vali Loss: 0.0021906 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 5.2890002727508545
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0030845  Vali Loss: 0.0021801 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 78 cost time: 5.294294357299805
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0031522  Vali Loss: 0.0021763 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 5.28525710105896
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0026692  Vali Loss: 0.0021744 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 5.289053678512573
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0027351  Vali Loss: 0.0021704 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 5.290721416473389
VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0029360  Vali Loss: 0.0021671 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 5.288631439208984
VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0030973  Vali Loss: 0.0021644 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 83 cost time: 5.2866597175598145
VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0026377  Vali Loss: 0.0021643 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 5.287054538726807
VALI: Epoch: 84, Steps: 29 | Train Loss: 0.0027275  Vali Loss: 0.0021639 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 85 cost time: 5.290893316268921
VALI: Epoch: 85, Steps: 29 | Train Loss: 0.0025360  Vali Loss: 0.0021634 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 86 cost time: 5.298553943634033
VALI: Epoch: 86, Steps: 29 | Train Loss: 0.0030257  Vali Loss: 0.0021631 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 87 cost time: 5.291608810424805
VALI: Epoch: 87, Steps: 29 | Train Loss: 0.0029716  Vali Loss: 0.0021628 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8657895  Test weighted F1: 0.8431104  Test macro F1 0.8431104 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.875019550323486
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0031068  Vali Loss: 0.0019260 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.001926).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.869908332824707
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0034088  Vali Loss: 0.0019912 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.870011568069458
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0030143  Vali Loss: 0.0022504 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.867631435394287
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0031907  Vali Loss: 0.0023957 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.867347478866577
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0030938  Vali Loss: 0.0025410 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.868039131164551
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0030927  Vali Loss: 0.0018371 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001926 --> 0.001837).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.870530605316162
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0023988  Vali Loss: 0.0038761 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974905  Vali macro F1 0.9976688 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.874077558517456
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0023875  Vali Loss: 0.0039493 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974922  Vali macro F1 0.9976720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.869757413864136
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0022085  Vali Loss: 0.0022956 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987447  Vali macro F1 0.9988845 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.8753252029418945
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0022904  Vali Loss: 0.0010799 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001837 --> 0.001080).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.878099679946899
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0021706  Vali Loss: 0.0021309 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.876642465591431
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0026513  Vali Loss: 0.0020656 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.874572515487671
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0020844  Vali Loss: 0.0010859 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.876140356063843
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0017218  Vali Loss: 0.0014883 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.8734729290008545
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0027954  Vali Loss: 0.0011428 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.881495237350464
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0023955  Vali Loss: 0.0010429 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001080 --> 0.001043).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.8732733726501465
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0015823  Vali Loss: 0.0010383 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001043 --> 0.001038).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.871695041656494
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0015200  Vali Loss: 0.0010602 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.877657890319824
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0021959  Vali Loss: 0.0011211 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.876157760620117
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0018992  Vali Loss: 0.0012294 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.879812002182007
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0016952  Vali Loss: 0.0010886 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.876797199249268
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0018495  Vali Loss: 0.0010623 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.881747007369995
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0017547  Vali Loss: 0.0010632 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.879882097244263
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0015520  Vali Loss: 0.0010692 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.870188236236572
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0018269  Vali Loss: 0.0010710 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.875928163528442
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0015476  Vali Loss: 0.0010691 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.874443769454956
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0013915  Vali Loss: 0.0010675 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 28 cost time: 6.872371196746826
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0015751  Vali Loss: 0.0010673 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.876790761947632
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0019262  Vali Loss: 0.0010669 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.8770623207092285
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0015225  Vali Loss: 0.0010668 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.874050140380859
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0015295  Vali Loss: 0.0010668 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.866133689880371
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0020518  Vali Loss: 0.0010668 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8666667  Test weighted F1: 0.8423687  Test macro F1 0.8423687 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.3470141887664795
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0756863  Vali Loss: 0.7496631 Vali Accuracy: 0.8771930  Vali weighted F1: 0.8626220  Vali macro F1 0.8615371 
Validation loss decreased (inf --> 0.749663).  Saving model ...
Epoch: 2 cost time: 5.252729892730713
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4637350  Vali Loss: 0.2641625 Vali Accuracy: 0.9523810  Vali weighted F1: 0.9500564  Vali macro F1 0.9500198 
new best score!!!!
Validation loss decreased (0.749663 --> 0.264162).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.249359607696533
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1925101  Vali Loss: 0.1389164 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9727770  Vali macro F1 0.9723625 
new best score!!!!
Validation loss decreased (0.264162 --> 0.138916).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.254016637802124
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1092925  Vali Loss: 0.0788267 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873047  Vali macro F1 0.9879213 
new best score!!!!
Validation loss decreased (0.138916 --> 0.078827).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.253132343292236
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0762645  Vali Loss: 0.0590708 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897624  Vali macro F1 0.9902048 
new best score!!!!
Validation loss decreased (0.078827 --> 0.059071).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.254849433898926
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0569218  Vali Loss: 0.0416186 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962344  Vali macro F1 0.9965073 
new best score!!!!
Validation loss decreased (0.059071 --> 0.041619).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.255239486694336
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0421059  Vali Loss: 0.0347230 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924146  Vali macro F1 0.9926225 
new best score!!!!
Validation loss decreased (0.041619 --> 0.034723).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.2571821212768555
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0344863  Vali Loss: 0.0303959 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923947  Vali macro F1 0.9926502 
new best score!!!!
Validation loss decreased (0.034723 --> 0.030396).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.260473966598511
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0294208  Vali Loss: 0.0218470 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
new best score!!!!
Validation loss decreased (0.030396 --> 0.021847).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.258569717407227
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0251394  Vali Loss: 0.0185026 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.021847 --> 0.018503).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.2543463706970215
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0205326  Vali Loss: 0.0207138 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.253102779388428
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0192232  Vali Loss: 0.0147676 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.018503 --> 0.014768).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.251643419265747
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0238973  Vali Loss: 0.0172086 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.256061553955078
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0209190  Vali Loss: 0.0144506 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
new best score!!!!
Validation loss decreased (0.014768 --> 0.014451).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.251986026763916
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0145817  Vali Loss: 0.0156269 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.2544026374816895
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0185365  Vali Loss: 0.0134035 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
new best score!!!!
Validation loss decreased (0.014451 --> 0.013403).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.25334906578064
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0212240  Vali Loss: 0.0119779 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.013403 --> 0.011978).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.255764722824097
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0139890  Vali Loss: 0.0176960 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949901  Vali macro F1 0.9951597 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.255274772644043
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0105718  Vali Loss: 0.0105136 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.011978 --> 0.010514).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.252747297286987
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0398669  Vali Loss: 0.0909139 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9871821  Vali macro F1 0.9877060 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.257866621017456
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0673206  Vali Loss: 0.0462818 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887882  Vali macro F1 0.9895249 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.250666856765747
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0333710  Vali Loss: 0.0190772 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.25221586227417
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0204951  Vali Loss: 0.0157410 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.251078844070435
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0162234  Vali Loss: 0.0117267 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 5.250412702560425
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0137569  Vali Loss: 0.0089067 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.010514 --> 0.008907).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.252227306365967
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0122881  Vali Loss: 0.0085116 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.008907 --> 0.008512).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.250725984573364
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0122674  Vali Loss: 0.0085199 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.255757093429565
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0104381  Vali Loss: 0.0079330 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.008512 --> 0.007933).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.256218910217285
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0107792  Vali Loss: 0.0076018 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.007933 --> 0.007602).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.2600648403167725
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0100368  Vali Loss: 0.0073188 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.007602 --> 0.007319).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.256937503814697
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0097438  Vali Loss: 0.0069672 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
new best score!!!!
Validation loss decreased (0.007319 --> 0.006967).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.250627279281616
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0105496  Vali Loss: 0.0066277 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006967 --> 0.006628).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.253164529800415
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0086990  Vali Loss: 0.0075765 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.247700452804565
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0090919  Vali Loss: 0.0071752 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.252647161483765
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0087136  Vali Loss: 0.0067965 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.251852989196777
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0080372  Vali Loss: 0.0066327 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.251945495605469
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0083618  Vali Loss: 0.0066203 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006628 --> 0.006620).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.256537437438965
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0077700  Vali Loss: 0.0061382 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006620 --> 0.006138).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.255307674407959
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0072524  Vali Loss: 0.0063013 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.249368906021118
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0075247  Vali Loss: 0.0058496 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006138 --> 0.005850).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.253659963607788
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0069343  Vali Loss: 0.0054959 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005850 --> 0.005496).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.250582933425903
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0070578  Vali Loss: 0.0054032 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005496 --> 0.005403).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.252978324890137
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0066932  Vali Loss: 0.0053125 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005403 --> 0.005312).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.253586769104004
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0066582  Vali Loss: 0.0050571 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005312 --> 0.005057).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.246204376220703
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0068581  Vali Loss: 0.0055080 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.2460315227508545
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0064089  Vali Loss: 0.0055923 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.248730659484863
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0068303  Vali Loss: 0.0062882 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.254835367202759
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0068273  Vali Loss: 0.0062805 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.249141693115234
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0063836  Vali Loss: 0.0052938 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 5.246563673019409
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0061521  Vali Loss: 0.0052761 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 5.2508509159088135
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0058509  Vali Loss: 0.0052361 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 5.250591278076172
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0057753  Vali Loss: 0.0052282 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 8.685171365737915
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0059808  Vali Loss: 0.0051696 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 5.24970006942749
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0056828  Vali Loss: 0.0051418 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 5.253564119338989
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0053643  Vali Loss: 0.0051394 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 5.249951124191284
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0057828  Vali Loss: 0.0051335 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 5.251551151275635
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0056790  Vali Loss: 0.0051290 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 5.254411458969116
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0054959  Vali Loss: 0.0051284 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 5.257976293563843
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0056908  Vali Loss: 0.0051274 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8921053  Test weighted F1: 0.8653723  Test macro F1 0.8653723 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 7.056304931640625
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0064940  Vali Loss: 0.0055816 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
Validation loss decreased (inf --> 0.005582).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.891602516174316
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0062482  Vali Loss: 0.0041656 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005582 --> 0.004166).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.894747495651245
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0055452  Vali Loss: 0.0037347 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004166 --> 0.003735).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.902767658233643
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0055169  Vali Loss: 0.0039299 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.89949631690979
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0049752  Vali Loss: 0.0042775 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.899457216262817
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0039818  Vali Loss: 0.0034923 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003735 --> 0.003492).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.905522108078003
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0036797  Vali Loss: 0.0043679 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.9075927734375
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0042011  Vali Loss: 0.0031679 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003492 --> 0.003168).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.893242597579956
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0045606  Vali Loss: 0.0028593 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003168 --> 0.002859).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.897163152694702
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0039385  Vali Loss: 0.0051399 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.897071599960327
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0040282  Vali Loss: 0.0039928 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.9042887687683105
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0038752  Vali Loss: 0.0037960 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.89166259765625
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0037918  Vali Loss: 0.0028460 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002859 --> 0.002846).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.9039390087127686
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0036603  Vali Loss: 0.0034335 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.90068244934082
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0037370  Vali Loss: 0.0021535 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002846 --> 0.002153).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.902864456176758
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0036268  Vali Loss: 0.0038722 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.899590253829956
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0046790  Vali Loss: 0.0025969 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.905590057373047
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0031681  Vali Loss: 0.0021025 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002153 --> 0.002103).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.890048265457153
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0027631  Vali Loss: 0.0042834 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.8955559730529785
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0032419  Vali Loss: 0.0019535 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002103 --> 0.001954).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.8882896900177
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0025959  Vali Loss: 0.0017152 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001954 --> 0.001715).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.902761459350586
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0028962  Vali Loss: 0.0026687 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.898687362670898
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0035238  Vali Loss: 0.0023693 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.899076700210571
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0024146  Vali Loss: 0.0017089 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001715 --> 0.001709).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.886023283004761
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0023574  Vali Loss: 0.0019764 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.894912958145142
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0028587  Vali Loss: 0.0020770 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.903641223907471
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0023046  Vali Loss: 0.0022973 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.897370338439941
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0021596  Vali Loss: 0.0027453 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.906457424163818
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0025057  Vali Loss: 0.0029308 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987488  Vali macro F1 0.9988917 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 30 cost time: 6.894283294677734
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0024703  Vali Loss: 0.0025764 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.895425796508789
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0021916  Vali Loss: 0.0013419 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001709 --> 0.001342).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 6.896517753601074
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0025931  Vali Loss: 0.0020510 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.899448394775391
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0017479  Vali Loss: 0.0017450 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.900871515274048
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0018494  Vali Loss: 0.0014363 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.898548364639282
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0014583  Vali Loss: 0.0018057 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.898546934127808
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0020265  Vali Loss: 0.0017829 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 37 cost time: 6.903464317321777
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0017429  Vali Loss: 0.0017882 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.8874406814575195
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0016897  Vali Loss: 0.0018022 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.8950514793396
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0017716  Vali Loss: 0.0018722 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.896051406860352
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0020894  Vali Loss: 0.0017779 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.901537656784058
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0015487  Vali Loss: 0.0019826 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 42 cost time: 6.899492979049683
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0014073  Vali Loss: 0.0020046 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 43 cost time: 6.900794744491577
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0017647  Vali Loss: 0.0019871 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 44 cost time: 6.900325536727905
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0015334  Vali Loss: 0.0019709 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 45 cost time: 6.888593435287476
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0014178  Vali Loss: 0.0019544 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 46 cost time: 6.902276515960693
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0015859  Vali Loss: 0.0019322 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9149123  Test weighted F1: 0.9040683  Test macro F1 0.9040683 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.339407205581665
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0657400  Vali Loss: 0.7228101 Vali Accuracy: 0.8796992  Vali weighted F1: 0.8681778  Vali macro F1 0.8689174 
Validation loss decreased (inf --> 0.722810).  Saving model ...
Epoch: 2 cost time: 5.257962942123413
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4460526  Vali Loss: 0.2477650 Vali Accuracy: 0.9523810  Vali weighted F1: 0.9495462  Vali macro F1 0.9501654 
new best score!!!!
Validation loss decreased (0.722810 --> 0.247765).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.264675140380859
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1869564  Vali Loss: 0.1308687 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9727905  Vali macro F1 0.9735232 
new best score!!!!
Validation loss decreased (0.247765 --> 0.130869).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.265664100646973
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1106729  Vali Loss: 0.0866336 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808651  Vali macro F1 0.9814698 
new best score!!!!
Validation loss decreased (0.130869 --> 0.086634).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.2709574699401855
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0693157  Vali Loss: 0.0589414 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886226  Vali macro F1 0.9892569 
new best score!!!!
Validation loss decreased (0.086634 --> 0.058941).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.270305395126343
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0519633  Vali Loss: 0.0522359 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9805852  Vali macro F1 0.9811329 
new best score!!!!
Validation loss decreased (0.058941 --> 0.052236).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.2744879722595215
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0462287  Vali Loss: 0.0446385 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9834718  Vali macro F1 0.9841370 
new best score!!!!
Validation loss decreased (0.052236 --> 0.044638).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.267283201217651
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0386518  Vali Loss: 0.0369124 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898837  Vali macro F1 0.9902643 
new best score!!!!
Validation loss decreased (0.044638 --> 0.036912).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.270047426223755
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0322938  Vali Loss: 0.0322071 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899133  Vali macro F1 0.9904618 
new best score!!!!
Validation loss decreased (0.036912 --> 0.032207).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.2680370807647705
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0321182  Vali Loss: 0.0301467 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911932  Vali macro F1 0.9916094 
new best score!!!!
Validation loss decreased (0.032207 --> 0.030147).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.263542890548706
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0250495  Vali Loss: 0.0439332 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9832891  Vali macro F1 0.9838520 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.262893915176392
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0290877  Vali Loss: 0.0273138 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924597  Vali macro F1 0.9928417 
new best score!!!!
Validation loss decreased (0.030147 --> 0.027314).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.264703273773193
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0219574  Vali Loss: 0.0251295 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911599  Vali macro F1 0.9915654 
new best score!!!!
Validation loss decreased (0.027314 --> 0.025130).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.2695629596710205
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0213796  Vali Loss: 0.0218040 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924596  Vali macro F1 0.9929447 
new best score!!!!
Validation loss decreased (0.025130 --> 0.021804).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.262521743774414
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0151597  Vali Loss: 0.0185161 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924596  Vali macro F1 0.9929447 
new best score!!!!
Validation loss decreased (0.021804 --> 0.018516).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.264216423034668
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0308047  Vali Loss: 0.0379253 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885908  Vali macro F1 0.9889995 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.263353109359741
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0247726  Vali Loss: 0.0230982 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924596  Vali macro F1 0.9929447 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.260572195053101
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0137089  Vali Loss: 0.0164790 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
new best score!!!!
Validation loss decreased (0.018516 --> 0.016479).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.261238098144531
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0128019  Vali Loss: 0.0147834 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
new best score!!!!
Validation loss decreased (0.016479 --> 0.014783).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.257803678512573
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0117988  Vali Loss: 0.0171250 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.253878831863403
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0090838  Vali Loss: 0.0152974 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.2517030239105225
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0095506  Vali Loss: 0.0148047 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.251234292984009
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0075901  Vali Loss: 0.0136626 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.014783 --> 0.013663).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.255481243133545
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0069817  Vali Loss: 0.0146336 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.248992919921875
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0059264  Vali Loss: 0.0137908 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.25630784034729
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0111720  Vali Loss: 0.0227487 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.253817796707153
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0081467  Vali Loss: 0.0149356 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 5.256778955459595
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0064395  Vali Loss: 0.0133893 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974912  Vali macro F1 0.9977272 
new best score!!!!
Validation loss decreased (0.013663 --> 0.013389).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.260168075561523
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0127216  Vali Loss: 0.0144659 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.259155035018921
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0358593  Vali Loss: 0.0194830 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.2582316398620605
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0145111  Vali Loss: 0.0224447 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924378  Vali macro F1 0.9928123 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 5.2537946701049805
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0111823  Vali Loss: 0.0187732 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 5.257617712020874
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0154477  Vali Loss: 0.0151813 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 5.253450870513916
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0089670  Vali Loss: 0.0132289 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
new best score!!!!
Validation loss decreased (0.013389 --> 0.013229).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.319587707519531
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0075834  Vali Loss: 0.0133185 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.254973411560059
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0064349  Vali Loss: 0.0126153 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
new best score!!!!
Validation loss decreased (0.013229 --> 0.012615).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.2544169425964355
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0059577  Vali Loss: 0.0127456 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.254993200302124
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0062844  Vali Loss: 0.0130852 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.258421182632446
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0052011  Vali Loss: 0.0131522 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.258391618728638
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0051645  Vali Loss: 0.0132638 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.258395195007324
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0050134  Vali Loss: 0.0132524 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 5.256266832351685
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0047666  Vali Loss: 0.0132375 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.259641647338867
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0049050  Vali Loss: 0.0132977 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.256053924560547
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0050680  Vali Loss: 0.0132810 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 5.257338285446167
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0050421  Vali Loss: 0.0132331 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 5.259227275848389
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0048106  Vali Loss: 0.0133789 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 5.256626129150391
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0050057  Vali Loss: 0.0134004 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.257529973983765
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0049444  Vali Loss: 0.0133986 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 5.258429050445557
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0049011  Vali Loss: 0.0134037 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 5.256301164627075
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0044326  Vali Loss: 0.0133982 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 5.25123405456543
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0048063  Vali Loss: 0.0134028 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8517544  Test weighted F1: 0.8328197  Test macro F1 0.8328197 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.884186029434204
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0064923  Vali Loss: 0.0125611 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937087  Vali macro F1 0.9940508 
Validation loss decreased (inf --> 0.012561).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.89251446723938
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0044175  Vali Loss: 0.0107950 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
new best score!!!!
Validation loss decreased (0.012561 --> 0.010795).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.881275415420532
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0041621  Vali Loss: 0.0122452 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.876822233200073
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0039898  Vali Loss: 0.0123330 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.886679649353027
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0033353  Vali Loss: 0.0131588 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.886361122131348
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0031198  Vali Loss: 0.0120247 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.894023656845093
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0043707  Vali Loss: 0.0140743 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.892992258071899
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0032384  Vali Loss: 0.0140131 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.894211292266846
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0029630  Vali Loss: 0.0090107 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.010795 --> 0.009011).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.892426013946533
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0025304  Vali Loss: 0.0092736 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.8946967124938965
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0027442  Vali Loss: 0.0101833 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.8902976512908936
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0030055  Vali Loss: 0.0110547 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.901686668395996
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0027370  Vali Loss: 0.0099684 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.885903835296631
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0023878  Vali Loss: 0.0081840 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.009011 --> 0.008184).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.894587278366089
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0036095  Vali Loss: 0.0119995 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.9040913581848145
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0027341  Vali Loss: 0.0098644 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.8853919506073
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022509  Vali Loss: 0.0096037 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.888724327087402
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0023410  Vali Loss: 0.0088802 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.894075870513916
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0025265  Vali Loss: 0.0095383 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.900368690490723
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0020675  Vali Loss: 0.0095238 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.882427930831909
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0022813  Vali Loss: 0.0093563 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.899826526641846
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0017276  Vali Loss: 0.0090546 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.900039911270142
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0021015  Vali Loss: 0.0088751 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.8865509033203125
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0017969  Vali Loss: 0.0088489 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 6.886370897293091
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0019107  Vali Loss: 0.0088416 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.886274337768555
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018872  Vali Loss: 0.0088431 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.893406391143799
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0021672  Vali Loss: 0.0088349 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.899080038070679
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0018959  Vali Loss: 0.0088391 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.902670621871948
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0017944  Vali Loss: 0.0088365 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9087719  Test weighted F1: 0.9037881  Test macro F1 0.9037881 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.37535548210144
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0651745  Vali Loss: 0.7431244 Vali Accuracy: 0.8709273  Vali weighted F1: 0.8605423  Vali macro F1 0.8597835 
Validation loss decreased (inf --> 0.743124).  Saving model ...
Epoch: 2 cost time: 5.267692804336548
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4530772  Vali Loss: 0.2678509 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9615393  Vali macro F1 0.9631457 
new best score!!!!
Validation loss decreased (0.743124 --> 0.267851).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.267786502838135
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1987852  Vali Loss: 0.1454449 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9682591  Vali macro F1 0.9689806 
new best score!!!!
Validation loss decreased (0.267851 --> 0.145445).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.265556812286377
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1121780  Vali Loss: 0.0954756 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860367  Vali macro F1 0.9869418 
new best score!!!!
Validation loss decreased (0.145445 --> 0.095476).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.266944408416748
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0698834  Vali Loss: 0.0649542 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821249  Vali macro F1 0.9830652 
new best score!!!!
Validation loss decreased (0.095476 --> 0.064954).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.26611065864563
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0529342  Vali Loss: 0.0460626 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899928  Vali macro F1 0.9906697 
new best score!!!!
Validation loss decreased (0.064954 --> 0.046063).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.27107310295105
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0426933  Vali Loss: 0.0496839 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822848  Vali macro F1 0.9830103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.276433706283569
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0385427  Vali Loss: 0.0357272 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912266  Vali macro F1 0.9918100 
new best score!!!!
Validation loss decreased (0.046063 --> 0.035727).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.2741172313690186
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0317292  Vali Loss: 0.0288908 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962472  Vali macro F1 0.9965748 
new best score!!!!
Validation loss decreased (0.035727 --> 0.028891).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.275112152099609
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0278614  Vali Loss: 0.0307489 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924824  Vali macro F1 0.9930188 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.27660608291626
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0214895  Vali Loss: 0.0278614 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912248  Vali macro F1 0.9919568 
new best score!!!!
Validation loss decreased (0.028891 --> 0.027861).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.278873682022095
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0237662  Vali Loss: 0.0377580 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912341  Vali macro F1 0.9916944 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.275146007537842
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0223398  Vali Loss: 0.0220396 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911897  Vali macro F1 0.9917072 
new best score!!!!
Validation loss decreased (0.027861 --> 0.022040).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.270033359527588
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0191837  Vali Loss: 0.0182655 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937161  Vali macro F1 0.9942858 
new best score!!!!
Validation loss decreased (0.022040 --> 0.018266).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.275300025939941
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0150530  Vali Loss: 0.0274158 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899917  Vali macro F1 0.9906048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.269193649291992
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0158454  Vali Loss: 0.0158279 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962472  Vali macro F1 0.9965748 
new best score!!!!
Validation loss decreased (0.018266 --> 0.015828).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.266482353210449
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0257689  Vali Loss: 0.0215597 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924557  Vali macro F1 0.9925488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.2700724601745605
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0211061  Vali Loss: 0.0176256 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987512  Vali macro F1 0.9986904 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.27115535736084
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0130602  Vali Loss: 0.0120374 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962565  Vali macro F1 0.9966373 
new best score!!!!
Validation loss decreased (0.015828 --> 0.012037).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.270979642868042
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0135864  Vali Loss: 0.0208746 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949739  Vali macro F1 0.9957121 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.268477439880371
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0171704  Vali Loss: 0.0195356 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949842  Vali macro F1 0.9954809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.27073073387146
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0312203  Vali Loss: 0.0209053 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937322  Vali macro F1 0.9941321 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.267306089401245
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0137687  Vali Loss: 0.0179992 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937644  Vali macro F1 0.9940405 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.268713474273682
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0112214  Vali Loss: 0.0155626 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949919  Vali macro F1 0.9954529 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 5.267955780029297
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0081260  Vali Loss: 0.0137063 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962465  Vali macro F1 0.9967330 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.266141653060913
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0079771  Vali Loss: 0.0133878 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949929  Vali macro F1 0.9955179 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.266259670257568
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0085986  Vali Loss: 0.0138974 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937383  Vali macro F1 0.9942378 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.264160633087158
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0074498  Vali Loss: 0.0152031 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937383  Vali macro F1 0.9942378 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.268159866333008
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0075176  Vali Loss: 0.0155845 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949919  Vali macro F1 0.9954529 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 30 cost time: 5.267349004745483
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0077110  Vali Loss: 0.0154875 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949919  Vali macro F1 0.9954529 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.264071941375732
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0069929  Vali Loss: 0.0152655 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949919  Vali macro F1 0.9954529 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.267350673675537
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0073871  Vali Loss: 0.0151592 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949919  Vali macro F1 0.9954529 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.266153335571289
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0067250  Vali Loss: 0.0151584 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949919  Vali macro F1 0.9954529 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 5.267489433288574
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0071429  Vali Loss: 0.0150858 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937383  Vali macro F1 0.9942378 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7982456  Test weighted F1: 0.7550779  Test macro F1 0.7550779 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.946372985839844
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0105198  Vali Loss: 0.0109544 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949919  Vali macro F1 0.9954529 
Validation loss decreased (inf --> 0.010954).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.906411170959473
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0080620  Vali Loss: 0.0090664 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974966  Vali macro F1 0.9974103 
new best score!!!!
Validation loss decreased (0.010954 --> 0.009066).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.903346300125122
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0073192  Vali Loss: 0.0091646 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.903374910354614
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0065904  Vali Loss: 0.0078125 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974966  Vali macro F1 0.9976334 
new best score!!!!
Validation loss decreased (0.009066 --> 0.007813).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.900285959243774
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0062186  Vali Loss: 0.0111466 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962465  Vali macro F1 0.9967330 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.909833192825317
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0063082  Vali Loss: 0.0091224 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975008  Vali macro F1 0.9977899 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.90296483039856
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0059291  Vali Loss: 0.0079491 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987512  Vali macro F1 0.9986904 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.909424543380737
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0068756  Vali Loss: 0.0091915 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.902120590209961
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0057571  Vali Loss: 0.0061294 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974966  Vali macro F1 0.9976334 
new best score!!!!
Validation loss decreased (0.007813 --> 0.006129).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.903956174850464
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0055871  Vali Loss: 0.0094568 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962465  Vali macro F1 0.9967330 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.899621963500977
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0049963  Vali Loss: 0.0092153 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962565  Vali macro F1 0.9966373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.901709079742432
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0056175  Vali Loss: 0.0107351 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975008  Vali macro F1 0.9977899 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.901326894760132
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0046813  Vali Loss: 0.0058775 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987512  Vali macro F1 0.9986904 
new best score!!!!
Validation loss decreased (0.006129 --> 0.005877).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.901612043380737
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0043463  Vali Loss: 0.0058293 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987512  Vali macro F1 0.9986904 
new best score!!!!
Validation loss decreased (0.005877 --> 0.005829).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.909969806671143
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0053114  Vali Loss: 0.0071580 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.90500545501709
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0043840  Vali Loss: 0.0112624 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937991  Vali macro F1 0.9943686 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.899318218231201
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0038903  Vali Loss: 0.0089549 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975008  Vali macro F1 0.9977899 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.903921604156494
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0035669  Vali Loss: 0.0075674 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962465  Vali macro F1 0.9967330 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.905303478240967
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0034986  Vali Loss: 0.0073457 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975008  Vali macro F1 0.9977899 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 20 cost time: 6.894044637680054
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0039167  Vali Loss: 0.0072199 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.8996052742004395
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0044451  Vali Loss: 0.0068236 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962465  Vali macro F1 0.9967330 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.902421951293945
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0037698  Vali Loss: 0.0072463 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962425  Vali macro F1 0.9964177 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.898632764816284
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0039697  Vali Loss: 0.0113713 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950227  Vali macro F1 0.9953270 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.908517599105835
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0058049  Vali Loss: 0.0061778 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987512  Vali macro F1 0.9986904 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.905966758728027
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0038083  Vali Loss: 0.0047265 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005829 --> 0.004726).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.913118839263916
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0032702  Vali Loss: 0.0046117 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004726 --> 0.004612).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.900819301605225
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0036890  Vali Loss: 0.0046833 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.896923542022705
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0029483  Vali Loss: 0.0048766 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.910311460494995
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0032320  Vali Loss: 0.0050634 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.903809309005737
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0029712  Vali Loss: 0.0051373 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.906160354614258
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0031408  Vali Loss: 0.0051006 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 32 cost time: 6.910285711288452
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0032814  Vali Loss: 0.0051092 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.902586221694946
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0030727  Vali Loss: 0.0051156 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.90483021736145
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0032754  Vali Loss: 0.0051244 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.910496473312378
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0033881  Vali Loss: 0.0051434 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.907015085220337
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0029838  Vali Loss: 0.0051466 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 37 cost time: 6.90547251701355
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0030934  Vali Loss: 0.0051477 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.896947383880615
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0028497  Vali Loss: 0.0051486 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.899789571762085
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0028184  Vali Loss: 0.0051493 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.900527238845825
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0031218  Vali Loss: 0.0051516 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.902705669403076
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0036728  Vali Loss: 0.0051522 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974987  Vali macro F1 0.9974779 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8087719  Test weighted F1: 0.7669263  Test macro F1 0.7669263 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.354316473007202
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0494342  Vali Loss: 0.7344410 Vali Accuracy: 0.8759398  Vali weighted F1: 0.8660426  Vali macro F1 0.8626917 
Validation loss decreased (inf --> 0.734441).  Saving model ...
Epoch: 2 cost time: 5.284267425537109
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4445992  Vali Loss: 0.2771785 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9620454  Vali macro F1 0.9607868 
new best score!!!!
Validation loss decreased (0.734441 --> 0.277179).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.2852301597595215
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.2009206  Vali Loss: 0.1532417 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811168  Vali macro F1 0.9810792 
new best score!!!!
Validation loss decreased (0.277179 --> 0.153242).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.288146257400513
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1208139  Vali Loss: 0.0942800 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874033  Vali macro F1 0.9882945 
new best score!!!!
Validation loss decreased (0.153242 --> 0.094280).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.289153337478638
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0735967  Vali Loss: 0.0662512 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873208  Vali macro F1 0.9880933 
new best score!!!!
Validation loss decreased (0.094280 --> 0.066251).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.293943405151367
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0537312  Vali Loss: 0.0552968 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912951  Vali macro F1 0.9915784 
new best score!!!!
Validation loss decreased (0.066251 --> 0.055297).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.2894110679626465
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0421199  Vali Loss: 0.0388929 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924802  Vali macro F1 0.9925554 
new best score!!!!
Validation loss decreased (0.055297 --> 0.038893).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.291421890258789
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0340434  Vali Loss: 0.0300522 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912501  Vali macro F1 0.9917246 
new best score!!!!
Validation loss decreased (0.038893 --> 0.030052).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.290576219558716
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0367668  Vali Loss: 0.0348805 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886939  Vali macro F1 0.9890329 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.289068222045898
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0317845  Vali Loss: 0.0347663 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900206  Vali macro F1 0.9906323 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.287367820739746
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0241114  Vali Loss: 0.0226889 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949785  Vali macro F1 0.9952322 
new best score!!!!
Validation loss decreased (0.030052 --> 0.022689).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.282433271408081
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0221596  Vali Loss: 0.0354317 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937836  Vali macro F1 0.9940907 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.278646230697632
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0234917  Vali Loss: 0.0282602 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899456  Vali macro F1 0.9903864 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.280476808547974
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0205524  Vali Loss: 0.0199165 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937318  Vali macro F1 0.9935999 
new best score!!!!
Validation loss decreased (0.022689 --> 0.019916).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.2811644077301025
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0161641  Vali Loss: 0.0183409 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937265  Vali macro F1 0.9936555 
new best score!!!!
Validation loss decreased (0.019916 --> 0.018341).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.283190727233887
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0127575  Vali Loss: 0.0116270 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
new best score!!!!
Validation loss decreased (0.018341 --> 0.011627).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.284108638763428
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0175265  Vali Loss: 0.0189494 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950227  Vali macro F1 0.9953270 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.2861247062683105
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0131136  Vali Loss: 0.0148003 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.27903413772583
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0128875  Vali Loss: 0.0107748 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.011627 --> 0.010775).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.283704996109009
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0167249  Vali Loss: 0.0215876 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949694  Vali macro F1 0.9949061 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.281944513320923
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0169926  Vali Loss: 0.0175798 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937319  Vali macro F1 0.9938229 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.279531717300415
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0113838  Vali Loss: 0.0200561 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924903  Vali macro F1 0.9925505 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.280097007751465
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0102972  Vali Loss: 0.0184397 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912522  Vali macro F1 0.9915319 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.281965017318726
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0107203  Vali Loss: 0.0100358 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.010775 --> 0.010036).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.283154487609863
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0105415  Vali Loss: 0.0095996 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974913  Vali macro F1 0.9975042 
new best score!!!!
Validation loss decreased (0.010036 --> 0.009600).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.278153419494629
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0077866  Vali Loss: 0.0099788 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974929  Vali macro F1 0.9975074 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.280998706817627
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0076582  Vali Loss: 0.0070187 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974913  Vali macro F1 0.9975042 
new best score!!!!
Validation loss decreased (0.009600 --> 0.007019).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.281747817993164
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0077004  Vali Loss: 0.0135827 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.276374340057373
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0273268  Vali Loss: 0.0722561 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9784570  Vali macro F1 0.9787291 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.2805705070495605
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0414523  Vali Loss: 0.0293016 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911438  Vali macro F1 0.9914495 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.280815124511719
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0242398  Vali Loss: 0.0132570 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987447  Vali macro F1 0.9988845 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.2821478843688965
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0119451  Vali Loss: 0.0090975 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 5.279033422470093
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0093283  Vali Loss: 0.0085274 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987460  Vali macro F1 0.9987719 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.279067277908325
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0071670  Vali Loss: 0.0082258 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987460  Vali macro F1 0.9987719 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.278069734573364
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0067085  Vali Loss: 0.0079192 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987460  Vali macro F1 0.9987719 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.276096343994141
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0062848  Vali Loss: 0.0077119 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.279599666595459
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0060481  Vali Loss: 0.0074098 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 5.277511119842529
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0057486  Vali Loss: 0.0073803 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.2812042236328125
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0054252  Vali Loss: 0.0073886 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.280187368392944
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0053679  Vali Loss: 0.0073598 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.279385805130005
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0058809  Vali Loss: 0.0073423 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.280468940734863
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0057754  Vali Loss: 0.0073438 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8394737  Test weighted F1: 0.7986181  Test macro F1 0.7986181 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.889906644821167
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0061201  Vali Loss: 0.0069254 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
Validation loss decreased (inf --> 0.006925).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.887823820114136
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0044966  Vali Loss: 0.0045994 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
new best score!!!!
Validation loss decreased (0.006925 --> 0.004599).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.889050245285034
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0040270  Vali Loss: 0.0047201 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.893803119659424
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0035278  Vali Loss: 0.0048213 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.894184589385986
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0035812  Vali Loss: 0.0047612 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.903346300125122
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0038116  Vali Loss: 0.0060235 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.896980047225952
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0045768  Vali Loss: 0.0059603 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.9070751667022705
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0031364  Vali Loss: 0.0047663 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.899581432342529
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0025781  Vali Loss: 0.0057213 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.903286933898926
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0023995  Vali Loss: 0.0060988 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.901254415512085
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0024869  Vali Loss: 0.0048335 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.902560234069824
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0023766  Vali Loss: 0.0038887 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.004599 --> 0.003889).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.89071798324585
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0024604  Vali Loss: 0.0052624 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.904572486877441
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0027841  Vali Loss: 0.0060049 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.899686336517334
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0019635  Vali Loss: 0.0040198 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.892266035079956
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0024487  Vali Loss: 0.0051203 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.8979856967926025
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0024026  Vali Loss: 0.0043558 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974913  Vali macro F1 0.9975042 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.903303623199463
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0023416  Vali Loss: 0.0043831 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974913  Vali macro F1 0.9975042 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.899187088012695
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0027800  Vali Loss: 0.0042538 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.903648614883423
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0018790  Vali Loss: 0.0039955 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.937469244003296
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0020369  Vali Loss: 0.0040145 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.908716678619385
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0020509  Vali Loss: 0.0040350 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.906959295272827
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0020151  Vali Loss: 0.0040301 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.898444175720215
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0015869  Vali Loss: 0.0040245 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.907329559326172
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0019540  Vali Loss: 0.0040311 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.9031665325164795
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018699  Vali Loss: 0.0040217 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.895727634429932
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0018055  Vali Loss: 0.0040055 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8385965  Test weighted F1: 0.7961833  Test macro F1 0.7961833 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.368014097213745
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0670915  Vali Loss: 0.7294122 Vali Accuracy: 0.8759398  Vali weighted F1: 0.8652364  Vali macro F1 0.8647638 
Validation loss decreased (inf --> 0.729412).  Saving model ...
Epoch: 2 cost time: 5.262493848800659
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4593208  Vali Loss: 0.2573570 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9609636  Vali macro F1 0.9623614 
new best score!!!!
Validation loss decreased (0.729412 --> 0.257357).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.262606620788574
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1957782  Vali Loss: 0.1334748 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9768812  Vali macro F1 0.9781101 
new best score!!!!
Validation loss decreased (0.257357 --> 0.133475).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.2665863037109375
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1164191  Vali Loss: 0.0920546 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9780699  Vali macro F1 0.9789060 
new best score!!!!
Validation loss decreased (0.133475 --> 0.092055).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.265192985534668
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0768002  Vali Loss: 0.0737648 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9793333  Vali macro F1 0.9799671 
new best score!!!!
Validation loss decreased (0.092055 --> 0.073765).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.268840789794922
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0585411  Vali Loss: 0.0545450 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872882  Vali macro F1 0.9877235 
new best score!!!!
Validation loss decreased (0.073765 --> 0.054545).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.265861511230469
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0459506  Vali Loss: 0.0458274 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9831831  Vali macro F1 0.9835676 
new best score!!!!
Validation loss decreased (0.054545 --> 0.045827).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.267540693283081
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0372213  Vali Loss: 0.0521167 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9805568  Vali macro F1 0.9810470 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.270809888839722
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0329832  Vali Loss: 0.0336282 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924146  Vali macro F1 0.9926225 
new best score!!!!
Validation loss decreased (0.045827 --> 0.033628).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.263841867446899
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0272450  Vali Loss: 0.0281513 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912327  Vali macro F1 0.9915126 
new best score!!!!
Validation loss decreased (0.033628 --> 0.028151).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.264033079147339
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0275375  Vali Loss: 0.0289129 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911288  Vali macro F1 0.9913663 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.258469581604004
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0357772  Vali Loss: 0.0317788 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911288  Vali macro F1 0.9913663 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.263970136642456
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0254880  Vali Loss: 0.0227907 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.028151 --> 0.022791).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.26276707649231
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0170626  Vali Loss: 0.0260246 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.262255668640137
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0155595  Vali Loss: 0.0203779 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
new best score!!!!
Validation loss decreased (0.022791 --> 0.020378).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.263753890991211
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0137692  Vali Loss: 0.0233391 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.261817216873169
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0127237  Vali Loss: 0.0234866 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924146  Vali macro F1 0.9926225 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 5.263185501098633
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0134481  Vali Loss: 0.0192998 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.020378 --> 0.019300).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 5.263355731964111
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0172977  Vali Loss: 0.0322205 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898496  Vali macro F1 0.9902788 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 5.261028528213501
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0263996  Vali Loss: 0.0232892 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 5.261170148849487
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0132900  Vali Loss: 0.0171117 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.019300 --> 0.017112).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.26399040222168
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0170459  Vali Loss: 0.0220585 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 5.259333848953247
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0158429  Vali Loss: 0.0206329 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.260457992553711
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0112256  Vali Loss: 0.0183434 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 5.260550260543823
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0089446  Vali Loss: 0.0130672 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937143  Vali macro F1 0.9938988 
new best score!!!!
Validation loss decreased (0.017112 --> 0.013067).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.261896848678589
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0080508  Vali Loss: 0.0267221 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.262751579284668
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0123940  Vali Loss: 0.0347776 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862155  Vali macro F1 0.9866909 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.2574028968811035
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0204963  Vali Loss: 0.0166236 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.2511138916015625
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0122466  Vali Loss: 0.0156949 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.254784345626831
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0125742  Vali Loss: 0.0179698 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 5.247092962265015
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0083464  Vali Loss: 0.0161601 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.242808818817139
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0086678  Vali Loss: 0.0157798 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.239590883255005
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0076154  Vali Loss: 0.0161754 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.243984937667847
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0067918  Vali Loss: 0.0156952 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.23907470703125
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0064052  Vali Loss: 0.0167550 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 36 cost time: 5.243013143539429
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0057160  Vali Loss: 0.0167257 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.242831707000732
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0056966  Vali Loss: 0.0164788 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.244739532470703
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0059177  Vali Loss: 0.0164034 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.243386268615723
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0056422  Vali Loss: 0.0162776 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 5.238264083862305
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0056277  Vali Loss: 0.0163385 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9570175  Test weighted F1: 0.9558038  Test macro F1 0.9558038 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.803619384765625
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0059067  Vali Loss: 0.0150749 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
Validation loss decreased (inf --> 0.015075).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.798235893249512
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0056512  Vali Loss: 0.0125887 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.015075 --> 0.012589).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.805078029632568
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0047070  Vali Loss: 0.0137672 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.802186489105225
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0067222  Vali Loss: 0.0145427 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.813303709030151
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0077653  Vali Loss: 0.0117579 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.012589 --> 0.011758).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.8158533573150635
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0047105  Vali Loss: 0.0130277 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949740  Vali macro F1 0.9952822 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.822878122329712
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0039125  Vali Loss: 0.0131137 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.821231365203857
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0039136  Vali Loss: 0.0119328 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.817677021026611
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0040345  Vali Loss: 0.0118766 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.8207621574401855
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0036024  Vali Loss: 0.0111449 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.011758 --> 0.011145).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.818557262420654
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0034309  Vali Loss: 0.0125331 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.823956727981567
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0036014  Vali Loss: 0.0109369 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.011145 --> 0.010937).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.823168039321899
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0029363  Vali Loss: 0.0123120 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.8195881843566895
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0034602  Vali Loss: 0.0103228 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.010937 --> 0.010323).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.822013854980469
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0033303  Vali Loss: 0.0140900 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.820974111557007
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0029631  Vali Loss: 0.0125218 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.820842504501343
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0033707  Vali Loss: 0.0120949 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.819497108459473
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0032206  Vali Loss: 0.0125452 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.8238513469696045
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0032197  Vali Loss: 0.0128766 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 20 cost time: 6.818993806838989
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0023569  Vali Loss: 0.0121020 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.8274407386779785
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0025455  Vali Loss: 0.0121092 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.822268009185791
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0028163  Vali Loss: 0.0106458 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.8238091468811035
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0023378  Vali Loss: 0.0106559 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.818670988082886
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0020542  Vali Loss: 0.0122103 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.817386865615845
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0021800  Vali Loss: 0.0112315 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.823059558868408
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025145  Vali Loss: 0.0128293 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.815680265426636
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0021290  Vali Loss: 0.0117963 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.815686225891113
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0022712  Vali Loss: 0.0108821 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.821019887924194
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0019642  Vali Loss: 0.0108918 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9438596  Test weighted F1: 0.9427473  Test macro F1 0.9427473 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.3718581199646
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0932959  Vali Loss: 0.7760983 Vali Accuracy: 0.8546366  Vali weighted F1: 0.8438243  Vali macro F1 0.8415980 
Validation loss decreased (inf --> 0.776098).  Saving model ...
Epoch: 2 cost time: 5.264692783355713
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4534584  Vali Loss: 0.2504025 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9605469  Vali macro F1 0.9608679 
new best score!!!!
Validation loss decreased (0.776098 --> 0.250402).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.268275260925293
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1816259  Vali Loss: 0.1364166 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836654  Vali macro F1 0.9843508 
new best score!!!!
Validation loss decreased (0.250402 --> 0.136417).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.2637574672698975
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1017019  Vali Loss: 0.0986006 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874570  Vali macro F1 0.9882492 
new best score!!!!
Validation loss decreased (0.136417 --> 0.098601).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.271209478378296
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0979268  Vali Loss: 0.0731661 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860775  Vali macro F1 0.9871657 
new best score!!!!
Validation loss decreased (0.098601 --> 0.073166).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.275567293167114
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0569252  Vali Loss: 0.0502696 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888180  Vali macro F1 0.9894849 
new best score!!!!
Validation loss decreased (0.073166 --> 0.050270).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.271406650543213
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0414253  Vali Loss: 0.0412370 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886965  Vali macro F1 0.9889708 
new best score!!!!
Validation loss decreased (0.050270 --> 0.041237).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.272842645645142
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0347458  Vali Loss: 0.0414331 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873886  Vali macro F1 0.9881130 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.264882564544678
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0416766  Vali Loss: 0.0343160 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924802  Vali macro F1 0.9925554 
new best score!!!!
Validation loss decreased (0.041237 --> 0.034316).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.26885986328125
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0298188  Vali Loss: 0.0267998 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937370  Vali macro F1 0.9942989 
new best score!!!!
Validation loss decreased (0.034316 --> 0.026800).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.267671346664429
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0211833  Vali Loss: 0.0243310 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937370  Vali macro F1 0.9942989 
new best score!!!!
Validation loss decreased (0.026800 --> 0.024331).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.2641990184783936
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0195090  Vali Loss: 0.0255648 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913154  Vali macro F1 0.9913328 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.268495798110962
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0187054  Vali Loss: 0.0274100 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911897  Vali macro F1 0.9917072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 5.268421173095703
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0193997  Vali Loss: 0.0258073 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899599  Vali macro F1 0.9905657 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 5.2730302810668945
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0175948  Vali Loss: 0.0258195 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924596  Vali macro F1 0.9929447 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 16 cost time: 5.270232915878296
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0130952  Vali Loss: 0.0183693 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962384  Vali macro F1 0.9964567 
new best score!!!!
Validation loss decreased (0.024331 --> 0.018369).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.268611669540405
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0192970  Vali Loss: 0.0216138 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924570  Vali macro F1 0.9930621 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.267822027206421
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0133464  Vali Loss: 0.0222480 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.2679383754730225
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0129454  Vali Loss: 0.0146124 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937319  Vali macro F1 0.9938229 
new best score!!!!
Validation loss decreased (0.018369 --> 0.014612).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.26706600189209
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0106131  Vali Loss: 0.0205023 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924720  Vali macro F1 0.9925984 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.264444828033447
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0126832  Vali Loss: 0.0176044 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937257  Vali macro F1 0.9940217 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.266433000564575
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0190539  Vali Loss: 0.0215113 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962465  Vali macro F1 0.9967330 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.267511606216431
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0120952  Vali Loss: 0.0176070 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974960  Vali macro F1 0.9976812 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.268156290054321
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0098998  Vali Loss: 0.0136605 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
new best score!!!!
Validation loss decreased (0.014612 --> 0.013660).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.264294862747192
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0088711  Vali Loss: 0.0150009 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.265505790710449
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0071469  Vali Loss: 0.0167254 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949839  Vali macro F1 0.9953996 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.26194953918457
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0074713  Vali Loss: 0.0204584 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924720  Vali macro F1 0.9925984 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.269239664077759
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0093959  Vali Loss: 0.0178751 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899989  Vali macro F1 0.9901628 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.264186143875122
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0084885  Vali Loss: 0.0116603 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
new best score!!!!
Validation loss decreased (0.013660 --> 0.011660).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.26502799987793
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0067513  Vali Loss: 0.0200390 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937475  Vali macro F1 0.9942036 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.267840623855591
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0129500  Vali Loss: 0.0237297 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924196  Vali macro F1 0.9925182 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.265039682388306
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0138844  Vali Loss: 0.0251619 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887289  Vali macro F1 0.9893159 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.26508355140686
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0253994  Vali Loss: 0.0363474 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862425  Vali macro F1 0.9867740 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 5.266479015350342
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0135881  Vali Loss: 0.0209525 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925139  Vali macro F1 0.9930460 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 5.262387752532959
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0095374  Vali Loss: 0.0188900 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925170  Vali macro F1 0.9926875 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.266660213470459
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0081108  Vali Loss: 0.0172866 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912619  Vali macro F1 0.9914693 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.2651355266571045
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0074624  Vali Loss: 0.0163727 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937501  Vali macro F1 0.9937740 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 5.265502214431763
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0065871  Vali Loss: 0.0149985 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937501  Vali macro F1 0.9937740 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 5.26405930519104
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0057359  Vali Loss: 0.0140405 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950037  Vali macro F1 0.9949892 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 5.264679193496704
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0054422  Vali Loss: 0.0140544 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950037  Vali macro F1 0.9949892 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.266467094421387
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0051361  Vali Loss: 0.0139382 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950037  Vali macro F1 0.9949892 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 7.174580335617065
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0054537  Vali Loss: 0.0137892 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950037  Vali macro F1 0.9949892 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.268845319747925
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0051160  Vali Loss: 0.0137304 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950037  Vali macro F1 0.9949892 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.2625720500946045
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0050638  Vali Loss: 0.0137349 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950037  Vali macro F1 0.9949892 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8754386  Test weighted F1: 0.8417513  Test macro F1 0.8417513 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.834265470504761
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0059711  Vali Loss: 0.0116440 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
Validation loss decreased (inf --> 0.011644).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.832627296447754
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0049830  Vali Loss: 0.0151542 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950012  Vali macro F1 0.9956372 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.830288648605347
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0041212  Vali Loss: 0.0115483 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
new best score!!!!
Validation loss decreased (0.011644 --> 0.011548).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.837066411972046
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0036297  Vali Loss: 0.0122689 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962557  Vali macro F1 0.9965659 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.841497421264648
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0036585  Vali Loss: 0.0118057 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.842919111251831
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0032138  Vali Loss: 0.0128796 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9967179 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.845461130142212
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0029860  Vali Loss: 0.0179253 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937906  Vali macro F1 0.9943970 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.844368934631348
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0026688  Vali Loss: 0.0122923 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962557  Vali macro F1 0.9965659 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.841127395629883
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0024383  Vali Loss: 0.0139427 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962557  Vali macro F1 0.9965659 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.846195459365845
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0024748  Vali Loss: 0.0122012 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962557  Vali macro F1 0.9965659 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.841586351394653
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0025744  Vali Loss: 0.0129944 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962557  Vali macro F1 0.9965659 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.840924501419067
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0031719  Vali Loss: 0.0109123 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962557  Vali macro F1 0.9965659 
new best score!!!!
Validation loss decreased (0.011548 --> 0.010912).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.842457056045532
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0031600  Vali Loss: 0.0122167 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949807  Vali macro F1 0.9954836 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.84429144859314
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0043119  Vali Loss: 0.0166228 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950221  Vali macro F1 0.9954788 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.838222503662109
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0027557  Vali Loss: 0.0104732 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
new best score!!!!
Validation loss decreased (0.010912 --> 0.010473).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.847195148468018
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0021197  Vali Loss: 0.0101710 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
new best score!!!!
Validation loss decreased (0.010473 --> 0.010171).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.847779989242554
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0033428  Vali Loss: 0.0114758 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.839657545089722
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0020853  Vali Loss: 0.0127384 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.839692115783691
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0025556  Vali Loss: 0.0124896 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.837677001953125
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0021165  Vali Loss: 0.0124097 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.84286904335022
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0019281  Vali Loss: 0.0119409 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 6.842793226242065
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0018251  Vali Loss: 0.0119005 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.835887432098389
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0020151  Vali Loss: 0.0118622 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.842013120651245
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0016893  Vali Loss: 0.0118449 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.838778018951416
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0017397  Vali Loss: 0.0118219 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.838071346282959
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0018713  Vali Loss: 0.0117808 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 6.838151693344116
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0019486  Vali Loss: 0.0117645 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.840290784835815
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0019067  Vali Loss: 0.0117586 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.8412981033325195
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0019063  Vali Loss: 0.0117887 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.8440399169921875
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0020175  Vali Loss: 0.0118045 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.8453240394592285
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0020172  Vali Loss: 0.0118148 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9298246  Test weighted F1: 0.9113364  Test macro F1 0.9113364 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.333447456359863
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.0554844  Vali Loss: 0.6751052 Vali Accuracy: 0.9035088  Vali weighted F1: 0.8943400  Vali macro F1 0.8921976 
Validation loss decreased (inf --> 0.675105).  Saving model ...
Epoch: 2 cost time: 5.259078025817871
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4377044  Vali Loss: 0.2381385 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9567803  Vali macro F1 0.9553536 
new best score!!!!
Validation loss decreased (0.675105 --> 0.238139).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.253696441650391
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1838479  Vali Loss: 0.1294239 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9783983  Vali macro F1 0.9785321 
new best score!!!!
Validation loss decreased (0.238139 --> 0.129424).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.260706424713135
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0993478  Vali Loss: 0.0757299 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872772  Vali macro F1 0.9877687 
new best score!!!!
Validation loss decreased (0.129424 --> 0.075730).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.258462190628052
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0667652  Vali Loss: 0.0543168 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911350  Vali macro F1 0.9917787 
new best score!!!!
Validation loss decreased (0.075730 --> 0.054317).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.2578370571136475
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0490411  Vali Loss: 0.0390971 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924829  Vali macro F1 0.9923393 
new best score!!!!
Validation loss decreased (0.054317 --> 0.039097).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.253310203552246
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0357636  Vali Loss: 0.0309208 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962318  Vali macro F1 0.9965655 
new best score!!!!
Validation loss decreased (0.039097 --> 0.030921).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.252399921417236
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0289823  Vali Loss: 0.0277761 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937157  Vali macro F1 0.9940272 
new best score!!!!
Validation loss decreased (0.030921 --> 0.027776).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.25201416015625
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0217333  Vali Loss: 0.0206682 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.027776 --> 0.020668).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.252094745635986
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0192690  Vali Loss: 0.0202578 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.020668 --> 0.020258).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.257460594177246
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0207366  Vali Loss: 0.0289602 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911657  Vali macro F1 0.9913130 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.255690336227417
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0183824  Vali Loss: 0.0151506 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
new best score!!!!
Validation loss decreased (0.020258 --> 0.015151).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.253220558166504
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0155839  Vali Loss: 0.0172169 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.25962495803833
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0129175  Vali Loss: 0.0160099 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949913  Vali macro F1 0.9953558 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.25738525390625
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0114685  Vali Loss: 0.0143527 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
new best score!!!!
Validation loss decreased (0.015151 --> 0.014353).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.255447864532471
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0167601  Vali Loss: 0.0128378 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.014353 --> 0.012838).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.253651857376099
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0091290  Vali Loss: 0.0119729 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
new best score!!!!
Validation loss decreased (0.012838 --> 0.011973).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.252411603927612
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0081164  Vali Loss: 0.0126401 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.2493064403533936
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0115106  Vali Loss: 0.0209764 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976762 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.249866485595703
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0149336  Vali Loss: 0.0164702 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.256428241729736
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0137004  Vali Loss: 0.0273830 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962438  Vali macro F1 0.9965247 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.251363277435303
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0126536  Vali Loss: 0.0128501 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 5.253639221191406
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0071176  Vali Loss: 0.0113417 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
new best score!!!!
Validation loss decreased (0.011973 --> 0.011342).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.252933979034424
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0056543  Vali Loss: 0.0111235 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
new best score!!!!
Validation loss decreased (0.011342 --> 0.011123).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.2520129680633545
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0056137  Vali Loss: 0.0114317 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.249709367752075
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0049880  Vali Loss: 0.0107885 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
new best score!!!!
Validation loss decreased (0.011123 --> 0.010789).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.25210976600647
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0046260  Vali Loss: 0.0110169 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.2546281814575195
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0045704  Vali Loss: 0.0114760 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.251437664031982
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0051343  Vali Loss: 0.0101351 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
new best score!!!!
Validation loss decreased (0.010789 --> 0.010135).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.254163980484009
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0047739  Vali Loss: 0.0104170 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.245203256607056
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0041897  Vali Loss: 0.0103567 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.249587774276733
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0044660  Vali Loss: 0.0104151 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.2482969760894775
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0040236  Vali Loss: 0.0109769 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 5.2505364418029785
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0044996  Vali Loss: 0.0098669 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.010135 --> 0.009867).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.252463102340698
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0037395  Vali Loss: 0.0092940 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
new best score!!!!
Validation loss decreased (0.009867 --> 0.009294).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.25089168548584
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0034324  Vali Loss: 0.0096776 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.2512266635894775
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0032768  Vali Loss: 0.0096582 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.249628305435181
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0033419  Vali Loss: 0.0091763 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
new best score!!!!
Validation loss decreased (0.009294 --> 0.009176).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.250543117523193
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0031945  Vali Loss: 0.0096475 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 5.247194766998291
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0030704  Vali Loss: 0.0095877 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 5.252204418182373
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0029611  Vali Loss: 0.0093810 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 5.25726580619812
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0029820  Vali Loss: 0.0096445 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 5.249868869781494
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0032366  Vali Loss: 0.0098160 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 5.246335029602051
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0028833  Vali Loss: 0.0097299 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 5.248351097106934
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0028362  Vali Loss: 0.0097097 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 5.24772310256958
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0028130  Vali Loss: 0.0096955 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 5.245703220367432
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0027916  Vali Loss: 0.0096534 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 5.250293970108032
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0027224  Vali Loss: 0.0096480 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 5.250879526138306
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0027626  Vali Loss: 0.0096379 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.2553935050964355
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0028315  Vali Loss: 0.0096337 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.250857353210449
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0028109  Vali Loss: 0.0096322 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.25298810005188
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0027224  Vali Loss: 0.0096301 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.2572643756866455
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0028854  Vali Loss: 0.0096265 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7824561  Test weighted F1: 0.7403713  Test macro F1 0.7403713 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.844480752944946
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0029196  Vali Loss: 0.0119471 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
Validation loss decreased (inf --> 0.011947).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.838878154754639
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0029331  Vali Loss: 0.0100443 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
new best score!!!!
Validation loss decreased (0.011947 --> 0.010044).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.8423237800598145
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0025490  Vali Loss: 0.0087294 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.010044 --> 0.008729).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.839291572570801
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0019404  Vali Loss: 0.0092237 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974957  Vali macro F1 0.9975892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.842538118362427
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0015416  Vali Loss: 0.0082484 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.008729 --> 0.008248).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.841281414031982
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0013820  Vali Loss: 0.0084007 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.838561773300171
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0013020  Vali Loss: 0.0084439 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.843423128128052
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0011809  Vali Loss: 0.0092405 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.839749097824097
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0040565  Vali Loss: 0.0108077 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.842789173126221
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0030329  Vali Loss: 0.0086262 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.8390953540802
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0011117  Vali Loss: 0.0087192 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.840519666671753
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0009395  Vali Loss: 0.0076488 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
new best score!!!!
Validation loss decreased (0.008248 --> 0.007649).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.842499256134033
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0008275  Vali Loss: 0.0086054 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.836982011795044
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0020309  Vali Loss: 0.0077479 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.841082334518433
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0009580  Vali Loss: 0.0088168 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.84852933883667
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0010868  Vali Loss: 0.0086286 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.8387956619262695
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0007782  Vali Loss: 0.0086101 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.840564250946045
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0006797  Vali Loss: 0.0086568 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.843057870864868
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0006459  Vali Loss: 0.0086928 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.843863010406494
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0006658  Vali Loss: 0.0087618 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.9972944259643555
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0006600  Vali Loss: 0.0088074 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.836781024932861
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0008438  Vali Loss: 0.0088853 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.835562467575073
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0006982  Vali Loss: 0.0088928 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.839574813842773
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0006537  Vali Loss: 0.0088921 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.839717864990234
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0008063  Vali Loss: 0.0088987 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.842828750610352
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0005891  Vali Loss: 0.0089027 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.8465354442596436
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0006210  Vali Loss: 0.0089099 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974970  Vali macro F1 0.9974747 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8114035  Test weighted F1: 0.7782917  Test macro F1 0.7782917 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 913548
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.3037683963775635
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8470253  Vali Loss: 0.6575865 Vali Accuracy: 0.8947368  Vali weighted F1: 0.8920405  Vali macro F1 0.8920773 
Validation loss decreased (inf --> 0.657586).  Saving model ...
Epoch: 2 cost time: 5.22761082649231
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4459491  Vali Loss: 0.2387196 Vali Accuracy: 0.9486216  Vali weighted F1: 0.9472660  Vali macro F1 0.9468353 
new best score!!!!
Validation loss decreased (0.657586 --> 0.238720).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.235713481903076
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.2051402  Vali Loss: 0.1413366 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9766916  Vali macro F1 0.9749871 
new best score!!!!
Validation loss decreased (0.238720 --> 0.141337).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.2369420528411865
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1171774  Vali Loss: 0.0872590 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851138  Vali macro F1 0.9840766 
new best score!!!!
Validation loss decreased (0.141337 --> 0.087259).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.240746021270752
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0776779  Vali Loss: 0.0770081 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887306  Vali macro F1 0.9878103 
new best score!!!!
Validation loss decreased (0.087259 --> 0.077008).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.2455058097839355
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0616601  Vali Loss: 0.0679376 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876192  Vali macro F1 0.9865296 
new best score!!!!
Validation loss decreased (0.077008 --> 0.067938).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.247330188751221
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0465974  Vali Loss: 0.0539061 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875725  Vali macro F1 0.9871826 
new best score!!!!
Validation loss decreased (0.067938 --> 0.053906).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.252831220626831
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0388474  Vali Loss: 0.0481761 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900692  Vali macro F1 0.9890605 
new best score!!!!
Validation loss decreased (0.053906 --> 0.048176).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.255639553070068
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0302276  Vali Loss: 0.0405763 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913225  Vali macro F1 0.9906351 
new best score!!!!
Validation loss decreased (0.048176 --> 0.040576).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.270512580871582
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0268073  Vali Loss: 0.0329217 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925512  Vali macro F1 0.9918848 
new best score!!!!
Validation loss decreased (0.040576 --> 0.032922).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.262287855148315
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0277426  Vali Loss: 0.0337504 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.262718200683594
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0228540  Vali Loss: 0.0250733 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.032922 --> 0.025073).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.2626426219940186
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0196359  Vali Loss: 0.0264531 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.26578688621521
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0184035  Vali Loss: 0.0270712 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 5.266029357910156
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0173569  Vali Loss: 0.0313381 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913225  Vali macro F1 0.9906351 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 5.264761686325073
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0220665  Vali Loss: 0.0416191 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888545  Vali macro F1 0.9877302 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 17 cost time: 5.265869140625
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0240809  Vali Loss: 0.0223184 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937799  Vali macro F1 0.9931993 
new best score!!!!
Validation loss decreased (0.025073 --> 0.022318).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.270795106887817
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0176751  Vali Loss: 0.0248009 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.263840436935425
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0133313  Vali Loss: 0.0227773 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.26509690284729
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0186345  Vali Loss: 0.0241634 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913171  Vali macro F1 0.9904837 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.264426946640015
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0197745  Vali Loss: 0.0136454 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.022318 --> 0.013645).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.2633056640625
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0130803  Vali Loss: 0.0120411 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.013645 --> 0.012041).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.264544248580933
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0151423  Vali Loss: 0.0140036 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.268407106399536
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0105834  Vali Loss: 0.0108812 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
new best score!!!!
Validation loss decreased (0.012041 --> 0.010881).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.26410174369812
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0076098  Vali Loss: 0.0134756 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.265673875808716
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0088652  Vali Loss: 0.0106494 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.010881 --> 0.010649).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.263447046279907
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0097851  Vali Loss: 0.0118654 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.26592493057251
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0107254  Vali Loss: 0.0130453 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937799  Vali macro F1 0.9931993 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.26324462890625
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0081663  Vali Loss: 0.0070880 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.010649 --> 0.007088).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.263619422912598
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0118738  Vali Loss: 0.0297508 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925527  Vali macro F1 0.9916333 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.259311199188232
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0088719  Vali Loss: 0.0071876 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.2645039558410645
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0062484  Vali Loss: 0.0055616 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007088 --> 0.005562).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.26262354850769
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0073346  Vali Loss: 0.0060940 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.262817859649658
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0062919  Vali Loss: 0.0068260 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.259973526000977
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0056776  Vali Loss: 0.0121178 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.261218786239624
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0063551  Vali Loss: 0.0147653 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.264864206314087
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0113951  Vali Loss: 0.0118773 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 5.26373028755188
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0083147  Vali Loss: 0.0089826 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.264153003692627
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0067983  Vali Loss: 0.0064364 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.27049708366394
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0056973  Vali Loss: 0.0055457 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005562 --> 0.005546).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.2627410888671875
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0051217  Vali Loss: 0.0049102 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.005546 --> 0.004910).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 5.265382289886475
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0065268  Vali Loss: 0.0046773 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004910 --> 0.004677).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.263684272766113
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0047877  Vali Loss: 0.0045073 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004677 --> 0.004507).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.265177965164185
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0039085  Vali Loss: 0.0042643 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004507 --> 0.004264).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 5.261260986328125
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0038343  Vali Loss: 0.0040695 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004264 --> 0.004069).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 5.262725830078125
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0036970  Vali Loss: 0.0039740 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004069 --> 0.003974).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.261602401733398
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0036994  Vali Loss: 0.0039208 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003974 --> 0.003921).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 5.260988235473633
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0034895  Vali Loss: 0.0038107 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003921 --> 0.003811).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 5.26037859916687
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0033213  Vali Loss: 0.0036758 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003811 --> 0.003676).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 5.260567665100098
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0036351  Vali Loss: 0.0035327 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003676 --> 0.003533).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 5.263096570968628
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0033914  Vali Loss: 0.0036508 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 5.25922155380249
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0032247  Vali Loss: 0.0035463 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 5.260194778442383
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0030328  Vali Loss: 0.0034211 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003533 --> 0.003421).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 7.848806381225586
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0032728  Vali Loss: 0.0033356 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003421 --> 0.003336).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 5.25925612449646
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0026480  Vali Loss: 0.0033590 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 5.257144927978516
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0026742  Vali Loss: 0.0033456 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 5.255447149276733
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0027561  Vali Loss: 0.0033760 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 5.258814334869385
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0024598  Vali Loss: 0.0032748 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003336 --> 0.003275).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 5.2589945793151855
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0030624  Vali Loss: 0.0032801 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 5.261141777038574
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0024309  Vali Loss: 0.0032397 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003275 --> 0.003240).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 5.260196208953857
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0027569  Vali Loss: 0.0031567 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003240 --> 0.003157).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 5.2618701457977295
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0026193  Vali Loss: 0.0039289 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 5.268204689025879
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0026256  Vali Loss: 0.0033809 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 5.267813205718994
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0026432  Vali Loss: 0.0031707 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 5.2741382122039795
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0024233  Vali Loss: 0.0031344 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003157 --> 0.003134).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 5.266953706741333
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0024068  Vali Loss: 0.0029170 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003134 --> 0.002917).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 5.264975547790527
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0022371  Vali Loss: 0.0032334 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 5.26373815536499
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0026610  Vali Loss: 0.0030633 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 5.267582893371582
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0023504  Vali Loss: 0.0030817 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 5.267526388168335
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0022242  Vali Loss: 0.0028312 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002917 --> 0.002831).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 5.266329288482666
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0021562  Vali Loss: 0.0028267 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002831 --> 0.002827).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 5.270463228225708
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0020351  Vali Loss: 0.0028645 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 5.26546573638916
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0021844  Vali Loss: 0.0028547 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 5.268742322921753
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0024124  Vali Loss: 0.0031150 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 5.273627042770386
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0019828  Vali Loss: 0.0028717 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 5.270760536193848
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0021423  Vali Loss: 0.0027189 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002827 --> 0.002719).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 5.270938873291016
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0056270  Vali Loss: 0.0034716 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 5.269572496414185
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0044350  Vali Loss: 0.0047455 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974761  Vali macro F1 0.9971110 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 5.267951726913452
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0030251  Vali Loss: 0.0058340 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 80 cost time: 5.269418478012085
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0026707  Vali Loss: 0.0046912 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 81 cost time: 5.267013072967529
VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0023889  Vali Loss: 0.0050740 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 82 cost time: 5.26818060874939
VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0020694  Vali Loss: 0.0049704 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 83 cost time: 5.26947808265686
VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0019781  Vali Loss: 0.0049035 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 84 cost time: 5.264534950256348
VALI: Epoch: 84, Steps: 29 | Train Loss: 0.0024084  Vali Loss: 0.0046199 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 85 cost time: 5.267848253250122
VALI: Epoch: 85, Steps: 29 | Train Loss: 0.0024768  Vali Loss: 0.0046781 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 86 cost time: 5.26960015296936
VALI: Epoch: 86, Steps: 29 | Train Loss: 0.0020574  Vali Loss: 0.0048476 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 87 cost time: 5.2684454917907715
VALI: Epoch: 87, Steps: 29 | Train Loss: 0.0022964  Vali Loss: 0.0048206 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 88 cost time: 5.267830848693848
VALI: Epoch: 88, Steps: 29 | Train Loss: 0.0022129  Vali Loss: 0.0047371 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 89 cost time: 5.266741037368774
VALI: Epoch: 89, Steps: 29 | Train Loss: 0.0020434  Vali Loss: 0.0047316 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 90 cost time: 5.265190839767456
VALI: Epoch: 90, Steps: 29 | Train Loss: 0.0021786  Vali Loss: 0.0047511 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 91 cost time: 5.263067960739136
VALI: Epoch: 91, Steps: 29 | Train Loss: 0.0022793  Vali Loss: 0.0047531 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8815789  Test weighted F1: 0.8584046  Test macro F1 0.8584046 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.847654581069946
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0018686  Vali Loss: 0.0024727 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
Validation loss decreased (inf --> 0.002473).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.845347881317139
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0022953  Vali Loss: 0.0028966 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.84271240234375
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0018842  Vali Loss: 0.0084896 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.847248792648315
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0035750  Vali Loss: 0.0031080 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.844235897064209
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0025933  Vali Loss: 0.0046681 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.846849203109741
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0024150  Vali Loss: 0.0021842 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002473 --> 0.002184).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.84676718711853
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0016071  Vali Loss: 0.0022556 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.8447277545928955
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0016418  Vali Loss: 0.0026184 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.846637725830078
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0020710  Vali Loss: 0.0037232 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.841595411300659
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0023867  Vali Loss: 0.0023918 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.855298280715942
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0014114  Vali Loss: 0.0018780 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002184 --> 0.001878).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.844186544418335
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0016048  Vali Loss: 0.0021037 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.853407621383667
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0012163  Vali Loss: 0.0018365 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001878 --> 0.001837).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.8439857959747314
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0011155  Vali Loss: 0.0019408 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.85081148147583
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0012255  Vali Loss: 0.0018090 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001837 --> 0.001809).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.84996223449707
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0012102  Vali Loss: 0.0015390 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001809 --> 0.001539).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.851140737533569
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0018519  Vali Loss: 0.0031432 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.84299898147583
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0013134  Vali Loss: 0.0022020 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.848567724227905
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0012706  Vali Loss: 0.0032056 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.848051071166992
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0013026  Vali Loss: 0.0017409 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.845508098602295
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0011326  Vali Loss: 0.0015501 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 6.844825267791748
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0010005  Vali Loss: 0.0015272 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001539 --> 0.001527).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.849115610122681
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0010250  Vali Loss: 0.0015177 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001527 --> 0.001518).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.851938724517822
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0009782  Vali Loss: 0.0015060 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001518 --> 0.001506).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 6.848055601119995
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0012291  Vali Loss: 0.0014830 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001506 --> 0.001483).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.846348524093628
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0009460  Vali Loss: 0.0014833 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.851072072982788
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0009601  Vali Loss: 0.0014717 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001483 --> 0.001472).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 6.847673177719116
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0009234  Vali Loss: 0.0014764 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.849574565887451
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0009796  Vali Loss: 0.0014574 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001472 --> 0.001457).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 6.852989435195923
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0010485  Vali Loss: 0.0014417 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001457 --> 0.001442).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.849622964859009
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0009750  Vali Loss: 0.0014274 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001442 --> 0.001427).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 6.847548484802246
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0011523  Vali Loss: 0.0014267 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001427 --> 0.001427).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.84904408454895
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0008986  Vali Loss: 0.0014143 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001427 --> 0.001414).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 6.851566553115845
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0011101  Vali Loss: 0.0013969 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001414 --> 0.001397).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 6.844352960586548
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0010961  Vali Loss: 0.0013928 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001397 --> 0.001393).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 36 cost time: 6.852805852890015
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0008074  Vali Loss: 0.0013672 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001393 --> 0.001367).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 6.8468053340911865
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0010098  Vali Loss: 0.0013719 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.8481669425964355
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0013464  Vali Loss: 0.0013440 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001367 --> 0.001344).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 6.848428726196289
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0010713  Vali Loss: 0.0013797 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 6.846075057983398
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0009626  Vali Loss: 0.0013022 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001344 --> 0.001302).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 41 cost time: 6.847468852996826
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0009408  Vali Loss: 0.0012616 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001302 --> 0.001262).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 42 cost time: 6.845332622528076
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0007900  Vali Loss: 0.0012408 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001262 --> 0.001241).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 43 cost time: 6.845938682556152
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0009384  Vali Loss: 0.0012704 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 6.845184087753296
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0007749  Vali Loss: 0.0012023 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001241 --> 0.001202).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 45 cost time: 6.846629858016968
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0010240  Vali Loss: 0.0011749 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001202 --> 0.001175).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 6.8460962772369385
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0009709  Vali Loss: 0.0011164 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001175 --> 0.001116).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 47 cost time: 6.84711480140686
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0008390  Vali Loss: 0.0010986 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001116 --> 0.001099).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 48 cost time: 6.848121166229248
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0010647  Vali Loss: 0.0010853 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001099 --> 0.001085).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 49 cost time: 6.842634677886963
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0009981  Vali Loss: 0.0010989 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 50 cost time: 6.841959238052368
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0009093  Vali Loss: 0.0010312 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001085 --> 0.001031).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 6.843819618225098
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0007830  Vali Loss: 0.0010155 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001031 --> 0.001015).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 52 cost time: 6.8335442543029785
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0008024  Vali Loss: 0.0010372 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 53 cost time: 6.8375563621521
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0009262  Vali Loss: 0.0010263 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 54 cost time: 6.827699661254883
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0010777  Vali Loss: 0.0011167 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 55 cost time: 6.835033178329468
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0008543  Vali Loss: 0.0012003 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 56 cost time: 6.830182790756226
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0008013  Vali Loss: 0.0011665 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 57 cost time: 6.835152864456177
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0009744  Vali Loss: 0.0011705 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 58 cost time: 6.83799147605896
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0007892  Vali Loss: 0.0011697 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 59 cost time: 6.836050987243652
Fine Tuning VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0007196  Vali Loss: 0.0011688 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 60 cost time: 6.841598033905029
Fine Tuning VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0007885  Vali Loss: 0.0011690 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 61 cost time: 6.846799612045288
Fine Tuning VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0008592  Vali Loss: 0.0011752 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 62 cost time: 6.848522424697876
Fine Tuning VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0010233  Vali Loss: 0.0011753 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 63 cost time: 6.850653648376465
Fine Tuning VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0012274  Vali Loss: 0.0011767 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 64 cost time: 6.846419811248779
Fine Tuning VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0013334  Vali Loss: 0.0011763 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 65 cost time: 6.849060535430908
Fine Tuning VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0009009  Vali Loss: 0.0011764 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 66 cost time: 6.846069097518921
Fine Tuning VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0009344  Vali Loss: 0.0011762 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8903509  Test weighted F1: 0.8684537  Test macro F1 0.8684537 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.335359334945679
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8527630  Vali Loss: 0.6361402 Vali Accuracy: 0.8809524  Vali weighted F1: 0.8722424  Vali macro F1 0.8728706 
Validation loss decreased (inf --> 0.636140).  Saving model ...
Epoch: 2 cost time: 5.261826992034912
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4318000  Vali Loss: 0.2189382 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9629875  Vali macro F1 0.9618830 
new best score!!!!
Validation loss decreased (0.636140 --> 0.218938).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.263071060180664
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1839327  Vali Loss: 0.1139597 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874597  Vali macro F1 0.9866283 
new best score!!!!
Validation loss decreased (0.218938 --> 0.113960).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.262486219406128
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1040461  Vali Loss: 0.0877612 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874326  Vali macro F1 0.9859329 
new best score!!!!
Validation loss decreased (0.113960 --> 0.087761).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.266129970550537
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0733119  Vali Loss: 0.0701482 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849722  Vali macro F1 0.9836260 
new best score!!!!
Validation loss decreased (0.087761 --> 0.070148).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.266608238220215
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0714761  Vali Loss: 0.0660026 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888740  Vali macro F1 0.9876904 
new best score!!!!
Validation loss decreased (0.070148 --> 0.066003).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.266110181808472
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0473782  Vali Loss: 0.0448355 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913185  Vali macro F1 0.9902817 
new best score!!!!
Validation loss decreased (0.066003 --> 0.044835).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.262944459915161
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0348591  Vali Loss: 0.0596941 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874305  Vali macro F1 0.9856633 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.260900497436523
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0355565  Vali Loss: 0.0446837 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
new best score!!!!
Validation loss decreased (0.044835 --> 0.044684).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.260158061981201
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0259730  Vali Loss: 0.0367027 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
new best score!!!!
Validation loss decreased (0.044684 --> 0.036703).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.261401891708374
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0272591  Vali Loss: 0.0584619 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848329  Vali macro F1 0.9838333 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.26327657699585
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0305622  Vali Loss: 0.0361269 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887355  Vali macro F1 0.9877442 
new best score!!!!
Validation loss decreased (0.036703 --> 0.036127).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.261103391647339
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0418967  Vali Loss: 0.0389860 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888740  Vali macro F1 0.9876904 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.259794473648071
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0220242  Vali Loss: 0.0252160 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.036127 --> 0.025216).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.25843358039856
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0178341  Vali Loss: 0.0515910 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849581  Vali macro F1 0.9842696 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.258413553237915
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0251980  Vali Loss: 0.0210882 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
new best score!!!!
Validation loss decreased (0.025216 --> 0.021088).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.261549711227417
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0187314  Vali Loss: 0.0174657 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974844  Vali macro F1 0.9974260 
new best score!!!!
Validation loss decreased (0.021088 --> 0.017466).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.255627155303955
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0153659  Vali Loss: 0.0215609 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925514  Vali macro F1 0.9919044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.256236791610718
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0142516  Vali Loss: 0.0147029 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.017466 --> 0.014703).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.255214214324951
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0218044  Vali Loss: 0.0239348 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887296  Vali macro F1 0.9878744 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.254365682601929
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0205785  Vali Loss: 0.0203016 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.256523370742798
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0106212  Vali Loss: 0.0212148 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.257301330566406
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0110659  Vali Loss: 0.0128877 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.014703 --> 0.012888).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.260118722915649
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0164873  Vali Loss: 0.0152672 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.25816798210144
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0139535  Vali Loss: 0.0186713 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.259112596511841
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0083405  Vali Loss: 0.0111594 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.012888 --> 0.011159).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.2583794593811035
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0074404  Vali Loss: 0.0056580 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.011159 --> 0.005658).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.257449626922607
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0071893  Vali Loss: 0.0157069 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937382  Vali macro F1 0.9931146 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.2554097175598145
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0103964  Vali Loss: 0.0099507 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.253960371017456
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0179947  Vali Loss: 0.0341003 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9830165  Vali macro F1 0.9804141 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.612788677215576
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0158953  Vali Loss: 0.0247009 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9914474 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.254475116729736
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0130038  Vali Loss: 0.0097359 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 5.256751537322998
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0082499  Vali Loss: 0.0089982 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.257452726364136
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0066585  Vali Loss: 0.0087456 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 5.259989976882935
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0063182  Vali Loss: 0.0083439 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 5.2617082595825195
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0057595  Vali Loss: 0.0076676 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 5.266246795654297
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0055328  Vali Loss: 0.0074411 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 5.266723394393921
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0051352  Vali Loss: 0.0074096 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.260489225387573
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0054575  Vali Loss: 0.0073759 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.261561632156372
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0054110  Vali Loss: 0.0073074 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.258195877075195
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0052578  Vali Loss: 0.0072457 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.262041330337524
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0057285  Vali Loss: 0.0071700 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9052632  Test weighted F1: 0.8833107  Test macro F1 0.8833107 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.900086164474487
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0057768  Vali Loss: 0.0459570 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
Validation loss decreased (inf --> 0.045957).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.895122051239014
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0045468  Vali Loss: 0.0081137 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.045957 --> 0.008114).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.8935441970825195
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0059066  Vali Loss: 0.0367741 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.885727405548096
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0045985  Vali Loss: 0.0071148 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008114 --> 0.007115).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.885850191116333
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0035354  Vali Loss: 0.0049801 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007115 --> 0.004980).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.882844924926758
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0032212  Vali Loss: 0.0047684 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004980 --> 0.004768).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.890810251235962
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0034265  Vali Loss: 0.0041730 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.004768 --> 0.004173).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.889263153076172
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0031941  Vali Loss: 0.0044123 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.878840923309326
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0030782  Vali Loss: 0.0038462 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.004173 --> 0.003846).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.882354259490967
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0027663  Vali Loss: 0.0037512 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003846 --> 0.003751).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.887241840362549
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0025289  Vali Loss: 0.0037305 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003751 --> 0.003730).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.885737419128418
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0023875  Vali Loss: 0.0033909 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003730 --> 0.003391).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.896147727966309
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0023901  Vali Loss: 0.0252108 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.880657196044922
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0027569  Vali Loss: 0.0035253 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.889553070068359
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0026123  Vali Loss: 0.0035838 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.890076160430908
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0020356  Vali Loss: 0.0027887 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003391 --> 0.002789).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.891897916793823
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0022271  Vali Loss: 0.0025259 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002789 --> 0.002526).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.890172958374023
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0020366  Vali Loss: 0.0028600 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.886651039123535
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0019243  Vali Loss: 0.0030015 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.886820316314697
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0021366  Vali Loss: 0.0067269 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.888754844665527
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0021333  Vali Loss: 0.0041750 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.890565395355225
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0016890  Vali Loss: 0.0040819 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 23 cost time: 6.880411863327026
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0020580  Vali Loss: 0.0068031 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.8905463218688965
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0023952  Vali Loss: 0.0069965 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.890032768249512
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0022755  Vali Loss: 0.0028081 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.884276390075684
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0017634  Vali Loss: 0.0027531 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.888902187347412
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0015837  Vali Loss: 0.0029766 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 6.881983518600464
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0015217  Vali Loss: 0.0029706 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.882294416427612
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0015197  Vali Loss: 0.0029543 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.884291887283325
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0016412  Vali Loss: 0.0029312 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.885554075241089
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0014057  Vali Loss: 0.0029017 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.893794298171997
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0015272  Vali Loss: 0.0028598 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9315789  Test weighted F1: 0.9175264  Test macro F1 0.9175264 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.374697208404541
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8560399  Vali Loss: 0.6961143 Vali Accuracy: 0.8659148  Vali weighted F1: 0.8631580  Vali macro F1 0.8621022 
Validation loss decreased (inf --> 0.696114).  Saving model ...
Epoch: 2 cost time: 5.2847418785095215
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4369366  Vali Loss: 0.2475586 Vali Accuracy: 0.9423559  Vali weighted F1: 0.9421932  Vali macro F1 0.9407488 
new best score!!!!
Validation loss decreased (0.696114 --> 0.247559).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.285311222076416
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1872704  Vali Loss: 0.1282265 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9789069  Vali macro F1 0.9779586 
new best score!!!!
Validation loss decreased (0.247559 --> 0.128226).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.286761999130249
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1137644  Vali Loss: 0.0872177 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874771  Vali macro F1 0.9867328 
new best score!!!!
Validation loss decreased (0.128226 --> 0.087218).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.2850024700164795
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0795757  Vali Loss: 0.0626979 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887236  Vali macro F1 0.9880929 
new best score!!!!
Validation loss decreased (0.087218 --> 0.062698).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.290189981460571
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0618379  Vali Loss: 0.0526560 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
new best score!!!!
Validation loss decreased (0.062698 --> 0.052656).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.286691665649414
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0553651  Vali Loss: 0.0436217 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862292  Vali macro F1 0.9849710 
new best score!!!!
Validation loss decreased (0.052656 --> 0.043622).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.287558078765869
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0377501  Vali Loss: 0.0358786 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924283  Vali macro F1 0.9913330 
new best score!!!!
Validation loss decreased (0.043622 --> 0.035879).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.287160396575928
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0386312  Vali Loss: 0.0324938 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937236  Vali macro F1 0.9934310 
new best score!!!!
Validation loss decreased (0.035879 --> 0.032494).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.289667367935181
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0296675  Vali Loss: 0.0197579 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949739  Vali macro F1 0.9945604 
new best score!!!!
Validation loss decreased (0.032494 --> 0.019758).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.294234991073608
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0308542  Vali Loss: 0.0218794 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911646  Vali macro F1 0.9908225 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.295854091644287
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0233747  Vali Loss: 0.0240697 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924789  Vali macro F1 0.9918235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.2919371128082275
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0202175  Vali Loss: 0.0169030 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936809  Vali macro F1 0.9933779 
new best score!!!!
Validation loss decreased (0.019758 --> 0.016903).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.29126501083374
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0158261  Vali Loss: 0.0117964 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.016903 --> 0.011796).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.289121627807617
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0155367  Vali Loss: 0.0233121 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912581  Vali macro F1 0.9909198 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.285080432891846
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0192827  Vali Loss: 0.0117674 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.011796 --> 0.011767).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.281696796417236
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0212557  Vali Loss: 0.0115910 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011767 --> 0.011591).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.283200263977051
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0147796  Vali Loss: 0.0523242 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.279027938842773
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0182893  Vali Loss: 0.0097352 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011591 --> 0.009735).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.281081676483154
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0125617  Vali Loss: 0.0141265 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937336  Vali macro F1 0.9928734 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.279585361480713
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0141247  Vali Loss: 0.0155620 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949977  Vali macro F1 0.9948843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.281041383743286
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0139701  Vali Loss: 0.0089950 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.009735 --> 0.008995).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.279609203338623
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0156051  Vali Loss: 0.0111162 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.278880834579468
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0106109  Vali Loss: 0.0101321 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.281270503997803
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0110694  Vali Loss: 0.0097652 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.280325412750244
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0086734  Vali Loss: 0.0062663 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008995 --> 0.006266).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.278985500335693
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0073495  Vali Loss: 0.0131000 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.28275728225708
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0142418  Vali Loss: 0.0062876 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.279603958129883
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0076274  Vali Loss: 0.0049025 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.006266 --> 0.004903).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.279435157775879
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0095613  Vali Loss: 0.0134326 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949754  Vali macro F1 0.9945862 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.278908967971802
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0126024  Vali Loss: 0.1126289 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9839181  Vali macro F1 0.9809942 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.282975196838379
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0463450  Vali Loss: 0.0205240 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937617  Vali macro F1 0.9934997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.278925180435181
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0176913  Vali Loss: 0.0105240 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 5.278523206710815
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0149311  Vali Loss: 0.0133496 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962282  Vali macro F1 0.9959644 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 5.281223297119141
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0104930  Vali Loss: 0.0099347 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.281364440917969
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0085629  Vali Loss: 0.0092185 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.279879570007324
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0079671  Vali Loss: 0.0088778 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 5.279358386993408
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0073040  Vali Loss: 0.0078051 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 5.282926559448242
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0068112  Vali Loss: 0.0077221 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 5.278380393981934
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0071416  Vali Loss: 0.0077350 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.27910041809082
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0067409  Vali Loss: 0.0076390 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.275981664657593
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0072448  Vali Loss: 0.0075756 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.271467924118042
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0073978  Vali Loss: 0.0076223 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.272262811660767
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0063740  Vali Loss: 0.0076310 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9184211  Test weighted F1: 0.9120801  Test macro F1 0.9120801 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.909940481185913
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0050885  Vali Loss: 0.0039495 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
Validation loss decreased (inf --> 0.003950).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.9008684158325195
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0053214  Vali Loss: 0.0038567 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003950 --> 0.003857).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.900067329406738
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0040177  Vali Loss: 0.0037426 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003857 --> 0.003743).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.9092676639556885
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0037435  Vali Loss: 0.0033605 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003743 --> 0.003360).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.9100353717803955
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0036875  Vali Loss: 0.0036463 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.903114318847656
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0041092  Vali Loss: 0.0032154 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003360 --> 0.003215).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.918971300125122
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0038216  Vali Loss: 0.0034875 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.904493570327759
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0031168  Vali Loss: 0.0027382 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003215 --> 0.002738).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.910996913909912
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0030402  Vali Loss: 0.0032321 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.919346809387207
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0028323  Vali Loss: 0.0031496 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.916358232498169
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0026321  Vali Loss: 0.0030297 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.924628973007202
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0026596  Vali Loss: 0.0029078 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.913714647293091
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0024343  Vali Loss: 0.0027821 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 6.916451454162598
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0022278  Vali Loss: 0.0026002 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002738 --> 0.002600).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.923490762710571
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0054582  Vali Loss: 0.0024738 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002600 --> 0.002474).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.916397571563721
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0033481  Vali Loss: 0.0025102 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.912965536117554
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0036421  Vali Loss: 0.0038417 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.913859844207764
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0034506  Vali Loss: 0.0026027 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.908988952636719
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0023461  Vali Loss: 0.0022041 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002474 --> 0.002204).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.916418075561523
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0020530  Vali Loss: 0.0024991 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.923259735107422
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0019654  Vali Loss: 0.0020071 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002204 --> 0.002007).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.9296715259552
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0017958  Vali Loss: 0.0018987 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002007 --> 0.001899).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.9220452308654785
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0026372  Vali Loss: 0.0017438 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001899 --> 0.001744).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 6.912389039993286
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0020619  Vali Loss: 0.0018545 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.908415794372559
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0025909  Vali Loss: 0.0102268 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.91439151763916
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0026285  Vali Loss: 0.0027757 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.915072917938232
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0019575  Vali Loss: 0.0019217 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.91573429107666
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0021061  Vali Loss: 0.0017942 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 29 cost time: 6.914999485015869
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0018432  Vali Loss: 0.0017610 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.915643215179443
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0022222  Vali Loss: 0.0017157 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001744 --> 0.001716).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.923784255981445
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0016887  Vali Loss: 0.0017130 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001716 --> 0.001713).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 6.916157245635986
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0013793  Vali Loss: 0.0017069 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001713 --> 0.001707).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.918184757232666
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0017044  Vali Loss: 0.0017108 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.919420480728149
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0018089  Vali Loss: 0.0016839 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001707 --> 0.001684).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 6.914985418319702
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0015197  Vali Loss: 0.0016724 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001684 --> 0.001672).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 36 cost time: 6.910632133483887
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0016812  Vali Loss: 0.0016678 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001672 --> 0.001668).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 6.916356563568115
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0015841  Vali Loss: 0.0016542 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001668 --> 0.001654).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 38 cost time: 6.908751487731934
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0017386  Vali Loss: 0.0016370 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001654 --> 0.001637).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 6.9162633419036865
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0015352  Vali Loss: 0.0016400 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 6.926166772842407
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0017179  Vali Loss: 0.0016290 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001637 --> 0.001629).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 41 cost time: 6.914200305938721
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0017708  Vali Loss: 0.0016404 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 6.9120800495147705
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0015066  Vali Loss: 0.0016322 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 6.913513898849487
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0015671  Vali Loss: 0.0016429 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 6.91593074798584
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0019829  Vali Loss: 0.0016063 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001629 --> 0.001606).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 45 cost time: 6.91622519493103
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0015367  Vali Loss: 0.0016114 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 46 cost time: 6.912682056427002
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0015845  Vali Loss: 0.0016023 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001606 --> 0.001602).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 47 cost time: 6.915446758270264
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0012787  Vali Loss: 0.0016108 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 48 cost time: 6.916457891464233
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0013544  Vali Loss: 0.0016099 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 49 cost time: 6.9262731075286865
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0016416  Vali Loss: 0.0015992 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001602 --> 0.001599).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 6.911396026611328
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0014182  Vali Loss: 0.0015971 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001599 --> 0.001597).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 6.913461208343506
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0016682  Vali Loss: 0.0015778 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001597 --> 0.001578).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 52 cost time: 6.91555643081665
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0016111  Vali Loss: 0.0015613 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001578 --> 0.001561).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 53 cost time: 6.910841464996338
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0015936  Vali Loss: 0.0015764 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 54 cost time: 6.916061162948608
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0016812  Vali Loss: 0.0015559 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.001561 --> 0.001556).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 55 cost time: 6.919335603713989
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0016031  Vali Loss: 0.0015743 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 56 cost time: 6.908719539642334
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0015317  Vali Loss: 0.0015803 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 57 cost time: 6.911332607269287
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0014416  Vali Loss: 0.0015889 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 58 cost time: 6.92116904258728
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0015234  Vali Loss: 0.0015686 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 59 cost time: 6.908189058303833
Fine Tuning VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0016218  Vali Loss: 0.0016007 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 60 cost time: 6.907671689987183
Fine Tuning VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0013223  Vali Loss: 0.0016015 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 61 cost time: 6.914725065231323
Fine Tuning VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0015310  Vali Loss: 0.0016011 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 62 cost time: 6.910714149475098
Fine Tuning VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0016663  Vali Loss: 0.0015992 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 63 cost time: 6.899149656295776
Fine Tuning VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0013794  Vali Loss: 0.0016002 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 64 cost time: 6.904171466827393
Fine Tuning VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0013854  Vali Loss: 0.0015987 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 65 cost time: 6.911763668060303
Fine Tuning VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0015471  Vali Loss: 0.0015987 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 66 cost time: 6.913288354873657
Fine Tuning VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0014567  Vali Loss: 0.0015981 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 67 cost time: 6.909901142120361
Fine Tuning VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0014006  Vali Loss: 0.0015986 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 68 cost time: 6.907577753067017
Fine Tuning VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0016554  Vali Loss: 0.0015993 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 69 cost time: 6.917993545532227
Fine Tuning VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0015408  Vali Loss: 0.0015991 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9096491  Test weighted F1: 0.9042865  Test macro F1 0.9042865 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.331685304641724
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8558170  Vali Loss: 0.6690942 Vali Accuracy: 0.8759398  Vali weighted F1: 0.8706088  Vali macro F1 0.8711698 
Validation loss decreased (inf --> 0.669094).  Saving model ...
Epoch: 2 cost time: 5.261751413345337
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4485573  Vali Loss: 0.2390572 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9655040  Vali macro F1 0.9646734 
new best score!!!!
Validation loss decreased (0.669094 --> 0.239057).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.260134935379028
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.2086285  Vali Loss: 0.1345491 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9684236  Vali macro F1 0.9679781 
new best score!!!!
Validation loss decreased (0.239057 --> 0.134549).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.267116069793701
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1145690  Vali Loss: 0.0810927 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875041  Vali macro F1 0.9864547 
new best score!!!!
Validation loss decreased (0.134549 --> 0.081093).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.267553091049194
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0774015  Vali Loss: 0.0730654 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863611  Vali macro F1 0.9854022 
new best score!!!!
Validation loss decreased (0.081093 --> 0.073065).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.264341592788696
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0549112  Vali Loss: 0.0476936 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888117  Vali macro F1 0.9877921 
new best score!!!!
Validation loss decreased (0.073065 --> 0.047694).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.268901824951172
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0443986  Vali Loss: 0.0511080 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888162  Vali macro F1 0.9877400 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.263585329055786
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0350693  Vali Loss: 0.0640934 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887849  Vali macro F1 0.9874480 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 9 cost time: 5.266275882720947
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0428154  Vali Loss: 0.0452599 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912968  Vali macro F1 0.9903926 
new best score!!!!
Validation loss decreased (0.047694 --> 0.045260).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.269470930099487
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0329711  Vali Loss: 0.0469268 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851357  Vali macro F1 0.9837003 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.266175985336304
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0280628  Vali Loss: 0.0400475 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.045260 --> 0.040048).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.2643866539001465
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0256670  Vali Loss: 0.0418553 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888596  Vali macro F1 0.9877840 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.266127109527588
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0223359  Vali Loss: 0.0290915 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925527  Vali macro F1 0.9916333 
new best score!!!!
Validation loss decreased (0.040048 --> 0.029092).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.262010335922241
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0186441  Vali Loss: 0.0226003 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
new best score!!!!
Validation loss decreased (0.029092 --> 0.022600).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.25918984413147
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0185196  Vali Loss: 0.0301925 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937612  Vali macro F1 0.9929400 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.256020784378052
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0165614  Vali Loss: 0.0235551 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 5.2554402351379395
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0170031  Vali Loss: 0.0267004 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900902  Vali macro F1 0.9890866 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 5.261975288391113
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0128051  Vali Loss: 0.0264449 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900902  Vali macro F1 0.9890866 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 19 cost time: 5.259068012237549
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0156325  Vali Loss: 0.0240095 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 20 cost time: 5.256856918334961
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0114590  Vali Loss: 0.0192063 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.022600 --> 0.019206).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.264608144760132
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0089522  Vali Loss: 0.0180696 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.019206 --> 0.018070).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.2639429569244385
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0082674  Vali Loss: 0.0169468 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.018070 --> 0.016947).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.263270854949951
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0080352  Vali Loss: 0.0160099 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
new best score!!!!
Validation loss decreased (0.016947 --> 0.016010).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.261597394943237
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0077603  Vali Loss: 0.0144111 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.016010 --> 0.014411).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.26520848274231
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0077262  Vali Loss: 0.0139016 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
new best score!!!!
Validation loss decreased (0.014411 --> 0.013902).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.2598395347595215
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0085667  Vali Loss: 0.0142551 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.259490251541138
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0080930  Vali Loss: 0.0161963 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937382  Vali macro F1 0.9931146 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.262086629867554
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0071997  Vali Loss: 0.0164572 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924890  Vali macro F1 0.9917279 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.2582502365112305
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0085487  Vali Loss: 0.0336045 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924843  Vali macro F1 0.9916839 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.261160612106323
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0077799  Vali Loss: 0.0158638 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 5.257611513137817
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0070337  Vali Loss: 0.0155351 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.2594053745269775
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0072681  Vali Loss: 0.0152220 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.25866436958313
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0108818  Vali Loss: 0.0151193 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.256971836090088
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0073301  Vali Loss: 0.0149769 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 5.259435653686523
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0071627  Vali Loss: 0.0148397 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 36 cost time: 5.263044118881226
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0071231  Vali Loss: 0.0148292 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.261543273925781
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0071946  Vali Loss: 0.0148073 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.258142471313477
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0071903  Vali Loss: 0.0147805 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.281463623046875
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0068655  Vali Loss: 0.0147696 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 5.255504846572876
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0067069  Vali Loss: 0.0147520 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7517544  Test weighted F1: 0.6932079  Test macro F1 0.6932079 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.894998788833618
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0075970  Vali Loss: 0.0139326 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949906  Vali macro F1 0.9945136 
Validation loss decreased (inf --> 0.013933).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.9033544063568115
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0066529  Vali Loss: 0.0126185 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.013933 --> 0.012618).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.896543025970459
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0062837  Vali Loss: 0.0139317 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.895530939102173
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0055168  Vali Loss: 0.0121229 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962475  Vali macro F1 0.9959265 
new best score!!!!
Validation loss decreased (0.012618 --> 0.012123).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.906356334686279
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0052045  Vali Loss: 0.0105212 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012123 --> 0.010521).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.910263299942017
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0051514  Vali Loss: 0.0172140 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924797  Vali macro F1 0.9917591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.8949198722839355
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0074940  Vali Loss: 0.0202228 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.896859645843506
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0052674  Vali Loss: 0.0355500 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937351  Vali macro F1 0.9930811 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.91070556640625
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0049348  Vali Loss: 0.0100622 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949906  Vali macro F1 0.9945136 
new best score!!!!
Validation loss decreased (0.010521 --> 0.010062).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.910704135894775
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0047870  Vali Loss: 0.0103298 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.902777433395386
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0046600  Vali Loss: 0.0087412 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.010062 --> 0.008741).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.913146495819092
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0040088  Vali Loss: 0.0097365 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.905583143234253
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0041472  Vali Loss: 0.0090713 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.901130676269531
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0045415  Vali Loss: 0.0095040 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.903681993484497
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0040258  Vali Loss: 0.0064501 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.008741 --> 0.006450).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.9029035568237305
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0039716  Vali Loss: 0.0110009 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.900622844696045
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0045755  Vali Loss: 0.0073482 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.900310277938843
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0034680  Vali Loss: 0.0087204 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.904785871505737
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0032902  Vali Loss: 0.0093398 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.909375190734863
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0031825  Vali Loss: 0.0073463 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 21 cost time: 6.90071702003479
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0029858  Vali Loss: 0.0073951 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.901269912719727
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0032430  Vali Loss: 0.0063499 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974913  Vali macro F1 0.9973279 
new best score!!!!
Validation loss decreased (0.006450 --> 0.006350).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.905150651931763
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0037035  Vali Loss: 0.0074550 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.9063191413879395
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0027764  Vali Loss: 0.0066065 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.8976922035217285
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0028286  Vali Loss: 0.0060186 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
new best score!!!!
Validation loss decreased (0.006350 --> 0.006019).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.908099174499512
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0025580  Vali Loss: 0.0063606 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.89890718460083
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0031763  Vali Loss: 0.0097017 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.90771222114563
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0034896  Vali Loss: 0.0063520 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974913  Vali macro F1 0.9973279 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.9117112159729
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0033653  Vali Loss: 0.0070660 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.900292873382568
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0028074  Vali Loss: 0.0066699 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 6.907971620559692
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0027349  Vali Loss: 0.0063995 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.902169466018677
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0024893  Vali Loss: 0.0068643 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.9014976024627686
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0027013  Vali Loss: 0.0065930 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.900547027587891
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0022910  Vali Loss: 0.0068049 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.901472330093384
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0022560  Vali Loss: 0.0065720 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 36 cost time: 6.901349067687988
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0022485  Vali Loss: 0.0065121 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.902550220489502
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0025129  Vali Loss: 0.0064991 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.900281667709351
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0026140  Vali Loss: 0.0065390 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.890320539474487
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0026673  Vali Loss: 0.0065528 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.903688907623291
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0022527  Vali Loss: 0.0065823 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974855  Vali macro F1 0.9973338 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7596491  Test weighted F1: 0.7019332  Test macro F1 0.7019332 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.3613080978393555
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8796419  Vali Loss: 0.6298883 Vali Accuracy: 0.9110276  Vali weighted F1: 0.9033762  Vali macro F1 0.9048261 
Validation loss decreased (inf --> 0.629888).  Saving model ...
Epoch: 2 cost time: 5.274693965911865
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4378645  Vali Loss: 0.2278669 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9709251  Vali macro F1 0.9706577 
new best score!!!!
Validation loss decreased (0.629888 --> 0.227867).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.267224073410034
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1866893  Vali Loss: 0.1280351 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837346  Vali macro F1 0.9826920 
new best score!!!!
Validation loss decreased (0.227867 --> 0.128035).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.269521236419678
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1023029  Vali Loss: 0.0798461 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849783  Vali macro F1 0.9841707 
new best score!!!!
Validation loss decreased (0.128035 --> 0.079846).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.268826246261597
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0662873  Vali Loss: 0.0600610 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849925  Vali macro F1 0.9839811 
new best score!!!!
Validation loss decreased (0.079846 --> 0.060061).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.266043186187744
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0458882  Vali Loss: 0.0475837 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900669  Vali macro F1 0.9890404 
new best score!!!!
Validation loss decreased (0.060061 --> 0.047584).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.270085096359253
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0388197  Vali Loss: 0.0636471 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849763  Vali macro F1 0.9835474 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.2640180587768555
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0341707  Vali Loss: 0.0493389 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900412  Vali macro F1 0.9889022 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 9 cost time: 5.264630079269409
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0307925  Vali Loss: 0.0400399 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.047584 --> 0.040040).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.262463331222534
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0289541  Vali Loss: 0.0410105 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888125  Vali macro F1 0.9880932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.259913206100464
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0238805  Vali Loss: 0.0360378 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912972  Vali macro F1 0.9905223 
new best score!!!!
Validation loss decreased (0.040040 --> 0.036038).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.262164354324341
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0359971  Vali Loss: 0.0391354 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937816  Vali macro F1 0.9931791 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 5.260816812515259
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0216189  Vali Loss: 0.0267749 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
new best score!!!!
Validation loss decreased (0.036038 --> 0.026775).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.260054588317871
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0227152  Vali Loss: 0.0307970 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.25742244720459
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0172440  Vali Loss: 0.0289048 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924890  Vali macro F1 0.9917279 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 5.261610746383667
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0132035  Vali Loss: 0.0214161 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.026775 --> 0.021416).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.258422374725342
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0161914  Vali Loss: 0.0154320 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.021416 --> 0.015432).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.253234624862671
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0118230  Vali Loss: 0.0227185 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.261615753173828
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0170943  Vali Loss: 0.0324794 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936883  Vali macro F1 0.9929737 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.256887197494507
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0223540  Vali Loss: 0.0308123 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.256574392318726
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0149480  Vali Loss: 0.0211223 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.258759021759033
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0116197  Vali Loss: 0.0208217 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 5.259202003479004
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0095167  Vali Loss: 0.0182730 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.259886026382446
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0084626  Vali Loss: 0.0175671 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.259618520736694
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0084323  Vali Loss: 0.0170559 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.2606470584869385
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0083766  Vali Loss: 0.0172691 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.261582851409912
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0088660  Vali Loss: 0.0176489 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 28 cost time: 5.259877920150757
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0073548  Vali Loss: 0.0176485 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.261464834213257
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0073156  Vali Loss: 0.0174897 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.264592885971069
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0073979  Vali Loss: 0.0174144 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.2614336013793945
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0072119  Vali Loss: 0.0172229 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.26101016998291
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0073287  Vali Loss: 0.0169876 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8508772  Test weighted F1: 0.8170393  Test macro F1 0.8170393 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.896871328353882
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0096047  Vali Loss: 0.0182191 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937612  Vali macro F1 0.9929400 
Validation loss decreased (inf --> 0.018219).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.908563613891602
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0083039  Vali Loss: 0.0156059 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.018219 --> 0.015606).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.907955169677734
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0074596  Vali Loss: 0.0139664 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.015606 --> 0.013966).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.905779838562012
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0069181  Vali Loss: 0.0120570 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.013966 --> 0.012057).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.904720067977905
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0082678  Vali Loss: 0.0106991 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012057 --> 0.010699).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.908419609069824
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0063424  Vali Loss: 0.0106101 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010699 --> 0.010610).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.909665584564209
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0062169  Vali Loss: 0.0100754 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010610 --> 0.010075).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.9091691970825195
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0056866  Vali Loss: 0.0088587 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010075 --> 0.008859).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.898962020874023
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0054638  Vali Loss: 0.0087281 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008859 --> 0.008728).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.9036102294921875
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0048187  Vali Loss: 0.0079436 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008728 --> 0.007944).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.907095909118652
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0049595  Vali Loss: 0.0094184 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.909214019775391
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0051416  Vali Loss: 0.0088175 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.9060280323028564
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0054948  Vali Loss: 0.0090548 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9956960 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.897651195526123
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0051927  Vali Loss: 0.0104405 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.899864435195923
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0045733  Vali Loss: 0.0087689 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 6.896643400192261
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0043420  Vali Loss: 0.0079060 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.007944 --> 0.007906).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.901462554931641
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0043398  Vali Loss: 0.0072255 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9971491 
new best score!!!!
Validation loss decreased (0.007906 --> 0.007225).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.911431789398193
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0036102  Vali Loss: 0.0067133 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007225 --> 0.006713).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.892532110214233
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0038238  Vali Loss: 0.0061745 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006713 --> 0.006174).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.897502422332764
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0034378  Vali Loss: 0.0068535 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974761  Vali macro F1 0.9971110 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.9016501903533936
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0029653  Vali Loss: 0.0068791 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.889848470687866
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0030137  Vali Loss: 0.0069602 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.896408319473267
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0028952  Vali Loss: 0.0063032 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974761  Vali macro F1 0.9971110 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.900331020355225
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0040906  Vali Loss: 0.0158033 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.900859355926514
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0058473  Vali Loss: 0.0121989 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.899533748626709
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0039844  Vali Loss: 0.0087193 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.907970905303955
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0039497  Vali Loss: 0.0068966 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.9080188274383545
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0035742  Vali Loss: 0.0060174 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006174 --> 0.006017).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.906126022338867
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0031058  Vali Loss: 0.0055687 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006017 --> 0.005569).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 6.906687498092651
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0029443  Vali Loss: 0.0053187 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005569 --> 0.005319).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.904839992523193
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0039957  Vali Loss: 0.0051033 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005319 --> 0.005103).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 6.897569179534912
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0027726  Vali Loss: 0.0051762 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.897631406784058
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0029142  Vali Loss: 0.0049241 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005103 --> 0.004924).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 6.902852296829224
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0027614  Vali Loss: 0.0047022 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004924 --> 0.004702).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 6.896931171417236
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0028496  Vali Loss: 0.0045578 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004702 --> 0.004558).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 36 cost time: 6.909954309463501
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0026624  Vali Loss: 0.0044874 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004558 --> 0.004487).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 6.894757270812988
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0027518  Vali Loss: 0.0044452 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004487 --> 0.004445).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 38 cost time: 6.9026899337768555
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0025028  Vali Loss: 0.0043790 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004445 --> 0.004379).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 6.904263734817505
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0028269  Vali Loss: 0.0042836 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004379 --> 0.004284).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 40 cost time: 6.903076410293579
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0026926  Vali Loss: 0.0043170 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 6.901628017425537
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0025234  Vali Loss: 0.0041987 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004284 --> 0.004199).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 42 cost time: 6.8972413539886475
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0025399  Vali Loss: 0.0042678 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 43 cost time: 6.904987812042236
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0024087  Vali Loss: 0.0043205 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 44 cost time: 6.901246786117554
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0026107  Vali Loss: 0.0041673 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004199 --> 0.004167).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 45 cost time: 6.90573525428772
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0028442  Vali Loss: 0.0043011 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 46 cost time: 6.8938987255096436
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0023615  Vali Loss: 0.0043478 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 47 cost time: 6.895688056945801
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0023230  Vali Loss: 0.0043386 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 48 cost time: 6.902787923812866
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0024835  Vali Loss: 0.0041897 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 49 cost time: 6.910318851470947
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0026394  Vali Loss: 0.0040883 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004167 --> 0.004088).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 6.891605377197266
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0032597  Vali Loss: 0.0040587 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004088 --> 0.004059).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 6.914887428283691
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0024588  Vali Loss: 0.0042708 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 52 cost time: 6.900187969207764
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0022552  Vali Loss: 0.0043032 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 53 cost time: 6.900681257247925
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0025648  Vali Loss: 0.0042222 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 54 cost time: 6.901057958602905
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0024829  Vali Loss: 0.0040304 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004059 --> 0.004030).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 55 cost time: 6.893430233001709
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0021788  Vali Loss: 0.0039455 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004030 --> 0.003946).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 56 cost time: 6.896557807922363
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0022127  Vali Loss: 0.0038480 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003946 --> 0.003848).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 57 cost time: 6.908654451370239
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0026660  Vali Loss: 0.0038613 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 58 cost time: 6.904942989349365
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0026667  Vali Loss: 0.0039935 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 59 cost time: 6.906248569488525
Fine Tuning VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0023304  Vali Loss: 0.0038566 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 60 cost time: 6.9033918380737305
Fine Tuning VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0022991  Vali Loss: 0.0037921 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003848 --> 0.003792).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 61 cost time: 6.907204627990723
Fine Tuning VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0024664  Vali Loss: 0.0038771 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 62 cost time: 6.900186538696289
Fine Tuning VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0019201  Vali Loss: 0.0038635 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 63 cost time: 6.9059977531433105
Fine Tuning VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0023399  Vali Loss: 0.0038909 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 64 cost time: 6.90475058555603
Fine Tuning VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0023953  Vali Loss: 0.0037638 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003792 --> 0.003764).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 65 cost time: 6.897730827331543
Fine Tuning VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0020466  Vali Loss: 0.0037783 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 66 cost time: 6.896920442581177
Fine Tuning VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0020523  Vali Loss: 0.0036600 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003764 --> 0.003660).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 67 cost time: 6.923513650894165
Fine Tuning VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0020293  Vali Loss: 0.0035958 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003660 --> 0.003596).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 68 cost time: 6.910190105438232
Fine Tuning VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0023635  Vali Loss: 0.0036140 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 69 cost time: 6.904972553253174
Fine Tuning VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0024333  Vali Loss: 0.0036124 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 70 cost time: 6.905917167663574
Fine Tuning VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0019329  Vali Loss: 0.0037087 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 71 cost time: 6.908138036727905
Fine Tuning VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0023079  Vali Loss: 0.0036208 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 72 cost time: 6.907904386520386
Fine Tuning VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0018225  Vali Loss: 0.0035463 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003596 --> 0.003546).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 73 cost time: 6.893088102340698
Fine Tuning VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0026705  Vali Loss: 0.0035372 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003546 --> 0.003537).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 74 cost time: 6.891880989074707
Fine Tuning VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0022275  Vali Loss: 0.0038840 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 75 cost time: 6.904077768325806
Fine Tuning VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0026110  Vali Loss: 0.0039265 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 76 cost time: 6.897294998168945
Fine Tuning VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0029863  Vali Loss: 0.0041910 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 77 cost time: 6.906203031539917
Fine Tuning VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0024674  Vali Loss: 0.0038734 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 78 cost time: 6.891361713409424
Fine Tuning VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0019224  Vali Loss: 0.0036297 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 79 cost time: 6.894130229949951
Fine Tuning VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0020760  Vali Loss: 0.0036221 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 80 cost time: 6.900408744812012
Fine Tuning VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0022548  Vali Loss: 0.0036206 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 81 cost time: 6.894801378250122
Fine Tuning VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0020658  Vali Loss: 0.0036111 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 82 cost time: 6.907293081283569
Fine Tuning VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0022799  Vali Loss: 0.0035918 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 83 cost time: 6.893630504608154
Fine Tuning VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0021082  Vali Loss: 0.0035876 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 84 cost time: 6.886345624923706
Fine Tuning VALI: Epoch: 84, Steps: 29 | Train Loss: 0.0022330  Vali Loss: 0.0035864 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 85 cost time: 6.906101942062378
Fine Tuning VALI: Epoch: 85, Steps: 29 | Train Loss: 0.0020484  Vali Loss: 0.0035858 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 86 cost time: 6.912931203842163
Fine Tuning VALI: Epoch: 86, Steps: 29 | Train Loss: 0.0021747  Vali Loss: 0.0035859 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 87 cost time: 6.894072532653809
Fine Tuning VALI: Epoch: 87, Steps: 29 | Train Loss: 0.0020799  Vali Loss: 0.0035856 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 88 cost time: 6.901514530181885
Fine Tuning VALI: Epoch: 88, Steps: 29 | Train Loss: 0.0022892  Vali Loss: 0.0035851 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8728070  Test weighted F1: 0.8376077  Test macro F1 0.8376077 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.342536449432373
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8431600  Vali Loss: 0.6672729 Vali Accuracy: 0.8709273  Vali weighted F1: 0.8602063  Vali macro F1 0.8624740 
Validation loss decreased (inf --> 0.667273).  Saving model ...
Epoch: 2 cost time: 5.2798380851745605
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4477655  Vali Loss: 0.2688599 Vali Accuracy: 0.9486216  Vali weighted F1: 0.9480446  Vali macro F1 0.9473315 
new best score!!!!
Validation loss decreased (0.667273 --> 0.268860).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.278425455093384
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1950460  Vali Loss: 0.1404946 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9699364  Vali macro F1 0.9691969 
new best score!!!!
Validation loss decreased (0.268860 --> 0.140495).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.276236534118652
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1157328  Vali Loss: 0.0918217 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912798  Vali macro F1 0.9906916 
new best score!!!!
Validation loss decreased (0.140495 --> 0.091822).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.278630256652832
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0791256  Vali Loss: 0.0642128 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937825  Vali macro F1 0.9929932 
new best score!!!!
Validation loss decreased (0.091822 --> 0.064213).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.2800211906433105
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0727384  Vali Loss: 0.0490088 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925280  Vali macro F1 0.9917545 
new best score!!!!
Validation loss decreased (0.064213 --> 0.049009).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.275437116622925
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0462259  Vali Loss: 0.0345089 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950099  Vali macro F1 0.9945168 
new best score!!!!
Validation loss decreased (0.049009 --> 0.034509).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.276538372039795
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0326409  Vali Loss: 0.0231048 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950153  Vali macro F1 0.9945523 
new best score!!!!
Validation loss decreased (0.034509 --> 0.023105).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.2776243686676025
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0325788  Vali Loss: 0.0326872 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.279265642166138
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0253825  Vali Loss: 0.0238294 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.280162811279297
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0219844  Vali Loss: 0.0228539 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.023105 --> 0.022854).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.278693199157715
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0241046  Vali Loss: 0.0171142 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.022854 --> 0.017114).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.2798216342926025
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0263811  Vali Loss: 0.0187245 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.276653289794922
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0205755  Vali Loss: 0.0144083 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.017114 --> 0.014408).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.274332046508789
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0155748  Vali Loss: 0.0108638 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.014408 --> 0.010864).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.275029897689819
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0138407  Vali Loss: 0.0100966 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.010864 --> 0.010097).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.2747955322265625
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0159460  Vali Loss: 0.0092173 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010097 --> 0.009217).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.274041175842285
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0147374  Vali Loss: 0.0159715 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.274027109146118
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0162758  Vali Loss: 0.0141120 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.269576072692871
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0140242  Vali Loss: 0.0095713 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.27222466468811
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0103692  Vali Loss: 0.0085674 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.009217 --> 0.008567).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.269396543502808
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0113045  Vali Loss: 0.0079628 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008567 --> 0.007963).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.274494647979736
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0099632  Vali Loss: 0.0106256 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.271756172180176
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0082506  Vali Loss: 0.0085254 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.267963171005249
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0109180  Vali Loss: 0.0265812 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911532  Vali macro F1 0.9905879 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.270874977111816
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0128312  Vali Loss: 0.0096069 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.267991304397583
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0091978  Vali Loss: 0.0150827 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937206  Vali macro F1 0.9934255 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 5.268795490264893
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0084446  Vali Loss: 0.0054175 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.007963 --> 0.005417).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 5.270501136779785
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0069787  Vali Loss: 0.0054909 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 5.27182149887085
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0056888  Vali Loss: 0.0055323 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 5.273616313934326
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0066758  Vali Loss: 0.0049827 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.005417 --> 0.004983).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.271790266036987
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0072437  Vali Loss: 0.0078538 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.272348642349243
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0091678  Vali Loss: 0.0056683 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.2734901905059814
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0058377  Vali Loss: 0.0040362 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.004983 --> 0.004036).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.272064685821533
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0052090  Vali Loss: 0.0042534 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.266849517822266
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0047428  Vali Loss: 0.0044137 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 5.2681684494018555
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0047096  Vali Loss: 0.0046020 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 5.267489910125732
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0048373  Vali Loss: 0.0043556 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 5.267274379730225
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0043703  Vali Loss: 0.0044829 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 5.2679009437561035
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0051498  Vali Loss: 0.0044922 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.277010202407837
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0044298  Vali Loss: 0.0046514 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.268572807312012
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0050380  Vali Loss: 0.0046024 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.268078088760376
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0067375  Vali Loss: 0.0045865 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.268898963928223
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0044236  Vali Loss: 0.0067798 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 5.2701756954193115
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0046664  Vali Loss: 0.0067606 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 5.26875901222229
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0047345  Vali Loss: 0.0067169 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 5.886180877685547
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0045598  Vali Loss: 0.0066659 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 5.267653942108154
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0044647  Vali Loss: 0.0066282 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 5.269056558609009
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0045955  Vali Loss: 0.0065967 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9429825  Test weighted F1: 0.9409414  Test macro F1 0.9409414 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.8948681354522705
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0057774  Vali Loss: 0.0041668 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
Validation loss decreased (inf --> 0.004167).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.884235858917236
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0052107  Vali Loss: 0.0045211 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 8.086267471313477
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0042299  Vali Loss: 0.0039099 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.004167 --> 0.003910).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.883435249328613
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0044610  Vali Loss: 0.0044958 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.888048887252808
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0036603  Vali Loss: 0.0044018 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.892043352127075
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0037485  Vali Loss: 0.0033304 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003910 --> 0.003330).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.894541263580322
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0036448  Vali Loss: 0.0033419 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.885718584060669
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0031936  Vali Loss: 0.0029338 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003330 --> 0.002934).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.889500379562378
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0078529  Vali Loss: 0.0037681 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.887364864349365
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0083786  Vali Loss: 0.0061534 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.885126829147339
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0063058  Vali Loss: 0.0026862 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002934 --> 0.002686).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.890625476837158
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0044089  Vali Loss: 0.0057298 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.891087770462036
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0041490  Vali Loss: 0.0049224 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.87884783744812
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0030953  Vali Loss: 0.0028392 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.893793821334839
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0028506  Vali Loss: 0.0025066 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002686 --> 0.002507).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.892939805984497
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0025509  Vali Loss: 0.0014558 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002507 --> 0.001456).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.89932656288147
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0049938  Vali Loss: 0.0106859 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.886339426040649
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0040048  Vali Loss: 0.0023916 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 7.830450057983398
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0028243  Vali Loss: 0.0034484 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.931167364120483
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0032481  Vali Loss: 0.0046975 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.889862298965454
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0029784  Vali Loss: 0.0035489 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 22 cost time: 6.887265920639038
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0024094  Vali Loss: 0.0037070 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.881496906280518
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0024480  Vali Loss: 0.0030435 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.884672164916992
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0023987  Vali Loss: 0.0030810 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.891814947128296
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0024457  Vali Loss: 0.0032253 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.887918949127197
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0022064  Vali Loss: 0.0030651 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 27 cost time: 6.88817024230957
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0018057  Vali Loss: 0.0030031 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.888289213180542
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0021961  Vali Loss: 0.0030309 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.881267070770264
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0024718  Vali Loss: 0.0030490 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.88767409324646
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0027105  Vali Loss: 0.0030495 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.8918657302856445
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0019501  Vali Loss: 0.0030291 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9385965  Test weighted F1: 0.9366774  Test macro F1 0.9366774 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.368077278137207
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8676852  Vali Loss: 0.6269290 Vali Accuracy: 0.8922306  Vali weighted F1: 0.8880892  Vali macro F1 0.8881572 
Validation loss decreased (inf --> 0.626929).  Saving model ...
Epoch: 2 cost time: 5.309745788574219
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4310781  Vali Loss: 0.2342161 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9674144  Vali macro F1 0.9656430 
new best score!!!!
Validation loss decreased (0.626929 --> 0.234216).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.307848930358887
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1895411  Vali Loss: 0.1290138 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835904  Vali macro F1 0.9825296 
new best score!!!!
Validation loss decreased (0.234216 --> 0.129014).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.307700157165527
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1090023  Vali Loss: 0.0895485 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810866  Vali macro F1 0.9798597 
new best score!!!!
Validation loss decreased (0.129014 --> 0.089549).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.309192657470703
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0724915  Vali Loss: 0.0705818 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863864  Vali macro F1 0.9854919 
new best score!!!!
Validation loss decreased (0.089549 --> 0.070582).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.307061433792114
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0666855  Vali Loss: 0.0612630 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875567  Vali macro F1 0.9863648 
new best score!!!!
Validation loss decreased (0.070582 --> 0.061263).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.312795162200928
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0487226  Vali Loss: 0.0561037 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9850006  Vali macro F1 0.9838760 
new best score!!!!
Validation loss decreased (0.061263 --> 0.056104).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.302978038787842
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0385905  Vali Loss: 0.0568167 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9850920  Vali macro F1 0.9834196 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.3039391040802
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0337676  Vali Loss: 0.0427426 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899950  Vali macro F1 0.9889849 
new best score!!!!
Validation loss decreased (0.056104 --> 0.042743).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.307681083679199
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0262393  Vali Loss: 0.0358743 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900875  Vali macro F1 0.9889368 
new best score!!!!
Validation loss decreased (0.042743 --> 0.035874).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.304048776626587
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0244577  Vali Loss: 0.0371873 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900875  Vali macro F1 0.9889368 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.3099565505981445
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0265008  Vali Loss: 0.0323593 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912968  Vali macro F1 0.9903926 
new best score!!!!
Validation loss decreased (0.035874 --> 0.032359).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.307457447052002
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0218590  Vali Loss: 0.0372093 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.308314800262451
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0209751  Vali Loss: 0.0257682 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
new best score!!!!
Validation loss decreased (0.032359 --> 0.025768).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.304550409317017
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0163871  Vali Loss: 0.0157073 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
new best score!!!!
Validation loss decreased (0.025768 --> 0.015707).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.30014967918396
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0166503  Vali Loss: 0.0193923 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.303574562072754
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0162965  Vali Loss: 0.0141371 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962537  Vali macro F1 0.9957576 
new best score!!!!
Validation loss decreased (0.015707 --> 0.014137).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.30970311164856
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0160591  Vali Loss: 0.0239965 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900669  Vali macro F1 0.9890404 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.306991815567017
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0136183  Vali Loss: 0.0231489 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912884  Vali macro F1 0.9903371 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.297995328903198
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0201639  Vali Loss: 0.0280967 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911761  Vali macro F1 0.9906002 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.298192262649536
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0137059  Vali Loss: 0.0342731 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887477  Vali macro F1 0.9876257 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.304502964019775
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0119888  Vali Loss: 0.0124769 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
new best score!!!!
Validation loss decreased (0.014137 --> 0.012477).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.302371025085449
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0094131  Vali Loss: 0.0130511 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.301331520080566
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0071582  Vali Loss: 0.0083812 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012477 --> 0.008381).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.303067445755005
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0060434  Vali Loss: 0.0094791 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.301418781280518
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0084358  Vali Loss: 0.0183144 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936838  Vali macro F1 0.9932524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.2952094078063965
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0086166  Vali Loss: 0.0208669 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.29838752746582
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0090169  Vali Loss: 0.0145876 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 5.298309803009033
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0062514  Vali Loss: 0.0185141 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 5.304912567138672
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0051539  Vali Loss: 0.0112511 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950153  Vali macro F1 0.9945523 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 5.294485330581665
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0044994  Vali Loss: 0.0087132 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962529  Vali macro F1 0.9959384 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 5.298902750015259
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0043461  Vali Loss: 0.0083488 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962529  Vali macro F1 0.9959384 
new best score!!!!
Validation loss decreased (0.008381 --> 0.008349).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 5.296414852142334
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0057813  Vali Loss: 0.0089229 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 5.294355630874634
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0050831  Vali Loss: 0.0080221 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.008349 --> 0.008022).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.2995219230651855
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0046344  Vali Loss: 0.0080678 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 5.296514511108398
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0045938  Vali Loss: 0.0070627 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.008022 --> 0.007063).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 5.298234939575195
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0040119  Vali Loss: 0.0072354 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.297256231307983
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0039561  Vali Loss: 0.0070030 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007063 --> 0.007003).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 5.30158805847168
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0038750  Vali Loss: 0.0068807 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007003 --> 0.006881).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.303548812866211
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0038284  Vali Loss: 0.0064386 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006881 --> 0.006439).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 5.301704406738281
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0036562  Vali Loss: 0.0064690 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 5.304487943649292
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0039355  Vali Loss: 0.0062630 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006439 --> 0.006263).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 5.299070835113525
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0036558  Vali Loss: 0.0069395 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.294757127761841
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0036179  Vali Loss: 0.0065069 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 5.296474933624268
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0033044  Vali Loss: 0.0057065 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.006263 --> 0.005706).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 5.298441648483276
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0035167  Vali Loss: 0.0075427 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 5.301496505737305
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0035184  Vali Loss: 0.0076314 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 5.296767711639404
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0035999  Vali Loss: 0.0067641 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 5.302417993545532
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0032363  Vali Loss: 0.0068494 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 5.298824310302734
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0034263  Vali Loss: 0.0067377 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 5.29639744758606
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0028983  Vali Loss: 0.0067078 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 5.299365997314453
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0029558  Vali Loss: 0.0067153 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 5.294970273971558
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0030480  Vali Loss: 0.0067139 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 5.298482894897461
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0034508  Vali Loss: 0.0067365 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 5.2917633056640625
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0031673  Vali Loss: 0.0068006 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 56 cost time: 5.293833017349243
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0035313  Vali Loss: 0.0067944 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 5.29536247253418
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0029219  Vali Loss: 0.0067883 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 5.292051792144775
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0029828  Vali Loss: 0.0067801 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 5.294896602630615
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0031699  Vali Loss: 0.0067798 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 5.293967008590698
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0029273  Vali Loss: 0.0067766 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9254386  Test weighted F1: 0.9092529  Test macro F1 0.9092529 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.967630386352539
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0040197  Vali Loss: 0.0074623 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
Validation loss decreased (inf --> 0.007462).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.855762720108032
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0030812  Vali Loss: 0.0061367 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.007462 --> 0.006137).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.853206157684326
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0035876  Vali Loss: 0.0050270 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
new best score!!!!
Validation loss decreased (0.006137 --> 0.005027).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.851938486099243
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0028892  Vali Loss: 0.0046583 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.005027 --> 0.004658).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.853209972381592
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0027713  Vali Loss: 0.0039043 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.004658 --> 0.003904).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.865756034851074
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0026609  Vali Loss: 0.0044301 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.862314701080322
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0024637  Vali Loss: 0.0037163 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.003904 --> 0.003716).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.86966347694397
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0023364  Vali Loss: 0.0038179 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.865048170089722
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0023751  Vali Loss: 0.0038084 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.86931848526001
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0022668  Vali Loss: 0.0034929 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003716 --> 0.003493).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.868659973144531
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0021139  Vali Loss: 0.0039318 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.86932635307312
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0020632  Vali Loss: 0.0033563 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003493 --> 0.003356).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.867728233337402
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0019566  Vali Loss: 0.0034826 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.869508981704712
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0017437  Vali Loss: 0.0035132 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.876983404159546
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0018874  Vali Loss: 0.0033353 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
new best score!!!!
Validation loss decreased (0.003356 --> 0.003335).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.8717827796936035
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0022703  Vali Loss: 0.0026471 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.003335 --> 0.002647).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.876539468765259
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0023251  Vali Loss: 0.0035042 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.872069835662842
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0022006  Vali Loss: 0.0031189 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.871754169464111
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0017265  Vali Loss: 0.0032834 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.86470627784729
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0017023  Vali Loss: 0.0024317 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
new best score!!!!
Validation loss decreased (0.002647 --> 0.002432).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 6.87542200088501
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0017747  Vali Loss: 0.0026667 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.868528366088867
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0026077  Vali Loss: 0.0025315 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.866776704788208
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0038836  Vali Loss: 0.0136539 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923593  Vali macro F1 0.9920441 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.8657166957855225
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0038069  Vali Loss: 0.0066086 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.864271640777588
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0031193  Vali Loss: 0.0039291 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 26 cost time: 6.87184739112854
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0023479  Vali Loss: 0.0038599 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.873422622680664
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0028780  Vali Loss: 0.0027790 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.872084379196167
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0017679  Vali Loss: 0.0027078 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.867393732070923
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0021657  Vali Loss: 0.0028705 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.865996837615967
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0023370  Vali Loss: 0.0035479 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 6.868731260299683
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0016572  Vali Loss: 0.0034248 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.873928546905518
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0016255  Vali Loss: 0.0032798 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.869911193847656
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0015272  Vali Loss: 0.0031786 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.86897087097168
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0015050  Vali Loss: 0.0029896 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.8686628341674805
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0018151  Vali Loss: 0.0027720 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987505  Vali macro F1 0.9985832 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9078947  Test weighted F1: 0.8917139  Test macro F1 0.8917139 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.419424533843994
VALI: Epoch: 1, Steps: 29 | Train Loss: 1.8520166  Vali Loss: 0.6719988 Vali Accuracy: 0.8809524  Vali weighted F1: 0.8788175  Vali macro F1 0.8800188 
Validation loss decreased (inf --> 0.671999).  Saving model ...
Epoch: 2 cost time: 5.312114238739014
VALI: Epoch: 2, Steps: 29 | Train Loss: 0.4362331  Vali Loss: 0.2248408 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9734058  Vali macro F1 0.9734113 
new best score!!!!
Validation loss decreased (0.671999 --> 0.224841).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.307119131088257
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.1852607  Vali Loss: 0.1183257 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899960  Vali macro F1 0.9898832 
new best score!!!!
Validation loss decreased (0.224841 --> 0.118326).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.313360214233398
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.1055264  Vali Loss: 0.0713581 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937239  Vali macro F1 0.9935241 
new best score!!!!
Validation loss decreased (0.118326 --> 0.071358).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.326536178588867
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0704364  Vali Loss: 0.0482217 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
new best score!!!!
Validation loss decreased (0.071358 --> 0.048222).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.31226372718811
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0529851  Vali Loss: 0.0416881 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950173  Vali macro F1 0.9944866 
new best score!!!!
Validation loss decreased (0.048222 --> 0.041688).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.313645839691162
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0420180  Vali Loss: 0.0382717 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962367  Vali macro F1 0.9958520 
new best score!!!!
Validation loss decreased (0.041688 --> 0.038272).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.310575246810913
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0303756  Vali Loss: 0.0569792 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987427  Vali macro F1 0.9985653 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 5.310732126235962
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0246370  Vali Loss: 0.0192732 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974983  Vali macro F1 0.9972947 
new best score!!!!
Validation loss decreased (0.038272 --> 0.019273).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.310737371444702
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0269924  Vali Loss: 0.0405171 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887355  Vali macro F1 0.9877442 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.314371347427368
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0292256  Vali Loss: 0.0163076 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9974356 
new best score!!!!
Validation loss decreased (0.019273 --> 0.016308).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.309360027313232
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0201533  Vali Loss: 0.0124223 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987478  Vali macro F1 0.9987115 
new best score!!!!
Validation loss decreased (0.016308 --> 0.012422).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.30788779258728
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0143064  Vali Loss: 0.0108934 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974983  Vali macro F1 0.9972947 
new best score!!!!
Validation loss decreased (0.012422 --> 0.010893).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.31007719039917
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0132162  Vali Loss: 0.0086295 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010893 --> 0.008629).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.310728311538696
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0145491  Vali Loss: 0.0109220 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.313310384750366
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0094566  Vali Loss: 0.0063555 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008629 --> 0.006355).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.309918403625488
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0076802  Vali Loss: 0.0062199 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
new best score!!!!
Validation loss decreased (0.006355 --> 0.006220).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.314749479293823
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0108590  Vali Loss: 0.0073527 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.306366205215454
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0162380  Vali Loss: 0.0207460 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950017  Vali macro F1 0.9954038 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.303851366043091
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0152252  Vali Loss: 0.0104187 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 5.30449652671814
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0137558  Vali Loss: 0.0109663 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962405  Vali macro F1 0.9962724 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 5.303282976150513
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0083204  Vali Loss: 0.0069914 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 5.301065683364868
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0054138  Vali Loss: 0.0063378 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 5.30224084854126
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0050520  Vali Loss: 0.0067481 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 5.305900573730469
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0051797  Vali Loss: 0.0069346 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 5.30456018447876
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0041071  Vali Loss: 0.0068200 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 5.305642604827881
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0036335  Vali Loss: 0.0066795 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 28 cost time: 5.303693056106567
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0035525  Vali Loss: 0.0066177 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.311480283737183
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0036257  Vali Loss: 0.0066155 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.31058406829834
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0037200  Vali Loss: 0.0066317 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 5.304967403411865
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0038181  Vali Loss: 0.0066269 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 5.304809808731079
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0035375  Vali Loss: 0.0066029 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8307018  Test weighted F1: 0.7933940  Test macro F1 0.7933940 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 913548
pruned model Parameter : 918307
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.91761326789856
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0059445  Vali Loss: 0.0054387 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
Validation loss decreased (inf --> 0.005439).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.914287090301514
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0056415  Vali Loss: 0.0042995 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005439 --> 0.004300).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.908043146133423
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0057216  Vali Loss: 0.0036715 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004300 --> 0.003671).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.913555383682251
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0039853  Vali Loss: 0.0032003 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003671 --> 0.003200).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.911649465560913
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0040835  Vali Loss: 0.0037266 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.913085699081421
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0036299  Vali Loss: 0.0027956 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003200 --> 0.002796).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.9112632274627686
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0031519  Vali Loss: 0.0028876 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.905589818954468
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0032940  Vali Loss: 0.0029437 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.903289556503296
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0029757  Vali Loss: 0.0027435 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002796 --> 0.002744).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.915695667266846
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0032880  Vali Loss: 0.0034919 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.915147304534912
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0030268  Vali Loss: 0.0028670 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.921281099319458
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0020475  Vali Loss: 0.0023103 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002744 --> 0.002310).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.919720649719238
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0022672  Vali Loss: 0.0025195 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.913022756576538
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0024660  Vali Loss: 0.0039584 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.910887718200684
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0019065  Vali Loss: 0.0028871 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.9129273891448975
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0016678  Vali Loss: 0.0030689 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.904334783554077
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0013862  Vali Loss: 0.0033647 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9985752 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 6.912792205810547
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0012110  Vali Loss: 0.0028173 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9985752 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.9172844886779785
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0012886  Vali Loss: 0.0031276 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9985752 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.90954327583313
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0010119  Vali Loss: 0.0026516 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.907084226608276
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0010581  Vali Loss: 0.0022630 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002310 --> 0.002263).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 6.907945871353149
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0010325  Vali Loss: 0.0025029 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.913053035736084
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0027254  Vali Loss: 0.0075619 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.911564588546753
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0042615  Vali Loss: 0.0028616 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.912974119186401
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0029135  Vali Loss: 0.0034139 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.907440900802612
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0013970  Vali Loss: 0.0021206 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
new best score!!!!
Validation loss decreased (0.002263 --> 0.002121).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.9146482944488525
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0009786  Vali Loss: 0.0023615 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.9129273891448975
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0014445  Vali Loss: 0.0026199 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987484  Vali macro F1 0.9987625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.904524087905884
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0025894  Vali Loss: 0.0113119 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962566  Vali macro F1 0.9962076 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.905805587768555
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0027106  Vali Loss: 0.0024402 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.911794900894165
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0014087  Vali Loss: 0.0051018 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9976149 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 32 cost time: 6.914390563964844
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0014455  Vali Loss: 0.0043955 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 6.910891056060791
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0011820  Vali Loss: 0.0038483 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 6.907602787017822
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0013036  Vali Loss: 0.0037462 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 6.912424802780151
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0011358  Vali Loss: 0.0036642 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 6.900954246520996
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0010483  Vali Loss: 0.0035544 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 37 cost time: 6.905883312225342
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0009536  Vali Loss: 0.0035457 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 6.913073778152466
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0010601  Vali Loss: 0.0035327 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 6.906285524368286
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0009251  Vali Loss: 0.0035194 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 6.908426761627197
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0011106  Vali Loss: 0.0035049 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 6.914601802825928
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0009193  Vali Loss: 0.0034903 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8201754  Test weighted F1: 0.7849379  Test macro F1 0.7849379 

============================= JOB FEEDBACK =============================

NodeName=uc2n565
Job ID: 20948456
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 05:57:27
CPU Efficiency: 4.92% of 5-01:03:40 core-walltime
Job Wall-clock time: 06:03:11
Memory Utilized: 6.97 GB
Memory Efficiency: 0.00% of 0.00 MB
