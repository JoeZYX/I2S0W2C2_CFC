Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 104364
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.6905949115753174
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8712910  Vali Loss: 2.3777299 Vali Accuracy: 0.4436090  Vali weighted F1: 0.3709566  Vali macro F1 0.3754035 
Validation loss decreased (inf --> 2.377730).  Saving model ...
Epoch: 2 cost time: 3.4307093620300293
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7536057  Vali Loss: 1.1808917 Vali Accuracy: 0.8045113  Vali weighted F1: 0.7842525  Vali macro F1 0.7765821 
new best score!!!!
Validation loss decreased (2.377730 --> 1.180892).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.4239795207977295
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0136865  Vali Loss: 0.7256082 Vali Accuracy: 0.8847118  Vali weighted F1: 0.8670400  Vali macro F1 0.8619806 
new best score!!!!
Validation loss decreased (1.180892 --> 0.725608).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.4285576343536377
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6768999  Vali Loss: 0.5139833 Vali Accuracy: 0.9122807  Vali weighted F1: 0.8988689  Vali macro F1 0.8947456 
new best score!!!!
Validation loss decreased (0.725608 --> 0.513983).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.426435947418213
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4942146  Vali Loss: 0.3577159 Vali Accuracy: 0.9448622  Vali weighted F1: 0.9419433  Vali macro F1 0.9393832 
new best score!!!!
Validation loss decreased (0.513983 --> 0.357716).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4284844398498535
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3836050  Vali Loss: 0.2799122 Vali Accuracy: 0.9523810  Vali weighted F1: 0.9503958  Vali macro F1 0.9476781 
new best score!!!!
Validation loss decreased (0.357716 --> 0.279912).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.422908067703247
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3047071  Vali Loss: 0.2231694 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9726835  Vali macro F1 0.9709922 
new best score!!!!
Validation loss decreased (0.279912 --> 0.223169).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.439296245574951
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2474438  Vali Loss: 0.1988099 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9674590  Vali macro F1 0.9657881 
new best score!!!!
Validation loss decreased (0.223169 --> 0.198810).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.463942527770996
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2154504  Vali Loss: 0.1550302 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822354  Vali macro F1 0.9815586 
new best score!!!!
Validation loss decreased (0.198810 --> 0.155030).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.475295305252075
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1718227  Vali Loss: 0.1280063 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810393  Vali macro F1 0.9797643 
new best score!!!!
Validation loss decreased (0.155030 --> 0.128006).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.4244260787963867
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1412532  Vali Loss: 0.1097365 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9834364  Vali macro F1 0.9827620 
new best score!!!!
Validation loss decreased (0.128006 --> 0.109737).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.4230034351348877
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1205014  Vali Loss: 0.0931044 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872634  Vali macro F1 0.9868291 
new best score!!!!
Validation loss decreased (0.109737 --> 0.093104).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4174587726593018
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1044546  Vali Loss: 0.0814592 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847660  Vali macro F1 0.9843729 
new best score!!!!
Validation loss decreased (0.093104 --> 0.081459).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.422224998474121
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0922723  Vali Loss: 0.0735367 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885599  Vali macro F1 0.9882173 
new best score!!!!
Validation loss decreased (0.081459 --> 0.073537).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4144017696380615
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0820577  Vali Loss: 0.0687028 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860477  Vali macro F1 0.9858087 
new best score!!!!
Validation loss decreased (0.073537 --> 0.068703).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.4244186878204346
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0812101  Vali Loss: 0.0705343 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835624  Vali macro F1 0.9817890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 3.417736768722534
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0741466  Vali Loss: 0.0579474 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899329  Vali macro F1 0.9895353 
new best score!!!!
Validation loss decreased (0.068703 --> 0.057947).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.425982713699341
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0628338  Vali Loss: 0.0503738 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.057947 --> 0.050374).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.4509551525115967
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0615718  Vali Loss: 0.0516386 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898599  Vali macro F1 0.9896314 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.474118947982788
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0550665  Vali Loss: 0.0455167 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
new best score!!!!
Validation loss decreased (0.050374 --> 0.045517).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.423609972000122
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0578143  Vali Loss: 0.0402806 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.045517 --> 0.040281).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.4190471172332764
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0446724  Vali Loss: 0.0472898 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898493  Vali macro F1 0.9895478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 3.4203505516052246
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0395861  Vali Loss: 0.0368458 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924696  Vali macro F1 0.9921442 
new best score!!!!
Validation loss decreased (0.040281 --> 0.036846).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.4178647994995117
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0384235  Vali Loss: 0.0363928 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924696  Vali macro F1 0.9921442 
new best score!!!!
Validation loss decreased (0.036846 --> 0.036393).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.4182376861572266
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0379281  Vali Loss: 0.0356328 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.036393 --> 0.035633).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4187426567077637
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0349429  Vali Loss: 0.0324613 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.035633 --> 0.032461).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.418107271194458
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0371103  Vali Loss: 0.0317504 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.032461 --> 0.031750).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.4205594062805176
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0323981  Vali Loss: 0.0313622 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.031750 --> 0.031362).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.421265125274658
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0282684  Vali Loss: 0.0360328 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.4295620918273926
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0332420  Vali Loss: 0.0291110 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.031362 --> 0.029111).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.474191188812256
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0279929  Vali Loss: 0.0266889 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949844  Vali macro F1 0.9948010 
new best score!!!!
Validation loss decreased (0.029111 --> 0.026689).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.443209648132324
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0264697  Vali Loss: 0.0297533 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.419682741165161
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0260226  Vali Loss: 0.0292743 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 3.418501138687134
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0216882  Vali Loss: 0.0265518 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
new best score!!!!
Validation loss decreased (0.026689 --> 0.026552).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.4193408489227295
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0267285  Vali Loss: 0.0312722 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.422450065612793
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0353598  Vali Loss: 0.0270062 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912214  Vali macro F1 0.9908474 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.417619466781616
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0252605  Vali Loss: 0.0229887 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.026552 --> 0.022989).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.421250104904175
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0221037  Vali Loss: 0.0326067 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912933  Vali macro F1 0.9910511 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 3.418213367462158
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0265918  Vali Loss: 0.0249506 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912054  Vali macro F1 0.9908379 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 3.4217519760131836
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0186229  Vali Loss: 0.0249498 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899595  Vali macro F1 0.9895435 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 3.426007032394409
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0187209  Vali Loss: 0.0206936 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937343  Vali macro F1 0.9935023 
new best score!!!!
Validation loss decreased (0.022989 --> 0.020694).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.459108352661133
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0225652  Vali Loss: 0.0490474 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821513  Vali macro F1 0.9817047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.4682958126068115
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0244172  Vali Loss: 0.0271782 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.420635223388672
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0156827  Vali Loss: 0.0221052 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 3.415029764175415
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0140328  Vali Loss: 0.0262431 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911045  Vali macro F1 0.9909019 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 3.4179842472076416
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0142128  Vali Loss: 0.0191353 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.020694 --> 0.019135).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.4147918224334717
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0135434  Vali Loss: 0.0186303 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.019135 --> 0.018630).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.416130304336548
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0134845  Vali Loss: 0.0181692 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.018630 --> 0.018169).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 3.4186601638793945
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0220366  Vali Loss: 0.0203887 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 3.4163379669189453
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0340360  Vali Loss: 0.0238723 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899774  Vali macro F1 0.9893936 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 3.420919895172119
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0579609  Vali Loss: 0.0409177 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9834779  Vali macro F1 0.9830671 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 3.4263429641723633
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0331055  Vali Loss: 0.0277783 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 3.421250581741333
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0273431  Vali Loss: 0.0208630 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899756  Vali macro F1 0.9895435 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 54 cost time: 3.4902288913726807
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0219001  Vali Loss: 0.0183214 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912307  Vali macro F1 0.9908976 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 3.4354114532470703
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0194138  Vali Loss: 0.0178306 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.018169 --> 0.017831).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 3.4194600582122803
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0191821  Vali Loss: 0.0198205 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899729  Vali macro F1 0.9895490 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 3.421804904937744
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0180834  Vali Loss: 0.0184459 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 3.41300368309021
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0183247  Vali Loss: 0.0189676 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 3.41326642036438
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0177230  Vali Loss: 0.0178771 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 3.41369366645813
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0170397  Vali Loss: 0.0176392 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
new best score!!!!
Validation loss decreased (0.017831 --> 0.017639).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 3.415604829788208
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0186011  Vali Loss: 0.0180151 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 3.413011074066162
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0165433  Vali Loss: 0.0171127 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.017639 --> 0.017113).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 3.422206163406372
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0163007  Vali Loss: 0.0169832 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.017113 --> 0.016983).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 3.414397716522217
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0162951  Vali Loss: 0.0169504 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.016983 --> 0.016950).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 3.4576687812805176
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0164105  Vali Loss: 0.0171557 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 3.450049877166748
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0156660  Vali Loss: 0.0170162 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 3.410719394683838
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0163022  Vali Loss: 0.0166620 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.016950 --> 0.016662).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 3.4054322242736816
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0155687  Vali Loss: 0.0161724 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.016662 --> 0.016172).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 3.406491756439209
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0155296  Vali Loss: 0.0166690 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 3.4085817337036133
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0164028  Vali Loss: 0.0163915 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 3.405965805053711
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0154881  Vali Loss: 0.0166073 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 3.407137155532837
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0150884  Vali Loss: 0.0174092 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 3.4040424823760986
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0165460  Vali Loss: 0.0180756 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 74 cost time: 3.408996820449829
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0147536  Vali Loss: 0.0180857 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 3.413468837738037
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0145980  Vali Loss: 0.0182485 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 3.399571180343628
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0151792  Vali Loss: 0.0183052 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 3.470823287963867
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0150492  Vali Loss: 0.0182061 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 3.4091238975524902
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0155869  Vali Loss: 0.0182880 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 79 cost time: 3.3981735706329346
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0147680  Vali Loss: 0.0183092 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 3.393225908279419
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0170368  Vali Loss: 0.0183235 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 3.396929979324341
VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0141031  Vali Loss: 0.0183394 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 3.391547918319702
VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0144182  Vali Loss: 0.0183510 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 3.39924955368042
VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0142518  Vali Loss: 0.0183668 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8456140  Test weighted F1: 0.8212891  Test macro F1 0.8212891 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.821526527404785
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0154026  Vali Loss: 0.0169926 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
Validation loss decreased (inf --> 0.016993).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.820333480834961
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0141932  Vali Loss: 0.0187288 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.822740077972412
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0145720  Vali Loss: 0.0177274 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.822006464004517
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0127836  Vali Loss: 0.0184572 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 4.823502540588379
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0128632  Vali Loss: 0.0182068 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 4.823332786560059
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0138833  Vali Loss: 0.0197257 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 4.823554515838623
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0123887  Vali Loss: 0.0176418 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 4.820969581604004
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0119388  Vali Loss: 0.0177073 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 4.821819067001343
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0131087  Vali Loss: 0.0178494 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 4.8183043003082275
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0118681  Vali Loss: 0.0165967 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.016993 --> 0.016597).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.822911500930786
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0122973  Vali Loss: 0.0162619 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.016597 --> 0.016262).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.821847915649414
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0105641  Vali Loss: 0.0171489 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.824930191040039
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0105530  Vali Loss: 0.0162401 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.016262 --> 0.016240).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.8216211795806885
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0109438  Vali Loss: 0.0149125 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.016240 --> 0.014913).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.819366216659546
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0105943  Vali Loss: 0.0165584 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.820209503173828
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0111718  Vali Loss: 0.0157521 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 4.829066276550293
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0110569  Vali Loss: 0.0153973 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 4.822583436965942
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0099096  Vali Loss: 0.0173998 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 4.825290203094482
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0104644  Vali Loss: 0.0145970 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
new best score!!!!
Validation loss decreased (0.014913 --> 0.014597).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.822531461715698
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0103569  Vali Loss: 0.0165367 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.8271448612213135
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0103839  Vali Loss: 0.0150120 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912147  Vali macro F1 0.9908976 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.824873447418213
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0092753  Vali Loss: 0.0154391 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 4.822423458099365
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0091815  Vali Loss: 0.0150086 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 4.822491884231567
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0097257  Vali Loss: 0.0184130 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 4.82175087928772
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0099540  Vali Loss: 0.0179855 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.820388078689575
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0097015  Vali Loss: 0.0164576 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 4.820159196853638
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0102015  Vali Loss: 0.0160314 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 4.824357509613037
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0089017  Vali Loss: 0.0157644 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 4.822463035583496
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0089681  Vali Loss: 0.0153273 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 4.822065591812134
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0094184  Vali Loss: 0.0153709 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 4.822549819946289
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0094010  Vali Loss: 0.0153526 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 4.824963331222534
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0089644  Vali Loss: 0.0153511 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 4.822591304779053
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0084120  Vali Loss: 0.0153348 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 4.820906162261963
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0092750  Vali Loss: 0.0153112 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8438596  Test weighted F1: 0.8169823  Test macro F1 0.8169823 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.490844249725342
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8659382  Vali Loss: 2.3717547 Vali Accuracy: 0.4135338  Vali weighted F1: 0.3335388  Vali macro F1 0.3463190 
Validation loss decreased (inf --> 2.371755).  Saving model ...
Epoch: 2 cost time: 3.4233756065368652
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7582921  Vali Loss: 1.1740629 Vali Accuracy: 0.8245614  Vali weighted F1: 0.8134785  Vali macro F1 0.8098457 
new best score!!!!
Validation loss decreased (2.371755 --> 1.174063).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.478074550628662
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0267210  Vali Loss: 0.7356520 Vali Accuracy: 0.8959900  Vali weighted F1: 0.8857173  Vali macro F1 0.8814257 
new best score!!!!
Validation loss decreased (1.174063 --> 0.735652).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.4300060272216797
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6893737  Vali Loss: 0.5059793 Vali Accuracy: 0.9385965  Vali weighted F1: 0.9347468  Vali macro F1 0.9314279 
new best score!!!!
Validation loss decreased (0.735652 --> 0.505979).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.418774127960205
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5046795  Vali Loss: 0.3775140 Vali Accuracy: 0.9486216  Vali weighted F1: 0.9465878  Vali macro F1 0.9443367 
new best score!!!!
Validation loss decreased (0.505979 --> 0.377514).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4083502292633057
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3963441  Vali Loss: 0.3056889 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9498713  Vali macro F1 0.9468262 
new best score!!!!
Validation loss decreased (0.377514 --> 0.305689).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4130802154541016
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3164111  Vali Loss: 0.2365532 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9694683  Vali macro F1 0.9680692 
new best score!!!!
Validation loss decreased (0.305689 --> 0.236553).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.412917137145996
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2513698  Vali Loss: 0.1891260 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9772149  Vali macro F1 0.9758251 
new best score!!!!
Validation loss decreased (0.236553 --> 0.189126).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.4117541313171387
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2226107  Vali Loss: 0.1647129 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9792350  Vali macro F1 0.9786161 
new best score!!!!
Validation loss decreased (0.189126 --> 0.164713).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.4119343757629395
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1763660  Vali Loss: 0.1259538 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9819396  Vali macro F1 0.9811347 
new best score!!!!
Validation loss decreased (0.164713 --> 0.125954).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.411426544189453
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1397101  Vali Loss: 0.1100610 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9844253  Vali macro F1 0.9843265 
new best score!!!!
Validation loss decreased (0.125954 --> 0.110061).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.4085612297058105
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1276168  Vali Loss: 0.0974079 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9790822  Vali macro F1 0.9786403 
new best score!!!!
Validation loss decreased (0.110061 --> 0.097408).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4100570678710938
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1351992  Vali Loss: 0.0995745 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886321  Vali macro F1 0.9879214 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 3.415616750717163
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.1059205  Vali Loss: 0.0809970 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873629  Vali macro F1 0.9872411 
new best score!!!!
Validation loss decreased (0.097408 --> 0.080997).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4644079208374023
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0977554  Vali Loss: 0.0787028 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886070  Vali macro F1 0.9885350 
new best score!!!!
Validation loss decreased (0.080997 --> 0.078703).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.445762872695923
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0838873  Vali Loss: 0.0691433 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848889  Vali macro F1 0.9844321 
new best score!!!!
Validation loss decreased (0.078703 --> 0.069143).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.4100306034088135
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0793080  Vali Loss: 0.0626848 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885617  Vali macro F1 0.9880674 
new best score!!!!
Validation loss decreased (0.069143 --> 0.062685).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.41161847114563
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0662486  Vali Loss: 0.0515487 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936646  Vali macro F1 0.9935699 
new best score!!!!
Validation loss decreased (0.062685 --> 0.051549).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.4097845554351807
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0614678  Vali Loss: 0.0492391 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911342  Vali macro F1 0.9911527 
new best score!!!!
Validation loss decreased (0.051549 --> 0.049239).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.4117400646209717
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0514176  Vali Loss: 0.0434631 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.049239 --> 0.043463).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.4109530448913574
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0526422  Vali Loss: 0.0445762 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.4092397689819336
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0467409  Vali Loss: 0.0415480 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.043463 --> 0.041548).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.409027338027954
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0412336  Vali Loss: 0.0369096 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924156  Vali macro F1 0.9922721 
new best score!!!!
Validation loss decreased (0.041548 --> 0.036910).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.4175572395324707
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0368895  Vali Loss: 0.0390669 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874018  Vali macro F1 0.9870510 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.412478446960449
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0348005  Vali Loss: 0.0344905 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.036910 --> 0.034490).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.434339761734009
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0309657  Vali Loss: 0.0346428 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.466168165206909
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0311527  Vali Loss: 0.0323379 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.034490 --> 0.032338).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.4165291786193848
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0283140  Vali Loss: 0.0314742 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.032338 --> 0.031474).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.4094698429107666
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0260418  Vali Loss: 0.0309361 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.031474 --> 0.030936).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.406691074371338
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0272927  Vali Loss: 0.0297030 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.030936 --> 0.029703).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.4076600074768066
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0246581  Vali Loss: 0.0296716 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.029703 --> 0.029672).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.408195972442627
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0270034  Vali Loss: 0.0265689 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.029672 --> 0.026569).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.4101693630218506
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0220380  Vali Loss: 0.0266027 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.403796434402466
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0212160  Vali Loss: 0.0314779 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911337  Vali macro F1 0.9907451 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 3.406654119491577
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0256357  Vali Loss: 0.0326658 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 3.407681941986084
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0260031  Vali Loss: 0.0264297 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.026569 --> 0.026430).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.4144349098205566
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0242180  Vali Loss: 0.0531891 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9782536  Vali macro F1 0.9752890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 3.460784435272217
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0246753  Vali Loss: 0.0230294 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.026430 --> 0.023029).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.4459991455078125
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0183963  Vali Loss: 0.0248082 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.4114792346954346
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0236883  Vali Loss: 0.0237680 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886446  Vali macro F1 0.9883573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 3.398336172103882
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0204400  Vali Loss: 0.0221253 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.023029 --> 0.022125).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.4028806686401367
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0181183  Vali Loss: 0.0300733 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.396420478820801
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0217485  Vali Loss: 0.0257426 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.3994483947753906
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0172797  Vali Loss: 0.0199821 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911402  Vali macro F1 0.9909537 
new best score!!!!
Validation loss decreased (0.022125 --> 0.019982).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.4015140533447266
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0141932  Vali Loss: 0.0211960 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.4000096321105957
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0139420  Vali Loss: 0.0208387 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.4035637378692627
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0126128  Vali Loss: 0.0189868 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911402  Vali macro F1 0.9909537 
new best score!!!!
Validation loss decreased (0.019982 --> 0.018987).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.399022340774536
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0131804  Vali Loss: 0.0230092 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911402  Vali macro F1 0.9909537 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.4271483421325684
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0136082  Vali Loss: 0.0224441 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.4553699493408203
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0114194  Vali Loss: 0.0220925 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.4035720825195312
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0143585  Vali Loss: 0.0207031 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 3.397352695465088
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0131544  Vali Loss: 0.0181084 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911402  Vali macro F1 0.9909537 
new best score!!!!
Validation loss decreased (0.018987 --> 0.018108).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 3.399810314178467
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0109117  Vali Loss: 0.0197706 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898931  Vali macro F1 0.9896568 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.4012420177459717
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0106759  Vali Loss: 0.0205967 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898931  Vali macro F1 0.9896568 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.399073362350464
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0104567  Vali Loss: 0.0244582 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.4010114669799805
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0132121  Vali Loss: 0.0171309 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.018108 --> 0.017131).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 3.399420738220215
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0139825  Vali Loss: 0.0157101 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.017131 --> 0.015710).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 3.3993992805480957
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0156110  Vali Loss: 0.0250372 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897296  Vali macro F1 0.9895415 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.4008636474609375
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0126092  Vali Loss: 0.0169954 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898933  Vali macro F1 0.9896344 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 3.408963203430176
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0094388  Vali Loss: 0.0198557 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 3.45354962348938
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0107563  Vali Loss: 0.0193960 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 3.4345715045928955
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0083241  Vali Loss: 0.0184237 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 63 cost time: 3.402961254119873
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0083577  Vali Loss: 0.0195192 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 3.3987514972686768
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0067633  Vali Loss: 0.0202754 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 3.399819850921631
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0074161  Vali Loss: 0.0197446 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 3.396681547164917
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0076571  Vali Loss: 0.0202604 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 3.3986260890960693
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0067080  Vali Loss: 0.0205388 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 68 cost time: 3.399109125137329
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0071008  Vali Loss: 0.0204420 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 3.3981146812438965
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0074282  Vali Loss: 0.0203214 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 3.4049227237701416
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0068325  Vali Loss: 0.0203363 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 3.400602340698242
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0068779  Vali Loss: 0.0202934 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 3.41343092918396
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0069855  Vali Loss: 0.0201897 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9587719  Test weighted F1: 0.9543612  Test macro F1 0.9543612 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.816114187240601
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0096152  Vali Loss: 0.0176835 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
Validation loss decreased (inf --> 0.017683).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.8117969036102295
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0089484  Vali Loss: 0.0169595 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.017683 --> 0.016960).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.810363054275513
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0079231  Vali Loss: 0.0179389 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.8099894523620605
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0081787  Vali Loss: 0.0190167 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 4.810260772705078
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0089368  Vali Loss: 0.0184652 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 4.806479454040527
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0078885  Vali Loss: 0.0185286 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 4.809683084487915
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0073784  Vali Loss: 0.0178691 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 4.80962061882019
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0076263  Vali Loss: 0.0183200 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.8095972537994385
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0072669  Vali Loss: 0.0200143 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 4.808849096298218
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0071337  Vali Loss: 0.0185772 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 4.811075210571289
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0072299  Vali Loss: 0.0192762 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 4.81017279624939
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0062804  Vali Loss: 0.0189849 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 4.809659242630005
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0060425  Vali Loss: 0.0188575 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.808898687362671
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0057581  Vali Loss: 0.0186378 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.811127185821533
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0059610  Vali Loss: 0.0187758 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.812365770339966
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0062655  Vali Loss: 0.0187869 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 4.810226202011108
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0058181  Vali Loss: 0.0187533 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9605263  Test weighted F1: 0.9579003  Test macro F1 0.9579003 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4849376678466797
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8568597  Vali Loss: 2.3178358 Vali Accuracy: 0.4448622  Vali weighted F1: 0.3576117  Vali macro F1 0.3660622 
Validation loss decreased (inf --> 2.317836).  Saving model ...
Epoch: 2 cost time: 3.4081833362579346
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7373338  Vali Loss: 1.1702649 Vali Accuracy: 0.8095238  Vali weighted F1: 0.7907393  Vali macro F1 0.7890046 
new best score!!!!
Validation loss decreased (2.317836 --> 1.170265).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.411447763442993
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0456231  Vali Loss: 0.7507377 Vali Accuracy: 0.8934837  Vali weighted F1: 0.8820423  Vali macro F1 0.8794333 
new best score!!!!
Validation loss decreased (1.170265 --> 0.750738).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.410599708557129
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7019906  Vali Loss: 0.4972787 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9481989  Vali macro F1 0.9469524 
new best score!!!!
Validation loss decreased (0.750738 --> 0.497279).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.412290334701538
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5017840  Vali Loss: 0.3681785 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9515547  Vali macro F1 0.9498420 
new best score!!!!
Validation loss decreased (0.497279 --> 0.368179).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4098923206329346
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3985617  Vali Loss: 0.2820850 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9656579  Vali macro F1 0.9642284 
new best score!!!!
Validation loss decreased (0.368179 --> 0.282085).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.410592555999756
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3293930  Vali Loss: 0.2320484 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9659495  Vali macro F1 0.9641006 
new best score!!!!
Validation loss decreased (0.282085 --> 0.232048).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.4135046005249023
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2682715  Vali Loss: 0.1880695 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9799768  Vali macro F1 0.9789228 
new best score!!!!
Validation loss decreased (0.232048 --> 0.188070).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.416569948196411
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2309334  Vali Loss: 0.1595791 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9786624  Vali macro F1 0.9774531 
new best score!!!!
Validation loss decreased (0.188070 --> 0.159579).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.4625322818756104
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1828997  Vali Loss: 0.1309606 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849762  Vali macro F1 0.9846685 
new best score!!!!
Validation loss decreased (0.159579 --> 0.130961).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.438596248626709
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1485089  Vali Loss: 0.1066292 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
new best score!!!!
Validation loss decreased (0.130961 --> 0.106629).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.4098260402679443
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1290575  Vali Loss: 0.0931621 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.106629 --> 0.093162).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.407895803451538
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1130617  Vali Loss: 0.0820255 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.093162 --> 0.082025).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4066498279571533
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0993376  Vali Loss: 0.0739289 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910759  Vali macro F1 0.9910708 
new best score!!!!
Validation loss decreased (0.082025 --> 0.073929).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.408153772354126
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.1053171  Vali Loss: 0.0651859 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962245  Vali macro F1 0.9964197 
new best score!!!!
Validation loss decreased (0.073929 --> 0.065186).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.4552016258239746
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0823677  Vali Loss: 0.0589063 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937191  Vali macro F1 0.9936054 
new best score!!!!
Validation loss decreased (0.065186 --> 0.058906).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.41473650932312
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0725451  Vali Loss: 0.0587385 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9871679  Vali macro F1 0.9870367 
new best score!!!!
Validation loss decreased (0.058906 --> 0.058738).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.4146227836608887
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0671962  Vali Loss: 0.0449559 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
new best score!!!!
Validation loss decreased (0.058738 --> 0.044956).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.4086530208587646
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0606090  Vali Loss: 0.0397719 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
new best score!!!!
Validation loss decreased (0.044956 --> 0.039772).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.4153358936309814
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0531213  Vali Loss: 0.0336247 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9975230 
new best score!!!!
Validation loss decreased (0.039772 --> 0.033625).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.417607545852661
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0544136  Vali Loss: 0.0506005 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872116  Vali macro F1 0.9869113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.4639029502868652
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0563463  Vali Loss: 0.0342282 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949575  Vali macro F1 0.9949532 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 3.4517743587493896
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0534483  Vali Loss: 0.0345681 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962249  Vali macro F1 0.9959411 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 3.414196491241455
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0439988  Vali Loss: 0.0357507 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9948382 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 3.4141316413879395
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0392571  Vali Loss: 0.0293032 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937182  Vali macro F1 0.9936615 
new best score!!!!
Validation loss decreased (0.033625 --> 0.029303).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4146811962127686
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0367697  Vali Loss: 0.0261900 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
new best score!!!!
Validation loss decreased (0.029303 --> 0.026190).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.4105753898620605
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0420836  Vali Loss: 0.0262691 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.412203311920166
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0353836  Vali Loss: 0.0258597 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949575  Vali macro F1 0.9949532 
new best score!!!!
Validation loss decreased (0.026190 --> 0.025860).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.413214683532715
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0315635  Vali Loss: 0.0261250 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9948382 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.4138031005859375
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0310647  Vali Loss: 0.0214841 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
new best score!!!!
Validation loss decreased (0.025860 --> 0.021484).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.413754463195801
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0267861  Vali Loss: 0.0200529 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
new best score!!!!
Validation loss decreased (0.021484 --> 0.020053).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.410875082015991
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0274036  Vali Loss: 0.0171429 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.020053 --> 0.017143).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.4232211112976074
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0263392  Vali Loss: 0.0181268 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.4845376014709473
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0225057  Vali Loss: 0.0308310 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911973  Vali macro F1 0.9902337 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 3.422379732131958
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0299448  Vali Loss: 0.0159553 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9975230 
new best score!!!!
Validation loss decreased (0.017143 --> 0.015955).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.4152631759643555
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0334462  Vali Loss: 0.0293305 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924335  Vali macro F1 0.9921334 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.4160563945770264
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0309196  Vali Loss: 0.0194944 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.4091947078704834
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0207284  Vali Loss: 0.0176716 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 3.412306547164917
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0213979  Vali Loss: 0.0142708 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9975230 
new best score!!!!
Validation loss decreased (0.015955 --> 0.014271).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.4114935398101807
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0217630  Vali Loss: 0.0157338 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 3.410315752029419
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0191018  Vali Loss: 0.0129436 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962417  Vali macro F1 0.9962206 
new best score!!!!
Validation loss decreased (0.014271 --> 0.012944).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.4131929874420166
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0233678  Vali Loss: 0.0175707 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962406  Vali macro F1 0.9961014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.4146177768707275
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0204515  Vali Loss: 0.0118101 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.012944 --> 0.011810).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.412493944168091
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0167008  Vali Loss: 0.0128767 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 3.4625720977783203
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0180898  Vali Loss: 0.0139722 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961432 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 3.455216407775879
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0176595  Vali Loss: 0.0141392 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 3.4164299964904785
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0192772  Vali Loss: 0.0133843 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9973973 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 3.4202935695648193
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0189325  Vali Loss: 0.0165982 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974934  Vali macro F1 0.9974114 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 3.4165093898773193
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0239333  Vali Loss: 0.0103064 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.011810 --> 0.010306).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 3.417717695236206
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0152977  Vali Loss: 0.0102705 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.010306 --> 0.010270).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 3.418087959289551
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0163630  Vali Loss: 0.0107551 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 3.4158859252929688
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0144789  Vali Loss: 0.0106777 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 3.414510726928711
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0146629  Vali Loss: 0.0104110 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 3.411799907684326
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0137336  Vali Loss: 0.0122609 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 3.4166548252105713
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0132821  Vali Loss: 0.0115502 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 3.429966449737549
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0123557  Vali Loss: 0.0114994 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 3.494119644165039
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0136071  Vali Loss: 0.0117742 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 3.427607297897339
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0137435  Vali Loss: 0.0120615 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 3.4133706092834473
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0135751  Vali Loss: 0.0120421 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 3.419059991836548
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0138372  Vali Loss: 0.0113877 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 3.4121334552764893
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0149386  Vali Loss: 0.0113955 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 3.4097955226898193
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0135087  Vali Loss: 0.0114849 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 3.4155235290527344
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0135155  Vali Loss: 0.0115210 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 3.409475088119507
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0133403  Vali Loss: 0.0115240 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 3.410722017288208
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0167068  Vali Loss: 0.0115459 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9114035  Test weighted F1: 0.8917997  Test macro F1 0.8917997 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.805659055709839
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0139253  Vali Loss: 0.0108907 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
Validation loss decreased (inf --> 0.010891).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.803030490875244
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0141133  Vali Loss: 0.0125478 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.8067779541015625
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0127485  Vali Loss: 0.0128321 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.805733919143677
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0130358  Vali Loss: 0.0122955 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 4.801096200942993
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0127195  Vali Loss: 0.0095320 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9975230 
new best score!!!!
Validation loss decreased (0.010891 --> 0.009532).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.80552864074707
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0121708  Vali Loss: 0.0130491 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 4.8043553829193115
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0119533  Vali Loss: 0.0123015 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 4.802145957946777
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0111881  Vali Loss: 0.0120811 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 4.8046135902404785
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0112758  Vali Loss: 0.0121216 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 4.8044822216033936
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0113077  Vali Loss: 0.0113716 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974783  Vali macro F1 0.9974451 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 4.80510139465332
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0107925  Vali Loss: 0.0117096 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.803381443023682
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0113141  Vali Loss: 0.0117932 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 4.803069591522217
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0105266  Vali Loss: 0.0120501 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 4.8037543296813965
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0110365  Vali Loss: 0.0112898 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 4.805505752563477
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0111372  Vali Loss: 0.0079223 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9975230 
new best score!!!!
Validation loss decreased (0.009532 --> 0.007922).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.802783966064453
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0106544  Vali Loss: 0.0105675 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 4.804668664932251
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0109922  Vali Loss: 0.0121814 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 4.804855585098267
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0096492  Vali Loss: 0.0116365 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 4.805608510971069
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0094436  Vali Loss: 0.0106715 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 4.805909633636475
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0097910  Vali Loss: 0.0120979 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 4.8005735874176025
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0092097  Vali Loss: 0.0119918 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.8041017055511475
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0094108  Vali Loss: 0.0119514 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 4.805217981338501
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0092871  Vali Loss: 0.0119463 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 4.802544355392456
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0093306  Vali Loss: 0.0119603 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 4.801196813583374
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0091387  Vali Loss: 0.0118650 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 4.805558681488037
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0086344  Vali Loss: 0.0118645 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.805751323699951
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0094309  Vali Loss: 0.0118530 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.80850887298584
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0086498  Vali Loss: 0.0118489 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 4.8079047203063965
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0090806  Vali Loss: 0.0118455 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 4.801008224487305
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0092811  Vali Loss: 0.0118394 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962263  Vali macro F1 0.9962684 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9070175  Test weighted F1: 0.8878473  Test macro F1 0.8878473 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.507033109664917
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8710686  Vali Loss: 2.4075375 Vali Accuracy: 0.3746867  Vali weighted F1: 0.2856195  Vali macro F1 0.2968161 
Validation loss decreased (inf --> 2.407538).  Saving model ...
Epoch: 2 cost time: 3.4143614768981934
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7638416  Vali Loss: 1.2069454 Vali Accuracy: 0.8007519  Vali weighted F1: 0.7860198  Vali macro F1 0.7809131 
new best score!!!!
Validation loss decreased (2.407538 --> 1.206945).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.415823459625244
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0242104  Vali Loss: 0.7236119 Vali Accuracy: 0.8884712  Vali weighted F1: 0.8787437  Vali macro F1 0.8752928 
new best score!!!!
Validation loss decreased (1.206945 --> 0.723612).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.41707706451416
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6709951  Vali Loss: 0.5042596 Vali Accuracy: 0.9235589  Vali weighted F1: 0.9206578  Vali macro F1 0.9160519 
new best score!!!!
Validation loss decreased (0.723612 --> 0.504260).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.417174816131592
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4957226  Vali Loss: 0.3654485 Vali Accuracy: 0.9436090  Vali weighted F1: 0.9427346  Vali macro F1 0.9386013 
new best score!!!!
Validation loss decreased (0.504260 --> 0.365448).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4585049152374268
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3825019  Vali Loss: 0.2825045 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9506569  Vali macro F1 0.9468573 
new best score!!!!
Validation loss decreased (0.365448 --> 0.282505).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.457670211791992
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3037725  Vali Loss: 0.2435078 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9611089  Vali macro F1 0.9586465 
new best score!!!!
Validation loss decreased (0.282505 --> 0.243508).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.406139850616455
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2588859  Vali Loss: 0.1959223 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9610834  Vali macro F1 0.9585151 
new best score!!!!
Validation loss decreased (0.243508 --> 0.195922).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.4073736667633057
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2161199  Vali Loss: 0.1533475 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845321  Vali macro F1 0.9838242 
new best score!!!!
Validation loss decreased (0.195922 --> 0.153348).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.4076709747314453
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1725867  Vali Loss: 0.1305952 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9833573  Vali macro F1 0.9830091 
new best score!!!!
Validation loss decreased (0.153348 --> 0.130595).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.403595209121704
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1369423  Vali Loss: 0.1070798 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9819211  Vali macro F1 0.9817163 
new best score!!!!
Validation loss decreased (0.130595 --> 0.107080).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.4128530025482178
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1147143  Vali Loss: 0.0935190 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847056  Vali macro F1 0.9838814 
new best score!!!!
Validation loss decreased (0.107080 --> 0.093519).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4066531658172607
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1003841  Vali Loss: 0.0793771 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911045  Vali macro F1 0.9909019 
new best score!!!!
Validation loss decreased (0.093519 --> 0.079377).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.407090902328491
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0844171  Vali Loss: 0.0671968 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910310  Vali macro F1 0.9909591 
new best score!!!!
Validation loss decreased (0.079377 --> 0.067197).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4072530269622803
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0791508  Vali Loss: 0.0601284 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.067197 --> 0.060128).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.4083101749420166
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0777214  Vali Loss: 0.0657339 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9858524  Vali macro F1 0.9855038 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 3.4114913940429688
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0654556  Vali Loss: 0.0540950 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.060128 --> 0.054095).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.4190118312835693
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0586025  Vali Loss: 0.0453939 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911405  Vali macro F1 0.9909313 
new best score!!!!
Validation loss decreased (0.054095 --> 0.045394).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.471245288848877
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0540869  Vali Loss: 0.0491078 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.412719488143921
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0486912  Vali Loss: 0.0455302 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 3.4114906787872314
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0460032  Vali Loss: 0.0442422 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
new best score!!!!
Validation loss decreased (0.045394 --> 0.044242).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.409421920776367
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0408043  Vali Loss: 0.0386341 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911358  Vali macro F1 0.9909637 
new best score!!!!
Validation loss decreased (0.044242 --> 0.038634).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.407283067703247
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0484688  Vali Loss: 0.0373020 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923873  Vali macro F1 0.9922268 
new best score!!!!
Validation loss decreased (0.038634 --> 0.037302).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.4085426330566406
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0379989  Vali Loss: 0.0351312 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.037302 --> 0.035131).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.4100706577301025
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0370983  Vali Loss: 0.0347645 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
new best score!!!!
Validation loss decreased (0.035131 --> 0.034764).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4135708808898926
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0340891  Vali Loss: 0.0315418 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899243  Vali macro F1 0.9896711 
new best score!!!!
Validation loss decreased (0.034764 --> 0.031542).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.407238245010376
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0342599  Vali Loss: 0.0323426 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897458  Vali macro F1 0.9897176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.4163053035736084
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0303034  Vali Loss: 0.0309905 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.031542 --> 0.030990).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.4230129718780518
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0274037  Vali Loss: 0.0271022 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.030990 --> 0.027102).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.4666099548339844
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0251113  Vali Loss: 0.0282264 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 3.447115182876587
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0332495  Vali Loss: 0.0310381 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 3.4129409790039062
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0260593  Vali Loss: 0.0258825 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923873  Vali macro F1 0.9922268 
new best score!!!!
Validation loss decreased (0.027102 --> 0.025882).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.412698984146118
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0251085  Vali Loss: 0.0236235 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.025882 --> 0.023624).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.410930633544922
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0213135  Vali Loss: 0.0269033 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.412949562072754
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0307006  Vali Loss: 0.0261219 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.4053351879119873
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0305568  Vali Loss: 0.0272578 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911402  Vali macro F1 0.9909537 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 3.406296730041504
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0210362  Vali Loss: 0.0253064 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898599  Vali macro F1 0.9896314 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 3.4044783115386963
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0205417  Vali Loss: 0.0289434 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 3.4078030586242676
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0209203  Vali Loss: 0.0229170 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.023624 --> 0.022917).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.4174537658691406
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0170281  Vali Loss: 0.0223868 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.022917 --> 0.022387).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.403691530227661
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0168085  Vali Loss: 0.0225222 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.4737963676452637
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0179783  Vali Loss: 0.0221182 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.022387 --> 0.022118).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 3.4096810817718506
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0170255  Vali Loss: 0.0222716 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 3.408281087875366
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0161364  Vali Loss: 0.0223865 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 3.4060659408569336
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0163953  Vali Loss: 0.0221780 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 3.404906749725342
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0165258  Vali Loss: 0.0216158 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.022118 --> 0.021616).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.409346103668213
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0163877  Vali Loss: 0.0221349 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 3.4050493240356445
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0164426  Vali Loss: 0.0222520 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 3.408069610595703
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0159068  Vali Loss: 0.0210645 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.021616 --> 0.021065).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 3.404601573944092
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0169947  Vali Loss: 0.0207072 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.021065 --> 0.020707).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 3.4094958305358887
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0155189  Vali Loss: 0.0205548 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.020707 --> 0.020555).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.417125701904297
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0166695  Vali Loss: 0.0208839 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 3.4626035690307617
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0155065  Vali Loss: 0.0200062 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.020555 --> 0.020006).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 3.449036121368408
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0147836  Vali Loss: 0.0202263 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 3.405365467071533
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0147785  Vali Loss: 0.0198120 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.020006 --> 0.019812).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 3.4193873405456543
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0158277  Vali Loss: 0.0203894 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 3.44663667678833
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0147716  Vali Loss: 0.0198922 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 3.4133894443511963
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0145589  Vali Loss: 0.0195654 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.019812 --> 0.019565).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 3.4146084785461426
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0155257  Vali Loss: 0.0193780 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.019565 --> 0.019378).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 3.412916421890259
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0148997  Vali Loss: 0.0202113 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 3.415611505508423
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0148128  Vali Loss: 0.0200104 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 3.4157626628875732
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0145153  Vali Loss: 0.0196506 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 3.4224038124084473
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0146760  Vali Loss: 0.0195840 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 3.4212875366210938
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0139852  Vali Loss: 0.0193660 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.019378 --> 0.019366).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 3.476120710372925
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0141500  Vali Loss: 0.0198849 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 3.4215774536132812
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0144493  Vali Loss: 0.0195326 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 3.416247844696045
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0140195  Vali Loss: 0.0194594 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 3.4156317710876465
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0142150  Vali Loss: 0.0198620 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 3.4158763885498047
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0141244  Vali Loss: 0.0201173 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 70 cost time: 3.4164113998413086
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0140160  Vali Loss: 0.0200679 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 3.4165866374969482
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0140361  Vali Loss: 0.0199571 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 3.4132039546966553
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0141486  Vali Loss: 0.0199332 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 3.416607618331909
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0149661  Vali Loss: 0.0199218 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 3.4163763523101807
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0138696  Vali Loss: 0.0198613 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 75 cost time: 3.4243175983428955
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0142435  Vali Loss: 0.0198632 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 3.4695494174957275
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0136746  Vali Loss: 0.0198761 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 77 cost time: 3.4535763263702393
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0137226  Vali Loss: 0.0198690 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 78 cost time: 3.4192347526550293
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0144865  Vali Loss: 0.0198609 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 79 cost time: 3.4149086475372314
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0141652  Vali Loss: 0.0198689 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8842105  Test weighted F1: 0.8584942  Test macro F1 0.8584942 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.851550817489624
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0159572  Vali Loss: 0.0189240 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
Validation loss decreased (inf --> 0.018924).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.849053144454956
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0147996  Vali Loss: 0.0193528 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.852735280990601
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0140495  Vali Loss: 0.0194146 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.851670026779175
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0128996  Vali Loss: 0.0195951 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 4.84823203086853
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0129043  Vali Loss: 0.0188760 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.018924 --> 0.018876).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.847359657287598
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0124600  Vali Loss: 0.0191057 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 4.855009078979492
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0126699  Vali Loss: 0.0181811 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.018876 --> 0.018181).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.849855184555054
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0119158  Vali Loss: 0.0182549 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.852269172668457
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0121471  Vali Loss: 0.0177057 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.018181 --> 0.017706).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.849813938140869
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0113864  Vali Loss: 0.0185028 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 4.853249549865723
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0119835  Vali Loss: 0.0175608 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.017706 --> 0.017561).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.849411487579346
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0109627  Vali Loss: 0.0177670 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.84834623336792
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0115005  Vali Loss: 0.0185851 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 4.850187063217163
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0114456  Vali Loss: 0.0170720 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.017561 --> 0.017072).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.852109432220459
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0118081  Vali Loss: 0.0165950 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911402  Vali macro F1 0.9909537 
new best score!!!!
Validation loss decreased (0.017072 --> 0.016595).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.850694179534912
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0118631  Vali Loss: 0.0185517 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 4.848530054092407
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0099433  Vali Loss: 0.0172733 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 4.848574876785278
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0103340  Vali Loss: 0.0176111 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 4.850545406341553
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0098935  Vali Loss: 0.0167998 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 4.847958087921143
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0102213  Vali Loss: 0.0175074 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 21 cost time: 4.849450588226318
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0100900  Vali Loss: 0.0205468 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.849397420883179
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0100280  Vali Loss: 0.0182015 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 4.853194952011108
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0094258  Vali Loss: 0.0172368 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 4.850968360900879
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0093933  Vali Loss: 0.0172398 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 4.8479180335998535
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0095776  Vali Loss: 0.0163677 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.016595 --> 0.016368).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 4.850636005401611
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0091173  Vali Loss: 0.0168769 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.848134756088257
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0096187  Vali Loss: 0.0176595 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911042  Vali macro F1 0.9909243 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.845918893814087
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0092405  Vali Loss: 0.0163771 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 4.848808765411377
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0086574  Vali Loss: 0.0159759 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
new best score!!!!
Validation loss decreased (0.016368 --> 0.015976).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 4.850286483764648
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0090948  Vali Loss: 0.0162775 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 4.847556829452515
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0083699  Vali Loss: 0.0165913 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 4.85115909576416
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0085625  Vali Loss: 0.0162481 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 4.850980043411255
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0087011  Vali Loss: 0.0164031 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 4.852348804473877
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0098873  Vali Loss: 0.0163227 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 35 cost time: 4.846643686294556
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0085303  Vali Loss: 0.0163076 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 4.849071264266968
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0080064  Vali Loss: 0.0163036 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 4.849266767501831
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0081822  Vali Loss: 0.0162671 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 4.851300239562988
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0080532  Vali Loss: 0.0162508 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 4.851801872253418
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0084199  Vali Loss: 0.0163059 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 40 cost time: 4.847145318984985
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0084368  Vali Loss: 0.0163079 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 4.850484371185303
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0081587  Vali Loss: 0.0163278 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 4.848013639450073
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0082977  Vali Loss: 0.0163141 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 4.849301099777222
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0082606  Vali Loss: 0.0163160 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 4.847934007644653
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0082125  Vali Loss: 0.0163126 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8631579  Test weighted F1: 0.8320181  Test macro F1 0.8320181 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.477632761001587
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8836862  Vali Loss: 2.4688634 Vali Accuracy: 0.3796992  Vali weighted F1: 0.2889634  Vali macro F1 0.2897471 
Validation loss decreased (inf --> 2.468863).  Saving model ...
Epoch: 2 cost time: 3.404449462890625
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8079542  Vali Loss: 1.2138419 Vali Accuracy: 0.7844612  Vali weighted F1: 0.7701227  Vali macro F1 0.7693095 
new best score!!!!
Validation loss decreased (2.468863 --> 1.213842).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.436631917953491
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0516033  Vali Loss: 0.7596816 Vali Accuracy: 0.9147870  Vali weighted F1: 0.9048779  Vali macro F1 0.9014436 
new best score!!!!
Validation loss decreased (1.213842 --> 0.759682).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.445944309234619
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6927381  Vali Loss: 0.4961168 Vali Accuracy: 0.9373434  Vali weighted F1: 0.9334070  Vali macro F1 0.9290977 
new best score!!!!
Validation loss decreased (0.759682 --> 0.496117).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.4086906909942627
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4968667  Vali Loss: 0.3690665 Vali Accuracy: 0.9498747  Vali weighted F1: 0.9478143  Vali macro F1 0.9423002 
new best score!!!!
Validation loss decreased (0.496117 --> 0.369066).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.402655839920044
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3785270  Vali Loss: 0.2810192 Vali Accuracy: 0.9573935  Vali weighted F1: 0.9552381  Vali macro F1 0.9516977 
new best score!!!!
Validation loss decreased (0.369066 --> 0.281019).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.404677391052246
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2985065  Vali Loss: 0.2206065 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9717294  Vali macro F1 0.9692298 
new best score!!!!
Validation loss decreased (0.281019 --> 0.220607).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3964076042175293
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2414986  Vali Loss: 0.1832441 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9718181  Vali macro F1 0.9694166 
new best score!!!!
Validation loss decreased (0.220607 --> 0.183244).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.4028937816619873
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2061796  Vali Loss: 0.1564997 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808614  Vali macro F1 0.9795685 
new best score!!!!
Validation loss decreased (0.183244 --> 0.156500).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.400604486465454
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1723256  Vali Loss: 0.1317431 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9858255  Vali macro F1 0.9852242 
new best score!!!!
Validation loss decreased (0.156500 --> 0.131743).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.4084930419921875
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1389592  Vali Loss: 0.1146479 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9845893  Vali macro F1 0.9839536 
new best score!!!!
Validation loss decreased (0.131743 --> 0.114648).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.403212547302246
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1153839  Vali Loss: 0.0989378 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
new best score!!!!
Validation loss decreased (0.114648 --> 0.098938).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4030818939208984
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1046891  Vali Loss: 0.0921815 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874062  Vali macro F1 0.9869232 
new best score!!!!
Validation loss decreased (0.098938 --> 0.092181).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4079325199127197
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0915105  Vali Loss: 0.0813666 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9871667  Vali macro F1 0.9866868 
new best score!!!!
Validation loss decreased (0.092181 --> 0.081367).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4138998985290527
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0849573  Vali Loss: 0.0734426 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859231  Vali macro F1 0.9852872 
new best score!!!!
Validation loss decreased (0.081367 --> 0.073443).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.48463773727417
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0755890  Vali Loss: 0.0721681 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873068  Vali macro F1 0.9865615 
new best score!!!!
Validation loss decreased (0.073443 --> 0.072168).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.4144880771636963
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0841551  Vali Loss: 0.0714085 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860458  Vali macro F1 0.9854608 
new best score!!!!
Validation loss decreased (0.072168 --> 0.071409).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.449765682220459
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0673686  Vali Loss: 0.0663556 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860288  Vali macro F1 0.9855642 
new best score!!!!
Validation loss decreased (0.071409 --> 0.066356).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.4321677684783936
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0594962  Vali Loss: 0.0569165 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9883338  Vali macro F1 0.9882342 
new best score!!!!
Validation loss decreased (0.066356 --> 0.056916).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.4152560234069824
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0493436  Vali Loss: 0.0531096 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897296  Vali macro F1 0.9895415 
new best score!!!!
Validation loss decreased (0.056916 --> 0.053110).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.416132926940918
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0485410  Vali Loss: 0.0514535 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872119  Vali macro F1 0.9868890 
new best score!!!!
Validation loss decreased (0.053110 --> 0.051453).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.4158854484558105
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0428668  Vali Loss: 0.0433942 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
new best score!!!!
Validation loss decreased (0.051453 --> 0.043394).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.418283224105835
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0404693  Vali Loss: 0.0452842 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.4132919311523438
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0394249  Vali Loss: 0.0420169 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885180  Vali macro F1 0.9882342 
new best score!!!!
Validation loss decreased (0.043394 --> 0.042017).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.4151434898376465
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0359843  Vali Loss: 0.0408150 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9883338  Vali macro F1 0.9882342 
new best score!!!!
Validation loss decreased (0.042017 --> 0.040815).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.423386812210083
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0334963  Vali Loss: 0.0422289 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9883459  Vali macro F1 0.9882672 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.4732091426849365
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0335934  Vali Loss: 0.0413739 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884314  Vali macro F1 0.9882972 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 3.454988956451416
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0296343  Vali Loss: 0.0329088 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884984  Vali macro F1 0.9883568 
new best score!!!!
Validation loss decreased (0.040815 --> 0.032909).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.4209213256835938
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0285768  Vali Loss: 0.0365356 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884314  Vali macro F1 0.9882972 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.419362783432007
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0309405  Vali Loss: 0.0348970 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912041  Vali macro F1 0.9909464 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 3.421173572540283
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0281516  Vali Loss: 0.0376780 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899372  Vali macro F1 0.9893769 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 3.4204564094543457
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0269726  Vali Loss: 0.0320052 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897863  Vali macro F1 0.9896142 
new best score!!!!
Validation loss decreased (0.032909 --> 0.032005).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.421457052230835
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0251471  Vali Loss: 0.0262987 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
new best score!!!!
Validation loss decreased (0.032005 --> 0.026299).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.4186110496520996
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0237383  Vali Loss: 0.0250856 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.026299 --> 0.025086).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.419440269470215
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0227122  Vali Loss: 0.0299714 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.415354013442993
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0239675  Vali Loss: 0.0305523 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886285  Vali macro F1 0.9882396 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.4254260063171387
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0226592  Vali Loss: 0.0300819 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898511  Vali macro F1 0.9893978 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 3.414273977279663
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0200481  Vali Loss: 0.0361895 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872119  Vali macro F1 0.9868890 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 3.4814181327819824
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0230206  Vali Loss: 0.0281828 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885180  Vali macro F1 0.9882342 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 3.4186184406280518
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0181680  Vali Loss: 0.0289577 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872119  Vali macro F1 0.9868890 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 3.4152867794036865
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0179536  Vali Loss: 0.0265080 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 3.416368007659912
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0185592  Vali Loss: 0.0276828 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 3.416569232940674
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0170439  Vali Loss: 0.0278497 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 3.4127650260925293
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0170753  Vali Loss: 0.0269872 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 3.4121203422546387
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0171676  Vali Loss: 0.0273101 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.413180112838745
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0176661  Vali Loss: 0.0274073 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.4126973152160645
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0168599  Vali Loss: 0.0274552 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 3.4124157428741455
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0169062  Vali Loss: 0.0275434 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 3.4256482124328613
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0173351  Vali Loss: 0.0276878 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898151  Vali macro F1 0.9895715 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8894737  Test weighted F1: 0.8669924  Test macro F1 0.8669924 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.75528359413147
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0220455  Vali Loss: 0.0277009 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
Validation loss decreased (inf --> 0.027701).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.74946665763855
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0210728  Vali Loss: 0.0267358 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.027701 --> 0.026736).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.748074769973755
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0201315  Vali Loss: 0.0267934 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.7488415241241455
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0219522  Vali Loss: 0.0236848 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.026736 --> 0.023685).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.749120235443115
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0180829  Vali Loss: 0.0269565 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885177  Vali macro F1 0.9882566 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.751595497131348
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0175469  Vali Loss: 0.0260367 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911051  Vali macro F1 0.9908510 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 4.748587131500244
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0183174  Vali Loss: 0.0261004 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 4.751850605010986
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0179512  Vali Loss: 0.0243708 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 4.7505106925964355
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0172295  Vali Loss: 0.0245773 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 4.751934051513672
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0171210  Vali Loss: 0.0224791 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
new best score!!!!
Validation loss decreased (0.023685 --> 0.022479).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.752158880233765
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0272403  Vali Loss: 0.0269467 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885177  Vali macro F1 0.9882566 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.751586675643921
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0163968  Vali Loss: 0.0220810 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.022479 --> 0.022081).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.7513649463653564
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0161626  Vali Loss: 0.0251802 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.748629808425903
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0147399  Vali Loss: 0.0243333 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.7508580684661865
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0157597  Vali Loss: 0.0246024 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884314  Vali macro F1 0.9882972 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.749736785888672
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0148243  Vali Loss: 0.0236759 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884314  Vali macro F1 0.9882972 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 4.749993562698364
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0141383  Vali Loss: 0.0238938 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 4.755310297012329
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0156782  Vali Loss: 0.0236902 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.747626066207886
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0143761  Vali Loss: 0.0237038 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898148  Vali macro F1 0.9895938 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 4.749042987823486
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0141522  Vali Loss: 0.0239059 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885177  Vali macro F1 0.9882566 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 4.748304605484009
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0147158  Vali Loss: 0.0235691 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 4.748194456100464
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0151566  Vali Loss: 0.0245105 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 4.748386383056641
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0142994  Vali Loss: 0.0244932 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 4.747533082962036
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0142162  Vali Loss: 0.0244646 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 4.751378297805786
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0147493  Vali Loss: 0.0244656 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 4.747151136398315
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0134759  Vali Loss: 0.0244803 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 4.756018161773682
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0140552  Vali Loss: 0.0244453 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899136  Vali macro F1 0.9895639 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8921053  Test weighted F1: 0.8646202  Test macro F1 0.8646202 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.476778268814087
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8621310  Vali Loss: 2.3481003 Vali Accuracy: 0.4661654  Vali weighted F1: 0.3886131  Vali macro F1 0.3952549 
Validation loss decreased (inf --> 2.348100).  Saving model ...
Epoch: 2 cost time: 3.4076735973358154
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7534515  Vali Loss: 1.1978363 Vali Accuracy: 0.8395990  Vali weighted F1: 0.8202055  Vali macro F1 0.8155707 
new best score!!!!
Validation loss decreased (2.348100 --> 1.197836).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.405416250228882
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0582772  Vali Loss: 0.7501352 Vali Accuracy: 0.9072682  Vali weighted F1: 0.8929604  Vali macro F1 0.8885735 
new best score!!!!
Validation loss decreased (1.197836 --> 0.750135).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.408862352371216
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6999110  Vali Loss: 0.5008507 Vali Accuracy: 0.9323308  Vali weighted F1: 0.9277896  Vali macro F1 0.9224588 
new best score!!!!
Validation loss decreased (0.750135 --> 0.500851).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.401901960372925
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5083809  Vali Loss: 0.3811222 Vali Accuracy: 0.9498747  Vali weighted F1: 0.9482830  Vali macro F1 0.9451228 
new best score!!!!
Validation loss decreased (0.500851 --> 0.381122).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.407698392868042
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3971739  Vali Loss: 0.2973648 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9534887  Vali macro F1 0.9500423 
new best score!!!!
Validation loss decreased (0.381122 --> 0.297365).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4161694049835205
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3282613  Vali Loss: 0.2384411 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9623054  Vali macro F1 0.9599671 
new best score!!!!
Validation loss decreased (0.297365 --> 0.238441).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.417933225631714
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2710784  Vali Loss: 0.1944508 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9771186  Vali macro F1 0.9762460 
new best score!!!!
Validation loss decreased (0.238441 --> 0.194451).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.4808812141418457
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2142942  Vali Loss: 0.1637912 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9797329  Vali macro F1 0.9791665 
new best score!!!!
Validation loss decreased (0.194451 --> 0.163791).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.416353225708008
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1818406  Vali Loss: 0.1321964 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9871033  Vali macro F1 0.9865497 
new best score!!!!
Validation loss decreased (0.163791 --> 0.132196).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.4214932918548584
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1482335  Vali Loss: 0.1047738 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910757  Vali macro F1 0.9910775 
new best score!!!!
Validation loss decreased (0.132196 --> 0.104774).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.410649061203003
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1296954  Vali Loss: 0.0957642 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859044  Vali macro F1 0.9861357 
new best score!!!!
Validation loss decreased (0.104774 --> 0.095764).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.409989833831787
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1146264  Vali Loss: 0.0796549 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898702  Vali macro F1 0.9896918 
new best score!!!!
Validation loss decreased (0.095764 --> 0.079655).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4105019569396973
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0955941  Vali Loss: 0.0684480 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923708  Vali macro F1 0.9923508 
new best score!!!!
Validation loss decreased (0.079655 --> 0.068448).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.461075782775879
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0834005  Vali Loss: 0.0656883 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949703  Vali macro F1 0.9948382 
new best score!!!!
Validation loss decreased (0.068448 --> 0.065688).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.4219441413879395
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0822103  Vali Loss: 0.0691427 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888337  Vali macro F1 0.9886208 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 3.4159493446350098
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.1044891  Vali Loss: 0.0613954 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899498  Vali macro F1 0.9899149 
new best score!!!!
Validation loss decreased (0.065688 --> 0.061395).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.4177896976470947
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0790494  Vali Loss: 0.0506653 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923703  Vali macro F1 0.9922111 
new best score!!!!
Validation loss decreased (0.061395 --> 0.050665).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.4175965785980225
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0612193  Vali Loss: 0.0399824 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9962393 
new best score!!!!
Validation loss decreased (0.050665 --> 0.039982).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.43271803855896
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0535118  Vali Loss: 0.0368659 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962266  Vali macro F1 0.9962839 
new best score!!!!
Validation loss decreased (0.039982 --> 0.036866).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.476177453994751
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0528690  Vali Loss: 0.0367835 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936655  Vali macro F1 0.9934965 
new best score!!!!
Validation loss decreased (0.036866 --> 0.036784).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.440044641494751
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0468043  Vali Loss: 0.0361278 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923879  Vali macro F1 0.9921759 
new best score!!!!
Validation loss decreased (0.036784 --> 0.036128).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.4215500354766846
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0497602  Vali Loss: 0.0340925 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949894  Vali macro F1 0.9947352 
new best score!!!!
Validation loss decreased (0.036128 --> 0.034092).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.418311357498169
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0428507  Vali Loss: 0.0349135 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.418520927429199
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0430007  Vali Loss: 0.0328125 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962361  Vali macro F1 0.9962257 
new best score!!!!
Validation loss decreased (0.034092 --> 0.032813).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4148876667022705
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0359845  Vali Loss: 0.0256126 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962095  Vali macro F1 0.9961299 
new best score!!!!
Validation loss decreased (0.032813 --> 0.025613).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.414527416229248
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0372376  Vali Loss: 0.0263968 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949381  Vali macro F1 0.9948875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.4166858196258545
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0493748  Vali Loss: 0.0325887 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911905  Vali macro F1 0.9908809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 3.4145748615264893
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0339119  Vali Loss: 0.0259339 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937319  Vali macro F1 0.9936671 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 3.4130849838256836
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0304026  Vali Loss: 0.0267618 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949880  Vali macro F1 0.9949674 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 3.4239978790283203
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0296437  Vali Loss: 0.0210365 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.025613 --> 0.021036).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.4490203857421875
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0276767  Vali Loss: 0.0208733 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
new best score!!!!
Validation loss decreased (0.021036 --> 0.020873).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.4663307666778564
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0261681  Vali Loss: 0.0197364 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.020873 --> 0.019736).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.4197864532470703
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0233928  Vali Loss: 0.0179148 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962425  Vali macro F1 0.9962238 
new best score!!!!
Validation loss decreased (0.019736 --> 0.017915).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.4179511070251465
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0232993  Vali Loss: 0.0181669 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.414851427078247
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0263112  Vali Loss: 0.0177153 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.017915 --> 0.017715).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.417719602584839
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0202324  Vali Loss: 0.0165011 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.017715 --> 0.016501).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.415811538696289
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0198407  Vali Loss: 0.0181481 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949858  Vali macro F1 0.9949579 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 3.417393445968628
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0202331  Vali Loss: 0.0145919 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
new best score!!!!
Validation loss decreased (0.016501 --> 0.014592).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.4176223278045654
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0215835  Vali Loss: 0.0132781 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.014592 --> 0.013278).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.4163901805877686
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0176592  Vali Loss: 0.0128691 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.013278 --> 0.012869).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.4287190437316895
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0213170  Vali Loss: 0.0217059 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924608  Vali macro F1 0.9926267 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.4216296672821045
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0255021  Vali Loss: 0.0176513 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.4881205558776855
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0240034  Vali Loss: 0.0179710 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949880  Vali macro F1 0.9949674 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 3.436929225921631
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0202931  Vali Loss: 0.0148819 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9962393 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 3.4164912700653076
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0177073  Vali Loss: 0.0137277 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9975381 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 3.4156088829040527
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0152634  Vali Loss: 0.0125817 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974952  Vali macro F1 0.9975381 
new best score!!!!
Validation loss decreased (0.012869 --> 0.012582).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.4168992042541504
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0148906  Vali Loss: 0.0118694 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.012582 --> 0.011869).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 3.4183366298675537
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0146477  Vali Loss: 0.0115366 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.011869 --> 0.011537).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 3.4157192707061768
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0168201  Vali Loss: 0.0112712 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.011537 --> 0.011271).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 3.4223830699920654
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0166353  Vali Loss: 0.0108086 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
new best score!!!!
Validation loss decreased (0.011271 --> 0.010809).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.4198689460754395
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0151589  Vali Loss: 0.0113266 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 3.4217655658721924
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0144059  Vali Loss: 0.0114942 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 3.428832530975342
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0137511  Vali Loss: 0.0112369 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 3.4636006355285645
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0136746  Vali Loss: 0.0106086 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.010809 --> 0.010609).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 3.4643452167510986
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0135340  Vali Loss: 0.0108529 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 3.4225850105285645
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0132583  Vali Loss: 0.0107522 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 3.4204890727996826
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0135538  Vali Loss: 0.0108289 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 3.4167587757110596
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0136411  Vali Loss: 0.0106440 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 3.4200336933135986
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0126719  Vali Loss: 0.0110544 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 61 cost time: 3.4165399074554443
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0137196  Vali Loss: 0.0110889 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 3.4170360565185547
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0125982  Vali Loss: 0.0110954 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 3.4169933795928955
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0132634  Vali Loss: 0.0110550 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 3.419111490249634
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0128892  Vali Loss: 0.0110324 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 3.4315760135650635
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0152333  Vali Loss: 0.0110310 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 66 cost time: 3.417530059814453
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0125408  Vali Loss: 0.0110270 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 3.4995920658111572
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0124589  Vali Loss: 0.0110262 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 3.4315643310546875
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0163696  Vali Loss: 0.0110294 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 3.421862840652466
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0137190  Vali Loss: 0.0110359 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 3.419097423553467
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0140597  Vali Loss: 0.0110385 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9394737  Test weighted F1: 0.9376415  Test macro F1 0.9376415 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.75040340423584
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0132995  Vali Loss: 0.0101576 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
Validation loss decreased (inf --> 0.010158).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.7465126514434814
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0137791  Vali Loss: 0.0106125 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.745266675949097
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0123771  Vali Loss: 0.0115004 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.744642972946167
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0125785  Vali Loss: 0.0101569 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
new best score!!!!
Validation loss decreased (0.010158 --> 0.010157).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.746813535690308
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0120830  Vali Loss: 0.0104433 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.744511365890503
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0115416  Vali Loss: 0.0100872 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
new best score!!!!
Validation loss decreased (0.010157 --> 0.010087).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.745764970779419
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0110987  Vali Loss: 0.0098671 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
new best score!!!!
Validation loss decreased (0.010087 --> 0.009867).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.7449047565460205
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0112071  Vali Loss: 0.0099546 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.739445686340332
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0107246  Vali Loss: 0.0095987 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
new best score!!!!
Validation loss decreased (0.009867 --> 0.009599).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.743655204772949
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0110135  Vali Loss: 0.0091025 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
new best score!!!!
Validation loss decreased (0.009599 --> 0.009102).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.742020845413208
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0114663  Vali Loss: 0.0088290 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.009102 --> 0.008829).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.743192434310913
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0100735  Vali Loss: 0.0088700 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.742727756500244
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0110683  Vali Loss: 0.0089143 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 4.742941856384277
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0096814  Vali Loss: 0.0086965 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
new best score!!!!
Validation loss decreased (0.008829 --> 0.008697).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.747009515762329
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0097555  Vali Loss: 0.0089195 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.743397235870361
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0096787  Vali Loss: 0.0084612 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
new best score!!!!
Validation loss decreased (0.008697 --> 0.008461).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.7427051067352295
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0096386  Vali Loss: 0.0083571 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
new best score!!!!
Validation loss decreased (0.008461 --> 0.008357).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.743361234664917
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0091642  Vali Loss: 0.0086621 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.742748737335205
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0095405  Vali Loss: 0.0087809 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 4.744734764099121
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0088627  Vali Loss: 0.0081350 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.008357 --> 0.008135).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 4.7398552894592285
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0090488  Vali Loss: 0.0074686 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
new best score!!!!
Validation loss decreased (0.008135 --> 0.007469).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 4.742950201034546
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0091750  Vali Loss: 0.0070261 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.007469 --> 0.007026).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.745955228805542
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0082708  Vali Loss: 0.0071145 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 4.745453596115112
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0081678  Vali Loss: 0.0074957 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 4.740330696105957
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0080405  Vali Loss: 0.0077178 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 4.74164891242981
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0078038  Vali Loss: 0.0069679 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
new best score!!!!
Validation loss decreased (0.007026 --> 0.006968).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 4.742511510848999
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0078835  Vali Loss: 0.0073917 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 4.74732780456543
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0083048  Vali Loss: 0.0079733 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 4.741586685180664
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0081597  Vali Loss: 0.0077678 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 4.739037036895752
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0085773  Vali Loss: 0.0075700 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 4.746415853500366
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0086384  Vali Loss: 0.0091445 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 32 cost time: 4.7448203563690186
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0100230  Vali Loss: 0.0065260 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.006968 --> 0.006526).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 4.741130352020264
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0125898  Vali Loss: 0.0077100 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 4.7456214427948
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0075982  Vali Loss: 0.0064323 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.006526 --> 0.006432).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 4.74401593208313
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0073373  Vali Loss: 0.0068489 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 4.745580673217773
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0070114  Vali Loss: 0.0067608 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974947  Vali macro F1 0.9975657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 4.742149829864502
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0076478  Vali Loss: 0.0067615 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 4.746454477310181
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0067714  Vali Loss: 0.0062307 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.006432 --> 0.006231).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 4.744193077087402
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0065494  Vali Loss: 0.0068029 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 4.7422850131988525
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0074189  Vali Loss: 0.0064408 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 4.742693662643433
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0082333  Vali Loss: 0.0064946 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 4.7409987449646
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0065219  Vali Loss: 0.0062556 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 4.743417739868164
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0069548  Vali Loss: 0.0056449 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
new best score!!!!
Validation loss decreased (0.006231 --> 0.005645).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 44 cost time: 4.744848251342773
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0058531  Vali Loss: 0.0063292 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 45 cost time: 4.745114088058472
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0058321  Vali Loss: 0.0061892 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9974005 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 46 cost time: 4.739084720611572
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0060829  Vali Loss: 0.0069978 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 47 cost time: 4.743272066116333
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0061473  Vali Loss: 0.0072278 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 48 cost time: 4.743407726287842
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0074065  Vali Loss: 0.0061480 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 49 cost time: 4.748914480209351
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0057866  Vali Loss: 0.0061663 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 50 cost time: 4.7454657554626465
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0057137  Vali Loss: 0.0061776 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 51 cost time: 4.740439176559448
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0083488  Vali Loss: 0.0061129 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 52 cost time: 4.744623899459839
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0060440  Vali Loss: 0.0061374 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 53 cost time: 4.744403839111328
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0071039  Vali Loss: 0.0062429 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 54 cost time: 4.745512247085571
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0067903  Vali Loss: 0.0062750 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 55 cost time: 4.74359130859375
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0059577  Vali Loss: 0.0062729 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 56 cost time: 4.7402637004852295
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0055949  Vali Loss: 0.0062641 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 57 cost time: 4.748011350631714
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0054285  Vali Loss: 0.0062684 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 58 cost time: 4.745307445526123
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0058757  Vali Loss: 0.0062576 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962419  Vali macro F1 0.9962666 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9570175  Test weighted F1: 0.9562487  Test macro F1 0.9562487 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.5030272006988525
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8693963  Vali Loss: 2.3981241 Vali Accuracy: 0.4298246  Vali weighted F1: 0.3501046  Vali macro F1 0.3556659 
Validation loss decreased (inf --> 2.398124).  Saving model ...
Epoch: 2 cost time: 3.4176688194274902
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7596417  Vali Loss: 1.2090815 Vali Accuracy: 0.7794486  Vali weighted F1: 0.7613524  Vali macro F1 0.7610309 
new best score!!!!
Validation loss decreased (2.398124 --> 1.209082).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.4111812114715576
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0253060  Vali Loss: 0.7352255 Vali Accuracy: 0.8897243  Vali weighted F1: 0.8796574  Vali macro F1 0.8757632 
new best score!!!!
Validation loss decreased (1.209082 --> 0.735226).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.415649890899658
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6832621  Vali Loss: 0.5149528 Vali Accuracy: 0.9473684  Vali weighted F1: 0.9430733  Vali macro F1 0.9414516 
new best score!!!!
Validation loss decreased (0.735226 --> 0.514953).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.413991689682007
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4926525  Vali Loss: 0.3651052 Vali Accuracy: 0.9473684  Vali weighted F1: 0.9430676  Vali macro F1 0.9407858 
new best score!!!!
Validation loss decreased (0.514953 --> 0.365105).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4133946895599365
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3796487  Vali Loss: 0.2798898 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9641883  Vali macro F1 0.9632502 
new best score!!!!
Validation loss decreased (0.365105 --> 0.279890).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4113261699676514
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3003259  Vali Loss: 0.2225113 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9723846  Vali macro F1 0.9715790 
new best score!!!!
Validation loss decreased (0.279890 --> 0.222511).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.454860210418701
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2398002  Vali Loss: 0.1795299 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9776185  Vali macro F1 0.9765892 
new best score!!!!
Validation loss decreased (0.222511 --> 0.179530).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.460014581680298
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1916328  Vali Loss: 0.1443724 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822264  Vali macro F1 0.9814976 
new best score!!!!
Validation loss decreased (0.179530 --> 0.144372).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.423551321029663
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1592314  Vali Loss: 0.1280044 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9767461  Vali macro F1 0.9758975 
new best score!!!!
Validation loss decreased (0.144372 --> 0.128004).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.417261838912964
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1358065  Vali Loss: 0.1062913 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874415  Vali macro F1 0.9869418 
new best score!!!!
Validation loss decreased (0.128004 --> 0.106291).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.4204790592193604
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1178131  Vali Loss: 0.0938727 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861202  Vali macro F1 0.9852296 
new best score!!!!
Validation loss decreased (0.106291 --> 0.093873).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.417475938796997
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1041366  Vali Loss: 0.0958170 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9793567  Vali macro F1 0.9786657 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 3.416823625564575
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0938589  Vali Loss: 0.0709720 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912172  Vali macro F1 0.9908434 
new best score!!!!
Validation loss decreased (0.093873 --> 0.070972).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.42146372795105
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0848633  Vali Loss: 0.0619787 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.070972 --> 0.061979).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.410656452178955
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0706625  Vali Loss: 0.0586350 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899243  Vali macro F1 0.9896711 
new best score!!!!
Validation loss decreased (0.061979 --> 0.058635).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.4135870933532715
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0694801  Vali Loss: 0.0644100 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860471  Vali macro F1 0.9853426 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 3.411160707473755
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0646052  Vali Loss: 0.0515752 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899691  Vali macro F1 0.9895466 
new best score!!!!
Validation loss decreased (0.058635 --> 0.051575).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.4129819869995117
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0599094  Vali Loss: 0.0501534 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897409  Vali macro F1 0.9896478 
new best score!!!!
Validation loss decreased (0.051575 --> 0.050153).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.421914577484131
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0485866  Vali Loss: 0.0418219 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.050153 --> 0.041822).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.475536823272705
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0492758  Vali Loss: 0.0619926 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9804785  Vali macro F1 0.9802281 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.4141948223114014
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0524932  Vali Loss: 0.0578105 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9791193  Vali macro F1 0.9786529 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 3.407148599624634
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0414561  Vali Loss: 0.0358005 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.041822 --> 0.035801).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.411111354827881
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0388972  Vali Loss: 0.0333879 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899739  Vali macro F1 0.9897524 
new best score!!!!
Validation loss decreased (0.035801 --> 0.033388).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.408970355987549
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0366546  Vali Loss: 0.0327911 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.033388 --> 0.032791).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.409369945526123
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0330659  Vali Loss: 0.0275434 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9921920 
new best score!!!!
Validation loss decreased (0.032791 --> 0.027543).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.4141790866851807
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0345242  Vali Loss: 0.0310591 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899766  Vali macro F1 0.9897468 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.4058377742767334
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0317077  Vali Loss: 0.0341432 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923871  Vali macro F1 0.9922492 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 3.4089837074279785
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0287691  Vali Loss: 0.0314070 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9921920 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 3.4098832607269287
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0285994  Vali Loss: 0.0291399 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912155  Vali macro F1 0.9910221 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 3.4220993518829346
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0255144  Vali Loss: 0.0273204 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
new best score!!!!
Validation loss decreased (0.027543 --> 0.027320).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.4637794494628906
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0232185  Vali Loss: 0.0265433 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.027320 --> 0.026543).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.44832706451416
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0215886  Vali Loss: 0.0235495 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924156  Vali macro F1 0.9922721 
new best score!!!!
Validation loss decreased (0.026543 --> 0.023550).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.4142866134643555
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0200700  Vali Loss: 0.0244604 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.4083030223846436
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0246123  Vali Loss: 0.0312442 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886513  Vali macro F1 0.9885166 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.414578437805176
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0310530  Vali Loss: 0.0227954 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.023550 --> 0.022795).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.4076859951019287
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0247913  Vali Loss: 0.0262535 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 3.4148831367492676
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0188313  Vali Loss: 0.0240282 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 3.4097042083740234
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0179285  Vali Loss: 0.0258949 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937248  Vali macro F1 0.9934983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 3.4122588634490967
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0176897  Vali Loss: 0.0322463 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887103  Vali macro F1 0.9876820 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 3.413339614868164
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0246095  Vali Loss: 0.0287152 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886740  Vali macro F1 0.9885992 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 3.422774076461792
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0215915  Vali Loss: 0.0247517 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898984  Vali macro F1 0.9898135 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.438309669494629
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0169892  Vali Loss: 0.0238802 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898984  Vali macro F1 0.9898135 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.5088629722595215
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0151637  Vali Loss: 0.0225319 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898984  Vali macro F1 0.9898135 
new best score!!!!
Validation loss decreased (0.022795 --> 0.022532).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.4195961952209473
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0160132  Vali Loss: 0.0225519 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.418874502182007
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0150803  Vali Loss: 0.0216027 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.022532 --> 0.021603).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.4170188903808594
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0176563  Vali Loss: 0.0209337 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.021603 --> 0.020934).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.4187839031219482
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0250298  Vali Loss: 0.0229873 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.415828227996826
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0157796  Vali Loss: 0.0212624 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.4210004806518555
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0144932  Vali Loss: 0.0214713 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.419647216796875
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0147098  Vali Loss: 0.0212651 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 3.421405553817749
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0151885  Vali Loss: 0.0223655 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 3.419302225112915
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0146448  Vali Loss: 0.0220785 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.422978401184082
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0142946  Vali Loss: 0.0219070 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.473933219909668
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0138448  Vali Loss: 0.0217819 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.4497132301330566
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0148999  Vali Loss: 0.0216410 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 3.4206433296203613
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0139752  Vali Loss: 0.0215064 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 3.4184162616729736
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0145426  Vali Loss: 0.0214949 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.4211177825927734
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0146688  Vali Loss: 0.0214780 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 3.4172255992889404
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0137797  Vali Loss: 0.0214774 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 3.421093463897705
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0142995  Vali Loss: 0.0214530 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 3.421312093734741
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0143073  Vali Loss: 0.0214485 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9017544  Test weighted F1: 0.8884264  Test macro F1 0.8884264 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.817009687423706
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0146711  Vali Loss: 0.0194287 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
Validation loss decreased (inf --> 0.019429).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.819887399673462
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0143196  Vali Loss: 0.0208225 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.819180727005005
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0138021  Vali Loss: 0.0192557 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.019429 --> 0.019256).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.818732976913452
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0128397  Vali Loss: 0.0193496 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.817143201828003
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0136237  Vali Loss: 0.0213505 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 4.816821813583374
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0123324  Vali Loss: 0.0183933 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.019256 --> 0.018393).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.813910007476807
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0125841  Vali Loss: 0.0181645 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.018393 --> 0.018164).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.818429231643677
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0120978  Vali Loss: 0.0198983 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.81397819519043
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0123392  Vali Loss: 0.0182502 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 4.817714214324951
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0111555  Vali Loss: 0.0180916 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.018164 --> 0.018092).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.819936752319336
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0108035  Vali Loss: 0.0184743 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.822201490402222
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0113911  Vali Loss: 0.0174846 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.018092 --> 0.017485).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.819708824157715
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0098888  Vali Loss: 0.0185429 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.816864252090454
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0106187  Vali Loss: 0.0191044 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.819918632507324
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0106557  Vali Loss: 0.0202213 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.819110631942749
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0114042  Vali Loss: 0.0195265 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 4.820181131362915
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0103848  Vali Loss: 0.0184584 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 4.817276239395142
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0098883  Vali Loss: 0.0187856 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.818139314651489
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0101455  Vali Loss: 0.0170651 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
new best score!!!!
Validation loss decreased (0.017485 --> 0.017065).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.815208673477173
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0090566  Vali Loss: 0.0182262 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.81805682182312
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0089373  Vali Loss: 0.0179081 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.820308446884155
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0089140  Vali Loss: 0.0166146 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.017065 --> 0.016615).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.814183473587036
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0090551  Vali Loss: 0.0196395 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 4.819821834564209
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0093809  Vali Loss: 0.0157639 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.016615 --> 0.015764).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.816925525665283
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0089016  Vali Loss: 0.0175459 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.812294006347656
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0086043  Vali Loss: 0.0189992 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924766  Vali macro F1 0.9922015 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 4.818058729171753
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0085769  Vali Loss: 0.0164928 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 4.814019680023193
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0091742  Vali Loss: 0.0155319 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924835  Vali macro F1 0.9922015 
new best score!!!!
Validation loss decreased (0.015764 --> 0.015532).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 4.8201117515563965
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0105481  Vali Loss: 0.0192988 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 4.816855430603027
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0087452  Vali Loss: 0.0206933 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899780  Vali macro F1 0.9896021 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 4.819115877151489
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0093172  Vali Loss: 0.0197038 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 4.816186189651489
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0089670  Vali Loss: 0.0193416 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 4.815113067626953
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0082958  Vali Loss: 0.0190445 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 34 cost time: 4.819049596786499
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0081023  Vali Loss: 0.0185861 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 4.816838502883911
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0085085  Vali Loss: 0.0184227 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 4.815691232681274
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0080645  Vali Loss: 0.0184329 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 4.821839094161987
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0081205  Vali Loss: 0.0182883 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 4.8199427127838135
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0076399  Vali Loss: 0.0181110 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 39 cost time: 4.817563772201538
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0074182  Vali Loss: 0.0180712 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 4.815985918045044
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0076874  Vali Loss: 0.0180604 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 4.815744638442993
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0102096  Vali Loss: 0.0180321 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 4.816726922988892
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0078473  Vali Loss: 0.0179658 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 4.816952705383301
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0077806  Vali Loss: 0.0179668 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9909032 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8429825  Test weighted F1: 0.8119229  Test macro F1 0.8119229 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0027027  0.00265252 0.00262467 0.00260417 0.00265252 0.00268097
 0.00262467 0.0026455  0.00265957 0.0025974  0.0025974  0.00268097
 0.00273224 0.0026178  0.00268097 0.00257069 0.0026178  0.00263852
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.502279281616211
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8633921  Vali Loss: 2.3615225 Vali Accuracy: 0.4323308  Vali weighted F1: 0.3492121  Vali macro F1 0.3599042 
Validation loss decreased (inf --> 2.361523).  Saving model ...
Epoch: 2 cost time: 3.482149124145508
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7637696  Vali Loss: 1.2187738 Vali Accuracy: 0.8471178  Vali weighted F1: 0.8323657  Vali macro F1 0.8278501 
new best score!!!!
Validation loss decreased (2.361523 --> 1.218774).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.4185595512390137
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0444785  Vali Loss: 0.7439622 Vali Accuracy: 0.9160401  Vali weighted F1: 0.9057716  Vali macro F1 0.9034498 
new best score!!!!
Validation loss decreased (1.218774 --> 0.743962).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.41140079498291
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6847189  Vali Loss: 0.4985699 Vali Accuracy: 0.9523810  Vali weighted F1: 0.9491997  Vali macro F1 0.9468352 
new best score!!!!
Validation loss decreased (0.743962 --> 0.498570).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.410374402999878
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4813445  Vali Loss: 0.3543730 Vali Accuracy: 0.9573935  Vali weighted F1: 0.9554332  Vali macro F1 0.9525015 
new best score!!!!
Validation loss decreased (0.498570 --> 0.354373).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4094626903533936
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3704566  Vali Loss: 0.2615465 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9782575  Vali macro F1 0.9779745 
new best score!!!!
Validation loss decreased (0.354373 --> 0.261547).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4045939445495605
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2918211  Vali Loss: 0.2121821 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9768722  Vali macro F1 0.9763227 
new best score!!!!
Validation loss decreased (0.261547 --> 0.212182).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.4127748012542725
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2287266  Vali Loss: 0.1627177 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860356  Vali macro F1 0.9860346 
new best score!!!!
Validation loss decreased (0.212182 --> 0.162718).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.409862518310547
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1838192  Vali Loss: 0.1308579 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885999  Vali macro F1 0.9879646 
new best score!!!!
Validation loss decreased (0.162718 --> 0.130858).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.409189462661743
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1434559  Vali Loss: 0.1113562 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9858510  Vali macro F1 0.9855778 
new best score!!!!
Validation loss decreased (0.130858 --> 0.111356).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.4162988662719727
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1174611  Vali Loss: 0.0942809 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898401  Vali macro F1 0.9899945 
new best score!!!!
Validation loss decreased (0.111356 --> 0.094281).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.415243148803711
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1020790  Vali Loss: 0.0773010 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910869  Vali macro F1 0.9908934 
new best score!!!!
Validation loss decreased (0.094281 --> 0.077301).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.469194173812866
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0892283  Vali Loss: 0.0665701 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924317  Vali macro F1 0.9922846 
new best score!!!!
Validation loss decreased (0.077301 --> 0.066570).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4490270614624023
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0812081  Vali Loss: 0.0606577 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949841  Vali macro F1 0.9950776 
new best score!!!!
Validation loss decreased (0.066570 --> 0.060658).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4119696617126465
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0711451  Vali Loss: 0.0507069 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974928  Vali macro F1 0.9974705 
new best score!!!!
Validation loss decreased (0.060658 --> 0.050707).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.4122979640960693
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0600823  Vali Loss: 0.0415685 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
new best score!!!!
Validation loss decreased (0.050707 --> 0.041569).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.411261796951294
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0584244  Vali Loss: 0.0488794 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924709  Vali macro F1 0.9924729 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 3.412985324859619
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0531749  Vali Loss: 0.0348206 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9973302 
new best score!!!!
Validation loss decreased (0.041569 --> 0.034821).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.410472869873047
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0472945  Vali Loss: 0.0338267 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962385  Vali macro F1 0.9963048 
new best score!!!!
Validation loss decreased (0.034821 --> 0.033827).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.4152703285217285
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0444110  Vali Loss: 0.0291057 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
new best score!!!!
Validation loss decreased (0.033827 --> 0.029106).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.4142777919769287
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0453129  Vali Loss: 0.0328929 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962282  Vali macro F1 0.9965013 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.4130284786224365
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0393233  Vali Loss: 0.0285337 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962233  Vali macro F1 0.9960756 
new best score!!!!
Validation loss decreased (0.029106 --> 0.028534).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.4259517192840576
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0357993  Vali Loss: 0.0232054 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987456  Vali macro F1 0.9988343 
new best score!!!!
Validation loss decreased (0.028534 --> 0.023205).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.416069269180298
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0324792  Vali Loss: 0.0225318 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9973302 
new best score!!!!
Validation loss decreased (0.023205 --> 0.022532).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.4838364124298096
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0350161  Vali Loss: 0.0219486 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987456  Vali macro F1 0.9988343 
new best score!!!!
Validation loss decreased (0.022532 --> 0.021949).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.417552947998047
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0285333  Vali Loss: 0.0192042 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974934  Vali macro F1 0.9976742 
new best score!!!!
Validation loss decreased (0.021949 --> 0.019204).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.41278076171875
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0313635  Vali Loss: 0.0292965 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949769  Vali macro F1 0.9949151 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.4145348072052
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0298788  Vali Loss: 0.0173905 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
new best score!!!!
Validation loss decreased (0.019204 --> 0.017391).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.419090509414673
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0219544  Vali Loss: 0.0158447 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
new best score!!!!
Validation loss decreased (0.017391 --> 0.015845).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.4112491607666016
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0226712  Vali Loss: 0.0144684 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
new best score!!!!
Validation loss decreased (0.015845 --> 0.014468).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.4106688499450684
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0218048  Vali Loss: 0.0131325 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014468 --> 0.013132).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.4086153507232666
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0406568  Vali Loss: 0.0201098 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974939  Vali macro F1 0.9971956 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.407825231552124
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0293426  Vali Loss: 0.0146866 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 3.408378839492798
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0209547  Vali Loss: 0.0146534 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 3.4213972091674805
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0207292  Vali Loss: 0.0108461 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013132 --> 0.010846).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.4605345726013184
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0171632  Vali Loss: 0.0101958 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010846 --> 0.010196).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.445755958557129
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0145162  Vali Loss: 0.0094976 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010196 --> 0.009498).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.409306287765503
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0140898  Vali Loss: 0.0106592 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987451  Vali macro F1 0.9988830 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 3.4050259590148926
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0150033  Vali Loss: 0.0090562 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009498 --> 0.009056).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.40635085105896
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0152341  Vali Loss: 0.0082974 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009056 --> 0.008297).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.4054553508758545
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0116804  Vali Loss: 0.0080361 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008297 --> 0.008036).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.40535044670105
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0186016  Vali Loss: 0.0138181 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.4049861431121826
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0244152  Vali Loss: 0.0091759 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.406625509262085
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0123173  Vali Loss: 0.0069506 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008036 --> 0.006951).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.403384208679199
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0102566  Vali Loss: 0.0063835 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006951 --> 0.006384).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 3.4122848510742188
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0105686  Vali Loss: 0.0066468 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 3.406653642654419
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0114232  Vali Loss: 0.0061311 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006384 --> 0.006131).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.4694840908050537
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0117264  Vali Loss: 0.0088462 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9986973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.411391258239746
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0154628  Vali Loss: 0.0088281 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.4034290313720703
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0303928  Vali Loss: 0.0210100 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962355  Vali macro F1 0.9962745 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.406034231185913
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0443982  Vali Loss: 0.0105897 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987472  Vali macro F1 0.9986997 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 3.407109260559082
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0171988  Vali Loss: 0.0064827 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 53 cost time: 3.405240774154663
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0115097  Vali Loss: 0.0060485 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006131 --> 0.006049).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 3.403764486312866
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0110985  Vali Loss: 0.0062438 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 3.4031009674072266
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0107549  Vali Loss: 0.0062264 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 3.4062857627868652
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0106191  Vali Loss: 0.0058710 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006049 --> 0.005871).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 3.4024956226348877
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0101342  Vali Loss: 0.0058665 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005871 --> 0.005866).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 3.416921615600586
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0103468  Vali Loss: 0.0058397 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005866 --> 0.005840).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 3.4615087509155273
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0103574  Vali Loss: 0.0057680 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005840 --> 0.005768).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 3.443098783493042
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0103748  Vali Loss: 0.0057306 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005768 --> 0.005731).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 3.4095041751861572
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0112264  Vali Loss: 0.0059136 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 3.4037342071533203
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0093931  Vali Loss: 0.0057543 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 3.408445119857788
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0094348  Vali Loss: 0.0056892 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005731 --> 0.005689).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 3.4042744636535645
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0092447  Vali Loss: 0.0057400 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 3.4078094959259033
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0095891  Vali Loss: 0.0055123 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005689 --> 0.005512).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 3.4113359451293945
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0090150  Vali Loss: 0.0054603 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005512 --> 0.005460).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 3.4033896923065186
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0088525  Vali Loss: 0.0054021 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005460 --> 0.005402).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 3.4059321880340576
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0088100  Vali Loss: 0.0054375 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 3.41900634765625
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0092533  Vali Loss: 0.0051951 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005402 --> 0.005195).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 3.407602310180664
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0094026  Vali Loss: 0.0051975 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 3.4712603092193604
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0083859  Vali Loss: 0.0051474 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005195 --> 0.005147).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 3.41277813911438
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0088882  Vali Loss: 0.0051178 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005147 --> 0.005118).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 3.4057936668395996
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0079559  Vali Loss: 0.0051070 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005118 --> 0.005107).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 3.4071662425994873
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0080606  Vali Loss: 0.0050306 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005107 --> 0.005031).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 3.405846118927002
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0080111  Vali Loss: 0.0049271 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005031 --> 0.004927).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 3.4040639400482178
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0083265  Vali Loss: 0.0049480 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 3.4111053943634033
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0080820  Vali Loss: 0.0048994 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004927 --> 0.004899).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 3.401606321334839
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0082730  Vali Loss: 0.0049045 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 3.4116158485412598
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0082754  Vali Loss: 0.0054402 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 3.4076969623565674
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0079081  Vali Loss: 0.0050937 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 3.421840190887451
VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0077145  Vali Loss: 0.0049269 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 3.470724582672119
VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0075405  Vali Loss: 0.0048722 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004899 --> 0.004872).  Saving model ...
new best score!!!!
Epoch: 83 cost time: 3.4458770751953125
VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0081493  Vali Loss: 0.0048805 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 3.4120256900787354
VALI: Epoch: 84, Steps: 29 | Train Loss: 0.0172751  Vali Loss: 0.0048691 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004872 --> 0.004869).  Saving model ...
new best score!!!!
Epoch: 85 cost time: 3.4134321212768555
VALI: Epoch: 85, Steps: 29 | Train Loss: 0.0097491  Vali Loss: 0.0051077 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 86 cost time: 3.4127144813537598
VALI: Epoch: 86, Steps: 29 | Train Loss: 0.0077987  Vali Loss: 0.0049060 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 87 cost time: 3.420300006866455
VALI: Epoch: 87, Steps: 29 | Train Loss: 0.0074734  Vali Loss: 0.0048659 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004869 --> 0.004866).  Saving model ...
new best score!!!!
Epoch: 88 cost time: 3.4076833724975586
VALI: Epoch: 88, Steps: 29 | Train Loss: 0.0073624  Vali Loss: 0.0048554 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004866 --> 0.004855).  Saving model ...
new best score!!!!
Epoch: 89 cost time: 3.4088852405548096
VALI: Epoch: 89, Steps: 29 | Train Loss: 0.0072514  Vali Loss: 0.0048528 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004855 --> 0.004853).  Saving model ...
new best score!!!!
Epoch: 90 cost time: 3.40773868560791
VALI: Epoch: 90, Steps: 29 | Train Loss: 0.0077490  Vali Loss: 0.0048123 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004853 --> 0.004812).  Saving model ...
new best score!!!!
Epoch: 91 cost time: 3.4059488773345947
VALI: Epoch: 91, Steps: 29 | Train Loss: 0.0071464  Vali Loss: 0.0047487 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004812 --> 0.004749).  Saving model ...
new best score!!!!
Epoch: 92 cost time: 3.455497980117798
VALI: Epoch: 92, Steps: 29 | Train Loss: 0.0080999  Vali Loss: 0.0047778 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 93 cost time: 3.4641926288604736
VALI: Epoch: 93, Steps: 29 | Train Loss: 0.0067365  Vali Loss: 0.0047159 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004749 --> 0.004716).  Saving model ...
new best score!!!!
Epoch: 94 cost time: 3.4859015941619873
VALI: Epoch: 94, Steps: 29 | Train Loss: 0.0075292  Vali Loss: 0.0046301 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004716 --> 0.004630).  Saving model ...
new best score!!!!
Epoch: 95 cost time: 3.422076463699341
VALI: Epoch: 95, Steps: 29 | Train Loss: 0.0175762  Vali Loss: 0.0053774 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 96 cost time: 3.418168067932129
VALI: Epoch: 96, Steps: 29 | Train Loss: 0.0068942  Vali Loss: 0.0044930 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004630 --> 0.004493).  Saving model ...
new best score!!!!
Epoch: 97 cost time: 3.413822889328003
VALI: Epoch: 97, Steps: 29 | Train Loss: 0.0066636  Vali Loss: 0.0044719 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004493 --> 0.004472).  Saving model ...
new best score!!!!
Epoch: 98 cost time: 3.4147653579711914
VALI: Epoch: 98, Steps: 29 | Train Loss: 0.0065449  Vali Loss: 0.0044929 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 99 cost time: 3.4150712490081787
VALI: Epoch: 99, Steps: 29 | Train Loss: 0.0070531  Vali Loss: 0.0044139 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004472 --> 0.004414).  Saving model ...
new best score!!!!
Epoch: 100 cost time: 3.418828248977661
VALI: Epoch: 100, Steps: 29 | Train Loss: 0.0066463  Vali Loss: 0.0043477 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004414 --> 0.004348).  Saving model ...
new best score!!!!
Epoch: 101 cost time: 3.419478416442871
VALI: Epoch: 101, Steps: 29 | Train Loss: 0.0067144  Vali Loss: 0.0042556 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004348 --> 0.004256).  Saving model ...
new best score!!!!
Epoch: 102 cost time: 3.416243076324463
VALI: Epoch: 102, Steps: 29 | Train Loss: 0.0066670  Vali Loss: 0.0041992 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004256 --> 0.004199).  Saving model ...
new best score!!!!
Epoch: 103 cost time: 3.4220354557037354
VALI: Epoch: 103, Steps: 29 | Train Loss: 0.0058793  Vali Loss: 0.0042278 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 104 cost time: 3.423900842666626
VALI: Epoch: 104, Steps: 29 | Train Loss: 0.0069539  Vali Loss: 0.0041556 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004199 --> 0.004156).  Saving model ...
new best score!!!!
Epoch: 105 cost time: 3.4677581787109375
VALI: Epoch: 105, Steps: 29 | Train Loss: 0.0061729  Vali Loss: 0.0041036 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004156 --> 0.004104).  Saving model ...
new best score!!!!
Epoch: 106 cost time: 3.4537298679351807
VALI: Epoch: 106, Steps: 29 | Train Loss: 0.0064068  Vali Loss: 0.0042222 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 107 cost time: 3.4191267490386963
VALI: Epoch: 107, Steps: 29 | Train Loss: 0.0062072  Vali Loss: 0.0041585 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 108 cost time: 3.4163403511047363
VALI: Epoch: 108, Steps: 29 | Train Loss: 0.0063643  Vali Loss: 0.0040422 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004104 --> 0.004042).  Saving model ...
new best score!!!!
Epoch: 109 cost time: 3.4129555225372314
VALI: Epoch: 109, Steps: 29 | Train Loss: 0.0059851  Vali Loss: 0.0040921 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 110 cost time: 3.4153757095336914
VALI: Epoch: 110, Steps: 29 | Train Loss: 0.0067676  Vali Loss: 0.0040415 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004042 --> 0.004042).  Saving model ...
new best score!!!!
Epoch: 111 cost time: 3.4157493114471436
VALI: Epoch: 111, Steps: 29 | Train Loss: 0.0062201  Vali Loss: 0.0039713 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004042 --> 0.003971).  Saving model ...
new best score!!!!
Epoch: 112 cost time: 3.4090964794158936
VALI: Epoch: 112, Steps: 29 | Train Loss: 0.0058713  Vali Loss: 0.0039960 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 113 cost time: 3.4179980754852295
VALI: Epoch: 113, Steps: 29 | Train Loss: 0.0058892  Vali Loss: 0.0040688 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 114 cost time: 3.4191229343414307
VALI: Epoch: 114, Steps: 29 | Train Loss: 0.0057616  Vali Loss: 0.0040076 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 115 cost time: 3.42771053314209
VALI: Epoch: 115, Steps: 29 | Train Loss: 0.0059703  Vali Loss: 0.0039529 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003971 --> 0.003953).  Saving model ...
new best score!!!!
Epoch: 116 cost time: 3.428830146789551
VALI: Epoch: 116, Steps: 29 | Train Loss: 0.0068210  Vali Loss: 0.0039342 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003953 --> 0.003934).  Saving model ...
new best score!!!!
Epoch: 117 cost time: 3.4696481227874756
VALI: Epoch: 117, Steps: 29 | Train Loss: 0.0060139  Vali Loss: 0.0039409 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 118 cost time: 3.4210565090179443
VALI: Epoch: 118, Steps: 29 | Train Loss: 0.0063257  Vali Loss: 0.0039582 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 119 cost time: 3.417574405670166
VALI: Epoch: 119, Steps: 29 | Train Loss: 0.0056420  Vali Loss: 0.0040256 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 120 cost time: 3.417508840560913
VALI: Epoch: 120, Steps: 29 | Train Loss: 0.0054364  Vali Loss: 0.0039165 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003934 --> 0.003916).  Saving model ...
new best score!!!!
Epoch: 121 cost time: 3.410536766052246
VALI: Epoch: 121, Steps: 29 | Train Loss: 0.0055046  Vali Loss: 0.0038856 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003916 --> 0.003886).  Saving model ...
new best score!!!!
Epoch: 122 cost time: 3.4128940105438232
VALI: Epoch: 122, Steps: 29 | Train Loss: 0.0058333  Vali Loss: 0.0038034 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003886 --> 0.003803).  Saving model ...
new best score!!!!
Epoch: 123 cost time: 3.407177209854126
VALI: Epoch: 123, Steps: 29 | Train Loss: 0.0052627  Vali Loss: 0.0037575 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003803 --> 0.003758).  Saving model ...
new best score!!!!
Epoch: 124 cost time: 3.4120843410491943
VALI: Epoch: 124, Steps: 29 | Train Loss: 0.0051492  Vali Loss: 0.0037495 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003758 --> 0.003750).  Saving model ...
new best score!!!!
Epoch: 125 cost time: 3.410404682159424
VALI: Epoch: 125, Steps: 29 | Train Loss: 0.0054234  Vali Loss: 0.0037164 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003750 --> 0.003716).  Saving model ...
new best score!!!!
Epoch: 126 cost time: 3.412409543991089
VALI: Epoch: 126, Steps: 29 | Train Loss: 0.0052842  Vali Loss: 0.0037194 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 127 cost time: 3.42144513130188
VALI: Epoch: 127, Steps: 29 | Train Loss: 0.0054437  Vali Loss: 0.0037292 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 128 cost time: 3.4742300510406494
VALI: Epoch: 128, Steps: 29 | Train Loss: 0.0085258  Vali Loss: 0.0039423 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 129 cost time: 3.449406385421753
VALI: Epoch: 129, Steps: 29 | Train Loss: 0.0068110  Vali Loss: 0.0040472 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 130 cost time: 3.4181461334228516
VALI: Epoch: 130, Steps: 29 | Train Loss: 0.0055892  Vali Loss: 0.0037594 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 131 cost time: 3.418646812438965
VALI: Epoch: 131, Steps: 29 | Train Loss: 0.0055694  Vali Loss: 0.0037668 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 132 cost time: 3.4177675247192383
VALI: Epoch: 132, Steps: 29 | Train Loss: 0.0054481  Vali Loss: 0.0037685 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 133 cost time: 3.417820453643799
VALI: Epoch: 133, Steps: 29 | Train Loss: 0.0051840  Vali Loss: 0.0037658 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 134 cost time: 3.4170920848846436
VALI: Epoch: 134, Steps: 29 | Train Loss: 0.0052486  Vali Loss: 0.0037622 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 135 cost time: 3.4200241565704346
VALI: Epoch: 135, Steps: 29 | Train Loss: 0.0054423  Vali Loss: 0.0037616 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 136 cost time: 3.4170982837677
VALI: Epoch: 136, Steps: 29 | Train Loss: 0.0053072  Vali Loss: 0.0037615 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 137 cost time: 3.420487880706787
VALI: Epoch: 137, Steps: 29 | Train Loss: 0.0051820  Vali Loss: 0.0037597 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 138 cost time: 3.4279582500457764
VALI: Epoch: 138, Steps: 29 | Train Loss: 0.0049851  Vali Loss: 0.0037584 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 139 cost time: 3.445258378982544
VALI: Epoch: 139, Steps: 29 | Train Loss: 0.0053466  Vali Loss: 0.0037582 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 140 cost time: 3.4701552391052246
VALI: Epoch: 140, Steps: 29 | Train Loss: 0.0052551  Vali Loss: 0.0037577 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8131579  Test weighted F1: 0.7812787  Test macro F1 0.7812787 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.81732439994812
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0054472  Vali Loss: 0.0035546 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.003555).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.818860769271851
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0057424  Vali Loss: 0.0034030 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003555 --> 0.003403).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.817620038986206
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0056360  Vali Loss: 0.0034188 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.81516170501709
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0052473  Vali Loss: 0.0031714 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003403 --> 0.003171).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.812378406524658
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0048516  Vali Loss: 0.0031140 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003171 --> 0.003114).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.817830324172974
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0062040  Vali Loss: 0.0028826 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003114 --> 0.002883).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.816156387329102
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0044491  Vali Loss: 0.0028835 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.815520524978638
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0056155  Vali Loss: 0.0028810 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002883 --> 0.002881).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.817766904830933
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0041660  Vali Loss: 0.0025174 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002881 --> 0.002517).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.816653251647949
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0046298  Vali Loss: 0.0025195 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 4.817873954772949
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0041532  Vali Loss: 0.0024830 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002517 --> 0.002483).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.81540584564209
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0041357  Vali Loss: 0.0025978 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.815303087234497
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0038114  Vali Loss: 0.0023118 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002483 --> 0.002312).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.822407007217407
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0038304  Vali Loss: 0.0022737 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002312 --> 0.002274).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.817720413208008
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0035550  Vali Loss: 0.0023046 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.814151048660278
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0043017  Vali Loss: 0.0022084 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002274 --> 0.002208).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.811001539230347
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0035482  Vali Loss: 0.0022182 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.805146217346191
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0035008  Vali Loss: 0.0022961 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 4.809763669967651
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0032540  Vali Loss: 0.0020561 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002208 --> 0.002056).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.813171625137329
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0033472  Vali Loss: 0.0019575 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002056 --> 0.001957).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 4.809956789016724
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0032692  Vali Loss: 0.0019374 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001957 --> 0.001937).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 4.808138847351074
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0039008  Vali Loss: 0.0020115 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 4.810610055923462
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0033105  Vali Loss: 0.0020015 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 4.804296016693115
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0028315  Vali Loss: 0.0019114 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001937 --> 0.001911).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.807091951370239
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0033979  Vali Loss: 0.0018119 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001911 --> 0.001812).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 4.80639386177063
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0030301  Vali Loss: 0.0018003 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001812 --> 0.001800).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 4.807519435882568
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0027773  Vali Loss: 0.0017060 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001800 --> 0.001706).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 4.809201240539551
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0029390  Vali Loss: 0.0016080 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001706 --> 0.001608).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 4.809873819351196
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0032747  Vali Loss: 0.0017357 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 4.802381992340088
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0037394  Vali Loss: 0.0016147 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 4.805965900421143
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0032403  Vali Loss: 0.0015510 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001608 --> 0.001551).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 4.803258657455444
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0028345  Vali Loss: 0.0017231 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 4.803452968597412
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0027141  Vali Loss: 0.0015468 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001551 --> 0.001547).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 4.804588794708252
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0026386  Vali Loss: 0.0014733 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001547 --> 0.001473).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 4.808933734893799
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0025790  Vali Loss: 0.0015901 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 4.807311058044434
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0032478  Vali Loss: 0.0015905 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 4.803670883178711
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0030979  Vali Loss: 0.0018223 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 4.808746337890625
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0028346  Vali Loss: 0.0015000 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 4.809367656707764
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0024340  Vali Loss: 0.0014556 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001473 --> 0.001456).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 40 cost time: 4.803340435028076
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0024871  Vali Loss: 0.0013275 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001456 --> 0.001328).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 41 cost time: 4.8035054206848145
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0023846  Vali Loss: 0.0011952 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001328 --> 0.001195).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 42 cost time: 4.792121648788452
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0024777  Vali Loss: 0.0012169 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 43 cost time: 4.792464256286621
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0027196  Vali Loss: 0.0012195 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 44 cost time: 4.793530464172363
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0022735  Vali Loss: 0.0011249 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001195 --> 0.001125).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 45 cost time: 4.79162859916687
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0026470  Vali Loss: 0.0011544 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 46 cost time: 4.789729595184326
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0022887  Vali Loss: 0.0014513 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 47 cost time: 4.7889244556427
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0022924  Vali Loss: 0.0012672 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 48 cost time: 4.795417785644531
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0026692  Vali Loss: 0.0010670 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001125 --> 0.001067).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 49 cost time: 4.7944581508636475
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0020488  Vali Loss: 0.0010611 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001067 --> 0.001061).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 4.795088768005371
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0021308  Vali Loss: 0.0010034 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001061 --> 0.001003).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 4.793368339538574
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0020048  Vali Loss: 0.0009706 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001003 --> 0.000971).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 52 cost time: 4.792144298553467
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0022166  Vali Loss: 0.0010339 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 53 cost time: 4.793370008468628
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0019610  Vali Loss: 0.0009668 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000971 --> 0.000967).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 54 cost time: 4.793352842330933
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0019349  Vali Loss: 0.0009004 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.000967 --> 0.000900).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 55 cost time: 4.792588472366333
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0019310  Vali Loss: 0.0009186 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 56 cost time: 4.7939910888671875
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0024330  Vali Loss: 0.0009614 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 57 cost time: 4.7968363761901855
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0021085  Vali Loss: 0.0010417 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 58 cost time: 4.798146724700928
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0019138  Vali Loss: 0.0009278 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 59 cost time: 4.8003456592559814
Fine Tuning VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0024029  Vali Loss: 0.0012735 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 60 cost time: 4.796634912490845
Fine Tuning VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0028702  Vali Loss: 0.0017078 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 61 cost time: 4.793933391571045
Fine Tuning VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0023419  Vali Loss: 0.0019881 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 62 cost time: 4.795684576034546
Fine Tuning VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0023993  Vali Loss: 0.0021391 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 63 cost time: 4.7956695556640625
Fine Tuning VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0019076  Vali Loss: 0.0019403 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9989745 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 64 cost time: 4.796636343002319
Fine Tuning VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0024776  Vali Loss: 0.0014682 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 65 cost time: 4.792787075042725
Fine Tuning VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0021383  Vali Loss: 0.0014983 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 66 cost time: 4.7968056201934814
Fine Tuning VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0020714  Vali Loss: 0.0015237 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 67 cost time: 4.797882080078125
Fine Tuning VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0023532  Vali Loss: 0.0015170 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 68 cost time: 4.7946696281433105
Fine Tuning VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0018182  Vali Loss: 0.0015048 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 69 cost time: 4.792816400527954
Fine Tuning VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0018481  Vali Loss: 0.0015268 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8131579  Test weighted F1: 0.7828263  Test macro F1 0.7828263 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 104364
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.489597797393799
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8595839  Vali Loss: 2.4596102 Vali Accuracy: 0.2819549  Vali weighted F1: 0.2058901  Vali macro F1 0.2096696 
Validation loss decreased (inf --> 2.459610).  Saving model ...
Epoch: 2 cost time: 3.410874366760254
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7618793  Vali Loss: 1.1865598 Vali Accuracy: 0.8634085  Vali weighted F1: 0.8480988  Vali macro F1 0.8455218 
new best score!!!!
Validation loss decreased (2.459610 --> 1.186560).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.4062771797180176
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.9840779  Vali Loss: 0.7416550 Vali Accuracy: 0.9235589  Vali weighted F1: 0.9167434  Vali macro F1 0.9163055 
new best score!!!!
Validation loss decreased (1.186560 --> 0.741655).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.4092612266540527
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6643617  Vali Loss: 0.5325393 Vali Accuracy: 0.9210526  Vali weighted F1: 0.9187038  Vali macro F1 0.9190170 
new best score!!!!
Validation loss decreased (0.741655 --> 0.532539).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.4108715057373047
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4751590  Vali Loss: 0.3921393 Vali Accuracy: 0.9498747  Vali weighted F1: 0.9486199  Vali macro F1 0.9490259 
new best score!!!!
Validation loss decreased (0.532539 --> 0.392139).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4110233783721924
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3695246  Vali Loss: 0.3061035 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9745012  Vali macro F1 0.9742117 
new best score!!!!
Validation loss decreased (0.392139 --> 0.306103).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4149444103240967
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2987303  Vali Loss: 0.2523251 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9736025  Vali macro F1 0.9733881 
new best score!!!!
Validation loss decreased (0.306103 --> 0.252325).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.4214842319488525
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2460420  Vali Loss: 0.2055567 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9784472  Vali macro F1 0.9786065 
new best score!!!!
Validation loss decreased (0.252325 --> 0.205557).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.4608936309814453
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2027581  Vali Loss: 0.1686773 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9773240  Vali macro F1 0.9774203 
new best score!!!!
Validation loss decreased (0.205557 --> 0.168677).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.4513967037200928
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1679803  Vali Loss: 0.1501975 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9782332  Vali macro F1 0.9780543 
new best score!!!!
Validation loss decreased (0.168677 --> 0.150198).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.419189214706421
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1408950  Vali Loss: 0.1291561 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822133  Vali macro F1 0.9825487 
new best score!!!!
Validation loss decreased (0.150198 --> 0.129156).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.41335391998291
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1187868  Vali Loss: 0.1109556 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848365  Vali macro F1 0.9849788 
new best score!!!!
Validation loss decreased (0.129156 --> 0.110956).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4136383533477783
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1042917  Vali Loss: 0.0996971 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848591  Vali macro F1 0.9852254 
new best score!!!!
Validation loss decreased (0.110956 --> 0.099697).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4107024669647217
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0911567  Vali Loss: 0.0877205 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861811  Vali macro F1 0.9863768 
new best score!!!!
Validation loss decreased (0.099697 --> 0.087720).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.416195869445801
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0806537  Vali Loss: 0.0743422 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887009  Vali macro F1 0.9889963 
new best score!!!!
Validation loss decreased (0.087720 --> 0.074342).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.4146955013275146
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0769236  Vali Loss: 0.0746473 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847426  Vali macro F1 0.9849276 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 3.4127070903778076
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0658845  Vali Loss: 0.0653016 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887599  Vali macro F1 0.9891583 
new best score!!!!
Validation loss decreased (0.074342 --> 0.065302).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.4114108085632324
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0652321  Vali Loss: 0.0750223 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809856  Vali macro F1 0.9809672 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 3.4120352268218994
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0586603  Vali Loss: 0.0566838 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875132  Vali macro F1 0.9878160 
new best score!!!!
Validation loss decreased (0.065302 --> 0.056684).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.413961172103882
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0513442  Vali Loss: 0.0521881 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886864  Vali macro F1 0.9888071 
new best score!!!!
Validation loss decreased (0.056684 --> 0.052188).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.4218337535858154
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0525174  Vali Loss: 0.0484462 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874087  Vali macro F1 0.9877003 
new best score!!!!
Validation loss decreased (0.052188 --> 0.048446).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.4711623191833496
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0429832  Vali Loss: 0.0481639 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861799  Vali macro F1 0.9865711 
new best score!!!!
Validation loss decreased (0.048446 --> 0.048164).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.4543650150299072
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0393051  Vali Loss: 0.0419349 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899887  Vali macro F1 0.9902874 
new best score!!!!
Validation loss decreased (0.048164 --> 0.041935).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.4157025814056396
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0363626  Vali Loss: 0.0443977 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874668  Vali macro F1 0.9875995 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.416977643966675
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0345503  Vali Loss: 0.0407630 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911355  Vali macro F1 0.9912657 
new best score!!!!
Validation loss decreased (0.041935 --> 0.040763).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.414202928543091
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0331454  Vali Loss: 0.0369408 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
new best score!!!!
Validation loss decreased (0.040763 --> 0.036941).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.417875289916992
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0340830  Vali Loss: 0.0353212 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898902  Vali macro F1 0.9899236 
new best score!!!!
Validation loss decreased (0.036941 --> 0.035321).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.415915012359619
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0299032  Vali Loss: 0.0406009 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851579  Vali macro F1 0.9853890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.417848825454712
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0335415  Vali Loss: 0.0354314 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912226  Vali macro F1 0.9913700 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 3.414161443710327
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0354511  Vali Loss: 0.0314395 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924263  Vali macro F1 0.9925598 
new best score!!!!
Validation loss decreased (0.035321 --> 0.031439).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.4162089824676514
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0270912  Vali Loss: 0.0293565 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
new best score!!!!
Validation loss decreased (0.031439 --> 0.029356).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.4199655055999756
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0241769  Vali Loss: 0.0301376 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.4474499225616455
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0235724  Vali Loss: 0.0264425 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898419  Vali macro F1 0.9901362 
new best score!!!!
Validation loss decreased (0.029356 --> 0.026443).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.469970941543579
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0252111  Vali Loss: 0.0364975 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887835  Vali macro F1 0.9889303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.419865846633911
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0522807  Vali Loss: 0.0417897 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835405  Vali macro F1 0.9837298 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.4149930477142334
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0317310  Vali Loss: 0.0315643 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899251  Vali macro F1 0.9902515 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 3.415395498275757
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0240653  Vali Loss: 0.0258976 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924922  Vali macro F1 0.9927521 
new best score!!!!
Validation loss decreased (0.026443 --> 0.025898).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.413060426712036
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0204788  Vali Loss: 0.0236175 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924442  Vali macro F1 0.9926728 
new best score!!!!
Validation loss decreased (0.025898 --> 0.023617).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.415410041809082
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0216996  Vali Loss: 0.0274213 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912394  Vali macro F1 0.9914133 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.413714647293091
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0212415  Vali Loss: 0.0262264 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898908  Vali macro F1 0.9900106 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 3.4147346019744873
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0211095  Vali Loss: 0.0189435 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937178  Vali macro F1 0.9939492 
new best score!!!!
Validation loss decreased (0.023617 --> 0.018944).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.4151368141174316
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0198787  Vali Loss: 0.0204173 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936628  Vali macro F1 0.9938778 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.4146006107330322
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0172276  Vali Loss: 0.0228791 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924263  Vali macro F1 0.9925598 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.428076982498169
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0159468  Vali Loss: 0.0246799 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 3.4715425968170166
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0170360  Vali Loss: 0.0223217 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 3.4441335201263428
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0137471  Vali Loss: 0.0213538 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 3.4176692962646484
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0137477  Vali Loss: 0.0208639 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 3.4155068397521973
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0135252  Vali Loss: 0.0212144 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 3.413771152496338
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0134493  Vali Loss: 0.0220566 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 3.4138503074645996
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0129395  Vali Loss: 0.0223499 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 3.4146554470062256
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0131599  Vali Loss: 0.0219549 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 3.4171407222747803
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0143741  Vali Loss: 0.0219100 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 3.4171364307403564
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0126938  Vali Loss: 0.0219506 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 3.415260076522827
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0121472  Vali Loss: 0.0220584 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 3.4173836708068848
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0124001  Vali Loss: 0.0221597 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 3.46040678024292
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0134710  Vali Loss: 0.0222441 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912067  Vali macro F1 0.9914271 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8596491  Test weighted F1: 0.8387929  Test macro F1 0.8387929 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.827268362045288
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0266068  Vali Loss: 0.0207710 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924284  Vali macro F1 0.9927299 
Validation loss decreased (inf --> 0.020771).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.824831485748291
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0152283  Vali Loss: 0.0211709 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.82532811164856
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0146304  Vali Loss: 0.0196497 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950032  Vali macro F1 0.9951622 
new best score!!!!
Validation loss decreased (0.020771 --> 0.019650).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.8195953369140625
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0147650  Vali Loss: 0.0209011 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937178  Vali macro F1 0.9939492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.823030948638916
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0141796  Vali Loss: 0.0220845 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 4.824682712554932
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0141274  Vali Loss: 0.0211528 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937178  Vali macro F1 0.9939492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 4.822888135910034
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0136207  Vali Loss: 0.0208464 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937178  Vali macro F1 0.9939492 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 4.824856281280518
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0130867  Vali Loss: 0.0206157 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924284  Vali macro F1 0.9927299 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 4.823853969573975
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0123234  Vali Loss: 0.0208442 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.828666687011719
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0120242  Vali Loss: 0.0199685 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 4.823156118392944
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0129335  Vali Loss: 0.0196275 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
new best score!!!!
Validation loss decreased (0.019650 --> 0.019627).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.8242175579071045
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0121778  Vali Loss: 0.0189286 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937178  Vali macro F1 0.9939492 
new best score!!!!
Validation loss decreased (0.019627 --> 0.018929).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.822702646255493
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0119098  Vali Loss: 0.0194788 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.819748640060425
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0128964  Vali Loss: 0.0193113 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.822984457015991
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0123364  Vali Loss: 0.0172856 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937178  Vali macro F1 0.9939492 
new best score!!!!
Validation loss decreased (0.018929 --> 0.017286).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.823873519897461
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0111767  Vali Loss: 0.0187291 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 4.8232057094573975
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0104646  Vali Loss: 0.0194707 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 4.823594331741333
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0110199  Vali Loss: 0.0197698 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 4.825840950012207
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0110748  Vali Loss: 0.0181259 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937794  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 4.821232795715332
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0109422  Vali Loss: 0.0178550 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 4.819265365600586
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0100934  Vali Loss: 0.0178407 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.823857545852661
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0106375  Vali Loss: 0.0180083 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 4.825620889663696
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0109005  Vali Loss: 0.0181801 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 4.8265955448150635
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0101692  Vali Loss: 0.0182739 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 4.827521562576294
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0100984  Vali Loss: 0.0186317 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 4.824815511703491
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0100145  Vali Loss: 0.0186123 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.821805715560913
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0111062  Vali Loss: 0.0185763 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.822673082351685
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0104421  Vali Loss: 0.0185282 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 4.826709747314453
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0103451  Vali Loss: 0.0185862 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 4.822715759277344
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0109458  Vali Loss: 0.0185807 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924950  Vali macro F1 0.9926452 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8798246  Test weighted F1: 0.8723408  Test macro F1 0.8723408 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.474416971206665
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8605162  Vali Loss: 2.4487075 Vali Accuracy: 0.3258145  Vali weighted F1: 0.2664103  Vali macro F1 0.2730240 
Validation loss decreased (inf --> 2.448708).  Saving model ...
Epoch: 2 cost time: 3.407787561416626
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7540262  Vali Loss: 1.1846512 Vali Accuracy: 0.8721805  Vali weighted F1: 0.8586442  Vali macro F1 0.8615956 
new best score!!!!
Validation loss decreased (2.448708 --> 1.184651).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.4203360080718994
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0025039  Vali Loss: 0.7566465 Vali Accuracy: 0.8947368  Vali weighted F1: 0.8857189  Vali macro F1 0.8864449 
new best score!!!!
Validation loss decreased (1.184651 --> 0.756647).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.409187078475952
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6779079  Vali Loss: 0.5205455 Vali Accuracy: 0.9348371  Vali weighted F1: 0.9305362  Vali macro F1 0.9307268 
new best score!!!!
Validation loss decreased (0.756647 --> 0.520545).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.4811408519744873
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4904272  Vali Loss: 0.3930727 Vali Accuracy: 0.9486216  Vali weighted F1: 0.9480077  Vali macro F1 0.9472198 
new best score!!!!
Validation loss decreased (0.520545 --> 0.393073).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4256157875061035
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3871154  Vali Loss: 0.3174683 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9629784  Vali macro F1 0.9624689 
new best score!!!!
Validation loss decreased (0.393073 --> 0.317468).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.41583251953125
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3193027  Vali Loss: 0.2601014 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9615042  Vali macro F1 0.9613538 
new best score!!!!
Validation loss decreased (0.317468 --> 0.260101).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.4083149433135986
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2621406  Vali Loss: 0.2178571 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9719090  Vali macro F1 0.9715645 
new best score!!!!
Validation loss decreased (0.260101 --> 0.217857).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.40610671043396
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2144178  Vali Loss: 0.1824743 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9786584  Vali macro F1 0.9785676 
new best score!!!!
Validation loss decreased (0.217857 --> 0.182474).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.4108381271362305
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1819601  Vali Loss: 0.1536238 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9813888  Vali macro F1 0.9813900 
new best score!!!!
Validation loss decreased (0.182474 --> 0.153624).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.4143459796905518
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1504718  Vali Loss: 0.1324901 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861987  Vali macro F1 0.9864545 
new best score!!!!
Validation loss decreased (0.153624 --> 0.132490).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.410717725753784
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1269134  Vali Loss: 0.1136585 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886823  Vali macro F1 0.9886429 
new best score!!!!
Validation loss decreased (0.132490 --> 0.113659).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4123733043670654
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1093296  Vali Loss: 0.0963935 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886520  Vali macro F1 0.9888580 
new best score!!!!
Validation loss decreased (0.113659 --> 0.096394).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.417358875274658
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.1022194  Vali Loss: 0.0870996 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899832  Vali macro F1 0.9902543 
new best score!!!!
Validation loss decreased (0.096394 --> 0.087100).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.414555788040161
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0884883  Vali Loss: 0.0787787 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873731  Vali macro F1 0.9876260 
new best score!!!!
Validation loss decreased (0.087100 --> 0.078779).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.409872055053711
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0808825  Vali Loss: 0.0677102 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899046  Vali macro F1 0.9901128 
new best score!!!!
Validation loss decreased (0.078779 --> 0.067710).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.422407388687134
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0684498  Vali Loss: 0.0607771 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912096  Vali macro F1 0.9913480 
new best score!!!!
Validation loss decreased (0.067710 --> 0.060777).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.4906413555145264
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0631573  Vali Loss: 0.0584508 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887252  Vali macro F1 0.9889868 
new best score!!!!
Validation loss decreased (0.060777 --> 0.058451).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.428882360458374
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0552312  Vali Loss: 0.0567618 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886521  Vali macro F1 0.9887826 
new best score!!!!
Validation loss decreased (0.058451 --> 0.056762).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.4155757427215576
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0515062  Vali Loss: 0.0516445 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899046  Vali macro F1 0.9901128 
new best score!!!!
Validation loss decreased (0.056762 --> 0.051645).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.413236379623413
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0494050  Vali Loss: 0.0494626 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912096  Vali macro F1 0.9913480 
new best score!!!!
Validation loss decreased (0.051645 --> 0.049463).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.418302536010742
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0450480  Vali Loss: 0.0461868 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899046  Vali macro F1 0.9901128 
new best score!!!!
Validation loss decreased (0.049463 --> 0.046187).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.4132137298583984
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0426761  Vali Loss: 0.0415408 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912096  Vali macro F1 0.9913480 
new best score!!!!
Validation loss decreased (0.046187 --> 0.041541).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.415506362915039
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0370404  Vali Loss: 0.0402520 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899306  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.041541 --> 0.040252).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.4130499362945557
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0344099  Vali Loss: 0.0374384 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899046  Vali macro F1 0.9901128 
new best score!!!!
Validation loss decreased (0.040252 --> 0.037438).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.417499542236328
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0341744  Vali Loss: 0.0365621 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913484  Vali macro F1 0.9914194 
new best score!!!!
Validation loss decreased (0.037438 --> 0.036562).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.41666316986084
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0390521  Vali Loss: 0.0281874 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9926232 
new best score!!!!
Validation loss decreased (0.036562 --> 0.028187).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.425701856613159
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0304441  Vali Loss: 0.0297460 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9926232 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.4701242446899414
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0309752  Vali Loss: 0.0336856 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912766  Vali macro F1 0.9914233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 3.45599365234375
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0273213  Vali Loss: 0.0249546 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9926232 
new best score!!!!
Validation loss decreased (0.028187 --> 0.024955).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.4594805240631104
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0270983  Vali Loss: 0.0245937 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937661  Vali macro F1 0.9938350 
new best score!!!!
Validation loss decreased (0.024955 --> 0.024594).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.432976245880127
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0260010  Vali Loss: 0.0257764 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937158  Vali macro F1 0.9937791 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.4225826263427734
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0228349  Vali Loss: 0.0193846 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974975  Vali macro F1 0.9976504 
new best score!!!!
Validation loss decreased (0.024594 --> 0.019385).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.4200727939605713
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0221235  Vali Loss: 0.0191177 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962725  Vali macro F1 0.9963442 
new best score!!!!
Validation loss decreased (0.019385 --> 0.019118).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.4255592823028564
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0203572  Vali Loss: 0.0227817 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.4210548400878906
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0193673  Vali Loss: 0.0223428 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924868  Vali macro F1 0.9926781 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.4205727577209473
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0194393  Vali Loss: 0.0262158 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925570  Vali macro F1 0.9926712 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 3.4209024906158447
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0197335  Vali Loss: 0.0230021 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9926232 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 3.426469326019287
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0176927  Vali Loss: 0.0219715 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937661  Vali macro F1 0.9938350 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 3.4411654472351074
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0149876  Vali Loss: 0.0214999 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9926232 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 3.4798202514648438
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0175290  Vali Loss: 0.0202916 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 3.4267475605010986
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0147216  Vali Loss: 0.0179046 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
new best score!!!!
Validation loss decreased (0.019118 --> 0.017905).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 3.426589250564575
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0135343  Vali Loss: 0.0178762 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
new best score!!!!
Validation loss decreased (0.017905 --> 0.017876).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.416820526123047
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0130457  Vali Loss: 0.0185210 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 3.4237470626831055
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0137474  Vali Loss: 0.0189314 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 3.425305128097534
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0138766  Vali Loss: 0.0193435 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 3.4240663051605225
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0151444  Vali Loss: 0.0195306 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 3.4206645488739014
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0139903  Vali Loss: 0.0211993 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 3.419516086578369
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0138254  Vali Loss: 0.0212021 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 3.422220230102539
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0140439  Vali Loss: 0.0211410 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 3.4326088428497314
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0135543  Vali Loss: 0.0210055 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 3.4781525135040283
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0150586  Vali Loss: 0.0210110 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 3.4536526203155518
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0127056  Vali Loss: 0.0211134 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 3.4226667881011963
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0136312  Vali Loss: 0.0211025 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 3.4216768741607666
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0134257  Vali Loss: 0.0210809 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 3.4196834564208984
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0135905  Vali Loss: 0.0210670 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 3.41992449760437
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0132293  Vali Loss: 0.0210614 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 3.4214096069335938
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0137506  Vali Loss: 0.0210351 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8938596  Test weighted F1: 0.8684412  Test macro F1 0.8684412 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.817897081375122
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0138606  Vali Loss: 0.0185336 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
Validation loss decreased (inf --> 0.018534).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.816576957702637
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0135174  Vali Loss: 0.0195638 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.811919927597046
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0133288  Vali Loss: 0.0168615 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
new best score!!!!
Validation loss decreased (0.018534 --> 0.016861).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.813822031021118
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0124470  Vali Loss: 0.0162935 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
new best score!!!!
Validation loss decreased (0.016861 --> 0.016294).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.8148579597473145
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0128758  Vali Loss: 0.0189417 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.814875602722168
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0122744  Vali Loss: 0.0184603 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 4.812831878662109
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0117374  Vali Loss: 0.0173543 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 4.810585260391235
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0107495  Vali Loss: 0.0168823 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 4.8139238357543945
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0110462  Vali Loss: 0.0172387 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 4.812158823013306
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0110592  Vali Loss: 0.0162341 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
new best score!!!!
Validation loss decreased (0.016294 --> 0.016234).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.809923410415649
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0111403  Vali Loss: 0.0153321 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
new best score!!!!
Validation loss decreased (0.016234 --> 0.015332).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.812736988067627
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0101953  Vali Loss: 0.0163671 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.812073230743408
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0104267  Vali Loss: 0.0152345 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
new best score!!!!
Validation loss decreased (0.015332 --> 0.015235).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.8131468296051025
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0117410  Vali Loss: 0.0154392 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.810871362686157
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0093140  Vali Loss: 0.0182043 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9926232 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 4.806792497634888
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0099854  Vali Loss: 0.0132355 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
new best score!!!!
Validation loss decreased (0.015235 --> 0.013236).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.805684566497803
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0104172  Vali Loss: 0.0153223 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.810898303985596
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0089655  Vali Loss: 0.0151503 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 4.811548471450806
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0088389  Vali Loss: 0.0140157 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 4.807430982589722
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0091968  Vali Loss: 0.0135478 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 4.811445474624634
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0096779  Vali Loss: 0.0113068 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
new best score!!!!
Validation loss decreased (0.013236 --> 0.011307).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 4.8121559619903564
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0090593  Vali Loss: 0.0143507 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 4.812206745147705
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0099752  Vali Loss: 0.0126451 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 4.810574293136597
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0085499  Vali Loss: 0.0108817 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962439  Vali macro F1 0.9964699 
new best score!!!!
Validation loss decreased (0.011307 --> 0.010882).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.809913873672485
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0080381  Vali Loss: 0.0116587 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.809115648269653
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0086739  Vali Loss: 0.0128609 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 4.80803656578064
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0083791  Vali Loss: 0.0126148 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962439  Vali macro F1 0.9964699 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 4.810940742492676
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0099021  Vali Loss: 0.0137083 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 4.812730312347412
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0081373  Vali Loss: 0.0134088 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937516  Vali macro F1 0.9938949 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 30 cost time: 4.812559604644775
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0075703  Vali Loss: 0.0131628 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 4.80887770652771
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0077185  Vali Loss: 0.0129724 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 4.811487913131714
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0081715  Vali Loss: 0.0130008 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 4.8095948696136475
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0082536  Vali Loss: 0.0129893 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 4.808200359344482
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0076662  Vali Loss: 0.0128565 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 35 cost time: 4.809247732162476
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0071652  Vali Loss: 0.0128665 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 4.8088297843933105
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0072944  Vali Loss: 0.0128753 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 4.8125598430633545
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0075378  Vali Loss: 0.0128970 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 4.808880090713501
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0084132  Vali Loss: 0.0129143 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 4.808696508407593
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0074403  Vali Loss: 0.0129110 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9951642 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8850877  Test weighted F1: 0.8596386  Test macro F1 0.8596386 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.517064332962036
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8538710  Vali Loss: 2.4451303 Vali Accuracy: 0.3258145  Vali weighted F1: 0.2515577  Vali macro F1 0.2607710 
Validation loss decreased (inf --> 2.445130).  Saving model ...
Epoch: 2 cost time: 3.4138028621673584
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7456585  Vali Loss: 1.1891159 Vali Accuracy: 0.8170426  Vali weighted F1: 0.8083782  Vali macro F1 0.8122718 
new best score!!!!
Validation loss decreased (2.445130 --> 1.189116).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.407727003097534
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.9810960  Vali Loss: 0.7156351 Vali Accuracy: 0.9210526  Vali weighted F1: 0.9178336  Vali macro F1 0.9182739 
new best score!!!!
Validation loss decreased (1.189116 --> 0.715635).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.4098784923553467
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6625589  Vali Loss: 0.4842253 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9525967  Vali macro F1 0.9515208 
new best score!!!!
Validation loss decreased (0.715635 --> 0.484225).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.4105074405670166
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4816446  Vali Loss: 0.3620327 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9694838  Vali macro F1 0.9690235 
new best score!!!!
Validation loss decreased (0.484225 --> 0.362033).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4072468280792236
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3630068  Vali Loss: 0.2808529 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9722350  Vali macro F1 0.9718980 
new best score!!!!
Validation loss decreased (0.362033 --> 0.280853).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4188950061798096
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2835794  Vali Loss: 0.2196361 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9759405  Vali macro F1 0.9756529 
new best score!!!!
Validation loss decreased (0.280853 --> 0.219636).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.411689519882202
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2271324  Vali Loss: 0.1727256 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872221  Vali macro F1 0.9873900 
new best score!!!!
Validation loss decreased (0.219636 --> 0.172726).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.460170030593872
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1864670  Vali Loss: 0.1476090 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811077  Vali macro F1 0.9810806 
new best score!!!!
Validation loss decreased (0.172726 --> 0.147609).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.4526126384735107
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1551357  Vali Loss: 0.1140998 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897529  Vali macro F1 0.9898469 
new best score!!!!
Validation loss decreased (0.147609 --> 0.114100).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.4165422916412354
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1273313  Vali Loss: 0.0992940 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911121  Vali macro F1 0.9911355 
new best score!!!!
Validation loss decreased (0.114100 --> 0.099294).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.408958911895752
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1057954  Vali Loss: 0.0810878 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923992  Vali macro F1 0.9923153 
new best score!!!!
Validation loss decreased (0.099294 --> 0.081088).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.403815746307373
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0906212  Vali Loss: 0.0674738 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949813  Vali macro F1 0.9949829 
new best score!!!!
Validation loss decreased (0.081088 --> 0.067474).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.413097858428955
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0792720  Vali Loss: 0.0552557 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.067474 --> 0.055256).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4091811180114746
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0717837  Vali Loss: 0.0535235 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949813  Vali macro F1 0.9949829 
new best score!!!!
Validation loss decreased (0.055256 --> 0.053523).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.414116382598877
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0759213  Vali Loss: 0.0601951 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911963  Vali macro F1 0.9916464 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 3.408935546875
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0582187  Vali Loss: 0.0447836 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949737  Vali macro F1 0.9951667 
new best score!!!!
Validation loss decreased (0.053523 --> 0.044784).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.4102463722229004
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0536643  Vali Loss: 0.0397302 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949706  Vali macro F1 0.9952731 
new best score!!!!
Validation loss decreased (0.044784 --> 0.039730).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.408339500427246
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0451146  Vali Loss: 0.0392246 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
new best score!!!!
Validation loss decreased (0.039730 --> 0.039225).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.4139504432678223
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0515854  Vali Loss: 0.0472369 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886445  Vali macro F1 0.9888599 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 3.4159862995147705
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0466589  Vali Loss: 0.0317365 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962378  Vali macro F1 0.9964661 
new best score!!!!
Validation loss decreased (0.039225 --> 0.031736).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.4712846279144287
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0543032  Vali Loss: 0.0351248 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937030  Vali macro F1 0.9936905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 3.4386777877807617
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0375368  Vali Loss: 0.0251068 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962443  Vali macro F1 0.9963962 
new best score!!!!
Validation loss decreased (0.031736 --> 0.025107).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.4177327156066895
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0326273  Vali Loss: 0.0220230 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.025107 --> 0.022023).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.4143714904785156
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0269785  Vali Loss: 0.0216040 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
new best score!!!!
Validation loss decreased (0.022023 --> 0.021604).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4132325649261475
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0290815  Vali Loss: 0.0220768 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962568  Vali macro F1 0.9963311 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.41890811920166
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0238414  Vali Loss: 0.0182195 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.021604 --> 0.018219).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.419325590133667
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0238253  Vali Loss: 0.0197160 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949508  Vali macro F1 0.9949150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.4106318950653076
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0278852  Vali Loss: 0.0237641 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949912  Vali macro F1 0.9953742 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 3.4135825634002686
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0232754  Vali Loss: 0.0173509 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950210  Vali macro F1 0.9951733 
new best score!!!!
Validation loss decreased (0.018219 --> 0.017351).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.4078779220581055
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0248338  Vali Loss: 0.0139751 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.017351 --> 0.013975).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.41487455368042
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0561021  Vali Loss: 0.0300471 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937156  Vali macro F1 0.9937531 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.4597601890563965
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0378119  Vali Loss: 0.0264362 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9975913 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 3.453826427459717
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0393808  Vali Loss: 0.0190127 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962246  Vali macro F1 0.9963716 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 3.4115138053894043
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0253155  Vali Loss: 0.0275034 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974971  Vali macro F1 0.9973944 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 3.416407585144043
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0200056  Vali Loss: 0.0158747 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 3.4094414710998535
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0182064  Vali Loss: 0.0136371 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.013975 --> 0.013637).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.4138247966766357
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0167387  Vali Loss: 0.0133348 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.013637 --> 0.013335).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.412217617034912
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0166228  Vali Loss: 0.0131572 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.013335 --> 0.013157).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.413818597793579
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0158731  Vali Loss: 0.0124327 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.013157 --> 0.012433).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.4188175201416016
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0153331  Vali Loss: 0.0122291 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.012433 --> 0.012229).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.415489673614502
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0159250  Vali Loss: 0.0125788 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.412292242050171
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0159379  Vali Loss: 0.0125736 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.4220032691955566
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0162430  Vali Loss: 0.0121609 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.012229 --> 0.012161).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.478710412979126
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0162521  Vali Loss: 0.0124595 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.4219770431518555
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0157080  Vali Loss: 0.0120436 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.012161 --> 0.012044).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.410726308822632
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0143563  Vali Loss: 0.0121142 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 3.4102213382720947
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0147380  Vali Loss: 0.0121141 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 3.417001485824585
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0153005  Vali Loss: 0.0124216 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 3.405904769897461
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0144905  Vali Loss: 0.0118588 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.012044 --> 0.011859).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 3.4237520694732666
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0141463  Vali Loss: 0.0113993 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.011859 --> 0.011399).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.451164722442627
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0139546  Vali Loss: 0.0117554 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 3.417346477508545
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0137576  Vali Loss: 0.0114393 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 3.4147956371307373
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0145053  Vali Loss: 0.0113016 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.011399 --> 0.011302).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 3.422825574874878
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0141322  Vali Loss: 0.0108840 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.011302 --> 0.010884).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 3.469223976135254
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0129084  Vali Loss: 0.0113277 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 3.4593000411987305
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0138511  Vali Loss: 0.0111007 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 3.418222427368164
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0135668  Vali Loss: 0.0112527 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 3.4247825145721436
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0131435  Vali Loss: 0.0115613 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 3.4137039184570312
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0135172  Vali Loss: 0.0104346 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.010884 --> 0.010435).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 3.4187896251678467
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0155806  Vali Loss: 0.0111552 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 3.413423538208008
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0182036  Vali Loss: 0.0111331 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 3.420039176940918
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0147906  Vali Loss: 0.0109459 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 3.416503667831421
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0127719  Vali Loss: 0.0116341 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 3.4208853244781494
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0120931  Vali Loss: 0.0114080 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 66 cost time: 3.425571918487549
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0130797  Vali Loss: 0.0114353 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 3.4299116134643555
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0130429  Vali Loss: 0.0113649 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 3.497513771057129
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0121805  Vali Loss: 0.0112724 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 3.429131269454956
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0136906  Vali Loss: 0.0112393 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 3.4248249530792236
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0129856  Vali Loss: 0.0112281 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 71 cost time: 3.418050765991211
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0130927  Vali Loss: 0.0112298 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 3.4196887016296387
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0126368  Vali Loss: 0.0112357 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 3.4245665073394775
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0127577  Vali Loss: 0.0112376 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 3.417304754257202
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0124059  Vali Loss: 0.0112335 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 3.417182683944702
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0132237  Vali Loss: 0.0112317 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9438596  Test weighted F1: 0.9430558  Test macro F1 0.9430558 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.808435916900635
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0124789  Vali Loss: 0.0119661 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
Validation loss decreased (inf --> 0.011966).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.805811405181885
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0118049  Vali Loss: 0.0088056 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.011966 --> 0.008806).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.8044915199279785
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0135737  Vali Loss: 0.0091004 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.805137395858765
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0136032  Vali Loss: 0.0097501 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 4.8020148277282715
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0112760  Vali Loss: 0.0090000 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 4.804951429367065
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0114718  Vali Loss: 0.0087014 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.008806 --> 0.008701).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.801377773284912
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0105053  Vali Loss: 0.0088838 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.80448055267334
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0107847  Vali Loss: 0.0076077 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008701 --> 0.007608).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.803712606430054
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0105860  Vali Loss: 0.0081385 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.8041534423828125
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0092080  Vali Loss: 0.0079174 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 4.80392050743103
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0093062  Vali Loss: 0.0080420 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 4.806301116943359
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0107634  Vali Loss: 0.0072036 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007608 --> 0.007204).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.8036253452301025
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0087284  Vali Loss: 0.0090062 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962443  Vali macro F1 0.9963962 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.807324171066284
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0085451  Vali Loss: 0.0074726 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.810182094573975
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0090843  Vali Loss: 0.0071306 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.007204 --> 0.007131).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.810056686401367
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0082856  Vali Loss: 0.0058975 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007131 --> 0.005898).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.80898642539978
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0085876  Vali Loss: 0.0058109 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005898 --> 0.005811).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.809624910354614
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0087086  Vali Loss: 0.0068428 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.809018135070801
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0084687  Vali Loss: 0.0054981 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005811 --> 0.005498).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.812511920928955
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0081063  Vali Loss: 0.0058157 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.812943935394287
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0084645  Vali Loss: 0.0068194 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975097  Vali macro F1 0.9975851 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.812062501907349
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0077262  Vali Loss: 0.0051173 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005498 --> 0.005117).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.813323736190796
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0078958  Vali Loss: 0.0056870 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 4.813400983810425
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0071119  Vali Loss: 0.0058012 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 4.81671142578125
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0070705  Vali Loss: 0.0065532 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 4.809295654296875
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0071276  Vali Loss: 0.0051857 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 4.811770915985107
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0072576  Vali Loss: 0.0037189 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005117 --> 0.003719).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 4.811491012573242
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0073911  Vali Loss: 0.0060526 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975097  Vali macro F1 0.9975851 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 4.815387487411499
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0078542  Vali Loss: 0.0043830 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 4.81093430519104
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0074727  Vali Loss: 0.0042727 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 4.810231447219849
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0068444  Vali Loss: 0.0043429 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 4.813825845718384
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0076492  Vali Loss: 0.0057169 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975097  Vali macro F1 0.9975851 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 33 cost time: 4.814547538757324
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0069395  Vali Loss: 0.0040958 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 4.817943572998047
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0066122  Vali Loss: 0.0084497 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975097  Vali macro F1 0.9975851 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 4.820592641830444
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0064768  Vali Loss: 0.0041076 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 4.817770481109619
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0055081  Vali Loss: 0.0034501 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003719 --> 0.003450).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 4.823175430297852
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0058216  Vali Loss: 0.0036850 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 4.8209068775177
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0067921  Vali Loss: 0.0040797 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 4.818326234817505
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0047992  Vali Loss: 0.0033449 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003450 --> 0.003345).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 40 cost time: 4.8159706592559814
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0060392  Vali Loss: 0.0033628 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 4.814977407455444
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0058055  Vali Loss: 0.0033783 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 4.816765785217285
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0058018  Vali Loss: 0.0037065 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 4.818841457366943
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0070317  Vali Loss: 0.0035227 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 4.815338850021362
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0059891  Vali Loss: 0.0041583 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 45 cost time: 4.817615032196045
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0049669  Vali Loss: 0.0041839 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 46 cost time: 4.818373441696167
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0053472  Vali Loss: 0.0040636 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 47 cost time: 4.8154566287994385
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0054637  Vali Loss: 0.0039468 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 48 cost time: 4.818092107772827
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0058305  Vali Loss: 0.0038489 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 49 cost time: 4.818547248840332
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0063000  Vali Loss: 0.0036368 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 50 cost time: 4.820736646652222
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0050514  Vali Loss: 0.0036378 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 51 cost time: 4.81443452835083
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0049658  Vali Loss: 0.0036312 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 52 cost time: 4.815718650817871
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0045708  Vali Loss: 0.0036196 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 53 cost time: 4.81453537940979
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0048688  Vali Loss: 0.0036063 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 54 cost time: 4.820245027542114
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0056069  Vali Loss: 0.0036050 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987470  Vali macro F1 0.9987467 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9350877  Test weighted F1: 0.9334018  Test macro F1 0.9334018 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.5051703453063965
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8566040  Vali Loss: 2.4486502 Vali Accuracy: 0.2957393  Vali weighted F1: 0.2291945  Vali macro F1 0.2359093 
Validation loss decreased (inf --> 2.448650).  Saving model ...
Epoch: 2 cost time: 3.4166171550750732
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7679095  Vali Loss: 1.1925144 Vali Accuracy: 0.8270677  Vali weighted F1: 0.8136655  Vali macro F1 0.8165115 
new best score!!!!
Validation loss decreased (2.448650 --> 1.192514).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.4127392768859863
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.9873677  Vali Loss: 0.7243519 Vali Accuracy: 0.9097744  Vali weighted F1: 0.9051408  Vali macro F1 0.9047507 
new best score!!!!
Validation loss decreased (1.192514 --> 0.724352).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.408808469772339
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6519402  Vali Loss: 0.4963460 Vali Accuracy: 0.9310777  Vali weighted F1: 0.9305223  Vali macro F1 0.9313193 
new best score!!!!
Validation loss decreased (0.724352 --> 0.496346).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.409996271133423
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4618603  Vali Loss: 0.3689179 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9622092  Vali macro F1 0.9618582 
new best score!!!!
Validation loss decreased (0.496346 --> 0.368918).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.409686326980591
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3484411  Vali Loss: 0.2918983 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9733526  Vali macro F1 0.9726551 
new best score!!!!
Validation loss decreased (0.368918 --> 0.291898).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4151382446289062
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2786455  Vali Loss: 0.2310208 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9708986  Vali macro F1 0.9706668 
new best score!!!!
Validation loss decreased (0.291898 --> 0.231021).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.425891160964966
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2278772  Vali Loss: 0.2037851 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9736632  Vali macro F1 0.9737751 
new best score!!!!
Validation loss decreased (0.231021 --> 0.203785).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.450543165206909
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1999325  Vali Loss: 0.1571914 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9824551  Vali macro F1 0.9825466 
new best score!!!!
Validation loss decreased (0.203785 --> 0.157191).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.4599740505218506
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1530780  Vali Loss: 0.1335444 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848771  Vali macro F1 0.9848812 
new best score!!!!
Validation loss decreased (0.157191 --> 0.133544).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.421097755432129
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1255963  Vali Loss: 0.1124964 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849649  Vali macro F1 0.9852695 
new best score!!!!
Validation loss decreased (0.133544 --> 0.112496).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.4151394367218018
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1061848  Vali Loss: 0.0950122 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873449  Vali macro F1 0.9871148 
new best score!!!!
Validation loss decreased (0.112496 --> 0.095012).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.418088674545288
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0933259  Vali Loss: 0.0809037 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886834  Vali macro F1 0.9886089 
new best score!!!!
Validation loss decreased (0.095012 --> 0.080904).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4146573543548584
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0781732  Vali Loss: 0.0724580 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887211  Vali macro F1 0.9886107 
new best score!!!!
Validation loss decreased (0.080904 --> 0.072458).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4123575687408447
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0704445  Vali Loss: 0.0630888 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899270  Vali macro F1 0.9898158 
new best score!!!!
Validation loss decreased (0.072458 --> 0.063089).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.455597400665283
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0603534  Vali Loss: 0.0542656 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924139  Vali macro F1 0.9922634 
new best score!!!!
Validation loss decreased (0.063089 --> 0.054266).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.437241554260254
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0560833  Vali Loss: 0.0570418 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875637  Vali macro F1 0.9873993 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 3.41985821723938
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0553892  Vali Loss: 0.0518289 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899718  Vali macro F1 0.9900475 
new best score!!!!
Validation loss decreased (0.054266 --> 0.051829).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.419027090072632
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0481625  Vali Loss: 0.0502939 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898567  Vali macro F1 0.9901261 
new best score!!!!
Validation loss decreased (0.051829 --> 0.050294).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.4185407161712646
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0473091  Vali Loss: 0.0413914 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912259  Vali macro F1 0.9911964 
new best score!!!!
Validation loss decreased (0.050294 --> 0.041391).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.4318253993988037
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0388580  Vali Loss: 0.0370383 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924487  Vali macro F1 0.9925004 
new best score!!!!
Validation loss decreased (0.041391 --> 0.037038).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.4770984649658203
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0346433  Vali Loss: 0.0344544 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924487  Vali macro F1 0.9925004 
new best score!!!!
Validation loss decreased (0.037038 --> 0.034454).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.4613311290740967
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0350941  Vali Loss: 0.0324397 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937142  Vali macro F1 0.9936454 
new best score!!!!
Validation loss decreased (0.034454 --> 0.032440).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.424611806869507
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0334043  Vali Loss: 0.0320322 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936878  Vali macro F1 0.9939531 
new best score!!!!
Validation loss decreased (0.032440 --> 0.032032).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.42639422416687
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0291091  Vali Loss: 0.0296116 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937142  Vali macro F1 0.9936454 
new best score!!!!
Validation loss decreased (0.032032 --> 0.029612).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4175026416778564
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0278447  Vali Loss: 0.0261248 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936878  Vali macro F1 0.9939531 
new best score!!!!
Validation loss decreased (0.029612 --> 0.026125).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.4221975803375244
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0253056  Vali Loss: 0.0262629 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.4217820167541504
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0253647  Vali Loss: 0.0251010 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
new best score!!!!
Validation loss decreased (0.026125 --> 0.025101).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.423750877380371
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0259508  Vali Loss: 0.0243290 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936878  Vali macro F1 0.9939531 
new best score!!!!
Validation loss decreased (0.025101 --> 0.024329).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.4241037368774414
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0229731  Vali Loss: 0.0236901 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
new best score!!!!
Validation loss decreased (0.024329 --> 0.023690).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.422187566757202
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0238845  Vali Loss: 0.0285021 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911569  Vali macro F1 0.9911270 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 3.425034523010254
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0284409  Vali Loss: 0.0242383 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 3.4380595684051514
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0232745  Vali Loss: 0.0194888 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937173  Vali macro F1 0.9938621 
new best score!!!!
Validation loss decreased (0.023690 --> 0.019489).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.4910757541656494
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0238452  Vali Loss: 0.0216871 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912050  Vali macro F1 0.9916368 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.4306044578552246
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0204799  Vali Loss: 0.0196055 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.4195847511291504
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0165693  Vali Loss: 0.0205781 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924258  Vali macro F1 0.9927706 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 3.4218215942382812
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0170924  Vali Loss: 0.0221649 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912509  Vali macro F1 0.9916404 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 3.418328285217285
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0163030  Vali Loss: 0.0215515 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924727  Vali macro F1 0.9925055 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 3.420719861984253
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0162145  Vali Loss: 0.0213161 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.4200491905212402
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0148574  Vali Loss: 0.0211971 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 3.422879457473755
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0169116  Vali Loss: 0.0211584 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 3.421632766723633
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0133067  Vali Loss: 0.0204471 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924834  Vali macro F1 0.9927062 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 3.4209489822387695
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0140148  Vali Loss: 0.0207142 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 3.431459665298462
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0130173  Vali Loss: 0.0207122 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 3.477957248687744
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0144997  Vali Loss: 0.0207812 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 3.4637084007263184
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0137407  Vali Loss: 0.0208127 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 3.4232537746429443
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0129348  Vali Loss: 0.0207986 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 3.4200499057769775
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0133795  Vali Loss: 0.0207790 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8096491  Test weighted F1: 0.7662395  Test macro F1 0.7662395 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.803789377212524
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0186363  Vali Loss: 0.0211411 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
Validation loss decreased (inf --> 0.021141).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.806045293807983
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0167651  Vali Loss: 0.0211551 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.809181451797485
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0164479  Vali Loss: 0.0216548 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.805843114852905
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0170485  Vali Loss: 0.0192881 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
new best score!!!!
Validation loss decreased (0.021141 --> 0.019288).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.8117029666900635
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0156660  Vali Loss: 0.0186218 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949533  Vali macro F1 0.9950981 
new best score!!!!
Validation loss decreased (0.019288 --> 0.018622).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.810702800750732
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0148478  Vali Loss: 0.0220143 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924876  Vali macro F1 0.9925667 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 4.815169334411621
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0148737  Vali Loss: 0.0199927 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 4.811188220977783
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0132855  Vali Loss: 0.0195749 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937645  Vali macro F1 0.9937013 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 4.812138319015503
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0135070  Vali Loss: 0.0191760 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 4.805652379989624
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0139775  Vali Loss: 0.0191898 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 4.806697130203247
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0129624  Vali Loss: 0.0188354 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.807544946670532
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0120347  Vali Loss: 0.0175264 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937645  Vali macro F1 0.9937013 
new best score!!!!
Validation loss decreased (0.018622 --> 0.017526).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.806512832641602
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0119263  Vali Loss: 0.0166116 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925563  Vali macro F1 0.9924938 
new best score!!!!
Validation loss decreased (0.017526 --> 0.016612).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.8047051429748535
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0129297  Vali Loss: 0.0178364 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937645  Vali macro F1 0.9937013 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.810912847518921
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0127490  Vali Loss: 0.0184681 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 4.805570125579834
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0116895  Vali Loss: 0.0171248 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924804  Vali macro F1 0.9924895 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 4.809876203536987
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0115956  Vali Loss: 0.0164363 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
new best score!!!!
Validation loss decreased (0.016612 --> 0.016436).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.805720567703247
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0113213  Vali Loss: 0.0165124 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.805749893188477
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0114693  Vali Loss: 0.0162786 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
new best score!!!!
Validation loss decreased (0.016436 --> 0.016279).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.807248830795288
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0105893  Vali Loss: 0.0156114 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
new best score!!!!
Validation loss decreased (0.016279 --> 0.015611).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 4.807473659515381
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0118436  Vali Loss: 0.0157064 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9951399 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.808994770050049
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0114601  Vali Loss: 0.0142967 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9951399 
new best score!!!!
Validation loss decreased (0.015611 --> 0.014297).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.809293508529663
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0102101  Vali Loss: 0.0147326 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9951399 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 4.810130596160889
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0099624  Vali Loss: 0.0149985 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 4.807644367218018
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0101956  Vali Loss: 0.0153334 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 4.80863094329834
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0107096  Vali Loss: 0.0148206 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9951399 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 4.806850910186768
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0104388  Vali Loss: 0.0136037 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
new best score!!!!
Validation loss decreased (0.014297 --> 0.013604).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 4.811183452606201
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0107310  Vali Loss: 0.0141994 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 4.805208921432495
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0097525  Vali Loss: 0.0149753 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 4.8089494705200195
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0102837  Vali Loss: 0.0161199 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 4.810296297073364
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0095551  Vali Loss: 0.0149876 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 4.806785821914673
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0103314  Vali Loss: 0.0155904 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 33 cost time: 4.811634302139282
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0088347  Vali Loss: 0.0152671 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 4.80709171295166
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0085456  Vali Loss: 0.0150138 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 4.802201271057129
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0095053  Vali Loss: 0.0149140 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 4.805740594863892
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0090113  Vali Loss: 0.0148419 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 4.8077921867370605
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0091915  Vali Loss: 0.0148056 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 38 cost time: 4.807439088821411
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0094765  Vali Loss: 0.0148149 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 4.80312705039978
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0083580  Vali Loss: 0.0148091 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 4.817342519760132
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0087512  Vali Loss: 0.0148137 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 4.808374643325806
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0089780  Vali Loss: 0.0148215 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 4.806891202926636
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0086151  Vali Loss: 0.0148357 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937048  Vali macro F1 0.9939272 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8166667  Test weighted F1: 0.7772664  Test macro F1 0.7772664 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4988832473754883
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8571311  Vali Loss: 2.4428839 Vali Accuracy: 0.3333333  Vali weighted F1: 0.2770990  Vali macro F1 0.2806737 
Validation loss decreased (inf --> 2.442884).  Saving model ...
Epoch: 2 cost time: 3.411447286605835
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7754716  Vali Loss: 1.2173296 Vali Accuracy: 0.8233083  Vali weighted F1: 0.8059770  Vali macro F1 0.8085066 
new best score!!!!
Validation loss decreased (2.442884 --> 1.217330).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.4115452766418457
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0103563  Vali Loss: 0.7278821 Vali Accuracy: 0.9010025  Vali weighted F1: 0.8960873  Vali macro F1 0.8941543 
new best score!!!!
Validation loss decreased (1.217330 --> 0.727882).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.412090539932251
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6845306  Vali Loss: 0.5406479 Vali Accuracy: 0.9335840  Vali weighted F1: 0.9336380  Vali macro F1 0.9325595 
new best score!!!!
Validation loss decreased (0.727882 --> 0.540648).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.41850209236145
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4949767  Vali Loss: 0.4069786 Vali Accuracy: 0.9473684  Vali weighted F1: 0.9473308  Vali macro F1 0.9466057 
new best score!!!!
Validation loss decreased (0.540648 --> 0.406979).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4192726612091064
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3896029  Vali Loss: 0.3162375 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9583215  Vali macro F1 0.9571152 
new best score!!!!
Validation loss decreased (0.406979 --> 0.316237).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4552817344665527
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3264747  Vali Loss: 0.2682062 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9610131  Vali macro F1 0.9604673 
new best score!!!!
Validation loss decreased (0.316237 --> 0.268206).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.4465291500091553
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2587290  Vali Loss: 0.2177857 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9659771  Vali macro F1 0.9654989 
new best score!!!!
Validation loss decreased (0.268206 --> 0.217786).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.4159395694732666
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2157793  Vali Loss: 0.1775635 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9775073  Vali macro F1 0.9771036 
new best score!!!!
Validation loss decreased (0.217786 --> 0.177563).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.4137651920318604
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1738128  Vali Loss: 0.1472948 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9813120  Vali macro F1 0.9808717 
new best score!!!!
Validation loss decreased (0.177563 --> 0.147295).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.4141411781311035
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1435170  Vali Loss: 0.1246763 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823590  Vali macro F1 0.9820472 
new best score!!!!
Validation loss decreased (0.147295 --> 0.124676).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.415361166000366
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1286658  Vali Loss: 0.1053247 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835804  Vali macro F1 0.9839728 
new best score!!!!
Validation loss decreased (0.124676 --> 0.105325).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4080007076263428
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1080794  Vali Loss: 0.0941215 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874307  Vali macro F1 0.9875608 
new best score!!!!
Validation loss decreased (0.105325 --> 0.094121).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4118497371673584
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0935847  Vali Loss: 0.0792546 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900034  Vali macro F1 0.9897956 
new best score!!!!
Validation loss decreased (0.094121 --> 0.079255).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4110803604125977
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0825756  Vali Loss: 0.0734455 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875083  Vali macro F1 0.9876897 
new best score!!!!
Validation loss decreased (0.079255 --> 0.073446).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.4174633026123047
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0776072  Vali Loss: 0.0632656 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887441  Vali macro F1 0.9885332 
new best score!!!!
Validation loss decreased (0.073446 --> 0.063266).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.417001962661743
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0655738  Vali Loss: 0.0609893 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899495  Vali macro F1 0.9900007 
new best score!!!!
Validation loss decreased (0.063266 --> 0.060989).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.4127705097198486
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0587748  Vali Loss: 0.0562995 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887520  Vali macro F1 0.9886125 
new best score!!!!
Validation loss decreased (0.060989 --> 0.056299).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.418452501296997
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0552608  Vali Loss: 0.0577272 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876023  Vali macro F1 0.9870085 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.4695234298706055
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0577039  Vali Loss: 0.0473060 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912275  Vali macro F1 0.9912328 
new best score!!!!
Validation loss decreased (0.056299 --> 0.047306).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.4589502811431885
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0726120  Vali Loss: 0.0475667 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924857  Vali macro F1 0.9927682 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.412947654724121
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0495436  Vali Loss: 0.0424727 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925101  Vali macro F1 0.9925766 
new best score!!!!
Validation loss decreased (0.047306 --> 0.042473).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.416807174682617
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0419911  Vali Loss: 0.0401569 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924811  Vali macro F1 0.9923691 
new best score!!!!
Validation loss decreased (0.042473 --> 0.040157).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.416710376739502
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0392728  Vali Loss: 0.0369370 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900463  Vali macro F1 0.9900172 
new best score!!!!
Validation loss decreased (0.040157 --> 0.036937).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.4166133403778076
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0371256  Vali Loss: 0.0355626 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912565  Vali macro F1 0.9914403 
new best score!!!!
Validation loss decreased (0.036937 --> 0.035563).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4156296253204346
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0378542  Vali Loss: 0.0304508 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925101  Vali macro F1 0.9925766 
new best score!!!!
Validation loss decreased (0.035563 --> 0.030451).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.4099481105804443
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0351600  Vali Loss: 0.0364533 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912766  Vali macro F1 0.9914233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.41416597366333
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0338499  Vali Loss: 0.0343047 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899819  Vali macro F1 0.9901452 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 3.417768955230713
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0301907  Vali Loss: 0.0305945 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 3.4202849864959717
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0278492  Vali Loss: 0.0290385 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912297  Vali macro F1 0.9915098 
new best score!!!!
Validation loss decreased (0.030451 --> 0.029038).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.4248228073120117
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0304194  Vali Loss: 0.0314904 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900043  Vali macro F1 0.9901194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 3.481015920639038
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0257038  Vali Loss: 0.0303920 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 3.42012095451355
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0292818  Vali Loss: 0.0244581 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912297  Vali macro F1 0.9915098 
new best score!!!!
Validation loss decreased (0.029038 --> 0.024458).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.4122066497802734
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0253873  Vali Loss: 0.0266525 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913034  Vali macro F1 0.9913706 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.412315607070923
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0200605  Vali Loss: 0.0270592 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.4113354682922363
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0207454  Vali Loss: 0.0296460 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912297  Vali macro F1 0.9915098 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 3.4453418254852295
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0207303  Vali Loss: 0.0237180 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
new best score!!!!
Validation loss decreased (0.024458 --> 0.023718).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.4453046321868896
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0188061  Vali Loss: 0.0250585 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887698  Vali macro F1 0.9891679 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 3.4188873767852783
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0186083  Vali Loss: 0.0215515 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937149  Vali macro F1 0.9939966 
new best score!!!!
Validation loss decreased (0.023718 --> 0.021551).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.42061448097229
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0163152  Vali Loss: 0.0196991 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924613  Vali macro F1 0.9928603 
new best score!!!!
Validation loss decreased (0.021551 --> 0.019699).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.426403284072876
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0243996  Vali Loss: 0.0299968 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888265  Vali macro F1 0.9889813 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.435481071472168
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0266822  Vali Loss: 0.0239097 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924879  Vali macro F1 0.9926725 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 3.477383613586426
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0528131  Vali Loss: 0.0400231 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861616  Vali macro F1 0.9863820 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 3.463533878326416
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0235287  Vali Loss: 0.0309887 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887004  Vali macro F1 0.9893850 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 3.42497181892395
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0194869  Vali Loss: 0.0238665 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925321  Vali macro F1 0.9929851 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 3.423046827316284
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0162534  Vali Loss: 0.0219119 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900231  Vali macro F1 0.9903904 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 3.4191534519195557
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0138947  Vali Loss: 0.0214856 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912297  Vali macro F1 0.9915098 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 3.416771173477173
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0153301  Vali Loss: 0.0209928 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924857  Vali macro F1 0.9927682 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 3.4258320331573486
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0151187  Vali Loss: 0.0208154 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924857  Vali macro F1 0.9927682 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 3.423322916030884
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0140036  Vali Loss: 0.0219707 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 3.419046640396118
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0138274  Vali Loss: 0.0216249 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 3.416013717651367
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0156496  Vali Loss: 0.0213356 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 3.4238548278808594
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0151516  Vali Loss: 0.0212660 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 3.453087568283081
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0151423  Vali Loss: 0.0212021 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 3.473676919937134
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0142665  Vali Loss: 0.0211699 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8333333  Test weighted F1: 0.7948464  Test macro F1 0.7948464 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.858375549316406
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0148836  Vali Loss: 0.0233631 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
Validation loss decreased (inf --> 0.023363).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.078654050827026
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0149581  Vali Loss: 0.0220867 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
new best score!!!!
Validation loss decreased (0.023363 --> 0.022087).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.8469626903533936
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0149557  Vali Loss: 0.0222614 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.851186275482178
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0141208  Vali Loss: 0.0225055 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 4.851261615753174
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0118678  Vali Loss: 0.0218886 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
new best score!!!!
Validation loss decreased (0.022087 --> 0.021889).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.849431991577148
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0117863  Vali Loss: 0.0214599 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
new best score!!!!
Validation loss decreased (0.021889 --> 0.021460).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.854221820831299
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0134271  Vali Loss: 0.0217493 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.8555073738098145
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0142904  Vali Loss: 0.0215109 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 4.854555130004883
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0122416  Vali Loss: 0.0219430 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 4.859680652618408
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0119529  Vali Loss: 0.0198841 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
new best score!!!!
Validation loss decreased (0.021460 --> 0.019884).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.851089000701904
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0126791  Vali Loss: 0.0209159 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.853200674057007
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0110301  Vali Loss: 0.0190697 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
new best score!!!!
Validation loss decreased (0.019884 --> 0.019070).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.856354713439941
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0113598  Vali Loss: 0.0208694 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.855177640914917
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0116072  Vali Loss: 0.0190840 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.855292558670044
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0114739  Vali Loss: 0.0193778 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.853213310241699
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0111101  Vali Loss: 0.0204522 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 4.857467889785767
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0111630  Vali Loss: 0.0175000 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937094  Vali macro F1 0.9940731 
new best score!!!!
Validation loss decreased (0.019070 --> 0.017500).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.855583429336548
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0109136  Vali Loss: 0.0189767 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.852975845336914
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0102806  Vali Loss: 0.0190951 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937329  Vali macro F1 0.9938805 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 4.851075172424316
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0097481  Vali Loss: 0.0197442 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 4.855957984924316
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0110099  Vali Loss: 0.0149103 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937094  Vali macro F1 0.9940731 
new best score!!!!
Validation loss decreased (0.017500 --> 0.014910).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 4.851168155670166
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0101613  Vali Loss: 0.0213488 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 4.850279331207275
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0108270  Vali Loss: 0.0194799 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 4.849939823150635
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0094936  Vali Loss: 0.0187551 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937149  Vali macro F1 0.9939966 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 4.852584600448608
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0104820  Vali Loss: 0.0172134 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 4.853698015213013
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0091729  Vali Loss: 0.0184626 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924831  Vali macro F1 0.9925392 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 27 cost time: 4.852553129196167
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0090246  Vali Loss: 0.0185740 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912027  Vali macro F1 0.9914724 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 4.850556373596191
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0094450  Vali Loss: 0.0180822 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937149  Vali macro F1 0.9939966 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 4.849683046340942
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0090096  Vali Loss: 0.0186759 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 4.8521728515625
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0089549  Vali Loss: 0.0174208 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 4.8539299964904785
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0085715  Vali Loss: 0.0176901 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 32 cost time: 4.846679449081421
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0084744  Vali Loss: 0.0178018 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 4.852825164794922
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0081531  Vali Loss: 0.0179246 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 4.852004766464233
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0078699  Vali Loss: 0.0180320 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 4.851836204528809
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0092876  Vali Loss: 0.0179526 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 4.851642608642578
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0085531  Vali Loss: 0.0179111 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924525  Vali macro F1 0.9928137 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8868421  Test weighted F1: 0.8627162  Test macro F1 0.8627162 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.501641273498535
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8545965  Vali Loss: 2.4627789 Vali Accuracy: 0.3120301  Vali weighted F1: 0.2369641  Vali macro F1 0.2475631 
Validation loss decreased (inf --> 2.462779).  Saving model ...
Epoch: 2 cost time: 3.589200496673584
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7807356  Vali Loss: 1.2328334 Vali Accuracy: 0.7957393  Vali weighted F1: 0.7790100  Vali macro F1 0.7856844 
new best score!!!!
Validation loss decreased (2.462779 --> 1.232833).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.6350674629211426
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0095755  Vali Loss: 0.7622334 Vali Accuracy: 0.8834586  Vali weighted F1: 0.8822997  Vali macro F1 0.8833240 
new best score!!!!
Validation loss decreased (1.232833 --> 0.762233).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.811450242996216
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6796168  Vali Loss: 0.5370092 Vali Accuracy: 0.9285714  Vali weighted F1: 0.9284247  Vali macro F1 0.9295924 
new best score!!!!
Validation loss decreased (0.762233 --> 0.537009).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.5204193592071533
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5023021  Vali Loss: 0.3867229 Vali Accuracy: 0.9461153  Vali weighted F1: 0.9456105  Vali macro F1 0.9462651 
new best score!!!!
Validation loss decreased (0.537009 --> 0.386723).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.5143752098083496
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3817242  Vali Loss: 0.2924686 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9578568  Vali macro F1 0.9566936 
new best score!!!!
Validation loss decreased (0.386723 --> 0.292469).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.5036256313323975
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2841863  Vali Loss: 0.2168081 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9820973  Vali macro F1 0.9816804 
new best score!!!!
Validation loss decreased (0.292469 --> 0.216808).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.426819086074829
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2186859  Vali Loss: 0.1713233 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885909  Vali macro F1 0.9884812 
new best score!!!!
Validation loss decreased (0.216808 --> 0.171323).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.487760066986084
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1822570  Vali Loss: 0.1446414 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899382  Vali macro F1 0.9900243 
new best score!!!!
Validation loss decreased (0.171323 --> 0.144641).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.488621950149536
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1935493  Vali Loss: 0.1324430 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847189  Vali macro F1 0.9847039 
new best score!!!!
Validation loss decreased (0.144641 --> 0.132443).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.4380288124084473
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1375967  Vali Loss: 0.1099653 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9883847  Vali macro F1 0.9883927 
new best score!!!!
Validation loss decreased (0.132443 --> 0.109965).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.467371940612793
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1097778  Vali Loss: 0.0921925 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9883052  Vali macro F1 0.9883243 
new best score!!!!
Validation loss decreased (0.109965 --> 0.092193).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.444197654724121
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0942551  Vali Loss: 0.0770057 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910555  Vali macro F1 0.9910951 
new best score!!!!
Validation loss decreased (0.092193 --> 0.077006).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4188485145568848
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0800408  Vali Loss: 0.0688371 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911950  Vali macro F1 0.9912893 
new best score!!!!
Validation loss decreased (0.077006 --> 0.068837).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.510754346847534
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0739380  Vali Loss: 0.0594595 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898265  Vali macro F1 0.9898796 
new best score!!!!
Validation loss decreased (0.068837 --> 0.059460).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.4167237281799316
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0671989  Vali Loss: 0.0566045 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910687  Vali macro F1 0.9911321 
new best score!!!!
Validation loss decreased (0.059460 --> 0.056604).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.422147035598755
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0618186  Vali Loss: 0.0511864 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923694  Vali macro F1 0.9923277 
new best score!!!!
Validation loss decreased (0.056604 --> 0.051186).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.5107452869415283
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0542347  Vali Loss: 0.0448338 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
new best score!!!!
Validation loss decreased (0.051186 --> 0.044834).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.417487144470215
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0481267  Vali Loss: 0.0574931 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897692  Vali macro F1 0.9896264 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.415485382080078
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0445856  Vali Loss: 0.0418879 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962015  Vali macro F1 0.9963437 
new best score!!!!
Validation loss decreased (0.044834 --> 0.041888).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.461350917816162
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0401760  Vali Loss: 0.0457065 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936621  Vali macro F1 0.9936237 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.4473464488983154
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0389364  Vali Loss: 0.0342779 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923209  Vali macro F1 0.9924531 
new best score!!!!
Validation loss decreased (0.041888 --> 0.034278).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.4124066829681396
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0359175  Vali Loss: 0.0313269 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923704  Vali macro F1 0.9925064 
new best score!!!!
Validation loss decreased (0.034278 --> 0.031327).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.4131932258605957
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0344825  Vali Loss: 0.0374186 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924503  Vali macro F1 0.9923225 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.4271554946899414
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0347028  Vali Loss: 0.0318245 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936787  Vali macro F1 0.9935673 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 3.4901437759399414
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0374171  Vali Loss: 0.0388173 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847149  Vali macro F1 0.9846348 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 3.4091744422912598
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0314891  Vali Loss: 0.0245951 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949286  Vali macro F1 0.9949952 
new best score!!!!
Validation loss decreased (0.031327 --> 0.024595).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.4119482040405273
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0263470  Vali Loss: 0.0260490 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936193  Vali macro F1 0.9937556 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.4100749492645264
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0250701  Vali Loss: 0.0206336 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
new best score!!!!
Validation loss decreased (0.024595 --> 0.020634).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.4230332374572754
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0264857  Vali Loss: 0.0284443 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949508  Vali macro F1 0.9949150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 3.508047103881836
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0244988  Vali Loss: 0.0208795 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910159  Vali macro F1 0.9911432 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 3.414980411529541
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0271470  Vali Loss: 0.0186601 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974875  Vali macro F1 0.9976316 
new best score!!!!
Validation loss decreased (0.020634 --> 0.018660).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.41391658782959
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0414873  Vali Loss: 0.0211941 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.423262357711792
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0275706  Vali Loss: 0.0188430 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 3.4186339378356934
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0240814  Vali Loss: 0.0174253 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
new best score!!!!
Validation loss decreased (0.018660 --> 0.017425).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.4180657863616943
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0191383  Vali Loss: 0.0151502 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.017425 --> 0.015150).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.5027425289154053
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0191975  Vali Loss: 0.0139445 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.015150 --> 0.013944).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.420869827270508
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0211044  Vali Loss: 0.0176265 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 3.410797119140625
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0218043  Vali Loss: 0.0194602 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923629  Vali macro F1 0.9924214 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 3.4120609760284424
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0266513  Vali Loss: 0.0177751 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 3.4159576892852783
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0190888  Vali Loss: 0.0124962 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
new best score!!!!
Validation loss decreased (0.013944 --> 0.012496).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.4099881649017334
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0170046  Vali Loss: 0.0128307 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.4187023639678955
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0167361  Vali Loss: 0.0114195 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.012496 --> 0.011419).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 5.478566884994507
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0162051  Vali Loss: 0.0114653 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9974923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 3.438232183456421
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0151956  Vali Loss: 0.0121217 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 3.3979475498199463
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0148191  Vali Loss: 0.0136213 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962281  Vali macro F1 0.9960490 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 3.3946800231933594
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0174388  Vali Loss: 0.0125436 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 3.3954169750213623
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0156382  Vali Loss: 0.0141354 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 3.392390251159668
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0127645  Vali Loss: 0.0139071 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 3.3962037563323975
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0134937  Vali Loss: 0.0137162 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 3.392383337020874
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0127684  Vali Loss: 0.0124700 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 3.4071497917175293
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0127931  Vali Loss: 0.0126771 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 3.397886276245117
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0122595  Vali Loss: 0.0121917 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 3.475862741470337
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0122849  Vali Loss: 0.0120108 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 3.4021687507629395
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0126461  Vali Loss: 0.0118890 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 3.3925909996032715
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0114716  Vali Loss: 0.0118215 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 3.3917717933654785
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0117329  Vali Loss: 0.0118359 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 3.375932216644287
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0118209  Vali Loss: 0.0119880 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9447368  Test weighted F1: 0.9432068  Test macro F1 0.9432068 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.78159761428833
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0154034  Vali Loss: 0.0106780 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
Validation loss decreased (inf --> 0.010678).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.778911113739014
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0151969  Vali Loss: 0.0101686 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.010678 --> 0.010169).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.779927968978882
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0141558  Vali Loss: 0.0104127 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.790008783340454
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0130850  Vali Loss: 0.0094862 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.010169 --> 0.009486).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.783629417419434
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0129349  Vali Loss: 0.0179315 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.7854626178741455
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0125431  Vali Loss: 0.0093773 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.009486 --> 0.009377).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.782266855239868
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0118451  Vali Loss: 0.0090926 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.009377 --> 0.009093).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.78357720375061
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0116745  Vali Loss: 0.0121782 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.783505201339722
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0116639  Vali Loss: 0.0098185 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974909  Vali macro F1 0.9974880 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 4.790249586105347
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0123380  Vali Loss: 0.0089273 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.009093 --> 0.008927).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.784843444824219
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0156562  Vali Loss: 0.0083159 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008927 --> 0.008316).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.789136171340942
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0118428  Vali Loss: 0.0100209 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974956  Vali macro F1 0.9973165 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.792248487472534
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0103027  Vali Loss: 0.0079745 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.008316 --> 0.007974).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.788869380950928
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0098876  Vali Loss: 0.0080441 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.795101642608643
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0106368  Vali Loss: 0.0077666 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007974 --> 0.007767).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.79338264465332
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0101286  Vali Loss: 0.0078781 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 4.79052209854126
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0108062  Vali Loss: 0.0075225 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007767 --> 0.007523).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.797221899032593
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0108983  Vali Loss: 0.0078038 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.791915416717529
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0106307  Vali Loss: 0.0074528 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007523 --> 0.007453).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.793626308441162
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0103101  Vali Loss: 0.0073275 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007453 --> 0.007328).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 4.794990301132202
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0100582  Vali Loss: 0.0073966 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.7927937507629395
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0090694  Vali Loss: 0.0075454 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 4.787715911865234
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0094438  Vali Loss: 0.0077524 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 4.794976711273193
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0088271  Vali Loss: 0.0072212 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007328 --> 0.007221).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.794322490692139
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0091835  Vali Loss: 0.0070768 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.007221 --> 0.007077).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 4.787668228149414
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0092941  Vali Loss: 0.0073395 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.792634725570679
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0093946  Vali Loss: 0.0070925 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.794186353683472
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0092331  Vali Loss: 0.0068465 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.007077 --> 0.006847).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 4.790626764297485
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0091757  Vali Loss: 0.0067925 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006847 --> 0.006792).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 4.790022850036621
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0087335  Vali Loss: 0.0072128 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 4.7924230098724365
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0083432  Vali Loss: 0.0071700 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 4.788861036300659
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0094980  Vali Loss: 0.0065577 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.006792 --> 0.006558).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 4.794762134552002
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0094977  Vali Loss: 0.0107848 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 4.789641857147217
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0086208  Vali Loss: 0.0081562 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 4.791991710662842
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0091170  Vali Loss: 0.0075109 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 4.788379430770874
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0090754  Vali Loss: 0.0090968 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 4.788678407669067
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0081412  Vali Loss: 0.0085893 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 38 cost time: 4.795922517776489
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0084709  Vali Loss: 0.0067511 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 4.79306435585022
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0090698  Vali Loss: 0.0062759 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.006558 --> 0.006276).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 40 cost time: 4.798793077468872
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0078220  Vali Loss: 0.0064693 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 4.797115802764893
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0076200  Vali Loss: 0.0071425 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962252  Vali macro F1 0.9961189 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 4.790197849273682
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0085516  Vali Loss: 0.0064757 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 4.796854496002197
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0080524  Vali Loss: 0.0064593 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 4.789008617401123
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0082778  Vali Loss: 0.0066312 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 45 cost time: 4.790993690490723
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0087216  Vali Loss: 0.0064880 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 46 cost time: 4.790308237075806
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0084943  Vali Loss: 0.0062591 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.006276 --> 0.006259).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 47 cost time: 4.7938268184661865
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0083134  Vali Loss: 0.0059092 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.006259 --> 0.005909).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 48 cost time: 4.789668560028076
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0080743  Vali Loss: 0.0058645 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.005909 --> 0.005864).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 49 cost time: 4.788928508758545
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0081642  Vali Loss: 0.0058298 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.005864 --> 0.005830).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 4.794378757476807
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0077055  Vali Loss: 0.0057846 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.005830 --> 0.005785).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 51 cost time: 4.792127847671509
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0078681  Vali Loss: 0.0057421 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005785 --> 0.005742).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 52 cost time: 4.793566703796387
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0085105  Vali Loss: 0.0057600 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 53 cost time: 4.7973952293396
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0076975  Vali Loss: 0.0057724 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 54 cost time: 4.793440103530884
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0074509  Vali Loss: 0.0057599 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 55 cost time: 4.788155794143677
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0077768  Vali Loss: 0.0057308 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.005742 --> 0.005731).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 56 cost time: 4.792486190795898
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0077317  Vali Loss: 0.0057080 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
new best score!!!!
Validation loss decreased (0.005731 --> 0.005708).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 57 cost time: 4.793485879898071
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0075363  Vali Loss: 0.0057188 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 58 cost time: 4.794131755828857
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0076099  Vali Loss: 0.0057286 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 59 cost time: 4.788841247558594
Fine Tuning VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0071338  Vali Loss: 0.0057266 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 60 cost time: 4.795056104660034
Fine Tuning VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0076849  Vali Loss: 0.0057101 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 61 cost time: 4.787946462631226
Fine Tuning VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0077378  Vali Loss: 0.0056517 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005708 --> 0.005652).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 62 cost time: 4.791383981704712
Fine Tuning VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0071045  Vali Loss: 0.0056403 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005652 --> 0.005640).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 63 cost time: 4.795604467391968
Fine Tuning VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0073215  Vali Loss: 0.0056235 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.005640 --> 0.005624).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 64 cost time: 4.792231559753418
Fine Tuning VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0068316  Vali Loss: 0.0056643 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 65 cost time: 4.790290832519531
Fine Tuning VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0082608  Vali Loss: 0.0056602 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 66 cost time: 4.801406621932983
Fine Tuning VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0125239  Vali Loss: 0.0056579 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 67 cost time: 4.790950059890747
Fine Tuning VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0072044  Vali Loss: 0.0056678 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 68 cost time: 4.792322158813477
Fine Tuning VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0072491  Vali Loss: 0.0056594 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 69 cost time: 4.7977752685546875
Fine Tuning VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0069580  Vali Loss: 0.0056584 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 70 cost time: 4.793564796447754
Fine Tuning VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0071117  Vali Loss: 0.0056564 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 71 cost time: 4.796220064163208
Fine Tuning VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0083208  Vali Loss: 0.0056568 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 72 cost time: 4.795012950897217
Fine Tuning VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0070849  Vali Loss: 0.0056561 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 73 cost time: 4.789680004119873
Fine Tuning VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0070944  Vali Loss: 0.0056587 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 74 cost time: 4.792589902877808
Fine Tuning VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0073567  Vali Loss: 0.0056589 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 75 cost time: 4.795231342315674
Fine Tuning VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0073848  Vali Loss: 0.0056590 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 76 cost time: 4.79136061668396
Fine Tuning VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0076409  Vali Loss: 0.0056603 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 77 cost time: 4.798488140106201
Fine Tuning VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0072782  Vali Loss: 0.0056604 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 78 cost time: 4.789937257766724
Fine Tuning VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0076987  Vali Loss: 0.0056601 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974759  Vali macro F1 0.9975476 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9421053  Test weighted F1: 0.9400279  Test macro F1 0.9400279 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.5264012813568115
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8549627  Vali Loss: 2.4426700 Vali Accuracy: 0.3057644  Vali weighted F1: 0.2333852  Vali macro F1 0.2371477 
Validation loss decreased (inf --> 2.442670).  Saving model ...
Epoch: 2 cost time: 3.41496205329895
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7629429  Vali Loss: 1.1987538 Vali Accuracy: 0.8258145  Vali weighted F1: 0.8119840  Vali macro F1 0.8155884 
new best score!!!!
Validation loss decreased (2.442670 --> 1.198754).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3975143432617188
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0125833  Vali Loss: 0.7466180 Vali Accuracy: 0.8947368  Vali weighted F1: 0.8905408  Vali macro F1 0.8904553 
new best score!!!!
Validation loss decreased (1.198754 --> 0.746618).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.4926204681396484
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6868901  Vali Loss: 0.5253122 Vali Accuracy: 0.9335840  Vali weighted F1: 0.9333880  Vali macro F1 0.9322019 
new best score!!!!
Validation loss decreased (0.746618 --> 0.525312).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.383505344390869
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4847837  Vali Loss: 0.3932725 Vali Accuracy: 0.9436090  Vali weighted F1: 0.9431586  Vali macro F1 0.9419211 
new best score!!!!
Validation loss decreased (0.525312 --> 0.393273).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3879430294036865
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3817275  Vali Loss: 0.3084598 Vali Accuracy: 0.9473684  Vali weighted F1: 0.9472374  Vali macro F1 0.9458942 
new best score!!!!
Validation loss decreased (0.393273 --> 0.308460).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.383415460586548
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3183199  Vali Loss: 0.2583326 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9631117  Vali macro F1 0.9623721 
new best score!!!!
Validation loss decreased (0.308460 --> 0.258333).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3872668743133545
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2482800  Vali Loss: 0.2091289 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9658122  Vali macro F1 0.9651910 
new best score!!!!
Validation loss decreased (0.258333 --> 0.209129).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3909969329833984
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2022964  Vali Loss: 0.1611024 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9787238  Vali macro F1 0.9782684 
new best score!!!!
Validation loss decreased (0.209129 --> 0.161102).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.389925003051758
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1611864  Vali Loss: 0.1403768 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9787163  Vali macro F1 0.9780990 
new best score!!!!
Validation loss decreased (0.161102 --> 0.140377).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.386089324951172
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1365707  Vali Loss: 0.1152264 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862146  Vali macro F1 0.9858836 
new best score!!!!
Validation loss decreased (0.140377 --> 0.115226).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.389115333557129
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1192532  Vali Loss: 0.1085943 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873866  Vali macro F1 0.9876017 
new best score!!!!
Validation loss decreased (0.115226 --> 0.108594).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3906688690185547
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1001079  Vali Loss: 0.0934692 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899413  Vali macro F1 0.9899486 
new best score!!!!
Validation loss decreased (0.108594 --> 0.093469).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.404297351837158
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0887843  Vali Loss: 0.0962464 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875370  Vali macro F1 0.9875506 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 3.3804404735565186
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0784360  Vali Loss: 0.0699368 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924811  Vali macro F1 0.9923691 
new best score!!!!
Validation loss decreased (0.093469 --> 0.069937).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3853650093078613
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0738166  Vali Loss: 0.0675275 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912592  Vali macro F1 0.9911477 
new best score!!!!
Validation loss decreased (0.069937 --> 0.067527).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.444911003112793
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0793938  Vali Loss: 0.0667335 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887677  Vali macro F1 0.9887333 
new best score!!!!
Validation loss decreased (0.067527 --> 0.066733).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.427966594696045
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0649988  Vali Loss: 0.0589772 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912207  Vali macro F1 0.9911055 
new best score!!!!
Validation loss decreased (0.066733 --> 0.058977).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3851256370544434
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0539908  Vali Loss: 0.0547528 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899116  Vali macro F1 0.9899964 
new best score!!!!
Validation loss decreased (0.058977 --> 0.054753).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.387787103652954
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0516656  Vali Loss: 0.0487326 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912207  Vali macro F1 0.9911055 
new best score!!!!
Validation loss decreased (0.054753 --> 0.048733).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3845818042755127
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0464721  Vali Loss: 0.0458732 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912006  Vali macro F1 0.9913023 
new best score!!!!
Validation loss decreased (0.048733 --> 0.045873).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.3803117275238037
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0391083  Vali Loss: 0.0404404 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899400  Vali macro F1 0.9900323 
new best score!!!!
Validation loss decreased (0.045873 --> 0.040440).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3862078189849854
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0355043  Vali Loss: 0.0363700 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925111  Vali macro F1 0.9926591 
new best score!!!!
Validation loss decreased (0.040440 --> 0.036370).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.38582706451416
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0361571  Vali Loss: 0.0346941 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911778  Vali macro F1 0.9912666 
new best score!!!!
Validation loss decreased (0.036370 --> 0.034694).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.38496994972229
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0339475  Vali Loss: 0.0320309 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.034694 --> 0.032031).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.3865549564361572
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0359873  Vali Loss: 0.0325292 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.3804540634155273
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0330897  Vali Loss: 0.0635139 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9775988  Vali macro F1 0.9780389 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 3.3840231895446777
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0351783  Vali Loss: 0.0388719 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888848  Vali macro F1 0.9888234 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 3.39861798286438
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0295522  Vali Loss: 0.0325198 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899024  Vali macro F1 0.9900727 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 3.4170734882354736
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0271539  Vali Loss: 0.0262980 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937443  Vali macro F1 0.9937980 
new best score!!!!
Validation loss decreased (0.032031 --> 0.026298).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.427340507507324
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0263194  Vali Loss: 0.0229540 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.026298 --> 0.022954).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.3896968364715576
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0219155  Vali Loss: 0.0253718 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.384474515914917
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0230792  Vali Loss: 0.0234144 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 3.37920880317688
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0217898  Vali Loss: 0.0215870 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.022954 --> 0.021587).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.3839285373687744
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0210387  Vali Loss: 0.0258805 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924830  Vali macro F1 0.9924526 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.3828046321868896
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0181306  Vali Loss: 0.0215367 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.021587 --> 0.021537).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.382511854171753
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0172580  Vali Loss: 0.0225552 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 3.384617328643799
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0158078  Vali Loss: 0.0376132 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887799  Vali macro F1 0.9887590 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 3.3846840858459473
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0205408  Vali Loss: 0.0221369 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912294  Vali macro F1 0.9913163 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 3.383685827255249
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0199004  Vali Loss: 0.0246945 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 3.390381336212158
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0221228  Vali Loss: 0.0225101 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924572  Vali macro F1 0.9924235 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 3.3952534198760986
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0162373  Vali Loss: 0.0213302 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.021537 --> 0.021330).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 3.3810434341430664
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0155038  Vali Loss: 0.0208378 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.021330 --> 0.020838).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.443690299987793
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0137082  Vali Loss: 0.0208179 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.020838 --> 0.020818).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.391728162765503
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0155647  Vali Loss: 0.0204946 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
new best score!!!!
Validation loss decreased (0.020818 --> 0.020495).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 3.3790643215179443
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0141311  Vali Loss: 0.0202777 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924820  Vali macro F1 0.9924516 
new best score!!!!
Validation loss decreased (0.020495 --> 0.020278).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.381950616836548
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0142390  Vali Loss: 0.0203684 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 3.3770978450775146
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0152309  Vali Loss: 0.0206666 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 3.3787975311279297
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0140000  Vali Loss: 0.0205756 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 3.381462574005127
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0134854  Vali Loss: 0.0193541 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.020278 --> 0.019354).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 3.3753061294555664
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0136775  Vali Loss: 0.0199807 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 3.380427122116089
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0144370  Vali Loss: 0.0204389 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 3.379851818084717
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0138918  Vali Loss: 0.0203760 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 3.3784103393554688
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0132683  Vali Loss: 0.0208039 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 3.3813886642456055
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0129240  Vali Loss: 0.0205469 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 3.3858978748321533
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0142192  Vali Loss: 0.0205017 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 3.42972993850708
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0129995  Vali Loss: 0.0204931 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 3.422376871109009
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0134715  Vali Loss: 0.0203511 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 3.3791072368621826
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0128190  Vali Loss: 0.0202722 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 3.3803865909576416
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0139447  Vali Loss: 0.0202392 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 3.375203847885132
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0131353  Vali Loss: 0.0202321 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 3.3820912837982178
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0129679  Vali Loss: 0.0202329 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 3.372551441192627
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0129232  Vali Loss: 0.0202321 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 3.381070852279663
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0133732  Vali Loss: 0.0202250 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 3.380963087081909
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0131094  Vali Loss: 0.0202195 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9070175  Test weighted F1: 0.8930998  Test macro F1 0.8930998 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.769040107727051
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0138098  Vali Loss: 0.0186349 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949826  Vali macro F1 0.9948749 
Validation loss decreased (inf --> 0.018635).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.7668235301971436
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0137717  Vali Loss: 0.0200554 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.768748044967651
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0132195  Vali Loss: 0.0196046 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.766830682754517
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0129701  Vali Loss: 0.0193346 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 4.761281490325928
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0123913  Vali Loss: 0.0173304 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
new best score!!!!
Validation loss decreased (0.018635 --> 0.017330).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.763409852981567
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0133002  Vali Loss: 0.0188231 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 4.748393774032593
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0116978  Vali Loss: 0.0192334 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 4.747555732727051
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0107691  Vali Loss: 0.0169584 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
new best score!!!!
Validation loss decreased (0.017330 --> 0.016958).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.748762845993042
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0116167  Vali Loss: 0.0192228 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.749920845031738
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0104772  Vali Loss: 0.0159554 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937131  Vali macro F1 0.9937647 
new best score!!!!
Validation loss decreased (0.016958 --> 0.015955).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.7492876052856445
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0107541  Vali Loss: 0.0171083 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924549  Vali macro F1 0.9926132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.754240274429321
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0109716  Vali Loss: 0.0174287 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 4.753245830535889
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0107311  Vali Loss: 0.0150957 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949676  Vali macro F1 0.9950209 
new best score!!!!
Validation loss decreased (0.015955 --> 0.015096).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.74973464012146
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0090533  Vali Loss: 0.0181842 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.748492956161499
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0089539  Vali Loss: 0.0161862 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949676  Vali macro F1 0.9950209 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 4.747183799743652
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0098571  Vali Loss: 0.0180054 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 4.748030185699463
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0093205  Vali Loss: 0.0162869 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 4.748633146286011
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0098363  Vali Loss: 0.0185971 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912343  Vali macro F1 0.9912838 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 4.748058795928955
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0089215  Vali Loss: 0.0147863 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949676  Vali macro F1 0.9950209 
new best score!!!!
Validation loss decreased (0.015096 --> 0.014786).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.746314287185669
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0091936  Vali Loss: 0.0160842 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.74747371673584
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0082199  Vali Loss: 0.0165677 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937186  Vali macro F1 0.9936881 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.753336429595947
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0085718  Vali Loss: 0.0149590 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949826  Vali macro F1 0.9948749 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 4.75716757774353
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0082053  Vali Loss: 0.0137685 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949871  Vali macro F1 0.9949992 
new best score!!!!
Validation loss decreased (0.014786 --> 0.013769).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 4.765289068222046
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0104739  Vali Loss: 0.0138392 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924880  Vali macro F1 0.9928353 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 4.764385223388672
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0094477  Vali Loss: 0.0156701 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 4.7631566524505615
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0086595  Vali Loss: 0.0163738 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 4.763643503189087
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0100385  Vali Loss: 0.0147305 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 4.764797687530518
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0081265  Vali Loss: 0.0165186 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 29 cost time: 4.764575004577637
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0076700  Vali Loss: 0.0164626 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 4.761318683624268
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0075019  Vali Loss: 0.0163805 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 4.774483680725098
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0078961  Vali Loss: 0.0163008 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 4.759451150894165
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0076158  Vali Loss: 0.0164223 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 4.768083333969116
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0076656  Vali Loss: 0.0161607 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 34 cost time: 4.765320301055908
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0076275  Vali Loss: 0.0161380 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 4.761301040649414
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0080359  Vali Loss: 0.0161093 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 4.7664971351623535
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0075761  Vali Loss: 0.0160953 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 4.761661529541016
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0075890  Vali Loss: 0.0160783 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 4.763507604598999
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0082634  Vali Loss: 0.0160579 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924562  Vali macro F1 0.9925053 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8973684  Test weighted F1: 0.8833922  Test macro F1 0.8833922 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00263852 0.0026178  0.0025974  0.00266667 0.00261097 0.00257732
 0.00265252 0.00263852 0.00265252 0.00261097 0.00271003 0.00260417
 0.00265957 0.00271739 0.00265957 0.00263158 0.00263158 0.0027027
 0.00269542]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4735755920410156
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8613949  Vali Loss: 2.4769627 Vali Accuracy: 0.3095238  Vali weighted F1: 0.2362174  Vali macro F1 0.2446228 
Validation loss decreased (inf --> 2.476963).  Saving model ...
Epoch: 2 cost time: 3.405498743057251
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7876071  Vali Loss: 1.1985679 Vali Accuracy: 0.8471178  Vali weighted F1: 0.8387715  Vali macro F1 0.8430579 
new best score!!!!
Validation loss decreased (2.476963 --> 1.198568).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.387233257293701
VALI: Epoch: 3, Steps: 29 | Train Loss: 0.9900501  Vali Loss: 0.7322901 Vali Accuracy: 0.9160401  Vali weighted F1: 0.9129421  Vali macro F1 0.9134243 
new best score!!!!
Validation loss decreased (1.198568 --> 0.732290).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3994927406311035
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6634663  Vali Loss: 0.4892003 Vali Accuracy: 0.9385965  Vali weighted F1: 0.9385037  Vali macro F1 0.9391144 
new best score!!!!
Validation loss decreased (0.732290 --> 0.489200).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.4393293857574463
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4689117  Vali Loss: 0.3645906 Vali Accuracy: 0.9548872  Vali weighted F1: 0.9541997  Vali macro F1 0.9544463 
new best score!!!!
Validation loss decreased (0.489200 --> 0.364591).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.396003484725952
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3544167  Vali Loss: 0.2740174 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9707547  Vali macro F1 0.9709428 
new best score!!!!
Validation loss decreased (0.364591 --> 0.274017).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.4020462036132812
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2778247  Vali Loss: 0.2293393 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9730321  Vali macro F1 0.9729829 
new best score!!!!
Validation loss decreased (0.274017 --> 0.229339).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.391817808151245
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2271518  Vali Loss: 0.1683589 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911980  Vali macro F1 0.9916056 
new best score!!!!
Validation loss decreased (0.229339 --> 0.168359).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3918263912200928
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1824208  Vali Loss: 0.1386432 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898547  Vali macro F1 0.9902149 
new best score!!!!
Validation loss decreased (0.168359 --> 0.138643).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.3895416259765625
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1492742  Vali Loss: 0.1169819 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911523  Vali macro F1 0.9914942 
new best score!!!!
Validation loss decreased (0.138643 --> 0.116982).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.397965908050537
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1213278  Vali Loss: 0.1000909 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923708  Vali macro F1 0.9925824 
new best score!!!!
Validation loss decreased (0.116982 --> 0.100091).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3990964889526367
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1027343  Vali Loss: 0.0824157 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936787  Vali macro F1 0.9938207 
new best score!!!!
Validation loss decreased (0.100091 --> 0.082416).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3904478549957275
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0925671  Vali Loss: 0.0751830 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937469  Vali macro F1 0.9938976 
new best score!!!!
Validation loss decreased (0.082416 --> 0.075183).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3903446197509766
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0852141  Vali Loss: 0.0653516 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937375  Vali macro F1 0.9940275 
new best score!!!!
Validation loss decreased (0.075183 --> 0.065352).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3919999599456787
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0697296  Vali Loss: 0.0551606 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974975  Vali macro F1 0.9976504 
new best score!!!!
Validation loss decreased (0.065352 --> 0.055161).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3956899642944336
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0602719  Vali Loss: 0.0566969 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911820  Vali macro F1 0.9912402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 3.3942277431488037
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0547919  Vali Loss: 0.0568695 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899029  Vali macro F1 0.9899557 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 3.4000027179718018
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0511984  Vali Loss: 0.0383208 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
new best score!!!!
Validation loss decreased (0.055161 --> 0.038321).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.4307479858398438
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0438881  Vali Loss: 0.0355984 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949817  Vali macro F1 0.9950517 
new best score!!!!
Validation loss decreased (0.038321 --> 0.035598).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.438523292541504
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0403471  Vali Loss: 0.0326332 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
new best score!!!!
Validation loss decreased (0.035598 --> 0.032633).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3920302391052246
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0382349  Vali Loss: 0.0330580 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9975913 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.391746759414673
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0373450  Vali Loss: 0.0398479 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924541  Vali macro F1 0.9925170 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 3.3931827545166016
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0313631  Vali Loss: 0.0253102 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.032633 --> 0.025310).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3934130668640137
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0287581  Vali Loss: 0.0272578 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.3910207748413086
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0271525  Vali Loss: 0.0217555 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987463  Vali macro F1 0.9987453 
new best score!!!!
Validation loss decreased (0.025310 --> 0.021756).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.393651008605957
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0250425  Vali Loss: 0.0203450 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.021756 --> 0.020345).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3934547901153564
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0221214  Vali Loss: 0.0178918 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.020345 --> 0.017892).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.3916938304901123
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0224129  Vali Loss: 0.0170273 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.017892 --> 0.017027).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.3937480449676514
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0254595  Vali Loss: 0.0315557 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911820  Vali macro F1 0.9912402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.3975508213043213
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0234537  Vali Loss: 0.0177617 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 3.402404546737671
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0229966  Vali Loss: 0.0177000 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 3.396911144256592
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0224829  Vali Loss: 0.0182462 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962040  Vali macro F1 0.9962735 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 3.46781325340271
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0291011  Vali Loss: 0.0141925 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.017027 --> 0.014192).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.40400767326355
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0297191  Vali Loss: 0.0183123 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962267  Vali macro F1 0.9961218 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.3972620964050293
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0544289  Vali Loss: 0.0287690 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962246  Vali macro F1 0.9963716 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.3861443996429443
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0230241  Vali Loss: 0.0150632 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 3.3967742919921875
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0171679  Vali Loss: 0.0148809 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 3.3958704471588135
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0143239  Vali Loss: 0.0125351 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.014192 --> 0.012535).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.3944029808044434
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0163377  Vali Loss: 0.0157251 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.393108367919922
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0136988  Vali Loss: 0.0106004 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.012535 --> 0.010600).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.39298415184021
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0119461  Vali Loss: 0.0101387 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010600 --> 0.010139).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.394388198852539
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0147330  Vali Loss: 0.0137354 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.4003829956054688
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0125159  Vali Loss: 0.0102939 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.4102799892425537
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0110774  Vali Loss: 0.0118971 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 3.3970630168914795
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0108821  Vali Loss: 0.0114486 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 3.4472744464874268
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0095836  Vali Loss: 0.0100079 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.010139 --> 0.010008).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.436697006225586
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0102622  Vali Loss: 0.0082990 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010008 --> 0.008299).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.394437313079834
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0089535  Vali Loss: 0.0084018 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.3933284282684326
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0090352  Vali Loss: 0.0099909 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.39363956451416
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0098346  Vali Loss: 0.0104027 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.375483274459839
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0071615  Vali Loss: 0.0074235 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.008299 --> 0.007423).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.3807036876678467
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0072441  Vali Loss: 0.0094611 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 3.374194383621216
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0079675  Vali Loss: 0.0139369 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9963119 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 3.377833366394043
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0085073  Vali Loss: 0.0073356 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.007423 --> 0.007336).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 3.3737993240356445
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0098343  Vali Loss: 0.0093829 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 3.382363796234131
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0058320  Vali Loss: 0.0087463 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 3.3801565170288086
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0067575  Vali Loss: 0.0082823 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 3.3892760276794434
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0091519  Vali Loss: 0.0061576 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.007336 --> 0.006158).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 3.390120267868042
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0094680  Vali Loss: 0.0075719 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 3.4340872764587402
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0065904  Vali Loss: 0.0092292 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 3.3845551013946533
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0080391  Vali Loss: 0.0109028 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 3.382148265838623
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0296821  Vali Loss: 0.0133877 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974945  Vali macro F1 0.9975687 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 3.3748886585235596
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0104603  Vali Loss: 0.0110815 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 64 cost time: 3.3781092166900635
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0066043  Vali Loss: 0.0102244 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 3.3741343021392822
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0056039  Vali Loss: 0.0096616 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 3.377995491027832
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0071571  Vali Loss: 0.0095866 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 3.3767879009246826
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0062257  Vali Loss: 0.0096754 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 3.377429723739624
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0062425  Vali Loss: 0.0094609 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 69 cost time: 3.3733465671539307
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0061154  Vali Loss: 0.0094342 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 3.377756118774414
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0066310  Vali Loss: 0.0094164 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 3.3748812675476074
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0090442  Vali Loss: 0.0094267 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 3.388523578643799
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0059542  Vali Loss: 0.0094396 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 3.4246950149536133
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0058920  Vali Loss: 0.0094214 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8385965  Test weighted F1: 0.8180069  Test macro F1 0.8180069 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.858619213104248
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0054844  Vali Loss: 0.0081487 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
Validation loss decreased (inf --> 0.008149).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.780073404312134
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0047942  Vali Loss: 0.0075499 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.008149 --> 0.007550).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.775331974029541
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0046003  Vali Loss: 0.0069233 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.007550 --> 0.006923).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.77552604675293
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0045892  Vali Loss: 0.0068841 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.006923 --> 0.006884).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.780287027359009
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0042103  Vali Loss: 0.0074978 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.778562307357788
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0043172  Vali Loss: 0.0063510 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.006884 --> 0.006351).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.775522470474243
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0036130  Vali Loss: 0.0070290 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.774825811386108
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0035311  Vali Loss: 0.0075397 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 4.777555227279663
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0038165  Vali Loss: 0.0076612 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9976422 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 4.77466607093811
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0039685  Vali Loss: 0.0060880 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
new best score!!!!
Validation loss decreased (0.006351 --> 0.006088).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.7755773067474365
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0039034  Vali Loss: 0.0045374 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987455  Vali macro F1 0.9988186 
new best score!!!!
Validation loss decreased (0.006088 --> 0.004537).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.780797481536865
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0031881  Vali Loss: 0.0066238 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.774044513702393
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0037674  Vali Loss: 0.0039436 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004537 --> 0.003944).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.776434898376465
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0033322  Vali Loss: 0.0048074 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.773939847946167
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0029305  Vali Loss: 0.0064964 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 4.780633926391602
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0026607  Vali Loss: 0.0068481 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 4.772593021392822
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0029684  Vali Loss: 0.0060102 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 4.771420240402222
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0042356  Vali Loss: 0.0070940 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 4.772737741470337
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0030755  Vali Loss: 0.0054359 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 4.775657892227173
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0026006  Vali Loss: 0.0075675 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 4.772196054458618
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0025309  Vali Loss: 0.0075149 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 4.7785868644714355
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0027582  Vali Loss: 0.0068375 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 4.773432970046997
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0029990  Vali Loss: 0.0067710 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 4.774793386459351
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0023257  Vali Loss: 0.0066918 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 4.777448654174805
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0023806  Vali Loss: 0.0066470 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 4.7751686573028564
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0027389  Vali Loss: 0.0066225 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 4.777263641357422
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0026150  Vali Loss: 0.0065946 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 4.77679705619812
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0026488  Vali Loss: 0.0066479 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9988233 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8429825  Test weighted F1: 0.8225331  Test macro F1 0.8225331 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 104364
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.48542857170105
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8718640  Vali Loss: 2.4564814 Vali Accuracy: 0.4160401  Vali weighted F1: 0.3781888  Vali macro F1 0.3859241 
Validation loss decreased (inf --> 2.456481).  Saving model ...
Epoch: 2 cost time: 3.3888251781463623
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8069762  Vali Loss: 1.2698611 Vali Accuracy: 0.8433584  Vali weighted F1: 0.8347046  Vali macro F1 0.8333578 
new best score!!!!
Validation loss decreased (2.456481 --> 1.269861).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.391533374786377
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0490289  Vali Loss: 0.8217678 Vali Accuracy: 0.8972431  Vali weighted F1: 0.8959833  Vali macro F1 0.8961093 
new best score!!!!
Validation loss decreased (1.269861 --> 0.821768).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3858323097229004
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7439831  Vali Loss: 0.5771385 Vali Accuracy: 0.9223058  Vali weighted F1: 0.9206658  Vali macro F1 0.9194195 
new best score!!!!
Validation loss decreased (0.821768 --> 0.577138).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3855555057525635
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5244870  Vali Loss: 0.4174033 Vali Accuracy: 0.9398496  Vali weighted F1: 0.9395073  Vali macro F1 0.9391182 
new best score!!!!
Validation loss decreased (0.577138 --> 0.417403).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.387927770614624
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3927089  Vali Loss: 0.3179242 Vali Accuracy: 0.9461153  Vali weighted F1: 0.9453018  Vali macro F1 0.9447777 
new best score!!!!
Validation loss decreased (0.417403 --> 0.317924).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.386894702911377
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3278826  Vali Loss: 0.2627397 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9620482  Vali macro F1 0.9622080 
new best score!!!!
Validation loss decreased (0.317924 --> 0.262740).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.385637044906616
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2612678  Vali Loss: 0.2179544 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9703508  Vali macro F1 0.9698796 
new best score!!!!
Validation loss decreased (0.262740 --> 0.217954).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3870792388916016
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2306588  Vali Loss: 0.1864120 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9771287  Vali macro F1 0.9769341 
new best score!!!!
Validation loss decreased (0.217954 --> 0.186412).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.400409460067749
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1945072  Vali Loss: 0.1575747 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9797619  Vali macro F1 0.9795304 
new best score!!!!
Validation loss decreased (0.186412 --> 0.157575).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3927552700042725
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1638254  Vali Loss: 0.1385941 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9784963  Vali macro F1 0.9784439 
new best score!!!!
Validation loss decreased (0.157575 --> 0.138594).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3948192596435547
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1460483  Vali Loss: 0.1332092 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859154  Vali macro F1 0.9858635 
new best score!!!!
Validation loss decreased (0.138594 --> 0.133209).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.439807176589966
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1304513  Vali Loss: 0.1074251 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821550  Vali macro F1 0.9816703 
new best score!!!!
Validation loss decreased (0.133209 --> 0.107425).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.4085094928741455
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.1070835  Vali Loss: 0.0909377 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886572  Vali macro F1 0.9880957 
new best score!!!!
Validation loss decreased (0.107425 --> 0.090938).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3955678939819336
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0890831  Vali Loss: 0.0825575 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861112  Vali macro F1 0.9856413 
new best score!!!!
Validation loss decreased (0.090938 --> 0.082558).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3873050212860107
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0784016  Vali Loss: 0.0736733 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874533  Vali macro F1 0.9866982 
new best score!!!!
Validation loss decreased (0.082558 --> 0.073673).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.384990692138672
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0755930  Vali Loss: 0.0690280 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886680  Vali macro F1 0.9881995 
new best score!!!!
Validation loss decreased (0.073673 --> 0.069028).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.384575843811035
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0699379  Vali Loss: 0.0623871 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900209  Vali macro F1 0.9895052 
new best score!!!!
Validation loss decreased (0.069028 --> 0.062387).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3844497203826904
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0644029  Vali Loss: 0.0645513 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836271  Vali macro F1 0.9831707 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.3848860263824463
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0602809  Vali Loss: 0.0544593 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911859  Vali macro F1 0.9907785 
new best score!!!!
Validation loss decreased (0.062387 --> 0.054459).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3891844749450684
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0548754  Vali Loss: 0.0585510 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873079  Vali macro F1 0.9871572 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.38193416595459
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0511039  Vali Loss: 0.0519522 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872743  Vali macro F1 0.9870346 
new best score!!!!
Validation loss decreased (0.054459 --> 0.051952).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.383753538131714
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0434146  Vali Loss: 0.0445579 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911366  Vali macro F1 0.9909441 
new best score!!!!
Validation loss decreased (0.051952 --> 0.044558).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3848183155059814
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0422958  Vali Loss: 0.0508945 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873400  Vali macro F1 0.9867345 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.3844964504241943
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0420547  Vali Loss: 0.0847080 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9843793  Vali macro F1 0.9830290 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 3.386428117752075
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0678916  Vali Loss: 0.0443282 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911762  Vali macro F1 0.9909328 
new best score!!!!
Validation loss decreased (0.044558 --> 0.044328).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3903048038482666
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0451117  Vali Loss: 0.0370385 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911926  Vali macro F1 0.9908442 
new best score!!!!
Validation loss decreased (0.044328 --> 0.037039).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.3893933296203613
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0375028  Vali Loss: 0.0345672 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9919421 
new best score!!!!
Validation loss decreased (0.037039 --> 0.034567).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.3869662284851074
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0309746  Vali Loss: 0.0359909 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912264  Vali macro F1 0.9905958 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.4446091651916504
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0314910  Vali Loss: 0.0400793 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886907  Vali macro F1 0.9881284 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 3.423609733581543
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0381300  Vali Loss: 0.0348623 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924596  Vali macro F1 0.9922266 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 3.3922059535980225
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0304968  Vali Loss: 0.0318397 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949777  Vali macro F1 0.9948241 
new best score!!!!
Validation loss decreased (0.034567 --> 0.031840).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.3869006633758545
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0268361  Vali Loss: 0.0312534 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924838  Vali macro F1 0.9918985 
new best score!!!!
Validation loss decreased (0.031840 --> 0.031253).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.3783814907073975
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0285266  Vali Loss: 0.0321484 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924407  Vali macro F1 0.9921247 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.3871965408325195
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0225287  Vali Loss: 0.0294636 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9946280 
new best score!!!!
Validation loss decreased (0.031253 --> 0.029464).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.384927988052368
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0249061  Vali Loss: 0.0364475 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924596  Vali macro F1 0.9922266 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.3829073905944824
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0218114  Vali Loss: 0.0259011 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.029464 --> 0.025901).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.388267993927002
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0215501  Vali Loss: 0.0356930 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9921106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 3.389863967895508
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0270936  Vali Loss: 0.0307249 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911968  Vali macro F1 0.9908823 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 3.392219305038452
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0223633  Vali Loss: 0.0259732 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949799  Vali macro F1 0.9947090 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 4.5043323040008545
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0210597  Vali Loss: 0.0323290 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937231  Vali macro F1 0.9935747 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 3.387112855911255
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0208605  Vali Loss: 0.0345892 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911366  Vali macro F1 0.9909441 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 43 cost time: 3.386899471282959
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0170122  Vali Loss: 0.0290363 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924407  Vali macro F1 0.9921247 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 3.3924901485443115
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0154825  Vali Loss: 0.0275640 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937036  Vali macro F1 0.9934691 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 3.4170706272125244
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0158282  Vali Loss: 0.0268792 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 3.4296419620513916
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0154911  Vali Loss: 0.0268996 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 3.395028591156006
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0153922  Vali Loss: 0.0244903 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
new best score!!!!
Validation loss decreased (0.025901 --> 0.024490).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.388883352279663
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0150842  Vali Loss: 0.0306088 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937036  Vali macro F1 0.9934691 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.386594533920288
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0148183  Vali Loss: 0.0259952 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.385157823562622
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0153725  Vali Loss: 0.0327784 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924407  Vali macro F1 0.9921247 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.3826310634613037
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0146551  Vali Loss: 0.0265448 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 3.382741689682007
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0148321  Vali Loss: 0.0251651 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 3.388209342956543
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0150125  Vali Loss: 0.0253323 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.390573263168335
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0152865  Vali Loss: 0.0259571 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.3821980953216553
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0147314  Vali Loss: 0.0258965 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.3865303993225098
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0150527  Vali Loss: 0.0256872 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 3.382476568222046
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0152376  Vali Loss: 0.0251505 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 3.393955707550049
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0147062  Vali Loss: 0.0251261 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.390230655670166
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0142990  Vali Loss: 0.0251251 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 3.433283567428589
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0145077  Vali Loss: 0.0252057 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 3.4255194664001465
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0145236  Vali Loss: 0.0252317 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 3.3879075050354004
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0149772  Vali Loss: 0.0252085 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8710526  Test weighted F1: 0.8612439  Test macro F1 0.8612439 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.7827982902526855
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0157164  Vali Loss: 0.0231148 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
Validation loss decreased (inf --> 0.023115).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.776909351348877
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0139281  Vali Loss: 0.0231527 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.78103494644165
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0144211  Vali Loss: 0.0223875 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.023115 --> 0.022388).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.781426191329956
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0161738  Vali Loss: 0.0317841 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924407  Vali macro F1 0.9921247 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.782950162887573
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0148978  Vali Loss: 0.0251782 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 4.7811243534088135
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0132715  Vali Loss: 0.0258033 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 4.780383110046387
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0131382  Vali Loss: 0.0209919 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.022388 --> 0.020992).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.780039548873901
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0126203  Vali Loss: 0.0245084 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.783732652664185
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0113811  Vali Loss: 0.0209543 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.020992 --> 0.020954).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.784138441085815
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0119335  Vali Loss: 0.0236703 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949671  Vali macro F1 0.9948172 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 4.786774158477783
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0117813  Vali Loss: 0.0211648 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 4.784655570983887
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0114643  Vali Loss: 0.0211746 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 4.78039026260376
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0107964  Vali Loss: 0.0222725 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 4.781201124191284
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0106396  Vali Loss: 0.0213025 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 4.781675338745117
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0106602  Vali Loss: 0.0208081 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.020954 --> 0.020808).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.7849249839782715
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0102930  Vali Loss: 0.0208242 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 4.783485651016235
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0096178  Vali Loss: 0.0204453 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.020808 --> 0.020445).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.781591892242432
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0114362  Vali Loss: 0.0209742 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.782620191574097
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0100782  Vali Loss: 0.0204689 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 4.781167507171631
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0097478  Vali Loss: 0.0199950 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
new best score!!!!
Validation loss decreased (0.020445 --> 0.019995).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 4.783796310424805
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0101165  Vali Loss: 0.0281304 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937036  Vali macro F1 0.9934691 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.782608270645142
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0097485  Vali Loss: 0.0208866 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 4.785856246948242
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0091355  Vali Loss: 0.0208963 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 4.781975269317627
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0092782  Vali Loss: 0.0210262 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 4.782054662704468
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0094578  Vali Loss: 0.0211123 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 4.7825751304626465
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0083831  Vali Loss: 0.0210971 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.786632537841797
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0079368  Vali Loss: 0.0210923 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.785125017166138
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0077480  Vali Loss: 0.0211024 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 4.782787561416626
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0090399  Vali Loss: 0.0214414 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 4.786353349685669
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0091649  Vali Loss: 0.0212335 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 4.784917831420898
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0088114  Vali Loss: 0.0212203 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 4.783655166625977
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0085449  Vali Loss: 0.0212125 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 4.785435199737549
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0094611  Vali Loss: 0.0212232 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 4.784161806106567
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0089895  Vali Loss: 0.0212404 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 4.785063982009888
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0084514  Vali Loss: 0.0212510 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962357  Vali macro F1 0.9959612 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8763158  Test weighted F1: 0.8655569  Test macro F1 0.8655569 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.468346118927002
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8750234  Vali Loss: 2.4672631 Vali Accuracy: 0.4611529  Vali weighted F1: 0.4111726  Vali macro F1 0.4140975 
Validation loss decreased (inf --> 2.467263).  Saving model ...
Epoch: 2 cost time: 3.3770225048065186
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8081942  Vali Loss: 1.3242696 Vali Accuracy: 0.7894737  Vali weighted F1: 0.7666010  Vali macro F1 0.7731653 
new best score!!!!
Validation loss decreased (2.467263 --> 1.324270).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3775436878204346
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0872617  Vali Loss: 0.8412861 Vali Accuracy: 0.8897243  Vali weighted F1: 0.8860461  Vali macro F1 0.8854725 
new best score!!!!
Validation loss decreased (1.324270 --> 0.841286).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.377918243408203
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7339625  Vali Loss: 0.5678908 Vali Accuracy: 0.9185464  Vali weighted F1: 0.9162129  Vali macro F1 0.9156137 
new best score!!!!
Validation loss decreased (0.841286 --> 0.567891).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.379403829574585
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5305537  Vali Loss: 0.4155624 Vali Accuracy: 0.9411028  Vali weighted F1: 0.9388317  Vali macro F1 0.9382210 
new best score!!!!
Validation loss decreased (0.567891 --> 0.415562).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3795011043548584
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3968243  Vali Loss: 0.3127169 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9602626  Vali macro F1 0.9601933 
new best score!!!!
Validation loss decreased (0.415562 --> 0.312717).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.376401901245117
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2987417  Vali Loss: 0.2330496 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9658814  Vali macro F1 0.9657470 
new best score!!!!
Validation loss decreased (0.312717 --> 0.233050).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3815205097198486
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2383576  Vali Loss: 0.2002387 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9647778  Vali macro F1 0.9644363 
new best score!!!!
Validation loss decreased (0.233050 --> 0.200239).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3809781074523926
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2064607  Vali Loss: 0.1690258 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9733902  Vali macro F1 0.9726052 
new best score!!!!
Validation loss decreased (0.200239 --> 0.169026).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.3880674839019775
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1702387  Vali Loss: 0.1392228 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9785188  Vali macro F1 0.9781586 
new best score!!!!
Validation loss decreased (0.169026 --> 0.139223).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.381120204925537
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1421606  Vali Loss: 0.1237739 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9706226  Vali macro F1 0.9691619 
new best score!!!!
Validation loss decreased (0.139223 --> 0.123774).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.4381284713745117
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1224789  Vali Loss: 0.1051955 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9771728  Vali macro F1 0.9766435 
new best score!!!!
Validation loss decreased (0.123774 --> 0.105195).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4188296794891357
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1100342  Vali Loss: 0.0913528 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9797652  Vali macro F1 0.9791963 
new best score!!!!
Validation loss decreased (0.105195 --> 0.091353).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3867688179016113
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0952707  Vali Loss: 0.0823816 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860772  Vali macro F1 0.9851602 
new best score!!!!
Validation loss decreased (0.091353 --> 0.082382).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3852338790893555
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0854754  Vali Loss: 0.0727932 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873097  Vali macro F1 0.9862418 
new best score!!!!
Validation loss decreased (0.082382 --> 0.072793).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3863086700439453
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0862305  Vali Loss: 0.0783664 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860595  Vali macro F1 0.9852247 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 3.382565498352051
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0727970  Vali Loss: 0.0632112 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9847610  Vali macro F1 0.9837862 
new best score!!!!
Validation loss decreased (0.072793 --> 0.063211).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3867969512939453
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0621837  Vali Loss: 0.0592068 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822037  Vali macro F1 0.9807601 
new best score!!!!
Validation loss decreased (0.063211 --> 0.059207).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.38258695602417
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0571278  Vali Loss: 0.0529996 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872666  Vali macro F1 0.9863025 
new best score!!!!
Validation loss decreased (0.059207 --> 0.053000).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.38442325592041
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0500776  Vali Loss: 0.0489262 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872648  Vali macro F1 0.9863070 
new best score!!!!
Validation loss decreased (0.053000 --> 0.048926).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3886513710021973
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0557059  Vali Loss: 0.0485258 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835349  Vali macro F1 0.9824083 
new best score!!!!
Validation loss decreased (0.048926 --> 0.048526).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.393381357192993
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0445106  Vali Loss: 0.0418111 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898168  Vali macro F1 0.9890281 
new best score!!!!
Validation loss decreased (0.048526 --> 0.041811).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.390298843383789
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0509271  Vali Loss: 0.0473941 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911808  Vali macro F1 0.9904841 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.3896734714508057
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0485289  Vali Loss: 0.0422773 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898467  Vali macro F1 0.9893658 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 3.3915598392486572
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0425917  Vali Loss: 0.0385198 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899016  Vali macro F1 0.9891489 
new best score!!!!
Validation loss decreased (0.041811 --> 0.038520).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.397075891494751
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0481368  Vali Loss: 0.0444155 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887741  Vali macro F1 0.9881898 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.398386001586914
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0340248  Vali Loss: 0.0352270 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924457  Vali macro F1 0.9919006 
new best score!!!!
Validation loss decreased (0.038520 --> 0.035227).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.4242823123931885
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0287731  Vali Loss: 0.0353902 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899228  Vali macro F1 0.9891053 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.431098699569702
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0304656  Vali Loss: 0.0355024 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911461  Vali macro F1 0.9906164 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 3.4044933319091797
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0302547  Vali Loss: 0.0354978 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885615  Vali macro F1 0.9876748 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 3.377415180206299
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0272064  Vali Loss: 0.0371238 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884996  Vali macro F1 0.9878429 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 3.368541717529297
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0258284  Vali Loss: 0.0298308 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911662  Vali macro F1 0.9905367 
new best score!!!!
Validation loss decreased (0.035227 --> 0.029831).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.3689823150634766
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0248161  Vali Loss: 0.0276176 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.029831 --> 0.027618).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.371622085571289
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0250596  Vali Loss: 0.0250569 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937463  Vali macro F1 0.9935092 
new best score!!!!
Validation loss decreased (0.027618 --> 0.025057).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.373182535171509
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0230415  Vali Loss: 0.0322015 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874296  Vali macro F1 0.9867919 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.36832332611084
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0240269  Vali Loss: 0.0252851 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.369710683822632
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0187330  Vali Loss: 0.0268096 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 3.365720510482788
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0249152  Vali Loss: 0.0765586 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9670961  Vali macro F1 0.9646379 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 3.3739173412323
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0766953  Vali Loss: 0.0499606 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9832827  Vali macro F1 0.9821343 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 3.3642232418060303
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0408301  Vali Loss: 0.0475898 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9820286  Vali macro F1 0.9807889 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 3.3710103034973145
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0358371  Vali Loss: 0.0433073 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859636  Vali macro F1 0.9849312 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 3.371954917907715
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0321352  Vali Loss: 0.0374837 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897989  Vali macro F1 0.9891104 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 3.4223246574401855
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0288265  Vali Loss: 0.0319385 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898715  Vali macro F1 0.9892613 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 3.403918981552124
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0265021  Vali Loss: 0.0284455 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 3.376108169555664
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0253669  Vali Loss: 0.0283416 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.3689074516296387
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0251564  Vali Loss: 0.0282947 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.3757002353668213
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0257118  Vali Loss: 0.0283402 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 3.364623785018921
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0252309  Vali Loss: 0.0282887 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 3.3718135356903076
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0248178  Vali Loss: 0.0282258 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911851  Vali macro F1 0.9905587 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9184211  Test weighted F1: 0.8985428  Test macro F1 0.8985428 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.807713747024536
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0206688  Vali Loss: 0.0252999 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
Validation loss decreased (inf --> 0.025300).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.809179782867432
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0197891  Vali Loss: 0.0247838 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.025300 --> 0.024784).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.809312105178833
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0191049  Vali Loss: 0.0241808 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.024784 --> 0.024181).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.809740304946899
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0185436  Vali Loss: 0.0238454 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937463  Vali macro F1 0.9935092 
new best score!!!!
Validation loss decreased (0.024181 --> 0.023845).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.807677268981934
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0181273  Vali Loss: 0.0240379 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.8101606369018555
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0172192  Vali Loss: 0.0233702 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937463  Vali macro F1 0.9935092 
new best score!!!!
Validation loss decreased (0.023845 --> 0.023370).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.918163537979126
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0170979  Vali Loss: 0.0232658 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.023370 --> 0.023266).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.809362411499023
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0160932  Vali Loss: 0.0232919 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.8091959953308105
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0163264  Vali Loss: 0.0228350 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.023266 --> 0.022835).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.811538934707642
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0181890  Vali Loss: 0.0222776 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.022835 --> 0.022278).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.809345483779907
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0166327  Vali Loss: 0.0216114 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.022278 --> 0.021611).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.812488079071045
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0175589  Vali Loss: 0.0222996 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937073  Vali macro F1 0.9932467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.809152603149414
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0155843  Vali Loss: 0.0214178 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.021611 --> 0.021418).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.804204940795898
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0145342  Vali Loss: 0.0212728 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937463  Vali macro F1 0.9935092 
new best score!!!!
Validation loss decreased (0.021418 --> 0.021273).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.805724143981934
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0141973  Vali Loss: 0.0217444 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.804474592208862
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0137999  Vali Loss: 0.0214940 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937463  Vali macro F1 0.9935092 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 4.802239418029785
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0182103  Vali Loss: 0.0208135 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.021273 --> 0.020813).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.808733940124512
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0137300  Vali Loss: 0.0197062 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.020813 --> 0.019706).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 4.801818370819092
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0133907  Vali Loss: 0.0208725 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 4.797613620758057
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0122896  Vali Loss: 0.0198666 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 4.800045490264893
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0129708  Vali Loss: 0.0199137 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 4.807027816772461
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0127361  Vali Loss: 0.0200354 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 4.797207593917847
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0129016  Vali Loss: 0.0206114 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 24 cost time: 4.7986366748809814
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0130109  Vali Loss: 0.0202679 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 4.796625137329102
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0124269  Vali Loss: 0.0217002 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936892  Vali macro F1 0.9931495 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 4.797307729721069
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0126216  Vali Loss: 0.0205923 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924099  Vali macro F1 0.9917859 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 4.79543137550354
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0128787  Vali Loss: 0.0199233 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 4.803889989852905
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0117956  Vali Loss: 0.0199088 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 29 cost time: 4.795883655548096
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0103738  Vali Loss: 0.0198174 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 4.800588846206665
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0099293  Vali Loss: 0.0196644 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.019706 --> 0.019664).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 4.800786733627319
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0138690  Vali Loss: 0.0196623 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.019664 --> 0.019662).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 4.792809247970581
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0102850  Vali Loss: 0.0197713 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 4.803137302398682
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0106457  Vali Loss: 0.0195850 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.019662 --> 0.019585).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 4.796522617340088
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0102976  Vali Loss: 0.0195899 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 4.795964479446411
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0109800  Vali Loss: 0.0196621 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 4.801936149597168
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0113977  Vali Loss: 0.0196449 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 4.799525260925293
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0102284  Vali Loss: 0.0196104 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 4.79691481590271
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0118590  Vali Loss: 0.0195461 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.019585 --> 0.019546).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 4.800726652145386
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0110029  Vali Loss: 0.0194849 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.019546 --> 0.019485).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 40 cost time: 4.798072576522827
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0115807  Vali Loss: 0.0194455 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.019485 --> 0.019445).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 41 cost time: 4.800041437149048
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0111231  Vali Loss: 0.0195520 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 4.804757595062256
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0124848  Vali Loss: 0.0197572 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 4.798033952713013
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0109530  Vali Loss: 0.0197597 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 4.799923419952393
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0109313  Vali Loss: 0.0196151 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 4.800992012023926
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0108898  Vali Loss: 0.0195232 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 46 cost time: 4.798921823501587
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0107488  Vali Loss: 0.0195261 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 47 cost time: 4.800560474395752
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0113757  Vali Loss: 0.0195331 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 48 cost time: 4.7967445850372314
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0108002  Vali Loss: 0.0195454 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 49 cost time: 4.791578769683838
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0117642  Vali Loss: 0.0195413 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 50 cost time: 4.796062231063843
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0106773  Vali Loss: 0.0195342 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 51 cost time: 4.7966392040252686
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0104209  Vali Loss: 0.0195348 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 52 cost time: 4.800250053405762
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0107277  Vali Loss: 0.0195348 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 53 cost time: 4.803797960281372
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0113088  Vali Loss: 0.0195326 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 54 cost time: 4.8062286376953125
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0111534  Vali Loss: 0.0195308 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 55 cost time: 4.796076059341431
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0104647  Vali Loss: 0.0195303 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9210526  Test weighted F1: 0.9024033  Test macro F1 0.9024033 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4587228298187256
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8902124  Vali Loss: 2.5110427 Vali Accuracy: 0.4436090  Vali weighted F1: 0.3898790  Vali macro F1 0.3892312 
Validation loss decreased (inf --> 2.511043).  Saving model ...
Epoch: 2 cost time: 3.3570759296417236
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8338301  Vali Loss: 1.3108511 Vali Accuracy: 0.7731830  Vali weighted F1: 0.7441562  Vali macro F1 0.7524771 
new best score!!!!
Validation loss decreased (2.511043 --> 1.310851).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.351074457168579
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0675636  Vali Loss: 0.8481347 Vali Accuracy: 0.8809524  Vali weighted F1: 0.8765157  Vali macro F1 0.8790580 
new best score!!!!
Validation loss decreased (1.310851 --> 0.848135).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3564565181732178
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7197231  Vali Loss: 0.5759293 Vali Accuracy: 0.9310777  Vali weighted F1: 0.9298369  Vali macro F1 0.9307843 
new best score!!!!
Validation loss decreased (0.848135 --> 0.575929).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.350135326385498
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5253185  Vali Loss: 0.4212443 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9621922  Vali macro F1 0.9608317 
new best score!!!!
Validation loss decreased (0.575929 --> 0.421244).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.359255790710449
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3909767  Vali Loss: 0.3155541 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9654213  Vali macro F1 0.9650049 
new best score!!!!
Validation loss decreased (0.421244 --> 0.315554).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3597652912139893
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3059254  Vali Loss: 0.2423228 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9833319  Vali macro F1 0.9827398 
new best score!!!!
Validation loss decreased (0.315554 --> 0.242323).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.366882562637329
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2391826  Vali Loss: 0.2062491 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9768906  Vali macro F1 0.9759382 
new best score!!!!
Validation loss decreased (0.242323 --> 0.206249).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.351513385772705
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2019346  Vali Loss: 0.1700207 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9805275  Vali macro F1 0.9800621 
new best score!!!!
Validation loss decreased (0.206249 --> 0.170021).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.417667865753174
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1652410  Vali Loss: 0.1409576 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872940  Vali macro F1 0.9867142 
new best score!!!!
Validation loss decreased (0.170021 --> 0.140958).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3705880641937256
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1427250  Vali Loss: 0.1208125 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899782  Vali macro F1 0.9895928 
new best score!!!!
Validation loss decreased (0.140958 --> 0.120812).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3646926879882812
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1226103  Vali Loss: 0.1077222 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937473  Vali macro F1 0.9934205 
new best score!!!!
Validation loss decreased (0.120812 --> 0.107722).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3592941761016846
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1041724  Vali Loss: 0.0932729 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911983  Vali macro F1 0.9907216 
new best score!!!!
Validation loss decreased (0.107722 --> 0.093273).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.360867500305176
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0949602  Vali Loss: 0.0770988 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937267  Vali macro F1 0.9934103 
new best score!!!!
Validation loss decreased (0.093273 --> 0.077099).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3539578914642334
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0890764  Vali Loss: 0.0775167 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924915  Vali macro F1 0.9923595 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 3.365938186645508
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0894609  Vali Loss: 0.0698470 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884629  Vali macro F1 0.9878331 
new best score!!!!
Validation loss decreased (0.077099 --> 0.069847).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.360105276107788
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0688778  Vali Loss: 0.0601668 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924295  Vali macro F1 0.9920259 
new best score!!!!
Validation loss decreased (0.069847 --> 0.060167).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3612489700317383
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0643390  Vali Loss: 0.0589727 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873385  Vali macro F1 0.9867052 
new best score!!!!
Validation loss decreased (0.060167 --> 0.058973).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3572747707366943
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0544182  Vali Loss: 0.0483254 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924618  Vali macro F1 0.9921536 
new best score!!!!
Validation loss decreased (0.058973 --> 0.048325).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.355564832687378
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0504417  Vali Loss: 0.0433382 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
new best score!!!!
Validation loss decreased (0.048325 --> 0.043338).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3652000427246094
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0466108  Vali Loss: 0.0471292 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937267  Vali macro F1 0.9934103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.360645055770874
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0493825  Vali Loss: 0.0400185 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936997  Vali macro F1 0.9933933 
new best score!!!!
Validation loss decreased (0.043338 --> 0.040018).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3557958602905273
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0424471  Vali Loss: 0.0393500 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937267  Vali macro F1 0.9934103 
new best score!!!!
Validation loss decreased (0.040018 --> 0.039350).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.367396831512451
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0409369  Vali Loss: 0.0367915 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924618  Vali macro F1 0.9921536 
new best score!!!!
Validation loss decreased (0.039350 --> 0.036791).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.3631858825683594
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0404558  Vali Loss: 0.0441065 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886972  Vali macro F1 0.9881068 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 3.41218900680542
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0439643  Vali Loss: 0.0308733 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
new best score!!!!
Validation loss decreased (0.036791 --> 0.030873).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3951992988586426
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0374951  Vali Loss: 0.0308711 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
new best score!!!!
Validation loss decreased (0.030873 --> 0.030871).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.362666606903076
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0340877  Vali Loss: 0.0334876 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924332  Vali macro F1 0.9920480 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.358633041381836
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0339530  Vali Loss: 0.0315265 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925108  Vali macro F1 0.9922107 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 3.358383893966675
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0304646  Vali Loss: 0.0317883 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911493  Vali macro F1 0.9906644 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 3.3572564125061035
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0317647  Vali Loss: 0.0507480 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900365  Vali macro F1 0.9902638 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 3.3622355461120605
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0309595  Vali Loss: 0.0302773 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924969  Vali macro F1 0.9920714 
new best score!!!!
Validation loss decreased (0.030871 --> 0.030277).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.358520746231079
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0255063  Vali Loss: 0.0346274 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897682  Vali macro F1 0.9892135 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.3597280979156494
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0304054  Vali Loss: 0.0299847 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911013  Vali macro F1 0.9906297 
new best score!!!!
Validation loss decreased (0.030277 --> 0.029985).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.3578474521636963
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0245915  Vali Loss: 0.0227769 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
new best score!!!!
Validation loss decreased (0.029985 --> 0.022777).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.3571383953094482
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0255219  Vali Loss: 0.0227639 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
new best score!!!!
Validation loss decreased (0.022777 --> 0.022764).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.3582353591918945
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0222710  Vali Loss: 0.0264143 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 3.362908363342285
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0208479  Vali Loss: 0.0278865 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923850  Vali macro F1 0.9919918 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 3.3619723320007324
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0219130  Vali Loss: 0.0237097 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949909  Vali macro F1 0.9947592 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 3.363741397857666
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0221483  Vali Loss: 0.0203629 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949909  Vali macro F1 0.9947592 
new best score!!!!
Validation loss decreased (0.022764 --> 0.020363).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.3621184825897217
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0193524  Vali Loss: 0.0193525 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949909  Vali macro F1 0.9947592 
new best score!!!!
Validation loss decreased (0.020363 --> 0.019353).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.418149709701538
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0219773  Vali Loss: 0.0278710 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937507  Vali macro F1 0.9936525 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.3852365016937256
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0273597  Vali Loss: 0.0206038 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.357443332672119
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0185780  Vali Loss: 0.0195630 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 3.3578145503997803
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0194355  Vali Loss: 0.0196180 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 3.357545852661133
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0177419  Vali Loss: 0.0188152 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9948479 
new best score!!!!
Validation loss decreased (0.019353 --> 0.018815).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.356372833251953
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0167996  Vali Loss: 0.0241204 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 3.3568713665008545
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0154454  Vali Loss: 0.0200866 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937267  Vali macro F1 0.9934103 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 3.358259439468384
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0149282  Vali Loss: 0.0236006 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937267  Vali macro F1 0.9934103 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 3.3559861183166504
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0143618  Vali Loss: 0.0228931 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924629  Vali macro F1 0.9920648 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 3.3586981296539307
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0137686  Vali Loss: 0.0167050 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974972  Vali macro F1 0.9974452 
new best score!!!!
Validation loss decreased (0.018815 --> 0.016705).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.3584518432617188
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0130154  Vali Loss: 0.0155789 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
new best score!!!!
Validation loss decreased (0.016705 --> 0.015579).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 3.3607006072998047
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0142288  Vali Loss: 0.0172726 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950063  Vali macro F1 0.9948671 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.358851909637451
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0176259  Vali Loss: 0.0197010 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949651  Vali macro F1 0.9947404 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.3614516258239746
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0154223  Vali Loss: 0.0247567 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911734  Vali macro F1 0.9908107 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.3597819805145264
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0268310  Vali Loss: 0.0304699 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873163  Vali macro F1 0.9864385 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 3.367283821105957
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0951455  Vali Loss: 0.0589885 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897682  Vali macro F1 0.9892135 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 58 cost time: 3.4091851711273193
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0460518  Vali Loss: 0.0477106 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911493  Vali macro F1 0.9906644 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.3939571380615234
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0386049  Vali Loss: 0.0393094 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936344  Vali macro F1 0.9931152 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 3.361907958984375
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0326965  Vali Loss: 0.0352495 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923179  Vali macro F1 0.9917152 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 3.356424570083618
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0318032  Vali Loss: 0.0328298 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923179  Vali macro F1 0.9917152 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 3.3555991649627686
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0288903  Vali Loss: 0.0320949 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923179  Vali macro F1 0.9917152 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 63 cost time: 3.3536832332611084
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0281763  Vali Loss: 0.0321182 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923179  Vali macro F1 0.9917152 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 3.3551666736602783
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0281974  Vali Loss: 0.0319824 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923179  Vali macro F1 0.9917152 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 3.3659520149230957
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0282729  Vali Loss: 0.0320121 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923179  Vali macro F1 0.9917152 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 3.355740547180176
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0293461  Vali Loss: 0.0309941 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9923179  Vali macro F1 0.9917152 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 3.3556811809539795
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0270185  Vali Loss: 0.0305297 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9910698  Vali macro F1 0.9905930 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9061404  Test weighted F1: 0.9035744  Test macro F1 0.9035744 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.786781072616577
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0126371  Vali Loss: 0.0154409 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
Validation loss decreased (inf --> 0.015441).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.7867043018341064
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0123197  Vali Loss: 0.0150738 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
new best score!!!!
Validation loss decreased (0.015441 --> 0.015074).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.785238027572632
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0121894  Vali Loss: 0.0145080 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
new best score!!!!
Validation loss decreased (0.015074 --> 0.014508).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.782685041427612
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0119121  Vali Loss: 0.0159403 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.781963109970093
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0115721  Vali Loss: 0.0168553 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 4.7864062786102295
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0107348  Vali Loss: 0.0149063 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 4.7814860343933105
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0106898  Vali Loss: 0.0133990 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
new best score!!!!
Validation loss decreased (0.014508 --> 0.013399).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.778249979019165
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0099428  Vali Loss: 0.0135131 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.772113084793091
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0107553  Vali Loss: 0.0155123 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 4.770211935043335
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0102102  Vali Loss: 0.0137082 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 4.76927924156189
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0103873  Vali Loss: 0.0136101 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 4.770344018936157
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0092129  Vali Loss: 0.0143314 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 4.76836371421814
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0101867  Vali Loss: 0.0137488 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.771191596984863
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0095286  Vali Loss: 0.0148341 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.7678728103637695
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0093321  Vali Loss: 0.0173283 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937590  Vali macro F1 0.9935380 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.770733594894409
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0097503  Vali Loss: 0.0157446 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949898  Vali macro F1 0.9948479 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 4.7720701694488525
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0092939  Vali Loss: 0.0168627 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 4.767158031463623
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0100933  Vali Loss: 0.0165573 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.77035927772522
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0096489  Vali Loss: 0.0156403 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 4.770381927490234
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0128976  Vali Loss: 0.0156145 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 4.768306493759155
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0097592  Vali Loss: 0.0152058 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 4.767834901809692
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0086610  Vali Loss: 0.0150292 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962560  Vali macro F1 0.9962020 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9026316  Test weighted F1: 0.8972920  Test macro F1 0.8972920 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.448960781097412
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8790361  Vali Loss: 2.4714441 Vali Accuracy: 0.4862155  Vali weighted F1: 0.4246815  Vali macro F1 0.4297197 
Validation loss decreased (inf --> 2.471444).  Saving model ...
Epoch: 2 cost time: 3.357349157333374
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8528931  Vali Loss: 1.3371158 Vali Accuracy: 0.8107769  Vali weighted F1: 0.7898251  Vali macro F1 0.7904873 
new best score!!!!
Validation loss decreased (2.471444 --> 1.337116).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3613758087158203
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0933463  Vali Loss: 0.8260959 Vali Accuracy: 0.8984962  Vali weighted F1: 0.8949787  Vali macro F1 0.8949967 
new best score!!!!
Validation loss decreased (1.337116 --> 0.826096).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3611114025115967
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7275016  Vali Loss: 0.5615208 Vali Accuracy: 0.9423559  Vali weighted F1: 0.9420653  Vali macro F1 0.9422774 
new best score!!!!
Validation loss decreased (0.826096 --> 0.561521).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.363537549972534
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5228304  Vali Loss: 0.3943795 Vali Accuracy: 0.9448622  Vali weighted F1: 0.9442501  Vali macro F1 0.9435735 
new best score!!!!
Validation loss decreased (0.561521 --> 0.394379).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.414008617401123
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3918220  Vali Loss: 0.2847087 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9557088  Vali macro F1 0.9555108 
new best score!!!!
Validation loss decreased (0.394379 --> 0.284709).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.39493727684021
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2980540  Vali Loss: 0.2243635 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9772345  Vali macro F1 0.9765776 
new best score!!!!
Validation loss decreased (0.284709 --> 0.224363).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.357726573944092
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2470149  Vali Loss: 0.1769438 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9734053  Vali macro F1 0.9720668 
new best score!!!!
Validation loss decreased (0.224363 --> 0.176944).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.356271743774414
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2025544  Vali Loss: 0.1464132 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9746882  Vali macro F1 0.9734623 
new best score!!!!
Validation loss decreased (0.176944 --> 0.146413).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.3600716590881348
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1655068  Vali Loss: 0.1243180 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809705  Vali macro F1 0.9804135 
new best score!!!!
Validation loss decreased (0.146413 --> 0.124318).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.357255458831787
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1399951  Vali Loss: 0.1030140 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873765  Vali macro F1 0.9864968 
new best score!!!!
Validation loss decreased (0.124318 --> 0.103014).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3580729961395264
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1184424  Vali Loss: 0.0919698 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822803  Vali macro F1 0.9814930 
new best score!!!!
Validation loss decreased (0.103014 --> 0.091970).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.359265089035034
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1210113  Vali Loss: 0.0858000 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822819  Vali macro F1 0.9814381 
new best score!!!!
Validation loss decreased (0.091970 --> 0.085800).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3677003383636475
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.1045079  Vali Loss: 0.0729069 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899014  Vali macro F1 0.9891824 
new best score!!!!
Validation loss decreased (0.085800 --> 0.072907).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.36071515083313
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0843325  Vali Loss: 0.0689971 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861580  Vali macro F1 0.9856629 
new best score!!!!
Validation loss decreased (0.072907 --> 0.068997).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.366236448287964
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0737125  Vali Loss: 0.0568705 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911895  Vali macro F1 0.9904797 
new best score!!!!
Validation loss decreased (0.068997 --> 0.056871).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.365817070007324
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0664132  Vali Loss: 0.0540106 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924437  Vali macro F1 0.9918285 
new best score!!!!
Validation loss decreased (0.056871 --> 0.054011).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.358339309692383
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0654064  Vali Loss: 0.0525316 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
new best score!!!!
Validation loss decreased (0.054011 --> 0.052532).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.362919330596924
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0581313  Vali Loss: 0.0497312 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887226  Vali macro F1 0.9879431 
new best score!!!!
Validation loss decreased (0.052532 --> 0.049731).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.36718487739563
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0560783  Vali Loss: 0.0455447 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937159  Vali macro F1 0.9931722 
new best score!!!!
Validation loss decreased (0.049731 --> 0.045545).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3707618713378906
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0509923  Vali Loss: 0.0443164 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886193  Vali macro F1 0.9877248 
new best score!!!!
Validation loss decreased (0.045545 --> 0.044316).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.3726625442504883
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0507282  Vali Loss: 0.0433344 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899314  Vali macro F1 0.9891237 
new best score!!!!
Validation loss decreased (0.044316 --> 0.043334).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.4156744480133057
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0460903  Vali Loss: 0.0405342 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899314  Vali macro F1 0.9891237 
new best score!!!!
Validation loss decreased (0.043334 --> 0.040534).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3667097091674805
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0462308  Vali Loss: 0.0418132 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899480  Vali macro F1 0.9891121 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.369173765182495
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0853747  Vali Loss: 0.0549139 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848701  Vali macro F1 0.9838506 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 3.364811897277832
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0451505  Vali Loss: 0.0383023 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872869  Vali macro F1 0.9865738 
new best score!!!!
Validation loss decreased (0.040534 --> 0.038302).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.362290859222412
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0376361  Vali Loss: 0.0375780 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886174  Vali macro F1 0.9877175 
new best score!!!!
Validation loss decreased (0.038302 --> 0.037578).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.360024929046631
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0357463  Vali Loss: 0.0345629 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937084  Vali macro F1 0.9931580 
new best score!!!!
Validation loss decreased (0.037578 --> 0.034563).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.365673542022705
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0347516  Vali Loss: 0.0352025 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911920  Vali macro F1 0.9904656 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.368232488632202
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0396591  Vali Loss: 0.0346922 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911598  Vali macro F1 0.9904755 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 3.3603649139404297
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0292018  Vali Loss: 0.0314833 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911895  Vali macro F1 0.9904797 
new best score!!!!
Validation loss decreased (0.034563 --> 0.031483).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.3629579544067383
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0291487  Vali Loss: 0.0285366 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924272  Vali macro F1 0.9918446 
new best score!!!!
Validation loss decreased (0.031483 --> 0.028537).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.363645315170288
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0246910  Vali Loss: 0.0294799 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924754  Vali macro F1 0.9918398 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.361612319946289
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0255621  Vali Loss: 0.0276745 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936985  Vali macro F1 0.9931748 
new best score!!!!
Validation loss decreased (0.028537 --> 0.027675).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.3631229400634766
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0238420  Vali Loss: 0.0305639 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899857  Vali macro F1 0.9891899 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.3678741455078125
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0248118  Vali Loss: 0.0283655 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924973  Vali macro F1 0.9919751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.3675901889801025
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0225376  Vali Loss: 0.0265492 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911499  Vali macro F1 0.9904832 
new best score!!!!
Validation loss decreased (0.027675 --> 0.026549).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.4227774143218994
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0199638  Vali Loss: 0.0253136 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950098  Vali macro F1 0.9947533 
new best score!!!!
Validation loss decreased (0.026549 --> 0.025314).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.4019625186920166
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0290201  Vali Loss: 0.0257428 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937051  Vali macro F1 0.9932997 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.364508867263794
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0237828  Vali Loss: 0.0268357 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924536  Vali macro F1 0.9918117 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 3.365034341812134
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0219751  Vali Loss: 0.0258310 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924519  Vali macro F1 0.9919552 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 3.3624510765075684
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0188224  Vali Loss: 0.0255667 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898747  Vali macro F1 0.9892705 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 3.3649163246154785
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0170009  Vali Loss: 0.0235735 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.025314 --> 0.023573).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.362107992172241
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0195261  Vali Loss: 0.0206472 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949706  Vali macro F1 0.9945184 
new best score!!!!
Validation loss decreased (0.023573 --> 0.020647).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.3676483631134033
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0434210  Vali Loss: 0.0296047 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884990  Vali macro F1 0.9878977 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.367154359817505
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0246040  Vali Loss: 0.0191716 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962360  Vali macro F1 0.9958716 
new best score!!!!
Validation loss decreased (0.020647 --> 0.019172).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.3656742572784424
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0201196  Vali Loss: 0.0203469 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937123  Vali macro F1 0.9934709 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 3.364384412765503
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0201929  Vali Loss: 0.0254906 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911569  Vali macro F1 0.9907194 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 3.3663949966430664
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0287695  Vali Loss: 0.0271899 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898805  Vali macro F1 0.9891543 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 3.3654963970184326
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0173557  Vali Loss: 0.0190190 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9959538 
new best score!!!!
Validation loss decreased (0.019172 --> 0.019019).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 3.3669917583465576
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0156208  Vali Loss: 0.0216674 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924524  Vali macro F1 0.9918241 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 3.3712821006774902
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0145613  Vali Loss: 0.0190500 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949810  Vali macro F1 0.9946150 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 3.367506742477417
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0127427  Vali Loss: 0.0175079 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.019019 --> 0.017508).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 3.424560785293579
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0131714  Vali Loss: 0.0252096 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949787  Vali macro F1 0.9947575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 3.389328956604004
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0166241  Vali Loss: 0.0191204 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9959538 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 3.3652312755584717
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0136474  Vali Loss: 0.0192461 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962608  Vali macro F1 0.9961029 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 3.364983320236206
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0184852  Vali Loss: 0.0203043 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937327  Vali macro F1 0.9932818 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 3.365239143371582
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0148336  Vali Loss: 0.0194418 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937560  Vali macro F1 0.9934185 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 59 cost time: 3.364345073699951
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0121668  Vali Loss: 0.0196936 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 3.361692190170288
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0111196  Vali Loss: 0.0188290 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 3.3653414249420166
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0112408  Vali Loss: 0.0188817 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 3.3714723587036133
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0106018  Vali Loss: 0.0192585 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 3.3632001876831055
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0105874  Vali Loss: 0.0193580 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 64 cost time: 3.3695080280303955
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0100654  Vali Loss: 0.0193654 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 3.3656694889068604
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0108078  Vali Loss: 0.0193800 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 3.3683228492736816
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0100419  Vali Loss: 0.0194056 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 3.368039131164551
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0108533  Vali Loss: 0.0194110 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 3.3776960372924805
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0105346  Vali Loss: 0.0193655 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950106  Vali macro F1 0.9947646 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8087719  Test weighted F1: 0.7710358  Test macro F1 0.7710358 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.843475103378296
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0120818  Vali Loss: 0.0187444 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962608  Vali macro F1 0.9961029 
Validation loss decreased (inf --> 0.018744).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.837030410766602
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0123344  Vali Loss: 0.0178714 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9959538 
new best score!!!!
Validation loss decreased (0.018744 --> 0.017871).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.837496042251587
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0121487  Vali Loss: 0.0173354 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9959538 
new best score!!!!
Validation loss decreased (0.017871 --> 0.017335).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.8313140869140625
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0111884  Vali Loss: 0.0172279 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9959538 
new best score!!!!
Validation loss decreased (0.017335 --> 0.017228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.838887453079224
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0114791  Vali Loss: 0.0175147 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962222  Vali macro F1 0.9959376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.831766843795776
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0106592  Vali Loss: 0.0160565 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.017228 --> 0.016056).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.833320617675781
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0105419  Vali Loss: 0.0160582 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9959538 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.828857183456421
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0105076  Vali Loss: 0.0161120 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 4.8328187465667725
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0106187  Vali Loss: 0.0159447 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.016056 --> 0.015945).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.822303771972656
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0104511  Vali Loss: 0.0156040 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.015945 --> 0.015604).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.81719708442688
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0094751  Vali Loss: 0.0150934 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.015604 --> 0.015093).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 7.478667259216309
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0101985  Vali Loss: 0.0157200 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.818066120147705
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0091777  Vali Loss: 0.0153177 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 4.819792985916138
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0086954  Vali Loss: 0.0153619 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 4.819777250289917
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0099533  Vali Loss: 0.0152687 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 4.819044351577759
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0086167  Vali Loss: 0.0170321 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962317  Vali macro F1 0.9959538 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 4.821457386016846
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0095523  Vali Loss: 0.0161244 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.818856954574585
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0091496  Vali Loss: 0.0151042 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 4.823280096054077
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0093845  Vali Loss: 0.0148256 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
new best score!!!!
Validation loss decreased (0.015093 --> 0.014826).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.82026481628418
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0104123  Vali Loss: 0.0171234 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949796  Vali macro F1 0.9946689 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.8220391273498535
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0088406  Vali Loss: 0.0172023 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950062  Vali macro F1 0.9947569 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.817717790603638
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0084557  Vali Loss: 0.0151562 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962343  Vali macro F1 0.9960151 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 4.81881046295166
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0081301  Vali Loss: 0.0153975 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 4.817994117736816
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0087034  Vali Loss: 0.0149495 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 4.81778883934021
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0079000  Vali Loss: 0.0149397 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.8199827671051025
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0078527  Vali Loss: 0.0148849 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 4.820022344589233
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0077028  Vali Loss: 0.0148819 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 4.817052602767944
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0081778  Vali Loss: 0.0148973 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 4.818063974380493
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0083805  Vali Loss: 0.0148847 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 4.824134111404419
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0075273  Vali Loss: 0.0148827 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 4.821693181991577
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0082196  Vali Loss: 0.0148840 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 4.819177865982056
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0074847  Vali Loss: 0.0148898 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 4.8226637840271
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0078729  Vali Loss: 0.0148894 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 4.819281578063965
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0079796  Vali Loss: 0.0148839 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974864  Vali macro F1 0.9973001 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8000000  Test weighted F1: 0.7537445  Test macro F1 0.7537445 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4659531116485596
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8546471  Vali Loss: 2.3719199 Vali Accuracy: 0.4899749  Vali weighted F1: 0.4457772  Vali macro F1 0.4466283 
Validation loss decreased (inf --> 2.371920).  Saving model ...
Epoch: 2 cost time: 3.3725175857543945
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7874146  Vali Loss: 1.3372568 Vali Accuracy: 0.7957393  Vali weighted F1: 0.7812841  Vali macro F1 0.7842315 
new best score!!!!
Validation loss decreased (2.371920 --> 1.337257).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3611505031585693
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.1101342  Vali Loss: 0.8517686 Vali Accuracy: 0.9110276  Vali weighted F1: 0.9060556  Vali macro F1 0.9037286 
new best score!!!!
Validation loss decreased (1.337257 --> 0.851769).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.364449977874756
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7587404  Vali Loss: 0.6119462 Vali Accuracy: 0.9310777  Vali weighted F1: 0.9305386  Vali macro F1 0.9289717 
new best score!!!!
Validation loss decreased (0.851769 --> 0.611946).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.364885091781616
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5598298  Vali Loss: 0.4513917 Vali Accuracy: 0.9548872  Vali weighted F1: 0.9535587  Vali macro F1 0.9518683 
new best score!!!!
Validation loss decreased (0.611946 --> 0.451392).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.363459825515747
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.4295976  Vali Loss: 0.3428712 Vali Accuracy: 0.9486216  Vali weighted F1: 0.9480271  Vali macro F1 0.9451791 
new best score!!!!
Validation loss decreased (0.451392 --> 0.342871).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.360393524169922
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3286494  Vali Loss: 0.2558815 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9708203  Vali macro F1 0.9691724 
new best score!!!!
Validation loss decreased (0.342871 --> 0.255882).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.363253116607666
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2561507  Vali Loss: 0.2063516 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9736240  Vali macro F1 0.9724543 
new best score!!!!
Validation loss decreased (0.255882 --> 0.206352).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3704357147216797
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2217551  Vali Loss: 0.1777162 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9733795  Vali macro F1 0.9721183 
new best score!!!!
Validation loss decreased (0.206352 --> 0.177716).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.364327907562256
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1833894  Vali Loss: 0.1421417 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9785595  Vali macro F1 0.9773913 
new best score!!!!
Validation loss decreased (0.177716 --> 0.142142).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.366075038909912
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1538606  Vali Loss: 0.1223869 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874205  Vali macro F1 0.9864975 
new best score!!!!
Validation loss decreased (0.142142 --> 0.122387).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3694043159484863
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1462809  Vali Loss: 0.1042271 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836252  Vali macro F1 0.9827745 
new best score!!!!
Validation loss decreased (0.122387 --> 0.104227).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.366936445236206
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1122160  Vali Loss: 0.0957044 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861626  Vali macro F1 0.9851585 
new best score!!!!
Validation loss decreased (0.104227 --> 0.095704).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3659093379974365
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.1027042  Vali Loss: 0.0857997 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848922  Vali macro F1 0.9837420 
new best score!!!!
Validation loss decreased (0.095704 --> 0.085800).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.379863977432251
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0990609  Vali Loss: 0.0830835 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823243  Vali macro F1 0.9808539 
new best score!!!!
Validation loss decreased (0.085800 --> 0.083083).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3714170455932617
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0878751  Vali Loss: 0.0756166 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861198  Vali macro F1 0.9851133 
new best score!!!!
Validation loss decreased (0.083083 --> 0.075617).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.377915859222412
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0703301  Vali Loss: 0.0744658 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823571  Vali macro F1 0.9810867 
new best score!!!!
Validation loss decreased (0.075617 --> 0.074466).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.426089286804199
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0628286  Vali Loss: 0.0655114 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874095  Vali macro F1 0.9864292 
new best score!!!!
Validation loss decreased (0.074466 --> 0.065511).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.4064078330993652
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0549614  Vali Loss: 0.0581702 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911920  Vali macro F1 0.9904656 
new best score!!!!
Validation loss decreased (0.065511 --> 0.058170).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.365084648132324
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0535256  Vali Loss: 0.0536943 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899260  Vali macro F1 0.9890980 
new best score!!!!
Validation loss decreased (0.058170 --> 0.053694).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3727099895477295
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0496657  Vali Loss: 0.0567576 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873626  Vali macro F1 0.9864499 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.3684136867523193
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0451721  Vali Loss: 0.0494729 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899260  Vali macro F1 0.9890980 
new best score!!!!
Validation loss decreased (0.053694 --> 0.049473).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3741605281829834
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0394942  Vali Loss: 0.0470581 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911920  Vali macro F1 0.9904656 
new best score!!!!
Validation loss decreased (0.049473 --> 0.047058).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3728835582733154
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0392933  Vali Loss: 0.0482567 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898845  Vali macro F1 0.9891638 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.3751747608184814
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0362245  Vali Loss: 0.0436569 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911920  Vali macro F1 0.9904656 
new best score!!!!
Validation loss decreased (0.047058 --> 0.043657).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.3716721534729004
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0388247  Vali Loss: 0.0437512 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924536  Vali macro F1 0.9918117 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.3700103759765625
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0340759  Vali Loss: 0.0412201 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898946  Vali macro F1 0.9891840 
new best score!!!!
Validation loss decreased (0.043657 --> 0.041220).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.372347116470337
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0316848  Vali Loss: 0.0414895 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911933  Vali macro F1 0.9906285 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.368255138397217
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0287646  Vali Loss: 0.0426834 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898946  Vali macro F1 0.9891840 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 3.3698878288269043
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0294083  Vali Loss: 0.0437263 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873788  Vali macro F1 0.9866302 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 3.373486042022705
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0302746  Vali Loss: 0.0417682 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 3.374326467514038
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0255897  Vali Loss: 0.0406316 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898946  Vali macro F1 0.9891840 
new best score!!!!
Validation loss decreased (0.041220 --> 0.040632).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.3842689990997314
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0260133  Vali Loss: 0.0361233 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924524  Vali macro F1 0.9918241 
new best score!!!!
Validation loss decreased (0.040632 --> 0.036123).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.4307804107666016
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0250854  Vali Loss: 0.0355511 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911920  Vali macro F1 0.9904656 
new best score!!!!
Validation loss decreased (0.036123 --> 0.035551).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.3787403106689453
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0215532  Vali Loss: 0.0327272 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899830  Vali macro F1 0.9893818 
new best score!!!!
Validation loss decreased (0.035551 --> 0.032727).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.3761909008026123
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0235116  Vali Loss: 0.0331875 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.372220039367676
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0210002  Vali Loss: 0.0368173 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898946  Vali macro F1 0.9891840 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.371476173400879
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0228602  Vali Loss: 0.0358163 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886516  Vali macro F1 0.9879799 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 3.3734099864959717
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0228371  Vali Loss: 0.0430897 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872851  Vali macro F1 0.9865679 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 3.371058225631714
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0268996  Vali Loss: 0.0350369 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 3.3815481662750244
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0189896  Vali Loss: 0.0343313 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.37066650390625
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0195573  Vali Loss: 0.0347678 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899184  Vali macro F1 0.9893620 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 3.371983289718628
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0181685  Vali Loss: 0.0337738 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 3.372534990310669
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0185353  Vali Loss: 0.0313179 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
new best score!!!!
Validation loss decreased (0.032727 --> 0.031318).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.3723106384277344
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0192434  Vali Loss: 0.0336610 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.3703196048736572
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0179720  Vali Loss: 0.0358392 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886412  Vali macro F1 0.9880007 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.38252854347229
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0175548  Vali Loss: 0.0348157 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899184  Vali macro F1 0.9893620 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 3.377300977706909
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0173066  Vali Loss: 0.0337329 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 3.4227523803710938
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0168838  Vali Loss: 0.0347376 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 3.374173641204834
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0173458  Vali Loss: 0.0347692 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 3.4066531658172607
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0171835  Vali Loss: 0.0348561 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 3.3688387870788574
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0168905  Vali Loss: 0.0345647 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 3.3727946281433105
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0165466  Vali Loss: 0.0343251 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 3.3712830543518066
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0166171  Vali Loss: 0.0346371 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 3.3681278228759766
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0172378  Vali Loss: 0.0346091 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 3.3668212890625
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0169813  Vali Loss: 0.0346019 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 3.3719258308410645
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0169846  Vali Loss: 0.0346018 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 3.36763072013855
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0196387  Vali Loss: 0.0346046 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 3.3682541847229004
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0169324  Vali Loss: 0.0345787 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8412281  Test weighted F1: 0.7875927  Test macro F1 0.7875927 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.762367010116577
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0176475  Vali Loss: 0.0349476 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898946  Vali macro F1 0.9891840 
Validation loss decreased (inf --> 0.034948).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.753698825836182
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0173682  Vali Loss: 0.0309995 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
new best score!!!!
Validation loss decreased (0.034948 --> 0.031000).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.7586753368377686
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0174872  Vali Loss: 0.0351328 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898946  Vali macro F1 0.9891840 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.758170127868652
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0161461  Vali Loss: 0.0328935 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924509  Vali macro F1 0.9919117 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 4.7594099044799805
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0160332  Vali Loss: 0.0326766 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924509  Vali macro F1 0.9919117 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 4.75446081161499
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0153958  Vali Loss: 0.0328960 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 4.757959842681885
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0151330  Vali Loss: 0.0291084 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
new best score!!!!
Validation loss decreased (0.031000 --> 0.029108).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.757395505905151
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0145476  Vali Loss: 0.0296272 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.754252195358276
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0144616  Vali Loss: 0.0312287 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 4.754578351974487
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0138482  Vali Loss: 0.0311188 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 4.754091024398804
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0138800  Vali Loss: 0.0288119 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
new best score!!!!
Validation loss decreased (0.029108 --> 0.028812).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.758176326751709
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0138136  Vali Loss: 0.0280243 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
new best score!!!!
Validation loss decreased (0.028812 --> 0.028024).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.756365537643433
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0138831  Vali Loss: 0.0301107 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924509  Vali macro F1 0.9919117 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.759866714477539
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0131165  Vali Loss: 0.0286732 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.754436254501343
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0144525  Vali Loss: 0.0300782 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.7568745613098145
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0130106  Vali Loss: 0.0290260 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 4.755737781524658
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0120585  Vali Loss: 0.0296235 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 4.755505561828613
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0123816  Vali Loss: 0.0318749 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924509  Vali macro F1 0.9919117 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.755414724349976
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0123087  Vali Loss: 0.0244305 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924509  Vali macro F1 0.9919117 
new best score!!!!
Validation loss decreased (0.028024 --> 0.024431).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.7399516105651855
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0128893  Vali Loss: 0.0288586 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.739057779312134
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0118381  Vali Loss: 0.0317518 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.746790170669556
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0120377  Vali Loss: 0.0279175 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 4.743024110794067
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0112090  Vali Loss: 0.0259128 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 4.743450164794922
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0109541  Vali Loss: 0.0229439 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
new best score!!!!
Validation loss decreased (0.024431 --> 0.022944).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.741051435470581
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0118560  Vali Loss: 0.0290350 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.74547266960144
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0111215  Vali Loss: 0.0284612 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924362  Vali macro F1 0.9918866 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 4.741889476776123
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0110360  Vali Loss: 0.0280362 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937056  Vali macro F1 0.9932580 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 4.750897169113159
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0152219  Vali Loss: 0.0290361 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911815  Vali macro F1 0.9905403 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 4.7496325969696045
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0133193  Vali Loss: 0.0285171 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 30 cost time: 4.747738361358643
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0109038  Vali Loss: 0.0283299 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899045  Vali macro F1 0.9891762 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 4.747973680496216
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0108042  Vali Loss: 0.0281744 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911719  Vali macro F1 0.9905453 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 4.747747898101807
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0109304  Vali Loss: 0.0280667 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 4.741165637969971
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0112619  Vali Loss: 0.0280299 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 4.744900226593018
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0102172  Vali Loss: 0.0279774 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911593  Vali macro F1 0.9905225 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 35 cost time: 4.7466559410095215
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0128928  Vali Loss: 0.0279623 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 4.75076150894165
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0108684  Vali Loss: 0.0279886 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 4.750574588775635
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0111374  Vali Loss: 0.0279587 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 4.749231338500977
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0105976  Vali Loss: 0.0279395 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 4.750931024551392
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0099301  Vali Loss: 0.0279166 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924266  Vali macro F1 0.9918916 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8561404  Test weighted F1: 0.8150855  Test macro F1 0.8150855 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4443166255950928
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8883133  Vali Loss: 2.5184244 Vali Accuracy: 0.4448622  Vali weighted F1: 0.4020930  Vali macro F1 0.4049318 
Validation loss decreased (inf --> 2.518424).  Saving model ...
Epoch: 2 cost time: 3.3712193965911865
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8569528  Vali Loss: 1.3038958 Vali Accuracy: 0.7982456  Vali weighted F1: 0.7788522  Vali macro F1 0.7817944 
new best score!!!!
Validation loss decreased (2.518424 --> 1.303896).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3757131099700928
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0739832  Vali Loss: 0.8269428 Vali Accuracy: 0.8771930  Vali weighted F1: 0.8704902  Vali macro F1 0.8709815 
new best score!!!!
Validation loss decreased (1.303896 --> 0.826943).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.375941753387451
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7182023  Vali Loss: 0.5615421 Vali Accuracy: 0.9285714  Vali weighted F1: 0.9281043  Vali macro F1 0.9278068 
new best score!!!!
Validation loss decreased (0.826943 --> 0.561542).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3768880367279053
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5197274  Vali Loss: 0.4172634 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9562974  Vali macro F1 0.9561394 
new best score!!!!
Validation loss decreased (0.561542 --> 0.417263).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3759372234344482
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3993216  Vali Loss: 0.3195313 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9631349  Vali macro F1 0.9624808 
new best score!!!!
Validation loss decreased (0.417263 --> 0.319531).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3771708011627197
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3120442  Vali Loss: 0.2583189 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9684860  Vali macro F1 0.9684279 
new best score!!!!
Validation loss decreased (0.319531 --> 0.258319).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.378024101257324
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2521454  Vali Loss: 0.2039033 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9738226  Vali macro F1 0.9734443 
new best score!!!!
Validation loss decreased (0.258319 --> 0.203903).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3755943775177
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2098543  Vali Loss: 0.1663551 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9838641  Vali macro F1 0.9831785 
new best score!!!!
Validation loss decreased (0.203903 --> 0.166355).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.372349262237549
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1772232  Vali Loss: 0.1396774 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851082  Vali macro F1 0.9844604 
new best score!!!!
Validation loss decreased (0.166355 --> 0.139677).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.36906099319458
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1436130  Vali Loss: 0.1168571 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900652  Vali macro F1 0.9897577 
new best score!!!!
Validation loss decreased (0.139677 --> 0.116857).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3690459728240967
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1232827  Vali Loss: 0.1008290 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925416  Vali macro F1 0.9924349 
new best score!!!!
Validation loss decreased (0.116857 --> 0.100829).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3748788833618164
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1130014  Vali Loss: 0.0930264 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900150  Vali macro F1 0.9900331 
new best score!!!!
Validation loss decreased (0.100829 --> 0.093026).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3802082538604736
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0987665  Vali Loss: 0.0788191 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9914123  Vali macro F1 0.9915503 
new best score!!!!
Validation loss decreased (0.093026 --> 0.078819).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.373116970062256
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0937618  Vali Loss: 0.0762221 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876176  Vali macro F1 0.9873072 
new best score!!!!
Validation loss decreased (0.078819 --> 0.076222).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.421177625656128
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0806966  Vali Loss: 0.0718243 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875123  Vali macro F1 0.9870596 
new best score!!!!
Validation loss decreased (0.076222 --> 0.071824).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.4095146656036377
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0688651  Vali Loss: 0.0604906 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912767  Vali macro F1 0.9911042 
new best score!!!!
Validation loss decreased (0.071824 --> 0.060491).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.369887351989746
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0645260  Vali Loss: 0.0586728 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886521  Vali macro F1 0.9883091 
new best score!!!!
Validation loss decreased (0.060491 --> 0.058673).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.372434616088867
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0579629  Vali Loss: 0.0521418 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925239  Vali macro F1 0.9924304 
new best score!!!!
Validation loss decreased (0.058673 --> 0.052142).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.3702681064605713
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0559163  Vali Loss: 0.0509131 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899300  Vali macro F1 0.9892420 
new best score!!!!
Validation loss decreased (0.052142 --> 0.050913).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.376875162124634
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0544091  Vali Loss: 0.0484950 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899644  Vali macro F1 0.9897051 
new best score!!!!
Validation loss decreased (0.050913 --> 0.048495).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.369657278060913
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0449114  Vali Loss: 0.0456348 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899644  Vali macro F1 0.9897051 
new best score!!!!
Validation loss decreased (0.048495 --> 0.045635).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3711459636688232
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0433157  Vali Loss: 0.0360556 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962620  Vali macro F1 0.9962010 
new best score!!!!
Validation loss decreased (0.045635 --> 0.036056).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3793575763702393
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0376985  Vali Loss: 0.0384767 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925108  Vali macro F1 0.9922107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.3700366020202637
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0362949  Vali Loss: 0.0353450 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950331  Vali macro F1 0.9953246 
new best score!!!!
Validation loss decreased (0.036056 --> 0.035345).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.3734936714172363
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0363512  Vali Loss: 0.0318347 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962271  Vali macro F1 0.9959594 
new best score!!!!
Validation loss decreased (0.035345 --> 0.031835).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3743937015533447
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0355457  Vali Loss: 0.0341110 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.3733620643615723
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0344093  Vali Loss: 0.0275367 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.031835 --> 0.027537).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.3660874366760254
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0299588  Vali Loss: 0.0313197 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925108  Vali macro F1 0.9922107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.3717451095581055
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0288988  Vali Loss: 0.0248828 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962701  Vali macro F1 0.9964320 
new best score!!!!
Validation loss decreased (0.027537 --> 0.024883).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.376999616622925
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0270825  Vali Loss: 0.0209148 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962457  Vali macro F1 0.9964115 
new best score!!!!
Validation loss decreased (0.024883 --> 0.020915).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.37827467918396
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0260158  Vali Loss: 0.0223936 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949963  Vali macro F1 0.9950769 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.405550956726074
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0254384  Vali Loss: 0.0222322 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950194  Vali macro F1 0.9950930 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 3.4177510738372803
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0270236  Vali Loss: 0.0195429 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949963  Vali macro F1 0.9950769 
new best score!!!!
Validation loss decreased (0.020915 --> 0.019543).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.379889488220215
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0253058  Vali Loss: 0.0177278 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962457  Vali macro F1 0.9964115 
new best score!!!!
Validation loss decreased (0.019543 --> 0.017728).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.3703958988189697
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0227488  Vali Loss: 0.0242394 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950380  Vali macro F1 0.9951044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.372636318206787
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0237618  Vali Loss: 0.0890956 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9796248  Vali macro F1 0.9799357 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.3731019496917725
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0343594  Vali Loss: 0.0208022 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962325  Vali macro F1 0.9961704 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 3.3717923164367676
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0212740  Vali Loss: 0.0280354 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925108  Vali macro F1 0.9922107 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 3.3741016387939453
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0204232  Vali Loss: 0.0217981 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974978  Vali macro F1 0.9973244 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 3.3724300861358643
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0184218  Vali Loss: 0.0214950 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.3720860481262207
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0175791  Vali Loss: 0.0217184 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 3.3716800212860107
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0165228  Vali Loss: 0.0219726 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 3.371716260910034
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0174757  Vali Loss: 0.0224981 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 3.3730132579803467
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0164149  Vali Loss: 0.0232708 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 3.4814651012420654
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0162933  Vali Loss: 0.0235101 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 3.3738934993743896
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0163060  Vali Loss: 0.0234372 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 3.42586088180542
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0159760  Vali Loss: 0.0233208 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 3.408911943435669
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0163865  Vali Loss: 0.0233445 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 3.3742892742156982
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0152503  Vali Loss: 0.0232101 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950070  Vali macro F1 0.9948680 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9315789  Test weighted F1: 0.9251804  Test macro F1 0.9251804 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.798383951187134
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0202426  Vali Loss: 0.0192761 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
Validation loss decreased (inf --> 0.019276).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.792487859725952
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0198813  Vali Loss: 0.0165648 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.019276 --> 0.016565).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.793455362319946
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0179474  Vali Loss: 0.0157118 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962457  Vali macro F1 0.9964115 
new best score!!!!
Validation loss decreased (0.016565 --> 0.015712).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.794872283935547
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0179774  Vali Loss: 0.0170940 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.79083514213562
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0170675  Vali Loss: 0.0159694 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 4.793232679367065
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0168442  Vali Loss: 0.0160352 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 4.7912421226501465
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0157797  Vali Loss: 0.0154146 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.015712 --> 0.015415).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.794536352157593
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0160539  Vali Loss: 0.0144945 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9961988 
new best score!!!!
Validation loss decreased (0.015415 --> 0.014494).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.791116714477539
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0151643  Vali Loss: 0.0133590 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974961  Vali macro F1 0.9975339 
new best score!!!!
Validation loss decreased (0.014494 --> 0.013359).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.793630123138428
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0171274  Vali Loss: 0.0182072 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 4.7940778732299805
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0157656  Vali Loss: 0.0172612 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 4.785517454147339
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0139763  Vali Loss: 0.0176323 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 4.785844564437866
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0146339  Vali Loss: 0.0175488 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 4.782050609588623
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0135034  Vali Loss: 0.0187886 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 4.784593105316162
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0131192  Vali Loss: 0.0178314 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.786531925201416
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0145066  Vali Loss: 0.0193086 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 4.782399892807007
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0151673  Vali Loss: 0.0169516 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949968  Vali macro F1 0.9948674 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 4.776416063308716
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0157280  Vali Loss: 0.0134103 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937590  Vali macro F1 0.9935380 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 4.779568910598755
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0148357  Vali Loss: 0.0189716 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 4.780395269393921
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0128846  Vali Loss: 0.0186906 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.780150651931763
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0129496  Vali Loss: 0.0182745 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.782113313674927
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0126106  Vali Loss: 0.0182858 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 4.776540756225586
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0127510  Vali Loss: 0.0185819 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 4.781903982162476
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0122529  Vali Loss: 0.0186410 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937468  Vali macro F1 0.9935382 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9114035  Test weighted F1: 0.8948532  Test macro F1 0.8948532 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.420863628387451
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8645425  Vali Loss: 2.4050725 Vali Accuracy: 0.4912281  Vali weighted F1: 0.4422640  Vali macro F1 0.4437137 
Validation loss decreased (inf --> 2.405073).  Saving model ...
Epoch: 2 cost time: 3.358912706375122
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7870466  Vali Loss: 1.2749785 Vali Accuracy: 0.7882206  Vali weighted F1: 0.7547183  Vali macro F1 0.7609573 
new best score!!!!
Validation loss decreased (2.405073 --> 1.274978).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.363568067550659
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0799785  Vali Loss: 0.8380068 Vali Accuracy: 0.9010025  Vali weighted F1: 0.8977321  Vali macro F1 0.8935705 
new best score!!!!
Validation loss decreased (1.274978 --> 0.838007).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3581223487854004
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7362275  Vali Loss: 0.5863155 Vali Accuracy: 0.9135338  Vali weighted F1: 0.9145077  Vali macro F1 0.9133857 
new best score!!!!
Validation loss decreased (0.838007 --> 0.586315).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.359257459640503
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5299111  Vali Loss: 0.4041860 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9529164  Vali macro F1 0.9517757 
new best score!!!!
Validation loss decreased (0.586315 --> 0.404186).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.357494592666626
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3998567  Vali Loss: 0.3138964 Vali Accuracy: 0.9548872  Vali weighted F1: 0.9541957  Vali macro F1 0.9541173 
new best score!!!!
Validation loss decreased (0.404186 --> 0.313896).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3675124645233154
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3071668  Vali Loss: 0.2431712 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9728328  Vali macro F1 0.9717386 
new best score!!!!
Validation loss decreased (0.313896 --> 0.243171).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3632912635803223
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2440219  Vali Loss: 0.1994310 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9759386  Vali macro F1 0.9751037 
new best score!!!!
Validation loss decreased (0.243171 --> 0.199431).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.4078903198242188
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2126890  Vali Loss: 0.1603917 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9770174  Vali macro F1 0.9757720 
new best score!!!!
Validation loss decreased (0.199431 --> 0.160392).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.402432680130005
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1733997  Vali Loss: 0.1347724 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811661  Vali macro F1 0.9798476 
new best score!!!!
Validation loss decreased (0.160392 --> 0.134772).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3783481121063232
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1386396  Vali Loss: 0.1126584 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836515  Vali macro F1 0.9825356 
new best score!!!!
Validation loss decreased (0.134772 --> 0.112658).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.372058629989624
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1192105  Vali Loss: 0.1128025 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9796770  Vali macro F1 0.9784731 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 3.3659250736236572
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1056657  Vali Loss: 0.0912369 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861340  Vali macro F1 0.9851777 
new best score!!!!
Validation loss decreased (0.112658 --> 0.091237).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3657100200653076
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.1013312  Vali Loss: 0.0799395 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849278  Vali macro F1 0.9837705 
new best score!!!!
Validation loss decreased (0.091237 --> 0.079940).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.365436315536499
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0858253  Vali Loss: 0.0702823 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899671  Vali macro F1 0.9892998 
new best score!!!!
Validation loss decreased (0.079940 --> 0.070282).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.364609718322754
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0731234  Vali Loss: 0.0647351 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862756  Vali macro F1 0.9856414 
new best score!!!!
Validation loss decreased (0.070282 --> 0.064735).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.3657422065734863
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0677906  Vali Loss: 0.0602090 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874216  Vali macro F1 0.9864777 
new best score!!!!
Validation loss decreased (0.064735 --> 0.060209).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.360109806060791
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0635398  Vali Loss: 0.0551834 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912427  Vali macro F1 0.9906430 
new best score!!!!
Validation loss decreased (0.060209 --> 0.055183).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3675787448883057
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0548056  Vali Loss: 0.0518318 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899820  Vali macro F1 0.9892979 
new best score!!!!
Validation loss decreased (0.055183 --> 0.051832).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.363328218460083
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0558065  Vali Loss: 0.0565177 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861409  Vali macro F1 0.9851303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 3.3632566928863525
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0467544  Vali Loss: 0.0532091 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861745  Vali macro F1 0.9852804 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 3.3622853755950928
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0459752  Vali Loss: 0.0496009 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886798  Vali macro F1 0.9877980 
new best score!!!!
Validation loss decreased (0.051832 --> 0.049601).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.371776580810547
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0420618  Vali Loss: 0.0417737 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912007  Vali macro F1 0.9906154 
new best score!!!!
Validation loss decreased (0.049601 --> 0.041774).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3735511302948
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0391767  Vali Loss: 0.0498788 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884504  Vali macro F1 0.9874951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.3648648262023926
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0417027  Vali Loss: 0.0332379 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924442  Vali macro F1 0.9918260 
new best score!!!!
Validation loss decreased (0.041774 --> 0.033238).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4228098392486572
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0342290  Vali Loss: 0.0334347 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937621  Vali macro F1 0.9935145 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.393209218978882
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0335116  Vali Loss: 0.0340390 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887180  Vali macro F1 0.9879657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 3.363513946533203
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0333820  Vali Loss: 0.0531067 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860836  Vali macro F1 0.9851207 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 3.3667430877685547
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0317817  Vali Loss: 0.0310991 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.033238 --> 0.031099).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.367248296737671
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0283271  Vali Loss: 0.0310234 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925084  Vali macro F1 0.9921000 
new best score!!!!
Validation loss decreased (0.031099 --> 0.031023).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.364877939224243
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0258876  Vali Loss: 0.0328764 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925064  Vali macro F1 0.9920844 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 3.367152214050293
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0256862  Vali Loss: 0.0366543 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899671  Vali macro F1 0.9892998 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 3.3657214641571045
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0272619  Vali Loss: 0.0298773 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924971  Vali macro F1 0.9920610 
new best score!!!!
Validation loss decreased (0.031023 --> 0.029877).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.365743398666382
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0253469  Vali Loss: 0.0361310 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9893040 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.371479034423828
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0232147  Vali Loss: 0.0263918 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
new best score!!!!
Validation loss decreased (0.029877 --> 0.026392).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.3666629791259766
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0211006  Vali Loss: 0.0299218 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937513  Vali macro F1 0.9934379 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.3661139011383057
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0220998  Vali Loss: 0.0248054 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949706  Vali macro F1 0.9945184 
new best score!!!!
Validation loss decreased (0.026392 --> 0.024805).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.417555332183838
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0281637  Vali Loss: 0.0224063 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.024805 --> 0.022406).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.391749620437622
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0210489  Vali Loss: 0.0232927 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937181  Vali macro F1 0.9932539 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.367680072784424
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0227087  Vali Loss: 0.0231646 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949955  Vali macro F1 0.9946488 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 3.406625747680664
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0172230  Vali Loss: 0.0210618 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.022406 --> 0.021062).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.406003713607788
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0155107  Vali Loss: 0.0211128 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962442  Vali macro F1 0.9959795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.3705434799194336
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0176593  Vali Loss: 0.0290605 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911369  Vali macro F1 0.9903570 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.364870309829712
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0219877  Vali Loss: 0.0246530 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937352  Vali macro F1 0.9933291 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 3.36346697807312
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0166852  Vali Loss: 0.0219829 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 3.3631014823913574
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0163816  Vali Loss: 0.0218062 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950099  Vali macro F1 0.9947675 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 3.3629508018493652
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0157322  Vali Loss: 0.0200608 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
new best score!!!!
Validation loss decreased (0.021062 --> 0.020061).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.364675998687744
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0133490  Vali Loss: 0.0205000 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.363539218902588
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0127758  Vali Loss: 0.0211802 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.3669986724853516
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0126111  Vali Loss: 0.0210510 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.373476266860962
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0127195  Vali Loss: 0.0214309 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 3.367654800415039
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0125756  Vali Loss: 0.0226786 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 3.3656623363494873
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0116765  Vali Loss: 0.0225876 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.36909556388855
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0124010  Vali Loss: 0.0226572 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.3729286193847656
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0126413  Vali Loss: 0.0226848 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.420302391052246
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0124692  Vali Loss: 0.0226875 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 3.4054789543151855
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0132882  Vali Loss: 0.0227265 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 3.365777015686035
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0139351  Vali Loss: 0.0227111 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.377758026123047
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0124471  Vali Loss: 0.0226979 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 3.3662736415863037
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0128733  Vali Loss: 0.0226992 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 3.3658955097198486
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0119276  Vali Loss: 0.0226830 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 3.3689422607421875
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0123203  Vali Loss: 0.0226759 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8982456  Test weighted F1: 0.8898860  Test macro F1 0.8898860 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.781328201293945
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0129002  Vali Loss: 0.0203122 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
Validation loss decreased (inf --> 0.020312).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.781507253646851
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0131655  Vali Loss: 0.0211229 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.783338785171509
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0119642  Vali Loss: 0.0236512 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.782855272293091
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0115384  Vali Loss: 0.0211881 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 4.779786109924316
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0115422  Vali Loss: 0.0204676 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 4.781586408615112
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0115549  Vali Loss: 0.0202584 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
new best score!!!!
Validation loss decreased (0.020312 --> 0.020258).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.781082630157471
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0107596  Vali Loss: 0.0239816 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.78821873664856
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0113331  Vali Loss: 0.0194358 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
new best score!!!!
Validation loss decreased (0.020258 --> 0.019436).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.785871267318726
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0105953  Vali Loss: 0.0195932 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.779665946960449
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0103631  Vali Loss: 0.0196356 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 4.7781453132629395
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0107779  Vali Loss: 0.0201240 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 4.7829461097717285
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0104960  Vali Loss: 0.0175564 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
new best score!!!!
Validation loss decreased (0.019436 --> 0.017556).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.7764668464660645
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0097466  Vali Loss: 0.0155237 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.017556 --> 0.015524).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.781508922576904
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0103797  Vali Loss: 0.0216894 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950108  Vali macro F1 0.9947788 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.781836748123169
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0101765  Vali Loss: 0.0191705 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 4.779625415802002
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0097047  Vali Loss: 0.0192481 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 4.779209136962891
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0089080  Vali Loss: 0.0185639 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949840  Vali macro F1 0.9946353 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 4.778761863708496
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0098617  Vali Loss: 0.0191247 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 4.7816362380981445
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0088822  Vali Loss: 0.0188579 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 4.782888412475586
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0088082  Vali Loss: 0.0213670 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 4.780374526977539
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0086484  Vali Loss: 0.0208060 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 4.778364181518555
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0096586  Vali Loss: 0.0224134 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 4.781779766082764
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0091697  Vali Loss: 0.0222585 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 4.776540040969849
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0090748  Vali Loss: 0.0221668 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 4.768108129501343
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0099333  Vali Loss: 0.0221162 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 4.770240545272827
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0093864  Vali Loss: 0.0219295 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 4.768959045410156
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0102820  Vali Loss: 0.0220856 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 4.7705442905426025
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0091876  Vali Loss: 0.0220222 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937611  Vali macro F1 0.9934307 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8947368  Test weighted F1: 0.8809978  Test macro F1 0.8809978 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00265957 0.00257732 0.0026738  0.00259067 0.00265957 0.00271003
 0.00260417 0.00265252 0.00265252 0.00265252 0.00266667 0.00273973
 0.00262467 0.00263158 0.00268817 0.00263158 0.00261097 0.0026455
 0.00260417]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.443868637084961
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8576722  Vali Loss: 2.3733869 Vali Accuracy: 0.5175439  Vali weighted F1: 0.4656604  Vali macro F1 0.4689868 
Validation loss decreased (inf --> 2.373387).  Saving model ...
Epoch: 2 cost time: 3.4202687740325928
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7730738  Vali Loss: 1.3084797 Vali Accuracy: 0.8258145  Vali weighted F1: 0.7967936  Vali macro F1 0.8048402 
new best score!!!!
Validation loss decreased (2.373387 --> 1.308480).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3993704319000244
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0696217  Vali Loss: 0.8603249 Vali Accuracy: 0.8922306  Vali weighted F1: 0.8913917  Vali macro F1 0.8933803 
new best score!!!!
Validation loss decreased (1.308480 --> 0.860325).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.365901470184326
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7207135  Vali Loss: 0.6005215 Vali Accuracy: 0.9110276  Vali weighted F1: 0.9083219  Vali macro F1 0.9101849 
new best score!!!!
Validation loss decreased (0.860325 --> 0.600521).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.367682933807373
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5137080  Vali Loss: 0.4324748 Vali Accuracy: 0.9411028  Vali weighted F1: 0.9397892  Vali macro F1 0.9403254 
new best score!!!!
Validation loss decreased (0.600521 --> 0.432475).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3564114570617676
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3886387  Vali Loss: 0.3162711 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9502362  Vali macro F1 0.9509500 
new best score!!!!
Validation loss decreased (0.432475 --> 0.316271).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3547065258026123
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2985108  Vali Loss: 0.2507520 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9631835  Vali macro F1 0.9636427 
new best score!!!!
Validation loss decreased (0.316271 --> 0.250752).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3519909381866455
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2403850  Vali Loss: 0.2027584 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9706893  Vali macro F1 0.9706398 
new best score!!!!
Validation loss decreased (0.250752 --> 0.202758).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3550467491149902
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2004453  Vali Loss: 0.1637984 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9746959  Vali macro F1 0.9742653 
new best score!!!!
Validation loss decreased (0.202758 --> 0.163798).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.357666015625
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1728960  Vali Loss: 0.1449304 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9782702  Vali macro F1 0.9778460 
new best score!!!!
Validation loss decreased (0.163798 --> 0.144930).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3602168560028076
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1577284  Vali Loss: 0.1215166 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809031  Vali macro F1 0.9805499 
new best score!!!!
Validation loss decreased (0.144930 --> 0.121517).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3579177856445312
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1294404  Vali Loss: 0.1060221 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899023  Vali macro F1 0.9895084 
new best score!!!!
Validation loss decreased (0.121517 --> 0.106022).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.363452196121216
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1066649  Vali Loss: 0.0984891 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822707  Vali macro F1 0.9819001 
new best score!!!!
Validation loss decreased (0.106022 --> 0.098489).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.355607509613037
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0937693  Vali Loss: 0.0845412 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861000  Vali macro F1 0.9858286 
new best score!!!!
Validation loss decreased (0.098489 --> 0.084541).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3672730922698975
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0949146  Vali Loss: 0.0769770 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873839  Vali macro F1 0.9868283 
new best score!!!!
Validation loss decreased (0.084541 --> 0.076977).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.365720272064209
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0775542  Vali Loss: 0.0698540 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898797  Vali macro F1 0.9895894 
new best score!!!!
Validation loss decreased (0.076977 --> 0.069854).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.4103829860687256
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0694429  Vali Loss: 0.0584992 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911009  Vali macro F1 0.9904121 
new best score!!!!
Validation loss decreased (0.069854 --> 0.058499).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3993873596191406
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0684802  Vali Loss: 0.0510494 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937176  Vali macro F1 0.9934669 
new best score!!!!
Validation loss decreased (0.058499 --> 0.051049).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.361698627471924
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0769621  Vali Loss: 0.0582927 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898357  Vali macro F1 0.9892471 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.3557183742523193
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0570468  Vali Loss: 0.0496698 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899869  Vali macro F1 0.9892879 
new best score!!!!
Validation loss decreased (0.051049 --> 0.049670).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.363062858581543
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0486292  Vali Loss: 0.0446719 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911861  Vali macro F1 0.9904700 
new best score!!!!
Validation loss decreased (0.049670 --> 0.044672).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.359734058380127
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0451548  Vali Loss: 0.0437460 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911808  Vali macro F1 0.9904841 
new best score!!!!
Validation loss decreased (0.044672 --> 0.043746).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3604249954223633
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0401814  Vali Loss: 0.0360750 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924467  Vali macro F1 0.9918119 
new best score!!!!
Validation loss decreased (0.043746 --> 0.036075).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.360957145690918
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0379432  Vali Loss: 0.0367621 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912723  Vali macro F1 0.9908582 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.359729766845703
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0366668  Vali Loss: 0.0345770 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912366  Vali macro F1 0.9906188 
new best score!!!!
Validation loss decreased (0.036075 --> 0.034577).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.361746072769165
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0373583  Vali Loss: 0.0309131 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9946001 
new best score!!!!
Validation loss decreased (0.034577 --> 0.030913).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3587710857391357
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0342407  Vali Loss: 0.0349883 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911808  Vali macro F1 0.9904841 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.360729217529297
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0318212  Vali Loss: 0.0310909 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924933  Vali macro F1 0.9919732 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 3.3641602993011475
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0269502  Vali Loss: 0.0264492 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
new best score!!!!
Validation loss decreased (0.030913 --> 0.026449).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.366908550262451
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0266350  Vali Loss: 0.0307955 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924812  Vali macro F1 0.9919421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 3.364381790161133
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0240972  Vali Loss: 0.0256472 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9932991 
new best score!!!!
Validation loss decreased (0.026449 --> 0.025647).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.370055913925171
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0299726  Vali Loss: 0.0373069 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860381  Vali macro F1 0.9855214 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.4183638095855713
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.1154098  Vali Loss: 0.0556137 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872930  Vali macro F1 0.9866875 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 3.3793575763702393
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0475529  Vali Loss: 0.0371286 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911300  Vali macro F1 0.9904804 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 3.3743467330932617
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0330029  Vali Loss: 0.0289398 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937067  Vali macro F1 0.9933015 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 3.3655824661254883
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0282103  Vali Loss: 0.0275526 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 3.3674569129943848
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0252988  Vali Loss: 0.0244081 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.025647 --> 0.024408).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.3638625144958496
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0242741  Vali Loss: 0.0239442 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.024408 --> 0.023944).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.3636722564697266
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0227595  Vali Loss: 0.0254706 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.3647968769073486
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0226204  Vali Loss: 0.0239193 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.023944 --> 0.023919).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.363386392593384
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0235112  Vali Loss: 0.0244372 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.3669204711914062
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0220488  Vali Loss: 0.0248575 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 3.3620262145996094
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0209691  Vali Loss: 0.0242345 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 3.365412712097168
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0217717  Vali Loss: 0.0247398 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 3.3683626651763916
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0234189  Vali Loss: 0.0257816 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 3.370359420776367
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0206555  Vali Loss: 0.0255787 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 3.3656928539276123
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0221076  Vali Loss: 0.0253182 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 3.405283212661743
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0206988  Vali Loss: 0.0248978 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 3.4091668128967285
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0207287  Vali Loss: 0.0250953 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 3.37005877494812
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0217060  Vali Loss: 0.0249047 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 3.3653478622436523
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0198783  Vali Loss: 0.0248969 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 3.365079641342163
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0214623  Vali Loss: 0.0248948 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 3.3712708950042725
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0221963  Vali Loss: 0.0248334 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 3.3642866611480713
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0206662  Vali Loss: 0.0248339 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 3.3671553134918213
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0214643  Vali Loss: 0.0248701 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8122807  Test weighted F1: 0.7875422  Test macro F1 0.7875422 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.810954570770264
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0222986  Vali Loss: 0.0240993 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911290  Vali macro F1 0.9905691 
Validation loss decreased (inf --> 0.024099).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.8136091232299805
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0214659  Vali Loss: 0.0270711 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897995  Vali macro F1 0.9890634 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.807255029678345
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0200816  Vali Loss: 0.0239144 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
new best score!!!!
Validation loss decreased (0.024099 --> 0.023914).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.809244394302368
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0253279  Vali Loss: 0.0237581 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
new best score!!!!
Validation loss decreased (0.023914 --> 0.023758).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.814771413803101
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0192621  Vali Loss: 0.0224041 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
new best score!!!!
Validation loss decreased (0.023758 --> 0.022404).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.816964626312256
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0226293  Vali Loss: 0.0201206 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.022404 --> 0.020121).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.819593191146851
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0182227  Vali Loss: 0.0245086 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911307  Vali macro F1 0.9904256 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.809194564819336
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0188475  Vali Loss: 0.0200448 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.020121 --> 0.020045).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.8070080280303955
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0164760  Vali Loss: 0.0207681 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924082  Vali macro F1 0.9919294 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.811152935028076
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0166979  Vali Loss: 0.0247903 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897639  Vali macro F1 0.9891251 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 4.808620929718018
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0204936  Vali Loss: 0.0227455 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9897639  Vali macro F1 0.9891251 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 4.81044340133667
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0156687  Vali Loss: 0.0203801 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924082  Vali macro F1 0.9919294 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 4.807354927062988
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0146271  Vali Loss: 0.0175844 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
new best score!!!!
Validation loss decreased (0.020045 --> 0.017584).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.8091418743133545
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0146384  Vali Loss: 0.0166783 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.017584 --> 0.016678).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.801765441894531
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0140580  Vali Loss: 0.0182300 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.8082380294799805
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0148569  Vali Loss: 0.0173389 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 4.805598974227905
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0144826  Vali Loss: 0.0199571 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9884502  Vali macro F1 0.9877310 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 4.814147710800171
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0139678  Vali Loss: 0.0163074 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.016678 --> 0.016307).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 4.8083930015563965
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0133265  Vali Loss: 0.0156649 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.016307 --> 0.015665).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.808627128601074
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0131944  Vali Loss: 0.0182378 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.80560302734375
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0131426  Vali Loss: 0.0158279 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.809399127960205
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0122913  Vali Loss: 0.0149718 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.015665 --> 0.014972).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.810258150100708
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0117580  Vali Loss: 0.0148165 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.014972 --> 0.014816).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 4.809521436691284
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0101670  Vali Loss: 0.0157495 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 4.807422876358032
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0154869  Vali Loss: 0.0148200 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 4.808323860168457
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0121220  Vali Loss: 0.0164600 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 4.80803370475769
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0107349  Vali Loss: 0.0135190 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949696  Vali macro F1 0.9946072 
new best score!!!!
Validation loss decreased (0.014816 --> 0.013519).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 4.811386585235596
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0115357  Vali Loss: 0.0158639 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 4.812188148498535
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0104524  Vali Loss: 0.0151650 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937061  Vali macro F1 0.9932591 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 4.8078999519348145
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0162761  Vali Loss: 0.0158164 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 4.81871485710144
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0109506  Vali Loss: 0.0163040 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924432  Vali macro F1 0.9919147 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 4.8124213218688965
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0116267  Vali Loss: 0.0165029 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912218  Vali macro F1 0.9908186 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 33 cost time: 4.81187105178833
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0105606  Vali Loss: 0.0151359 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924618  Vali macro F1 0.9921536 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 4.804440498352051
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0099154  Vali Loss: 0.0150493 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912218  Vali macro F1 0.9908186 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 4.807844638824463
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0102607  Vali Loss: 0.0136046 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937463  Vali macro F1 0.9935092 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 4.798333644866943
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0107809  Vali Loss: 0.0144081 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937463  Vali macro F1 0.9935092 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 4.797566890716553
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0098501  Vali Loss: 0.0147329 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924836  Vali macro F1 0.9921620 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 38 cost time: 4.793635368347168
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0105040  Vali Loss: 0.0146380 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924836  Vali macro F1 0.9921620 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 4.7963316440582275
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0091837  Vali Loss: 0.0145680 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924836  Vali macro F1 0.9921620 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 4.7940757274627686
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0090603  Vali Loss: 0.0145402 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924836  Vali macro F1 0.9921620 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 4.793847322463989
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0095531  Vali Loss: 0.0146630 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924836  Vali macro F1 0.9921620 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 4.799833536148071
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0090617  Vali Loss: 0.0147630 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912218  Vali macro F1 0.9908186 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8087719  Test weighted F1: 0.7785606  Test macro F1 0.7785606 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 104364
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4377195835113525
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8808774  Vali Loss: 2.4999378 Vali Accuracy: 0.3771930  Vali weighted F1: 0.3311107  Vali macro F1 0.3333147 
Validation loss decreased (inf --> 2.499938).  Saving model ...
Epoch: 2 cost time: 3.364156484603882
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8469867  Vali Loss: 1.2757717 Vali Accuracy: 0.7919799  Vali weighted F1: 0.7776687  Vali macro F1 0.7713037 
new best score!!!!
Validation loss decreased (2.499938 --> 1.275772).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3989365100860596
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0625359  Vali Loss: 0.8192884 Vali Accuracy: 0.8796992  Vali weighted F1: 0.8737587  Vali macro F1 0.8699002 
new best score!!!!
Validation loss decreased (1.275772 --> 0.819288).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.4002296924591064
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7042080  Vali Loss: 0.5751610 Vali Accuracy: 0.9197995  Vali weighted F1: 0.9165366  Vali macro F1 0.9149602 
new best score!!!!
Validation loss decreased (0.819288 --> 0.575161).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3635454177856445
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5068836  Vali Loss: 0.4332646 Vali Accuracy: 0.9360902  Vali weighted F1: 0.9340575  Vali macro F1 0.9322152 
new best score!!!!
Validation loss decreased (0.575161 --> 0.433265).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.36220383644104
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3866972  Vali Loss: 0.3385350 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9505822  Vali macro F1 0.9477520 
new best score!!!!
Validation loss decreased (0.433265 --> 0.338535).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.362043857574463
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3046816  Vali Loss: 0.2635385 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9514131  Vali macro F1 0.9491848 
new best score!!!!
Validation loss decreased (0.338535 --> 0.263539).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3658370971679688
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2482876  Vali Loss: 0.2157977 Vali Accuracy: 0.9598997  Vali weighted F1: 0.9588482  Vali macro F1 0.9558768 
new best score!!!!
Validation loss decreased (0.263539 --> 0.215798).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3597676753997803
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2062744  Vali Loss: 0.1894507 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9625578  Vali macro F1 0.9614518 
new best score!!!!
Validation loss decreased (0.215798 --> 0.189451).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.362931489944458
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1753687  Vali Loss: 0.1529654 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9746930  Vali macro F1 0.9733355 
new best score!!!!
Validation loss decreased (0.189451 --> 0.152965).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.361948251724243
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1470398  Vali Loss: 0.1323928 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9824367  Vali macro F1 0.9806890 
new best score!!!!
Validation loss decreased (0.152965 --> 0.132393).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3608226776123047
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1307328  Vali Loss: 0.1140907 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837081  Vali macro F1 0.9819211 
new best score!!!!
Validation loss decreased (0.132393 --> 0.114091).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.363003730773926
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1173300  Vali Loss: 0.1007274 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9798583  Vali macro F1 0.9779967 
new best score!!!!
Validation loss decreased (0.114091 --> 0.100727).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.364628553390503
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.1055561  Vali Loss: 0.0889130 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886983  Vali macro F1 0.9878659 
new best score!!!!
Validation loss decreased (0.100727 --> 0.088913).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.36368465423584
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.1082572  Vali Loss: 0.0876021 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899545  Vali macro F1 0.9891012 
new best score!!!!
Validation loss decreased (0.088913 --> 0.087602).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.370555877685547
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0980918  Vali Loss: 0.0858143 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823526  Vali macro F1 0.9818049 
new best score!!!!
Validation loss decreased (0.087602 --> 0.085814).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.369119644165039
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0757212  Vali Loss: 0.0688043 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861243  Vali macro F1 0.9868925 
new best score!!!!
Validation loss decreased (0.085814 --> 0.068804).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3644165992736816
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0697492  Vali Loss: 0.0592834 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924194  Vali macro F1 0.9926721 
new best score!!!!
Validation loss decreased (0.068804 --> 0.059283).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3703830242156982
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0595886  Vali Loss: 0.0525870 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924426  Vali macro F1 0.9928578 
new best score!!!!
Validation loss decreased (0.059283 --> 0.052587).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.420344352722168
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0508257  Vali Loss: 0.0547761 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873912  Vali macro F1 0.9881162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 3.39424467086792
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0457270  Vali Loss: 0.0448399 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886537  Vali macro F1 0.9892330 
new best score!!!!
Validation loss decreased (0.052587 --> 0.044840).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.3718152046203613
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0418458  Vali Loss: 0.0384989 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962391  Vali macro F1 0.9966104 
new best score!!!!
Validation loss decreased (0.044840 --> 0.038499).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3602981567382812
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0401024  Vali Loss: 0.0392008 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899735  Vali macro F1 0.9905608 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.3728983402252197
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0436493  Vali Loss: 0.0340601 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949732  Vali macro F1 0.9952814 
new best score!!!!
Validation loss decreased (0.038499 --> 0.034060).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.368931293487549
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0343399  Vali Loss: 0.0287477 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974908  Vali macro F1 0.9976627 
new best score!!!!
Validation loss decreased (0.034060 --> 0.028748).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.363729238510132
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0322935  Vali Loss: 0.0287001 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962366  Vali macro F1 0.9964470 
new best score!!!!
Validation loss decreased (0.028748 --> 0.028700).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3658058643341064
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0304215  Vali Loss: 0.0278073 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962394  Vali macro F1 0.9964516 
new best score!!!!
Validation loss decreased (0.028700 --> 0.027807).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.364654779434204
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0392994  Vali Loss: 0.0231706 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974908  Vali macro F1 0.9976627 
new best score!!!!
Validation loss decreased (0.027807 --> 0.023171).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.360013484954834
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0368119  Vali Loss: 0.0257543 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.3585214614868164
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0280965  Vali Loss: 0.0218560 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.023171 --> 0.021856).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.360105037689209
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0264867  Vali Loss: 0.0241651 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949895  Vali macro F1 0.9954678 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 3.367915391921997
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0243565  Vali Loss: 0.0182107 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
new best score!!!!
Validation loss decreased (0.021856 --> 0.018211).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.3705861568450928
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0217652  Vali Loss: 0.0175363 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.018211 --> 0.017536).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.368100643157959
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0216097  Vali Loss: 0.0177064 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974908  Vali macro F1 0.9976627 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.3970184326171875
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0208396  Vali Loss: 0.0178375 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962391  Vali macro F1 0.9966104 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.384739637374878
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0216662  Vali Loss: 0.0200717 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962391  Vali macro F1 0.9966104 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 3.3986854553222656
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0229111  Vali Loss: 0.0174524 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974860  Vali macro F1 0.9977812 
new best score!!!!
Validation loss decreased (0.017536 --> 0.017452).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.370288848876953
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0209106  Vali Loss: 0.0179983 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 3.3656744956970215
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0183413  Vali Loss: 0.0157454 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
new best score!!!!
Validation loss decreased (0.017452 --> 0.015745).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.3738460540771484
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0206043  Vali Loss: 0.0147997 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
new best score!!!!
Validation loss decreased (0.015745 --> 0.014800).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.3661835193634033
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0189029  Vali Loss: 0.0145696 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
new best score!!!!
Validation loss decreased (0.014800 --> 0.014570).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.3657822608947754
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0157227  Vali Loss: 0.0143222 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
new best score!!!!
Validation loss decreased (0.014570 --> 0.014322).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 3.3647401332855225
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0156399  Vali Loss: 0.0150809 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 3.366335153579712
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0165710  Vali Loss: 0.0137617 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
new best score!!!!
Validation loss decreased (0.014322 --> 0.013762).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.367596387863159
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0149089  Vali Loss: 0.0145922 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.3669915199279785
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0138919  Vali Loss: 0.0112572 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
new best score!!!!
Validation loss decreased (0.013762 --> 0.011257).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.3654515743255615
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0133789  Vali Loss: 0.0126884 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 3.374424457550049
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0142128  Vali Loss: 0.0150579 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 3.3677210807800293
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0138692  Vali Loss: 0.0116322 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974982  Vali macro F1 0.9978989 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 3.375208854675293
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0165774  Vali Loss: 0.0560043 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9844651  Vali macro F1 0.9851500 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 3.4138317108154297
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0277223  Vali Loss: 0.0258219 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949725  Vali macro F1 0.9952639 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 52 cost time: 3.399573564529419
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0171151  Vali Loss: 0.0180618 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 3.3714959621429443
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0166568  Vali Loss: 0.0157650 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 3.367007255554199
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0183001  Vali Loss: 0.0147100 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 3.3647921085357666
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0128155  Vali Loss: 0.0141298 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 3.371798038482666
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0123331  Vali Loss: 0.0129930 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 3.3684816360473633
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0125672  Vali Loss: 0.0127116 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 3.3613216876983643
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0125624  Vali Loss: 0.0125876 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 3.3655340671539307
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0136008  Vali Loss: 0.0126128 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 3.3629608154296875
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0125270  Vali Loss: 0.0125378 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 3.3639118671417236
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0124743  Vali Loss: 0.0122910 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8789474  Test weighted F1: 0.8628829  Test macro F1 0.8628829 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.767656326293945
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0120743  Vali Loss: 0.0106870 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
Validation loss decreased (inf --> 0.010687).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.759016275405884
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0120427  Vali Loss: 0.0101619 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.010687 --> 0.010162).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.752226114273071
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0122524  Vali Loss: 0.0093903 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.010162 --> 0.009390).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.756809949874878
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0120496  Vali Loss: 0.0098406 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.757221221923828
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0110569  Vali Loss: 0.0090184 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009390 --> 0.009018).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.756098985671997
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0111835  Vali Loss: 0.0088894 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009018 --> 0.008889).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.757291078567505
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0105271  Vali Loss: 0.0086369 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008889 --> 0.008637).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.75515341758728
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0106394  Vali Loss: 0.0084995 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008637 --> 0.008499).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.755690813064575
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0100130  Vali Loss: 0.0085349 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.755826950073242
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0099157  Vali Loss: 0.0084317 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.008499 --> 0.008432).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.755483150482178
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0095354  Vali Loss: 0.0089477 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.758244752883911
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0097130  Vali Loss: 0.0080739 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008432 --> 0.008074).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.757877349853516
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0095497  Vali Loss: 0.0086233 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.75945782661438
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0097703  Vali Loss: 0.0083741 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.758391857147217
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0106268  Vali Loss: 0.0093193 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.75998854637146
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0088943  Vali Loss: 0.0100368 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 4.759310483932495
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0135407  Vali Loss: 0.0085639 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 4.7583794593811035
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0110364  Vali Loss: 0.0089482 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9978906 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.754710912704468
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0095874  Vali Loss: 0.0096200 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 4.739765405654907
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0088821  Vali Loss: 0.0090056 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 4.7471089363098145
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0091630  Vali Loss: 0.0082499 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 4.745049476623535
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0101646  Vali Loss: 0.0073604 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008074 --> 0.007360).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.7457098960876465
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0089447  Vali Loss: 0.0082736 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 4.745384454727173
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0081308  Vali Loss: 0.0071388 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007360 --> 0.007139).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.742564916610718
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0080950  Vali Loss: 0.0102089 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.745784282684326
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0093981  Vali Loss: 0.0071312 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
new best score!!!!
Validation loss decreased (0.007139 --> 0.007131).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 4.745380878448486
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0078018  Vali Loss: 0.0082459 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9989429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 4.746862888336182
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0081765  Vali Loss: 0.0085173 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 4.744044542312622
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0075399  Vali Loss: 0.0100773 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 4.742098808288574
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0070010  Vali Loss: 0.0098372 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974935  Vali macro F1 0.9976673 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 4.745820999145508
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0077066  Vali Loss: 0.0074824 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 32 cost time: 4.747624397277832
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0069103  Vali Loss: 0.0077161 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 33 cost time: 4.745263338088989
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0074337  Vali Loss: 0.0076368 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974908  Vali macro F1 0.9976627 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 34 cost time: 4.7455573081970215
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0073232  Vali Loss: 0.0075187 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 35 cost time: 4.742897987365723
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0072821  Vali Loss: 0.0076121 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 36 cost time: 4.756348133087158
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0068887  Vali Loss: 0.0076086 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 37 cost time: 4.745575189590454
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0075053  Vali Loss: 0.0076203 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 4.751572132110596
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0074099  Vali Loss: 0.0076214 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 39 cost time: 4.742516994476318
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0074331  Vali Loss: 0.0076275 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 40 cost time: 4.74718451499939
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0091738  Vali Loss: 0.0076383 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 41 cost time: 4.744447231292725
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0072889  Vali Loss: 0.0076255 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987454  Vali macro F1 0.9987199 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8859649  Test weighted F1: 0.8721637  Test macro F1 0.8721637 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4485840797424316
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8795019  Vali Loss: 2.4880340 Vali Accuracy: 0.3446115  Vali weighted F1: 0.2946682  Vali macro F1 0.3039741 
Validation loss decreased (inf --> 2.488034).  Saving model ...
Epoch: 2 cost time: 3.3668501377105713
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8377774  Vali Loss: 1.3034244 Vali Accuracy: 0.8007519  Vali weighted F1: 0.7832786  Vali macro F1 0.7813447 
new best score!!!!
Validation loss decreased (2.488034 --> 1.303424).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3558216094970703
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0844124  Vali Loss: 0.8261149 Vali Accuracy: 0.8909774  Vali weighted F1: 0.8819290  Vali macro F1 0.8820982 
new best score!!!!
Validation loss decreased (1.303424 --> 0.826115).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.350102186203003
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7270300  Vali Loss: 0.5721940 Vali Accuracy: 0.9335840  Vali weighted F1: 0.9277631  Vali macro F1 0.9254159 
new best score!!!!
Validation loss decreased (0.826115 --> 0.572194).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3519058227539062
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5191603  Vali Loss: 0.4212870 Vali Accuracy: 0.9523810  Vali weighted F1: 0.9479175  Vali macro F1 0.9459449 
new best score!!!!
Validation loss decreased (0.572194 --> 0.421287).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3571054935455322
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3903930  Vali Loss: 0.3264147 Vali Accuracy: 0.9573935  Vali weighted F1: 0.9561455  Vali macro F1 0.9540969 
new best score!!!!
Validation loss decreased (0.421287 --> 0.326415).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3606066703796387
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2999248  Vali Loss: 0.2530434 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9597663  Vali macro F1 0.9581520 
new best score!!!!
Validation loss decreased (0.326415 --> 0.253043).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.363508462905884
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2466099  Vali Loss: 0.2070337 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9613577  Vali macro F1 0.9592223 
new best score!!!!
Validation loss decreased (0.253043 --> 0.207034).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.392965316772461
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2054160  Vali Loss: 0.1786884 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9623219  Vali macro F1 0.9601270 
new best score!!!!
Validation loss decreased (0.207034 --> 0.178688).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.404041290283203
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1745767  Vali Loss: 0.1554932 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9640164  Vali macro F1 0.9618689 
new best score!!!!
Validation loss decreased (0.178688 --> 0.155493).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.360729217529297
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1486510  Vali Loss: 0.1347058 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861694  Vali macro F1 0.9857867 
new best score!!!!
Validation loss decreased (0.155493 --> 0.134706).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.363994836807251
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1307337  Vali Loss: 0.1104492 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810633  Vali macro F1 0.9797494 
new best score!!!!
Validation loss decreased (0.134706 --> 0.110449).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3624441623687744
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1070199  Vali Loss: 0.0919304 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874586  Vali macro F1 0.9857156 
new best score!!!!
Validation loss decreased (0.110449 --> 0.091930).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.358902931213379
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0974867  Vali Loss: 0.0891999 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861625  Vali macro F1 0.9853505 
new best score!!!!
Validation loss decreased (0.091930 --> 0.089200).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.360131025314331
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0982817  Vali Loss: 0.0849351 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886339  Vali macro F1 0.9880544 
new best score!!!!
Validation loss decreased (0.089200 --> 0.084935).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.360755443572998
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0769163  Vali Loss: 0.0715926 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873611  Vali macro F1 0.9862227 
new best score!!!!
Validation loss decreased (0.084935 --> 0.071593).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.363070487976074
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0698271  Vali Loss: 0.0624579 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911288  Vali macro F1 0.9913663 
new best score!!!!
Validation loss decreased (0.071593 --> 0.062458).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3622050285339355
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0676079  Vali Loss: 0.0543291 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924588  Vali macro F1 0.9929771 
new best score!!!!
Validation loss decreased (0.062458 --> 0.054329).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3579699993133545
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0559929  Vali Loss: 0.0452200 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.054329 --> 0.045220).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.358060598373413
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0465549  Vali Loss: 0.0433794 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
new best score!!!!
Validation loss decreased (0.045220 --> 0.043379).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.358914613723755
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0443776  Vali Loss: 0.0400617 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
new best score!!!!
Validation loss decreased (0.043379 --> 0.040062).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.363264322280884
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0369163  Vali Loss: 0.0320637 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.040062 --> 0.032064).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3649117946624756
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0379909  Vali Loss: 0.0393817 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937219  Vali macro F1 0.9937054 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.359750509262085
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0430440  Vali Loss: 0.0353490 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 3.369751214981079
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0410344  Vali Loss: 0.0298582 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.032064 --> 0.029858).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.4257938861846924
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0349292  Vali Loss: 0.0343191 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975009  Vali macro F1 0.9978355 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.387199878692627
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0452316  Vali Loss: 0.0253686 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.029858 --> 0.025369).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.368396759033203
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0277708  Vali Loss: 0.0229116 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.025369 --> 0.022912).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.361154556274414
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0250918  Vali Loss: 0.0183499 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.022912 --> 0.018350).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.360485076904297
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0222287  Vali Loss: 0.0346350 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924146  Vali macro F1 0.9926225 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 4.347877502441406
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0262296  Vali Loss: 0.0176540 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.018350 --> 0.017654).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.3594744205474854
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0209518  Vali Loss: 0.0161371 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.017654 --> 0.016137).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.3625383377075195
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0217103  Vali Loss: 0.0160537 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.016137 --> 0.016054).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.3672313690185547
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0186121  Vali Loss: 0.0146655 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.016054 --> 0.014665).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.357323408126831
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0168335  Vali Loss: 0.0134466 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
new best score!!!!
Validation loss decreased (0.014665 --> 0.013447).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.362675428390503
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0231458  Vali Loss: 0.0254788 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.361835479736328
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0249076  Vali Loss: 0.0181991 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.362889289855957
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0180745  Vali Loss: 0.0149282 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 3.36527943611145
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0184366  Vali Loss: 0.0155088 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987481  Vali macro F1 0.9989475 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 3.363037586212158
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0171703  Vali Loss: 0.0169300 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 3.3676626682281494
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0166481  Vali Loss: 0.0148484 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.3709194660186768
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0144765  Vali Loss: 0.0132767 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013447 --> 0.013277).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 3.4165022373199463
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0136345  Vali Loss: 0.0127414 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.013277 --> 0.012741).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.399338722229004
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0133481  Vali Loss: 0.0119971 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012741 --> 0.011997).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.368577241897583
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0127724  Vali Loss: 0.0116234 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011997 --> 0.011623).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 3.361156940460205
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0131537  Vali Loss: 0.0108310 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.011623 --> 0.010831).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.365332841873169
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0130396  Vali Loss: 0.0103980 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010831 --> 0.010398).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.3632545471191406
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0128692  Vali Loss: 0.0100052 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010398 --> 0.010005).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 3.3621320724487305
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0134389  Vali Loss: 0.0098659 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010005 --> 0.009866).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 3.3692538738250732
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0125914  Vali Loss: 0.0096071 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009866 --> 0.009607).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 3.363206624984741
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0121969  Vali Loss: 0.0095928 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009607 --> 0.009593).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.3595998287200928
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0125869  Vali Loss: 0.0094088 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009593 --> 0.009409).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 3.3646020889282227
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0114442  Vali Loss: 0.0094567 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.36041522026062
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0137400  Vali Loss: 0.0094650 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.3675944805145264
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0160577  Vali Loss: 0.0162060 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.3669543266296387
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0123625  Vali Loss: 0.0117065 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 3.3715922832489014
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0121506  Vali Loss: 0.0101796 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 58 cost time: 3.3643720149993896
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0103613  Vali Loss: 0.0100833 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.4227869510650635
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0131610  Vali Loss: 0.0100391 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 3.3803064823150635
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0119857  Vali Loss: 0.0100052 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 3.3630356788635254
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0106763  Vali Loss: 0.0099834 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 3.3646440505981445
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0121531  Vali Loss: 0.0099608 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 63 cost time: 3.365597724914551
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0113869  Vali Loss: 0.0099567 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 3.362008571624756
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0114551  Vali Loss: 0.0099528 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 3.3626983165740967
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0117685  Vali Loss: 0.0099485 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 3.367759943008423
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0111376  Vali Loss: 0.0099444 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 3.363676071166992
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0113520  Vali Loss: 0.0099408 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8719298  Test weighted F1: 0.8393087  Test macro F1 0.8393087 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.7686567306518555
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0125399  Vali Loss: 0.0093880 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
Validation loss decreased (inf --> 0.009388).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.763951301574707
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0120095  Vali Loss: 0.0084520 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009388 --> 0.008452).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.766719818115234
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0116540  Vali Loss: 0.0079626 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008452 --> 0.007963).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.764859199523926
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0102536  Vali Loss: 0.0078885 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007963 --> 0.007888).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.765103340148926
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0100213  Vali Loss: 0.0084374 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.76273250579834
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0101286  Vali Loss: 0.0075088 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007888 --> 0.007509).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.762183904647827
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0090198  Vali Loss: 0.0071442 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007509 --> 0.007144).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.764129877090454
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0095386  Vali Loss: 0.0069435 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.007144 --> 0.006943).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.760209560394287
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0091724  Vali Loss: 0.0068637 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006943 --> 0.006864).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.7619805335998535
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0087118  Vali Loss: 0.0066766 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006864 --> 0.006677).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.762677431106567
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0162419  Vali Loss: 0.0068815 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.760289907455444
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0098190  Vali Loss: 0.0074929 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 4.7613866329193115
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0079888  Vali Loss: 0.0064521 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006677 --> 0.006452).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.76062536239624
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0075468  Vali Loss: 0.0065381 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.760027170181274
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0078394  Vali Loss: 0.0066866 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 4.760416746139526
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0082711  Vali Loss: 0.0062628 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006452 --> 0.006263).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.761928081512451
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0080049  Vali Loss: 0.0064712 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.755467176437378
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0078200  Vali Loss: 0.0059060 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.006263 --> 0.005906).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 4.758577346801758
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0070212  Vali Loss: 0.0057585 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005906 --> 0.005759).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.764553546905518
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0098610  Vali Loss: 0.0061574 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.7646324634552
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0070173  Vali Loss: 0.0059220 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.7604663372039795
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0073229  Vali Loss: 0.0059393 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 4.761406898498535
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0064543  Vali Loss: 0.0057796 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 4.7564098834991455
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0061321  Vali Loss: 0.0051841 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005759 --> 0.005184).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.764534950256348
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0063946  Vali Loss: 0.0051996 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.7574872970581055
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0066288  Vali Loss: 0.0048496 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005184 --> 0.004850).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 4.759650230407715
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0060970  Vali Loss: 0.0050581 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 4.7607033252716064
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0066220  Vali Loss: 0.0053594 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 4.761370658874512
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0054277  Vali Loss: 0.0052026 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 4.763407945632935
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0059583  Vali Loss: 0.0051780 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 4.760739326477051
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0063018  Vali Loss: 0.0048951 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 32 cost time: 4.761583566665649
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0058784  Vali Loss: 0.0048352 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004850 --> 0.004835).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 4.763135671615601
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0050423  Vali Loss: 0.0046061 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004835 --> 0.004606).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 4.766723871231079
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0100968  Vali Loss: 0.0046266 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 4.765061855316162
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0078392  Vali Loss: 0.0068209 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974937  Vali macro F1 0.9975721 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 4.768691539764404
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0065323  Vali Loss: 0.0054310 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 4.762371063232422
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0054725  Vali Loss: 0.0045842 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
new best score!!!!
Validation loss decreased (0.004606 --> 0.004584).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 38 cost time: 4.768173456192017
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0056061  Vali Loss: 0.0044215 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987475  Vali macro F1 0.9987875 
new best score!!!!
Validation loss decreased (0.004584 --> 0.004422).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 4.768609046936035
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0050483  Vali Loss: 0.0045508 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 4.76625919342041
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0067179  Vali Loss: 0.0043160 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004422 --> 0.004316).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 41 cost time: 4.767679929733276
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0055529  Vali Loss: 0.0040184 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004316 --> 0.004018).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 42 cost time: 4.772381544113159
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0045726  Vali Loss: 0.0048175 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 43 cost time: 4.7666285037994385
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0045504  Vali Loss: 0.0038875 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004018 --> 0.003888).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 44 cost time: 4.76816463470459
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0049341  Vali Loss: 0.0043762 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987459  Vali macro F1 0.9987843 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 45 cost time: 4.7668373584747314
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0048890  Vali Loss: 0.0041393 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 46 cost time: 4.765792369842529
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0053174  Vali Loss: 0.0039104 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 47 cost time: 4.763693571090698
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0057848  Vali Loss: 0.0042280 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 48 cost time: 4.764837026596069
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0044251  Vali Loss: 0.0041432 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 49 cost time: 4.761307716369629
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0050726  Vali Loss: 0.0041249 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 50 cost time: 4.765530824661255
Fine Tuning VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0045077  Vali Loss: 0.0041330 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 51 cost time: 4.765970230102539
Fine Tuning VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0053527  Vali Loss: 0.0041745 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 52 cost time: 4.761064767837524
Fine Tuning VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0054382  Vali Loss: 0.0041105 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 53 cost time: 4.7676191329956055
Fine Tuning VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0046203  Vali Loss: 0.0040690 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 54 cost time: 4.764424800872803
Fine Tuning VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0041644  Vali Loss: 0.0040728 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 55 cost time: 4.760477781295776
Fine Tuning VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0045062  Vali Loss: 0.0040717 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 56 cost time: 4.765191316604614
Fine Tuning VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0044784  Vali Loss: 0.0040669 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 57 cost time: 4.759533405303955
Fine Tuning VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0049272  Vali Loss: 0.0040650 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 58 cost time: 4.759721755981445
Fine Tuning VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0047763  Vali Loss: 0.0040729 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8719298  Test weighted F1: 0.8405771  Test macro F1 0.8405771 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.440370798110962
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8807003  Vali Loss: 2.5075820 Vali Accuracy: 0.3157895  Vali weighted F1: 0.2592283  Vali macro F1 0.2699467 
Validation loss decreased (inf --> 2.507582).  Saving model ...
Epoch: 2 cost time: 3.3609092235565186
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8685576  Vali Loss: 1.3554016 Vali Accuracy: 0.7531328  Vali weighted F1: 0.7307131  Vali macro F1 0.7281132 
new best score!!!!
Validation loss decreased (2.507582 --> 1.355402).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3580167293548584
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.1238576  Vali Loss: 0.8514644 Vali Accuracy: 0.8897243  Vali weighted F1: 0.8774860  Vali macro F1 0.8729394 
new best score!!!!
Validation loss decreased (1.355402 --> 0.851464).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3684558868408203
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7397924  Vali Loss: 0.5996212 Vali Accuracy: 0.9122807  Vali weighted F1: 0.9084997  Vali macro F1 0.9028406 
new best score!!!!
Validation loss decreased (0.851464 --> 0.599621).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3614070415496826
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5239365  Vali Loss: 0.4353204 Vali Accuracy: 0.9423559  Vali weighted F1: 0.9414399  Vali macro F1 0.9403039 
new best score!!!!
Validation loss decreased (0.599621 --> 0.435320).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.4088950157165527
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3961562  Vali Loss: 0.3342136 Vali Accuracy: 0.9498747  Vali weighted F1: 0.9492008  Vali macro F1 0.9486244 
new best score!!!!
Validation loss decreased (0.435320 --> 0.334214).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.395892858505249
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3041062  Vali Loss: 0.2695000 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9544225  Vali macro F1 0.9532472 
new best score!!!!
Validation loss decreased (0.334214 --> 0.269500).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.363682985305786
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2467217  Vali Loss: 0.2288083 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9546730  Vali macro F1 0.9541252 
new best score!!!!
Validation loss decreased (0.269500 --> 0.228808).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3648695945739746
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2029541  Vali Loss: 0.1879275 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9602426  Vali macro F1 0.9594247 
new best score!!!!
Validation loss decreased (0.228808 --> 0.187927).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.365427017211914
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1737036  Vali Loss: 0.1676938 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9629137  Vali macro F1 0.9620791 
new best score!!!!
Validation loss decreased (0.187927 --> 0.167694).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.366574764251709
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1453857  Vali Loss: 0.1387646 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9709213  Vali macro F1 0.9696500 
new best score!!!!
Validation loss decreased (0.167694 --> 0.138765).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3679683208465576
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1295183  Vali Loss: 0.1194757 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9733874  Vali macro F1 0.9717809 
new best score!!!!
Validation loss decreased (0.138765 --> 0.119476).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.360930919647217
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1157559  Vali Loss: 0.1131591 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9784305  Vali macro F1 0.9777966 
new best score!!!!
Validation loss decreased (0.119476 --> 0.113159).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3645501136779785
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0964083  Vali Loss: 0.0927047 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811013  Vali macro F1 0.9808949 
new best score!!!!
Validation loss decreased (0.113159 --> 0.092705).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.35925030708313
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0886481  Vali Loss: 0.0820274 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9848136  Vali macro F1 0.9848133 
new best score!!!!
Validation loss decreased (0.092705 --> 0.082027).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3692309856414795
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0792638  Vali Loss: 0.0772639 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886231  Vali macro F1 0.9893164 
new best score!!!!
Validation loss decreased (0.082027 --> 0.077264).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.3616840839385986
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0765462  Vali Loss: 0.0661369 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9872772  Vali macro F1 0.9877687 
new best score!!!!
Validation loss decreased (0.077264 --> 0.066137).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3673572540283203
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0816818  Vali Loss: 0.0796491 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9796578  Vali macro F1 0.9795608 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 3.3618767261505127
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0598009  Vali Loss: 0.0582581 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9860228  Vali macro F1 0.9867118 
new best score!!!!
Validation loss decreased (0.066137 --> 0.058258).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.3695614337921143
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0507800  Vali Loss: 0.0505491 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885822  Vali macro F1 0.9890470 
new best score!!!!
Validation loss decreased (0.058258 --> 0.050549).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.366475820541382
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0477658  Vali Loss: 0.0632961 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9794192  Vali macro F1 0.9803962 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.377248525619507
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0443776  Vali Loss: 0.0429066 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924405  Vali macro F1 0.9928169 
new best score!!!!
Validation loss decreased (0.050549 --> 0.042907).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.428210973739624
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0418948  Vali Loss: 0.0517615 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873637  Vali macro F1 0.9884110 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.3884084224700928
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0388655  Vali Loss: 0.0385036 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924146  Vali macro F1 0.9926225 
new best score!!!!
Validation loss decreased (0.042907 --> 0.038504).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.3677048683166504
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0366606  Vali Loss: 0.0363141 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911627  Vali macro F1 0.9915700 
new best score!!!!
Validation loss decreased (0.038504 --> 0.036314).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.363063335418701
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0386088  Vali Loss: 0.0389891 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887278  Vali macro F1 0.9890876 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.368762493133545
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0388787  Vali Loss: 0.0375968 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885822  Vali macro F1 0.9890470 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 3.3619115352630615
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0342416  Vali Loss: 0.0346294 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887230  Vali macro F1 0.9892360 
new best score!!!!
Validation loss decreased (0.036314 --> 0.034629).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.3626670837402344
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0497959  Vali Loss: 0.0438142 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859608  Vali macro F1 0.9864776 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.3726682662963867
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0380718  Vali Loss: 0.0343414 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885291  Vali macro F1 0.9888212 
new best score!!!!
Validation loss decreased (0.034629 --> 0.034341).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.3659183979034424
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0263523  Vali Loss: 0.0242119 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.034341 --> 0.024212).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.3635709285736084
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0229536  Vali Loss: 0.0233180 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937115  Vali macro F1 0.9940554 
new best score!!!!
Validation loss decreased (0.024212 --> 0.023318).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.357774257659912
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0244144  Vali Loss: 0.0254322 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.361715316772461
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0221273  Vali Loss: 0.0183642 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.023318 --> 0.018364).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.361941337585449
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0198644  Vali Loss: 0.0224185 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937115  Vali macro F1 0.9940554 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.364154577255249
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0181931  Vali Loss: 0.0269335 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911627  Vali macro F1 0.9915700 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.3667893409729004
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0205129  Vali Loss: 0.0250337 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 3.4069724082946777
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0179860  Vali Loss: 0.0193051 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 3.4035630226135254
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0159387  Vali Loss: 0.0226788 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 3.7612597942352295
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0146995  Vali Loss: 0.0192502 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 3.3594560623168945
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0146059  Vali Loss: 0.0188669 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 3.3587663173675537
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0200731  Vali Loss: 0.0191271 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 3.3561506271362305
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0142524  Vali Loss: 0.0169454 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.018364 --> 0.016945).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.36063551902771
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0132705  Vali Loss: 0.0175456 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 3.3640048503875732
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0129580  Vali Loss: 0.0170325 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 3.3716516494750977
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0138665  Vali Loss: 0.0174955 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 3.365112781524658
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0130017  Vali Loss: 0.0162020 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.016945 --> 0.016202).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.3648440837860107
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0121864  Vali Loss: 0.0163801 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.3597493171691895
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0132566  Vali Loss: 0.0176343 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.3646860122680664
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0132193  Vali Loss: 0.0162937 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.365387439727783
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0130825  Vali Loss: 0.0166871 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 3.3727126121520996
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0131567  Vali Loss: 0.0165145 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 3.411834955215454
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0128357  Vali Loss: 0.0167502 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.4014434814453125
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0130652  Vali Loss: 0.0167881 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.3649983406066895
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0135174  Vali Loss: 0.0167077 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.370408535003662
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0127170  Vali Loss: 0.0167840 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 3.360487222671509
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0119322  Vali Loss: 0.0168524 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 58 cost time: 3.3743643760681152
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0139512  Vali Loss: 0.0168684 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.3622491359710693
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0128072  Vali Loss: 0.0168809 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 3.371985673904419
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0129145  Vali Loss: 0.0168686 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 3.3583340644836426
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0126105  Vali Loss: 0.0168591 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 3.373244047164917
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0116329  Vali Loss: 0.0168560 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8736842  Test weighted F1: 0.8644580  Test macro F1 0.8644580 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.754559516906738
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0137594  Vali Loss: 0.0182307 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
Validation loss decreased (inf --> 0.018231).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.751431465148926
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0127503  Vali Loss: 0.0166227 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
new best score!!!!
Validation loss decreased (0.018231 --> 0.016623).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.7471067905426025
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0132466  Vali Loss: 0.0162470 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.016623 --> 0.016247).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.749042510986328
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0124500  Vali Loss: 0.0146169 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.016247 --> 0.014617).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.747289180755615
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0127914  Vali Loss: 0.0152076 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.747557163238525
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0119525  Vali Loss: 0.0137289 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
new best score!!!!
Validation loss decreased (0.014617 --> 0.013729).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.745331764221191
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0131392  Vali Loss: 0.0170267 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.739725351333618
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0113176  Vali Loss: 0.0153819 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 4.742753267288208
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0108410  Vali Loss: 0.0145539 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 4.744195938110352
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0100334  Vali Loss: 0.0145698 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 4.741828203201294
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0100524  Vali Loss: 0.0144450 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 4.744307041168213
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0101830  Vali Loss: 0.0143958 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.74446702003479
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0096190  Vali Loss: 0.0126902 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.013729 --> 0.012690).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.746237754821777
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0093963  Vali Loss: 0.0122298 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974891  Vali macro F1 0.9975644 
new best score!!!!
Validation loss decreased (0.012690 --> 0.012230).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.741464853286743
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0088701  Vali Loss: 0.0135962 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.74120569229126
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0101738  Vali Loss: 0.0152187 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 4.741933822631836
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0093738  Vali Loss: 0.0132883 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 4.7466139793396
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0098498  Vali Loss: 0.0142025 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949634  Vali macro F1 0.9951080 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 4.741713523864746
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0087141  Vali Loss: 0.0136664 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 4.743851661682129
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0092727  Vali Loss: 0.0125906 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.738987445831299
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0094383  Vali Loss: 0.0124198 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.7427496910095215
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0082389  Vali Loss: 0.0124558 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 4.744721412658691
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0080755  Vali Loss: 0.0123474 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 4.74521279335022
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0079819  Vali Loss: 0.0123566 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 25 cost time: 4.745012283325195
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0080116  Vali Loss: 0.0123536 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.747257232666016
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0080920  Vali Loss: 0.0123342 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 4.748049736022949
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0086830  Vali Loss: 0.0123230 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 4.743914842605591
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0079914  Vali Loss: 0.0123543 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 4.745217323303223
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0082455  Vali Loss: 0.0123747 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962286  Vali macro F1 0.9963393 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8640351  Test weighted F1: 0.8524937  Test macro F1 0.8524937 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.459611654281616
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8855077  Vali Loss: 2.5395230 Vali Accuracy: 0.3095238  Vali weighted F1: 0.2481560  Vali macro F1 0.2611675 
Validation loss decreased (inf --> 2.539523).  Saving model ...
Epoch: 2 cost time: 3.3609068393707275
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8596779  Vali Loss: 1.3235825 Vali Accuracy: 0.8157895  Vali weighted F1: 0.8016291  Vali macro F1 0.8036867 
new best score!!!!
Validation loss decreased (2.539523 --> 1.323582).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.362323045730591
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0993768  Vali Loss: 0.8461401 Vali Accuracy: 0.8834586  Vali weighted F1: 0.8709196  Vali macro F1 0.8694053 
new best score!!!!
Validation loss decreased (1.323582 --> 0.846140).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3586416244506836
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7359730  Vali Loss: 0.6096891 Vali Accuracy: 0.9147870  Vali weighted F1: 0.9085363  Vali macro F1 0.9073538 
new best score!!!!
Validation loss decreased (0.846140 --> 0.609689).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3613970279693604
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5306545  Vali Loss: 0.4536111 Vali Accuracy: 0.9486216  Vali weighted F1: 0.9450831  Vali macro F1 0.9429357 
new best score!!!!
Validation loss decreased (0.609689 --> 0.453611).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3626291751861572
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.4106651  Vali Loss: 0.3532742 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9600078  Vali macro F1 0.9603295 
new best score!!!!
Validation loss decreased (0.453611 --> 0.353274).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.363933563232422
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3131504  Vali Loss: 0.2790797 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9668034  Vali macro F1 0.9662499 
new best score!!!!
Validation loss decreased (0.353274 --> 0.279080).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3594648838043213
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2558291  Vali Loss: 0.2181314 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9641031  Vali macro F1 0.9633942 
new best score!!!!
Validation loss decreased (0.279080 --> 0.218131).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3672049045562744
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2125683  Vali Loss: 0.1804595 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9742216  Vali macro F1 0.9741109 
new best score!!!!
Validation loss decreased (0.218131 --> 0.180459).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.3716511726379395
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1763261  Vali Loss: 0.1557972 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9798212  Vali macro F1 0.9793443 
new best score!!!!
Validation loss decreased (0.180459 --> 0.155797).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.409053087234497
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1479688  Vali Loss: 0.1279945 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849169  Vali macro F1 0.9846392 
new best score!!!!
Validation loss decreased (0.155797 --> 0.127994).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.4063215255737305
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1371396  Vali Loss: 0.1201303 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823882  Vali macro F1 0.9826041 
new best score!!!!
Validation loss decreased (0.127994 --> 0.120130).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3732824325561523
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1316886  Vali Loss: 0.1004454 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862544  Vali macro F1 0.9861648 
new best score!!!!
Validation loss decreased (0.120130 --> 0.100445).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.368558168411255
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.1095656  Vali Loss: 0.0989201 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862425  Vali macro F1 0.9870509 
new best score!!!!
Validation loss decreased (0.100445 --> 0.098920).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3703207969665527
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0898255  Vali Loss: 0.0808791 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886502  Vali macro F1 0.9894009 
new best score!!!!
Validation loss decreased (0.098920 --> 0.080879).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3688712120056152
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0751110  Vali Loss: 0.0690739 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924423  Vali macro F1 0.9932193 
new best score!!!!
Validation loss decreased (0.080879 --> 0.069074).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.367332935333252
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0683643  Vali Loss: 0.0601617 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937151  Vali macro F1 0.9941711 
new best score!!!!
Validation loss decreased (0.069074 --> 0.060162).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.370802164077759
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0573251  Vali Loss: 0.0510639 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924800  Vali macro F1 0.9929762 
new best score!!!!
Validation loss decreased (0.060162 --> 0.051064).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3630552291870117
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0558876  Vali Loss: 0.0535866 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911962  Vali macro F1 0.9916605 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.3696281909942627
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0505001  Vali Loss: 0.0474416 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937214  Vali macro F1 0.9942829 
new best score!!!!
Validation loss decreased (0.051064 --> 0.047442).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.363908052444458
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0497337  Vali Loss: 0.0502787 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899263  Vali macro F1 0.9904230 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.3669018745422363
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0451895  Vali Loss: 0.0386653 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937204  Vali macro F1 0.9941154 
new best score!!!!
Validation loss decreased (0.047442 --> 0.038665).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.369145393371582
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0420583  Vali Loss: 0.0368756 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949806  Vali macro F1 0.9954961 
new best score!!!!
Validation loss decreased (0.038665 --> 0.036876).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3653244972229004
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0412896  Vali Loss: 0.0462323 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912281  Vali macro F1 0.9920196 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.373356342315674
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0411557  Vali Loss: 0.0470515 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937240  Vali macro F1 0.9941752 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 3.368021011352539
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0346432  Vali Loss: 0.0346328 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924605  Vali macro F1 0.9928909 
new best score!!!!
Validation loss decreased (0.036876 --> 0.034633).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3685858249664307
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0307231  Vali Loss: 0.0397585 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873657  Vali macro F1 0.9879230 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.4200704097747803
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0388794  Vali Loss: 0.0399350 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900053  Vali macro F1 0.9905403 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 3.3920159339904785
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0774514  Vali Loss: 0.0404032 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899913  Vali macro F1 0.9905038 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 3.3693618774414062
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0405620  Vali Loss: 0.0300365 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912254  Vali macro F1 0.9916961 
new best score!!!!
Validation loss decreased (0.034633 --> 0.030037).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.37630558013916
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0293910  Vali Loss: 0.0251417 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949937  Vali macro F1 0.9952973 
new best score!!!!
Validation loss decreased (0.030037 --> 0.025142).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.3663811683654785
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0267270  Vali Loss: 0.0271218 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937158  Vali macro F1 0.9941153 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.3652830123901367
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0232068  Vali Loss: 0.0221828 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949768  Vali macro F1 0.9953349 
new best score!!!!
Validation loss decreased (0.025142 --> 0.022183).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.3640761375427246
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0216755  Vali Loss: 0.0213331 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
new best score!!!!
Validation loss decreased (0.022183 --> 0.021333).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.3639485836029053
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0192342  Vali Loss: 0.0195650 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
new best score!!!!
Validation loss decreased (0.021333 --> 0.019565).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.365748643875122
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0237892  Vali Loss: 0.0243385 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949768  Vali macro F1 0.9953349 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.36417818069458
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0251964  Vali Loss: 0.0213195 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962321  Vali macro F1 0.9965593 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.366093635559082
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0196563  Vali Loss: 0.0226802 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937211  Vali macro F1 0.9940597 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 3.3665804862976074
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0213181  Vali Loss: 0.0271545 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 3.3725345134735107
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0179035  Vali Loss: 0.0214431 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937177  Vali macro F1 0.9941685 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 3.3714325428009033
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0162768  Vali Loss: 0.0203566 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.3721189498901367
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0160581  Vali Loss: 0.0206054 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 3.404754400253296
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0159841  Vali Loss: 0.0210666 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 3.4068593978881836
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0153823  Vali Loss: 0.0220671 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 3.372619390487671
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0153347  Vali Loss: 0.0214507 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 3.3659560680389404
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0148052  Vali Loss: 0.0210476 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 3.3665034770965576
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0146755  Vali Loss: 0.0211106 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 3.3664052486419678
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0153553  Vali Loss: 0.0211991 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 3.3652408123016357
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0154324  Vali Loss: 0.0211944 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 3.3663644790649414
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0148707  Vali Loss: 0.0212377 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8429825  Test weighted F1: 0.8013384  Test macro F1 0.8013384 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.857502460479736
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0190621  Vali Loss: 0.0226450 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
Validation loss decreased (inf --> 0.022645).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.781568765640259
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0175582  Vali Loss: 0.0190402 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949778  Vali macro F1 0.9955024 
new best score!!!!
Validation loss decreased (0.022645 --> 0.019040).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.782455682754517
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0171666  Vali Loss: 0.0188860 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949771  Vali macro F1 0.9954378 
new best score!!!!
Validation loss decreased (0.019040 --> 0.018886).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.783269643783569
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0172086  Vali Loss: 0.0197650 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.782296180725098
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0167787  Vali Loss: 0.0226210 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 4.782272100448608
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0164452  Vali Loss: 0.0239520 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962363  Vali macro F1 0.9967724 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 4.7815093994140625
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0162989  Vali Loss: 0.0169173 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9978347 
new best score!!!!
Validation loss decreased (0.018886 --> 0.016917).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.780738830566406
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0148695  Vali Loss: 0.0200101 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962308  Vali macro F1 0.9965505 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.777094841003418
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0166029  Vali Loss: 0.0153404 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974860  Vali macro F1 0.9977748 
new best score!!!!
Validation loss decreased (0.016917 --> 0.015340).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.77826189994812
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0149127  Vali Loss: 0.0165435 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949778  Vali macro F1 0.9955024 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 4.7780067920684814
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0152139  Vali Loss: 0.0180172 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962403  Vali macro F1 0.9966192 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 4.78197169303894
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0149890  Vali Loss: 0.0174524 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 4.779296636581421
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0145051  Vali Loss: 0.0164081 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949778  Vali macro F1 0.9955024 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 4.77881932258606
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0145822  Vali Loss: 0.0215072 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 4.7802722454071045
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0145312  Vali Loss: 0.0212073 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962308  Vali macro F1 0.9965505 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.780097723007202
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0141636  Vali Loss: 0.0153010 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
new best score!!!!
Validation loss decreased (0.015340 --> 0.015301).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.778063058853149
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0137342  Vali Loss: 0.0152288 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
new best score!!!!
Validation loss decreased (0.015301 --> 0.015229).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.779599905014038
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0128672  Vali Loss: 0.0146145 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
new best score!!!!
Validation loss decreased (0.015229 --> 0.014615).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 4.776684284210205
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0135317  Vali Loss: 0.0155086 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 4.777690410614014
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0125897  Vali Loss: 0.0161698 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 4.778146743774414
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0124776  Vali Loss: 0.0158227 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 4.778003692626953
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0119615  Vali Loss: 0.0176092 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 4.777745485305786
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0118392  Vali Loss: 0.0143635 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
new best score!!!!
Validation loss decreased (0.014615 --> 0.014363).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 4.776996612548828
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0113335  Vali Loss: 0.0209922 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 4.776489019393921
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0113837  Vali Loss: 0.0151335 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 4.777551889419556
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0128711  Vali Loss: 0.0152578 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 4.7759459018707275
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0118920  Vali Loss: 0.0173259 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 4.778630256652832
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0137008  Vali Loss: 0.0151319 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 29 cost time: 4.7779717445373535
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0115954  Vali Loss: 0.0145007 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974942  Vali macro F1 0.9976116 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 4.778953790664673
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0112726  Vali Loss: 0.0143304 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
new best score!!!!
Validation loss decreased (0.014363 --> 0.014330).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 4.778827905654907
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0115975  Vali Loss: 0.0145338 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 4.766458034515381
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0107506  Vali Loss: 0.0146874 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 4.769741058349609
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0117559  Vali Loss: 0.0147161 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 4.767473936080933
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0117837  Vali Loss: 0.0139914 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
new best score!!!!
Validation loss decreased (0.014330 --> 0.013991).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 4.767229318618774
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0109414  Vali Loss: 0.0141593 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 4.7667396068573
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0107615  Vali Loss: 0.0140858 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 4.765598773956299
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0114492  Vali Loss: 0.0141380 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962314  Vali macro F1 0.9964947 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 4.762831687927246
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0107155  Vali Loss: 0.0145270 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 4.765874624252319
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0105885  Vali Loss: 0.0145339 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 40 cost time: 4.771947383880615
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0113506  Vali Loss: 0.0145119 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 4.76671838760376
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0106383  Vali Loss: 0.0145007 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 4.764303684234619
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0101764  Vali Loss: 0.0144833 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 4.764919996261597
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0105327  Vali Loss: 0.0144552 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 4.767583847045898
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0106240  Vali Loss: 0.0144247 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 45 cost time: 4.768630266189575
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0097712  Vali Loss: 0.0144239 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 46 cost time: 4.765276670455933
Fine Tuning VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0108343  Vali Loss: 0.0144195 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 47 cost time: 4.76489782333374
Fine Tuning VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0104399  Vali Loss: 0.0144164 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 48 cost time: 4.7641236782073975
Fine Tuning VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0107671  Vali Loss: 0.0144142 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 49 cost time: 4.764971017837524
Fine Tuning VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0109596  Vali Loss: 0.0144086 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949775  Vali macro F1 0.9952792 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8219298  Test weighted F1: 0.7782929  Test macro F1 0.7782929 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.454185724258423
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8842138  Vali Loss: 2.5259600 Vali Accuracy: 0.3533835  Vali weighted F1: 0.3106620  Vali macro F1 0.3168051 
Validation loss decreased (inf --> 2.525960).  Saving model ...
Epoch: 2 cost time: 3.4417428970336914
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8695636  Vali Loss: 1.3133075 Vali Accuracy: 0.7969925  Vali weighted F1: 0.7807581  Vali macro F1 0.7837587 
new best score!!!!
Validation loss decreased (2.525960 --> 1.313307).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3772788047790527
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.1036592  Vali Loss: 0.8562301 Vali Accuracy: 0.8872180  Vali weighted F1: 0.8740451  Vali macro F1 0.8726976 
new best score!!!!
Validation loss decreased (1.313307 --> 0.856230).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3716964721679688
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7441170  Vali Loss: 0.6143973 Vali Accuracy: 0.9210526  Vali weighted F1: 0.9167615  Vali macro F1 0.9148513 
new best score!!!!
Validation loss decreased (0.856230 --> 0.614397).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3619589805603027
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5298985  Vali Loss: 0.4409670 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9510364  Vali macro F1 0.9511605 
new best score!!!!
Validation loss decreased (0.614397 --> 0.440967).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.366915702819824
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3993079  Vali Loss: 0.3535088 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9548389  Vali macro F1 0.9544742 
new best score!!!!
Validation loss decreased (0.440967 --> 0.353509).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.362851619720459
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2980588  Vali Loss: 0.2610430 Vali Accuracy: 0.9598997  Vali weighted F1: 0.9584854  Vali macro F1 0.9584354 
new best score!!!!
Validation loss decreased (0.353509 --> 0.261043).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.366909980773926
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2351491  Vali Loss: 0.2190186 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9720241  Vali macro F1 0.9717995 
new best score!!!!
Validation loss decreased (0.261043 --> 0.219019).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3658905029296875
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1911367  Vali Loss: 0.1719750 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809293  Vali macro F1 0.9811817 
new best score!!!!
Validation loss decreased (0.219019 --> 0.171975).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.842699766159058
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1601832  Vali Loss: 0.1436388 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809428  Vali macro F1 0.9808226 
new best score!!!!
Validation loss decreased (0.171975 --> 0.143639).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.367624044418335
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1308624  Vali Loss: 0.1312786 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811256  Vali macro F1 0.9817819 
new best score!!!!
Validation loss decreased (0.143639 --> 0.131279).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.36970591545105
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1124163  Vali Loss: 0.1125558 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811532  Vali macro F1 0.9818015 
new best score!!!!
Validation loss decreased (0.131279 --> 0.112556).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3665809631347656
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0991975  Vali Loss: 0.0957700 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873460  Vali macro F1 0.9881638 
new best score!!!!
Validation loss decreased (0.112556 --> 0.095770).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.367155075073242
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0971447  Vali Loss: 0.0888555 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886468  Vali macro F1 0.9888699 
new best score!!!!
Validation loss decreased (0.095770 --> 0.088855).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3729779720306396
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.1407667  Vali Loss: 0.0956948 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9821999  Vali macro F1 0.9830451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 3.3800151348114014
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.1076979  Vali Loss: 0.0852869 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9834945  Vali macro F1 0.9840442 
new best score!!!!
Validation loss decreased (0.088855 --> 0.085287).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.422239303588867
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0681413  Vali Loss: 0.0668665 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899759  Vali macro F1 0.9896802 
new best score!!!!
Validation loss decreased (0.085287 --> 0.066867).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3971407413482666
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0557683  Vali Loss: 0.0574062 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924653  Vali macro F1 0.9928285 
new best score!!!!
Validation loss decreased (0.066867 --> 0.057406).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3746535778045654
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0531532  Vali Loss: 0.0589867 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899026  Vali macro F1 0.9898393 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.3679301738739014
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0473617  Vali Loss: 0.0481204 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911835  Vali macro F1 0.9910986 
new best score!!!!
Validation loss decreased (0.057406 --> 0.048120).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.370842456817627
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0431493  Vali Loss: 0.0453081 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924544  Vali macro F1 0.9925193 
new best score!!!!
Validation loss decreased (0.048120 --> 0.045308).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.3723199367523193
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0380959  Vali Loss: 0.0409065 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937372  Vali macro F1 0.9940638 
new best score!!!!
Validation loss decreased (0.045308 --> 0.040907).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3676319122314453
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0366603  Vali Loss: 0.0459473 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911421  Vali macro F1 0.9911292 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.3760204315185547
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0383640  Vali Loss: 0.0423851 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925422  Vali macro F1 0.9924392 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 3.3680994510650635
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0371701  Vali Loss: 0.0376724 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962462  Vali macro F1 0.9965098 
new best score!!!!
Validation loss decreased (0.040907 --> 0.037672).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.371108055114746
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0305215  Vali Loss: 0.0375693 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924596  Vali macro F1 0.9923518 
new best score!!!!
Validation loss decreased (0.037672 --> 0.037569).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3736157417297363
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0294601  Vali Loss: 0.0423811 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886452  Vali macro F1 0.9887412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.368636131286621
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0305373  Vali Loss: 0.0475193 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9878493  Vali macro F1 0.9883571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 3.3671326637268066
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.1035558  Vali Loss: 0.0770627 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808447  Vali macro F1 0.9813775 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 3.3706881999969482
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0508444  Vali Loss: 0.0443630 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885892  Vali macro F1 0.9885719 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 3.3726460933685303
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0361868  Vali Loss: 0.0436432 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886639  Vali macro F1 0.9888582 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 3.37349271774292
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0304144  Vali Loss: 0.0412028 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899389  Vali macro F1 0.9901103 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 3.4161179065704346
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0303926  Vali Loss: 0.0394885 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886639  Vali macro F1 0.9888582 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 3.4052419662475586
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0290476  Vali Loss: 0.0381764 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911970  Vali macro F1 0.9912193 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 3.3747260570526123
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0285265  Vali Loss: 0.0383429 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899210  Vali macro F1 0.9899661 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 3.3682196140289307
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0292657  Vali Loss: 0.0353077 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911730  Vali macro F1 0.9915428 
new best score!!!!
Validation loss decreased (0.037569 --> 0.035308).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.3697454929351807
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0290583  Vali Loss: 0.0334599 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911730  Vali macro F1 0.9915428 
new best score!!!!
Validation loss decreased (0.035308 --> 0.033460).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 3.3731536865234375
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0290100  Vali Loss: 0.0320933 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937116  Vali macro F1 0.9939285 
new best score!!!!
Validation loss decreased (0.033460 --> 0.032093).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.370647668838501
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0297621  Vali Loss: 0.0307940 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924490  Vali macro F1 0.9927960 
new best score!!!!
Validation loss decreased (0.032093 --> 0.030794).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.377009868621826
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0264969  Vali Loss: 0.0315984 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924596  Vali macro F1 0.9923518 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 3.3706324100494385
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0271105  Vali Loss: 0.0334678 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912133  Vali macro F1 0.9912517 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 3.367020845413208
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0271021  Vali Loss: 0.0321169 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912133  Vali macro F1 0.9912517 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 3.3666176795959473
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0253645  Vali Loss: 0.0300573 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912133  Vali macro F1 0.9912517 
new best score!!!!
Validation loss decreased (0.030794 --> 0.030057).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.3687658309936523
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0255525  Vali Loss: 0.0297765 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
new best score!!!!
Validation loss decreased (0.030057 --> 0.029777).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.3696861267089844
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0256925  Vali Loss: 0.0317231 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.370119333267212
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0251440  Vali Loss: 0.0298845 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.369124412536621
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0244144  Vali Loss: 0.0289127 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937372  Vali macro F1 0.9940638 
new best score!!!!
Validation loss decreased (0.029777 --> 0.028913).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.3808863162994385
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0257841  Vali Loss: 0.0296526 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.3676295280456543
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0245359  Vali Loss: 0.0300418 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.4280991554260254
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0244777  Vali Loss: 0.0302026 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937413  Vali macro F1 0.9936622 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.388352155685425
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0238887  Vali Loss: 0.0290729 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937413  Vali macro F1 0.9936622 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 3.368424892425537
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0240607  Vali Loss: 0.0284851 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924724  Vali macro F1 0.9924188 
new best score!!!!
Validation loss decreased (0.028913 --> 0.028485).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 3.367177724838257
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0242647  Vali Loss: 0.0268791 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937372  Vali macro F1 0.9940638 
new best score!!!!
Validation loss decreased (0.028485 --> 0.026879).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 3.367659091949463
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0275591  Vali Loss: 0.0274374 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924724  Vali macro F1 0.9924188 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 3.3674051761627197
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0235132  Vali Loss: 0.0275064 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924724  Vali macro F1 0.9924188 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 3.373713970184326
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0232157  Vali Loss: 0.0273164 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924724  Vali macro F1 0.9924188 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 3.370753049850464
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0220896  Vali Loss: 0.0267862 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924724  Vali macro F1 0.9924188 
new best score!!!!
Validation loss decreased (0.026879 --> 0.026786).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 3.370807647705078
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0292829  Vali Loss: 0.0261811 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937413  Vali macro F1 0.9936622 
new best score!!!!
Validation loss decreased (0.026786 --> 0.026181).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 3.3699538707733154
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0220631  Vali Loss: 0.0265796 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924724  Vali macro F1 0.9924188 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 3.3699159622192383
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0224138  Vali Loss: 0.0252227 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949734  Vali macro F1 0.9948555 
new best score!!!!
Validation loss decreased (0.026181 --> 0.025223).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 3.36800479888916
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0219508  Vali Loss: 0.0254665 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924724  Vali macro F1 0.9924188 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 3.368887424468994
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0214098  Vali Loss: 0.0271677 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 3.3720273971557617
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0212725  Vali Loss: 0.0270856 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 3.383493185043335
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0208210  Vali Loss: 0.0268166 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 3.4132895469665527
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0223640  Vali Loss: 0.0257272 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 66 cost time: 3.4011545181274414
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0204203  Vali Loss: 0.0258566 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 3.376802682876587
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0201423  Vali Loss: 0.0260106 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 3.366527795791626
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0209686  Vali Loss: 0.0261690 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 3.3672902584075928
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0230516  Vali Loss: 0.0263393 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 3.3668930530548096
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0198275  Vali Loss: 0.0261458 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 71 cost time: 3.370429277420044
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0217202  Vali Loss: 0.0261608 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 3.3686234951019287
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0203173  Vali Loss: 0.0261703 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 3.4424314498901367
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0203036  Vali Loss: 0.0261977 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 3.3663148880004883
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0205072  Vali Loss: 0.0262147 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 3.3677988052368164
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0195454  Vali Loss: 0.0262275 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8728070  Test weighted F1: 0.8446768  Test macro F1 0.8446768 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.774184703826904
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0211638  Vali Loss: 0.0266986 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937413  Vali macro F1 0.9936622 
Validation loss decreased (inf --> 0.026699).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.765131711959839
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0206499  Vali Loss: 0.0261135 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937409  Vali macro F1 0.9936618 
new best score!!!!
Validation loss decreased (0.026699 --> 0.026114).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.769712924957275
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0229009  Vali Loss: 0.0220873 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9948549 
new best score!!!!
Validation loss decreased (0.026114 --> 0.022087).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.764160871505737
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0200196  Vali Loss: 0.0220072 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937210  Vali macro F1 0.9936432 
new best score!!!!
Validation loss decreased (0.022087 --> 0.022007).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.766389846801758
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0186929  Vali Loss: 0.0270361 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924852  Vali macro F1 0.9924871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.771028280258179
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0182490  Vali Loss: 0.0262800 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924714  Vali macro F1 0.9924178 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 4.769590377807617
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0176875  Vali Loss: 0.0197066 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974948  Vali macro F1 0.9976636 
new best score!!!!
Validation loss decreased (0.022007 --> 0.019707).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.768470525741577
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0180376  Vali Loss: 0.0181382 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949728  Vali macro F1 0.9948549 
new best score!!!!
Validation loss decreased (0.019707 --> 0.018138).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.769035577774048
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0173278  Vali Loss: 0.0205971 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949856  Vali macro F1 0.9951109 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.770225763320923
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0168295  Vali Loss: 0.0211264 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924714  Vali macro F1 0.9924178 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 4.77028489112854
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0161695  Vali Loss: 0.0179389 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949856  Vali macro F1 0.9951109 
new best score!!!!
Validation loss decreased (0.018138 --> 0.017939).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.768022298812866
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0170669  Vali Loss: 0.0194986 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962426  Vali macro F1 0.9960993 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.770556688308716
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0147007  Vali Loss: 0.0218819 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924714  Vali macro F1 0.9924178 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 4.7681238651275635
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0155999  Vali Loss: 0.0210529 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937336  Vali macro F1 0.9935342 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 4.7718377113342285
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0144873  Vali Loss: 0.0193368 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950036  Vali macro F1 0.9947661 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 4.770000457763672
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0140463  Vali Loss: 0.0179884 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962556  Vali macro F1 0.9963428 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 4.7700841426849365
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0146853  Vali Loss: 0.0144933 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987460  Vali macro F1 0.9987719 
new best score!!!!
Validation loss decreased (0.017939 --> 0.014493).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 4.766807556152344
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0138107  Vali Loss: 0.0201098 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937372  Vali macro F1 0.9940638 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.766701936721802
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0134679  Vali Loss: 0.0197249 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924874  Vali macro F1 0.9922978 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 4.766282796859741
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0130656  Vali Loss: 0.0175975 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962401  Vali macro F1 0.9958593 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 4.769577741622925
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0127478  Vali Loss: 0.0177682 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950034  Vali macro F1 0.9947785 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 4.7654335498809814
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0126879  Vali Loss: 0.0169793 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 4.769690752029419
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0128886  Vali Loss: 0.0168207 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 4.768225193023682
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0127503  Vali Loss: 0.0169215 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 4.762800455093384
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0119125  Vali Loss: 0.0170387 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 4.768122911453247
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0154023  Vali Loss: 0.0172303 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950034  Vali macro F1 0.9947785 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 4.765631198883057
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0125471  Vali Loss: 0.0172363 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 28 cost time: 4.769944906234741
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0132979  Vali Loss: 0.0172451 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 4.765644788742065
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0126228  Vali Loss: 0.0172505 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 4.768178939819336
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0121799  Vali Loss: 0.0172365 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 4.77071213722229
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0121717  Vali Loss: 0.0172482 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 4.767589092254639
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0140673  Vali Loss: 0.0172624 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962576  Vali macro F1 0.9959942 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8745614  Test weighted F1: 0.8387331  Test macro F1 0.8387331 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.43402099609375
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8783345  Vali Loss: 2.4996793 Vali Accuracy: 0.2944862  Vali weighted F1: 0.2427483  Vali macro F1 0.2525509 
Validation loss decreased (inf --> 2.499679).  Saving model ...
Epoch: 2 cost time: 3.3634660243988037
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8346104  Vali Loss: 1.3062379 Vali Accuracy: 0.7894737  Vali weighted F1: 0.7780903  Vali macro F1 0.7737186 
new best score!!!!
Validation loss decreased (2.499679 --> 1.306238).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.366947889328003
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0754995  Vali Loss: 0.8156222 Vali Accuracy: 0.8746867  Vali weighted F1: 0.8689197  Vali macro F1 0.8677273 
new best score!!!!
Validation loss decreased (1.306238 --> 0.815622).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3688387870788574
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7192042  Vali Loss: 0.5621786 Vali Accuracy: 0.9185464  Vali weighted F1: 0.9164519  Vali macro F1 0.9133880 
new best score!!!!
Validation loss decreased (0.815622 --> 0.562179).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.371349573135376
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5148355  Vali Loss: 0.4195436 Vali Accuracy: 0.9411028  Vali weighted F1: 0.9381600  Vali macro F1 0.9343738 
new best score!!!!
Validation loss decreased (0.562179 --> 0.419544).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.37803053855896
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3892836  Vali Loss: 0.3267397 Vali Accuracy: 0.9536341  Vali weighted F1: 0.9528321  Vali macro F1 0.9508167 
new best score!!!!
Validation loss decreased (0.419544 --> 0.326740).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3683278560638428
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.3086125  Vali Loss: 0.2600011 Vali Accuracy: 0.9636591  Vali weighted F1: 0.9623099  Vali macro F1 0.9622138 
new best score!!!!
Validation loss decreased (0.326740 --> 0.260001).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.4333837032318115
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2514936  Vali Loss: 0.2148325 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9640723  Vali macro F1 0.9648242 
new best score!!!!
Validation loss decreased (0.260001 --> 0.214833).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3873116970062256
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.2085212  Vali Loss: 0.1868085 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9561611  Vali macro F1 0.9553505 
new best score!!!!
Validation loss decreased (0.214833 --> 0.186809).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.37508225440979
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1884324  Vali Loss: 0.1644665 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9634250  Vali macro F1 0.9636040 
new best score!!!!
Validation loss decreased (0.186809 --> 0.164467).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.372248649597168
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1508201  Vali Loss: 0.1336683 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9796957  Vali macro F1 0.9802077 
new best score!!!!
Validation loss decreased (0.164467 --> 0.133668).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3696532249450684
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1363159  Vali Loss: 0.1222443 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9769344  Vali macro F1 0.9780092 
new best score!!!!
Validation loss decreased (0.133668 --> 0.122244).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.366267442703247
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1161185  Vali Loss: 0.1033241 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9808837  Vali macro F1 0.9819235 
new best score!!!!
Validation loss decreased (0.122244 --> 0.103324).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.373495578765869
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0970158  Vali Loss: 0.1068300 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9771648  Vali macro F1 0.9780113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 3.3707516193389893
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0958679  Vali Loss: 0.0861966 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9835652  Vali macro F1 0.9840411 
new best score!!!!
Validation loss decreased (0.103324 --> 0.086197).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3737404346466064
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0786913  Vali Loss: 0.0798073 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9822089  Vali macro F1 0.9826333 
new best score!!!!
Validation loss decreased (0.086197 --> 0.079807).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.371386766433716
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0796053  Vali Loss: 0.0763969 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885822  Vali macro F1 0.9890470 
new best score!!!!
Validation loss decreased (0.079807 --> 0.076397).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.367020606994629
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0811054  Vali Loss: 0.0782673 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873273  Vali macro F1 0.9874633 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 3.3692245483398438
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0618784  Vali Loss: 0.0624318 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9859608  Vali macro F1 0.9864776 
new best score!!!!
Validation loss decreased (0.076397 --> 0.062432).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.365750312805176
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0549081  Vali Loss: 0.0536896 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898619  Vali macro F1 0.9902580 
new best score!!!!
Validation loss decreased (0.062432 --> 0.053690).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3691768646240234
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0512307  Vali Loss: 0.0590666 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9819292  Vali macro F1 0.9825702 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.3721845149993896
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0482899  Vali Loss: 0.0436028 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911288  Vali macro F1 0.9913663 
new best score!!!!
Validation loss decreased (0.053690 --> 0.043603).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3666834831237793
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0440266  Vali Loss: 0.0488103 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9885783  Vali macro F1 0.9893694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.3810274600982666
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0482614  Vali Loss: 0.0411165 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
new best score!!!!
Validation loss decreased (0.043603 --> 0.041116).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.42134952545166
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0385932  Vali Loss: 0.0372781 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924405  Vali macro F1 0.9928169 
new best score!!!!
Validation loss decreased (0.041116 --> 0.037278).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.40083384513855
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0383667  Vali Loss: 0.0373839 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911084  Vali macro F1 0.9916769 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 3.3719637393951416
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0333781  Vali Loss: 0.0354056 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.037278 --> 0.035406).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.36789870262146
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0329448  Vali Loss: 0.0327034 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.035406 --> 0.032703).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.3646366596221924
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0419098  Vali Loss: 0.0449401 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873697  Vali macro F1 0.9877088 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.365190267562866
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0320318  Vali Loss: 0.0338233 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911633  Vali macro F1 0.9915455 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 3.3681869506835938
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0264686  Vali Loss: 0.0302907 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.032703 --> 0.030291).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.366533041000366
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0248755  Vali Loss: 0.0298952 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924546  Vali macro F1 0.9925268 
new best score!!!!
Validation loss decreased (0.030291 --> 0.029895).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.3631556034088135
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0244562  Vali Loss: 0.0319549 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898749  Vali macro F1 0.9903689 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.366619825363159
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0230531  Vali Loss: 0.0335233 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911607  Vali macro F1 0.9916251 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 3.3664002418518066
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0226930  Vali Loss: 0.0248654 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
new best score!!!!
Validation loss decreased (0.029895 --> 0.024865).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.3621973991394043
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0225213  Vali Loss: 0.0294533 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898749  Vali macro F1 0.9903689 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.3710896968841553
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0218408  Vali Loss: 0.0289776 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899079  Vali macro F1 0.9904146 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.3721511363983154
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0183935  Vali Loss: 0.0256511 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 3.3740665912628174
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0164934  Vali Loss: 0.0248946 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911607  Vali macro F1 0.9916251 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 3.3841328620910645
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0174697  Vali Loss: 0.0287810 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937095  Vali macro F1 0.9941106 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 3.4195005893707275
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0175473  Vali Loss: 0.0300294 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911607  Vali macro F1 0.9916251 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.3831238746643066
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0208920  Vali Loss: 0.0288810 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 4.537133455276489
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0150825  Vali Loss: 0.0245602 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.024865 --> 0.024560).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.477402925491333
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0146174  Vali Loss: 0.0239987 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.024560 --> 0.023999).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.3659117221832275
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0146127  Vali Loss: 0.0243735 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911607  Vali macro F1 0.9916251 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.3679449558258057
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0157496  Vali Loss: 0.0240970 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911607  Vali macro F1 0.9916251 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.373354434967041
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0154520  Vali Loss: 0.0237090 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.023999 --> 0.023709).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.3692691326141357
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0141049  Vali Loss: 0.0239954 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.369284152984619
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0146192  Vali Loss: 0.0242790 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911607  Vali macro F1 0.9916251 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.365952968597412
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0149442  Vali Loss: 0.0242510 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.3652713298797607
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0150667  Vali Loss: 0.0236411 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.023709 --> 0.023641).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.3643202781677246
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0149146  Vali Loss: 0.0233461 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.023641 --> 0.023346).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 3.3645739555358887
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0148602  Vali Loss: 0.0251291 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911607  Vali macro F1 0.9916251 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.3777809143066406
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0142274  Vali Loss: 0.0244023 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.4137253761291504
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0141884  Vali Loss: 0.0249156 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.4125864505767822
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0143124  Vali Loss: 0.0243999 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 3.3736815452575684
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0140586  Vali Loss: 0.0245119 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 58 cost time: 3.3689675331115723
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0150031  Vali Loss: 0.0244379 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.369525909423828
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0139906  Vali Loss: 0.0242381 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 3.3700058460235596
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0138203  Vali Loss: 0.0241758 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 3.3691186904907227
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0136379  Vali Loss: 0.0240870 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 3.368304967880249
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0129986  Vali Loss: 0.0240311 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 63 cost time: 3.378138303756714
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0136394  Vali Loss: 0.0240334 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 3.3744938373565674
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0133402  Vali Loss: 0.0240314 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 3.3713300228118896
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0132779  Vali Loss: 0.0240389 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 3.3705620765686035
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0139415  Vali Loss: 0.0240380 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 3.369643449783325
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0147725  Vali Loss: 0.0240192 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9614035  Test weighted F1: 0.9607222  Test macro F1 0.9607222 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.815436840057373
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0135753  Vali Loss: 0.0235822 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
Validation loss decreased (inf --> 0.023582).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.742199897766113
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0137510  Vali Loss: 0.0231683 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.023582 --> 0.023168).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.749070882797241
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0126820  Vali Loss: 0.0219879 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
new best score!!!!
Validation loss decreased (0.023168 --> 0.021988).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.745185136795044
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0131531  Vali Loss: 0.0229066 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911607  Vali macro F1 0.9916251 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.744448661804199
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0137430  Vali Loss: 0.0213662 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.021988 --> 0.021366).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.744807958602905
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0122567  Vali Loss: 0.0210287 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
new best score!!!!
Validation loss decreased (0.021366 --> 0.021029).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.7443528175354
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0116913  Vali Loss: 0.0213165 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.741542339324951
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0124475  Vali Loss: 0.0224475 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 4.750310659408569
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0115502  Vali Loss: 0.0220337 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 4.748159170150757
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0112506  Vali Loss: 0.0216004 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 4.751508951187134
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0118800  Vali Loss: 0.0217485 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 4.7509777545928955
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0114418  Vali Loss: 0.0210056 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937095  Vali macro F1 0.9941106 
new best score!!!!
Validation loss decreased (0.021029 --> 0.021006).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.751189947128296
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0111583  Vali Loss: 0.0217720 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.753079414367676
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0110713  Vali Loss: 0.0203651 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936924  Vali macro F1 0.9938694 
new best score!!!!
Validation loss decreased (0.021006 --> 0.020365).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.75827169418335
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0109674  Vali Loss: 0.0192951 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
new best score!!!!
Validation loss decreased (0.020365 --> 0.019295).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.756606340408325
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0106059  Vali Loss: 0.0201113 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 4.757103204727173
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0134084  Vali Loss: 0.0206597 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 4.752278566360474
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0104496  Vali Loss: 0.0200150 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 4.75817084312439
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0094474  Vali Loss: 0.0198495 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 4.7529613971710205
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0097271  Vali Loss: 0.0196006 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 4.756871700286865
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0098167  Vali Loss: 0.0195299 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.7527406215667725
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0090262  Vali Loss: 0.0197341 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 4.758605718612671
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0092518  Vali Loss: 0.0196931 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 4.757483243942261
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0090673  Vali Loss: 0.0198247 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 4.757004261016846
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0102561  Vali Loss: 0.0198001 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 4.759166479110718
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0096315  Vali Loss: 0.0197534 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.7593677043914795
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0090793  Vali Loss: 0.0197552 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.75491189956665
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0097638  Vali Loss: 0.0197442 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 4.752676725387573
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0103374  Vali Loss: 0.0197591 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 4.756616830825806
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0097825  Vali Loss: 0.0197566 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924385  Vali macro F1 0.9928720 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9570175  Test weighted F1: 0.9564155  Test macro F1 0.9564155 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4245738983154297
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8936951  Vali Loss: 2.5746103 Vali Accuracy: 0.3446115  Vali weighted F1: 0.2877931  Vali macro F1 0.2985127 
Validation loss decreased (inf --> 2.574610).  Saving model ...
Epoch: 2 cost time: 3.3700368404388428
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.8835510  Vali Loss: 1.2865150 Vali Accuracy: 0.8107769  Vali weighted F1: 0.7996190  Vali macro F1 0.7979411 
new best score!!!!
Validation loss decreased (2.574610 --> 1.286515).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.365422487258911
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0798838  Vali Loss: 0.8226547 Vali Accuracy: 0.8884712  Vali weighted F1: 0.8815963  Vali macro F1 0.8790395 
new best score!!!!
Validation loss decreased (1.286515 --> 0.822655).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.363739490509033
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7054153  Vali Loss: 0.5826487 Vali Accuracy: 0.9210526  Vali weighted F1: 0.9158374  Vali macro F1 0.9163042 
new best score!!!!
Validation loss decreased (0.822655 --> 0.582649).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.367924451828003
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5022463  Vali Loss: 0.4238048 Vali Accuracy: 0.9373434  Vali weighted F1: 0.9341125  Vali macro F1 0.9359720 
new best score!!!!
Validation loss decreased (0.582649 --> 0.423805).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3643558025360107
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3851168  Vali Loss: 0.3277126 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9573096  Vali macro F1 0.9581429 
new best score!!!!
Validation loss decreased (0.423805 --> 0.327713).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3745369911193848
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2926199  Vali Loss: 0.2575724 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9630709  Vali macro F1 0.9633235 
new best score!!!!
Validation loss decreased (0.327713 --> 0.257572).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.373460531234741
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2318066  Vali Loss: 0.2064484 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9743146  Vali macro F1 0.9751379 
new best score!!!!
Validation loss decreased (0.257572 --> 0.206448).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.427098512649536
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1898666  Vali Loss: 0.1646512 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9729197  Vali macro F1 0.9725410 
new best score!!!!
Validation loss decreased (0.206448 --> 0.164651).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.3869292736053467
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1548303  Vali Loss: 0.1399262 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9769030  Vali macro F1 0.9775608 
new best score!!!!
Validation loss decreased (0.164651 --> 0.139926).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.374229907989502
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1265177  Vali Loss: 0.1181588 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9797394  Vali macro F1 0.9798213 
new best score!!!!
Validation loss decreased (0.139926 --> 0.118159).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.370968818664551
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1103667  Vali Loss: 0.1033599 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861474  Vali macro F1 0.9871480 
new best score!!!!
Validation loss decreased (0.118159 --> 0.103360).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3734242916107178
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0920130  Vali Loss: 0.0869605 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899524  Vali macro F1 0.9901106 
new best score!!!!
Validation loss decreased (0.103360 --> 0.086960).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.367115020751953
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0799042  Vali Loss: 0.0760078 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899939  Vali macro F1 0.9901511 
new best score!!!!
Validation loss decreased (0.086960 --> 0.076008).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.365642786026001
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0686730  Vali Loss: 0.0650266 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912026  Vali macro F1 0.9908040 
new best score!!!!
Validation loss decreased (0.076008 --> 0.065027).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.372816324234009
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0593988  Vali Loss: 0.0637499 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912090  Vali macro F1 0.9914719 
new best score!!!!
Validation loss decreased (0.065027 --> 0.063750).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.366971731185913
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0548984  Vali Loss: 0.0491974 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924956  Vali macro F1 0.9923917 
new best score!!!!
Validation loss decreased (0.063750 --> 0.049197).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3712103366851807
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0529142  Vali Loss: 0.0551288 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899496  Vali macro F1 0.9901035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 3.3721940517425537
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0491058  Vali Loss: 0.0504933 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924847  Vali macro F1 0.9924990 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 3.3703091144561768
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0450414  Vali Loss: 0.0455073 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899622  Vali macro F1 0.9900459 
new best score!!!!
Validation loss decreased (0.049197 --> 0.045507).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3713948726654053
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0377740  Vali Loss: 0.0373286 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974939  Vali macro F1 0.9972076 
new best score!!!!
Validation loss decreased (0.045507 --> 0.037329).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.3703856468200684
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0389112  Vali Loss: 0.0354693 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949871  Vali macro F1 0.9947153 
new best score!!!!
Validation loss decreased (0.037329 --> 0.035469).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3741347789764404
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0364337  Vali Loss: 0.0317560 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962393  Vali macro F1 0.9959275 
new best score!!!!
Validation loss decreased (0.035469 --> 0.031756).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3763201236724854
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0349749  Vali Loss: 0.0347550 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.369483232498169
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0341535  Vali Loss: 0.0354979 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937263  Vali macro F1 0.9936533 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 3.4339888095855713
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0311102  Vali Loss: 0.0395475 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899822  Vali macro F1 0.9901814 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 3.4108664989471436
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0285942  Vali Loss: 0.0347795 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899376  Vali macro F1 0.9899075 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 3.373814821243286
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0282991  Vali Loss: 0.0292991 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974955  Vali macro F1 0.9972108 
new best score!!!!
Validation loss decreased (0.031756 --> 0.029299).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.369006395339966
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0469982  Vali Loss: 0.0319728 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924790  Vali macro F1 0.9923893 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 3.3650665283203125
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0293512  Vali Loss: 0.0328872 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937475  Vali macro F1 0.9941991 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 3.366870164871216
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0245704  Vali Loss: 0.0253852 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962393  Vali macro F1 0.9959275 
new best score!!!!
Validation loss decreased (0.029299 --> 0.025385).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.37136173248291
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0203828  Vali Loss: 0.0243377 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
new best score!!!!
Validation loss decreased (0.025385 --> 0.024338).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.370826244354248
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0204215  Vali Loss: 0.0331690 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949864  Vali macro F1 0.9948800 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.3707993030548096
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0196861  Vali Loss: 0.0208984 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
new best score!!!!
Validation loss decreased (0.024338 --> 0.020898).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.36723256111145
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0188215  Vali Loss: 0.0231425 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987480  Vali macro F1 0.9984233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.367846727371216
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0196581  Vali Loss: 0.0271171 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.368960380554199
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0206129  Vali Loss: 0.0287187 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924776  Vali macro F1 0.9928520 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 3.3659026622772217
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0228731  Vali Loss: 0.0284148 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924847  Vali macro F1 0.9924990 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 3.368992567062378
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0183071  Vali Loss: 0.0231459 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962402  Vali macro F1 0.9963961 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 3.3693904876708984
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0156646  Vali Loss: 0.0232149 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 3.3760945796966553
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0151862  Vali Loss: 0.0228112 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 3.4118740558624268
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0157669  Vali Loss: 0.0218590 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 3.4096717834472656
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0140943  Vali Loss: 0.0223175 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 3.3732199668884277
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0142329  Vali Loss: 0.0222443 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 3.366166114807129
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0142304  Vali Loss: 0.0222095 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.3678500652313232
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0144981  Vali Loss: 0.0221669 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.367039918899536
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0141748  Vali Loss: 0.0221745 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 3.3712353706359863
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0151419  Vali Loss: 0.0222840 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 3.365631341934204
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0143228  Vali Loss: 0.0225230 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9245614  Test weighted F1: 0.9076687  Test macro F1 0.9076687 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.7832350730896
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0184020  Vali Loss: 0.0272040 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
Validation loss decreased (inf --> 0.027204).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.781038045883179
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0173306  Vali Loss: 0.0262477 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
new best score!!!!
Validation loss decreased (0.027204 --> 0.026248).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.7795798778533936
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0160470  Vali Loss: 0.0275488 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.78169059753418
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0154729  Vali Loss: 0.0222174 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962393  Vali macro F1 0.9959275 
new best score!!!!
Validation loss decreased (0.026248 --> 0.022217).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.77613091468811
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0152497  Vali Loss: 0.0251907 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949926  Vali macro F1 0.9952947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.780100584030151
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0153374  Vali Loss: 0.0248383 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 4.781587839126587
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0142604  Vali Loss: 0.0179880 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962393  Vali macro F1 0.9959275 
new best score!!!!
Validation loss decreased (0.022217 --> 0.017988).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 4.780437469482422
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0142354  Vali Loss: 0.0256917 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937406  Vali macro F1 0.9937179 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 4.7789905071258545
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0142647  Vali Loss: 0.0214301 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 4.776042222976685
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0139076  Vali Loss: 0.0236627 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 4.776782989501953
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0136693  Vali Loss: 0.0167208 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962393  Vali macro F1 0.9959275 
new best score!!!!
Validation loss decreased (0.017988 --> 0.016721).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.773313522338867
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0126895  Vali Loss: 0.0169240 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962393  Vali macro F1 0.9959275 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.773135662078857
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0127667  Vali Loss: 0.0177669 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962393  Vali macro F1 0.9959275 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 4.774876117706299
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0121540  Vali Loss: 0.0189777 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 4.770898103713989
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0130836  Vali Loss: 0.0210964 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 4.768396377563477
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0116199  Vali Loss: 0.0169437 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974939  Vali macro F1 0.9972076 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 4.773640155792236
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0112477  Vali Loss: 0.0186535 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.7707579135894775
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0123277  Vali Loss: 0.0170829 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 4.773289442062378
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0115168  Vali Loss: 0.0166624 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
new best score!!!!
Validation loss decreased (0.016721 --> 0.016662).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.776404142379761
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0116860  Vali Loss: 0.0183717 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.77289342880249
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0109700  Vali Loss: 0.0219489 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.779095649719238
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0113157  Vali Loss: 0.0207089 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 4.7756593227386475
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0108365  Vali Loss: 0.0161434 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
new best score!!!!
Validation loss decreased (0.016662 --> 0.016143).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 4.7734527587890625
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0115350  Vali Loss: 0.0136732 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974939  Vali macro F1 0.9972076 
new best score!!!!
Validation loss decreased (0.016143 --> 0.013673).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.779469013214111
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0103791  Vali Loss: 0.0167029 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 4.776852607727051
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0107627  Vali Loss: 0.0184434 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 4.780203104019165
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0100658  Vali Loss: 0.0182855 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 4.776311635971069
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0089795  Vali Loss: 0.0142232 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974939  Vali macro F1 0.9972076 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 4.772456407546997
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0163412  Vali Loss: 0.0176860 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 30 cost time: 4.778429746627808
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0119516  Vali Loss: 0.0179594 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 4.779522180557251
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0092647  Vali Loss: 0.0187576 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 4.7767322063446045
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0102696  Vali Loss: 0.0185005 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949882  Vali macro F1 0.9948194 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 4.77778172492981
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0099108  Vali Loss: 0.0168426 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 4.777960777282715
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0103969  Vali Loss: 0.0156931 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 35 cost time: 4.780044794082642
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0093286  Vali Loss: 0.0156103 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 4.780269384384155
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0100493  Vali Loss: 0.0156831 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 4.77989649772644
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0093815  Vali Loss: 0.0158423 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 4.779351234436035
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0106041  Vali Loss: 0.0158387 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 4.779745578765869
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0090708  Vali Loss: 0.0158571 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960995 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9157895  Test weighted F1: 0.8967929  Test macro F1 0.8967929 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00265957 0.00271739 0.0026738  0.00252525 0.00263852 0.00266667
 0.0026738  0.00263852 0.00263852 0.00257069 0.00260417 0.00263158
 0.00266667 0.0026455  0.00262467 0.0027027  0.00263852 0.0026178
 0.00274725]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.467473030090332
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8739773  Vali Loss: 2.4707088 Vali Accuracy: 0.3358396  Vali weighted F1: 0.2838518  Vali macro F1 0.2927933 
Validation loss decreased (inf --> 2.470709).  Saving model ...
Epoch: 2 cost time: 3.3689088821411133
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.7888440  Vali Loss: 1.2702127 Vali Accuracy: 0.8120301  Vali weighted F1: 0.7962550  Vali macro F1 0.7926969 
new best score!!!!
Validation loss decreased (2.470709 --> 1.270213).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.368631601333618
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0355381  Vali Loss: 0.8042037 Vali Accuracy: 0.8909774  Vali weighted F1: 0.8794126  Vali macro F1 0.8773630 
new best score!!!!
Validation loss decreased (1.270213 --> 0.804204).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3615479469299316
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7041791  Vali Loss: 0.5611470 Vali Accuracy: 0.9298246  Vali weighted F1: 0.9239076  Vali macro F1 0.9203718 
new best score!!!!
Validation loss decreased (0.804204 --> 0.561147).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.361773729324341
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4894903  Vali Loss: 0.4150603 Vali Accuracy: 0.9448622  Vali weighted F1: 0.9420264  Vali macro F1 0.9369791 
new best score!!!!
Validation loss decreased (0.561147 --> 0.415060).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3609282970428467
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3673240  Vali Loss: 0.2977051 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9610738  Vali macro F1 0.9584734 
new best score!!!!
Validation loss decreased (0.415060 --> 0.297705).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.363284111022949
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2826142  Vali Loss: 0.2417557 Vali Accuracy: 0.9573935  Vali weighted F1: 0.9564819  Vali macro F1 0.9530086 
new best score!!!!
Validation loss decreased (0.297705 --> 0.241756).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.364013433456421
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2277075  Vali Loss: 0.1864462 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9734844  Vali macro F1 0.9716710 
new best score!!!!
Validation loss decreased (0.241756 --> 0.186446).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3636326789855957
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1893235  Vali Loss: 0.1721131 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9670359  Vali macro F1 0.9636731 
new best score!!!!
Validation loss decreased (0.186446 --> 0.172113).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.372579336166382
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1580351  Vali Loss: 0.1351603 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9747951  Vali macro F1 0.9719594 
new best score!!!!
Validation loss decreased (0.172113 --> 0.135160).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3666698932647705
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1338609  Vali Loss: 0.1264483 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9747785  Vali macro F1 0.9732968 
new best score!!!!
Validation loss decreased (0.135160 --> 0.126448).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3686094284057617
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1199895  Vali Loss: 0.1005141 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836433  Vali macro F1 0.9824457 
new best score!!!!
Validation loss decreased (0.126448 --> 0.100514).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.366939067840576
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1000943  Vali Loss: 0.0769171 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
new best score!!!!
Validation loss decreased (0.100514 --> 0.076917).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3695456981658936
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0836448  Vali Loss: 0.0906035 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9759511  Vali macro F1 0.9736903 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 3.371953248977661
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.1192427  Vali Loss: 0.0733510 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912313  Vali macro F1 0.9905829 
new best score!!!!
Validation loss decreased (0.076917 --> 0.073351).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3761773109436035
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0715455  Vali Loss: 0.0592437 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
new best score!!!!
Validation loss decreased (0.073351 --> 0.059244).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.4311110973358154
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0677985  Vali Loss: 0.0492484 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
new best score!!!!
Validation loss decreased (0.059244 --> 0.049248).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3915834426879883
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0567041  Vali Loss: 0.0589760 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899083  Vali macro F1 0.9905131 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 3.367372751235962
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0468289  Vali Loss: 0.0515986 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898039  Vali macro F1 0.9902345 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 3.3683454990386963
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0460496  Vali Loss: 0.0442448 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937115  Vali macro F1 0.9940554 
new best score!!!!
Validation loss decreased (0.049248 --> 0.044245).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.369957685470581
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0420257  Vali Loss: 0.0495858 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911627  Vali macro F1 0.9915700 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.3705639839172363
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0421159  Vali Loss: 0.0448736 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899034  Vali macro F1 0.9884284 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 3.370135545730591
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0364920  Vali Loss: 0.0306146 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.044245 --> 0.030615).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3688111305236816
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0323413  Vali Loss: 0.0282845 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.030615 --> 0.028284).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.3702588081359863
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0273314  Vali Loss: 0.0306220 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937146  Vali macro F1 0.9941204 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 3.373706579208374
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0340773  Vali Loss: 0.0301362 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937363  Vali macro F1 0.9942531 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 3.369990348815918
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0409189  Vali Loss: 0.0369155 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912074  Vali macro F1 0.9909497 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 3.3681719303131104
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0416507  Vali Loss: 0.0252105 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949828  Vali macro F1 0.9954549 
new best score!!!!
Validation loss decreased (0.028284 --> 0.025211).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.3704721927642822
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0245602  Vali Loss: 0.0222595 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.025211 --> 0.022259).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.3712360858917236
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0222702  Vali Loss: 0.0220229 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
new best score!!!!
Validation loss decreased (0.022259 --> 0.022023).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.373225450515747
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0244445  Vali Loss: 0.0327401 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962248  Vali macro F1 0.9964316 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 3.3708136081695557
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0208082  Vali Loss: 0.0199713 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.022023 --> 0.019971).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.4183974266052246
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0213646  Vali Loss: 0.0230607 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.4098961353302
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0184460  Vali Loss: 0.0201476 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962392  Vali macro F1 0.9961480 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 3.3746914863586426
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0168390  Vali Loss: 0.0181301 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.019971 --> 0.018130).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.3693177700042725
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0199043  Vali Loss: 0.0207965 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.370708465576172
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0179471  Vali Loss: 0.0182196 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.3708810806274414
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0147956  Vali Loss: 0.0178815 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.018130 --> 0.017881).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.3701932430267334
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0139572  Vali Loss: 0.0165171 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.017881 --> 0.016517).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.3690097332000732
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0130048  Vali Loss: 0.0160323 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.016517 --> 0.016032).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.367262840270996
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0116665  Vali Loss: 0.0150300 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.016032 --> 0.015030).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.3751742839813232
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0134272  Vali Loss: 0.0154657 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 3.3710341453552246
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0116435  Vali Loss: 0.0152662 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 3.3713061809539795
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0103914  Vali Loss: 0.0152588 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 3.3718433380126953
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0211228  Vali Loss: 0.0188082 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9952868 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 3.37546706199646
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0343006  Vali Loss: 0.0216008 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937140  Vali macro F1 0.9941699 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 3.370548963546753
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0216983  Vali Loss: 0.0186651 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 3.3767521381378174
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0179540  Vali Loss: 0.0176523 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 3.431654453277588
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0175379  Vali Loss: 0.0177005 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962372  Vali macro F1 0.9965119 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 3.3899497985839844
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0163964  Vali Loss: 0.0164261 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 3.3765223026275635
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0151107  Vali Loss: 0.0159442 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 3.3705379962921143
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0149208  Vali Loss: 0.0159509 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 3.3740673065185547
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0150722  Vali Loss: 0.0159263 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 3.3698818683624268
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0136875  Vali Loss: 0.0159063 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 3.369802236557007
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0142693  Vali Loss: 0.0158540 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 3.367701292037964
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0162604  Vali Loss: 0.0157955 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8482456  Test weighted F1: 0.8264964  Test macro F1 0.8264964 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.7867889404296875
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0106722  Vali Loss: 0.0143990 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
Validation loss decreased (inf --> 0.014399).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.783979415893555
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0103716  Vali Loss: 0.0141848 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.014399 --> 0.014185).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.785022735595703
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0104869  Vali Loss: 0.0142608 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.783354997634888
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0098352  Vali Loss: 0.0139643 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.014185 --> 0.013964).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.787895202636719
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0094012  Vali Loss: 0.0131508 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.013964 --> 0.013151).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.786892414093018
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0090739  Vali Loss: 0.0127760 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.013151 --> 0.012776).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.7866644859313965
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0090792  Vali Loss: 0.0130173 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.783282279968262
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0083719  Vali Loss: 0.0129896 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 4.781016826629639
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0082006  Vali Loss: 0.0125708 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.012776 --> 0.012571).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.779690265655518
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0087264  Vali Loss: 0.0117124 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.012571 --> 0.011712).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.779268503189087
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0089173  Vali Loss: 0.0125381 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 4.782057285308838
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0087891  Vali Loss: 0.0109845 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.011712 --> 0.010985).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.782551050186157
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0080723  Vali Loss: 0.0112691 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.779698133468628
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0070125  Vali Loss: 0.0113194 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.784007787704468
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0072931  Vali Loss: 0.0098891 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.010985 --> 0.009889).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.782582759857178
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0066119  Vali Loss: 0.0102327 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 4.784234523773193
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0080008  Vali Loss: 0.0112399 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 4.779204607009888
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0061712  Vali Loss: 0.0112026 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 4.7803168296813965
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0067155  Vali Loss: 0.0104305 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 4.781045913696289
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0068663  Vali Loss: 0.0105870 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 21 cost time: 4.78070855140686
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0057910  Vali Loss: 0.0103395 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.78163480758667
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0062419  Vali Loss: 0.0116480 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 4.7658772468566895
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0065385  Vali Loss: 0.0110567 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 4.770460844039917
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0056733  Vali Loss: 0.0110436 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 4.769463062286377
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0058884  Vali Loss: 0.0098163 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
new best score!!!!
Validation loss decreased (0.009889 --> 0.009816).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 4.767366409301758
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0061543  Vali Loss: 0.0100907 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.766254663467407
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0052127  Vali Loss: 0.0113241 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.765272378921509
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0056288  Vali Loss: 0.0108748 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 4.767170667648315
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0051981  Vali Loss: 0.0109330 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 4.7691357135772705
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0058166  Vali Loss: 0.0118216 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 4.770286321640015
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0057683  Vali Loss: 0.0117326 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 4.768280267715454
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0054893  Vali Loss: 0.0116907 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 4.769878149032593
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0047435  Vali Loss: 0.0116783 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 4.768347501754761
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0049321  Vali Loss: 0.0116705 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 4.766794443130493
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0049908  Vali Loss: 0.0116224 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 36 cost time: 4.767588376998901
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0063162  Vali Loss: 0.0116178 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 4.767432928085327
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0050304  Vali Loss: 0.0116115 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 4.76651668548584
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0053169  Vali Loss: 0.0116063 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 4.767394542694092
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0047769  Vali Loss: 0.0116026 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 4.768121957778931
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0056146  Vali Loss: 0.0116028 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974940  Vali macro F1 0.9977318 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8491228  Test weighted F1: 0.8251596  Test macro F1 0.8251596 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 104364
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 8 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4633514881134033
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.9049082  Vali Loss: 2.6080596 Vali Accuracy: 0.3195489  Vali weighted F1: 0.2654790  Vali macro F1 0.2635936 
Validation loss decreased (inf --> 2.608060).  Saving model ...
Epoch: 2 cost time: 3.3656423091888428
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.9134600  Vali Loss: 1.2905576 Vali Accuracy: 0.7619048  Vali weighted F1: 0.7206329  Vali macro F1 0.7238287 
new best score!!!!
Validation loss decreased (2.608060 --> 1.290558).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.368321657180786
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0676311  Vali Loss: 0.7684380 Vali Accuracy: 0.8771930  Vali weighted F1: 0.8594502  Vali macro F1 0.8613798 
new best score!!!!
Validation loss decreased (1.290558 --> 0.768438).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.414095401763916
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6714357  Vali Loss: 0.5000020 Vali Accuracy: 0.9223058  Vali weighted F1: 0.9129796  Vali macro F1 0.9138951 
new best score!!!!
Validation loss decreased (0.768438 --> 0.500002).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.4046082496643066
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4639573  Vali Loss: 0.3580295 Vali Accuracy: 0.9323308  Vali weighted F1: 0.9236726  Vali macro F1 0.9238499 
new best score!!!!
Validation loss decreased (0.500002 --> 0.358030).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3654425144195557
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3427421  Vali Loss: 0.2626238 Vali Accuracy: 0.9611529  Vali weighted F1: 0.9590717  Vali macro F1 0.9580813 
new best score!!!!
Validation loss decreased (0.358030 --> 0.262624).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3738913536071777
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2659536  Vali Loss: 0.2116140 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9704811  Vali macro F1 0.9692697 
new best score!!!!
Validation loss decreased (0.262624 --> 0.211614).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3651180267333984
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2095979  Vali Loss: 0.1797083 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9717888  Vali macro F1 0.9703790 
new best score!!!!
Validation loss decreased (0.211614 --> 0.179708).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.361213207244873
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1792958  Vali Loss: 0.1411720 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9799446  Vali macro F1 0.9788383 
new best score!!!!
Validation loss decreased (0.179708 --> 0.141172).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.363076686859131
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1435319  Vali Loss: 0.1238259 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9799673  Vali macro F1 0.9788133 
new best score!!!!
Validation loss decreased (0.141172 --> 0.123826).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3651013374328613
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1227383  Vali Loss: 0.1047303 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9811625  Vali macro F1 0.9798746 
new best score!!!!
Validation loss decreased (0.123826 --> 0.104730).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3643369674682617
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1043474  Vali Loss: 0.0943782 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837087  Vali macro F1 0.9825471 
new best score!!!!
Validation loss decreased (0.104730 --> 0.094378).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3632614612579346
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.1048562  Vali Loss: 0.0829017 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851390  Vali macro F1 0.9839175 
new best score!!!!
Validation loss decreased (0.094378 --> 0.082902).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3651461601257324
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0853767  Vali Loss: 0.0841707 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9826365  Vali macro F1 0.9809983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 3.370109796524048
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0763130  Vali Loss: 0.0758030 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888456  Vali macro F1 0.9876936 
new best score!!!!
Validation loss decreased (0.082902 --> 0.075803).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.364966869354248
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0619140  Vali Loss: 0.0747052 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837230  Vali macro F1 0.9826356 
new best score!!!!
Validation loss decreased (0.075803 --> 0.074705).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.3693082332611084
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0609515  Vali Loss: 0.0598861 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874956  Vali macro F1 0.9863300 
new best score!!!!
Validation loss decreased (0.074705 --> 0.059886).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.370424270629883
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0569124  Vali Loss: 0.0579452 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
new best score!!!!
Validation loss decreased (0.059886 --> 0.057945).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.375486135482788
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0479667  Vali Loss: 0.0556645 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862482  Vali macro F1 0.9850660 
new best score!!!!
Validation loss decreased (0.057945 --> 0.055665).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.3856496810913086
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0442426  Vali Loss: 0.0484021 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
new best score!!!!
Validation loss decreased (0.055665 --> 0.048402).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.416922092437744
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0405998  Vali Loss: 0.0480129 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888369  Vali macro F1 0.9878903 
new best score!!!!
Validation loss decreased (0.048402 --> 0.048013).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.372626543045044
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0414827  Vali Loss: 0.0502685 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863479  Vali macro F1 0.9850177 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 3.36745548248291
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0413674  Vali Loss: 0.0444177 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900880  Vali macro F1 0.9891653 
new best score!!!!
Validation loss decreased (0.048013 --> 0.044418).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3614251613616943
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0349693  Vali Loss: 0.0410006 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913190  Vali macro F1 0.9905102 
new best score!!!!
Validation loss decreased (0.044418 --> 0.041001).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.3654870986938477
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0334047  Vali Loss: 0.0440335 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 3.3601531982421875
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0287156  Vali Loss: 0.0447961 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863841  Vali macro F1 0.9850863 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 3.3539719581604004
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0295607  Vali Loss: 0.0340395 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925527  Vali macro F1 0.9916333 
new best score!!!!
Validation loss decreased (0.041001 --> 0.034040).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.3613662719726562
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0290415  Vali Loss: 0.0307903 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937818  Vali macro F1 0.9932259 
new best score!!!!
Validation loss decreased (0.034040 --> 0.030790).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.3561599254608154
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0277525  Vali Loss: 0.0261251 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.030790 --> 0.026125).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.3634588718414307
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0232424  Vali Loss: 0.0364655 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900679  Vali macro F1 0.9892352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 3.3596885204315186
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0229139  Vali Loss: 0.0342275 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888369  Vali macro F1 0.9878903 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 3.356783628463745
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0227966  Vali Loss: 0.0433820 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851361  Vali macro F1 0.9838118 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 3.3608005046844482
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0257323  Vali Loss: 0.0361774 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 3.357903242111206
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0203336  Vali Loss: 0.0232533 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.026125 --> 0.023253).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.399604320526123
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0261116  Vali Loss: 0.0280769 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.3958637714385986
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0204921  Vali Loss: 0.0249773 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.3618810176849365
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0222955  Vali Loss: 0.0267970 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937527  Vali macro F1 0.9929159 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 3.3540401458740234
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0262463  Vali Loss: 0.0438617 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837992  Vali macro F1 0.9838943 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 3.3621931076049805
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0225661  Vali Loss: 0.0284445 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 3.353580951690674
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0177373  Vali Loss: 0.0249433 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 3.353520631790161
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0155811  Vali Loss: 0.0257554 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 3.356008768081665
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0162103  Vali Loss: 0.0245289 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 3.3553476333618164
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0149709  Vali Loss: 0.0238578 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 3.357534170150757
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0153590  Vali Loss: 0.0243308 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 3.3565194606781006
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0151019  Vali Loss: 0.0255541 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.3542399406433105
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0142714  Vali Loss: 0.0251849 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.3619942665100098
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0137174  Vali Loss: 0.0246932 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 3.3653478622436523
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0151986  Vali Loss: 0.0246540 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 3.364064931869507
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0148234  Vali Loss: 0.0242480 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8622807  Test weighted F1: 0.8371075  Test macro F1 0.8371075 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.792273759841919
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0184264  Vali Loss: 0.0245377 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
Validation loss decreased (inf --> 0.024538).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.793517112731934
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0175991  Vali Loss: 0.0243978 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.024538 --> 0.024398).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.792507648468018
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0164558  Vali Loss: 0.0237002 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.024398 --> 0.023700).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.792011499404907
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0167895  Vali Loss: 0.0237901 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 4.785918235778809
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0153096  Vali Loss: 0.0206295 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.023700 --> 0.020629).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.790529251098633
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0149691  Vali Loss: 0.0214562 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 4.783592462539673
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0168469  Vali Loss: 0.0266684 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 4.782472610473633
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0140788  Vali Loss: 0.0190233 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950162  Vali macro F1 0.9945996 
new best score!!!!
Validation loss decreased (0.020629 --> 0.019023).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.828104496002197
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0144564  Vali Loss: 0.0208614 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.785696029663086
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0138764  Vali Loss: 0.0197540 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 4.786949872970581
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0129086  Vali Loss: 0.0179576 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.019023 --> 0.017958).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.785672903060913
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0201205  Vali Loss: 0.0196705 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.786316156387329
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0134579  Vali Loss: 0.0163917 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.017958 --> 0.016392).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.783329725265503
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0126670  Vali Loss: 0.0160855 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.016392 --> 0.016086).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.78406023979187
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0127221  Vali Loss: 0.0159538 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.016086 --> 0.015954).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 4.78115439414978
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0121688  Vali Loss: 0.0155611 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.015954 --> 0.015561).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.782227039337158
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0129050  Vali Loss: 0.0159097 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.7833027839660645
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0122450  Vali Loss: 0.0165620 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 4.778941631317139
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0131686  Vali Loss: 0.0153717 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950183  Vali macro F1 0.9945209 
new best score!!!!
Validation loss decreased (0.015561 --> 0.015372).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.780544757843018
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0126866  Vali Loss: 0.0136061 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.015372 --> 0.013606).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 4.7828309535980225
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0118344  Vali Loss: 0.0154198 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 4.78316593170166
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0118443  Vali Loss: 0.0140790 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 4.7794506549835205
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0114559  Vali Loss: 0.0155990 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 4.779663324356079
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0115334  Vali Loss: 0.0150071 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 4.783454418182373
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0108846  Vali Loss: 0.0160988 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 26 cost time: 4.782369375228882
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0115347  Vali Loss: 0.0151312 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.778606653213501
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0102847  Vali Loss: 0.0142380 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.781916379928589
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0104869  Vali Loss: 0.0153222 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 4.7793872356414795
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0107748  Vali Loss: 0.0140943 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 4.780787706375122
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0107290  Vali Loss: 0.0162821 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 4.782816171646118
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0100252  Vali Loss: 0.0153981 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 4.779132127761841
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0089813  Vali Loss: 0.0152821 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 4.779746055603027
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0095107  Vali Loss: 0.0150603 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 4.782544136047363
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0100263  Vali Loss: 0.0146584 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 4.777657985687256
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0100055  Vali Loss: 0.0147111 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8807018  Test weighted F1: 0.8542229  Test macro F1 0.8542229 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.435426712036133
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8980123  Vali Loss: 2.5757297 Vali Accuracy: 0.3458647  Vali weighted F1: 0.2879628  Vali macro F1 0.2862407 
Validation loss decreased (inf --> 2.575730).  Saving model ...
Epoch: 2 cost time: 3.373702049255371
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.9372988  Vali Loss: 1.3573618 Vali Accuracy: 0.7443609  Vali weighted F1: 0.7111797  Vali macro F1 0.7102904 
new best score!!!!
Validation loss decreased (2.575730 --> 1.357362).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.367159843444824
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.1165704  Vali Loss: 0.8243683 Vali Accuracy: 0.8696742  Vali weighted F1: 0.8546018  Vali macro F1 0.8553230 
new best score!!!!
Validation loss decreased (1.357362 --> 0.824368).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.371339797973633
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7180183  Vali Loss: 0.5199473 Vali Accuracy: 0.9298246  Vali weighted F1: 0.9260216  Vali macro F1 0.9255369 
new best score!!!!
Validation loss decreased (0.824368 --> 0.519947).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.373326301574707
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4876378  Vali Loss: 0.3736132 Vali Accuracy: 0.9461153  Vali weighted F1: 0.9436019  Vali macro F1 0.9428190 
new best score!!!!
Validation loss decreased (0.519947 --> 0.373613).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3711354732513428
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3541323  Vali Loss: 0.2739682 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9706657  Vali macro F1 0.9693388 
new best score!!!!
Validation loss decreased (0.373613 --> 0.273968).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.3698198795318604
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2693306  Vali Loss: 0.2302744 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9658594  Vali macro F1 0.9646528 
new best score!!!!
Validation loss decreased (0.273968 --> 0.230274).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3684751987457275
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2171439  Vali Loss: 0.1949439 Vali Accuracy: 0.9699248  Vali weighted F1: 0.9694061  Vali macro F1 0.9685786 
new best score!!!!
Validation loss decreased (0.230274 --> 0.194944).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.367379665374756
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1795046  Vali Loss: 0.1619993 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9746532  Vali macro F1 0.9730973 
new best score!!!!
Validation loss decreased (0.194944 --> 0.161999).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.377751588821411
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1456988  Vali Loss: 0.1350623 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9798490  Vali macro F1 0.9790337 
new best score!!!!
Validation loss decreased (0.161999 --> 0.135062).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3775689601898193
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1200448  Vali Loss: 0.1191975 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9812046  Vali macro F1 0.9799315 
new best score!!!!
Validation loss decreased (0.135062 --> 0.119198).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.3755528926849365
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1066181  Vali Loss: 0.1086856 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849824  Vali macro F1 0.9840328 
new best score!!!!
Validation loss decreased (0.119198 --> 0.108686).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.388927936553955
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0936731  Vali Loss: 0.1042225 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9800333  Vali macro F1 0.9786736 
new best score!!!!
Validation loss decreased (0.108686 --> 0.104222).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.43164324760437
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0793901  Vali Loss: 0.0868582 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862304  Vali macro F1 0.9853927 
new best score!!!!
Validation loss decreased (0.104222 --> 0.086858).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3969433307647705
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0705608  Vali Loss: 0.0770192 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899614  Vali macro F1 0.9889011 
new best score!!!!
Validation loss decreased (0.086858 --> 0.077019).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3776347637176514
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0643918  Vali Loss: 0.0694130 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
new best score!!!!
Validation loss decreased (0.077019 --> 0.069413).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.380873203277588
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0605816  Vali Loss: 0.0648177 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900828  Vali macro F1 0.9890617 
new best score!!!!
Validation loss decreased (0.069413 --> 0.064818).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3730220794677734
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0598332  Vali Loss: 0.0615777 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887322  Vali macro F1 0.9878381 
new best score!!!!
Validation loss decreased (0.064818 --> 0.061578).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.370758533477783
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0517387  Vali Loss: 0.0576887 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912322  Vali macro F1 0.9904566 
new best score!!!!
Validation loss decreased (0.061578 --> 0.057689).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.373892068862915
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0434898  Vali Loss: 0.0610616 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887355  Vali macro F1 0.9877442 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 3.374464750289917
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0442289  Vali Loss: 0.0616927 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925225  Vali macro F1 0.9915472 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 3.3720335960388184
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0398388  Vali Loss: 0.0487401 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912322  Vali macro F1 0.9904566 
new best score!!!!
Validation loss decreased (0.057689 --> 0.048740).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.371288537979126
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0394489  Vali Loss: 0.0543233 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887355  Vali macro F1 0.9877442 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.3729255199432373
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0345507  Vali Loss: 0.0499229 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 3.373729944229126
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0319721  Vali Loss: 0.0452809 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899863  Vali macro F1 0.9889701 
new best score!!!!
Validation loss decreased (0.048740 --> 0.045281).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.3721108436584473
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0277164  Vali Loss: 0.0439683 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913245  Vali macro F1 0.9902834 
new best score!!!!
Validation loss decreased (0.045281 --> 0.043968).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.377204418182373
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0263878  Vali Loss: 0.0385334 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.043968 --> 0.038533).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.3761746883392334
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0265155  Vali Loss: 0.0392825 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899756  Vali macro F1 0.9894307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.415595769882202
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0257580  Vali Loss: 0.0394182 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 3.4181509017944336
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0217238  Vali Loss: 0.0348789 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
new best score!!!!
Validation loss decreased (0.038533 --> 0.034879).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.3851211071014404
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0221054  Vali Loss: 0.0410428 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 3.3750650882720947
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0212428  Vali Loss: 0.0414921 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 3.3748841285705566
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0208212  Vali Loss: 0.0328316 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.034879 --> 0.032832).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.376171827316284
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0180549  Vali Loss: 0.0401393 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.373567819595337
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0255708  Vali Loss: 0.0380271 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.374178647994995
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0197794  Vali Loss: 0.0337130 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937825  Vali macro F1 0.9929932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 3.3802497386932373
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0267866  Vali Loss: 0.0431685 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912294  Vali macro F1 0.9903980 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 3.3700802326202393
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0247404  Vali Loss: 0.0264092 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912241  Vali macro F1 0.9906627 
new best score!!!!
Validation loss decreased (0.032832 --> 0.026409).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.3729665279388428
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0176649  Vali Loss: 0.0406535 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899849  Vali macro F1 0.9890973 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.3741912841796875
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0164296  Vali Loss: 0.0262965 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.026409 --> 0.026297).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.3770010471343994
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0151432  Vali Loss: 0.0352218 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.378730535507202
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0145274  Vali Loss: 0.0239376 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.026297 --> 0.023938).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 3.3781204223632812
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0148342  Vali Loss: 0.0376741 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 3.3764240741729736
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0143114  Vali Loss: 0.0173573 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
new best score!!!!
Validation loss decreased (0.023938 --> 0.017357).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.432634115219116
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0131391  Vali Loss: 0.0336961 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.412949562072754
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0154051  Vali Loss: 0.0203757 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.376951217651367
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0127989  Vali Loss: 0.0272364 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912322  Vali macro F1 0.9904566 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 3.373906373977661
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0123369  Vali Loss: 0.0176902 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949754  Vali macro F1 0.9945862 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 3.3737411499023438
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0113042  Vali Loss: 0.0166469 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924789  Vali macro F1 0.9918235 
new best score!!!!
Validation loss decreased (0.017357 --> 0.016647).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 3.373568534851074
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0105990  Vali Loss: 0.0301289 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 3.372760772705078
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0140436  Vali Loss: 0.0165191 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.016647 --> 0.016519).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.373265027999878
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0105804  Vali Loss: 0.0123827 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9936672  Vali macro F1 0.9932992 
new best score!!!!
Validation loss decreased (0.016519 --> 0.012383).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 3.378070592880249
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0102378  Vali Loss: 0.0248852 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924789  Vali macro F1 0.9918235 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.3701529502868652
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0088729  Vali Loss: 0.0204437 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.371440887451172
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0105813  Vali Loss: 0.0136363 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.3727455139160156
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0099076  Vali Loss: 0.0143804 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 3.3780548572540283
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0082409  Vali Loss: 0.0116962 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
new best score!!!!
Validation loss decreased (0.012383 --> 0.011696).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 3.381089925765991
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0089595  Vali Loss: 0.0197348 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 3.4277687072753906
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0087308  Vali Loss: 0.0097670 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.011696 --> 0.009767).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 3.412248373031616
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0101273  Vali Loss: 0.0426062 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937215  Vali macro F1 0.9931556 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 3.3858866691589355
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0098691  Vali Loss: 0.0100115 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949754  Vali macro F1 0.9945862 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 3.375575304031372
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0076986  Vali Loss: 0.0123241 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 3.3785979747772217
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0101104  Vali Loss: 0.0220024 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 3.376466989517212
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0081795  Vali Loss: 0.0133968 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 65 cost time: 3.370490550994873
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0068179  Vali Loss: 0.0139709 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 3.3712799549102783
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0065314  Vali Loss: 0.0110384 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 3.3738043308258057
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0063315  Vali Loss: 0.0110389 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 3.373075485229492
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0066107  Vali Loss: 0.0118337 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 3.3768627643585205
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0068600  Vali Loss: 0.0133280 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 70 cost time: 3.371788740158081
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0063778  Vali Loss: 0.0134564 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 3.3755979537963867
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0068546  Vali Loss: 0.0134747 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 3.374676465988159
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0065284  Vali Loss: 0.0134855 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 3.3866734504699707
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0070093  Vali Loss: 0.0135791 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 3.4301106929779053
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0063854  Vali Loss: 0.0135954 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9464912  Test weighted F1: 0.9441237  Test macro F1 0.9441237 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.794067144393921
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0081513  Vali Loss: 0.0177060 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
Validation loss decreased (inf --> 0.017706).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.781229734420776
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0063787  Vali Loss: 0.0103065 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.017706 --> 0.010307).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.776901960372925
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0064396  Vali Loss: 0.0143769 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.779003143310547
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0065797  Vali Loss: 0.0207488 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 4.778218984603882
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0068358  Vali Loss: 0.0189023 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 4.7817063331604
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0062299  Vali Loss: 0.0120270 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 4.778962135314941
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0060890  Vali Loss: 0.0178422 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 4.7832324504852295
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0054716  Vali Loss: 0.0091393 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.010307 --> 0.009139).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.774930715560913
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0055642  Vali Loss: 0.0139892 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.780145883560181
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0062813  Vali Loss: 0.0146356 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 4.785262107849121
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0068068  Vali Loss: 0.0097330 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 4.776665925979614
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0064846  Vali Loss: 0.0138445 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 4.779705762863159
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0052249  Vali Loss: 0.0141969 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 4.770702362060547
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0053038  Vali Loss: 0.0142763 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.773191690444946
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0049098  Vali Loss: 0.0150275 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 4.770440101623535
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0063336  Vali Loss: 0.0149836 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 4.7686216831207275
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0051894  Vali Loss: 0.0153535 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 4.768158197402954
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0053117  Vali Loss: 0.0154140 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 19 cost time: 4.761471748352051
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0047841  Vali Loss: 0.0154367 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 4.766550779342651
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0056797  Vali Loss: 0.0153822 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 4.761136293411255
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0056476  Vali Loss: 0.0153820 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 4.766825914382935
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0049253  Vali Loss: 0.0153346 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 4.766859769821167
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0053977  Vali Loss: 0.0152113 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9368421  Test weighted F1: 0.9339371  Test macro F1 0.9339371 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.440243721008301
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8991136  Vali Loss: 2.5613589 Vali Accuracy: 0.3533835  Vali weighted F1: 0.3026315  Vali macro F1 0.3026001 
Validation loss decreased (inf --> 2.561359).  Saving model ...
Epoch: 2 cost time: 3.365852117538452
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.9016726  Vali Loss: 1.3533100 Vali Accuracy: 0.7556391  Vali weighted F1: 0.7213019  Vali macro F1 0.7257267 
new best score!!!!
Validation loss decreased (2.561359 --> 1.353310).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.356038808822632
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0899614  Vali Loss: 0.8242184 Vali Accuracy: 0.8859649  Vali weighted F1: 0.8729457  Vali macro F1 0.8750364 
new best score!!!!
Validation loss decreased (1.353310 --> 0.824218).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.3503425121307373
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7014427  Vali Loss: 0.5452425 Vali Accuracy: 0.9323308  Vali weighted F1: 0.9288174  Vali macro F1 0.9288597 
new best score!!!!
Validation loss decreased (0.824218 --> 0.545242).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.355013847351074
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4882237  Vali Loss: 0.3672737 Vali Accuracy: 0.9561404  Vali weighted F1: 0.9547874  Vali macro F1 0.9539797 
new best score!!!!
Validation loss decreased (0.545242 --> 0.367274).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3553919792175293
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3494848  Vali Loss: 0.2850764 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9580989  Vali macro F1 0.9577501 
new best score!!!!
Validation loss decreased (0.367274 --> 0.285076).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.353189706802368
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2925911  Vali Loss: 0.2303612 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9640948  Vali macro F1 0.9632417 
new best score!!!!
Validation loss decreased (0.285076 --> 0.230361).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.353668212890625
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2146915  Vali Loss: 0.1722438 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823572  Vali macro F1 0.9813286 
new best score!!!!
Validation loss decreased (0.230361 --> 0.172244).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.356567144393921
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1727721  Vali Loss: 0.1439153 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9786039  Vali macro F1 0.9777753 
new best score!!!!
Validation loss decreased (0.172244 --> 0.143915).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.369088888168335
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1425309  Vali Loss: 0.1159128 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9813064  Vali macro F1 0.9803807 
new best score!!!!
Validation loss decreased (0.143915 --> 0.115913).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3711788654327393
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1189639  Vali Loss: 0.0995417 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9824700  Vali macro F1 0.9809848 
new best score!!!!
Validation loss decreased (0.115913 --> 0.099542).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.359492063522339
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1008423  Vali Loss: 0.0877649 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9851150  Vali macro F1 0.9835975 
new best score!!!!
Validation loss decreased (0.099542 --> 0.087765).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.4305248260498047
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0922251  Vali Loss: 0.0760891 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900896  Vali macro F1 0.9892064 
new best score!!!!
Validation loss decreased (0.087765 --> 0.076089).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.371717691421509
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0758452  Vali Loss: 0.0622585 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913185  Vali macro F1 0.9902817 
new best score!!!!
Validation loss decreased (0.076089 --> 0.062258).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3635237216949463
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0708146  Vali Loss: 0.0594006 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913009  Vali macro F1 0.9904781 
new best score!!!!
Validation loss decreased (0.062258 --> 0.059401).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.357985496520996
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0767137  Vali Loss: 0.0560822 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912989  Vali macro F1 0.9902085 
new best score!!!!
Validation loss decreased (0.059401 --> 0.056082).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.3634965419769287
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0603213  Vali Loss: 0.0529693 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912322  Vali macro F1 0.9904566 
new best score!!!!
Validation loss decreased (0.056082 --> 0.052969).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.368163585662842
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0564692  Vali Loss: 0.0463087 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901090  Vali macro F1 0.9890234 
new best score!!!!
Validation loss decreased (0.052969 --> 0.046309).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3575010299682617
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0458221  Vali Loss: 0.0399646 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.046309 --> 0.039965).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.357581853866577
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0423300  Vali Loss: 0.0421279 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 3.357165813446045
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0423382  Vali Loss: 0.0525942 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 3.3574607372283936
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0387362  Vali Loss: 0.0316086 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937804  Vali macro F1 0.9932614 
new best score!!!!
Validation loss decreased (0.039965 --> 0.031609).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.358363389968872
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0355946  Vali Loss: 0.0290302 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949978  Vali macro F1 0.9943247 
new best score!!!!
Validation loss decreased (0.031609 --> 0.029030).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.3612358570098877
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0371132  Vali Loss: 0.0295324 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913185  Vali macro F1 0.9902817 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 3.359631061553955
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0305064  Vali Loss: 0.0214769 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.029030 --> 0.021477).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.3658030033111572
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0272299  Vali Loss: 0.0209470 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.021477 --> 0.020947).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.361344814300537
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0281441  Vali Loss: 0.0294221 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912271  Vali macro F1 0.9906682 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.3634419441223145
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0306739  Vali Loss: 0.0208593 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.020947 --> 0.020859).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 3.40903639793396
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0239950  Vali Loss: 0.0188939 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.020859 --> 0.018894).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.3932480812072754
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0237525  Vali Loss: 0.0264368 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925723  Vali macro F1 0.9917065 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 3.362245798110962
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0240812  Vali Loss: 0.0316815 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924789  Vali macro F1 0.9918235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 3.358999013900757
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0246903  Vali Loss: 0.0157558 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.018894 --> 0.015756).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.3543264865875244
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0219203  Vali Loss: 0.0182709 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.3590314388275146
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0192591  Vali Loss: 0.0147405 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.015756 --> 0.014741).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.3608903884887695
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0322797  Vali Loss: 0.0168935 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.3585023880004883
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0255427  Vali Loss: 0.0152537 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.359179973602295
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0214506  Vali Loss: 0.0163648 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 3.357072353363037
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0195447  Vali Loss: 0.0185757 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 3.359206438064575
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0194830  Vali Loss: 0.0183297 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937262  Vali macro F1 0.9931995 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 3.3586926460266113
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0165721  Vali Loss: 0.0137124 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
new best score!!!!
Validation loss decreased (0.014741 --> 0.013712).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.3622493743896484
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0149099  Vali Loss: 0.0129759 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.013712 --> 0.012976).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 3.366483688354492
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0151259  Vali Loss: 0.0127455 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012976 --> 0.012746).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 3.3609492778778076
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0144877  Vali Loss: 0.0125329 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012746 --> 0.012533).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 3.4106078147888184
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0141768  Vali Loss: 0.0123300 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012533 --> 0.012330).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 3.399258852005005
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0143877  Vali Loss: 0.0120958 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012330 --> 0.012096).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 3.3608717918395996
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0138388  Vali Loss: 0.0121635 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 3.3619208335876465
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0140638  Vali Loss: 0.0120775 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012096 --> 0.012077).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.3586630821228027
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0139287  Vali Loss: 0.0122602 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.3593037128448486
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0139719  Vali Loss: 0.0121783 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 3.3678481578826904
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0135647  Vali Loss: 0.0124521 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 3.360368013381958
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0128023  Vali Loss: 0.0122755 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 3.3601200580596924
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0133813  Vali Loss: 0.0121212 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 3.360626697540283
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0138564  Vali Loss: 0.0120918 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 3.3591322898864746
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0130048  Vali Loss: 0.0120871 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 3.360816240310669
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0130461  Vali Loss: 0.0120918 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 3.3595638275146484
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0131230  Vali Loss: 0.0120671 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012077 --> 0.012067).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 3.3627126216888428
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0131411  Vali Loss: 0.0120670 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012067 --> 0.012067).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 3.371791362762451
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0125833  Vali Loss: 0.0120483 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012067 --> 0.012048).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 3.4147989749908447
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0127963  Vali Loss: 0.0120288 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012048 --> 0.012029).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 3.3940670490264893
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0143548  Vali Loss: 0.0120260 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012029 --> 0.012026).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 3.3612163066864014
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0132388  Vali Loss: 0.0120279 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 3.3600220680236816
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0127314  Vali Loss: 0.0120311 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 3.3606009483337402
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0132378  Vali Loss: 0.0119790 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.012026 --> 0.011979).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 3.357621192932129
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0131261  Vali Loss: 0.0119454 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011979 --> 0.011945).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 3.3593192100524902
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0134588  Vali Loss: 0.0119524 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 3.3640458583831787
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0128713  Vali Loss: 0.0119330 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011945 --> 0.011933).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 3.3552188873291016
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0134582  Vali Loss: 0.0118895 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011933 --> 0.011890).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 3.363813638687134
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0131851  Vali Loss: 0.0119061 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 3.3582065105438232
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0126557  Vali Loss: 0.0118866 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011890 --> 0.011887).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 3.3564987182617188
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0130904  Vali Loss: 0.0118683 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011887 --> 0.011868).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 3.366854190826416
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0128678  Vali Loss: 0.0118554 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011868 --> 0.011855).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 3.3650095462799072
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0125956  Vali Loss: 0.0118281 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011855 --> 0.011828).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 3.359755516052246
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0131548  Vali Loss: 0.0118241 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011828 --> 0.011824).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 3.425438404083252
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0130390  Vali Loss: 0.0118407 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 3.3933017253875732
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0130414  Vali Loss: 0.0118539 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 3.3605971336364746
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0126930  Vali Loss: 0.0118469 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 3.3595941066741943
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0133939  Vali Loss: 0.0118233 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011824 --> 0.011823).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 3.361875534057617
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0130498  Vali Loss: 0.0118294 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 3.3627192974090576
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0126452  Vali Loss: 0.0118530 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 3.3590540885925293
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0133302  Vali Loss: 0.0118427 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 3.3612332344055176
VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0128565  Vali Loss: 0.0118923 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 3.371401786804199
VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0130546  Vali Loss: 0.0118832 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 83 cost time: 3.359180450439453
VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0128396  Vali Loss: 0.0118828 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 3.361510992050171
VALI: Epoch: 84, Steps: 29 | Train Loss: 0.0125382  Vali Loss: 0.0118803 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 85 cost time: 3.362008571624756
VALI: Epoch: 85, Steps: 29 | Train Loss: 0.0121439  Vali Loss: 0.0118776 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 86 cost time: 3.3643555641174316
VALI: Epoch: 86, Steps: 29 | Train Loss: 0.0128554  Vali Loss: 0.0118744 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 87 cost time: 3.366626024246216
VALI: Epoch: 87, Steps: 29 | Train Loss: 0.0132167  Vali Loss: 0.0118735 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 88 cost time: 3.3701682090759277
VALI: Epoch: 88, Steps: 29 | Train Loss: 0.0125909  Vali Loss: 0.0118733 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 89 cost time: 3.422032594680786
VALI: Epoch: 89, Steps: 29 | Train Loss: 0.0132017  Vali Loss: 0.0118732 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 90 cost time: 3.3922007083892822
VALI: Epoch: 90, Steps: 29 | Train Loss: 0.0126748  Vali Loss: 0.0118730 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 91 cost time: 3.364121198654175
VALI: Epoch: 91, Steps: 29 | Train Loss: 0.0128475  Vali Loss: 0.0118732 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 92 cost time: 3.3622448444366455
VALI: Epoch: 92, Steps: 29 | Train Loss: 0.0126932  Vali Loss: 0.0118731 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8921053  Test weighted F1: 0.8776468  Test macro F1 0.8776468 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.773263692855835
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0138061  Vali Loss: 0.0115720 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
Validation loss decreased (inf --> 0.011572).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.7685768604278564
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0123114  Vali Loss: 0.0120211 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.767646312713623
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0124765  Vali Loss: 0.0116166 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.768232583999634
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0120893  Vali Loss: 0.0111371 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011572 --> 0.011137).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.769165277481079
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0114031  Vali Loss: 0.0105408 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.011137 --> 0.010541).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.769877195358276
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0123002  Vali Loss: 0.0107804 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 4.7695324420928955
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0121145  Vali Loss: 0.0110265 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962557  Vali macro F1 0.9960272 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 4.767626523971558
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0121602  Vali Loss: 0.0105040 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010541 --> 0.010504).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.771100044250488
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0116040  Vali Loss: 0.0101250 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010504 --> 0.010125).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.769784450531006
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0109474  Vali Loss: 0.0105572 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 4.769033908843994
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0101226  Vali Loss: 0.0101608 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 4.765510559082031
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0105039  Vali Loss: 0.0096117 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.010125 --> 0.009612).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.764347076416016
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0103212  Vali Loss: 0.0099440 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.760669231414795
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0093868  Vali Loss: 0.0098935 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.761581182479858
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0094709  Vali Loss: 0.0098164 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.760992527008057
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0094351  Vali Loss: 0.0093137 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.009612 --> 0.009314).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.762371301651001
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0087270  Vali Loss: 0.0093903 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.760618209838867
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0086847  Vali Loss: 0.0093017 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.009314 --> 0.009302).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 4.758347988128662
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0086064  Vali Loss: 0.0094869 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 4.758994817733765
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0088294  Vali Loss: 0.0093902 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 4.756970643997192
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0084783  Vali Loss: 0.0093347 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 4.7605626583099365
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0083255  Vali Loss: 0.0091231 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.009302 --> 0.009123).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.757043123245239
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0088707  Vali Loss: 0.0090294 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.009123 --> 0.009029).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 4.754451036453247
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0133440  Vali Loss: 0.0089408 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.009029 --> 0.008941).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 4.757552623748779
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0095166  Vali Loss: 0.0070501 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.008941 --> 0.007050).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 4.754009962081909
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0110291  Vali Loss: 0.0082932 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.758400201797485
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0093818  Vali Loss: 0.0064062 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.007050 --> 0.006406).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 4.752598285675049
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0085409  Vali Loss: 0.0075083 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 4.755486488342285
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0087216  Vali Loss: 0.0077570 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 4.755616903305054
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0081544  Vali Loss: 0.0079314 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 4.756845712661743
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0078580  Vali Loss: 0.0082695 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 4.7564003467559814
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0071821  Vali Loss: 0.0077317 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 33 cost time: 4.753199577331543
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0074340  Vali Loss: 0.0074769 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 4.7530388832092285
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0078789  Vali Loss: 0.0080188 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 4.752957582473755
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0068748  Vali Loss: 0.0080882 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 4.754927635192871
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0074665  Vali Loss: 0.0074198 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 4.753207445144653
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0077013  Vali Loss: 0.0078770 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 38 cost time: 4.752506971359253
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0080236  Vali Loss: 0.0078925 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 4.756027936935425
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0070892  Vali Loss: 0.0078834 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 4.750484466552734
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0075003  Vali Loss: 0.0079242 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 4.754154443740845
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0066711  Vali Loss: 0.0078999 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 4.752786636352539
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0067671  Vali Loss: 0.0078964 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9043860  Test weighted F1: 0.8913545  Test macro F1 0.8913545 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.462277412414551
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.9061119  Vali Loss: 2.6022754 Vali Accuracy: 0.3408521  Vali weighted F1: 0.2882734  Vali macro F1 0.2889991 
Validation loss decreased (inf --> 2.602275).  Saving model ...
Epoch: 2 cost time: 3.3645641803741455
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.9108773  Vali Loss: 1.2886102 Vali Accuracy: 0.7681704  Vali weighted F1: 0.7334479  Vali macro F1 0.7351239 
new best score!!!!
Validation loss decreased (2.602275 --> 1.288610).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3644161224365234
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0704796  Vali Loss: 0.7806667 Vali Accuracy: 0.8922306  Vali weighted F1: 0.8789798  Vali macro F1 0.8803977 
new best score!!!!
Validation loss decreased (1.288610 --> 0.780667).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.35526180267334
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6925931  Vali Loss: 0.5293888 Vali Accuracy: 0.9223058  Vali weighted F1: 0.9154164  Vali macro F1 0.9147633 
new best score!!!!
Validation loss decreased (0.780667 --> 0.529389).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.355374813079834
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4899046  Vali Loss: 0.3765062 Vali Accuracy: 0.9436090  Vali weighted F1: 0.9403065  Vali macro F1 0.9389384 
new best score!!!!
Validation loss decreased (0.529389 --> 0.376506).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3540477752685547
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3545979  Vali Loss: 0.2844021 Vali Accuracy: 0.9624060  Vali weighted F1: 0.9620677  Vali macro F1 0.9600938 
new best score!!!!
Validation loss decreased (0.376506 --> 0.284402).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.353931188583374
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2771578  Vali Loss: 0.2186645 Vali Accuracy: 0.9598997  Vali weighted F1: 0.9594823  Vali macro F1 0.9571100 
new best score!!!!
Validation loss decreased (0.284402 --> 0.218665).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.3578755855560303
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2076272  Vali Loss: 0.1775328 Vali Accuracy: 0.9598997  Vali weighted F1: 0.9595788  Vali macro F1 0.9572571 
new best score!!!!
Validation loss decreased (0.218665 --> 0.177533).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.352783679962158
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1699051  Vali Loss: 0.1478120 Vali Accuracy: 0.9711779  Vali weighted F1: 0.9712160  Vali macro F1 0.9690740 
new best score!!!!
Validation loss decreased (0.177533 --> 0.147812).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.356255054473877
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1398906  Vali Loss: 0.1215575 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9724364  Vali macro F1 0.9703182 
new best score!!!!
Validation loss decreased (0.147812 --> 0.121558).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.366297721862793
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1166300  Vali Loss: 0.1100026 Vali Accuracy: 0.9724311  Vali weighted F1: 0.9726060  Vali macro F1 0.9709618 
new best score!!!!
Validation loss decreased (0.121558 --> 0.110003).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.367157220840454
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0987279  Vali Loss: 0.0981353 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9773280  Vali macro F1 0.9757955 
new best score!!!!
Validation loss decreased (0.110003 --> 0.098135).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.3610548973083496
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0880742  Vali Loss: 0.0881541 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9812737  Vali macro F1 0.9800088 
new best score!!!!
Validation loss decreased (0.098135 --> 0.088154).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3685221672058105
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0753498  Vali Loss: 0.0741953 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887956  Vali macro F1 0.9878625 
new best score!!!!
Validation loss decreased (0.088154 --> 0.074195).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.4179468154907227
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0674361  Vali Loss: 0.0892502 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9836446  Vali macro F1 0.9819521 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 3.3865129947662354
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0651255  Vali Loss: 0.0699059 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887296  Vali macro F1 0.9879278 
new best score!!!!
Validation loss decreased (0.074195 --> 0.069906).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.3687825202941895
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0577959  Vali Loss: 0.0690578 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849615  Vali macro F1 0.9843218 
new best score!!!!
Validation loss decreased (0.069906 --> 0.069058).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3619303703308105
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0508636  Vali Loss: 0.0544221 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900906  Vali macro F1 0.9891211 
new best score!!!!
Validation loss decreased (0.069058 --> 0.054422).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.369297981262207
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0469753  Vali Loss: 0.0480134 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925504  Vali macro F1 0.9918172 
new best score!!!!
Validation loss decreased (0.054422 --> 0.048013).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.363456964492798
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0424218  Vali Loss: 0.0530091 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888370  Vali macro F1 0.9876965 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 3.3612966537475586
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0403588  Vali Loss: 0.0386439 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937228  Vali macro F1 0.9932790 
new best score!!!!
Validation loss decreased (0.048013 --> 0.038644).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.3642444610595703
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0418031  Vali Loss: 0.0498214 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887355  Vali macro F1 0.9878579 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 3.3622870445251465
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0358665  Vali Loss: 0.0404004 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925504  Vali macro F1 0.9918172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 3.362916946411133
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0425588  Vali Loss: 0.0418534 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887226  Vali macro F1 0.9880450 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 3.361952066421509
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0335390  Vali Loss: 0.0393391 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925504  Vali macro F1 0.9918172 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 3.3630259037017822
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0273279  Vali Loss: 0.0294233 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950153  Vali macro F1 0.9945523 
new best score!!!!
Validation loss decreased (0.038644 --> 0.029423).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3612756729125977
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0276748  Vali Loss: 0.0332234 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937617  Vali macro F1 0.9931278 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.358220100402832
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0399688  Vali Loss: 0.0399708 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887338  Vali macro F1 0.9878777 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 3.361175298690796
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0296616  Vali Loss: 0.0308130 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937236  Vali macro F1 0.9934310 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 3.3674004077911377
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0235192  Vali Loss: 0.0305494 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937816  Vali macro F1 0.9931791 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 3.406386375427246
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0346531  Vali Loss: 0.0253667 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937816  Vali macro F1 0.9931791 
new best score!!!!
Validation loss decreased (0.029423 --> 0.025367).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.4010417461395264
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0223141  Vali Loss: 0.0246455 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949754  Vali macro F1 0.9945862 
new best score!!!!
Validation loss decreased (0.025367 --> 0.024645).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.368926525115967
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0200607  Vali Loss: 0.0267448 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.363772392272949
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0197226  Vali Loss: 0.0222217 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.024645 --> 0.022222).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.367208480834961
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0297242  Vali Loss: 0.0217666 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949875  Vali macro F1 0.9942982 
new best score!!!!
Validation loss decreased (0.022222 --> 0.021767).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.3619627952575684
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0193351  Vali Loss: 0.0314272 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950150  Vali macro F1 0.9943648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.3597683906555176
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0176395  Vali Loss: 0.0252384 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924565  Vali macro F1 0.9918135 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.365091323852539
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0172633  Vali Loss: 0.0234483 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 3.3607544898986816
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0157313  Vali Loss: 0.0198816 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950165  Vali macro F1 0.9945718 
new best score!!!!
Validation loss decreased (0.021767 --> 0.019882).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.3602051734924316
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0147275  Vali Loss: 0.0190874 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950165  Vali macro F1 0.9945718 
new best score!!!!
Validation loss decreased (0.019882 --> 0.019087).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 3.3581511974334717
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0133983  Vali Loss: 0.0213516 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937822  Vali macro F1 0.9931980 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.3593621253967285
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0159111  Vali Loss: 0.0190386 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.019087 --> 0.019039).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 3.3767476081848145
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0140659  Vali Loss: 0.0240462 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925502  Vali macro F1 0.9918354 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 3.3644919395446777
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0166906  Vali Loss: 0.0225526 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912695  Vali macro F1 0.9903230 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 3.4025936126708984
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0190131  Vali Loss: 0.0378578 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873592  Vali macro F1 0.9865297 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 3.403402328491211
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0182748  Vali Loss: 0.0234334 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925504  Vali macro F1 0.9918172 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 3.3694355487823486
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0136578  Vali Loss: 0.0159830 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.019039 --> 0.015983).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.361269474029541
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0123775  Vali Loss: 0.0165128 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 3.364114284515381
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0135232  Vali Loss: 0.0143762 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937620  Vali macro F1 0.9931406 
new best score!!!!
Validation loss decreased (0.015983 --> 0.014376).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 3.3628320693969727
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0104263  Vali Loss: 0.0148494 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 3.3672728538513184
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0104374  Vali Loss: 0.0142475 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
new best score!!!!
Validation loss decreased (0.014376 --> 0.014248).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.5388073921203613
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0117515  Vali Loss: 0.0252646 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9886224  Vali macro F1 0.9880018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 3.358637809753418
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0261608  Vali Loss: 0.0330145 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849938  Vali macro F1 0.9841467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 3.3598103523254395
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0182406  Vali Loss: 0.0211058 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913207  Vali macro F1 0.9904690 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 3.359844207763672
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0160564  Vali Loss: 0.0214996 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899782  Vali macro F1 0.9892315 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 3.353482484817505
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0140591  Vali Loss: 0.0149621 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 57 cost time: 3.35785174369812
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0103327  Vali Loss: 0.0145703 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 3.358743190765381
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0102349  Vali Loss: 0.0142622 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 3.3716700077056885
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0105556  Vali Loss: 0.0156916 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924886  Vali macro F1 0.9921466 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 3.360452890396118
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0104255  Vali Loss: 0.0140257 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
new best score!!!!
Validation loss decreased (0.014248 --> 0.014026).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 3.4160943031311035
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0100704  Vali Loss: 0.0137088 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
new best score!!!!
Validation loss decreased (0.014026 --> 0.013709).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 3.3962907791137695
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0098551  Vali Loss: 0.0145565 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 3.3643362522125244
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0105774  Vali Loss: 0.0141280 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 3.361877679824829
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0095771  Vali Loss: 0.0142631 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 3.361966848373413
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0090541  Vali Loss: 0.0133163 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
new best score!!!!
Validation loss decreased (0.013709 --> 0.013316).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 3.3610575199127197
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0096615  Vali Loss: 0.0141656 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 3.368772268295288
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0088799  Vali Loss: 0.0143960 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 3.3628005981445312
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0096602  Vali Loss: 0.0131829 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
new best score!!!!
Validation loss decreased (0.013316 --> 0.013183).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 3.3605501651763916
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0092237  Vali Loss: 0.0131180 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
new best score!!!!
Validation loss decreased (0.013183 --> 0.013118).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 3.3640925884246826
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0087737  Vali Loss: 0.0127855 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
new best score!!!!
Validation loss decreased (0.013118 --> 0.012786).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 3.3640406131744385
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0091719  Vali Loss: 0.0130744 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 3.366645097732544
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0088393  Vali Loss: 0.0129050 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950179  Vali macro F1 0.9945584 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 3.3685929775238037
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0108829  Vali Loss: 0.0137546 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 3.3703103065490723
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0087931  Vali Loss: 0.0145716 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 3.36995267868042
VALI: Epoch: 75, Steps: 29 | Train Loss: 0.0086727  Vali Loss: 0.0140864 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 76 cost time: 3.419523239135742
VALI: Epoch: 76, Steps: 29 | Train Loss: 0.0095515  Vali Loss: 0.0139822 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 3.401639699935913
VALI: Epoch: 77, Steps: 29 | Train Loss: 0.0084627  Vali Loss: 0.0139511 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 3.3641927242279053
VALI: Epoch: 78, Steps: 29 | Train Loss: 0.0085334  Vali Loss: 0.0138859 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 3.363990545272827
VALI: Epoch: 79, Steps: 29 | Train Loss: 0.0087957  Vali Loss: 0.0138602 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 3.3666932582855225
VALI: Epoch: 80, Steps: 29 | Train Loss: 0.0089863  Vali Loss: 0.0137579 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 81 cost time: 3.3612661361694336
VALI: Epoch: 81, Steps: 29 | Train Loss: 0.0097259  Vali Loss: 0.0137512 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 82 cost time: 3.3639540672302246
VALI: Epoch: 82, Steps: 29 | Train Loss: 0.0084926  Vali Loss: 0.0137513 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 83 cost time: 3.363757371902466
VALI: Epoch: 83, Steps: 29 | Train Loss: 0.0087862  Vali Loss: 0.0137461 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 84 cost time: 3.3645832538604736
VALI: Epoch: 84, Steps: 29 | Train Loss: 0.0085984  Vali Loss: 0.0137449 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 85 cost time: 3.3615365028381348
VALI: Epoch: 85, Steps: 29 | Train Loss: 0.0085959  Vali Loss: 0.0137353 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8008772  Test weighted F1: 0.7510498  Test macro F1 0.7510498 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.849684476852417
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0089830  Vali Loss: 0.0143199 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
Validation loss decreased (inf --> 0.014320).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.85312557220459
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0079375  Vali Loss: 0.0136516 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.014320 --> 0.013652).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.849271535873413
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0085156  Vali Loss: 0.0118206 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
new best score!!!!
Validation loss decreased (0.013652 --> 0.011821).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 4.856685161590576
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0080593  Vali Loss: 0.0105145 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.011821 --> 0.010515).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.913387775421143
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0088920  Vali Loss: 0.0108259 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.849390268325806
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0078753  Vali Loss: 0.0157356 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 4.848204851150513
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0076019  Vali Loss: 0.0113969 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950179  Vali macro F1 0.9945584 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 4.8509135246276855
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0077006  Vali Loss: 0.0130109 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 4.848932504653931
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0077427  Vali Loss: 0.0134801 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 4.849103689193726
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0066001  Vali Loss: 0.0132371 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 4.849355936050415
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0070523  Vali Loss: 0.0132518 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 4.850019693374634
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0069334  Vali Loss: 0.0119861 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937404  Vali macro F1 0.9933019 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 4.845195293426514
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0072703  Vali Loss: 0.0089487 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962559  Vali macro F1 0.9959448 
new best score!!!!
Validation loss decreased (0.010515 --> 0.008949).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.846736431121826
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0069588  Vali Loss: 0.0135506 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 4.844897508621216
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0064427  Vali Loss: 0.0123975 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 4.843900918960571
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0075143  Vali Loss: 0.0127597 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 4.83955192565918
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0062494  Vali Loss: 0.0124632 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 4.8424506187438965
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0061376  Vali Loss: 0.0092171 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 4.8424296379089355
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0067395  Vali Loss: 0.0091268 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 4.835388422012329
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0060742  Vali Loss: 0.0100838 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 4.842443227767944
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0062728  Vali Loss: 0.0095422 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 4.844180583953857
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0058078  Vali Loss: 0.0095746 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 4.840917110443115
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0061596  Vali Loss: 0.0116547 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 4.845492601394653
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0066922  Vali Loss: 0.0115845 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 4.841710090637207
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0064005  Vali Loss: 0.0115785 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 4.837759256362915
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0057919  Vali Loss: 0.0114997 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 4.838964462280273
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0059177  Vali Loss: 0.0114167 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 4.839159965515137
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0061660  Vali Loss: 0.0113823 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7982456  Test weighted F1: 0.7471954  Test macro F1 0.7471954 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4397547245025635
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.9031928  Vali Loss: 2.5662561 Vali Accuracy: 0.3558897  Vali weighted F1: 0.2773713  Vali macro F1 0.2784891 
Validation loss decreased (inf --> 2.566256).  Saving model ...
Epoch: 2 cost time: 3.3526456356048584
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.9480318  Vali Loss: 1.3317347 Vali Accuracy: 0.7844612  Vali weighted F1: 0.7588331  Vali macro F1 0.7570660 
new best score!!!!
Validation loss decreased (2.566256 --> 1.331735).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3510935306549072
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.1163240  Vali Loss: 0.8198236 Vali Accuracy: 0.8847118  Vali weighted F1: 0.8734353  Vali macro F1 0.8735884 
new best score!!!!
Validation loss decreased (1.331735 --> 0.819824).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.350276231765747
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7181864  Vali Loss: 0.5447515 Vali Accuracy: 0.9260652  Vali weighted F1: 0.9203709  Vali macro F1 0.9202276 
new best score!!!!
Validation loss decreased (0.819824 --> 0.544752).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3507556915283203
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.5014722  Vali Loss: 0.3707060 Vali Accuracy: 0.9586466  Vali weighted F1: 0.9572149  Vali macro F1 0.9559664 
new best score!!!!
Validation loss decreased (0.544752 --> 0.370706).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.357527732849121
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3595865  Vali Loss: 0.2755286 Vali Accuracy: 0.9674185  Vali weighted F1: 0.9666978  Vali macro F1 0.9657405 
new best score!!!!
Validation loss decreased (0.370706 --> 0.275529).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.354234457015991
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2709493  Vali Loss: 0.2140744 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9737408  Vali macro F1 0.9723237 
new best score!!!!
Validation loss decreased (0.275529 --> 0.214074).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.36135196685791
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2112258  Vali Loss: 0.1704075 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9838999  Vali macro F1 0.9824768 
new best score!!!!
Validation loss decreased (0.214074 --> 0.170407).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3481757640838623
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1701613  Vali Loss: 0.1381890 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9826132  Vali macro F1 0.9816388 
new best score!!!!
Validation loss decreased (0.170407 --> 0.138189).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.386558771133423
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1490796  Vali Loss: 0.1256310 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9823741  Vali macro F1 0.9811533 
new best score!!!!
Validation loss decreased (0.138189 --> 0.125631).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.3986093997955322
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1168783  Vali Loss: 0.1032953 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863270  Vali macro F1 0.9853814 
new best score!!!!
Validation loss decreased (0.125631 --> 0.103295).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.357727289199829
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0954604  Vali Loss: 0.0917206 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9901338  Vali macro F1 0.9891972 
new best score!!!!
Validation loss decreased (0.103295 --> 0.091721).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.358778238296509
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0855969  Vali Loss: 0.0841331 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887837  Vali macro F1 0.9877118 
new best score!!!!
Validation loss decreased (0.091721 --> 0.084133).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.368346691131592
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0729604  Vali Loss: 0.0746182 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888790  Vali macro F1 0.9880364 
new best score!!!!
Validation loss decreased (0.084133 --> 0.074618).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.3549585342407227
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0651778  Vali Loss: 0.0650986 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9850973  Vali macro F1 0.9840764 
new best score!!!!
Validation loss decreased (0.074618 --> 0.065099).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.354151487350464
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0585330  Vali Loss: 0.0593957 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900809  Vali macro F1 0.9892726 
new best score!!!!
Validation loss decreased (0.065099 --> 0.059396).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.3552489280700684
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0533412  Vali Loss: 0.0574346 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887802  Vali macro F1 0.9881540 
new best score!!!!
Validation loss decreased (0.059396 --> 0.057435).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3587400913238525
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0555842  Vali Loss: 0.0574262 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899729  Vali macro F1 0.9892695 
new best score!!!!
Validation loss decreased (0.057435 --> 0.057426).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3525476455688477
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0464980  Vali Loss: 0.0517695 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9876086  Vali macro F1 0.9866917 
new best score!!!!
Validation loss decreased (0.057426 --> 0.051770).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 3.351696252822876
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0434291  Vali Loss: 0.0348945 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937602  Vali macro F1 0.9936181 
new best score!!!!
Validation loss decreased (0.051770 --> 0.034894).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.3513524532318115
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0361870  Vali Loss: 0.0427438 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900389  Vali macro F1 0.9894067 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.3559741973876953
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0372974  Vali Loss: 0.0342210 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925240  Vali macro F1 0.9919286 
new best score!!!!
Validation loss decreased (0.034894 --> 0.034221).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.3549952507019043
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0313508  Vali Loss: 0.0327075 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899761  Vali macro F1 0.9894242 
new best score!!!!
Validation loss decreased (0.034221 --> 0.032707).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 3.356588125228882
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0280836  Vali Loss: 0.0272948 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937214  Vali macro F1 0.9933611 
new best score!!!!
Validation loss decreased (0.032707 --> 0.027295).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.359565496444702
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0325928  Vali Loss: 0.0427191 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899756  Vali macro F1 0.9893347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 3.354743719100952
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0299270  Vali Loss: 0.0378289 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899710  Vali macro F1 0.9890804 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 3.3622238636016846
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0341246  Vali Loss: 0.0274825 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924875  Vali macro F1 0.9923027 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 3.376255512237549
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0276999  Vali Loss: 0.0275185 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924675  Vali macro F1 0.9919305 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 3.4009628295898438
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0226935  Vali Loss: 0.0209804 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949746  Vali macro F1 0.9946775 
new best score!!!!
Validation loss decreased (0.027295 --> 0.020980).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.3649914264678955
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0213589  Vali Loss: 0.0341509 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924797  Vali macro F1 0.9917591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 3.358103036880493
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0215723  Vali Loss: 0.0278262 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899873  Vali macro F1 0.9895182 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 3.351112127304077
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0186966  Vali Loss: 0.0220915 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 5.978463649749756
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0180011  Vali Loss: 0.0161575 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975075  Vali macro F1 0.9971824 
new best score!!!!
Validation loss decreased (0.020980 --> 0.016158).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.4607038497924805
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0167417  Vali Loss: 0.0182178 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962695  Vali macro F1 0.9957959 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.3493165969848633
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0253846  Vali Loss: 0.0186256 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962497  Vali macro F1 0.9961138 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 3.350562810897827
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0165334  Vali Loss: 0.0178739 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949737  Vali macro F1 0.9947601 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 3.352625608444214
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0309761  Vali Loss: 0.0377116 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900635  Vali macro F1 0.9891986 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 3.3596575260162354
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0198617  Vali Loss: 0.0234245 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924675  Vali macro F1 0.9919305 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 3.354217529296875
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0163545  Vali Loss: 0.0173750 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937228  Vali macro F1 0.9932790 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.3580307960510254
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0142020  Vali Loss: 0.0175077 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937228  Vali macro F1 0.9932790 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 3.355189561843872
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0139258  Vali Loss: 0.0169254 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937228  Vali macro F1 0.9932790 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 3.361159324645996
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0138276  Vali Loss: 0.0174381 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937228  Vali macro F1 0.9932790 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 3.3903348445892334
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0141868  Vali Loss: 0.0184735 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937228  Vali macro F1 0.9932790 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 3.398916006088257
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0139215  Vali Loss: 0.0183155 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937228  Vali macro F1 0.9932790 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 3.36186146736145
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0131709  Vali Loss: 0.0181509 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 3.358044147491455
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0127727  Vali Loss: 0.0179762 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 3.353215456008911
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0129233  Vali Loss: 0.0178074 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 3.3526604175567627
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0129915  Vali Loss: 0.0177652 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8377193  Test weighted F1: 0.7876127  Test macro F1 0.7876127 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.869499206542969
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0174602  Vali Loss: 0.0174196 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
Validation loss decreased (inf --> 0.017420).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.83265233039856
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0151531  Vali Loss: 0.0180649 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.83206582069397
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0148697  Vali Loss: 0.0181273 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.832049608230591
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0145443  Vali Loss: 0.0174411 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 4.833304166793823
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0139731  Vali Loss: 0.0166115 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.017420 --> 0.016612).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 4.832472085952759
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0126207  Vali Loss: 0.0163344 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.016612 --> 0.016334).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.834654092788696
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0127471  Vali Loss: 0.0163993 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.836779356002808
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0129609  Vali Loss: 0.0153272 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.016334 --> 0.015327).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.840658187866211
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0129945  Vali Loss: 0.0159576 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.831528902053833
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0125207  Vali Loss: 0.0151976 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.015327 --> 0.015198).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 4.833882808685303
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0114317  Vali Loss: 0.0151454 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.015198 --> 0.015145).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.831042051315308
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0105395  Vali Loss: 0.0159582 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949731  Vali macro F1 0.9944884 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.832087993621826
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0125782  Vali Loss: 0.0144117 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.015145 --> 0.014412).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 4.831761360168457
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0111534  Vali Loss: 0.0136960 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
new best score!!!!
Validation loss decreased (0.014412 --> 0.013696).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 4.833398342132568
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0096628  Vali Loss: 0.0161287 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949761  Vali macro F1 0.9945219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 4.83169150352478
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0109903  Vali Loss: 0.0136763 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.013696 --> 0.013676).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.836374521255493
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0113065  Vali Loss: 0.0149253 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.8318774700164795
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0108086  Vali Loss: 0.0122758 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.013676 --> 0.012276).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 4.831547498703003
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0106461  Vali Loss: 0.0176375 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937410  Vali macro F1 0.9935456 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 4.836819648742676
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0112387  Vali Loss: 0.0121327 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.012276 --> 0.012133).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 4.834192991256714
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0093482  Vali Loss: 0.0117929 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
new best score!!!!
Validation loss decreased (0.012133 --> 0.011793).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 4.834115266799927
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0091154  Vali Loss: 0.0122282 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 4.82893443107605
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0096319  Vali Loss: 0.0143988 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949767  Vali macro F1 0.9947657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 4.830572843551636
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0109763  Vali Loss: 0.0129518 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 4.8325278759002686
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0085338  Vali Loss: 0.0141548 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 4.829293727874756
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0085599  Vali Loss: 0.0137070 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 27 cost time: 4.83147931098938
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0085338  Vali Loss: 0.0133372 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 4.828745603561401
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0093670  Vali Loss: 0.0188186 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949341  Vali macro F1 0.9947390 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 4.830065965652466
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0099732  Vali Loss: 0.0177674 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949341  Vali macro F1 0.9947390 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 4.83238959312439
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0090137  Vali Loss: 0.0114499 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962497  Vali macro F1 0.9961138 
new best score!!!!
Validation loss decreased (0.011793 --> 0.011450).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 4.83326530456543
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0081343  Vali Loss: 0.0128276 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 4.829431533813477
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0085013  Vali Loss: 0.0118270 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962285  Vali macro F1 0.9959209 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 4.833048343658447
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0077687  Vali Loss: 0.0132496 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 4.831210136413574
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0069623  Vali Loss: 0.0124162 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 4.830929517745972
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0080337  Vali Loss: 0.0116077 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 36 cost time: 4.83069372177124
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0081242  Vali Loss: 0.0121656 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 4.829047203063965
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0069404  Vali Loss: 0.0121369 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 4.827855348587036
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0071964  Vali Loss: 0.0120988 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 4.831115007400513
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0067224  Vali Loss: 0.0117524 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 4.830180883407593
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0073787  Vali Loss: 0.0119101 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 41 cost time: 4.828858137130737
Fine Tuning VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0075540  Vali Loss: 0.0119489 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 4.830471515655518
Fine Tuning VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0090744  Vali Loss: 0.0119514 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 4.834240913391113
Fine Tuning VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0073118  Vali Loss: 0.0121611 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 4.83336329460144
Fine Tuning VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0068275  Vali Loss: 0.0122021 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 4.833357572555542
Fine Tuning VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0072288  Vali Loss: 0.0122441 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949928  Vali macro F1 0.9947009 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8394737  Test weighted F1: 0.7894580  Test macro F1 0.7894580 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.419126033782959
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.9121185  Vali Loss: 2.6424602 Vali Accuracy: 0.3157895  Vali weighted F1: 0.2738703  Vali macro F1 0.2766434 
Validation loss decreased (inf --> 2.642460).  Saving model ...
Epoch: 2 cost time: 3.348360300064087
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.9456056  Vali Loss: 1.3686985 Vali Accuracy: 0.7568922  Vali weighted F1: 0.7178351  Vali macro F1 0.7188370 
new best score!!!!
Validation loss decreased (2.642460 --> 1.368698).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.350938558578491
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.1157153  Vali Loss: 0.8389609 Vali Accuracy: 0.8721805  Vali weighted F1: 0.8642293  Vali macro F1 0.8645912 
new best score!!!!
Validation loss decreased (1.368698 --> 0.838961).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.352961301803589
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7125701  Vali Loss: 0.5307007 Vali Accuracy: 0.9360902  Vali weighted F1: 0.9336852  Vali macro F1 0.9335698 
new best score!!!!
Validation loss decreased (0.838961 --> 0.530701).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3510265350341797
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4952790  Vali Loss: 0.3877242 Vali Accuracy: 0.9511278  Vali weighted F1: 0.9487632  Vali macro F1 0.9486247 
new best score!!!!
Validation loss decreased (0.530701 --> 0.387724).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3658993244171143
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3658086  Vali Loss: 0.2957821 Vali Accuracy: 0.9598997  Vali weighted F1: 0.9593047  Vali macro F1 0.9588730 
new best score!!!!
Validation loss decreased (0.387724 --> 0.295782).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.354567527770996
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2767074  Vali Loss: 0.2342933 Vali Accuracy: 0.9661654  Vali weighted F1: 0.9656936  Vali macro F1 0.9648359 
new best score!!!!
Validation loss decreased (0.295782 --> 0.234293).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.381488084793091
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2228546  Vali Loss: 0.1802588 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9782997  Vali macro F1 0.9778602 
new best score!!!!
Validation loss decreased (0.234293 --> 0.180259).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.393965721130371
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1828764  Vali Loss: 0.1487445 Vali Accuracy: 0.9749373  Vali weighted F1: 0.9747112  Vali macro F1 0.9736599 
new best score!!!!
Validation loss decreased (0.180259 --> 0.148744).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.359374761581421
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1443239  Vali Loss: 0.1246204 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9809930  Vali macro F1 0.9802649 
new best score!!!!
Validation loss decreased (0.148744 --> 0.124620).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.364442825317383
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1240792  Vali Loss: 0.1038062 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849832  Vali macro F1 0.9837627 
new best score!!!!
Validation loss decreased (0.124620 --> 0.103806).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.355654716491699
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.1028653  Vali Loss: 0.0916736 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837305  Vali macro F1 0.9829444 
new best score!!!!
Validation loss decreased (0.103806 --> 0.091674).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.353476047515869
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0918177  Vali Loss: 0.0812898 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887307  Vali macro F1 0.9877003 
new best score!!!!
Validation loss decreased (0.091674 --> 0.081290).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 3.3607757091522217
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0820491  Vali Loss: 0.0760383 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9873768  Vali macro F1 0.9866490 
new best score!!!!
Validation loss decreased (0.081290 --> 0.076038).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.356743812561035
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0771948  Vali Loss: 0.0625879 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912202  Vali macro F1 0.9903742 
new best score!!!!
Validation loss decreased (0.076038 --> 0.062588).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.352403163909912
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0690326  Vali Loss: 0.0617773 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862266  Vali macro F1 0.9852581 
new best score!!!!
Validation loss decreased (0.062588 --> 0.061777).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.3530139923095703
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0633951  Vali Loss: 0.0564410 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9838265  Vali macro F1 0.9833584 
new best score!!!!
Validation loss decreased (0.061777 --> 0.056441).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3572304248809814
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0578293  Vali Loss: 0.0481530 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
new best score!!!!
Validation loss decreased (0.056441 --> 0.048153).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3597278594970703
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0524911  Vali Loss: 0.0510049 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874797  Vali macro F1 0.9864882 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.3572444915771484
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0432033  Vali Loss: 0.0445181 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874749  Vali macro F1 0.9868947 
new best score!!!!
Validation loss decreased (0.048153 --> 0.044518).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.35640025138855
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0420870  Vali Loss: 0.0347867 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924673  Vali macro F1 0.9917586 
new best score!!!!
Validation loss decreased (0.044518 --> 0.034787).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 3.369364023208618
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0432536  Vali Loss: 0.0426367 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912200  Vali macro F1 0.9908498 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 3.362873077392578
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0560235  Vali Loss: 0.0359232 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925261  Vali macro F1 0.9918952 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 3.366442918777466
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0449491  Vali Loss: 0.0323203 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913413  Vali macro F1 0.9903616 
new best score!!!!
Validation loss decreased (0.034787 --> 0.032320).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 3.41416335105896
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0348132  Vali Loss: 0.0342597 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888535  Vali macro F1 0.9877395 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 3.390291452407837
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0303610  Vali Loss: 0.0257452 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950157  Vali macro F1 0.9943711 
new best score!!!!
Validation loss decreased (0.032320 --> 0.025745).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3628504276275635
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0295357  Vali Loss: 0.0271273 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913168  Vali macro F1 0.9904227 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 3.3584280014038086
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0280770  Vali Loss: 0.0261925 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 3.3616061210632324
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0255839  Vali Loss: 0.0275537 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924704  Vali macro F1 0.9919434 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 3.360151767730713
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0260251  Vali Loss: 0.0192810 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
new best score!!!!
Validation loss decreased (0.025745 --> 0.019281).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 3.359199285507202
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0318375  Vali Loss: 0.0290401 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899781  Vali macro F1 0.9890596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 3.356212615966797
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0242945  Vali Loss: 0.0328529 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888535  Vali macro F1 0.9877395 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 3.356051206588745
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0224935  Vali Loss: 0.0182094 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962516  Vali macro F1 0.9957495 
new best score!!!!
Validation loss decreased (0.019281 --> 0.018209).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 3.3577661514282227
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0212568  Vali Loss: 0.0201184 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 3.3600144386291504
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0283671  Vali Loss: 0.0181513 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.018209 --> 0.018151).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 3.35786509513855
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0228007  Vali Loss: 0.0185475 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937639  Vali macro F1 0.9932159 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 3.3621575832366943
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0191694  Vali Loss: 0.0212771 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925295  Vali macro F1 0.9918422 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 3.3682548999786377
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0162551  Vali Loss: 0.0222012 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9938032  Vali macro F1 0.9930596 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 3.4120490550994873
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0247486  Vali Loss: 0.0337104 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888357  Vali macro F1 0.9877816 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 3.3912858963012695
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0191033  Vali Loss: 0.0216777 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9898493  Vali macro F1 0.9892647 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 3.358232021331787
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0167364  Vali Loss: 0.0220051 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9911393  Vali macro F1 0.9905370 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 3.358232259750366
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0157059  Vali Loss: 0.0197578 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9950351  Vali macro F1 0.9944222 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 3.3560116291046143
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0147534  Vali Loss: 0.0187830 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 3.357564926147461
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0151341  Vali Loss: 0.0186844 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 3.355762481689453
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0151773  Vali Loss: 0.0178415 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.018151 --> 0.017842).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 3.367116689682007
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0140702  Vali Loss: 0.0186782 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 3.3587772846221924
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0138487  Vali Loss: 0.0181597 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 3.355652093887329
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0135453  Vali Loss: 0.0184529 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 3.3567843437194824
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0143358  Vali Loss: 0.0192060 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 3.3542141914367676
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0137269  Vali Loss: 0.0202318 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 3.357006549835205
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0135309  Vali Loss: 0.0200203 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 3.3580570220947266
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0137356  Vali Loss: 0.0198606 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 3.3629870414733887
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0147969  Vali Loss: 0.0196848 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 3.416569948196411
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0135277  Vali Loss: 0.0197071 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 3.3980278968811035
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0134283  Vali Loss: 0.0196392 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 56 cost time: 3.3587865829467773
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0128292  Vali Loss: 0.0196531 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 3.354809522628784
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0139308  Vali Loss: 0.0196380 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 3.3545444011688232
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0136612  Vali Loss: 0.0196277 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 3.3545494079589844
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0135013  Vali Loss: 0.0196069 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 3.3580641746520996
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0138206  Vali Loss: 0.0196040 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9403509  Test weighted F1: 0.9384378  Test macro F1 0.9384378 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.777595520019531
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0171997  Vali Loss: 0.0210815 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
Validation loss decreased (inf --> 0.021081).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.782114028930664
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0132529  Vali Loss: 0.0166748 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.021081 --> 0.016675).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.77979850769043
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0134090  Vali Loss: 0.0194608 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.777236461639404
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0132285  Vali Loss: 0.0166280 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
new best score!!!!
Validation loss decreased (0.016675 --> 0.016628).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.7807793617248535
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0127891  Vali Loss: 0.0169639 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.779497861862183
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0128397  Vali Loss: 0.0176484 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 4.779165744781494
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0118040  Vali Loss: 0.0199486 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 4.7807700634002686
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0119708  Vali Loss: 0.0172187 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 4.780049800872803
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0125716  Vali Loss: 0.0145164 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.016628 --> 0.014516).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 4.7720582485198975
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0107107  Vali Loss: 0.0162344 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 4.775578498840332
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0105063  Vali Loss: 0.0178854 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 4.773361921310425
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0109209  Vali Loss: 0.0137108 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.014516 --> 0.013711).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 4.776061058044434
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0107213  Vali Loss: 0.0158845 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 4.7672810554504395
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0105970  Vali Loss: 0.0158365 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 4.764515161514282
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0100723  Vali Loss: 0.0147754 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 4.759304523468018
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0101242  Vali Loss: 0.0162647 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 4.760345220565796
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0097395  Vali Loss: 0.0139935 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 4.763063907623291
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0099662  Vali Loss: 0.0196451 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913185  Vali macro F1 0.9902817 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 4.762500286102295
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0097431  Vali Loss: 0.0166917 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 4.763417482376099
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0096354  Vali Loss: 0.0165776 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 4.7652223110198975
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0091640  Vali Loss: 0.0182580 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 4.7624671459198
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0091762  Vali Loss: 0.0131692 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
new best score!!!!
Validation loss decreased (0.013711 --> 0.013169).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.763835191726685
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0092594  Vali Loss: 0.0207183 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9913185  Vali macro F1 0.9902817 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 4.761375427246094
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0093465  Vali Loss: 0.0155199 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 4.769712924957275
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0086450  Vali Loss: 0.0140348 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937813  Vali macro F1 0.9929974 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 4.764915227890015
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0088262  Vali Loss: 0.0145847 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 4.771148681640625
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0085471  Vali Loss: 0.0169836 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 4.778302907943726
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0082641  Vali Loss: 0.0168979 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 4.777710676193237
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0087504  Vali Loss: 0.0169186 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 4.781995534896851
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0079428  Vali Loss: 0.0164510 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 4.77701210975647
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0082338  Vali Loss: 0.0159896 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 4.776367425918579
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0083750  Vali Loss: 0.0157697 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 4.776147127151489
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0085421  Vali Loss: 0.0157349 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 4.7772369384765625
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0079663  Vali Loss: 0.0156837 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 4.777554273605347
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0082679  Vali Loss: 0.0156657 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 4.7777886390686035
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0080215  Vali Loss: 0.0156213 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 4.7762768268585205
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0085379  Vali Loss: 0.0154803 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925494  Vali macro F1 0.9916348 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9543860  Test weighted F1: 0.9532841  Test macro F1 0.9532841 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4368886947631836
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.9111272  Vali Loss: 2.6228918 Vali Accuracy: 0.3671679  Vali weighted F1: 0.3135896  Vali macro F1 0.3125444 
Validation loss decreased (inf --> 2.622892).  Saving model ...
Epoch: 2 cost time: 3.3482377529144287
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.9573756  Vali Loss: 1.3559285 Vali Accuracy: 0.7518797  Vali weighted F1: 0.7260266  Vali macro F1 0.7250355 
new best score!!!!
Validation loss decreased (2.622892 --> 1.355928).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.4061384201049805
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.1094784  Vali Loss: 0.8086080 Vali Accuracy: 0.8847118  Vali weighted F1: 0.8705725  Vali macro F1 0.8706030 
new best score!!!!
Validation loss decreased (1.355928 --> 0.808608).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.4033021926879883
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.7190627  Vali Loss: 0.5282881 Vali Accuracy: 0.9260652  Vali weighted F1: 0.9214922  Vali macro F1 0.9208870 
new best score!!!!
Validation loss decreased (0.808608 --> 0.528288).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3661162853240967
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4996827  Vali Loss: 0.3815098 Vali Accuracy: 0.9498747  Vali weighted F1: 0.9487669  Vali macro F1 0.9470748 
new best score!!!!
Validation loss decreased (0.528288 --> 0.381510).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.3786730766296387
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3528358  Vali Loss: 0.2839137 Vali Accuracy: 0.9598997  Vali weighted F1: 0.9597733  Vali macro F1 0.9578280 
new best score!!!!
Validation loss decreased (0.381510 --> 0.283914).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.367278814315796
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2699786  Vali Loss: 0.2227051 Vali Accuracy: 0.9686717  Vali weighted F1: 0.9684892  Vali macro F1 0.9666472 
new best score!!!!
Validation loss decreased (0.283914 --> 0.222705).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.361851453781128
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.2111553  Vali Loss: 0.1780885 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9740156  Vali macro F1 0.9719376 
new best score!!!!
Validation loss decreased (0.222705 --> 0.178089).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.364710569381714
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1737207  Vali Loss: 0.1531203 Vali Accuracy: 0.9761905  Vali weighted F1: 0.9758178  Vali macro F1 0.9744520 
new best score!!!!
Validation loss decreased (0.178089 --> 0.153120).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.3682212829589844
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1410514  Vali Loss: 0.1349405 Vali Accuracy: 0.9736842  Vali weighted F1: 0.9738009  Vali macro F1 0.9709506 
new best score!!!!
Validation loss decreased (0.153120 --> 0.134940).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.369318723678589
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1156456  Vali Loss: 0.1083366 Vali Accuracy: 0.9774436  Vali weighted F1: 0.9775463  Vali macro F1 0.9757610 
new best score!!!!
Validation loss decreased (0.134940 --> 0.108337).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.370032787322998
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0980290  Vali Loss: 0.1003697 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9786706  Vali macro F1 0.9772422 
new best score!!!!
Validation loss decreased (0.108337 --> 0.100370).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.36714506149292
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0892106  Vali Loss: 0.1014469 Vali Accuracy: 0.9799499  Vali weighted F1: 0.9800006  Vali macro F1 0.9777774 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 3.377926826477051
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0774382  Vali Loss: 0.0789672 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837463  Vali macro F1 0.9826239 
new best score!!!!
Validation loss decreased (0.100370 --> 0.078967).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.371878147125244
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0656973  Vali Loss: 0.0789422 Vali Accuracy: 0.9824561  Vali weighted F1: 0.9825555  Vali macro F1 0.9811651 
new best score!!!!
Validation loss decreased (0.078967 --> 0.078942).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3750178813934326
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0574421  Vali Loss: 0.0675227 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9862600  Vali macro F1 0.9849139 
new best score!!!!
Validation loss decreased (0.078942 --> 0.067523).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.3752198219299316
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0534089  Vali Loss: 0.0590083 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887375  Vali macro F1 0.9878904 
new best score!!!!
Validation loss decreased (0.067523 --> 0.059008).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.3779351711273193
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0477322  Vali Loss: 0.0590505 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874812  Vali macro F1 0.9863238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 3.390043258666992
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0457677  Vali Loss: 0.0636952 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9861980  Vali macro F1 0.9845448 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 3.4233803749084473
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0414671  Vali Loss: 0.0511791 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874549  Vali macro F1 0.9862712 
new best score!!!!
Validation loss decreased (0.059008 --> 0.051179).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.378605365753174
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0398007  Vali Loss: 0.0584668 Vali Accuracy: 0.9837093  Vali weighted F1: 0.9837433  Vali macro F1 0.9822548 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.3738369941711426
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0413992  Vali Loss: 0.0389736 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924758  Vali macro F1 0.9918602 
new best score!!!!
Validation loss decreased (0.051179 --> 0.038974).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.372462749481201
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0335921  Vali Loss: 0.0479790 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887271  Vali macro F1 0.9879565 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.370123863220215
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0305805  Vali Loss: 0.0436981 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887308  Vali macro F1 0.9878722 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 3.3694379329681396
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0307266  Vali Loss: 0.0461952 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9874985  Vali macro F1 0.9863550 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 3.370443105697632
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0303277  Vali Loss: 0.0546820 Vali Accuracy: 0.9849624  Vali weighted F1: 0.9849487  Vali macro F1 0.9834415 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 3.3685429096221924
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0296504  Vali Loss: 0.0406716 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924797  Vali macro F1 0.9917591 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 3.367180347442627
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0247387  Vali Loss: 0.0394468 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924797  Vali macro F1 0.9917591 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.36712384223938
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0233512  Vali Loss: 0.0384736 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924797  Vali macro F1 0.9917591 
new best score!!!!
Validation loss decreased (0.038974 --> 0.038474).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 3.3712828159332275
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0227624  Vali Loss: 0.0385548 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912330  Vali macro F1 0.9903922 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 3.372727155685425
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0222380  Vali Loss: 0.0388896 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912330  Vali macro F1 0.9903922 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 3.372385263442993
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0220930  Vali Loss: 0.0385846 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899782  Vali macro F1 0.9892315 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 3.38090443611145
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0217359  Vali Loss: 0.0404568 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 3.4138600826263428
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0218637  Vali Loss: 0.0372377 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899782  Vali macro F1 0.9892315 
new best score!!!!
Validation loss decreased (0.038474 --> 0.037238).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 3.410797595977783
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0333430  Vali Loss: 0.0378101 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899782  Vali macro F1 0.9892315 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 3.3750321865081787
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0211596  Vali Loss: 0.0425016 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887192  Vali macro F1 0.9877311 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 3.370535373687744
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0213822  Vali Loss: 0.0385030 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 3.3730123043060303
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0213000  Vali Loss: 0.0358149 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912330  Vali macro F1 0.9903922 
new best score!!!!
Validation loss decreased (0.037238 --> 0.035815).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.365436315536499
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0209699  Vali Loss: 0.0341929 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912249  Vali macro F1 0.9905984 
new best score!!!!
Validation loss decreased (0.035815 --> 0.034193).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 3.364190101623535
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0209066  Vali Loss: 0.0381647 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 4.759557485580444
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0207327  Vali Loss: 0.0392655 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887315  Vali macro F1 0.9878093 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 3.48764705657959
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0208421  Vali Loss: 0.0374138 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887315  Vali macro F1 0.9878093 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 3.366337537765503
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0204514  Vali Loss: 0.0378367 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887315  Vali macro F1 0.9878093 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 3.367279052734375
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0201352  Vali Loss: 0.0384002 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912302  Vali macro F1 0.9903337 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 3.366825580596924
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0199819  Vali Loss: 0.0381736 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912302  Vali macro F1 0.9903337 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 3.375025749206543
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0199955  Vali Loss: 0.0380919 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912302  Vali macro F1 0.9903337 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 3.371417284011841
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0190340  Vali Loss: 0.0380321 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912302  Vali macro F1 0.9903337 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 3.3746209144592285
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0213541  Vali Loss: 0.0374836 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 3.4204349517822266
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0204316  Vali Loss: 0.0377446 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 3.407728672027588
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0190924  Vali Loss: 0.0377231 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 3.3738245964050293
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0192704  Vali Loss: 0.0377257 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 3.3652868270874023
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0193837  Vali Loss: 0.0377069 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 3.367245674133301
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0193764  Vali Loss: 0.0377000 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 3.3713762760162354
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0197630  Vali Loss: 0.0376794 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899754  Vali macro F1 0.9891729 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8228070  Test weighted F1: 0.7879611  Test macro F1 0.7879611 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.9031126499176025
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0211344  Vali Loss: 0.0412241 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9899740  Vali macro F1 0.9888919 
Validation loss decreased (inf --> 0.041224).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.821848630905151
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0195087  Vali Loss: 0.0327721 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924797  Vali macro F1 0.9917591 
new best score!!!!
Validation loss decreased (0.041224 --> 0.032772).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 4.818236827850342
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0198934  Vali Loss: 0.0364936 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9887308  Vali macro F1 0.9878722 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 4.819988965988159
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0192171  Vali Loss: 0.0295734 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.032772 --> 0.029573).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 4.82004451751709
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0177497  Vali Loss: 0.0306151 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924758  Vali macro F1 0.9918602 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 4.819828748703003
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0169235  Vali Loss: 0.0302337 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912286  Vali macro F1 0.9904841 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 4.82274317741394
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0230386  Vali Loss: 0.0299296 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912249  Vali macro F1 0.9905984 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 4.822929620742798
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0168260  Vali Loss: 0.0260687 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924758  Vali macro F1 0.9918602 
new best score!!!!
Validation loss decreased (0.029573 --> 0.026069).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 4.825224161148071
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0162335  Vali Loss: 0.0265212 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 4.825583219528198
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0157404  Vali Loss: 0.0261703 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924890  Vali macro F1 0.9917279 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 4.824608564376831
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0162637  Vali Loss: 0.0244943 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924722  Vali macro F1 0.9919744 
new best score!!!!
Validation loss decreased (0.026069 --> 0.024494).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.827442169189453
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0159205  Vali Loss: 0.0268974 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924797  Vali macro F1 0.9917591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.825411796569824
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0145228  Vali Loss: 0.0253221 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 4.827889680862427
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0152315  Vali Loss: 0.0252129 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 4.83134651184082
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0140399  Vali Loss: 0.0285090 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924751  Vali macro F1 0.9917069 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 4.824734210968018
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0147909  Vali Loss: 0.0253936 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924751  Vali macro F1 0.9917069 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 4.830913782119751
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0136505  Vali Loss: 0.0273120 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912249  Vali macro F1 0.9905984 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.824652194976807
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0141950  Vali Loss: 0.0279313 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924751  Vali macro F1 0.9917069 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 4.829466342926025
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0133191  Vali Loss: 0.0239974 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.024494 --> 0.023997).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 4.831536769866943
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0132754  Vali Loss: 0.0244003 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 4.830040216445923
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0162291  Vali Loss: 0.0247410 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924751  Vali macro F1 0.9917069 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 4.825394153594971
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0141173  Vali Loss: 0.0230068 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.023997 --> 0.023007).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 4.827932119369507
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0129676  Vali Loss: 0.0224774 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.023007 --> 0.022477).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 4.826575756072998
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0122312  Vali Loss: 0.0237768 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 4.82895302772522
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0119699  Vali Loss: 0.0224453 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
new best score!!!!
Validation loss decreased (0.022477 --> 0.022445).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 4.830016613006592
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0111789  Vali Loss: 0.0240798 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 4.825695037841797
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0117048  Vali Loss: 0.0241418 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 4.8284735679626465
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0112539  Vali Loss: 0.0233807 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 4.83231258392334
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0118068  Vali Loss: 0.0247987 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912249  Vali macro F1 0.9905984 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 4.833390235900879
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0111859  Vali Loss: 0.0228165 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 4.831632852554321
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0108398  Vali Loss: 0.0225704 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 4.826736211776733
Fine Tuning VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0114887  Vali Loss: 0.0231153 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 4.829834938049316
Fine Tuning VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0105383  Vali Loss: 0.0229224 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924722  Vali macro F1 0.9919744 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 4.828816652297974
Fine Tuning VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0113077  Vali Loss: 0.0234509 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 4.829383850097656
Fine Tuning VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0115759  Vali Loss: 0.0235475 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 36 cost time: 4.826591491699219
Fine Tuning VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0112159  Vali Loss: 0.0235124 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 4.826834678649902
Fine Tuning VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0104069  Vali Loss: 0.0235167 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 4.829531908035278
Fine Tuning VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0119448  Vali Loss: 0.0234609 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 4.831493616104126
Fine Tuning VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0107092  Vali Loss: 0.0234398 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 4.824267387390137
Fine Tuning VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0110410  Vali Loss: 0.0234228 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937270  Vali macro F1 0.9931352 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8754386  Test weighted F1: 0.8560413  Test macro F1 0.8560413 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00263158 0.0026455  0.00268817 0.0026178  0.00268817 0.00265957
 0.0025641  0.00268817 0.0026455  0.00271003 0.00263852 0.00263158
 0.00260417 0.00268817 0.00263852 0.00265957 0.00255754 0.0027027
 0.0026178 ]
Train data number :  7182
The number of classes is :  19
The input_length  is :  125
The channel_in is :  45
Validation data number :  798
Test data number :  1140
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.4644687175750732
VALI: Epoch: 1, Steps: 29 | Train Loss: 2.8954268  Vali Loss: 2.5543464 Vali Accuracy: 0.3546366  Vali weighted F1: 0.2943930  Vali macro F1 0.2958140 
Validation loss decreased (inf --> 2.554346).  Saving model ...
Epoch: 2 cost time: 3.3811771869659424
VALI: Epoch: 2, Steps: 29 | Train Loss: 1.9122390  Vali Loss: 1.3511053 Vali Accuracy: 0.7456140  Vali weighted F1: 0.7036462  Vali macro F1 0.7070911 
new best score!!!!
Validation loss decreased (2.554346 --> 1.351105).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 3.3849387168884277
VALI: Epoch: 3, Steps: 29 | Train Loss: 1.0746263  Vali Loss: 0.7778948 Vali Accuracy: 0.8947368  Vali weighted F1: 0.8834527  Vali macro F1 0.8824644 
new best score!!!!
Validation loss decreased (1.351105 --> 0.777895).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 3.376713275909424
VALI: Epoch: 4, Steps: 29 | Train Loss: 0.6597187  Vali Loss: 0.5073280 Vali Accuracy: 0.9348371  Vali weighted F1: 0.9300581  Vali macro F1 0.9316188 
new best score!!!!
Validation loss decreased (0.777895 --> 0.507328).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 3.3752434253692627
VALI: Epoch: 5, Steps: 29 | Train Loss: 0.4437183  Vali Loss: 0.3349504 Vali Accuracy: 0.9649123  Vali weighted F1: 0.9628496  Vali macro F1 0.9631804 
new best score!!!!
Validation loss decreased (0.507328 --> 0.334950).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 3.377593755722046
VALI: Epoch: 6, Steps: 29 | Train Loss: 0.3125613  Vali Loss: 0.2425771 Vali Accuracy: 0.9786967  Vali weighted F1: 0.9781938  Vali macro F1 0.9775819 
new best score!!!!
Validation loss decreased (0.334950 --> 0.242577).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 3.380258321762085
VALI: Epoch: 7, Steps: 29 | Train Loss: 0.2342613  Vali Loss: 0.1874064 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9812741  Vali macro F1 0.9801355 
new best score!!!!
Validation loss decreased (0.242577 --> 0.187406).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 3.37585711479187
VALI: Epoch: 8, Steps: 29 | Train Loss: 0.1882380  Vali Loss: 0.1506575 Vali Accuracy: 0.9812030  Vali weighted F1: 0.9810410  Vali macro F1 0.9801741 
new best score!!!!
Validation loss decreased (0.187406 --> 0.150657).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 3.3741040229797363
VALI: Epoch: 9, Steps: 29 | Train Loss: 0.1593307  Vali Loss: 0.1246857 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863791  Vali macro F1 0.9850524 
new best score!!!!
Validation loss decreased (0.150657 --> 0.124686).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 3.379445791244507
VALI: Epoch: 10, Steps: 29 | Train Loss: 0.1276017  Vali Loss: 0.1077620 Vali Accuracy: 0.9862155  Vali weighted F1: 0.9863557  Vali macro F1 0.9851106 
new best score!!!!
Validation loss decreased (0.124686 --> 0.107762).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 3.382897138595581
VALI: Epoch: 11, Steps: 29 | Train Loss: 0.1039542  Vali Loss: 0.0834705 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900632  Vali macro F1 0.9892243 
new best score!!!!
Validation loss decreased (0.107762 --> 0.083471).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 3.381294012069702
VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0879037  Vali Loss: 0.0742030 Vali Accuracy: 0.9874687  Vali weighted F1: 0.9875061  Vali macro F1 0.9862093 
new best score!!!!
Validation loss decreased (0.083471 --> 0.074203).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 3.383012056350708
VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0993978  Vali Loss: 0.0755056 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912977  Vali macro F1 0.9904891 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 3.38531756401062
VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0743763  Vali Loss: 0.0604426 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900620  Vali macro F1 0.9892691 
new best score!!!!
Validation loss decreased (0.074203 --> 0.060443).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 3.398122787475586
VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0656172  Vali Loss: 0.0571972 Vali Accuracy: 0.9912281  Vali weighted F1: 0.9912721  Vali macro F1 0.9908435 
new best score!!!!
Validation loss decreased (0.060443 --> 0.057197).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 3.3855342864990234
VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0850299  Vali Loss: 0.0568172 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925289  Vali macro F1 0.9918511 
new best score!!!!
Validation loss decreased (0.057197 --> 0.056817).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 3.453058958053589
VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0533416  Vali Loss: 0.0425147 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937626  Vali macro F1 0.9932243 
new best score!!!!
Validation loss decreased (0.056817 --> 0.042515).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 3.400592088699341
VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0483866  Vali Loss: 0.0416466 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925274  Vali macro F1 0.9918498 
new best score!!!!
Validation loss decreased (0.042515 --> 0.041647).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 3.3809053897857666
VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0476322  Vali Loss: 0.0429261 Vali Accuracy: 0.9887218  Vali weighted F1: 0.9888302  Vali macro F1 0.9875890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 3.380953550338745
VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0386909  Vali Loss: 0.0302000 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949998  Vali macro F1 0.9946100 
new best score!!!!
Validation loss decreased (0.041647 --> 0.030200).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 3.38167667388916
VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0345670  Vali Loss: 0.0319494 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937624  Vali macro F1 0.9931748 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 3.379761219024658
VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0357056  Vali Loss: 0.0255822 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962430  Vali macro F1 0.9960109 
new best score!!!!
Validation loss decreased (0.030200 --> 0.025582).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 3.382662296295166
VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0327777  Vali Loss: 0.0277612 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962278  Vali macro F1 0.9959852 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 3.381300449371338
VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0308174  Vali Loss: 0.0278191 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937793  Vali macro F1 0.9931002 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 3.381704092025757
VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0258927  Vali Loss: 0.0191567 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
new best score!!!!
Validation loss decreased (0.025582 --> 0.019157).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 3.3810524940490723
VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0225710  Vali Loss: 0.0190381 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962350  Vali macro F1 0.9959930 
new best score!!!!
Validation loss decreased (0.019157 --> 0.019038).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 3.3829188346862793
VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0235909  Vali Loss: 0.0171258 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.019038 --> 0.017126).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 3.3854072093963623
VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0207830  Vali Loss: 0.0174289 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 3.3826568126678467
VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0265841  Vali Loss: 0.0231477 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962430  Vali macro F1 0.9960109 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 3.3894262313842773
VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0232568  Vali Loss: 0.0230517 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9924677  Vali macro F1 0.9920138 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 3.4024744033813477
VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0178459  Vali Loss: 0.0156496 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974967  Vali macro F1 0.9971584 
new best score!!!!
Validation loss decreased (0.017126 --> 0.015650).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 3.434837818145752
VALI: Epoch: 32, Steps: 29 | Train Loss: 0.0168634  Vali Loss: 0.0136205 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9985752 
new best score!!!!
Validation loss decreased (0.015650 --> 0.013620).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 3.391892433166504
VALI: Epoch: 33, Steps: 29 | Train Loss: 0.0173980  Vali Loss: 0.0153858 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987462  Vali macro F1 0.9985752 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 3.3801920413970947
VALI: Epoch: 34, Steps: 29 | Train Loss: 0.0180044  Vali Loss: 0.0151224 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962566  Vali macro F1 0.9962076 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 3.3804240226745605
VALI: Epoch: 35, Steps: 29 | Train Loss: 0.0274711  Vali Loss: 0.0141784 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 3.3786513805389404
VALI: Epoch: 36, Steps: 29 | Train Loss: 0.0148954  Vali Loss: 0.0133459 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.013620 --> 0.013346).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 3.3814995288848877
VALI: Epoch: 37, Steps: 29 | Train Loss: 0.0129949  Vali Loss: 0.0146057 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975098  Vali macro F1 0.9973042 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 3.381166696548462
VALI: Epoch: 38, Steps: 29 | Train Loss: 0.0123041  Vali Loss: 0.0123348 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962428  Vali macro F1 0.9960108 
new best score!!!!
Validation loss decreased (0.013346 --> 0.012335).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 3.3882830142974854
VALI: Epoch: 39, Steps: 29 | Train Loss: 0.0124248  Vali Loss: 0.0193334 Vali Accuracy: 0.9937343  Vali weighted F1: 0.9937618  Vali macro F1 0.9932236 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 3.380500316619873
VALI: Epoch: 40, Steps: 29 | Train Loss: 0.0162016  Vali Loss: 0.0140450 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975098  Vali macro F1 0.9973042 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 3.376201868057251
VALI: Epoch: 41, Steps: 29 | Train Loss: 0.0111265  Vali Loss: 0.0158012 Vali Accuracy: 0.9949875  Vali weighted F1: 0.9949739  Vali macro F1 0.9943554 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 3.37614107131958
VALI: Epoch: 42, Steps: 29 | Train Loss: 0.0206319  Vali Loss: 0.0134495 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 3.3791141510009766
VALI: Epoch: 43, Steps: 29 | Train Loss: 0.0247218  Vali Loss: 0.0329692 Vali Accuracy: 0.9899749  Vali weighted F1: 0.9900375  Vali macro F1 0.9894203 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 3.3797836303710938
VALI: Epoch: 44, Steps: 29 | Train Loss: 0.0217802  Vali Loss: 0.0196203 Vali Accuracy: 0.9924812  Vali weighted F1: 0.9925099  Vali macro F1 0.9921805 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 3.3837270736694336
VALI: Epoch: 45, Steps: 29 | Train Loss: 0.0152175  Vali Loss: 0.0133650 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 3.4319090843200684
VALI: Epoch: 46, Steps: 29 | Train Loss: 0.0130130  Vali Loss: 0.0123274 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.012335 --> 0.012327).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 3.424572467803955
VALI: Epoch: 47, Steps: 29 | Train Loss: 0.0115410  Vali Loss: 0.0117771 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.012327 --> 0.011777).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 3.3896267414093018
VALI: Epoch: 48, Steps: 29 | Train Loss: 0.0114260  Vali Loss: 0.0117096 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.011777 --> 0.011710).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 3.3821496963500977
VALI: Epoch: 49, Steps: 29 | Train Loss: 0.0108843  Vali Loss: 0.0115638 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.011710 --> 0.011564).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 3.3810157775878906
VALI: Epoch: 50, Steps: 29 | Train Loss: 0.0104976  Vali Loss: 0.0113001 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.011564 --> 0.011300).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 3.3824148178100586
VALI: Epoch: 51, Steps: 29 | Train Loss: 0.0103368  Vali Loss: 0.0111216 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.011300 --> 0.011122).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 3.381466865539551
VALI: Epoch: 52, Steps: 29 | Train Loss: 0.0106076  Vali Loss: 0.0108518 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.011122 --> 0.010852).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 3.3810362815856934
VALI: Epoch: 53, Steps: 29 | Train Loss: 0.0102199  Vali Loss: 0.0106874 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.010852 --> 0.010687).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 3.3830602169036865
VALI: Epoch: 54, Steps: 29 | Train Loss: 0.0098833  Vali Loss: 0.0106738 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.010687 --> 0.010674).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 3.3868653774261475
VALI: Epoch: 55, Steps: 29 | Train Loss: 0.0093987  Vali Loss: 0.0106663 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.010674 --> 0.010666).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 3.3823370933532715
VALI: Epoch: 56, Steps: 29 | Train Loss: 0.0095305  Vali Loss: 0.0099544 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.010666 --> 0.009954).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 3.38258957862854
VALI: Epoch: 57, Steps: 29 | Train Loss: 0.0092849  Vali Loss: 0.0098316 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
new best score!!!!
Validation loss decreased (0.009954 --> 0.009832).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 3.3846640586853027
VALI: Epoch: 58, Steps: 29 | Train Loss: 0.0086765  Vali Loss: 0.0096138 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
new best score!!!!
Validation loss decreased (0.009832 --> 0.009614).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 3.3854825496673584
VALI: Epoch: 59, Steps: 29 | Train Loss: 0.0094104  Vali Loss: 0.0095218 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
new best score!!!!
Validation loss decreased (0.009614 --> 0.009522).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 3.429713726043701
VALI: Epoch: 60, Steps: 29 | Train Loss: 0.0095613  Vali Loss: 0.0096594 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 3.4198384284973145
VALI: Epoch: 61, Steps: 29 | Train Loss: 0.0094059  Vali Loss: 0.0097923 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 3.3869659900665283
VALI: Epoch: 62, Steps: 29 | Train Loss: 0.0088363  Vali Loss: 0.0097991 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 3.381624460220337
VALI: Epoch: 63, Steps: 29 | Train Loss: 0.0081946  Vali Loss: 0.0100228 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 3.3792738914489746
VALI: Epoch: 64, Steps: 29 | Train Loss: 0.0087506  Vali Loss: 0.0104589 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 65 cost time: 3.3785383701324463
VALI: Epoch: 65, Steps: 29 | Train Loss: 0.0082989  Vali Loss: 0.0104610 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 3.3768608570098877
VALI: Epoch: 66, Steps: 29 | Train Loss: 0.0082225  Vali Loss: 0.0104900 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 3.377650737762451
VALI: Epoch: 67, Steps: 29 | Train Loss: 0.0080424  Vali Loss: 0.0105144 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 3.3780791759490967
VALI: Epoch: 68, Steps: 29 | Train Loss: 0.0083193  Vali Loss: 0.0104782 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 3.3788540363311768
VALI: Epoch: 69, Steps: 29 | Train Loss: 0.0085571  Vali Loss: 0.0104804 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 70 cost time: 3.382718086242676
VALI: Epoch: 70, Steps: 29 | Train Loss: 0.0085126  Vali Loss: 0.0104771 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 3.3839499950408936
VALI: Epoch: 71, Steps: 29 | Train Loss: 0.0087946  Vali Loss: 0.0104889 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 3.383758306503296
VALI: Epoch: 72, Steps: 29 | Train Loss: 0.0084668  Vali Loss: 0.0104878 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 3.386986255645752
VALI: Epoch: 73, Steps: 29 | Train Loss: 0.0086779  Vali Loss: 0.0104925 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 3.390061140060425
VALI: Epoch: 74, Steps: 29 | Train Loss: 0.0077116  Vali Loss: 0.0104955 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974923  Vali macro F1 0.9974276 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7903509  Test weighted F1: 0.7566799  Test macro F1 0.7566799 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 104364
pruned model Parameter : 109283
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 4.7708351612091064
Fine Tuning VALI: Epoch: 1, Steps: 29 | Train Loss: 0.0088561  Vali Loss: 0.0090979 Vali Accuracy: 0.9987469  Vali weighted F1: 0.9987461  Vali macro F1 0.9988524 
Validation loss decreased (inf --> 0.009098).  Saving model ...
Fine Tuning Epoch: 2 cost time: 4.7756922245025635
Fine Tuning VALI: Epoch: 2, Steps: 29 | Train Loss: 0.0082986  Vali Loss: 0.0091693 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975121  Vali macro F1 0.9974915 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 4.737922430038452
Fine Tuning VALI: Epoch: 3, Steps: 29 | Train Loss: 0.0078911  Vali Loss: 0.0103235 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962894  Vali macro F1 0.9961011 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 4.736267566680908
Fine Tuning VALI: Epoch: 4, Steps: 29 | Train Loss: 0.0078050  Vali Loss: 0.0099796 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962566  Vali macro F1 0.9962076 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 4.739457368850708
Fine Tuning VALI: Epoch: 5, Steps: 29 | Train Loss: 0.0067891  Vali Loss: 0.0094155 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962894  Vali macro F1 0.9961011 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 4.735600233078003
Fine Tuning VALI: Epoch: 6, Steps: 29 | Train Loss: 0.0066740  Vali Loss: 0.0085959 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974929  Vali macro F1 0.9973789 
new best score!!!!
Validation loss decreased (0.009098 --> 0.008596).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 4.739455699920654
Fine Tuning VALI: Epoch: 7, Steps: 29 | Train Loss: 0.0066702  Vali Loss: 0.0089345 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975098  Vali macro F1 0.9973042 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 4.735580682754517
Fine Tuning VALI: Epoch: 8, Steps: 29 | Train Loss: 0.0068439  Vali Loss: 0.0086576 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974929  Vali macro F1 0.9973789 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 4.736257314682007
Fine Tuning VALI: Epoch: 9, Steps: 29 | Train Loss: 0.0064337  Vali Loss: 0.0097523 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962572  Vali macro F1 0.9961588 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 4.742191314697266
Fine Tuning VALI: Epoch: 10, Steps: 29 | Train Loss: 0.0064626  Vali Loss: 0.0102364 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962572  Vali macro F1 0.9961588 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 4.738326549530029
Fine Tuning VALI: Epoch: 11, Steps: 29 | Train Loss: 0.0065128  Vali Loss: 0.0080244 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974929  Vali macro F1 0.9973789 
new best score!!!!
Validation loss decreased (0.008596 --> 0.008024).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 4.739989995956421
Fine Tuning VALI: Epoch: 12, Steps: 29 | Train Loss: 0.0058918  Vali Loss: 0.0081480 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9974929  Vali macro F1 0.9973789 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 4.742015838623047
Fine Tuning VALI: Epoch: 13, Steps: 29 | Train Loss: 0.0060745  Vali Loss: 0.0126323 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962894  Vali macro F1 0.9961011 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 4.744630336761475
Fine Tuning VALI: Epoch: 14, Steps: 29 | Train Loss: 0.0061241  Vali Loss: 0.0109334 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962894  Vali macro F1 0.9961011 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 4.7511961460113525
Fine Tuning VALI: Epoch: 15, Steps: 29 | Train Loss: 0.0052183  Vali Loss: 0.0091701 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962894  Vali macro F1 0.9961011 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 4.754088878631592
Fine Tuning VALI: Epoch: 16, Steps: 29 | Train Loss: 0.0054172  Vali Loss: 0.0072177 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975098  Vali macro F1 0.9973042 
new best score!!!!
Validation loss decreased (0.008024 --> 0.007218).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 4.749468564987183
Fine Tuning VALI: Epoch: 17, Steps: 29 | Train Loss: 0.0050465  Vali Loss: 0.0082152 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962894  Vali macro F1 0.9961011 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 4.752018451690674
Fine Tuning VALI: Epoch: 18, Steps: 29 | Train Loss: 0.0053192  Vali Loss: 0.0074438 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975098  Vali macro F1 0.9973042 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 4.7495903968811035
Fine Tuning VALI: Epoch: 19, Steps: 29 | Train Loss: 0.0048803  Vali Loss: 0.0095540 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962894  Vali macro F1 0.9961011 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 4.751427173614502
Fine Tuning VALI: Epoch: 20, Steps: 29 | Train Loss: 0.0047823  Vali Loss: 0.0076531 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 4.756070613861084
Fine Tuning VALI: Epoch: 21, Steps: 29 | Train Loss: 0.0043051  Vali Loss: 0.0078169 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 4.754385471343994
Fine Tuning VALI: Epoch: 22, Steps: 29 | Train Loss: 0.0045428  Vali Loss: 0.0079975 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 4.752274036407471
Fine Tuning VALI: Epoch: 23, Steps: 29 | Train Loss: 0.0050643  Vali Loss: 0.0081785 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 4.751583099365234
Fine Tuning VALI: Epoch: 24, Steps: 29 | Train Loss: 0.0045852  Vali Loss: 0.0082412 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 4.749483346939087
Fine Tuning VALI: Epoch: 25, Steps: 29 | Train Loss: 0.0051037  Vali Loss: 0.0083693 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 4.756864070892334
Fine Tuning VALI: Epoch: 26, Steps: 29 | Train Loss: 0.0049196  Vali Loss: 0.0083558 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 4.751636743545532
Fine Tuning VALI: Epoch: 27, Steps: 29 | Train Loss: 0.0048476  Vali Loss: 0.0083657 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 4.748906373977661
Fine Tuning VALI: Epoch: 28, Steps: 29 | Train Loss: 0.0039074  Vali Loss: 0.0083701 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 4.750439643859863
Fine Tuning VALI: Epoch: 29, Steps: 29 | Train Loss: 0.0039314  Vali Loss: 0.0083721 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 4.75325870513916
Fine Tuning VALI: Epoch: 30, Steps: 29 | Train Loss: 0.0042518  Vali Loss: 0.0083886 Vali Accuracy: 0.9974937  Vali weighted F1: 0.9975104  Vali macro F1 0.9973552 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 4.749348402023315
Fine Tuning VALI: Epoch: 31, Steps: 29 | Train Loss: 0.0045201  Vali Loss: 0.0083985 Vali Accuracy: 0.9962406  Vali weighted F1: 0.9962894  Vali macro F1 0.9961011 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7964912  Test weighted F1: 0.7655788  Test macro F1 0.7655788 

============================= JOB FEEDBACK =============================

NodeName=uc2n565
Job ID: 20948454
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 05:02:03
CPU Efficiency: 4.91% of 4-06:38:00 core-walltime
Job Wall-clock time: 05:07:54
Memory Utilized: 6.75 GB
Memory Efficiency: 0.00% of 0.00 MB
